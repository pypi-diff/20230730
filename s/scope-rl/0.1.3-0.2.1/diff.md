# Comparing `tmp/scope-rl-0.1.3.tar.gz` & `tmp/scope-rl-0.2.1.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "scope-rl-0.1.3.tar", last modified: Mon Jul 24 00:40:08 2023, max compression
+gzip compressed data, was "scope-rl-0.2.1.tar", last modified: Sun Jul 30 11:05:10 2023, max compression
```

## Comparing `scope-rl-0.1.3.tar` & `scope-rl-0.2.1.tar`

### file list

```diff
@@ -1,96 +1,95 @@
-drwxr-xr-x   0 haruka     (501) staff       (20)        0 2023-07-24 00:40:08.707862 scope-rl-0.1.3/
--rw-r--r--   0 haruka     (501) staff       (20)     1483 2023-06-16 01:19:44.000000 scope-rl-0.1.3/CONTRIBUTING.md
--rw-r--r--   0 haruka     (501) staff       (20)     1318 2023-07-24 00:35:57.000000 scope-rl-0.1.3/FrequentlyAskedQuestions.md
--rw-r--r--   0 haruka     (501) staff       (20)    11420 2023-06-16 01:19:44.000000 scope-rl-0.1.3/LICENSE
--rw-r--r--   0 haruka     (501) staff       (20)       42 2023-06-16 01:19:44.000000 scope-rl-0.1.3/MANIFEST.in
--rw-r--r--   0 haruka     (501) staff       (20)    30939 2023-07-24 00:40:08.707953 scope-rl-0.1.3/PKG-INFO
--rw-r--r--   0 haruka     (501) staff       (20)    29880 2023-07-24 00:35:57.000000 scope-rl-0.1.3/README.md
-drwxr-xr-x   0 haruka     (501) staff       (20)        0 2023-07-24 00:40:08.698694 scope-rl-0.1.3/basicgym/
--rw-r--r--   0 haruka     (501) staff       (20)     1013 2023-06-16 01:19:44.000000 scope-rl-0.1.3/basicgym/__init__.py
-drwxr-xr-x   0 haruka     (501) staff       (20)        0 2023-07-24 00:40:08.698949 scope-rl-0.1.3/basicgym/envs/
--rw-r--r--   0 haruka     (501) staff       (20)      249 2023-06-16 01:19:44.000000 scope-rl-0.1.3/basicgym/envs/__init__.py
-drwxr-xr-x   0 haruka     (501) staff       (20)        0 2023-07-24 00:40:08.699294 scope-rl-0.1.3/basicgym/envs/simulator/
--rw-r--r--   0 haruka     (501) staff       (20)      339 2023-06-16 01:19:44.000000 scope-rl-0.1.3/basicgym/envs/simulator/__init__.py
--rw-r--r--   0 haruka     (501) staff       (20)     2341 2023-06-16 01:19:44.000000 scope-rl-0.1.3/basicgym/envs/simulator/base.py
--rw-r--r--   0 haruka     (501) staff       (20)     5633 2023-06-16 01:19:44.000000 scope-rl-0.1.3/basicgym/envs/simulator/function.py
--rw-r--r--   0 haruka     (501) staff       (20)    12192 2023-06-16 01:19:44.000000 scope-rl-0.1.3/basicgym/envs/synthetic.py
--rw-r--r--   0 haruka     (501) staff       (20)      306 2023-06-16 01:19:44.000000 scope-rl-0.1.3/basicgym/types.py
--rw-r--r--   0 haruka     (501) staff       (20)     2051 2023-06-16 01:19:44.000000 scope-rl-0.1.3/basicgym/utils.py
--rw-r--r--   0 haruka     (501) staff       (20)      194 2023-06-16 01:19:44.000000 scope-rl-0.1.3/basicgym/version.py
-drwxr-xr-x   0 haruka     (501) staff       (20)        0 2023-07-24 00:40:08.699762 scope-rl-0.1.3/recgym/
--rw-r--r--   0 haruka     (501) staff       (20)      548 2023-06-16 01:19:45.000000 scope-rl-0.1.3/recgym/__init__.py
-drwxr-xr-x   0 haruka     (501) staff       (20)        0 2023-07-24 00:40:08.699988 scope-rl-0.1.3/recgym/envs/
--rw-r--r--   0 haruka     (501) staff       (20)      237 2023-06-16 01:19:45.000000 scope-rl-0.1.3/recgym/envs/__init__.py
--rw-r--r--   0 haruka     (501) staff       (20)    12828 2023-06-16 01:19:45.000000 scope-rl-0.1.3/recgym/envs/rec.py
-drwxr-xr-x   0 haruka     (501) staff       (20)        0 2023-07-24 00:40:08.700333 scope-rl-0.1.3/recgym/envs/simulator/
--rw-r--r--   0 haruka     (501) staff       (20)      257 2023-06-16 01:19:45.000000 scope-rl-0.1.3/recgym/envs/simulator/__init__.py
--rw-r--r--   0 haruka     (501) staff       (20)     2757 2023-06-16 01:19:45.000000 scope-rl-0.1.3/recgym/envs/simulator/base.py
--rw-r--r--   0 haruka     (501) staff       (20)     5363 2023-06-16 01:19:45.000000 scope-rl-0.1.3/recgym/envs/simulator/function.py
--rw-r--r--   0 haruka     (501) staff       (20)      333 2023-06-16 01:19:45.000000 scope-rl-0.1.3/recgym/types.py
--rw-r--r--   0 haruka     (501) staff       (20)     2052 2023-06-16 01:19:45.000000 scope-rl-0.1.3/recgym/utils.py
--rw-r--r--   0 haruka     (501) staff       (20)      194 2023-06-16 01:19:45.000000 scope-rl-0.1.3/recgym/version.py
--rw-r--r--   0 haruka     (501) staff       (20)      193 2023-07-24 00:35:58.000000 scope-rl-0.1.3/requirements.txt
-drwxr-xr-x   0 haruka     (501) staff       (20)        0 2023-07-24 00:40:08.700803 scope-rl-0.1.3/rtbgym/
--rw-r--r--   0 haruka     (501) staff       (20)     1264 2023-06-16 01:19:45.000000 scope-rl-0.1.3/rtbgym/__init__.py
-drwxr-xr-x   0 haruka     (501) staff       (20)        0 2023-07-24 00:40:08.701157 scope-rl-0.1.3/rtbgym/envs/
--rw-r--r--   0 haruka     (501) staff       (20)      314 2023-06-16 01:19:45.000000 scope-rl-0.1.3/rtbgym/envs/__init__.py
--rw-r--r--   0 haruka     (501) staff       (20)    18863 2023-07-24 00:16:24.000000 scope-rl-0.1.3/rtbgym/envs/rtb.py
-drwxr-xr-x   0 haruka     (501) staff       (20)        0 2023-07-24 00:40:08.701728 scope-rl-0.1.3/rtbgym/envs/simulator/
--rw-r--r--   0 haruka     (501) staff       (20)      621 2023-06-16 01:19:45.000000 scope-rl-0.1.3/rtbgym/envs/simulator/__init__.py
--rw-r--r--   0 haruka     (501) staff       (20)     7529 2023-06-16 01:19:45.000000 scope-rl-0.1.3/rtbgym/envs/simulator/base.py
--rw-r--r--   0 haruka     (501) staff       (20)    16332 2023-06-16 01:19:45.000000 scope-rl-0.1.3/rtbgym/envs/simulator/bidder.py
--rw-r--r--   0 haruka     (501) staff       (20)    20994 2023-07-24 00:16:24.000000 scope-rl-0.1.3/rtbgym/envs/simulator/function.py
--rw-r--r--   0 haruka     (501) staff       (20)    21598 2023-07-24 00:16:24.000000 scope-rl-0.1.3/rtbgym/envs/simulator/rtb_synthetic.py
--rw-r--r--   0 haruka     (501) staff       (20)    13398 2023-06-16 01:19:45.000000 scope-rl-0.1.3/rtbgym/envs/wrapper_rtb.py
--rw-r--r--   0 haruka     (501) staff       (20)      411 2023-06-16 01:19:45.000000 scope-rl-0.1.3/rtbgym/types.py
--rw-r--r--   0 haruka     (501) staff       (20)     4788 2023-06-16 01:19:45.000000 scope-rl-0.1.3/rtbgym/utils.py
--rw-r--r--   0 haruka     (501) staff       (20)      194 2023-06-16 01:19:45.000000 scope-rl-0.1.3/rtbgym/version.py
-drwxr-xr-x   0 haruka     (501) staff       (20)        0 2023-07-24 00:40:08.702233 scope-rl-0.1.3/scope_rl/
--rw-r--r--   0 haruka     (501) staff       (20)      213 2023-06-16 01:19:45.000000 scope-rl-0.1.3/scope_rl/__init__.py
-drwxr-xr-x   0 haruka     (501) staff       (20)        0 2023-07-24 00:40:08.703218 scope-rl-0.1.3/scope_rl/dataset/
--rw-r--r--   0 haruka     (501) staff       (20)      332 2023-06-16 01:19:45.000000 scope-rl-0.1.3/scope_rl/dataset/__init__.py
--rw-r--r--   0 haruka     (501) staff       (20)     7018 2023-06-16 01:19:45.000000 scope-rl-0.1.3/scope_rl/dataset/base.py
--rw-r--r--   0 haruka     (501) staff       (20)    49548 2023-07-24 00:35:58.000000 scope-rl-0.1.3/scope_rl/dataset/synthetic.py
-drwxr-xr-x   0 haruka     (501) staff       (20)        0 2023-07-24 00:40:08.704387 scope-rl-0.1.3/scope_rl/ope/
--rw-r--r--   0 haruka     (501) staff       (20)     1046 2023-06-16 01:19:45.000000 scope-rl-0.1.3/scope_rl/ope/__init__.py
-drwxr-xr-x   0 haruka     (501) staff       (20)        0 2023-07-24 00:40:08.705218 scope-rl-0.1.3/scope_rl/ope/continuous/
--rw-r--r--   0 haruka     (501) staff       (20)     2233 2023-06-16 01:19:45.000000 scope-rl-0.1.3/scope_rl/ope/continuous/__init__.py
--rw-r--r--   0 haruka     (501) staff       (20)    69911 2023-07-24 00:16:24.000000 scope-rl-0.1.3/scope_rl/ope/continuous/basic_estimators.py
--rw-r--r--   0 haruka     (501) staff       (20)    73299 2023-06-16 01:19:45.000000 scope-rl-0.1.3/scope_rl/ope/continuous/cumulative_distribution_estimators.py
--rw-r--r--   0 haruka     (501) staff       (20)   130872 2023-07-24 00:16:24.000000 scope-rl-0.1.3/scope_rl/ope/continuous/marginal_estimators.py
-drwxr-xr-x   0 haruka     (501) staff       (20)        0 2023-07-24 00:40:08.705869 scope-rl-0.1.3/scope_rl/ope/discrete/
--rw-r--r--   0 haruka     (501) staff       (20)     2227 2023-06-16 01:19:45.000000 scope-rl-0.1.3/scope_rl/ope/discrete/__init__.py
--rw-r--r--   0 haruka     (501) staff       (20)    62875 2023-07-24 00:16:24.000000 scope-rl-0.1.3/scope_rl/ope/discrete/basic_estimators.py
--rw-r--r--   0 haruka     (501) staff       (20)    68685 2023-06-16 01:19:45.000000 scope-rl-0.1.3/scope_rl/ope/discrete/cumulative_distribution_estimators.py
--rw-r--r--   0 haruka     (501) staff       (20)   124829 2023-07-24 00:16:24.000000 scope-rl-0.1.3/scope_rl/ope/discrete/marginal_estimators.py
--rw-r--r--   0 haruka     (501) staff       (20)    37164 2023-06-16 01:19:45.000000 scope-rl-0.1.3/scope_rl/ope/estimators_base.py
--rw-r--r--   0 haruka     (501) staff       (20)   129251 2023-07-24 00:35:58.000000 scope-rl-0.1.3/scope_rl/ope/input.py
--rw-r--r--   0 haruka     (501) staff       (20)    54713 2023-07-24 00:35:58.000000 scope-rl-0.1.3/scope_rl/ope/online.py
--rw-r--r--   0 haruka     (501) staff       (20)   293608 2023-07-24 00:35:58.000000 scope-rl-0.1.3/scope_rl/ope/ope.py
--rw-r--r--   0 haruka     (501) staff       (20)   523702 2023-07-24 00:35:58.000000 scope-rl-0.1.3/scope_rl/ope/ops.py
-drwxr-xr-x   0 haruka     (501) staff       (20)        0 2023-07-24 00:40:08.707210 scope-rl-0.1.3/scope_rl/ope/weight_value_learning/
--rw-r--r--   0 haruka     (501) staff       (20)     2492 2023-06-16 01:19:45.000000 scope-rl-0.1.3/scope_rl/ope/weight_value_learning/__init__.py
--rw-r--r--   0 haruka     (501) staff       (20)    49122 2023-06-16 01:19:45.000000 scope-rl-0.1.3/scope_rl/ope/weight_value_learning/augmented_lagrangian_learning_continuous.py
--rw-r--r--   0 haruka     (501) staff       (20)    50800 2023-06-16 01:19:45.000000 scope-rl-0.1.3/scope_rl/ope/weight_value_learning/augmented_lagrangian_learning_discrete.py
--rw-r--r--   0 haruka     (501) staff       (20)      985 2023-06-16 01:19:45.000000 scope-rl-0.1.3/scope_rl/ope/weight_value_learning/base.py
--rw-r--r--   0 haruka     (501) staff       (20)     7892 2023-06-16 01:19:45.000000 scope-rl-0.1.3/scope_rl/ope/weight_value_learning/function.py
--rw-r--r--   0 haruka     (501) staff       (20)    34834 2023-06-16 01:19:45.000000 scope-rl-0.1.3/scope_rl/ope/weight_value_learning/minimax_value_learning_continuous.py
--rw-r--r--   0 haruka     (501) staff       (20)    36314 2023-06-16 01:19:45.000000 scope-rl-0.1.3/scope_rl/ope/weight_value_learning/minimax_value_learning_discrete.py
--rw-r--r--   0 haruka     (501) staff       (20)    41939 2023-06-16 01:19:45.000000 scope-rl-0.1.3/scope_rl/ope/weight_value_learning/minimax_weight_learning_continuous.py
--rw-r--r--   0 haruka     (501) staff       (20)    42102 2023-06-16 01:19:45.000000 scope-rl-0.1.3/scope_rl/ope/weight_value_learning/minimax_weight_learning_discrete.py
-drwxr-xr-x   0 haruka     (501) staff       (20)        0 2023-07-24 00:40:08.707732 scope-rl-0.1.3/scope_rl/policy/
--rw-r--r--   0 haruka     (501) staff       (20)      981 2023-07-24 00:35:58.000000 scope-rl-0.1.3/scope_rl/policy/__init__.py
--rw-r--r--   0 haruka     (501) staff       (20)     9256 2023-07-24 00:35:58.000000 scope-rl-0.1.3/scope_rl/policy/encoder.py
--rw-r--r--   0 haruka     (501) staff       (20)    33199 2023-07-24 00:35:58.000000 scope-rl-0.1.3/scope_rl/policy/head.py
--rw-r--r--   0 haruka     (501) staff       (20)    25869 2023-07-24 00:35:58.000000 scope-rl-0.1.3/scope_rl/policy/orl.py
--rw-r--r--   0 haruka     (501) staff       (20)      334 2023-06-16 01:19:45.000000 scope-rl-0.1.3/scope_rl/types.py
--rw-r--r--   0 haruka     (501) staff       (20)    30944 2023-07-24 00:35:58.000000 scope-rl-0.1.3/scope_rl/utils.py
--rw-r--r--   0 haruka     (501) staff       (20)      194 2023-07-24 00:35:58.000000 scope-rl-0.1.3/scope_rl/version.py
-drwxr-xr-x   0 haruka     (501) staff       (20)        0 2023-07-24 00:40:08.702873 scope-rl-0.1.3/scope_rl.egg-info/
--rw-r--r--   0 haruka     (501) staff       (20)    30939 2023-07-24 00:40:08.000000 scope-rl-0.1.3/scope_rl.egg-info/PKG-INFO
--rw-r--r--   0 haruka     (501) staff       (20)     2374 2023-07-24 00:40:08.000000 scope-rl-0.1.3/scope_rl.egg-info/SOURCES.txt
--rw-r--r--   0 haruka     (501) staff       (20)        1 2023-07-24 00:40:08.000000 scope-rl-0.1.3/scope_rl.egg-info/dependency_links.txt
--rw-r--r--   0 haruka     (501) staff       (20)      194 2023-07-24 00:40:08.000000 scope-rl-0.1.3/scope_rl.egg-info/requires.txt
--rw-r--r--   0 haruka     (501) staff       (20)       32 2023-07-24 00:40:08.000000 scope-rl-0.1.3/scope_rl.egg-info/top_level.txt
--rw-r--r--   0 haruka     (501) staff       (20)       74 2023-07-24 00:40:08.708185 scope-rl-0.1.3/setup.cfg
--rw-r--r--   0 haruka     (501) staff       (20)     1729 2023-07-24 00:16:24.000000 scope-rl-0.1.3/setup.py
+drwxr-xr-x   0 haruka     (501) staff       (20)        0 2023-07-30 11:05:10.648642 scope-rl-0.2.1/
+-rw-r--r--   0 haruka     (501) staff       (20)     1483 2023-06-16 01:19:44.000000 scope-rl-0.2.1/CONTRIBUTING.md
+-rw-r--r--   0 haruka     (501) staff       (20)     1574 2023-07-30 07:44:46.000000 scope-rl-0.2.1/FrequentlyAskedQuestions.md
+-rw-r--r--   0 haruka     (501) staff       (20)    11420 2023-06-16 01:19:44.000000 scope-rl-0.2.1/LICENSE
+-rw-r--r--   0 haruka     (501) staff       (20)       42 2023-06-16 01:19:44.000000 scope-rl-0.2.1/MANIFEST.in
+-rw-r--r--   0 haruka     (501) staff       (20)    31852 2023-07-30 11:05:10.648738 scope-rl-0.2.1/PKG-INFO
+-rw-r--r--   0 haruka     (501) staff       (20)    30793 2023-07-30 07:44:46.000000 scope-rl-0.2.1/README.md
+drwxr-xr-x   0 haruka     (501) staff       (20)        0 2023-07-30 11:05:10.629083 scope-rl-0.2.1/basicgym/
+-rw-r--r--   0 haruka     (501) staff       (20)     1013 2023-06-16 01:19:44.000000 scope-rl-0.2.1/basicgym/__init__.py
+drwxr-xr-x   0 haruka     (501) staff       (20)        0 2023-07-30 11:05:10.629645 scope-rl-0.2.1/basicgym/envs/
+-rw-r--r--   0 haruka     (501) staff       (20)      249 2023-06-16 01:19:44.000000 scope-rl-0.2.1/basicgym/envs/__init__.py
+drwxr-xr-x   0 haruka     (501) staff       (20)        0 2023-07-30 11:05:10.630238 scope-rl-0.2.1/basicgym/envs/simulator/
+-rw-r--r--   0 haruka     (501) staff       (20)      339 2023-06-16 01:19:44.000000 scope-rl-0.2.1/basicgym/envs/simulator/__init__.py
+-rw-r--r--   0 haruka     (501) staff       (20)     2341 2023-06-16 01:19:44.000000 scope-rl-0.2.1/basicgym/envs/simulator/base.py
+-rw-r--r--   0 haruka     (501) staff       (20)     5633 2023-06-16 01:19:44.000000 scope-rl-0.2.1/basicgym/envs/simulator/function.py
+-rw-r--r--   0 haruka     (501) staff       (20)    12192 2023-06-16 01:19:44.000000 scope-rl-0.2.1/basicgym/envs/synthetic.py
+-rw-r--r--   0 haruka     (501) staff       (20)      306 2023-06-16 01:19:44.000000 scope-rl-0.2.1/basicgym/types.py
+-rw-r--r--   0 haruka     (501) staff       (20)     2051 2023-06-16 01:19:44.000000 scope-rl-0.2.1/basicgym/utils.py
+-rw-r--r--   0 haruka     (501) staff       (20)      194 2023-06-16 01:19:44.000000 scope-rl-0.2.1/basicgym/version.py
+drwxr-xr-x   0 haruka     (501) staff       (20)        0 2023-07-30 11:05:10.631335 scope-rl-0.2.1/recgym/
+-rw-r--r--   0 haruka     (501) staff       (20)      548 2023-06-16 01:19:45.000000 scope-rl-0.2.1/recgym/__init__.py
+drwxr-xr-x   0 haruka     (501) staff       (20)        0 2023-07-30 11:05:10.631732 scope-rl-0.2.1/recgym/envs/
+-rw-r--r--   0 haruka     (501) staff       (20)      237 2023-06-16 01:19:45.000000 scope-rl-0.2.1/recgym/envs/__init__.py
+-rw-r--r--   0 haruka     (501) staff       (20)    12828 2023-06-16 01:19:45.000000 scope-rl-0.2.1/recgym/envs/rec.py
+drwxr-xr-x   0 haruka     (501) staff       (20)        0 2023-07-30 11:05:10.632283 scope-rl-0.2.1/recgym/envs/simulator/
+-rw-r--r--   0 haruka     (501) staff       (20)      257 2023-06-16 01:19:45.000000 scope-rl-0.2.1/recgym/envs/simulator/__init__.py
+-rw-r--r--   0 haruka     (501) staff       (20)     2757 2023-06-16 01:19:45.000000 scope-rl-0.2.1/recgym/envs/simulator/base.py
+-rw-r--r--   0 haruka     (501) staff       (20)     5363 2023-06-16 01:19:45.000000 scope-rl-0.2.1/recgym/envs/simulator/function.py
+-rw-r--r--   0 haruka     (501) staff       (20)      333 2023-06-16 01:19:45.000000 scope-rl-0.2.1/recgym/types.py
+-rw-r--r--   0 haruka     (501) staff       (20)     2052 2023-06-16 01:19:45.000000 scope-rl-0.2.1/recgym/utils.py
+-rw-r--r--   0 haruka     (501) staff       (20)      194 2023-06-16 01:19:45.000000 scope-rl-0.2.1/recgym/version.py
+-rw-r--r--   0 haruka     (501) staff       (20)      193 2023-07-30 07:44:47.000000 scope-rl-0.2.1/requirements.txt
+drwxr-xr-x   0 haruka     (501) staff       (20)        0 2023-07-30 11:05:10.632943 scope-rl-0.2.1/rtbgym/
+-rw-r--r--   0 haruka     (501) staff       (20)     1264 2023-06-16 01:19:45.000000 scope-rl-0.2.1/rtbgym/__init__.py
+drwxr-xr-x   0 haruka     (501) staff       (20)        0 2023-07-30 11:05:10.634081 scope-rl-0.2.1/rtbgym/envs/
+-rw-r--r--   0 haruka     (501) staff       (20)      314 2023-06-16 01:19:45.000000 scope-rl-0.2.1/rtbgym/envs/__init__.py
+-rw-r--r--   0 haruka     (501) staff       (20)    18863 2023-07-24 00:16:24.000000 scope-rl-0.2.1/rtbgym/envs/rtb.py
+drwxr-xr-x   0 haruka     (501) staff       (20)        0 2023-07-30 11:05:10.635125 scope-rl-0.2.1/rtbgym/envs/simulator/
+-rw-r--r--   0 haruka     (501) staff       (20)      621 2023-06-16 01:19:45.000000 scope-rl-0.2.1/rtbgym/envs/simulator/__init__.py
+-rw-r--r--   0 haruka     (501) staff       (20)     7529 2023-06-16 01:19:45.000000 scope-rl-0.2.1/rtbgym/envs/simulator/base.py
+-rw-r--r--   0 haruka     (501) staff       (20)    16332 2023-06-16 01:19:45.000000 scope-rl-0.2.1/rtbgym/envs/simulator/bidder.py
+-rw-r--r--   0 haruka     (501) staff       (20)    20994 2023-07-24 00:16:24.000000 scope-rl-0.2.1/rtbgym/envs/simulator/function.py
+-rw-r--r--   0 haruka     (501) staff       (20)    21598 2023-07-24 00:16:24.000000 scope-rl-0.2.1/rtbgym/envs/simulator/rtb_synthetic.py
+-rw-r--r--   0 haruka     (501) staff       (20)    13398 2023-06-16 01:19:45.000000 scope-rl-0.2.1/rtbgym/envs/wrapper_rtb.py
+-rw-r--r--   0 haruka     (501) staff       (20)      411 2023-06-16 01:19:45.000000 scope-rl-0.2.1/rtbgym/types.py
+-rw-r--r--   0 haruka     (501) staff       (20)     4788 2023-06-16 01:19:45.000000 scope-rl-0.2.1/rtbgym/utils.py
+-rw-r--r--   0 haruka     (501) staff       (20)      194 2023-06-16 01:19:45.000000 scope-rl-0.2.1/rtbgym/version.py
+drwxr-xr-x   0 haruka     (501) staff       (20)        0 2023-07-30 11:05:10.636363 scope-rl-0.2.1/scope_rl/
+-rw-r--r--   0 haruka     (501) staff       (20)      213 2023-06-16 01:19:45.000000 scope-rl-0.2.1/scope_rl/__init__.py
+drwxr-xr-x   0 haruka     (501) staff       (20)        0 2023-07-30 11:05:10.637641 scope-rl-0.2.1/scope_rl/dataset/
+-rw-r--r--   0 haruka     (501) staff       (20)      332 2023-06-16 01:19:45.000000 scope-rl-0.2.1/scope_rl/dataset/__init__.py
+-rw-r--r--   0 haruka     (501) staff       (20)     7018 2023-06-16 01:19:45.000000 scope-rl-0.2.1/scope_rl/dataset/base.py
+-rw-r--r--   0 haruka     (501) staff       (20)    49309 2023-07-30 07:44:47.000000 scope-rl-0.2.1/scope_rl/dataset/synthetic.py
+drwxr-xr-x   0 haruka     (501) staff       (20)        0 2023-07-30 11:05:10.640447 scope-rl-0.2.1/scope_rl/ope/
+-rw-r--r--   0 haruka     (501) staff       (20)     1046 2023-06-16 01:19:45.000000 scope-rl-0.2.1/scope_rl/ope/__init__.py
+drwxr-xr-x   0 haruka     (501) staff       (20)        0 2023-07-30 11:05:10.642928 scope-rl-0.2.1/scope_rl/ope/continuous/
+-rw-r--r--   0 haruka     (501) staff       (20)     2233 2023-06-16 01:19:45.000000 scope-rl-0.2.1/scope_rl/ope/continuous/__init__.py
+-rw-r--r--   0 haruka     (501) staff       (20)    69911 2023-07-24 00:16:24.000000 scope-rl-0.2.1/scope_rl/ope/continuous/basic_estimators.py
+-rw-r--r--   0 haruka     (501) staff       (20)    73299 2023-06-16 01:19:45.000000 scope-rl-0.2.1/scope_rl/ope/continuous/cumulative_distribution_estimators.py
+-rw-r--r--   0 haruka     (501) staff       (20)   130872 2023-07-24 00:16:24.000000 scope-rl-0.2.1/scope_rl/ope/continuous/marginal_estimators.py
+drwxr-xr-x   0 haruka     (501) staff       (20)        0 2023-07-30 11:05:10.644489 scope-rl-0.2.1/scope_rl/ope/discrete/
+-rw-r--r--   0 haruka     (501) staff       (20)     2227 2023-06-16 01:19:45.000000 scope-rl-0.2.1/scope_rl/ope/discrete/__init__.py
+-rw-r--r--   0 haruka     (501) staff       (20)    62875 2023-07-24 00:16:24.000000 scope-rl-0.2.1/scope_rl/ope/discrete/basic_estimators.py
+-rw-r--r--   0 haruka     (501) staff       (20)    68685 2023-06-16 01:19:45.000000 scope-rl-0.2.1/scope_rl/ope/discrete/cumulative_distribution_estimators.py
+-rw-r--r--   0 haruka     (501) staff       (20)   124829 2023-07-24 00:16:24.000000 scope-rl-0.2.1/scope_rl/ope/discrete/marginal_estimators.py
+-rw-r--r--   0 haruka     (501) staff       (20)    37164 2023-06-16 01:19:45.000000 scope-rl-0.2.1/scope_rl/ope/estimators_base.py
+-rw-r--r--   0 haruka     (501) staff       (20)   128551 2023-07-30 07:44:47.000000 scope-rl-0.2.1/scope_rl/ope/input.py
+-rw-r--r--   0 haruka     (501) staff       (20)    54996 2023-07-30 07:44:47.000000 scope-rl-0.2.1/scope_rl/ope/online.py
+-rw-r--r--   0 haruka     (501) staff       (20)   293396 2023-07-30 07:44:47.000000 scope-rl-0.2.1/scope_rl/ope/ope.py
+-rw-r--r--   0 haruka     (501) staff       (20)   523596 2023-07-30 07:44:47.000000 scope-rl-0.2.1/scope_rl/ope/ops.py
+drwxr-xr-x   0 haruka     (501) staff       (20)        0 2023-07-30 11:05:10.647263 scope-rl-0.2.1/scope_rl/ope/weight_value_learning/
+-rw-r--r--   0 haruka     (501) staff       (20)     2492 2023-06-16 01:19:45.000000 scope-rl-0.2.1/scope_rl/ope/weight_value_learning/__init__.py
+-rw-r--r--   0 haruka     (501) staff       (20)    49122 2023-06-16 01:19:45.000000 scope-rl-0.2.1/scope_rl/ope/weight_value_learning/augmented_lagrangian_learning_continuous.py
+-rw-r--r--   0 haruka     (501) staff       (20)    50800 2023-06-16 01:19:45.000000 scope-rl-0.2.1/scope_rl/ope/weight_value_learning/augmented_lagrangian_learning_discrete.py
+-rw-r--r--   0 haruka     (501) staff       (20)      985 2023-06-16 01:19:45.000000 scope-rl-0.2.1/scope_rl/ope/weight_value_learning/base.py
+-rw-r--r--   0 haruka     (501) staff       (20)     7892 2023-06-16 01:19:45.000000 scope-rl-0.2.1/scope_rl/ope/weight_value_learning/function.py
+-rw-r--r--   0 haruka     (501) staff       (20)    34834 2023-06-16 01:19:45.000000 scope-rl-0.2.1/scope_rl/ope/weight_value_learning/minimax_value_learning_continuous.py
+-rw-r--r--   0 haruka     (501) staff       (20)    36314 2023-06-16 01:19:45.000000 scope-rl-0.2.1/scope_rl/ope/weight_value_learning/minimax_value_learning_discrete.py
+-rw-r--r--   0 haruka     (501) staff       (20)    41939 2023-06-16 01:19:45.000000 scope-rl-0.2.1/scope_rl/ope/weight_value_learning/minimax_weight_learning_continuous.py
+-rw-r--r--   0 haruka     (501) staff       (20)    42102 2023-06-16 01:19:45.000000 scope-rl-0.2.1/scope_rl/ope/weight_value_learning/minimax_weight_learning_discrete.py
+drwxr-xr-x   0 haruka     (501) staff       (20)        0 2023-07-30 11:05:10.648286 scope-rl-0.2.1/scope_rl/policy/
+-rw-r--r--   0 haruka     (501) staff       (20)      772 2023-07-30 07:44:47.000000 scope-rl-0.2.1/scope_rl/policy/__init__.py
+-rw-r--r--   0 haruka     (501) staff       (20)    33776 2023-07-30 07:44:47.000000 scope-rl-0.2.1/scope_rl/policy/head.py
+-rw-r--r--   0 haruka     (501) staff       (20)    25904 2023-07-30 08:45:24.000000 scope-rl-0.2.1/scope_rl/policy/orl.py
+-rw-r--r--   0 haruka     (501) staff       (20)      334 2023-06-16 01:19:45.000000 scope-rl-0.2.1/scope_rl/types.py
+-rw-r--r--   0 haruka     (501) staff       (20)    22975 2023-07-30 07:44:47.000000 scope-rl-0.2.1/scope_rl/utils.py
+-rw-r--r--   0 haruka     (501) staff       (20)      194 2023-07-30 07:44:47.000000 scope-rl-0.2.1/scope_rl/version.py
+drwxr-xr-x   0 haruka     (501) staff       (20)        0 2023-07-30 11:05:10.637139 scope-rl-0.2.1/scope_rl.egg-info/
+-rw-r--r--   0 haruka     (501) staff       (20)    31852 2023-07-30 11:05:10.000000 scope-rl-0.2.1/scope_rl.egg-info/PKG-INFO
+-rw-r--r--   0 haruka     (501) staff       (20)     2347 2023-07-30 11:05:10.000000 scope-rl-0.2.1/scope_rl.egg-info/SOURCES.txt
+-rw-r--r--   0 haruka     (501) staff       (20)        1 2023-07-30 11:05:10.000000 scope-rl-0.2.1/scope_rl.egg-info/dependency_links.txt
+-rw-r--r--   0 haruka     (501) staff       (20)      194 2023-07-30 11:05:10.000000 scope-rl-0.2.1/scope_rl.egg-info/requires.txt
+-rw-r--r--   0 haruka     (501) staff       (20)       32 2023-07-30 11:05:10.000000 scope-rl-0.2.1/scope_rl.egg-info/top_level.txt
+-rw-r--r--   0 haruka     (501) staff       (20)       74 2023-07-30 11:05:10.649015 scope-rl-0.2.1/setup.cfg
+-rw-r--r--   0 haruka     (501) staff       (20)     1729 2023-07-24 00:16:24.000000 scope-rl-0.2.1/setup.py
```

### Comparing `scope-rl-0.1.3/CONTRIBUTING.md` & `scope-rl-0.2.1/CONTRIBUTING.md`

 * *Files identical despite different names*

### Comparing `scope-rl-0.1.3/LICENSE` & `scope-rl-0.2.1/LICENSE`

 * *Files identical despite different names*

### Comparing `scope-rl-0.1.3/PKG-INFO` & `scope-rl-0.2.1/PKG-INFO`

 * *Files 4% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: scope-rl
-Version: 0.1.3
+Version: 0.2.1
 Summary: SCOPE-RL: A pipeline for offline reinforcement learning research and applications
 Home-page: https://github.com/hakuhodo-technologies/scope-rl
 Author: Haruka Kiyohara
 Author-email: hk844@cornell.edu
 License: Apache License 2.0
 Keywords: off-policy evaluation,offline reinforcement learning,risk assessment
 Platform: UNKNOWN
@@ -22,14 +22,23 @@
 Description-Content-Type: text/markdown
 License-File: LICENSE
 
 # SCOPE-RL: A Python library for offline reinforcement learning, off-policy evaluation, and selection
 
 <div align="center"><img src="https://raw.githubusercontent.com/hakuhodo-technologies/scope-rl/main/images/logo.png" width="100%"/></div>
 
+[![pypi](https://img.shields.io/pypi/v/scope-rl.svg)](https://pypi.python.org/pypi/scope-rl)
+[![Python](https://img.shields.io/badge/python-3.9%20%7C%203.10%20%7C%203.11-blue)](https://www.python.org)
+[![Downloads](https://pepy.tech/badge/scope-rl)](https://pepy.tech/project/scope-rl)
+[![GitHub commit activity](https://img.shields.io/github/commit-activity/m/hakuhodo-technologies/scope-rl)](https://github.com/hakuhodo-technologies/scope-rl/graphs/contributors)
+[![GitHub last commit](https://img.shields.io/github/last-commit/hakuhodo-technologies/scope-rl)](https://github.com/hakuhodo-technologies/scope-rl/graphs/commit-activity)
+[![Documentation Status](https://readthedocs.org/projects/scope-rl/badge/?version=latest)](https://scope-rl.readthedocs.io/en/latest/)
+[![License](https://img.shields.io/badge/License-Apache%202.0-blue.svg)](https://opensource.org/licenses/Apache-2.0)
+[![arXiv](https://img.shields.io/badge/arXiv-23xx.xxxxx-b31b1b.svg)](https://arxiv.org/abs/23xx.xxxxx)
+
 <details>
 <summary><strong>Table of Contents </strong>(click to expand)</summary>
 
 - [SCOPE-RL: A Python library for offline reinforcement learning, off-policy evaluation, and selection](#SCOPE-RL-a-python-library-for-offline-reinforcement-learning-off-policy-evaluation-and-selection)
 - [Overview](#overview)
 - [Installation](#installation)
 - [Usage](#usage)
@@ -172,38 +181,36 @@
 ```Python
 # implement a data collection procedure on the RTBGym environment
 
 # import SCOPE-RL modules
 from scope_rl.dataset import SyntheticDataset
 from scope_rl.policy import EpsilonGreedyHead
 # import d3rlpy algorithms
-from d3rlpy.algos import DoubleDQN
-from d3rlpy.online.buffers import ReplayBuffer
-from d3rlpy.online.explorers import ConstantEpsilonGreedy
+from d3rlpy.algos import DoubleDQNConfig
+from d3rlpy.dataset import create_fifo_replay_buffer
+from d3rlpy.algos import ConstantEpsilonGreedy
 # import rtbgym and gym
 import rtbgym
 import gym
+import torch
 # random state
 random_state = 12345
+device = "cuda:0" if torch.cuda.is_available() else "cpu"
 
 # (0) Setup environment
 env = gym.make("RTBEnv-discrete-v0")
 
-# for api compatibility to d3rlpy
-from scope_rl.utils import OldGymAPIWrapper
-env_ = OldGymAPIWrapper(env)
-
 # (1) Learn a baseline policy in an online environment (using d3rlpy)
 # initialize the algorithm
-ddqn = DoubleDQN()
+ddqn = DoubleDQNConfig().create(device=device)
 # train an online policy
 # this takes about 5min to compute
 ddqn.fit_online(
-    env_,
-    buffer=ReplayBuffer(maxlen=10000, env=env_),
+    env,
+    buffer=create_fifo_replay_buffer(limit=10000, env=env),
     explorer=ConstantEpsilonGreedy(epsilon=0.3),
     n_steps=100000,
     n_steps_per_epoch=1000,
     update_start_step=1000,
 )
 
 # (2) Generate a logged dataset
@@ -214,56 +221,53 @@
     epsilon=0.3,
     name="ddqn_epsilon_0.3",
     random_state=random_state,
 )
 # initialize the dataset class
 dataset = SyntheticDataset(
     env=env,
-    maximum_episode_steps=env.step_per_episode,
+    max_episode_steps=env.step_per_episode,
 )
 # the behavior policy collects some logged data
-train_logged_dataset = dataset.obtain_trajectories(
+train_logged_dataset = dataset.obtain_episodes(
   behavior_policies=behavior_policy,
   n_trajectories=10000,
   random_state=random_state,
 )
-test_logged_dataset = dataset.obtain_trajectories(
+test_logged_dataset = dataset.obtain_episodes(
   behavior_policies=behavior_policy,
   n_trajectories=10000,
   random_state=random_state + 1,
 )
 ```
 
 ### Offline Reinforcement Learning
 We are now ready to learn a new policy (evaluation policy) from the logged data using [d3rlpy](https://github.com/takuseno/d3rlpy).
 
 ```Python
 # implement an offline RL procedure using SCOPE-RL and d3rlpy
 
 # import d3rlpy algorithms
 from d3rlpy.dataset import MDPDataset
-from d3rlpy.algos import DiscreteCQL
+from d3rlpy.algos import DiscreteCQLConfig
 
 # (3) Learning a new policy from offline logged data (using d3rlpy)
 # convert the logged dataset into d3rlpy's dataset format
 offlinerl_dataset = MDPDataset(
     observations=train_logged_dataset["state"],
     actions=train_logged_dataset["action"],
     rewards=train_logged_dataset["reward"],
     terminals=train_logged_dataset["done"],
-    episode_terminals=train_logged_dataset["done"],
-    discrete_action=True,
 )
 # initialize the algorithm
-cql = DiscreteCQL()
+cql = DiscreteCQLConfig().create(device=device)
 # train an offline policy
 cql.fit(
     offlinerl_dataset,
     n_steps=10000,
-    scorers={},
 )
 ```
 
 ### Basic Off-Policy Evaluation
 
 Then, we evaluate the performance of several evaluation policies (ddqn, cql, and random) using offline logged data collected by the behavior policy. Specifically, we compare the estimation results of various OPE estimators, including Direct Method (DM), Trajectory-wise Importance Sampling (TIS), Per-Decision Importance Sampling (PDIS), and Doubly Robust (DR) below.
 
@@ -301,15 +305,14 @@
     epsilon=1.0,
     random_state=random_state,
 )
 evaluation_policies = [cql_, ddqn_, random_]
 # create input for the OPE class
 prep = CreateOPEInput(
     env=env,
-    logged_dataset=test_logged_dataset,
 )
 input_dict = prep.obtain_whole_inputs(
     logged_dataset=test_logged_dataset,
     evaluation_policies=evaluation_policies,
     require_value_prediction=True,
     n_trajectories_on_policy_evaluation=100,
     random_state=random_state,
@@ -377,15 +380,15 @@
 </p>
 </figcaption>
 
 For more extensive examples, please refer to [quickstart/rtb/rtb_synthetic_discrete_advanced.ipynb](./examples/quickstart/rtb/rtb_synthetic_discrete_advanced.ipynb).
 
 ### Off-Policy Selection and Evaluation of OPE/OPS
 
-We can also select the best-performing policy among a set of candidate policies based on the OPE results using the OPS class. It is also possible to evaluate the reliability of OPE/OPS using various metrics such as mean squaredberror, rank correlation, regret, and type I and type II error rates.
+We can also select the best-performing policy among a set of candidate policies based on the OPE results using the OPS class. It is also possible to evaluate the reliability of OPE/OPS using various metrics such as mean squared error, rank correlation, regret, and type I and type II error rates.
 
 ```Python
 # perform off-policy selection based on the OPE results
 
 # import SCOPE-RL modules
 from scope_rl.ope import OffPolicySelection
 
@@ -399,15 +402,15 @@
 ranking_dict = ops.select_by_policy_value(input_dict)
 # rank the candidate policies by their policy value estimated by cumulative distribution OPE
 ranking_dict_ = ops.select_by_policy_value_via_cumulative_distribution_ope(input_dict)
 # visualize the top k deployment result
 ops.visualize_topk_policy_value_selected_by_standard_ope(
     input_dict=input_dict,
     compared_estimators=["dm", "tis", "pdis", "dr"],
-    safety_criteria=1.0,
+    relative_safety_criteria=1.0,
 )
 ```
 <div align="center"><img src="https://raw.githubusercontent.com/hakuhodo-technologies/scope-rl/main/images/ops_topk_lower_quartile.png" width="100%"/></div>
 <figcaption>
 <p align="center">
   Comparison of the Top-k Statistics of 10% Lower Quartile of Policy Value
 </p>
@@ -419,15 +422,15 @@
 ranking_df, metric_df = ops.select_by_lower_quartile(
     input_dict,
     alpha=0.3,
     return_metrics=True,
     return_by_dataframe=True,
 )
 # visualize the OPS results with the ground-truth metrics
-ops.visualize_cvar_for_validation(
+ops.visualize_conditional_value_at_risk_for_validation(
     input_dict,
     alpha=0.3,
     share_axes=True,
 )
 ```
 <div align="center"><img src="https://raw.githubusercontent.com/hakuhodo-technologies/scope-rl/main/images/ops_variance_validation.png" width="100%"/></div>
 <figcaption>
```

### Comparing `scope-rl-0.1.3/README.md` & `scope-rl-0.2.1/README.md`

 * *Files 4% similar despite different names*

```diff
@@ -1,11 +1,20 @@
 # SCOPE-RL: A Python library for offline reinforcement learning, off-policy evaluation, and selection
 
 <div align="center"><img src="https://raw.githubusercontent.com/hakuhodo-technologies/scope-rl/main/images/logo.png" width="100%"/></div>
 
+[![pypi](https://img.shields.io/pypi/v/scope-rl.svg)](https://pypi.python.org/pypi/scope-rl)
+[![Python](https://img.shields.io/badge/python-3.9%20%7C%203.10%20%7C%203.11-blue)](https://www.python.org)
+[![Downloads](https://pepy.tech/badge/scope-rl)](https://pepy.tech/project/scope-rl)
+[![GitHub commit activity](https://img.shields.io/github/commit-activity/m/hakuhodo-technologies/scope-rl)](https://github.com/hakuhodo-technologies/scope-rl/graphs/contributors)
+[![GitHub last commit](https://img.shields.io/github/last-commit/hakuhodo-technologies/scope-rl)](https://github.com/hakuhodo-technologies/scope-rl/graphs/commit-activity)
+[![Documentation Status](https://readthedocs.org/projects/scope-rl/badge/?version=latest)](https://scope-rl.readthedocs.io/en/latest/)
+[![License](https://img.shields.io/badge/License-Apache%202.0-blue.svg)](https://opensource.org/licenses/Apache-2.0)
+[![arXiv](https://img.shields.io/badge/arXiv-23xx.xxxxx-b31b1b.svg)](https://arxiv.org/abs/23xx.xxxxx)
+
 <details>
 <summary><strong>Table of Contents </strong>(click to expand)</summary>
 
 - [SCOPE-RL: A Python library for offline reinforcement learning, off-policy evaluation, and selection](#SCOPE-RL-a-python-library-for-offline-reinforcement-learning-off-policy-evaluation-and-selection)
 - [Overview](#overview)
 - [Installation](#installation)
 - [Usage](#usage)
@@ -148,38 +157,36 @@
 ```Python
 # implement a data collection procedure on the RTBGym environment
 
 # import SCOPE-RL modules
 from scope_rl.dataset import SyntheticDataset
 from scope_rl.policy import EpsilonGreedyHead
 # import d3rlpy algorithms
-from d3rlpy.algos import DoubleDQN
-from d3rlpy.online.buffers import ReplayBuffer
-from d3rlpy.online.explorers import ConstantEpsilonGreedy
+from d3rlpy.algos import DoubleDQNConfig
+from d3rlpy.dataset import create_fifo_replay_buffer
+from d3rlpy.algos import ConstantEpsilonGreedy
 # import rtbgym and gym
 import rtbgym
 import gym
+import torch
 # random state
 random_state = 12345
+device = "cuda:0" if torch.cuda.is_available() else "cpu"
 
 # (0) Setup environment
 env = gym.make("RTBEnv-discrete-v0")
 
-# for api compatibility to d3rlpy
-from scope_rl.utils import OldGymAPIWrapper
-env_ = OldGymAPIWrapper(env)
-
 # (1) Learn a baseline policy in an online environment (using d3rlpy)
 # initialize the algorithm
-ddqn = DoubleDQN()
+ddqn = DoubleDQNConfig().create(device=device)
 # train an online policy
 # this takes about 5min to compute
 ddqn.fit_online(
-    env_,
-    buffer=ReplayBuffer(maxlen=10000, env=env_),
+    env,
+    buffer=create_fifo_replay_buffer(limit=10000, env=env),
     explorer=ConstantEpsilonGreedy(epsilon=0.3),
     n_steps=100000,
     n_steps_per_epoch=1000,
     update_start_step=1000,
 )
 
 # (2) Generate a logged dataset
@@ -190,56 +197,53 @@
     epsilon=0.3,
     name="ddqn_epsilon_0.3",
     random_state=random_state,
 )
 # initialize the dataset class
 dataset = SyntheticDataset(
     env=env,
-    maximum_episode_steps=env.step_per_episode,
+    max_episode_steps=env.step_per_episode,
 )
 # the behavior policy collects some logged data
-train_logged_dataset = dataset.obtain_trajectories(
+train_logged_dataset = dataset.obtain_episodes(
   behavior_policies=behavior_policy,
   n_trajectories=10000,
   random_state=random_state,
 )
-test_logged_dataset = dataset.obtain_trajectories(
+test_logged_dataset = dataset.obtain_episodes(
   behavior_policies=behavior_policy,
   n_trajectories=10000,
   random_state=random_state + 1,
 )
 ```
 
 ### Offline Reinforcement Learning
 We are now ready to learn a new policy (evaluation policy) from the logged data using [d3rlpy](https://github.com/takuseno/d3rlpy).
 
 ```Python
 # implement an offline RL procedure using SCOPE-RL and d3rlpy
 
 # import d3rlpy algorithms
 from d3rlpy.dataset import MDPDataset
-from d3rlpy.algos import DiscreteCQL
+from d3rlpy.algos import DiscreteCQLConfig
 
 # (3) Learning a new policy from offline logged data (using d3rlpy)
 # convert the logged dataset into d3rlpy's dataset format
 offlinerl_dataset = MDPDataset(
     observations=train_logged_dataset["state"],
     actions=train_logged_dataset["action"],
     rewards=train_logged_dataset["reward"],
     terminals=train_logged_dataset["done"],
-    episode_terminals=train_logged_dataset["done"],
-    discrete_action=True,
 )
 # initialize the algorithm
-cql = DiscreteCQL()
+cql = DiscreteCQLConfig().create(device=device)
 # train an offline policy
 cql.fit(
     offlinerl_dataset,
     n_steps=10000,
-    scorers={},
 )
 ```
 
 ### Basic Off-Policy Evaluation
 
 Then, we evaluate the performance of several evaluation policies (ddqn, cql, and random) using offline logged data collected by the behavior policy. Specifically, we compare the estimation results of various OPE estimators, including Direct Method (DM), Trajectory-wise Importance Sampling (TIS), Per-Decision Importance Sampling (PDIS), and Doubly Robust (DR) below.
 
@@ -277,15 +281,14 @@
     epsilon=1.0,
     random_state=random_state,
 )
 evaluation_policies = [cql_, ddqn_, random_]
 # create input for the OPE class
 prep = CreateOPEInput(
     env=env,
-    logged_dataset=test_logged_dataset,
 )
 input_dict = prep.obtain_whole_inputs(
     logged_dataset=test_logged_dataset,
     evaluation_policies=evaluation_policies,
     require_value_prediction=True,
     n_trajectories_on_policy_evaluation=100,
     random_state=random_state,
@@ -353,15 +356,15 @@
 </p>
 </figcaption>
 
 For more extensive examples, please refer to [quickstart/rtb/rtb_synthetic_discrete_advanced.ipynb](./examples/quickstart/rtb/rtb_synthetic_discrete_advanced.ipynb).
 
 ### Off-Policy Selection and Evaluation of OPE/OPS
 
-We can also select the best-performing policy among a set of candidate policies based on the OPE results using the OPS class. It is also possible to evaluate the reliability of OPE/OPS using various metrics such as mean squaredberror, rank correlation, regret, and type I and type II error rates.
+We can also select the best-performing policy among a set of candidate policies based on the OPE results using the OPS class. It is also possible to evaluate the reliability of OPE/OPS using various metrics such as mean squared error, rank correlation, regret, and type I and type II error rates.
 
 ```Python
 # perform off-policy selection based on the OPE results
 
 # import SCOPE-RL modules
 from scope_rl.ope import OffPolicySelection
 
@@ -375,15 +378,15 @@
 ranking_dict = ops.select_by_policy_value(input_dict)
 # rank the candidate policies by their policy value estimated by cumulative distribution OPE
 ranking_dict_ = ops.select_by_policy_value_via_cumulative_distribution_ope(input_dict)
 # visualize the top k deployment result
 ops.visualize_topk_policy_value_selected_by_standard_ope(
     input_dict=input_dict,
     compared_estimators=["dm", "tis", "pdis", "dr"],
-    safety_criteria=1.0,
+    relative_safety_criteria=1.0,
 )
 ```
 <div align="center"><img src="https://raw.githubusercontent.com/hakuhodo-technologies/scope-rl/main/images/ops_topk_lower_quartile.png" width="100%"/></div>
 <figcaption>
 <p align="center">
   Comparison of the Top-k Statistics of 10% Lower Quartile of Policy Value
 </p>
@@ -395,15 +398,15 @@
 ranking_df, metric_df = ops.select_by_lower_quartile(
     input_dict,
     alpha=0.3,
     return_metrics=True,
     return_by_dataframe=True,
 )
 # visualize the OPS results with the ground-truth metrics
-ops.visualize_cvar_for_validation(
+ops.visualize_conditional_value_at_risk_for_validation(
     input_dict,
     alpha=0.3,
     share_axes=True,
 )
 ```
 <div align="center"><img src="https://raw.githubusercontent.com/hakuhodo-technologies/scope-rl/main/images/ops_variance_validation.png" width="100%"/></div>
 <figcaption>
```

### Comparing `scope-rl-0.1.3/basicgym/__init__.py` & `scope-rl-0.2.1/basicgym/__init__.py`

 * *Files identical despite different names*

### Comparing `scope-rl-0.1.3/basicgym/envs/simulator/base.py` & `scope-rl-0.2.1/basicgym/envs/simulator/base.py`

 * *Files identical despite different names*

### Comparing `scope-rl-0.1.3/basicgym/envs/simulator/function.py` & `scope-rl-0.2.1/basicgym/envs/simulator/function.py`

 * *Files identical despite different names*

### Comparing `scope-rl-0.1.3/basicgym/envs/synthetic.py` & `scope-rl-0.2.1/basicgym/envs/synthetic.py`

 * *Files identical despite different names*

### Comparing `scope-rl-0.1.3/basicgym/utils.py` & `scope-rl-0.2.1/basicgym/utils.py`

 * *Files identical despite different names*

### Comparing `scope-rl-0.1.3/recgym/__init__.py` & `scope-rl-0.2.1/recgym/__init__.py`

 * *Files identical despite different names*

### Comparing `scope-rl-0.1.3/recgym/envs/rec.py` & `scope-rl-0.2.1/recgym/envs/rec.py`

 * *Files identical despite different names*

### Comparing `scope-rl-0.1.3/recgym/envs/simulator/base.py` & `scope-rl-0.2.1/recgym/envs/simulator/base.py`

 * *Files identical despite different names*

### Comparing `scope-rl-0.1.3/recgym/envs/simulator/function.py` & `scope-rl-0.2.1/recgym/envs/simulator/function.py`

 * *Files identical despite different names*

### Comparing `scope-rl-0.1.3/recgym/utils.py` & `scope-rl-0.2.1/recgym/utils.py`

 * *Files identical despite different names*

### Comparing `scope-rl-0.1.3/rtbgym/__init__.py` & `scope-rl-0.2.1/rtbgym/__init__.py`

 * *Files identical despite different names*

### Comparing `scope-rl-0.1.3/rtbgym/envs/rtb.py` & `scope-rl-0.2.1/rtbgym/envs/rtb.py`

 * *Files identical despite different names*

### Comparing `scope-rl-0.1.3/rtbgym/envs/simulator/__init__.py` & `scope-rl-0.2.1/rtbgym/envs/simulator/__init__.py`

 * *Files identical despite different names*

### Comparing `scope-rl-0.1.3/rtbgym/envs/simulator/base.py` & `scope-rl-0.2.1/rtbgym/envs/simulator/base.py`

 * *Files identical despite different names*

### Comparing `scope-rl-0.1.3/rtbgym/envs/simulator/bidder.py` & `scope-rl-0.2.1/rtbgym/envs/simulator/bidder.py`

 * *Files identical despite different names*

### Comparing `scope-rl-0.1.3/rtbgym/envs/simulator/function.py` & `scope-rl-0.2.1/rtbgym/envs/simulator/function.py`

 * *Files identical despite different names*

### Comparing `scope-rl-0.1.3/rtbgym/envs/simulator/rtb_synthetic.py` & `scope-rl-0.2.1/rtbgym/envs/simulator/rtb_synthetic.py`

 * *Files identical despite different names*

### Comparing `scope-rl-0.1.3/rtbgym/envs/wrapper_rtb.py` & `scope-rl-0.2.1/rtbgym/envs/wrapper_rtb.py`

 * *Files identical despite different names*

### Comparing `scope-rl-0.1.3/rtbgym/utils.py` & `scope-rl-0.2.1/rtbgym/utils.py`

 * *Files identical despite different names*

### Comparing `scope-rl-0.1.3/scope_rl/dataset/base.py` & `scope-rl-0.2.1/scope_rl/dataset/base.py`

 * *Files identical despite different names*

### Comparing `scope-rl-0.1.3/scope_rl/dataset/synthetic.py` & `scope-rl-0.2.1/scope_rl/dataset/synthetic.py`

 * *Files 2% similar despite different names*

```diff
@@ -33,16 +33,14 @@
     .. code-block:: python
 
         d3rlpy_dataset = MDPDataset(
             observations=logged_datasets["state"],
             actions=logged_datasets["action"],
             rewards=logged_datasets["reward"],
             terminals=logged_datasets["done"],
-            episode_terminals=logged_datasets["terminal"],
-            discrete_action=(logged_datasets["action_type"]=="discrete"),
         )
 
     .. seealso::
 
         (external) `d3rlpy's documentation about MDPDataset <https://d3rlpy.readthedocs.io/en/latest/references/dataset.html>`_
 
     Parameters
@@ -77,36 +75,32 @@
         # import necessary module from SCOPE-RL
         from scope_rl.dataset import SyntheticDataset
         from scope_rl.policy import EpsilonGreedyHead
 
         # import necessary module from other libraries
         import gym
         import rtbgym
-        from d3rlpy.algos import DoubleDQN
-        from d3rlpy.online.buffers import ReplayBuffer
-        from d3rlpy.online.explorers import ConstantEpsilonGreedy
+        from d3rlpy.algos import DoubleDQNConfig
+        from d3rlpy.dataset import create_fifo_replay_buffer
+        from d3rlpy.algos import ConstantEpsilonGreedy
 
         # initialize environment
         env = gym.make("RTBEnv-discrete-v0")
 
-        # for api compatibility to d3rlpy
-        from scope_rl.utils import OldGymAPIWrapper
-        env_ = OldGymAPIWrapper(env)
-
         # define (RL) agent (i.e., policy) and train on the environment
-        ddqn = DoubleDQN()
-        buffer = ReplayBuffer(
-            maxlen=10000,
-            env=env_,
+        ddqn = DoubleDQNConfig().create()
+        buffer = create_fifo_replay_buffer(
+            limit=10000,
+            env=env,
         )
         explorer = ConstantEpsilonGreedy(
             epsilon=0.3,
         )
         ddqn.fit_online(
-            env=env_,
+            env=env,
             buffer=buffer,
             explorer=explorer,
             n_steps=10000,
             n_steps_per_epoch=1000,
         )
 
         # convert ddqn policy to stochastic data collection policy
```

### Comparing `scope-rl-0.1.3/scope_rl/ope/__init__.py` & `scope-rl-0.2.1/scope_rl/ope/__init__.py`

 * *Files identical despite different names*

### Comparing `scope-rl-0.1.3/scope_rl/ope/continuous/__init__.py` & `scope-rl-0.2.1/scope_rl/ope/continuous/__init__.py`

 * *Files identical despite different names*

### Comparing `scope-rl-0.1.3/scope_rl/ope/continuous/basic_estimators.py` & `scope-rl-0.2.1/scope_rl/ope/continuous/basic_estimators.py`

 * *Files identical despite different names*

### Comparing `scope-rl-0.1.3/scope_rl/ope/continuous/cumulative_distribution_estimators.py` & `scope-rl-0.2.1/scope_rl/ope/continuous/cumulative_distribution_estimators.py`

 * *Files identical despite different names*

### Comparing `scope-rl-0.1.3/scope_rl/ope/continuous/marginal_estimators.py` & `scope-rl-0.2.1/scope_rl/ope/continuous/marginal_estimators.py`

 * *Files identical despite different names*

### Comparing `scope-rl-0.1.3/scope_rl/ope/discrete/__init__.py` & `scope-rl-0.2.1/scope_rl/ope/discrete/__init__.py`

 * *Files identical despite different names*

### Comparing `scope-rl-0.1.3/scope_rl/ope/discrete/basic_estimators.py` & `scope-rl-0.2.1/scope_rl/ope/discrete/basic_estimators.py`

 * *Files identical despite different names*

### Comparing `scope-rl-0.1.3/scope_rl/ope/discrete/cumulative_distribution_estimators.py` & `scope-rl-0.2.1/scope_rl/ope/discrete/cumulative_distribution_estimators.py`

 * *Files identical despite different names*

### Comparing `scope-rl-0.1.3/scope_rl/ope/discrete/marginal_estimators.py` & `scope-rl-0.2.1/scope_rl/ope/discrete/marginal_estimators.py`

 * *Files identical despite different names*

### Comparing `scope-rl-0.1.3/scope_rl/ope/estimators_base.py` & `scope-rl-0.2.1/scope_rl/ope/estimators_base.py`

 * *Files identical despite different names*

### Comparing `scope-rl-0.1.3/scope_rl/ope/input.py` & `scope-rl-0.2.1/scope_rl/ope/input.py`

 * *Files 1% similar despite different names*

```diff
@@ -13,14 +13,15 @@
 import numpy as np
 from sklearn.utils import check_scalar, check_random_state
 
 import gym
 from gym.spaces import Discrete
 
 from d3rlpy.dataset import MDPDataset
+from d3rlpy.ope import FQEConfig
 from d3rlpy.ope import DiscreteFQE
 from d3rlpy.ope import FQE as ContinuousFQE
 from d3rlpy.models.encoders import VectorEncoderFactory
 from d3rlpy.models.q_functions import MeanQFunctionFactory
 from d3rlpy.preprocessing import Scaler, ActionScaler
 
 from .weight_value_learning import (
@@ -124,36 +125,32 @@
         from scope_rl.ope import OffPolicyEvaluation as OPE
         from scope_rl.ope.discrete import TrajectoryWiseImportanceSampling as TIS
         from scope_rl.ope.discrete import PerDecisionImportanceSampling as PDIS
 
         # import necessary module from other libraries
         import gym
         import rtbgym
-        from d3rlpy.algos import DoubleDQN
-        from d3rlpy.online.buffers import ReplayBuffer
-        from d3rlpy.online.explorers import ConstantEpsilonGreedy
+        from d3rlpy.algos import DoubleDQNConfig
+        from d3rlpy.dataset import create_fifo_replay_buffer
+        from d3rlpy.algos import ConstantEpsilonGreedy
 
         # initialize environment
         env = gym.make("RTBEnv-discrete-v0")
 
-        # for api compatibility to d3rlpy
-        from scope_rl.utils import OldGymAPIWrapper
-        env_ = OldGymAPIWrapper(env)
-
         # define (RL) agent (i.e., policy) and train on the environment
-        ddqn = DoubleDQN()
-        buffer = ReplayBuffer(
-            maxlen=10000,
-            env=env_,
+        ddqn = DoubleDQNConfig().create()
+        buffer = create_fifo_replay_buffer(
+            limit=10000,
+            env=env,
         )
         explorer = ConstantEpsilonGreedy(
             epsilon=0.3,
         )
         ddqn.fit_online(
-            env=env_,
+            env=env,
             buffer=buffer,
             explorer=explorer,
             n_steps=10000,
             n_steps_per_epoch=1000,
         )
 
         # convert ddqn policy to stochastic data collection policy
@@ -315,15 +312,14 @@
         if self.model_args["fqe"] is None:
             self.model_args["fqe"] = {
                 "encoder_factory": VectorEncoderFactory(
                     hidden_units=[self.model_args["hidden_dim"]]
                 ),
                 "q_func_factory": MeanQFunctionFactory(),
                 "learning_rate": 1e-4,
-                "use_gpu": torch.cuda.is_available(),
             }
 
         if self.model_args["state_action_dual"] is None:
             self.model_args["state_action_dual"] = {}
 
         if self.model_args["state_action_value"] is None:
             self.model_args["state_action_value"] = {}
@@ -402,16 +398,14 @@
             )
 
         self.mdp_dataset = MDPDataset(
             observations=self.state,
             actions=self.action,
             rewards=self.reward,
             terminals=self.done,
-            episode_terminals=self.terminal,
-            discrete_action=(self.action_type == "discrete"),
         )
 
     def build_and_fit_FQE(
         self,
         evaluation_policy: BaseHead,
         k_fold: int = 1,
         n_steps: int = 10000,
@@ -436,42 +430,38 @@
         check_scalar(n_steps, name="n_steps", target_type=int, min_val=1)
 
         if evaluation_policy.name in self.fqe:
             pass
 
         else:
             self.fqe[evaluation_policy.name] = []
+            fqe_config = FQEConfig(gamma=self.gamma, **self.model_args["fqe"])
 
             for k in range(k_fold):
                 if self.action_type == "discrete":
                     self.fqe[evaluation_policy.name].append(
                         DiscreteFQE(
                             algo=evaluation_policy,
-                            scaler=self.state_scaler,
-                            gamma=self.gamma,
-                            **self.model_args["fqe"],
+                            config=fqe_config,
+                            device=self.device,
                         )
                     )
                 else:
                     self.fqe[evaluation_policy.name].append(
                         ContinuousFQE(
                             algo=evaluation_policy,
-                            scaler=self.state_scaler,
-                            action_scaler=self.action_scaler,
-                            gamma=self.gamma,
-                            **self.model_args["fqe"],
+                            config=fqe_config,
+                            device=self.device,
                         )
                     )
 
             if k_fold == 1:
                 self.fqe[evaluation_policy.name][0].fit(
-                    self.mdp_dataset.episodes,
-                    eval_episodes=self.mdp_dataset.episodes,
+                    self.mdp_dataset,
                     n_steps=n_steps,
-                    scorers={},
                 )
             else:
                 all_idx = np.arange(self.n_trajectories)
                 idx = np.array(
                     [(self.n_trajectories + k) // k_fold for k in range(k_fold)]
                 )
                 idx = np.insert(idx, 0, 0)
@@ -495,22 +485,18 @@
                     mdp_dataset_ = MDPDataset(
                         observations=self.state_2d[subset_idx_].reshape(
                             (-1, self.state_dim)
                         ),
                         actions=action_,
                         rewards=self.reward_2d[subset_idx_].flatten(),
                         terminals=self.done_2d[subset_idx_].flatten(),
-                        episode_terminals=self.terminal_2d[subset_idx_].flatten(),
-                        discrete_action=(self.action_type == "discrete"),
                     )
                     self.fqe[evaluation_policy.name][k].fit(
-                        mdp_dataset_.episodes,
-                        eval_episodes=mdp_dataset_.episodes,
+                        mdp_dataset_,
                         n_steps=n_steps,
-                        scorers={},
                     )
 
     def build_and_fit_state_action_dual_model(
         self,
         evaluation_policy: BaseHead,
         k_fold: int = 1,
         n_steps: int = 10000,
```

### Comparing `scope-rl-0.1.3/scope_rl/ope/online.py` & `scope-rl-0.2.1/scope_rl/ope/online.py`

 * *Files 2% similar despite different names*

```diff
@@ -12,27 +12,27 @@
 
 from pandas import DataFrame
 import matplotlib.pyplot as plt
 import seaborn as sns
 
 import gym
 from gym.wrappers import TimeLimit
-from d3rlpy.algos import AlgoBase
+from d3rlpy.algos import QLearningAlgoBase
 from sklearn.utils import check_scalar, check_random_state
 
 from ..policy.head import BaseHead, OnlineHead
 from ..utils import (
     estimate_confidence_interval_by_bootstrap,
     check_array,
 )
 
 
 def visualize_on_policy_policy_value(
     env: gym.Env,
-    policies: List[Union[AlgoBase, BaseHead]],
+    policies: List[Union[QLearningAlgoBase, BaseHead]],
     policy_names: List[str],
     n_trajectories: int = 100,
     step_per_trajectory: Optional[int] = None,
     evaluate_on_stationary_distribution: bool = False,
     gamma: float = 1.0,
     alpha: float = 0.05,
     n_bootstrap_samples: int = 100,
@@ -43,15 +43,15 @@
     """Visualize on-policy policy value estimates of the given policies.
 
     Parameters
     -------
     env: gym.Env
         Reinforcement learning (RL) environment.
 
-    policies: list of {AlgoBase, BaseHead}
+    policies: list of {QLearningAlgoBase, BaseHead}
         List of policies to be evaluated.
 
     policy_names: list of str
         Name of policies.
 
     n_trajectories: int, default=100 (> 0)
         Number of trajectories to rollout.
@@ -126,15 +126,15 @@
     plt.yticks(fontsize=12)
     if fig_dir:
         plt.savefig(str(fig_dir / fig_name), dpi=300, bbox_inches="tight")
 
 
 def visualize_on_policy_policy_value_with_variance(
     env: gym.Env,
-    policies: List[Union[AlgoBase, BaseHead]],
+    policies: List[Union[QLearningAlgoBase, BaseHead]],
     policy_names: List[str],
     n_trajectories: int = 100,
     step_per_trajectory: Optional[int] = None,
     evaluate_on_stationary_distribution: bool = False,
     gamma: float = 1.0,
     alpha: float = 0.05,
     random_state: Optional[int] = None,
@@ -144,15 +144,15 @@
     """Visualize the policy value estimated by OPE estimators.
 
     Parameters
     -------
     env: gym.Env
         Reinforcement learning (RL) environment.
 
-    policies: list of {AlgoBase, BaseHead}
+    policies: list of {QLearningAlgoBase, BaseHead}
         List of policies to be evaluated.
 
     policy_names: list of str
         Name of policies.
 
     n_trajectories: int, default=100 (> 0)
         Number of trajectories to rollout.
@@ -243,15 +243,15 @@
 
     if fig_dir:
         fig.savefig(str(fig_dir / fig_name), dpi=300, bbox_inches="tight")
 
 
 def visualize_on_policy_cumulative_distribution_function(
     env: gym.Env,
-    policies: List[Union[AlgoBase, BaseHead]],
+    policies: List[Union[QLearningAlgoBase, BaseHead]],
     policy_names: List[str],
     n_trajectories: int = 100,
     step_per_trajectory: Optional[int] = None,
     evaluate_on_stationary_distribution: bool = False,
     gamma: float = 1.0,
     use_custom_reward_scale: bool = False,
     scale_min: Optional[float] = None,
@@ -265,15 +265,15 @@
     """Visualize the cumulative distribution function of the on-policy policy value.
 
     Parameters
     -------
     env: gym.Env
         Reinforcement learning (RL) environment.
 
-    policy: {AlgoBase, BaseHead}
+    policy: {QLearningAlgoBase, BaseHead}
         A policy to be evaluated.
 
     n_trajectories: int, default=100 (> 0)
         Number of trajectories to rollout.
 
     step_per_trajectory: int, default=None (> 0)
         Number of timesteps in an trajectory.
@@ -352,15 +352,15 @@
 
     if fig_dir:
         fig.savefig(str(fig_dir / fig_name), dpi=300, bbox_inches="tight")
 
 
 def visualize_on_policy_conditional_value_at_risk(
     env: gym.Env,
-    policies: List[Union[AlgoBase, BaseHead]],
+    policies: List[Union[QLearningAlgoBase, BaseHead]],
     policy_names: List[str],
     n_trajectories: int = 100,
     step_per_trajectory: Optional[int] = None,
     evaluate_on_stationary_distribution: bool = False,
     gamma: float = 1.0,
     alphas: Optional[np.ndarray] = None,
     use_custom_reward_scale: bool = False,
@@ -375,15 +375,15 @@
     """Visualize the conditional value at risk of the on-policy policy value.
 
     Parameters
     -------
     env: gym.Env
         Reinforcement learning (RL) environment.
 
-    policy: {AlgoBase, BaseHead}
+    policy: {QLearningAlgoBase, BaseHead}
         A policy to be evaluated.
 
     n_trajectories: int, default=100 (> 0)
         Number of trajectories to rollout.
 
     step_per_trajectory: int, default=None (> 0)
         Number of timesteps in an trajectory.
@@ -467,15 +467,15 @@
 
     if fig_dir:
         fig.savefig(str(fig_dir / fig_name), dpi=300, bbox_inches="tight")
 
 
 def visualize_on_policy_interquartile_range(
     env: gym.Env,
-    policies: List[Union[AlgoBase, BaseHead]],
+    policies: List[Union[QLearningAlgoBase, BaseHead]],
     policy_names: List[str],
     n_trajectories: int = 100,
     step_per_trajectory: Optional[int] = None,
     evaluate_on_stationary_distribution: bool = False,
     gamma: float = 1.0,
     alpha: float = 0.05,
     use_custom_reward_scale: bool = False,
@@ -489,15 +489,15 @@
     """Visualize the interquartile range of the on-policy policy value.
 
     Parameters
     -------
     env: gym.Env
         Reinforcement learning (RL) environment.
 
-    policy: {AlgoBase, BaseHead}
+    policy: {QLearningAlgoBase, BaseHead}
         A policy to be evaluated.
 
     n_trajectories: int, default=100 (> 0)
         Number of trajectories to rollout.
 
     step_per_trajectory: int, default=None (> 0)
         Number of timesteps in an trajectory.
@@ -621,15 +621,15 @@
 
     if fig_dir:
         fig.savefig(str(fig_dir / fig_name), dpi=300, bbox_inches="tight")
 
 
 def calc_on_policy_statistics(
     env: gym.Env,
-    policy: Union[AlgoBase, BaseHead],
+    policy: Union[QLearningAlgoBase, BaseHead],
     n_trajectories: int = 100,
     step_per_trajectory: Optional[int] = None,
     evaluate_on_stationary_distribution: bool = False,
     gamma: float = 1.0,
     quartile_alpha: float = 0.05,
     cvar_alpha: float = 0.05,
     use_custom_reward_scale: bool = False,
@@ -641,15 +641,15 @@
     """Calculate the mean, variance, conditional value at risk, interquartile range of the on-policy policy value.
 
     Parameters
     -------
     env: gym.Env
         Reinforcement learning (RL) environment.
 
-    policy: {AlgoBase, BaseHead}
+    policy: {QLearningAlgoBase, BaseHead}
         A policy to be evaluated.
 
     n_trajectories: int, default=100 (> 0)
         Number of trajectories to rollout.
 
     step_per_trajectory: int, default=None (> 0)
         Number of timesteps in an trajectory.
@@ -807,15 +807,15 @@
     }
 
     return statistics_dict
 
 
 def calc_on_policy_policy_value(
     env: gym.Env,
-    policy: Union[AlgoBase, BaseHead],
+    policy: Union[QLearningAlgoBase, BaseHead],
     n_trajectories: int = 100,
     step_per_trajectory: Optional[int] = None,
     evaluate_on_stationary_distribution: bool = False,
     gamma: float = 1.0,
     alpha: float = 0.05,
     use_bootstrap: bool = False,
     n_bootstrap_samples: int = 100,
@@ -824,15 +824,15 @@
     """Calculate an on-policy policy value of a given policy.
 
     Parameters
     -------
     env: gym.Env
         Reinforcement learning (RL) environment.
 
-    policy: {AlgoBase, BaseHead}
+    policy: {QLearningAlgoBase, BaseHead}
         A policy to be evaluated.
 
     n_trajectories: int, default=100 (> 0)
         Number of trajectories to rollout.
 
     step_per_trajectory: int, default=None (> 0)
         Number of timesteps in an trajectory.
@@ -886,15 +886,15 @@
             random_state=random_state,
         ).mean()
     return on_policy_policy_value
 
 
 def calc_on_policy_policy_value_interval(
     env: gym.Env,
-    policy: Union[AlgoBase, BaseHead],
+    policy: Union[QLearningAlgoBase, BaseHead],
     n_trajectories: int = 100,
     step_per_trajectory: Optional[int] = None,
     evaluate_on_stationary_distribution: bool = False,
     gamma: float = 1.0,
     alpha: float = 0.05,
     n_bootstrap_samples: int = 100,
     random_state: Optional[int] = None,
@@ -902,15 +902,15 @@
     """Estimate the confidence interval of on-policy policy value by nonparametric bootstrap.
 
     Parameters
     -------
     env: gym.Env
         Reinforcement learning (RL) environment.
 
-    policy: {AlgoBase, BaseHead}
+    policy: {QLearningAlgoBase, BaseHead}
         A policy to be evaluated.
 
     n_trajectories: int, default=100 (> 0)
         Number of trajectories to rollout.
 
     step_per_trajectory: int, default=None (> 0)
         Number of timesteps in an trajectory.
@@ -953,29 +953,29 @@
         n_bootstrap_samples=n_bootstrap_samples,
         random_state=random_state,
     )
 
 
 def calc_on_policy_variance(
     env: gym.Env,
-    policy: Union[AlgoBase, BaseHead],
+    policy: Union[QLearningAlgoBase, BaseHead],
     n_trajectories: int = 100,
     step_per_trajectory: Optional[int] = None,
     evaluate_on_stationary_distribution: bool = False,
     gamma: float = 1.0,
     random_state: Optional[int] = None,
 ):
     """Calculate the variance of the on-policy policy value.
 
     Parameters
     -------
     env: gym.Env
         Reinforcement learning (RL) environment.
 
-    policy: {AlgoBase, BaseHead}
+    policy: {QLearningAlgoBase, BaseHead}
         A policy to be evaluated.
 
     n_trajectories: int, default=100 (> 0)
         Number of trajectories to rollout.
 
     step_per_trajectory: int, default=None (> 0)
         Number of timesteps in an trajectory.
@@ -1007,15 +1007,15 @@
         random_state=random_state,
     )
     return on_policy_policy_values.var(ddof=1)
 
 
 def calc_on_policy_conditional_value_at_risk(
     env: gym.Env,
-    policy: Union[AlgoBase, BaseHead],
+    policy: Union[QLearningAlgoBase, BaseHead],
     n_trajectories: int = 100,
     step_per_trajectory: Optional[int] = None,
     evaluate_on_stationary_distribution: bool = False,
     gamma: float = 1.0,
     alphas: Optional[Union[np.ndarray, float]] = None,
     use_custom_reward_scale: bool = False,
     scale_min: Optional[float] = None,
@@ -1026,15 +1026,15 @@
     """Calculate the conditional value at risk (CVaR) of the on-policy policy value.
 
     Parameters
     -------
     env: gym.Env
         Reinforcement learning (RL) environment.
 
-    policy: {AlgoBase, BaseHead}
+    policy: {QLearningAlgoBase, BaseHead}
         A policy to be evaluated.
 
     n_trajectories: int, default=100 (> 0)
         Number of trajectories to rollout.
 
     step_per_trajectory: int, default=None (> 0)
         Number of timesteps in an trajectory.
@@ -1163,15 +1163,15 @@
             ).sum()
 
     return cvar
 
 
 def calc_on_policy_interquartile_range(
     env: gym.Env,
-    policy: Union[AlgoBase, BaseHead],
+    policy: Union[QLearningAlgoBase, BaseHead],
     n_trajectories: int = 100,
     step_per_trajectory: Optional[int] = None,
     evaluate_on_stationary_distribution: bool = False,
     gamma: float = 1.0,
     alpha: float = 0.05,
     use_custom_reward_scale: bool = False,
     scale_min: Optional[float] = None,
@@ -1180,15 +1180,15 @@
     random_state: Optional[int] = None,
 ):
     """Calculate the interquartile range of the on-policy policy value.
 
     env: gym.Env
         Reinforcement learning (RL) environment.
 
-    policy: {AlgoBase, BaseHead}
+    policy: {QLearningAlgoBase, BaseHead}
         A policy to be evaluated.
 
     n_trajectories: int, default=100 (> 0)
         Number of trajectories to rollout.
 
     step_per_trajectory: int, default=None (> 0)
         Number of timesteps in an trajectory.
@@ -1302,15 +1302,15 @@
     }
 
     return interquartile_range_dict
 
 
 def calc_on_policy_cumulative_distribution_function(
     env: gym.Env,
-    policy: Union[AlgoBase, BaseHead],
+    policy: Union[QLearningAlgoBase, BaseHead],
     n_trajectories: int = 100,
     step_per_trajectory: Optional[int] = None,
     evaluate_on_stationary_distribution: bool = False,
     gamma: float = 1.0,
     use_custom_reward_scale: bool = False,
     scale_min: Optional[float] = None,
     scale_max: Optional[float] = None,
@@ -1320,15 +1320,15 @@
     """Calculate the cumulative distribution of the on-policy policy value.
 
     Parameters
     -------
     env: gym.Env
         Reinforcement learning (RL) environment.
 
-    policy: {AlgoBase, BaseHead}
+    policy: {QLearningAlgoBase, BaseHead}
         A policy to be evaluated.
 
     n_trajectories: int, default=100 (> 0)
         Number of trajectories to rollout.
 
     step_per_trajectory: int, default=None (> 0)
         Number of timesteps in an trajectory.
@@ -1424,29 +1424,29 @@
 
     cumulative_distribution_function = np.insert(density, 0, 0).cumsum()
     return cumulative_distribution_function, reward_scale
 
 
 def rollout_policy_online(
     env: gym.Env,
-    policy: Union[AlgoBase, BaseHead],
+    policy: Union[QLearningAlgoBase, BaseHead],
     n_trajectories: int = 100,
     step_per_trajectory: Optional[int] = None,
     evaluate_on_stationary_distribution: bool = False,
     gamma: float = 1.0,
     random_state: Optional[int] = None,
 ):
     """Rollout a given policy on the environment and generate trajectory-wise rewards under the policy online.
 
     Parameters
     -------
     env: gym.Env
         Reinforcement learning (RL) environment.
 
-    policy: {AlgoBase, BaseHead}
+    policy: {QLearningAlgoBase, BaseHead}
         A policy to be evaluated.
 
     n_trajectories: int, default=100 (> 0)
         Number of trajectories to rollout.
 
     step_per_trajectory: int, default=None (> 0)
         Number of timesteps in an trajectory.
@@ -1468,16 +1468,18 @@
         Trajectory-wise on-policy policy values.
 
     """
     if not isinstance(env, gym.Env):
         raise ValueError(
             "env must be a child class of gym.Env",
         )
-    if not isinstance(policy, (AlgoBase, BaseHead)):
-        raise ValueError("policy must be a child class of either AlgoBase or BaseHead")
+    if not isinstance(policy, (QLearningAlgoBase, BaseHead)):
+        raise ValueError(
+            "policy must be a child class of either QLearningAlgoBase or BaseHead"
+        )
     check_scalar(
         n_trajectories,
         name="n_trajectories",
         target_type=int,
         min_val=1,
     )
     check_scalar(
```

### Comparing `scope-rl-0.1.3/scope_rl/ope/ope.py` & `scope-rl-0.2.1/scope_rl/ope/ope.py`

 * *Files 0% similar despite different names*

```diff
@@ -253,18099 +253,18086 @@
 00000fc0: 6e65 6365 7373 6172 7920 6d6f 6475 6c65  necessary module
 00000fd0: 2066 726f 6d20 6f74 6865 7220 6c69 6272   from other libr
 00000fe0: 6172 6965 730a 2020 2020 2020 2020 696d  aries.        im
 00000ff0: 706f 7274 2067 796d 0a20 2020 2020 2020  port gym.       
 00001000: 2069 6d70 6f72 7420 7274 6267 796d 0a20   import rtbgym. 
 00001010: 2020 2020 2020 2066 726f 6d20 6433 726c         from d3rl
 00001020: 7079 2e61 6c67 6f73 2069 6d70 6f72 7420  py.algos import 
-00001030: 446f 7562 6c65 4451 4e0a 2020 2020 2020  DoubleDQN.      
-00001040: 2020 6672 6f6d 2064 3372 6c70 792e 6f6e    from d3rlpy.on
-00001050: 6c69 6e65 2e62 7566 6665 7273 2069 6d70  line.buffers imp
-00001060: 6f72 7420 5265 706c 6179 4275 6666 6572  ort ReplayBuffer
-00001070: 0a20 2020 2020 2020 2066 726f 6d20 6433  .        from d3
-00001080: 726c 7079 2e6f 6e6c 696e 652e 6578 706c  rlpy.online.expl
-00001090: 6f72 6572 7320 696d 706f 7274 2043 6f6e  orers import Con
-000010a0: 7374 616e 7445 7073 696c 6f6e 4772 6565  stantEpsilonGree
-000010b0: 6479 0a0a 2020 2020 2020 2020 2320 696e  dy..        # in
-000010c0: 6974 6961 6c69 7a65 2065 6e76 6972 6f6e  itialize environ
-000010d0: 6d65 6e74 0a20 2020 2020 2020 2065 6e76  ment.        env
-000010e0: 203d 2067 796d 2e6d 616b 6528 2252 5442   = gym.make("RTB
-000010f0: 456e 762d 6469 7363 7265 7465 2d76 3022  Env-discrete-v0"
-00001100: 290a 0a20 2020 2020 2020 2023 2066 6f72  )..        # for
-00001110: 2061 7069 2063 6f6d 7061 7469 6269 6c69   api compatibili
-00001120: 7479 2074 6f20 6433 726c 7079 0a20 2020  ty to d3rlpy.   
-00001130: 2020 2020 2066 726f 6d20 7363 6f70 655f       from scope_
-00001140: 726c 2e75 7469 6c73 2069 6d70 6f72 7420  rl.utils import 
-00001150: 4f6c 6447 796d 4150 4957 7261 7070 6572  OldGymAPIWrapper
-00001160: 0a20 2020 2020 2020 2065 6e76 5f20 3d20  .        env_ = 
-00001170: 4f6c 6447 796d 4150 4957 7261 7070 6572  OldGymAPIWrapper
-00001180: 2865 6e76 290a 0a20 2020 2020 2020 2023  (env)..        #
-00001190: 2064 6566 696e 6520 2852 4c29 2061 6765   define (RL) age
-000011a0: 6e74 2028 692e 652e 2c20 706f 6c69 6379  nt (i.e., policy
-000011b0: 2920 616e 6420 7472 6169 6e20 6f6e 2074  ) and train on t
-000011c0: 6865 2065 6e76 6972 6f6e 6d65 6e74 0a20  he environment. 
-000011d0: 2020 2020 2020 2064 6471 6e20 3d20 446f         ddqn = Do
-000011e0: 7562 6c65 4451 4e28 290a 2020 2020 2020  ubleDQN().      
-000011f0: 2020 6275 6666 6572 203d 2052 6570 6c61    buffer = Repla
-00001200: 7942 7566 6665 7228 0a20 2020 2020 2020  yBuffer(.       
-00001210: 2020 2020 206d 6178 6c65 6e3d 3130 3030       maxlen=1000
-00001220: 302c 0a20 2020 2020 2020 2020 2020 2065  0,.            e
-00001230: 6e76 3d65 6e76 5f2c 0a20 2020 2020 2020  nv=env_,.       
-00001240: 2029 0a20 2020 2020 2020 2065 7870 6c6f   ).        explo
-00001250: 7265 7220 3d20 436f 6e73 7461 6e74 4570  rer = ConstantEp
-00001260: 7369 6c6f 6e47 7265 6564 7928 0a20 2020  silonGreedy(.   
-00001270: 2020 2020 2020 2020 2065 7073 696c 6f6e           epsilon
-00001280: 3d30 2e33 2c0a 2020 2020 2020 2020 290a  =0.3,.        ).
-00001290: 2020 2020 2020 2020 6464 716e 2e66 6974          ddqn.fit
-000012a0: 5f6f 6e6c 696e 6528 0a20 2020 2020 2020  _online(.       
-000012b0: 2020 2020 2065 6e76 3d65 6e76 5f2c 0a20       env=env_,. 
-000012c0: 2020 2020 2020 2020 2020 2062 7566 6665             buffe
-000012d0: 723d 6275 6666 6572 2c0a 2020 2020 2020  r=buffer,.      
-000012e0: 2020 2020 2020 6578 706c 6f72 6572 3d65        explorer=e
-000012f0: 7870 6c6f 7265 722c 0a20 2020 2020 2020  xplorer,.       
-00001300: 2020 2020 206e 5f73 7465 7073 3d31 3030       n_steps=100
-00001310: 3030 2c0a 2020 2020 2020 2020 2020 2020  00,.            
-00001320: 6e5f 7374 6570 735f 7065 725f 6570 6f63  n_steps_per_epoc
-00001330: 683d 3130 3030 2c0a 2020 2020 2020 2020  h=1000,.        
-00001340: 290a 0a20 2020 2020 2020 2023 2063 6f6e  )..        # con
-00001350: 7665 7274 2064 6471 6e20 706f 6c69 6379  vert ddqn policy
-00001360: 2074 6f20 7374 6f63 6861 7374 6963 2064   to stochastic d
-00001370: 6174 6120 636f 6c6c 6563 7469 6f6e 2070  ata collection p
-00001380: 6f6c 6963 790a 2020 2020 2020 2020 6265  olicy.        be
-00001390: 6861 7669 6f72 5f70 6f6c 6963 7920 3d20  havior_policy = 
-000013a0: 4570 7369 6c6f 6e47 7265 6564 7948 6561  EpsilonGreedyHea
-000013b0: 6428 0a20 2020 2020 2020 2020 2020 2064  d(.            d
-000013c0: 6471 6e2c 0a20 2020 2020 2020 2020 2020  dqn,.           
-000013d0: 206e 5f61 6374 696f 6e73 3d65 6e76 2e61   n_actions=env.a
-000013e0: 6374 696f 6e5f 7370 6163 652e 6e2c 0a20  ction_space.n,. 
-000013f0: 2020 2020 2020 2020 2020 2065 7073 696c             epsil
-00001400: 6f6e 3d30 2e33 2c0a 2020 2020 2020 2020  on=0.3,.        
-00001410: 2020 2020 6e61 6d65 3d22 6464 716e 5f65      name="ddqn_e
-00001420: 7073 696c 6f6e 5f30 2e33 222c 0a20 2020  psilon_0.3",.   
-00001430: 2020 2020 2020 2020 2072 616e 646f 6d5f           random_
-00001440: 7374 6174 653d 3132 3334 352c 0a20 2020  state=12345,.   
-00001450: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
-00001460: 2320 696e 6974 6961 6c69 7a65 2064 6174  # initialize dat
-00001470: 6173 6574 2063 6c61 7373 0a20 2020 2020  aset class.     
-00001480: 2020 2064 6174 6173 6574 203d 2053 796e     dataset = Syn
-00001490: 7468 6574 6963 4461 7461 7365 7428 0a20  theticDataset(. 
-000014a0: 2020 2020 2020 2020 2020 2065 6e76 3d65             env=e
-000014b0: 6e76 2c0a 2020 2020 2020 2020 2020 2020  nv,.            
-000014c0: 6d61 785f 6570 6973 6f64 655f 7374 6570  max_episode_step
-000014d0: 733d 656e 762e 7374 6570 5f70 6572 5f65  s=env.step_per_e
-000014e0: 7069 736f 6465 2c0a 2020 2020 2020 2020  pisode,.        
-000014f0: 290a 0a20 2020 2020 2020 2023 2064 6174  )..        # dat
-00001500: 6120 636f 6c6c 6563 7469 6f6e 0a20 2020  a collection.   
-00001510: 2020 2020 206c 6f67 6765 645f 6461 7461       logged_data
-00001520: 7365 7420 3d20 6461 7461 7365 742e 6f62  set = dataset.ob
-00001530: 7461 696e 5f65 7069 736f 6465 7328 0a20  tain_episodes(. 
-00001540: 2020 2020 2020 2020 2020 2062 6568 6176             behav
-00001550: 696f 725f 706f 6c69 6369 6573 3d62 6568  ior_policies=beh
-00001560: 6176 696f 725f 706f 6c69 6379 2c0a 2020  avior_policy,.  
-00001570: 2020 2020 2020 2020 2020 6e5f 7472 616a            n_traj
-00001580: 6563 746f 7269 6573 3d31 3030 2c0a 2020  ectories=100,.  
-00001590: 2020 2020 2020 2020 2020 7261 6e64 6f6d            random
-000015a0: 5f73 7461 7465 3d31 3233 3435 2c0a 2020  _state=12345,.  
-000015b0: 2020 2020 2020 290a 0a20 2020 2043 7265        )..    Cre
-000015c0: 6174 6520 496e 7075 7420 666f 7220 4f50  ate Input for OP
-000015d0: 453a 0a0a 2020 2020 2e2e 2063 6f64 652d  E:..    .. code-
-000015e0: 626c 6f63 6b3a 3a20 7079 7468 6f6e 0a0a  block:: python..
-000015f0: 2020 2020 2020 2020 2320 6576 616c 7561          # evalua
-00001600: 7469 6f6e 2070 6f6c 6963 790a 2020 2020  tion policy.    
-00001610: 2020 2020 6464 716e 5f20 3d20 4570 7369      ddqn_ = Epsi
-00001620: 6c6f 6e47 7265 6564 7948 6561 6428 0a20  lonGreedyHead(. 
-00001630: 2020 2020 2020 2020 2020 2062 6173 655f             base_
-00001640: 706f 6c69 6379 3d64 6471 6e2c 0a20 2020  policy=ddqn,.   
-00001650: 2020 2020 2020 2020 206e 5f61 6374 696f           n_actio
-00001660: 6e73 3d65 6e76 2e61 6374 696f 6e5f 7370  ns=env.action_sp
-00001670: 6163 652e 6e2c 0a20 2020 2020 2020 2020  ace.n,.         
-00001680: 2020 206e 616d 653d 2264 6471 6e22 2c0a     name="ddqn",.
-00001690: 2020 2020 2020 2020 2020 2020 6570 7369              epsi
-000016a0: 6c6f 6e3d 302e 302c 0a20 2020 2020 2020  lon=0.0,.       
-000016b0: 2020 2020 2072 616e 646f 6d5f 7374 6174       random_stat
-000016c0: 653d 3132 3334 350a 2020 2020 2020 2020  e=12345.        
-000016d0: 290a 2020 2020 2020 2020 7261 6e64 6f6d  ).        random
-000016e0: 5f20 3d20 4570 7369 6c6f 6e47 7265 6564  _ = EpsilonGreed
-000016f0: 7948 6561 6428 0a20 2020 2020 2020 2020  yHead(.         
-00001700: 2020 2062 6173 655f 706f 6c69 6379 3d64     base_policy=d
-00001710: 6471 6e2c 0a20 2020 2020 2020 2020 2020  dqn,.           
-00001720: 206e 5f61 6374 696f 6e73 3d65 6e76 2e61   n_actions=env.a
-00001730: 6374 696f 6e5f 7370 6163 652e 6e2c 0a20  ction_space.n,. 
-00001740: 2020 2020 2020 2020 2020 206e 616d 653d             name=
-00001750: 2272 616e 646f 6d22 2c0a 2020 2020 2020  "random",.      
-00001760: 2020 2020 2020 6570 7369 6c6f 6e3d 312e        epsilon=1.
-00001770: 302c 0a20 2020 2020 2020 2020 2020 2072  0,.            r
-00001780: 616e 646f 6d5f 7374 6174 653d 3132 3334  andom_state=1234
-00001790: 350a 2020 2020 2020 2020 290a 0a20 2020  5.        )..   
-000017a0: 2020 2020 2023 2063 7265 6174 6520 696e       # create in
-000017b0: 7075 7420 666f 7220 6f66 662d 706f 6c69  put for off-poli
-000017c0: 6379 2065 7661 6c75 6174 696f 6e20 284f  cy evaluation (O
-000017d0: 5045 290a 2020 2020 2020 2020 7072 6570  PE).        prep
-000017e0: 203d 2043 7265 6174 654f 5045 496e 7075   = CreateOPEInpu
-000017f0: 7428 0a20 2020 2020 2020 2020 2020 2065  t(.            e
-00001800: 6e76 3d65 6e76 2c0a 2020 2020 2020 2020  nv=env,.        
-00001810: 290a 2020 2020 2020 2020 696e 7075 745f  ).        input_
-00001820: 6469 6374 203d 2070 7265 702e 6f62 7461  dict = prep.obta
-00001830: 696e 5f77 686f 6c65 5f69 6e70 7574 7328  in_whole_inputs(
-00001840: 0a20 2020 2020 2020 2020 2020 206c 6f67  .            log
-00001850: 6765 645f 6461 7461 7365 743d 6c6f 6767  ged_dataset=logg
-00001860: 6564 5f64 6174 6173 6574 2c0a 2020 2020  ed_dataset,.    
-00001870: 2020 2020 2020 2020 6576 616c 7561 7469          evaluati
-00001880: 6f6e 5f70 6f6c 6963 6965 733d 5b64 6471  on_policies=[ddq
-00001890: 6e5f 2c20 7261 6e64 6f6d 5f5d 2c0a 2020  n_, random_],.  
-000018a0: 2020 2020 2020 2020 2020 6e5f 7472 616a            n_traj
-000018b0: 6563 746f 7269 6573 5f6f 6e5f 706f 6c69  ectories_on_poli
-000018c0: 6379 5f65 7661 6c75 6174 696f 6e3d 3130  cy_evaluation=10
-000018d0: 302c 0a20 2020 2020 2020 2020 2020 2072  0,.            r
-000018e0: 616e 646f 6d5f 7374 6174 653d 3132 3334  andom_state=1234
-000018f0: 352c 0a20 2020 2020 2020 2029 0a0a 2020  5,.        )..  
-00001900: 2020 2a2a 4f66 662d 506f 6c69 6379 2045    **Off-Policy E
-00001910: 7661 6c75 6174 696f 6e2a 2a3a 0a0a 2020  valuation**:..  
-00001920: 2020 2e2e 2063 6f64 652d 626c 6f63 6b3a    .. code-block:
-00001930: 3a20 7079 7468 6f6e 0a0a 2020 2020 2020  : python..      
-00001940: 2020 2320 4f50 450a 2020 2020 2020 2020    # OPE.        
-00001950: 6f70 6520 3d20 4f50 4528 0a20 2020 2020  ope = OPE(.     
-00001960: 2020 2020 2020 206c 6f67 6765 645f 6461         logged_da
-00001970: 7461 7365 743d 6c6f 6767 6564 5f64 6174  taset=logged_dat
-00001980: 6173 6574 2c0a 2020 2020 2020 2020 2020  aset,.          
-00001990: 2020 6f70 655f 6573 7469 6d61 746f 7273    ope_estimators
-000019a0: 3d5b 5449 5328 292c 2050 4449 5328 295d  =[TIS(), PDIS()]
-000019b0: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
-000019c0: 2020 2020 706f 6c69 6379 5f76 616c 7565      policy_value
-000019d0: 5f64 6963 7420 3d20 6f70 652e 6573 7469  _dict = ope.esti
-000019e0: 6d61 7465 5f70 6f6c 6963 795f 7661 6c75  mate_policy_valu
-000019f0: 6528 0a20 2020 2020 2020 2020 2020 2069  e(.            i
-00001a00: 6e70 7574 5f64 6963 743d 696e 7075 745f  nput_dict=input_
-00001a10: 6469 6374 2c0a 2020 2020 2020 2020 290a  dict,.        ).
-00001a20: 0a20 2020 202a 2a4f 7574 7075 742a 2a3a  .    **Output**:
-00001a30: 0a0a 2020 2020 2e2e 2063 6f64 652d 626c  ..    .. code-bl
-00001a40: 6f63 6b3a 3a20 7079 7468 6f6e 0a0a 2020  ock:: python..  
-00001a50: 2020 2020 2020 3e3e 3e20 706f 6c69 6379        >>> policy
-00001a60: 5f76 616c 7565 5f64 6963 740a 0a20 2020  _value_dict..   
-00001a70: 2020 2020 207b 2764 6471 6e27 3a20 7b27       {'ddqn': {'
-00001a80: 6f6e 5f70 6f6c 6963 7927 3a20 3135 2e39  on_policy': 15.9
-00001a90: 352c 2027 7469 7327 3a20 3138 2e31 3033  5, 'tis': 18.103
-00001aa0: 3830 3936 3537 3437 3437 3032 2c20 2770  809657474702, 'p
-00001ab0: 6469 7327 3a20 3136 2e39 3533 3134 3036  dis': 16.9531406
-00001ac0: 3531 3932 3035 337d 2c0a 2020 2020 2020  5192053},.      
-00001ad0: 2020 2772 616e 646f 6d27 3a20 7b27 6f6e    'random': {'on
-00001ae0: 5f70 6f6c 6963 7927 3a20 3132 2e36 392c  _policy': 12.69,
-00001af0: 2027 7469 7327 3a20 302e 3438 3835 3638   'tis': 0.488568
-00001b00: 3531 3437 3538 3433 3531 2c20 2770 6469  5147584351, 'pdi
-00001b10: 7327 3a20 362e 3237 3532 3536 3835 3437  s': 6.2752568547
-00001b20: 3730 3133 3335 7d7d 0a0a 2020 2020 2e2e  701335}}..    ..
-00001b30: 2073 6565 616c 736f 3a3a 0a0a 2020 2020   seealso::..    
-00001b40: 2020 2020 2a20 3a64 6f63 3a60 5175 6963      * :doc:`Quic
-00001b50: 6b73 7461 7274 203c 2f64 6f63 756d 656e  kstart </documen
-00001b60: 7461 7469 6f6e 2f71 7569 636b 7374 6172  tation/quickstar
-00001b70: 743e 600a 2020 2020 2020 2020 2a20 3a64  t>`.        * :d
-00001b80: 6f63 3a60 5265 6c61 7465 6420 7475 746f  oc:`Related tuto
-00001b90: 7269 616c 7320 3c2f 646f 6375 6d65 6e74  rials </document
-00001ba0: 6174 696f 6e2f 6578 616d 706c 6573 2f62  ation/examples/b
-00001bb0: 6173 6963 5f6f 7065 3e60 0a0a 2020 2020  asic_ope>`..    
-00001bc0: 2222 220a 0a20 2020 206c 6f67 6765 645f  """..    logged_
-00001bd0: 6461 7461 7365 743a 2055 6e69 6f6e 5b4c  dataset: Union[L
-00001be0: 6f67 6765 6444 6174 6173 6574 2c20 4d75  oggedDataset, Mu
-00001bf0: 6c74 6970 6c65 4c6f 6767 6564 4461 7461  ltipleLoggedData
-00001c00: 7365 745d 0a20 2020 206f 7065 5f65 7374  set].    ope_est
-00001c10: 696d 6174 6f72 733a 204c 6973 745b 4261  imators: List[Ba
-00001c20: 7365 4f66 6650 6f6c 6963 7945 7374 696d  seOffPolicyEstim
-00001c30: 6174 6f72 5d0a 2020 2020 6e5f 7374 6570  ator].    n_step
-00001c40: 5f70 6469 733a 2069 6e74 203d 2030 0a20  _pdis: int = 0. 
-00001c50: 2020 2062 616e 6477 6964 7468 3a20 666c     bandwidth: fl
-00001c60: 6f61 7420 3d20 312e 300a 2020 2020 6163  oat = 1.0.    ac
-00001c70: 7469 6f6e 5f73 6361 6c65 723a 204f 7074  tion_scaler: Opt
-00001c80: 696f 6e61 6c5b 4163 7469 6f6e 5363 616c  ional[ActionScal
-00001c90: 6572 5d20 3d20 4e6f 6e65 0a20 2020 2064  er] = None.    d
-00001ca0: 6973 6162 6c65 5f72 6577 6172 645f 6166  isable_reward_af
-00001cb0: 7465 725f 646f 6e65 3a20 626f 6f6c 203d  ter_done: bool =
-00001cc0: 2054 7275 650a 0a20 2020 2064 6566 205f   True..    def _
-00001cd0: 5f70 6f73 745f 696e 6974 5f5f 2873 656c  _post_init__(sel
-00001ce0: 6629 202d 3e20 4e6f 6e65 3a0a 2020 2020  f) -> None:.    
-00001cf0: 2020 2020 7365 6c66 2e75 7365 5f6d 756c      self.use_mul
-00001d00: 7469 706c 655f 6c6f 6767 6564 5f64 6174  tiple_logged_dat
-00001d10: 6173 6574 203d 2046 616c 7365 0a20 2020  aset = False.   
-00001d20: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
-00001d30: 6365 2873 656c 662e 6c6f 6767 6564 5f64  ce(self.logged_d
-00001d40: 6174 6173 6574 2c20 4d75 6c74 6970 6c65  ataset, Multiple
-00001d50: 4c6f 6767 6564 4461 7461 7365 7429 3a0a  LoggedDataset):.
-00001d60: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00001d70: 2e6d 756c 7469 706c 655f 6c6f 6767 6564  .multiple_logged
-00001d80: 5f64 6174 6173 6574 203d 2073 656c 662e  _dataset = self.
-00001d90: 6c6f 6767 6564 5f64 6174 6173 6574 0a20  logged_dataset. 
-00001da0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00001db0: 6c6f 6767 6564 5f64 6174 6173 6574 203d  logged_dataset =
-00001dc0: 2073 656c 662e 6d75 6c74 6970 6c65 5f6c   self.multiple_l
-00001dd0: 6f67 6765 645f 6461 7461 7365 742e 6765  ogged_dataset.ge
-00001de0: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
-00001df0: 2020 2073 656c 662e 6d75 6c74 6970 6c65     self.multiple
-00001e00: 5f6c 6f67 6765 645f 6461 7461 7365 742e  _logged_dataset.
-00001e10: 6265 6861 7669 6f72 5f70 6f6c 6963 795f  behavior_policy_
-00001e20: 6e61 6d65 735b 305d 2c20 6461 7461 7365  names[0], datase
-00001e30: 745f 6964 3d30 0a20 2020 2020 2020 2020  t_id=0.         
-00001e40: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-00001e50: 2073 656c 662e 7573 655f 6d75 6c74 6970   self.use_multip
-00001e60: 6c65 5f6c 6f67 6765 645f 6461 7461 7365  le_logged_datase
-00001e70: 7420 3d20 5472 7565 0a0a 2020 2020 2020  t = True..      
-00001e80: 2020 6368 6563 6b5f 6c6f 6767 6564 5f64    check_logged_d
-00001e90: 6174 6173 6574 2873 656c 662e 6c6f 6767  ataset(self.logg
-00001ea0: 6564 5f64 6174 6173 6574 290a 2020 2020  ed_dataset).    
-00001eb0: 2020 2020 7365 6c66 2e73 7465 705f 7065      self.step_pe
-00001ec0: 725f 7472 616a 6563 746f 7279 203d 2073  r_trajectory = s
-00001ed0: 656c 662e 6c6f 6767 6564 5f64 6174 6173  elf.logged_datas
-00001ee0: 6574 5b22 7374 6570 5f70 6572 5f74 7261  et["step_per_tra
-00001ef0: 6a65 6374 6f72 7922 5d0a 2020 2020 2020  jectory"].      
-00001f00: 2020 7365 6c66 2e61 6374 696f 6e5f 7479    self.action_ty
-00001f10: 7065 203d 2073 656c 662e 6c6f 6767 6564  pe = self.logged
-00001f20: 5f64 6174 6173 6574 5b22 6163 7469 6f6e  _dataset["action
-00001f30: 5f74 7970 6522 5d0a 0a20 2020 2020 2020  _type"]..       
-00001f40: 2069 6620 6e6f 7420 7365 6c66 2e75 7365   if not self.use
-00001f50: 5f6d 756c 7469 706c 655f 6c6f 6767 6564  _multiple_logged
-00001f60: 5f64 6174 6173 6574 3a0a 2020 2020 2020  _dataset:.      
-00001f70: 2020 2020 2020 7365 6c66 2e5f 7265 6769        self._regi
-00001f80: 7374 6572 5f6c 6f67 6765 645f 6461 7461  ster_logged_data
-00001f90: 7365 7428 290a 0a20 2020 2020 2020 2073  set()..        s
-00001fa0: 656c 662e 6f70 655f 6573 7469 6d61 746f  elf.ope_estimato
-00001fb0: 7273 5f20 3d20 6469 6374 2829 0a20 2020  rs_ = dict().   
-00001fc0: 2020 2020 2066 6f72 2065 7374 696d 6174       for estimat
-00001fd0: 6f72 2069 6e20 7365 6c66 2e6f 7065 5f65  or in self.ope_e
-00001fe0: 7374 696d 6174 6f72 733a 0a20 2020 2020  stimators:.     
-00001ff0: 2020 2020 2020 2073 656c 662e 6f70 655f         self.ope_
-00002000: 6573 7469 6d61 746f 7273 5f5b 6573 7469  estimators_[esti
-00002010: 6d61 746f 722e 6573 7469 6d61 746f 725f  mator.estimator_
-00002020: 6e61 6d65 5d20 3d20 6573 7469 6d61 746f  name] = estimato
-00002030: 720a 0a20 2020 2020 2020 2020 2020 2069  r..            i
-00002040: 6620 6573 7469 6d61 746f 722e 6163 7469  f estimator.acti
-00002050: 6f6e 5f74 7970 6520 213d 2073 656c 662e  on_type != self.
-00002060: 6163 7469 6f6e 5f74 7970 653a 0a20 2020  action_type:.   
-00002070: 2020 2020 2020 2020 2020 2020 2072 6169               rai
-00002080: 7365 2052 756e 7469 6d65 4572 726f 7228  se RuntimeError(
-00002090: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000020a0: 2020 2020 2066 224f 6e65 206f 6620 7468       f"One of th
-000020b0: 6520 6f70 655f 6573 7469 6d61 746f 7273  e ope_estimators
-000020c0: 2c20 7b65 7374 696d 6174 6f72 2e65 7374  , {estimator.est
-000020d0: 696d 6174 6f72 5f6e 616d 657d 2064 6f65  imator_name} doe
-000020e0: 7320 6e6f 7420 6d61 7463 6820 7468 6520  s not match the 
-000020f0: 6163 7469 6f6e 5f74 7970 6520 6f66 206c  action_type of l
-00002100: 6f67 6765 645f 6461 7461 7365 7420 2860  ogged_dataset (`
-00002110: 7b73 656c 662e 6163 7469 6f6e 5f74 7970  {self.action_typ
-00002120: 657d 6029 220a 2020 2020 2020 2020 2020  e}`)".          
-00002130: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-00002140: 2020 2020 2069 6620 6e6f 7420 6973 696e       if not isin
-00002150: 7374 616e 6365 2865 7374 696d 6174 6f72  stance(estimator
-00002160: 2c20 4261 7365 4f66 6650 6f6c 6963 7945  , BaseOffPolicyE
-00002170: 7374 696d 6174 6f72 293a 0a20 2020 2020  stimator):.     
-00002180: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00002190: 2052 756e 7469 6d65 4572 726f 7228 0a20   RuntimeError(. 
-000021a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000021b0: 2020 2066 226f 7065 5f65 7374 696d 6174     f"ope_estimat
-000021c0: 6f72 7320 6d75 7374 2062 6520 6368 696c  ors must be chil
-000021d0: 6420 636c 6173 7365 7320 6f66 2042 6173  d classes of Bas
-000021e0: 654f 6666 506f 6c69 6379 4573 7469 6d61  eOffPolicyEstima
-000021f0: 746f 722c 2062 7574 206f 6e65 206f 6620  tor, but one of 
-00002200: 7468 656d 2c20 7b65 7374 696d 6174 6f72  them, {estimator
-00002210: 2e65 7374 696d 6174 6f72 5f6e 616d 657d  .estimator_name}
-00002220: 2069 7320 6e6f 7422 0a20 2020 2020 2020   is not".       
-00002230: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-00002240: 2020 2020 7365 6c66 2e5f 6573 7469 6d61      self._estima
-00002250: 7465 5f63 6f6e 6669 6465 6e63 655f 696e  te_confidence_in
-00002260: 7465 7276 616c 203d 207b 0a20 2020 2020  terval = {.     
-00002270: 2020 2020 2020 2022 626f 6f74 7374 7261         "bootstra
-00002280: 7022 3a20 6573 7469 6d61 7465 5f63 6f6e  p": estimate_con
-00002290: 6669 6465 6e63 655f 696e 7465 7276 616c  fidence_interval
-000022a0: 5f62 795f 626f 6f74 7374 7261 702c 0a20  _by_bootstrap,. 
-000022b0: 2020 2020 2020 2020 2020 2022 686f 6566             "hoef
-000022c0: 6664 696e 6722 3a20 6573 7469 6d61 7465  fding": estimate
-000022d0: 5f63 6f6e 6669 6465 6e63 655f 696e 7465  _confidence_inte
-000022e0: 7276 616c 5f62 795f 686f 6566 6664 696e  rval_by_hoeffdin
-000022f0: 672c 0a20 2020 2020 2020 2020 2020 2022  g,.            "
-00002300: 6265 726e 7374 6569 6e22 3a20 6573 7469  bernstein": esti
-00002310: 6d61 7465 5f63 6f6e 6669 6465 6e63 655f  mate_confidence_
-00002320: 696e 7465 7276 616c 5f62 795f 656d 7069  interval_by_empi
-00002330: 7269 6361 6c5f 6265 726e 7374 6569 6e2c  rical_bernstein,
-00002340: 0a20 2020 2020 2020 2020 2020 2022 7474  .            "tt
-00002350: 6573 7422 3a20 6573 7469 6d61 7465 5f63  est": estimate_c
-00002360: 6f6e 6669 6465 6e63 655f 696e 7465 7276  onfidence_interv
-00002370: 616c 5f62 795f 745f 7465 7374 2c0a 2020  al_by_t_test,.  
-00002380: 2020 2020 2020 7d0a 0a20 2020 2064 6566        }..    def
-00002390: 205f 6368 6563 6b5f 636f 6d70 6172 6564   _check_compared
-000023a0: 5f65 7374 696d 6174 6f72 7328 0a20 2020  _estimators(.   
-000023b0: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-000023c0: 2020 2063 6f6d 7061 7265 645f 6573 7469     compared_esti
-000023d0: 6d61 746f 7273 3a20 4f70 7469 6f6e 616c  mators: Optional
-000023e0: 5b4c 6973 745b 7374 725d 5d20 3d20 4e6f  [List[str]] = No
-000023f0: 6e65 2c0a 2020 2020 293a 0a20 2020 2020  ne,.    ):.     
-00002400: 2020 2069 6620 636f 6d70 6172 6564 5f65     if compared_e
-00002410: 7374 696d 6174 6f72 7320 6973 204e 6f6e  stimators is Non
-00002420: 653a 0a20 2020 2020 2020 2020 2020 2063  e:.            c
-00002430: 6f6d 7061 7265 645f 6573 7469 6d61 746f  ompared_estimato
-00002440: 7273 203d 2073 656c 662e 6573 7469 6d61  rs = self.estima
-00002450: 746f 7273 5f6e 616d 650a 2020 2020 2020  tors_name.      
-00002460: 2020 656c 6966 206e 6f74 2073 6574 2863    elif not set(c
-00002470: 6f6d 7061 7265 645f 6573 7469 6d61 746f  ompared_estimato
-00002480: 7273 292e 6973 7375 6273 6574 2873 656c  rs).issubset(sel
-00002490: 662e 6573 7469 6d61 746f 7273 5f6e 616d  f.estimators_nam
-000024a0: 6529 3a0a 2020 2020 2020 2020 2020 2020  e):.            
-000024b0: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
-000024c0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-000024d0: 2020 2263 6f6d 7061 7265 645f 6573 7469    "compared_esti
-000024e0: 6d61 746f 7273 206d 7573 7420 6265 2061  mators must be a
-000024f0: 2073 7562 7365 7420 6f66 2073 656c 662e   subset of self.
-00002500: 6573 7469 6d61 746f 7273 5f6e 616d 652c  estimators_name,
-00002510: 2062 7574 2066 6f75 6e64 2046 616c 7365   but found False
-00002520: 2e22 0a20 2020 2020 2020 2020 2020 2029  .".            )
-00002530: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00002540: 636f 6d70 6172 6564 5f65 7374 696d 6174  compared_estimat
-00002550: 6f72 730a 0a20 2020 2064 6566 205f 6368  ors..    def _ch
-00002560: 6563 6b5f 6261 7369 635f 7669 7375 616c  eck_basic_visual
-00002570: 697a 6174 696f 6e5f 696e 7075 7473 280a  ization_inputs(.
-00002580: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-00002590: 2020 2020 2020 6875 653a 2073 7472 2c0a        hue: str,.
-000025a0: 2020 2020 2020 2020 6669 675f 6469 723a          fig_dir:
-000025b0: 204f 7074 696f 6e61 6c5b 5061 7468 5d20   Optional[Path] 
-000025c0: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-000025d0: 6669 675f 6e61 6d65 3a20 4f70 7469 6f6e  fig_name: Option
-000025e0: 616c 5b73 7472 5d20 3d20 4e6f 6e65 2c0a  al[str] = None,.
-000025f0: 2020 2020 293a 0a20 2020 2020 2020 2069      ):.        i
-00002600: 6620 6875 6520 6e6f 7420 696e 205b 2265  f hue not in ["e
-00002610: 7374 696d 6174 6f72 222c 2022 706f 6c69  stimator", "poli
-00002620: 6379 225d 3a0a 2020 2020 2020 2020 2020  cy"]:.          
-00002630: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-00002640: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
-00002650: 2020 2020 6622 6875 6520 6d75 7374 2062      f"hue must b
-00002660: 6520 6569 7468 6572 2060 6573 7469 6d61  e either `estima
-00002670: 746f 7260 206f 7220 6070 6f6c 6963 7960  tor` or `policy`
-00002680: 2c20 6275 7420 7b68 7565 7d20 6973 2067  , but {hue} is g
-00002690: 6976 656e 220a 2020 2020 2020 2020 2020  iven".          
-000026a0: 2020 290a 2020 2020 2020 2020 6966 2066    ).        if f
-000026b0: 6967 5f64 6972 2069 7320 6e6f 7420 4e6f  ig_dir is not No
-000026c0: 6e65 2061 6e64 206e 6f74 2069 7369 6e73  ne and not isins
-000026d0: 7461 6e63 6528 6669 675f 6469 722c 2050  tance(fig_dir, P
-000026e0: 6174 6829 3a0a 2020 2020 2020 2020 2020  ath):.          
-000026f0: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-00002700: 6f72 2866 2266 6967 5f64 6972 206d 7573  or(f"fig_dir mus
-00002710: 7420 6265 2061 2050 6174 682c 2062 7574  t be a Path, but
-00002720: 207b 7479 7065 2866 6967 5f64 6972 297d   {type(fig_dir)}
-00002730: 2069 7320 6769 7665 6e22 290a 2020 2020   is given").    
-00002740: 2020 2020 6966 2066 6967 5f6e 616d 6520      if fig_name 
-00002750: 6973 206e 6f74 204e 6f6e 6520 616e 6420  is not None and 
-00002760: 6e6f 7420 6973 696e 7374 616e 6365 2866  not isinstance(f
-00002770: 6967 5f6e 616d 652c 2073 7472 293a 0a20  ig_name, str):. 
-00002780: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00002790: 2056 616c 7565 4572 726f 7228 6622 6669   ValueError(f"fi
-000027a0: 675f 6469 7220 6d75 7374 2062 6520 6120  g_dir must be a 
-000027b0: 7374 7269 6e67 2c20 6275 7420 7b74 7970  string, but {typ
-000027c0: 6528 6669 675f 6469 7229 7d20 6973 2067  e(fig_dir)} is g
-000027d0: 6976 656e 2229 0a0a 2020 2020 6465 6620  iven")..    def 
-000027e0: 5f72 6567 6973 7465 725f 6c6f 6767 6564  _register_logged
-000027f0: 5f64 6174 6173 6574 280a 2020 2020 2020  _dataset(.      
-00002800: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-00002810: 6265 6861 7669 6f72 5f70 6f6c 6963 795f  behavior_policy_
-00002820: 6e61 6d65 3a20 4f70 7469 6f6e 616c 5b73  name: Optional[s
-00002830: 7472 5d20 3d20 4e6f 6e65 2c0a 2020 2020  tr] = None,.    
-00002840: 2020 2020 6461 7461 7365 745f 6964 3a20      dataset_id: 
-00002850: 4f70 7469 6f6e 616c 5b69 6e74 5d20 3d20  Optional[int] = 
-00002860: 4e6f 6e65 2c0a 2020 2020 293a 0a20 2020  None,.    ):.   
-00002870: 2020 2020 2069 6620 6265 6861 7669 6f72       if behavior
-00002880: 5f70 6f6c 6963 795f 6e61 6d65 2069 7320  _policy_name is 
-00002890: 6e6f 7420 4e6f 6e65 2061 6e64 2064 6174  not None and dat
-000028a0: 6173 6574 5f69 6420 6973 206e 6f74 204e  aset_id is not N
-000028b0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-000028c0: 2073 656c 662e 6c6f 6767 6564 5f64 6174   self.logged_dat
-000028d0: 6173 6574 203d 2073 656c 662e 6d75 6c74  aset = self.mult
-000028e0: 6970 6c65 5f6c 6f67 6765 645f 6461 7461  iple_logged_data
-000028f0: 7365 742e 6765 7428 0a20 2020 2020 2020  set.get(.       
-00002900: 2020 2020 2020 2020 2062 6568 6176 696f           behavio
-00002910: 725f 706f 6c69 6379 5f6e 616d 653d 6265  r_policy_name=be
-00002920: 6861 7669 6f72 5f70 6f6c 6963 795f 6e61  havior_policy_na
-00002930: 6d65 2c20 6461 7461 7365 745f 6964 3d64  me, dataset_id=d
-00002940: 6174 6173 6574 5f69 640a 2020 2020 2020  ataset_id.      
-00002950: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-00002960: 2073 656c 662e 6265 6861 7669 6f72 5f70   self.behavior_p
-00002970: 6f6c 6963 795f 7265 7761 7264 203d 2073  olicy_reward = s
-00002980: 656c 662e 6c6f 6767 6564 5f64 6174 6173  elf.logged_datas
-00002990: 6574 5b22 7265 7761 7264 225d 2e72 6573  et["reward"].res
-000029a0: 6861 7065 280a 2020 2020 2020 2020 2020  hape(.          
-000029b0: 2020 282d 312c 2073 656c 662e 7374 6570    (-1, self.step
-000029c0: 5f70 6572 5f74 7261 6a65 6374 6f72 7929  _per_trajectory)
-000029d0: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-000029e0: 2020 2020 6966 2073 656c 662e 6469 7361      if self.disa
-000029f0: 626c 655f 7265 7761 7264 5f61 6674 6572  ble_reward_after
-00002a00: 5f64 6f6e 653a 0a20 2020 2020 2020 2020  _done:.         
-00002a10: 2020 2064 6f6e 6520 3d20 7365 6c66 2e6c     done = self.l
-00002a20: 6f67 6765 645f 6461 7461 7365 745b 2264  ogged_dataset["d
-00002a30: 6f6e 6522 5d2e 7265 7368 6170 6528 282d  one"].reshape((-
-00002a40: 312c 2073 656c 662e 7374 6570 5f70 6572  1, self.step_per
-00002a50: 5f74 7261 6a65 6374 6f72 7929 290a 2020  _trajectory)).  
-00002a60: 2020 2020 2020 2020 2020 7365 6c66 2e62            self.b
-00002a70: 6568 6176 696f 725f 706f 6c69 6379 5f72  ehavior_policy_r
-00002a80: 6577 6172 6420 3d20 7365 6c66 2e62 6568  eward = self.beh
-00002a90: 6176 696f 725f 706f 6c69 6379 5f72 6577  avior_policy_rew
-00002aa0: 6172 6420 2a20 280a 2020 2020 2020 2020  ard * (.        
-00002ab0: 2020 2020 2020 2020 3120 2d20 646f 6e65          1 - done
-00002ac0: 0a20 2020 2020 2020 2020 2020 2029 2e63  .            ).c
-00002ad0: 756d 7072 6f64 2861 7869 733d 3129 0a0a  umprod(axis=1)..
-00002ae0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00002af0: 6163 7469 6f6e 5f74 7970 6520 3d3d 2022  action_type == "
-00002b00: 6469 7363 7265 7465 223a 0a20 2020 2020  discrete":.     
-00002b10: 2020 2020 2020 2073 656c 662e 696e 7075         self.inpu
-00002b20: 745f 6469 6374 5f20 3d20 7b0a 2020 2020  t_dict_ = {.    
-00002b30: 2020 2020 2020 2020 2020 2020 2273 7465              "ste
-00002b40: 705f 7065 725f 7472 616a 6563 746f 7279  p_per_trajectory
-00002b50: 223a 2073 656c 662e 7374 6570 5f70 6572  ": self.step_per
-00002b60: 5f74 7261 6a65 6374 6f72 792c 0a20 2020  _trajectory,.   
-00002b70: 2020 2020 2020 2020 2020 2020 2022 6163               "ac
-00002b80: 7469 6f6e 223a 2073 656c 662e 6c6f 6767  tion": self.logg
-00002b90: 6564 5f64 6174 6173 6574 5b22 6163 7469  ed_dataset["acti
-00002ba0: 6f6e 225d 2e61 7374 7970 6528 696e 7429  on"].astype(int)
-00002bb0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00002bc0: 2020 2272 6577 6172 6422 3a20 7365 6c66    "reward": self
-00002bd0: 2e62 6568 6176 696f 725f 706f 6c69 6379  .behavior_policy
-00002be0: 5f72 6577 6172 642e 666c 6174 7465 6e28  _reward.flatten(
-00002bf0: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-00002c00: 2020 2022 646f 6e65 223a 2073 656c 662e     "done": self.
-00002c10: 6c6f 6767 6564 5f64 6174 6173 6574 5b22  logged_dataset["
-00002c20: 646f 6e65 225d 2c0a 2020 2020 2020 2020  done"],.        
-00002c30: 2020 2020 2020 2020 2270 7363 6f72 6522          "pscore"
-00002c40: 3a20 7365 6c66 2e6c 6f67 6765 645f 6461  : self.logged_da
-00002c50: 7461 7365 745b 2270 7363 6f72 6522 5d2c  taset["pscore"],
-00002c60: 0a20 2020 2020 2020 2020 2020 207d 0a20  .            }. 
-00002c70: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00002c80: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
-00002c90: 2e61 6374 696f 6e5f 7363 616c 6572 2069  .action_scaler i
-00002ca0: 7320 6e6f 7420 4e6f 6e65 2061 6e64 206e  s not None and n
-00002cb0: 6f74 2069 7369 6e73 7461 6e63 6528 0a20  ot isinstance(. 
-00002cc0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00002cd0: 656c 662e 6163 7469 6f6e 5f73 6361 6c65  elf.action_scale
-00002ce0: 722c 2041 6374 696f 6e53 6361 6c65 720a  r, ActionScaler.
-00002cf0: 2020 2020 2020 2020 2020 2020 293a 0a20              ):. 
-00002d00: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00002d10: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-00002d20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00002d30: 2020 2020 2022 6163 7469 6f6e 5f73 6361       "action_sca
-00002d40: 6c65 7220 6d75 7374 2062 6520 616e 2069  ler must be an i
-00002d50: 6e73 7461 6e63 6520 6f66 2064 3372 6c70  nstance of d3rlp
-00002d60: 792e 7072 6570 726f 6365 7373 696e 672e  y.preprocessing.
-00002d70: 4163 7469 6f6e 5363 616c 6572 2c20 6275  ActionScaler, bu
-00002d80: 7420 666f 756e 6420 4661 6c73 6522 0a20  t found False". 
-00002d90: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-00002da0: 0a20 2020 2020 2020 2020 2020 2063 6865  .            che
-00002db0: 636b 5f73 6361 6c61 7228 0a20 2020 2020  ck_scalar(.     
-00002dc0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00002dd0: 6261 6e64 7769 6474 682c 206e 616d 653d  bandwidth, name=
-00002de0: 2262 616e 6477 6964 7468 222c 2074 6172  "bandwidth", tar
-00002df0: 6765 745f 7479 7065 3d66 6c6f 6174 2c20  get_type=float, 
-00002e00: 6d69 6e5f 7661 6c3d 302e 300a 2020 2020  min_val=0.0.    
-00002e10: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
-00002e20: 2020 2020 2020 2073 656c 662e 696e 7075         self.inpu
-00002e30: 745f 6469 6374 5f20 3d20 7b0a 2020 2020  t_dict_ = {.    
-00002e40: 2020 2020 2020 2020 2020 2020 2273 7465              "ste
-00002e50: 705f 7065 725f 7472 616a 6563 746f 7279  p_per_trajectory
-00002e60: 223a 2073 656c 662e 7374 6570 5f70 6572  ": self.step_per
-00002e70: 5f74 7261 6a65 6374 6f72 792c 0a20 2020  _trajectory,.   
-00002e80: 2020 2020 2020 2020 2020 2020 2022 6163               "ac
-00002e90: 7469 6f6e 223a 2073 656c 662e 6c6f 6767  tion": self.logg
-00002ea0: 6564 5f64 6174 6173 6574 5b22 6163 7469  ed_dataset["acti
-00002eb0: 6f6e 225d 2e61 7374 7970 6528 696e 7429  on"].astype(int)
-00002ec0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00002ed0: 2020 2272 6577 6172 6422 3a20 7365 6c66    "reward": self
-00002ee0: 2e62 6568 6176 696f 725f 706f 6c69 6379  .behavior_policy
-00002ef0: 5f72 6577 6172 642e 666c 6174 7465 6e28  _reward.flatten(
-00002f00: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-00002f10: 2020 2022 646f 6e65 223a 2073 656c 662e     "done": self.
-00002f20: 6c6f 6767 6564 5f64 6174 6173 6574 5b22  logged_dataset["
-00002f30: 646f 6e65 225d 2c0a 2020 2020 2020 2020  done"],.        
-00002f40: 2020 2020 2020 2020 2270 7363 6f72 6522          "pscore"
-00002f50: 3a20 7365 6c66 2e6c 6f67 6765 645f 6461  : self.logged_da
-00002f60: 7461 7365 745b 2270 7363 6f72 6522 5d2c  taset["pscore"],
-00002f70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00002f80: 2022 6163 7469 6f6e 5f73 6361 6c65 7222   "action_scaler"
-00002f90: 3a20 7365 6c66 2e61 6374 696f 6e5f 7363  : self.action_sc
-00002fa0: 616c 6572 2c0a 2020 2020 2020 2020 2020  aler,.          
-00002fb0: 2020 2020 2020 2262 616e 6477 6964 7468        "bandwidth
-00002fc0: 223a 2073 656c 662e 6261 6e64 7769 6474  ": self.bandwidt
-00002fd0: 682c 0a20 2020 2020 2020 2020 2020 207d  h,.            }
-00002fe0: 0a0a 2020 2020 6465 6620 5f65 7374 696d  ..    def _estim
-00002ff0: 6174 655f 706f 6c69 6379 5f76 616c 7565  ate_policy_value
-00003000: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
-00003010: 2020 2020 2020 2020 696e 7075 745f 6469          input_di
-00003020: 6374 3a20 4f50 4549 6e70 7574 4469 6374  ct: OPEInputDict
-00003030: 2c0a 2020 2020 2020 2020 636f 6d70 6172  ,.        compar
-00003040: 6564 5f65 7374 696d 6174 6f72 733a 204f  ed_estimators: O
-00003050: 7074 696f 6e61 6c5b 4c69 7374 5b73 7472  ptional[List[str
-00003060: 5d5d 203d 204e 6f6e 652c 0a20 2020 2029  ]] = None,.    )
-00003070: 202d 3e20 4469 6374 5b73 7472 2c20 666c   -> Dict[str, fl
-00003080: 6f61 745d 3a0a 2020 2020 2020 2020 2222  oat]:.        ""
-00003090: 2245 7374 696d 6174 6520 7468 6520 706f  "Estimate the po
-000030a0: 6c69 6379 2076 616c 7565 206f 6620 7468  licy value of th
-000030b0: 6520 6769 7665 6e20 6576 616c 7561 7469  e given evaluati
-000030c0: 6f6e 2070 6f6c 6963 6965 732e 0a0a 2020  on policies...  
-000030d0: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
-000030e0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-000030f0: 0a20 2020 2020 2020 2069 6e70 7574 5f64  .        input_d
-00003100: 6963 743a 204f 5045 496e 7075 7444 6963  ict: OPEInputDic
-00003110: 740a 2020 2020 2020 2020 2020 2020 4469  t.            Di
-00003120: 6374 696f 6e61 7279 206f 6620 7468 6520  ctionary of the 
-00003130: 4f50 4520 696e 7075 7473 2066 6f72 2065  OPE inputs for e
-00003140: 6163 6820 6576 616c 7561 7469 6f6e 2070  ach evaluation p
-00003150: 6f6c 6963 792e 0a0a 2020 2020 2020 2020  olicy...        
-00003160: 2020 2020 2e2e 2063 6f64 652d 626c 6f63      .. code-bloc
-00003170: 6b3a 3a20 7079 7468 6f6e 0a0a 2020 2020  k:: python..    
-00003180: 2020 2020 2020 2020 2020 2020 6b65 793a              key:
-00003190: 205b 6576 616c 7561 7469 6f6e 5f70 6f6c   [evaluation_pol
-000031a0: 6963 795d 5b0a 2020 2020 2020 2020 2020  icy][.          
-000031b0: 2020 2020 2020 2020 2020 6576 616c 7561            evalua
-000031c0: 7469 6f6e 5f70 6f6c 6963 795f 6163 7469  tion_policy_acti
-000031d0: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
-000031e0: 2020 2020 2020 2020 6576 616c 7561 7469          evaluati
-000031f0: 6f6e 5f70 6f6c 6963 795f 6163 7469 6f6e  on_policy_action
-00003200: 5f64 6973 742c 0a20 2020 2020 2020 2020  _dist,.         
-00003210: 2020 2020 2020 2020 2020 2073 7461 7465             state
-00003220: 5f61 6374 696f 6e5f 7661 6c75 655f 7072  _action_value_pr
-00003230: 6564 6963 7469 6f6e 2c0a 2020 2020 2020  ediction,.      
-00003240: 2020 2020 2020 2020 2020 2020 2020 696e                in
-00003250: 6974 6961 6c5f 7374 6174 655f 7661 6c75  itial_state_valu
-00003260: 655f 7072 6564 6963 7469 6f6e 2c0a 2020  e_prediction,.  
-00003270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003280: 2020 7374 6174 655f 6163 7469 6f6e 5f6d    state_action_m
-00003290: 6172 6769 6e61 6c5f 696d 706f 7274 616e  arginal_importan
-000032a0: 6365 5f77 6569 6768 742c 0a20 2020 2020  ce_weight,.     
-000032b0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-000032c0: 7461 7465 5f6d 6172 6769 6e61 6c5f 696d  tate_marginal_im
-000032d0: 706f 7274 616e 6365 5f77 6569 6768 742c  portance_weight,
-000032e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000032f0: 2020 2020 206f 6e5f 706f 6c69 6379 5f70       on_policy_p
-00003300: 6f6c 6963 795f 7661 6c75 652c 0a20 2020  olicy_value,.   
-00003310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003320: 2067 616d 6d61 2c0a 2020 2020 2020 2020   gamma,.        
-00003330: 2020 2020 2020 2020 2020 2020 6265 6861              beha
-00003340: 7669 6f72 5f70 6f6c 6963 792c 0a20 2020  vior_policy,.   
-00003350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003360: 2065 7661 6c75 6174 696f 6e5f 706f 6c69   evaluation_poli
-00003370: 6379 2c0a 2020 2020 2020 2020 2020 2020  cy,.            
-00003380: 2020 2020 2020 2020 6461 7461 7365 745f          dataset_
-00003390: 6964 2c0a 2020 2020 2020 2020 2020 2020  id,.            
-000033a0: 2020 2020 5d0a 0a20 2020 2020 2020 2020      ]..         
-000033b0: 2020 202e 2e20 7365 6561 6c73 6f3a 3a0a     .. seealso::.
-000033c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000033d0: 203a 636c 6173 733a 6073 636f 7065 5f72   :class:`scope_r
-000033e0: 6c2e 6f70 652e 696e 7075 742e 4372 6561  l.ope.input.Crea
-000033f0: 7465 4f50 4549 6e70 7574 6020 6465 7363  teOPEInput` desc
-00003400: 7269 6265 7320 7468 6520 636f 6d70 6f6e  ribes the compon
-00003410: 656e 7473 206f 6620 3a63 6c61 7373 3a60  ents of :class:`
-00003420: 696e 7075 745f 6469 6374 602e 0a0a 2020  input_dict`...  
-00003430: 2020 2020 2020 636f 6d70 6172 6564 5f65        compared_e
-00003440: 7374 696d 6174 6f72 733a 206c 6973 7420  stimators: list 
-00003450: 6f66 2073 7472 2c20 6465 6661 756c 743d  of str, default=
-00003460: 4e6f 6e65 0a20 2020 2020 2020 2020 2020  None.           
-00003470: 204e 616d 6520 6f66 2063 6f6d 7061 7265   Name of compare
-00003480: 6420 6573 7469 6d61 746f 7273 2e0a 2020  d estimators..  
-00003490: 2020 2020 2020 2020 2020 4966 2060 4e6f            If `No
-000034a0: 6e65 6020 6973 2067 6976 656e 2c20 616c  ne` is given, al
-000034b0: 6c20 7468 6520 6573 7469 6d61 746f 7273  l the estimators
-000034c0: 2061 7265 2063 6f6d 7061 7265 642e 0a0a   are compared...
-000034d0: 2020 2020 2020 2020 5265 7475 726e 0a20          Return. 
-000034e0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0a20         -------. 
-000034f0: 2020 2020 2020 2070 6f6c 6963 795f 7661         policy_va
-00003500: 6c75 655f 6469 6374 3a20 6469 6374 0a20  lue_dict: dict. 
-00003510: 2020 2020 2020 2020 2020 2044 6963 7469             Dicti
-00003520: 6f6e 6172 7920 636f 6e74 6169 6e69 6e67  onary containing
-00003530: 2074 6865 2070 6f6c 6963 7920 7661 6c75   the policy valu
-00003540: 6520 6f66 2065 6163 6820 6576 616c 7561  e of each evalua
-00003550: 7469 6f6e 2070 6f6c 6963 7920 6573 7469  tion policy esti
-00003560: 6d61 7465 6420 6279 204f 5045 2065 7374  mated by OPE est
-00003570: 696d 6174 6f72 732e 0a20 2020 2020 2020  imators..       
-00003580: 2020 2020 206b 6579 3a20 3a63 6c61 7373       key: :class
-00003590: 3a60 5b65 7661 6c75 6174 696f 6e5f 706f  :`[evaluation_po
-000035a0: 6c69 6379 5d5b 4f50 455f 6573 7469 6d61  licy][OPE_estima
-000035b0: 746f 725f 6e61 6d65 5d60 0a0a 2020 2020  tor_name]`..    
-000035c0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-000035d0: 6368 6563 6b5f 696e 7075 745f 6469 6374  check_input_dict
-000035e0: 2869 6e70 7574 5f64 6963 7429 0a0a 2020  (input_dict)..  
-000035f0: 2020 2020 2020 706f 6c69 6379 5f76 616c        policy_val
-00003600: 7565 5f64 6963 7420 3d20 6465 6661 756c  ue_dict = defaul
-00003610: 7464 6963 7428 6469 6374 290a 2020 2020  tdict(dict).    
-00003620: 2020 2020 666f 7220 6576 616c 5f70 6f6c      for eval_pol
-00003630: 6963 7920 696e 2069 6e70 7574 5f64 6963  icy in input_dic
-00003640: 742e 6b65 7973 2829 3a0a 2020 2020 2020  t.keys():.      
-00003650: 2020 2020 2020 6966 2069 6e70 7574 5f64        if input_d
-00003660: 6963 745b 6576 616c 5f70 6f6c 6963 795d  ict[eval_policy]
-00003670: 5b22 6f6e 5f70 6f6c 6963 795f 706f 6c69  ["on_policy_poli
-00003680: 6379 5f76 616c 7565 225d 2069 7320 6e6f  cy_value"] is no
-00003690: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-000036a0: 2020 2020 2020 2020 706f 6c69 6379 5f76          policy_v
-000036b0: 616c 7565 5f64 6963 745b 6576 616c 5f70  alue_dict[eval_p
-000036c0: 6f6c 6963 795d 5b22 6f6e 5f70 6f6c 6963  olicy]["on_polic
-000036d0: 7922 5d20 3d20 696e 7075 745f 6469 6374  y"] = input_dict
-000036e0: 5b65 7661 6c5f 706f 6c69 6379 5d5b 0a20  [eval_policy][. 
-000036f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003700: 2020 2022 6f6e 5f70 6f6c 6963 795f 706f     "on_policy_po
-00003710: 6c69 6379 5f76 616c 7565 220a 2020 2020  licy_value".    
-00003720: 2020 2020 2020 2020 2020 2020 5d2e 6d65              ].me
-00003730: 616e 2829 0a20 2020 2020 2020 2020 2020  an().           
-00003740: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00003750: 2020 2020 2020 2070 6f6c 6963 795f 7661         policy_va
-00003760: 6c75 655f 6469 6374 5b65 7661 6c5f 706f  lue_dict[eval_po
-00003770: 6c69 6379 5d5b 226f 6e5f 706f 6c69 6379  licy]["on_policy
-00003780: 225d 203d 204e 6f6e 650a 0a20 2020 2020  "] = None..     
-00003790: 2020 2020 2020 2066 6f72 2065 7374 696d         for estim
-000037a0: 6174 6f72 5f6e 616d 6520 696e 2063 6f6d  ator_name in com
-000037b0: 7061 7265 645f 6573 7469 6d61 746f 7273  pared_estimators
-000037c0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000037d0: 2020 6573 7469 6d61 746f 7220 3d20 7365    estimator = se
-000037e0: 6c66 2e6f 7065 5f65 7374 696d 6174 6f72  lf.ope_estimator
-000037f0: 735f 5b65 7374 696d 6174 6f72 5f6e 616d  s_[estimator_nam
-00003800: 655d 0a20 2020 2020 2020 2020 2020 2020  e].             
-00003810: 2020 2070 6f6c 6963 795f 7661 6c75 655f     policy_value_
-00003820: 6469 6374 5b65 7661 6c5f 706f 6c69 6379  dict[eval_policy
-00003830: 5d5b 0a20 2020 2020 2020 2020 2020 2020  ][.             
-00003840: 2020 2020 2020 2065 7374 696d 6174 6f72         estimator
-00003850: 5f6e 616d 650a 2020 2020 2020 2020 2020  _name.          
-00003860: 2020 2020 2020 5d20 3d20 6573 7469 6d61        ] = estima
-00003870: 746f 722e 6573 7469 6d61 7465 5f70 6f6c  tor.estimate_pol
-00003880: 6963 795f 7661 6c75 6528 0a20 2020 2020  icy_value(.     
-00003890: 2020 2020 2020 2020 2020 2020 2020 202a                 *
-000038a0: 2a69 6e70 7574 5f64 6963 745b 6576 616c  *input_dict[eval
-000038b0: 5f70 6f6c 6963 795d 2c0a 2020 2020 2020  _policy],.      
-000038c0: 2020 2020 2020 2020 2020 2020 2020 2a2a                **
-000038d0: 7365 6c66 2e69 6e70 7574 5f64 6963 745f  self.input_dict_
-000038e0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000038f0: 2020 2020 2020 6e5f 7374 6570 5f70 6469        n_step_pdi
-00003900: 733d 7365 6c66 2e6e 5f73 7465 705f 7064  s=self.n_step_pd
-00003910: 6973 2c0a 2020 2020 2020 2020 2020 2020  is,.            
-00003920: 2020 2020 2020 2020 6469 7361 626c 655f          disable_
-00003930: 7265 7761 7264 5f61 6674 6572 5f64 6f6e  reward_after_don
-00003940: 653d 7365 6c66 2e64 6973 6162 6c65 5f72  e=self.disable_r
-00003950: 6577 6172 645f 6166 7465 725f 646f 6e65  eward_after_done
-00003960: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00003970: 2020 290a 2020 2020 2020 2020 7265 7475    ).        retu
-00003980: 726e 2064 6566 6175 6c74 6469 6374 5f74  rn defaultdict_t
-00003990: 6f5f 6469 6374 2870 6f6c 6963 795f 7661  o_dict(policy_va
-000039a0: 6c75 655f 6469 6374 290a 0a20 2020 2064  lue_dict)..    d
-000039b0: 6566 205f 6573 7469 6d61 7465 5f69 6e74  ef _estimate_int
-000039c0: 6572 7661 6c73 280a 2020 2020 2020 2020  ervals(.        
-000039d0: 7365 6c66 2c0a 2020 2020 2020 2020 696e  self,.        in
-000039e0: 7075 745f 6469 6374 3a20 4f50 4549 6e70  put_dict: OPEInp
-000039f0: 7574 4469 6374 2c0a 2020 2020 2020 2020  utDict,.        
-00003a00: 636f 6d70 6172 6564 5f65 7374 696d 6174  compared_estimat
-00003a10: 6f72 733a 204f 7074 696f 6e61 6c5b 4c69  ors: Optional[Li
-00003a20: 7374 5b73 7472 5d5d 203d 204e 6f6e 652c  st[str]] = None,
-00003a30: 0a20 2020 2020 2020 2061 6c70 6861 3a20  .        alpha: 
-00003a40: 666c 6f61 7420 3d20 302e 3035 2c0a 2020  float = 0.05,.  
-00003a50: 2020 2020 2020 6369 3a20 7374 7220 3d20        ci: str = 
-00003a60: 2262 6f6f 7473 7472 6170 222c 0a20 2020  "bootstrap",.   
-00003a70: 2020 2020 206e 5f62 6f6f 7473 7472 6170       n_bootstrap
-00003a80: 5f73 616d 706c 6573 3a20 696e 7420 3d20  _samples: int = 
-00003a90: 3130 302c 0a20 2020 2020 2020 2072 616e  100,.        ran
-00003aa0: 646f 6d5f 7374 6174 653a 204f 7074 696f  dom_state: Optio
-00003ab0: 6e61 6c5b 696e 745d 203d 204e 6f6e 652c  nal[int] = None,
-00003ac0: 0a20 2020 2029 202d 3e20 4469 6374 5b73  .    ) -> Dict[s
-00003ad0: 7472 2c20 4469 6374 5b73 7472 2c20 666c  tr, Dict[str, fl
-00003ae0: 6f61 745d 5d3a 0a20 2020 2020 2020 2022  oat]]:.        "
-00003af0: 2222 4573 7469 6d61 7465 2074 6865 2063  ""Estimate the c
-00003b00: 6f6e 6669 6465 6e63 6520 696e 7465 7276  onfidence interv
-00003b10: 616c 7320 6f66 2074 6865 2070 6f6c 6963  als of the polic
-00003b20: 7920 7661 6c75 6520 6279 206e 6f6e 7061  y value by nonpa
-00003b30: 7261 6d65 7472 6963 2062 6f6f 7473 7472  rametric bootstr
-00003b40: 6170 2e0a 0a20 2020 2020 2020 2050 6172  ap...        Par
-00003b50: 616d 6574 6572 730a 2020 2020 2020 2020  ameters.        
-00003b60: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-00003b70: 696e 7075 745f 6469 6374 3a20 4f50 4549  input_dict: OPEI
-00003b80: 6e70 7574 4469 6374 0a20 2020 2020 2020  nputDict.       
-00003b90: 2020 2020 2044 6963 7469 6f6e 6172 7920       Dictionary 
-00003ba0: 6f66 2074 6865 204f 5045 2069 6e70 7574  of the OPE input
-00003bb0: 7320 666f 7220 6561 6368 2065 7661 6c75  s for each evalu
-00003bc0: 6174 696f 6e20 706f 6c69 6379 2e0a 0a20  ation policy... 
-00003bd0: 2020 2020 2020 2020 2020 202e 2e20 636f             .. co
-00003be0: 6465 2d62 6c6f 636b 3a3a 2070 7974 686f  de-block:: pytho
-00003bf0: 6e0a 0a20 2020 2020 2020 2020 2020 2020  n..             
-00003c00: 2020 206b 6579 3a20 5b65 7661 6c75 6174     key: [evaluat
-00003c10: 696f 6e5f 706f 6c69 6379 5d5b 0a20 2020  ion_policy][.   
-00003c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003c30: 2065 7661 6c75 6174 696f 6e5f 706f 6c69   evaluation_poli
-00003c40: 6379 5f61 6374 696f 6e2c 0a20 2020 2020  cy_action,.     
-00003c50: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00003c60: 7661 6c75 6174 696f 6e5f 706f 6c69 6379  valuation_policy
-00003c70: 5f61 6374 696f 6e5f 6469 7374 2c0a 2020  _action_dist,.  
-00003c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003c90: 2020 7374 6174 655f 6163 7469 6f6e 5f76    state_action_v
-00003ca0: 616c 7565 5f70 7265 6469 6374 696f 6e2c  alue_prediction,
-00003cb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00003cc0: 2020 2020 2069 6e69 7469 616c 5f73 7461       initial_sta
-00003cd0: 7465 5f76 616c 7565 5f70 7265 6469 6374  te_value_predict
-00003ce0: 696f 6e2c 0a20 2020 2020 2020 2020 2020  ion,.           
-00003cf0: 2020 2020 2020 2020 2073 7461 7465 5f61           state_a
-00003d00: 6374 696f 6e5f 6d61 7267 696e 616c 5f69  ction_marginal_i
-00003d10: 6d70 6f72 7461 6e63 655f 7765 6967 6874  mportance_weight
-00003d20: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00003d30: 2020 2020 2020 7374 6174 655f 6d61 7267        state_marg
-00003d40: 696e 616c 5f69 6d70 6f72 7461 6e63 655f  inal_importance_
-00003d50: 7765 6967 6874 2c0a 2020 2020 2020 2020  weight,.        
-00003d60: 2020 2020 2020 2020 2020 2020 6f6e 5f70              on_p
-00003d70: 6f6c 6963 795f 706f 6c69 6379 5f76 616c  olicy_policy_val
-00003d80: 7565 2c0a 2020 2020 2020 2020 2020 2020  ue,.            
-00003d90: 2020 2020 2020 2020 6761 6d6d 612c 0a20          gamma,. 
-00003da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003db0: 2020 2062 6568 6176 696f 725f 706f 6c69     behavior_poli
-00003dc0: 6379 2c0a 2020 2020 2020 2020 2020 2020  cy,.            
-00003dd0: 2020 2020 2020 2020 6576 616c 7561 7469          evaluati
-00003de0: 6f6e 5f70 6f6c 6963 792c 0a20 2020 2020  on_policy,.     
-00003df0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-00003e00: 6174 6173 6574 5f69 642c 0a20 2020 2020  ataset_id,.     
-00003e10: 2020 2020 2020 2020 2020 205d 0a0a 2020             ]..  
-00003e20: 2020 2020 2020 2020 2020 2e2e 2073 6565            .. see
-00003e30: 616c 736f 3a3a 0a0a 2020 2020 2020 2020  also::..        
-00003e40: 2020 2020 2020 2020 3a63 6c61 7373 3a60          :class:`
-00003e50: 7363 6f70 655f 726c 2e6f 7065 2e69 6e70  scope_rl.ope.inp
-00003e60: 7574 2e43 7265 6174 654f 5045 496e 7075  ut.CreateOPEInpu
-00003e70: 7460 2064 6573 6372 6962 6573 2074 6865  t` describes the
-00003e80: 2063 6f6d 706f 6e65 6e74 7320 6f66 203a   components of :
-00003e90: 636c 6173 733a 6069 6e70 7574 5f64 6963  class:`input_dic
-00003ea0: 7460 2e0a 0a20 2020 2020 2020 2063 6f6d  t`...        com
-00003eb0: 7061 7265 645f 6573 7469 6d61 746f 7273  pared_estimators
-00003ec0: 3a20 6c69 7374 206f 6620 7374 722c 2064  : list of str, d
-00003ed0: 6566 6175 6c74 3d4e 6f6e 650a 2020 2020  efault=None.    
-00003ee0: 2020 2020 2020 2020 4e61 6d65 206f 6620          Name of 
-00003ef0: 636f 6d70 6172 6564 2065 7374 696d 6174  compared estimat
-00003f00: 6f72 732e 0a20 2020 2020 2020 2020 2020  ors..           
-00003f10: 2049 6620 604e 6f6e 6560 2069 7320 6769   If `None` is gi
-00003f20: 7665 6e2c 2061 6c6c 2074 6865 2065 7374  ven, all the est
-00003f30: 696d 6174 6f72 7320 6172 6520 636f 6d70  imators are comp
-00003f40: 6172 6564 2e0a 0a20 2020 2020 2020 2061  ared...        a
-00003f50: 6c70 6861 3a20 666c 6f61 742c 2064 6566  lpha: float, def
-00003f60: 6175 6c74 3d30 2e30 350a 2020 2020 2020  ault=0.05.      
-00003f70: 2020 2020 2020 5369 676e 6966 6963 616e        Significan
-00003f80: 6365 206c 6576 656c 2e20 5468 6520 7661  ce level. The va
-00003f90: 6c75 6520 7368 6f75 6c64 2062 6520 7769  lue should be wi
-00003fa0: 7468 696e 2060 5b30 2c20 3129 602e 0a0a  thin `[0, 1)`...
-00003fb0: 2020 2020 2020 2020 6369 3a20 7b22 626f          ci: {"bo
-00003fc0: 6f74 7374 7261 7022 2c20 2268 6f65 6666  otstrap", "hoeff
-00003fd0: 6469 6e67 222c 2022 6265 726e 7374 6569  ding", "bernstei
-00003fe0: 6e22 2c20 2274 7465 7374 227d 2c20 6465  n", "ttest"}, de
-00003ff0: 6661 756c 743d 2262 6f6f 7473 7472 6170  fault="bootstrap
-00004000: 220a 2020 2020 2020 2020 2020 2020 4d65  ".            Me
-00004010: 7468 6f64 2074 6f20 6573 7469 6d61 7465  thod to estimate
-00004020: 2074 6865 2063 6f6e 6669 6465 6e63 6520   the confidence 
-00004030: 696e 7465 7276 616c 2e0a 0a20 2020 2020  interval...     
-00004040: 2020 206e 5f62 6f6f 7473 7472 6170 5f73     n_bootstrap_s
-00004050: 616d 706c 6573 3a20 696e 742c 2064 6566  amples: int, def
-00004060: 6175 6c74 3d31 3030 2028 3e20 3029 0a20  ault=100 (> 0). 
-00004070: 2020 2020 2020 2020 2020 204e 756d 6265             Numbe
-00004080: 7220 6f66 2072 6573 616d 706c 696e 6720  r of resampling 
-00004090: 7065 7266 6f72 6d65 6420 696e 2074 6865  performed in the
-000040a0: 2062 6f6f 7473 7472 6170 2070 726f 6365   bootstrap proce
-000040b0: 6475 7265 2e0a 0a20 2020 2020 2020 2072  dure...        r
-000040c0: 616e 646f 6d5f 7374 6174 653a 2069 6e74  andom_state: int
-000040d0: 2c20 6465 6661 756c 743d 4e6f 6e65 2028  , default=None (
-000040e0: 3e3d 2030 290a 2020 2020 2020 2020 2020  >= 0).          
-000040f0: 2020 5261 6e64 6f6d 2073 7461 7465 2e0a    Random state..
-00004100: 0a20 2020 2020 2020 2052 6574 7572 6e0a  .        Return.
-00004110: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0a          -------.
-00004120: 2020 2020 2020 2020 706f 6c69 6379 5f76          policy_v
-00004130: 616c 7565 5f69 6e74 6572 7661 6c5f 6469  alue_interval_di
-00004140: 6374 3a20 6469 6374 0a20 2020 2020 2020  ct: dict.       
-00004150: 2020 2020 2044 6963 7469 6f6e 6172 7920       Dictionary 
-00004160: 636f 6e74 6169 6e69 6e67 2074 6865 2063  containing the c
-00004170: 6f6e 6669 6465 6e63 6520 696e 7465 7276  onfidence interv
-00004180: 616c 7320 6573 7469 6d61 7465 6420 6279  als estimated by
-00004190: 206e 6f6e 7061 7261 6d65 7472 6963 2062   nonparametric b
-000041a0: 6f6f 7473 7472 6170 2e0a 2020 2020 2020  ootstrap..      
-000041b0: 2020 2020 2020 6b65 793a 203a 636c 6173        key: :clas
-000041c0: 733a 605b 6576 616c 7561 7469 6f6e 5f70  s:`[evaluation_p
-000041d0: 6f6c 6963 795d 5b4f 5045 5f65 7374 696d  olicy][OPE_estim
-000041e0: 6174 6f72 5f6e 616d 655d 600a 0a20 2020  ator_name]`..   
-000041f0: 2020 2020 2052 6566 6572 656e 6365 730a       References.
-00004200: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0a          -------.
-00004210: 2020 2020 2020 2020 4a6f 7369 6168 2050          Josiah P
-00004220: 2e20 4861 6e6e 612c 2050 6574 6572 2053  . Hanna, Peter S
-00004230: 746f 6e65 2c20 616e 6420 5363 6f74 7420  tone, and Scott 
-00004240: 4e69 656b 756d 2e0a 2020 2020 2020 2020  Niekum..        
-00004250: 2242 6f6f 7473 7472 6170 7069 6e67 2077  "Bootstrapping w
-00004260: 6974 6820 4d6f 6465 6c73 3a20 436f 6e66  ith Models: Conf
-00004270: 6964 656e 6365 2049 6e74 6572 7661 6c73  idence Intervals
-00004280: 2066 6f72 204f 6666 2d50 6f6c 6963 7920   for Off-Policy 
-00004290: 4576 616c 7561 7469 6f6e 2e22 2032 3031  Evaluation." 201
-000042a0: 372e 0a0a 2020 2020 2020 2020 5068 696c  7...        Phil
-000042b0: 6970 2053 2e20 5468 6f6d 6173 2c20 4765  ip S. Thomas, Ge
-000042c0: 6f72 6769 6f73 2054 6865 6f63 6861 726f  orgios Theocharo
-000042d0: 7573 2c20 616e 6420 4d6f 6861 6d6d 6164  us, and Mohammad
-000042e0: 2047 6861 7661 6d7a 6164 6568 2e0a 2020   Ghavamzadeh..  
-000042f0: 2020 2020 2020 2248 6967 6820 436f 6e66        "High Conf
-00004300: 6964 656e 6365 2050 6f6c 6963 7920 496d  idence Policy Im
-00004310: 7072 6f76 656d 656e 742e 2220 3230 3135  provement." 2015
-00004320: 2e0a 0a20 2020 2020 2020 2050 6869 6c69  ...        Phili
-00004330: 7020 532e 2054 686f 6d61 732c 2047 656f  p S. Thomas, Geo
-00004340: 7267 696f 7320 5468 656f 6368 6172 6f75  rgios Theocharou
-00004350: 732c 2061 6e64 204d 6f68 616d 6d61 6420  s, and Mohammad 
-00004360: 4768 6176 616d 7a61 6465 682e 0a20 2020  Ghavamzadeh..   
-00004370: 2020 2020 2022 4869 6768 2043 6f6e 6669       "High Confi
-00004380: 6465 6e63 6520 4f66 662d 506f 6c69 6379  dence Off-Policy
-00004390: 2045 7661 6c75 6174 696f 6e2e 2220 3230   Evaluation." 20
-000043a0: 3135 2e0a 0a20 2020 2020 2020 2022 2222  15...        """
-000043b0: 0a20 2020 2020 2020 2063 6865 636b 5f69  .        check_i
-000043c0: 6e70 7574 5f64 6963 7428 696e 7075 745f  nput_dict(input_
-000043d0: 6469 6374 290a 0a20 2020 2020 2020 2070  dict)..        p
-000043e0: 6f6c 6963 795f 7661 6c75 655f 696e 7465  olicy_value_inte
-000043f0: 7276 616c 5f64 6963 7420 3d20 6465 6661  rval_dict = defa
-00004400: 756c 7464 6963 7428 6469 6374 290a 2020  ultdict(dict).  
-00004410: 2020 2020 2020 666f 7220 6576 616c 5f70        for eval_p
-00004420: 6f6c 6963 7920 696e 2069 6e70 7574 5f64  olicy in input_d
-00004430: 6963 742e 6b65 7973 2829 3a0a 2020 2020  ict.keys():.    
-00004440: 2020 2020 2020 2020 6966 2069 6e70 7574          if input
-00004450: 5f64 6963 745b 6576 616c 5f70 6f6c 6963  _dict[eval_polic
-00004460: 795d 5b22 6f6e 5f70 6f6c 6963 795f 706f  y]["on_policy_po
-00004470: 6c69 6379 5f76 616c 7565 225d 2069 7320  licy_value"] is 
-00004480: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
-00004490: 2020 2020 2020 2020 2020 706f 6c69 6379            policy
-000044a0: 5f76 616c 7565 5f69 6e74 6572 7661 6c5f  _value_interval_
-000044b0: 6469 6374 5b65 7661 6c5f 706f 6c69 6379  dict[eval_policy
-000044c0: 5d5b 0a20 2020 2020 2020 2020 2020 2020  ][.             
-000044d0: 2020 2020 2020 2022 6f6e 5f70 6f6c 6963         "on_polic
-000044e0: 7922 0a20 2020 2020 2020 2020 2020 2020  y".             
-000044f0: 2020 205d 203d 2073 656c 662e 5f65 7374     ] = self._est
-00004500: 696d 6174 655f 636f 6e66 6964 656e 6365  imate_confidence
-00004510: 5f69 6e74 6572 7661 6c5b 6369 5d28 0a20  _interval[ci](. 
+00001030: 446f 7562 6c65 4451 4e43 6f6e 6669 670a  DoubleDQNConfig.
+00001040: 2020 2020 2020 2020 6672 6f6d 2064 3372          from d3r
+00001050: 6c70 792e 6461 7461 7365 7420 696d 706f  lpy.dataset impo
+00001060: 7274 2063 7265 6174 655f 6669 666f 5f72  rt create_fifo_r
+00001070: 6570 6c61 795f 6275 6666 6572 0a20 2020  eplay_buffer.   
+00001080: 2020 2020 2066 726f 6d20 6433 726c 7079       from d3rlpy
+00001090: 2e61 6c67 6f73 2069 6d70 6f72 7420 436f  .algos import Co
+000010a0: 6e73 7461 6e74 4570 7369 6c6f 6e47 7265  nstantEpsilonGre
+000010b0: 6564 790a 0a20 2020 2020 2020 2023 2069  edy..        # i
+000010c0: 6e69 7469 616c 697a 6520 656e 7669 726f  nitialize enviro
+000010d0: 6e6d 656e 740a 2020 2020 2020 2020 656e  nment.        en
+000010e0: 7620 3d20 6779 6d2e 6d61 6b65 2822 5254  v = gym.make("RT
+000010f0: 4245 6e76 2d64 6973 6372 6574 652d 7630  BEnv-discrete-v0
+00001100: 2229 0a0a 2020 2020 2020 2020 2320 6465  ")..        # de
+00001110: 6669 6e65 2028 524c 2920 6167 656e 7420  fine (RL) agent 
+00001120: 2869 2e65 2e2c 2070 6f6c 6963 7929 2061  (i.e., policy) a
+00001130: 6e64 2074 7261 696e 206f 6e20 7468 6520  nd train on the 
+00001140: 656e 7669 726f 6e6d 656e 740a 2020 2020  environment.    
+00001150: 2020 2020 6464 716e 203d 2044 6f75 626c      ddqn = Doubl
+00001160: 6544 514e 436f 6e66 6967 2829 2e63 7265  eDQNConfig().cre
+00001170: 6174 6528 290a 2020 2020 2020 2020 6275  ate().        bu
+00001180: 6666 6572 203d 2063 7265 6174 655f 6669  ffer = create_fi
+00001190: 666f 5f72 6570 6c61 795f 6275 6666 6572  fo_replay_buffer
+000011a0: 280a 2020 2020 2020 2020 2020 2020 6c69  (.            li
+000011b0: 6d69 743d 3130 3030 302c 0a20 2020 2020  mit=10000,.     
+000011c0: 2020 2020 2020 2065 6e76 3d65 6e76 2c0a         env=env,.
+000011d0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+000011e0: 2020 6578 706c 6f72 6572 203d 2043 6f6e    explorer = Con
+000011f0: 7374 616e 7445 7073 696c 6f6e 4772 6565  stantEpsilonGree
+00001200: 6479 280a 2020 2020 2020 2020 2020 2020  dy(.            
+00001210: 6570 7369 6c6f 6e3d 302e 332c 0a20 2020  epsilon=0.3,.   
+00001220: 2020 2020 2029 0a20 2020 2020 2020 2064       ).        d
+00001230: 6471 6e2e 6669 745f 6f6e 6c69 6e65 280a  dqn.fit_online(.
+00001240: 2020 2020 2020 2020 2020 2020 656e 763d              env=
+00001250: 656e 762c 0a20 2020 2020 2020 2020 2020  env,.           
+00001260: 2062 7566 6665 723d 6275 6666 6572 2c0a   buffer=buffer,.
+00001270: 2020 2020 2020 2020 2020 2020 6578 706c              expl
+00001280: 6f72 6572 3d65 7870 6c6f 7265 722c 0a20  orer=explorer,. 
+00001290: 2020 2020 2020 2020 2020 206e 5f73 7465             n_ste
+000012a0: 7073 3d31 3030 3030 2c0a 2020 2020 2020  ps=10000,.      
+000012b0: 2020 2020 2020 6e5f 7374 6570 735f 7065        n_steps_pe
+000012c0: 725f 6570 6f63 683d 3130 3030 2c0a 2020  r_epoch=1000,.  
+000012d0: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+000012e0: 2023 2063 6f6e 7665 7274 2064 6471 6e20   # convert ddqn 
+000012f0: 706f 6c69 6379 2074 6f20 7374 6f63 6861  policy to stocha
+00001300: 7374 6963 2064 6174 6120 636f 6c6c 6563  stic data collec
+00001310: 7469 6f6e 2070 6f6c 6963 790a 2020 2020  tion policy.    
+00001320: 2020 2020 6265 6861 7669 6f72 5f70 6f6c      behavior_pol
+00001330: 6963 7920 3d20 4570 7369 6c6f 6e47 7265  icy = EpsilonGre
+00001340: 6564 7948 6561 6428 0a20 2020 2020 2020  edyHead(.       
+00001350: 2020 2020 2064 6471 6e2c 0a20 2020 2020       ddqn,.     
+00001360: 2020 2020 2020 206e 5f61 6374 696f 6e73         n_actions
+00001370: 3d65 6e76 2e61 6374 696f 6e5f 7370 6163  =env.action_spac
+00001380: 652e 6e2c 0a20 2020 2020 2020 2020 2020  e.n,.           
+00001390: 2065 7073 696c 6f6e 3d30 2e33 2c0a 2020   epsilon=0.3,.  
+000013a0: 2020 2020 2020 2020 2020 6e61 6d65 3d22            name="
+000013b0: 6464 716e 5f65 7073 696c 6f6e 5f30 2e33  ddqn_epsilon_0.3
+000013c0: 222c 0a20 2020 2020 2020 2020 2020 2072  ",.            r
+000013d0: 616e 646f 6d5f 7374 6174 653d 3132 3334  andom_state=1234
+000013e0: 352c 0a20 2020 2020 2020 2029 0a0a 2020  5,.        )..  
+000013f0: 2020 2020 2020 2320 696e 6974 6961 6c69        # initiali
+00001400: 7a65 2064 6174 6173 6574 2063 6c61 7373  ze dataset class
+00001410: 0a20 2020 2020 2020 2064 6174 6173 6574  .        dataset
+00001420: 203d 2053 796e 7468 6574 6963 4461 7461   = SyntheticData
+00001430: 7365 7428 0a20 2020 2020 2020 2020 2020  set(.           
+00001440: 2065 6e76 3d65 6e76 2c0a 2020 2020 2020   env=env,.      
+00001450: 2020 2020 2020 6d61 785f 6570 6973 6f64        max_episod
+00001460: 655f 7374 6570 733d 656e 762e 7374 6570  e_steps=env.step
+00001470: 5f70 6572 5f65 7069 736f 6465 2c0a 2020  _per_episode,.  
+00001480: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+00001490: 2023 2064 6174 6120 636f 6c6c 6563 7469   # data collecti
+000014a0: 6f6e 0a20 2020 2020 2020 206c 6f67 6765  on.        logge
+000014b0: 645f 6461 7461 7365 7420 3d20 6461 7461  d_dataset = data
+000014c0: 7365 742e 6f62 7461 696e 5f65 7069 736f  set.obtain_episo
+000014d0: 6465 7328 0a20 2020 2020 2020 2020 2020  des(.           
+000014e0: 2062 6568 6176 696f 725f 706f 6c69 6369   behavior_polici
+000014f0: 6573 3d62 6568 6176 696f 725f 706f 6c69  es=behavior_poli
+00001500: 6379 2c0a 2020 2020 2020 2020 2020 2020  cy,.            
+00001510: 6e5f 7472 616a 6563 746f 7269 6573 3d31  n_trajectories=1
+00001520: 3030 2c0a 2020 2020 2020 2020 2020 2020  00,.            
+00001530: 7261 6e64 6f6d 5f73 7461 7465 3d31 3233  random_state=123
+00001540: 3435 2c0a 2020 2020 2020 2020 290a 0a20  45,.        ).. 
+00001550: 2020 2043 7265 6174 6520 496e 7075 7420     Create Input 
+00001560: 666f 7220 4f50 453a 0a0a 2020 2020 2e2e  for OPE:..    ..
+00001570: 2063 6f64 652d 626c 6f63 6b3a 3a20 7079   code-block:: py
+00001580: 7468 6f6e 0a0a 2020 2020 2020 2020 2320  thon..        # 
+00001590: 6576 616c 7561 7469 6f6e 2070 6f6c 6963  evaluation polic
+000015a0: 790a 2020 2020 2020 2020 6464 716e 5f20  y.        ddqn_ 
+000015b0: 3d20 4570 7369 6c6f 6e47 7265 6564 7948  = EpsilonGreedyH
+000015c0: 6561 6428 0a20 2020 2020 2020 2020 2020  ead(.           
+000015d0: 2062 6173 655f 706f 6c69 6379 3d64 6471   base_policy=ddq
+000015e0: 6e2c 0a20 2020 2020 2020 2020 2020 206e  n,.            n
+000015f0: 5f61 6374 696f 6e73 3d65 6e76 2e61 6374  _actions=env.act
+00001600: 696f 6e5f 7370 6163 652e 6e2c 0a20 2020  ion_space.n,.   
+00001610: 2020 2020 2020 2020 206e 616d 653d 2264           name="d
+00001620: 6471 6e22 2c0a 2020 2020 2020 2020 2020  dqn",.          
+00001630: 2020 6570 7369 6c6f 6e3d 302e 302c 0a20    epsilon=0.0,. 
+00001640: 2020 2020 2020 2020 2020 2072 616e 646f             rando
+00001650: 6d5f 7374 6174 653d 3132 3334 350a 2020  m_state=12345.  
+00001660: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00001670: 7261 6e64 6f6d 5f20 3d20 4570 7369 6c6f  random_ = Epsilo
+00001680: 6e47 7265 6564 7948 6561 6428 0a20 2020  nGreedyHead(.   
+00001690: 2020 2020 2020 2020 2062 6173 655f 706f           base_po
+000016a0: 6c69 6379 3d64 6471 6e2c 0a20 2020 2020  licy=ddqn,.     
+000016b0: 2020 2020 2020 206e 5f61 6374 696f 6e73         n_actions
+000016c0: 3d65 6e76 2e61 6374 696f 6e5f 7370 6163  =env.action_spac
+000016d0: 652e 6e2c 0a20 2020 2020 2020 2020 2020  e.n,.           
+000016e0: 206e 616d 653d 2272 616e 646f 6d22 2c0a   name="random",.
+000016f0: 2020 2020 2020 2020 2020 2020 6570 7369              epsi
+00001700: 6c6f 6e3d 312e 302c 0a20 2020 2020 2020  lon=1.0,.       
+00001710: 2020 2020 2072 616e 646f 6d5f 7374 6174       random_stat
+00001720: 653d 3132 3334 350a 2020 2020 2020 2020  e=12345.        
+00001730: 290a 0a20 2020 2020 2020 2023 2063 7265  )..        # cre
+00001740: 6174 6520 696e 7075 7420 666f 7220 6f66  ate input for of
+00001750: 662d 706f 6c69 6379 2065 7661 6c75 6174  f-policy evaluat
+00001760: 696f 6e20 284f 5045 290a 2020 2020 2020  ion (OPE).      
+00001770: 2020 7072 6570 203d 2043 7265 6174 654f    prep = CreateO
+00001780: 5045 496e 7075 7428 0a20 2020 2020 2020  PEInput(.       
+00001790: 2020 2020 2065 6e76 3d65 6e76 2c0a 2020       env=env,.  
+000017a0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+000017b0: 696e 7075 745f 6469 6374 203d 2070 7265  input_dict = pre
+000017c0: 702e 6f62 7461 696e 5f77 686f 6c65 5f69  p.obtain_whole_i
+000017d0: 6e70 7574 7328 0a20 2020 2020 2020 2020  nputs(.         
+000017e0: 2020 206c 6f67 6765 645f 6461 7461 7365     logged_datase
+000017f0: 743d 6c6f 6767 6564 5f64 6174 6173 6574  t=logged_dataset
+00001800: 2c0a 2020 2020 2020 2020 2020 2020 6576  ,.            ev
+00001810: 616c 7561 7469 6f6e 5f70 6f6c 6963 6965  aluation_policie
+00001820: 733d 5b64 6471 6e5f 2c20 7261 6e64 6f6d  s=[ddqn_, random
+00001830: 5f5d 2c0a 2020 2020 2020 2020 2020 2020  _],.            
+00001840: 6e5f 7472 616a 6563 746f 7269 6573 5f6f  n_trajectories_o
+00001850: 6e5f 706f 6c69 6379 5f65 7661 6c75 6174  n_policy_evaluat
+00001860: 696f 6e3d 3130 302c 0a20 2020 2020 2020  ion=100,.       
+00001870: 2020 2020 2072 616e 646f 6d5f 7374 6174       random_stat
+00001880: 653d 3132 3334 352c 0a20 2020 2020 2020  e=12345,.       
+00001890: 2029 0a0a 2020 2020 2a2a 4f66 662d 506f   )..    **Off-Po
+000018a0: 6c69 6379 2045 7661 6c75 6174 696f 6e2a  licy Evaluation*
+000018b0: 2a3a 0a0a 2020 2020 2e2e 2063 6f64 652d  *:..    .. code-
+000018c0: 626c 6f63 6b3a 3a20 7079 7468 6f6e 0a0a  block:: python..
+000018d0: 2020 2020 2020 2020 2320 4f50 450a 2020          # OPE.  
+000018e0: 2020 2020 2020 6f70 6520 3d20 4f50 4528        ope = OPE(
+000018f0: 0a20 2020 2020 2020 2020 2020 206c 6f67  .            log
+00001900: 6765 645f 6461 7461 7365 743d 6c6f 6767  ged_dataset=logg
+00001910: 6564 5f64 6174 6173 6574 2c0a 2020 2020  ed_dataset,.    
+00001920: 2020 2020 2020 2020 6f70 655f 6573 7469          ope_esti
+00001930: 6d61 746f 7273 3d5b 5449 5328 292c 2050  mators=[TIS(), P
+00001940: 4449 5328 295d 2c0a 2020 2020 2020 2020  DIS()],.        
+00001950: 290a 2020 2020 2020 2020 706f 6c69 6379  ).        policy
+00001960: 5f76 616c 7565 5f64 6963 7420 3d20 6f70  _value_dict = op
+00001970: 652e 6573 7469 6d61 7465 5f70 6f6c 6963  e.estimate_polic
+00001980: 795f 7661 6c75 6528 0a20 2020 2020 2020  y_value(.       
+00001990: 2020 2020 2069 6e70 7574 5f64 6963 743d       input_dict=
+000019a0: 696e 7075 745f 6469 6374 2c0a 2020 2020  input_dict,.    
+000019b0: 2020 2020 290a 0a20 2020 202a 2a4f 7574      )..    **Out
+000019c0: 7075 742a 2a3a 0a0a 2020 2020 2e2e 2063  put**:..    .. c
+000019d0: 6f64 652d 626c 6f63 6b3a 3a20 7079 7468  ode-block:: pyth
+000019e0: 6f6e 0a0a 2020 2020 2020 2020 3e3e 3e20  on..        >>> 
+000019f0: 706f 6c69 6379 5f76 616c 7565 5f64 6963  policy_value_dic
+00001a00: 740a 0a20 2020 2020 2020 207b 2764 6471  t..        {'ddq
+00001a10: 6e27 3a20 7b27 6f6e 5f70 6f6c 6963 7927  n': {'on_policy'
+00001a20: 3a20 3135 2e39 352c 2027 7469 7327 3a20  : 15.95, 'tis': 
+00001a30: 3138 2e31 3033 3830 3936 3537 3437 3437  18.1038096574747
+00001a40: 3032 2c20 2770 6469 7327 3a20 3136 2e39  02, 'pdis': 16.9
+00001a50: 3533 3134 3036 3531 3932 3035 337d 2c0a  5314065192053},.
+00001a60: 2020 2020 2020 2020 2772 616e 646f 6d27          'random'
+00001a70: 3a20 7b27 6f6e 5f70 6f6c 6963 7927 3a20  : {'on_policy': 
+00001a80: 3132 2e36 392c 2027 7469 7327 3a20 302e  12.69, 'tis': 0.
+00001a90: 3438 3835 3638 3531 3437 3538 3433 3531  4885685147584351
+00001aa0: 2c20 2770 6469 7327 3a20 362e 3237 3532  , 'pdis': 6.2752
+00001ab0: 3536 3835 3437 3730 3133 3335 7d7d 0a0a  568547701335}}..
+00001ac0: 2020 2020 2e2e 2073 6565 616c 736f 3a3a      .. seealso::
+00001ad0: 0a0a 2020 2020 2020 2020 2a20 3a64 6f63  ..        * :doc
+00001ae0: 3a60 5175 6963 6b73 7461 7274 203c 2f64  :`Quickstart </d
+00001af0: 6f63 756d 656e 7461 7469 6f6e 2f71 7569  ocumentation/qui
+00001b00: 636b 7374 6172 743e 600a 2020 2020 2020  ckstart>`.      
+00001b10: 2020 2a20 3a64 6f63 3a60 5265 6c61 7465    * :doc:`Relate
+00001b20: 6420 7475 746f 7269 616c 7320 3c2f 646f  d tutorials </do
+00001b30: 6375 6d65 6e74 6174 696f 6e2f 6578 616d  cumentation/exam
+00001b40: 706c 6573 2f62 6173 6963 5f6f 7065 3e60  ples/basic_ope>`
+00001b50: 0a0a 2020 2020 2222 220a 0a20 2020 206c  ..    """..    l
+00001b60: 6f67 6765 645f 6461 7461 7365 743a 2055  ogged_dataset: U
+00001b70: 6e69 6f6e 5b4c 6f67 6765 6444 6174 6173  nion[LoggedDatas
+00001b80: 6574 2c20 4d75 6c74 6970 6c65 4c6f 6767  et, MultipleLogg
+00001b90: 6564 4461 7461 7365 745d 0a20 2020 206f  edDataset].    o
+00001ba0: 7065 5f65 7374 696d 6174 6f72 733a 204c  pe_estimators: L
+00001bb0: 6973 745b 4261 7365 4f66 6650 6f6c 6963  ist[BaseOffPolic
+00001bc0: 7945 7374 696d 6174 6f72 5d0a 2020 2020  yEstimator].    
+00001bd0: 6e5f 7374 6570 5f70 6469 733a 2069 6e74  n_step_pdis: int
+00001be0: 203d 2030 0a20 2020 2062 616e 6477 6964   = 0.    bandwid
+00001bf0: 7468 3a20 666c 6f61 7420 3d20 312e 300a  th: float = 1.0.
+00001c00: 2020 2020 6163 7469 6f6e 5f73 6361 6c65      action_scale
+00001c10: 723a 204f 7074 696f 6e61 6c5b 4163 7469  r: Optional[Acti
+00001c20: 6f6e 5363 616c 6572 5d20 3d20 4e6f 6e65  onScaler] = None
+00001c30: 0a20 2020 2064 6973 6162 6c65 5f72 6577  .    disable_rew
+00001c40: 6172 645f 6166 7465 725f 646f 6e65 3a20  ard_after_done: 
+00001c50: 626f 6f6c 203d 2054 7275 650a 0a20 2020  bool = True..   
+00001c60: 2064 6566 205f 5f70 6f73 745f 696e 6974   def __post_init
+00001c70: 5f5f 2873 656c 6629 202d 3e20 4e6f 6e65  __(self) -> None
+00001c80: 3a0a 2020 2020 2020 2020 7365 6c66 2e75  :.        self.u
+00001c90: 7365 5f6d 756c 7469 706c 655f 6c6f 6767  se_multiple_logg
+00001ca0: 6564 5f64 6174 6173 6574 203d 2046 616c  ed_dataset = Fal
+00001cb0: 7365 0a20 2020 2020 2020 2069 6620 6973  se.        if is
+00001cc0: 696e 7374 616e 6365 2873 656c 662e 6c6f  instance(self.lo
+00001cd0: 6767 6564 5f64 6174 6173 6574 2c20 4d75  gged_dataset, Mu
+00001ce0: 6c74 6970 6c65 4c6f 6767 6564 4461 7461  ltipleLoggedData
+00001cf0: 7365 7429 3a0a 2020 2020 2020 2020 2020  set):.          
+00001d00: 2020 7365 6c66 2e6d 756c 7469 706c 655f    self.multiple_
+00001d10: 6c6f 6767 6564 5f64 6174 6173 6574 203d  logged_dataset =
+00001d20: 2073 656c 662e 6c6f 6767 6564 5f64 6174   self.logged_dat
+00001d30: 6173 6574 0a20 2020 2020 2020 2020 2020  aset.           
+00001d40: 2073 656c 662e 6c6f 6767 6564 5f64 6174   self.logged_dat
+00001d50: 6173 6574 203d 2073 656c 662e 6d75 6c74  aset = self.mult
+00001d60: 6970 6c65 5f6c 6f67 6765 645f 6461 7461  iple_logged_data
+00001d70: 7365 742e 6765 7428 0a20 2020 2020 2020  set.get(.       
+00001d80: 2020 2020 2020 2020 2073 656c 662e 6d75           self.mu
+00001d90: 6c74 6970 6c65 5f6c 6f67 6765 645f 6461  ltiple_logged_da
+00001da0: 7461 7365 742e 6265 6861 7669 6f72 5f70  taset.behavior_p
+00001db0: 6f6c 6963 795f 6e61 6d65 735b 305d 2c20  olicy_names[0], 
+00001dc0: 6461 7461 7365 745f 6964 3d30 0a20 2020  dataset_id=0.   
+00001dd0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00001de0: 2020 2020 2020 2073 656c 662e 7573 655f         self.use_
+00001df0: 6d75 6c74 6970 6c65 5f6c 6f67 6765 645f  multiple_logged_
+00001e00: 6461 7461 7365 7420 3d20 5472 7565 0a0a  dataset = True..
+00001e10: 2020 2020 2020 2020 6368 6563 6b5f 6c6f          check_lo
+00001e20: 6767 6564 5f64 6174 6173 6574 2873 656c  gged_dataset(sel
+00001e30: 662e 6c6f 6767 6564 5f64 6174 6173 6574  f.logged_dataset
+00001e40: 290a 2020 2020 2020 2020 7365 6c66 2e73  ).        self.s
+00001e50: 7465 705f 7065 725f 7472 616a 6563 746f  tep_per_trajecto
+00001e60: 7279 203d 2073 656c 662e 6c6f 6767 6564  ry = self.logged
+00001e70: 5f64 6174 6173 6574 5b22 7374 6570 5f70  _dataset["step_p
+00001e80: 6572 5f74 7261 6a65 6374 6f72 7922 5d0a  er_trajectory"].
+00001e90: 2020 2020 2020 2020 7365 6c66 2e61 6374          self.act
+00001ea0: 696f 6e5f 7479 7065 203d 2073 656c 662e  ion_type = self.
+00001eb0: 6c6f 6767 6564 5f64 6174 6173 6574 5b22  logged_dataset["
+00001ec0: 6163 7469 6f6e 5f74 7970 6522 5d0a 0a20  action_type"].. 
+00001ed0: 2020 2020 2020 2069 6620 6e6f 7420 7365         if not se
+00001ee0: 6c66 2e75 7365 5f6d 756c 7469 706c 655f  lf.use_multiple_
+00001ef0: 6c6f 6767 6564 5f64 6174 6173 6574 3a0a  logged_dataset:.
+00001f00: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00001f10: 2e5f 7265 6769 7374 6572 5f6c 6f67 6765  ._register_logge
+00001f20: 645f 6461 7461 7365 7428 290a 0a20 2020  d_dataset()..   
+00001f30: 2020 2020 2073 656c 662e 6f70 655f 6573       self.ope_es
+00001f40: 7469 6d61 746f 7273 5f20 3d20 6469 6374  timators_ = dict
+00001f50: 2829 0a20 2020 2020 2020 2066 6f72 2065  ().        for e
+00001f60: 7374 696d 6174 6f72 2069 6e20 7365 6c66  stimator in self
+00001f70: 2e6f 7065 5f65 7374 696d 6174 6f72 733a  .ope_estimators:
+00001f80: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00001f90: 662e 6f70 655f 6573 7469 6d61 746f 7273  f.ope_estimators
+00001fa0: 5f5b 6573 7469 6d61 746f 722e 6573 7469  _[estimator.esti
+00001fb0: 6d61 746f 725f 6e61 6d65 5d20 3d20 6573  mator_name] = es
+00001fc0: 7469 6d61 746f 720a 0a20 2020 2020 2020  timator..       
+00001fd0: 2020 2020 2069 6620 6573 7469 6d61 746f       if estimato
+00001fe0: 722e 6163 7469 6f6e 5f74 7970 6520 213d  r.action_type !=
+00001ff0: 2073 656c 662e 6163 7469 6f6e 5f74 7970   self.action_typ
+00002000: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00002010: 2020 2072 6169 7365 2052 756e 7469 6d65     raise Runtime
+00002020: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
+00002030: 2020 2020 2020 2020 2020 2066 224f 6e65             f"One
+00002040: 206f 6620 7468 6520 6f70 655f 6573 7469   of the ope_esti
+00002050: 6d61 746f 7273 2c20 7b65 7374 696d 6174  mators, {estimat
+00002060: 6f72 2e65 7374 696d 6174 6f72 5f6e 616d  or.estimator_nam
+00002070: 657d 2064 6f65 7320 6e6f 7420 6d61 7463  e} does not matc
+00002080: 6820 7468 6520 6163 7469 6f6e 5f74 7970  h the action_typ
+00002090: 6520 6f66 206c 6f67 6765 645f 6461 7461  e of logged_data
+000020a0: 7365 7420 2860 7b73 656c 662e 6163 7469  set (`{self.acti
+000020b0: 6f6e 5f74 7970 657d 6029 220a 2020 2020  on_type}`)".    
+000020c0: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+000020d0: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
+000020e0: 7420 6973 696e 7374 616e 6365 2865 7374  t isinstance(est
+000020f0: 696d 6174 6f72 2c20 4261 7365 4f66 6650  imator, BaseOffP
+00002100: 6f6c 6963 7945 7374 696d 6174 6f72 293a  olicyEstimator):
+00002110: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00002120: 2072 6169 7365 2052 756e 7469 6d65 4572   raise RuntimeEr
+00002130: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
+00002140: 2020 2020 2020 2020 2066 226f 7065 5f65           f"ope_e
+00002150: 7374 696d 6174 6f72 7320 6d75 7374 2062  stimators must b
+00002160: 6520 6368 696c 6420 636c 6173 7365 7320  e child classes 
+00002170: 6f66 2042 6173 654f 6666 506f 6c69 6379  of BaseOffPolicy
+00002180: 4573 7469 6d61 746f 722c 2062 7574 206f  Estimator, but o
+00002190: 6e65 206f 6620 7468 656d 2c20 7b65 7374  ne of them, {est
+000021a0: 696d 6174 6f72 2e65 7374 696d 6174 6f72  imator.estimator
+000021b0: 5f6e 616d 657d 2069 7320 6e6f 7422 0a20  _name} is not". 
+000021c0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+000021d0: 0a0a 2020 2020 2020 2020 7365 6c66 2e5f  ..        self._
+000021e0: 6573 7469 6d61 7465 5f63 6f6e 6669 6465  estimate_confide
+000021f0: 6e63 655f 696e 7465 7276 616c 203d 207b  nce_interval = {
+00002200: 0a20 2020 2020 2020 2020 2020 2022 626f  .            "bo
+00002210: 6f74 7374 7261 7022 3a20 6573 7469 6d61  otstrap": estima
+00002220: 7465 5f63 6f6e 6669 6465 6e63 655f 696e  te_confidence_in
+00002230: 7465 7276 616c 5f62 795f 626f 6f74 7374  terval_by_bootst
+00002240: 7261 702c 0a20 2020 2020 2020 2020 2020  rap,.           
+00002250: 2022 686f 6566 6664 696e 6722 3a20 6573   "hoeffding": es
+00002260: 7469 6d61 7465 5f63 6f6e 6669 6465 6e63  timate_confidenc
+00002270: 655f 696e 7465 7276 616c 5f62 795f 686f  e_interval_by_ho
+00002280: 6566 6664 696e 672c 0a20 2020 2020 2020  effding,.       
+00002290: 2020 2020 2022 6265 726e 7374 6569 6e22       "bernstein"
+000022a0: 3a20 6573 7469 6d61 7465 5f63 6f6e 6669  : estimate_confi
+000022b0: 6465 6e63 655f 696e 7465 7276 616c 5f62  dence_interval_b
+000022c0: 795f 656d 7069 7269 6361 6c5f 6265 726e  y_empirical_bern
+000022d0: 7374 6569 6e2c 0a20 2020 2020 2020 2020  stein,.         
+000022e0: 2020 2022 7474 6573 7422 3a20 6573 7469     "ttest": esti
+000022f0: 6d61 7465 5f63 6f6e 6669 6465 6e63 655f  mate_confidence_
+00002300: 696e 7465 7276 616c 5f62 795f 745f 7465  interval_by_t_te
+00002310: 7374 2c0a 2020 2020 2020 2020 7d0a 0a20  st,.        }.. 
+00002320: 2020 2064 6566 205f 6368 6563 6b5f 636f     def _check_co
+00002330: 6d70 6172 6564 5f65 7374 696d 6174 6f72  mpared_estimator
+00002340: 7328 0a20 2020 2020 2020 2073 656c 662c  s(.        self,
+00002350: 0a20 2020 2020 2020 2063 6f6d 7061 7265  .        compare
+00002360: 645f 6573 7469 6d61 746f 7273 3a20 4f70  d_estimators: Op
+00002370: 7469 6f6e 616c 5b4c 6973 745b 7374 725d  tional[List[str]
+00002380: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 293a  ] = None,.    ):
+00002390: 0a20 2020 2020 2020 2069 6620 636f 6d70  .        if comp
+000023a0: 6172 6564 5f65 7374 696d 6174 6f72 7320  ared_estimators 
+000023b0: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
+000023c0: 2020 2020 2063 6f6d 7061 7265 645f 6573       compared_es
+000023d0: 7469 6d61 746f 7273 203d 2073 656c 662e  timators = self.
+000023e0: 6573 7469 6d61 746f 7273 5f6e 616d 650a  estimators_name.
+000023f0: 2020 2020 2020 2020 656c 6966 206e 6f74          elif not
+00002400: 2073 6574 2863 6f6d 7061 7265 645f 6573   set(compared_es
+00002410: 7469 6d61 746f 7273 292e 6973 7375 6273  timators).issubs
+00002420: 6574 2873 656c 662e 6573 7469 6d61 746f  et(self.estimato
+00002430: 7273 5f6e 616d 6529 3a0a 2020 2020 2020  rs_name):.      
+00002440: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+00002450: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
+00002460: 2020 2020 2020 2020 2263 6f6d 7061 7265          "compare
+00002470: 645f 6573 7469 6d61 746f 7273 206d 7573  d_estimators mus
+00002480: 7420 6265 2061 2073 7562 7365 7420 6f66  t be a subset of
+00002490: 2073 656c 662e 6573 7469 6d61 746f 7273   self.estimators
+000024a0: 5f6e 616d 652c 2062 7574 2066 6f75 6e64  _name, but found
+000024b0: 2046 616c 7365 2e22 0a20 2020 2020 2020   False.".       
+000024c0: 2020 2020 2029 0a20 2020 2020 2020 2072       ).        r
+000024d0: 6574 7572 6e20 636f 6d70 6172 6564 5f65  eturn compared_e
+000024e0: 7374 696d 6174 6f72 730a 0a20 2020 2064  stimators..    d
+000024f0: 6566 205f 6368 6563 6b5f 6261 7369 635f  ef _check_basic_
+00002500: 7669 7375 616c 697a 6174 696f 6e5f 696e  visualization_in
+00002510: 7075 7473 280a 2020 2020 2020 2020 7365  puts(.        se
+00002520: 6c66 2c0a 2020 2020 2020 2020 6875 653a  lf,.        hue:
+00002530: 2073 7472 2c0a 2020 2020 2020 2020 6669   str,.        fi
+00002540: 675f 6469 723a 204f 7074 696f 6e61 6c5b  g_dir: Optional[
+00002550: 5061 7468 5d20 3d20 4e6f 6e65 2c0a 2020  Path] = None,.  
+00002560: 2020 2020 2020 6669 675f 6e61 6d65 3a20        fig_name: 
+00002570: 4f70 7469 6f6e 616c 5b73 7472 5d20 3d20  Optional[str] = 
+00002580: 4e6f 6e65 2c0a 2020 2020 293a 0a20 2020  None,.    ):.   
+00002590: 2020 2020 2069 6620 6875 6520 6e6f 7420       if hue not 
+000025a0: 696e 205b 2265 7374 696d 6174 6f72 222c  in ["estimator",
+000025b0: 2022 706f 6c69 6379 225d 3a0a 2020 2020   "policy"]:.    
+000025c0: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+000025d0: 6c75 6545 7272 6f72 280a 2020 2020 2020  lueError(.      
+000025e0: 2020 2020 2020 2020 2020 6622 6875 6520            f"hue 
+000025f0: 6d75 7374 2062 6520 6569 7468 6572 2060  must be either `
+00002600: 6573 7469 6d61 746f 7260 206f 7220 6070  estimator` or `p
+00002610: 6f6c 6963 7960 2c20 6275 7420 7b68 7565  olicy`, but {hue
+00002620: 7d20 6973 2067 6976 656e 220a 2020 2020  } is given".    
+00002630: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00002640: 2020 6966 2066 6967 5f64 6972 2069 7320    if fig_dir is 
+00002650: 6e6f 7420 4e6f 6e65 2061 6e64 206e 6f74  not None and not
+00002660: 2069 7369 6e73 7461 6e63 6528 6669 675f   isinstance(fig_
+00002670: 6469 722c 2050 6174 6829 3a0a 2020 2020  dir, Path):.    
+00002680: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+00002690: 6c75 6545 7272 6f72 2866 2266 6967 5f64  lueError(f"fig_d
+000026a0: 6972 206d 7573 7420 6265 2061 2050 6174  ir must be a Pat
+000026b0: 682c 2062 7574 207b 7479 7065 2866 6967  h, but {type(fig
+000026c0: 5f64 6972 297d 2069 7320 6769 7665 6e22  _dir)} is given"
+000026d0: 290a 2020 2020 2020 2020 6966 2066 6967  ).        if fig
+000026e0: 5f6e 616d 6520 6973 206e 6f74 204e 6f6e  _name is not Non
+000026f0: 6520 616e 6420 6e6f 7420 6973 696e 7374  e and not isinst
+00002700: 616e 6365 2866 6967 5f6e 616d 652c 2073  ance(fig_name, s
+00002710: 7472 293a 0a20 2020 2020 2020 2020 2020  tr):.           
+00002720: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+00002730: 7228 6622 6669 675f 6469 7220 6d75 7374  r(f"fig_dir must
+00002740: 2062 6520 6120 7374 7269 6e67 2c20 6275   be a string, bu
+00002750: 7420 7b74 7970 6528 6669 675f 6469 7229  t {type(fig_dir)
+00002760: 7d20 6973 2067 6976 656e 2229 0a0a 2020  } is given")..  
+00002770: 2020 6465 6620 5f72 6567 6973 7465 725f    def _register_
+00002780: 6c6f 6767 6564 5f64 6174 6173 6574 280a  logged_dataset(.
+00002790: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+000027a0: 2020 2020 2020 6265 6861 7669 6f72 5f70        behavior_p
+000027b0: 6f6c 6963 795f 6e61 6d65 3a20 4f70 7469  olicy_name: Opti
+000027c0: 6f6e 616c 5b73 7472 5d20 3d20 4e6f 6e65  onal[str] = None
+000027d0: 2c0a 2020 2020 2020 2020 6461 7461 7365  ,.        datase
+000027e0: 745f 6964 3a20 4f70 7469 6f6e 616c 5b69  t_id: Optional[i
+000027f0: 6e74 5d20 3d20 4e6f 6e65 2c0a 2020 2020  nt] = None,.    
+00002800: 293a 0a20 2020 2020 2020 2069 6620 6265  ):.        if be
+00002810: 6861 7669 6f72 5f70 6f6c 6963 795f 6e61  havior_policy_na
+00002820: 6d65 2069 7320 6e6f 7420 4e6f 6e65 2061  me is not None a
+00002830: 6e64 2064 6174 6173 6574 5f69 6420 6973  nd dataset_id is
+00002840: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
+00002850: 2020 2020 2020 2073 656c 662e 6c6f 6767         self.logg
+00002860: 6564 5f64 6174 6173 6574 203d 2073 656c  ed_dataset = sel
+00002870: 662e 6d75 6c74 6970 6c65 5f6c 6f67 6765  f.multiple_logge
+00002880: 645f 6461 7461 7365 742e 6765 7428 0a20  d_dataset.get(. 
+00002890: 2020 2020 2020 2020 2020 2020 2020 2062                 b
+000028a0: 6568 6176 696f 725f 706f 6c69 6379 5f6e  ehavior_policy_n
+000028b0: 616d 653d 6265 6861 7669 6f72 5f70 6f6c  ame=behavior_pol
+000028c0: 6963 795f 6e61 6d65 2c20 6461 7461 7365  icy_name, datase
+000028d0: 745f 6964 3d64 6174 6173 6574 5f69 640a  t_id=dataset_id.
+000028e0: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+000028f0: 2020 2020 2020 2073 656c 662e 6265 6861         self.beha
+00002900: 7669 6f72 5f70 6f6c 6963 795f 7265 7761  vior_policy_rewa
+00002910: 7264 203d 2073 656c 662e 6c6f 6767 6564  rd = self.logged
+00002920: 5f64 6174 6173 6574 5b22 7265 7761 7264  _dataset["reward
+00002930: 225d 2e72 6573 6861 7065 280a 2020 2020  "].reshape(.    
+00002940: 2020 2020 2020 2020 282d 312c 2073 656c          (-1, sel
+00002950: 662e 7374 6570 5f70 6572 5f74 7261 6a65  f.step_per_traje
+00002960: 6374 6f72 7929 0a20 2020 2020 2020 2029  ctory).        )
+00002970: 0a0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
+00002980: 662e 6469 7361 626c 655f 7265 7761 7264  f.disable_reward
+00002990: 5f61 6674 6572 5f64 6f6e 653a 0a20 2020  _after_done:.   
+000029a0: 2020 2020 2020 2020 2064 6f6e 6520 3d20           done = 
+000029b0: 7365 6c66 2e6c 6f67 6765 645f 6461 7461  self.logged_data
+000029c0: 7365 745b 2264 6f6e 6522 5d2e 7265 7368  set["done"].resh
+000029d0: 6170 6528 282d 312c 2073 656c 662e 7374  ape((-1, self.st
+000029e0: 6570 5f70 6572 5f74 7261 6a65 6374 6f72  ep_per_trajector
+000029f0: 7929 290a 2020 2020 2020 2020 2020 2020  y)).            
+00002a00: 7365 6c66 2e62 6568 6176 696f 725f 706f  self.behavior_po
+00002a10: 6c69 6379 5f72 6577 6172 6420 3d20 7365  licy_reward = se
+00002a20: 6c66 2e62 6568 6176 696f 725f 706f 6c69  lf.behavior_poli
+00002a30: 6379 5f72 6577 6172 6420 2a20 280a 2020  cy_reward * (.  
+00002a40: 2020 2020 2020 2020 2020 2020 2020 3120                1 
+00002a50: 2d20 646f 6e65 0a20 2020 2020 2020 2020  - done.         
+00002a60: 2020 2029 2e63 756d 7072 6f64 2861 7869     ).cumprod(axi
+00002a70: 733d 3129 0a0a 2020 2020 2020 2020 6966  s=1)..        if
+00002a80: 2073 656c 662e 6163 7469 6f6e 5f74 7970   self.action_typ
+00002a90: 6520 3d3d 2022 6469 7363 7265 7465 223a  e == "discrete":
+00002aa0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00002ab0: 662e 696e 7075 745f 6469 6374 5f20 3d20  f.input_dict_ = 
+00002ac0: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
+00002ad0: 2020 2273 7465 705f 7065 725f 7472 616a    "step_per_traj
+00002ae0: 6563 746f 7279 223a 2073 656c 662e 7374  ectory": self.st
+00002af0: 6570 5f70 6572 5f74 7261 6a65 6374 6f72  ep_per_trajector
+00002b00: 792c 0a20 2020 2020 2020 2020 2020 2020  y,.             
+00002b10: 2020 2022 6163 7469 6f6e 223a 2073 656c     "action": sel
+00002b20: 662e 6c6f 6767 6564 5f64 6174 6173 6574  f.logged_dataset
+00002b30: 5b22 6163 7469 6f6e 225d 2e61 7374 7970  ["action"].astyp
+00002b40: 6528 696e 7429 2c0a 2020 2020 2020 2020  e(int),.        
+00002b50: 2020 2020 2020 2020 2272 6577 6172 6422          "reward"
+00002b60: 3a20 7365 6c66 2e62 6568 6176 696f 725f  : self.behavior_
+00002b70: 706f 6c69 6379 5f72 6577 6172 642e 666c  policy_reward.fl
+00002b80: 6174 7465 6e28 292c 0a20 2020 2020 2020  atten(),.       
+00002b90: 2020 2020 2020 2020 2022 646f 6e65 223a           "done":
+00002ba0: 2073 656c 662e 6c6f 6767 6564 5f64 6174   self.logged_dat
+00002bb0: 6173 6574 5b22 646f 6e65 225d 2c0a 2020  aset["done"],.  
+00002bc0: 2020 2020 2020 2020 2020 2020 2020 2270                "p
+00002bd0: 7363 6f72 6522 3a20 7365 6c66 2e6c 6f67  score": self.log
+00002be0: 6765 645f 6461 7461 7365 745b 2270 7363  ged_dataset["psc
+00002bf0: 6f72 6522 5d2c 0a20 2020 2020 2020 2020  ore"],.         
+00002c00: 2020 207d 0a20 2020 2020 2020 2065 6c73     }.        els
+00002c10: 653a 0a20 2020 2020 2020 2020 2020 2069  e:.            i
+00002c20: 6620 7365 6c66 2e61 6374 696f 6e5f 7363  f self.action_sc
+00002c30: 616c 6572 2069 7320 6e6f 7420 4e6f 6e65  aler is not None
+00002c40: 2061 6e64 206e 6f74 2069 7369 6e73 7461   and not isinsta
+00002c50: 6e63 6528 0a20 2020 2020 2020 2020 2020  nce(.           
+00002c60: 2020 2020 2073 656c 662e 6163 7469 6f6e       self.action
+00002c70: 5f73 6361 6c65 722c 2041 6374 696f 6e53  _scaler, ActionS
+00002c80: 6361 6c65 720a 2020 2020 2020 2020 2020  caler.          
+00002c90: 2020 293a 0a20 2020 2020 2020 2020 2020    ):.           
+00002ca0: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+00002cb0: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
+00002cc0: 2020 2020 2020 2020 2020 2022 6163 7469             "acti
+00002cd0: 6f6e 5f73 6361 6c65 7220 6d75 7374 2062  on_scaler must b
+00002ce0: 6520 616e 2069 6e73 7461 6e63 6520 6f66  e an instance of
+00002cf0: 2064 3372 6c70 792e 7072 6570 726f 6365   d3rlpy.preproce
+00002d00: 7373 696e 672e 4163 7469 6f6e 5363 616c  ssing.ActionScal
+00002d10: 6572 2c20 6275 7420 666f 756e 6420 4661  er, but found Fa
+00002d20: 6c73 6522 0a20 2020 2020 2020 2020 2020  lse".           
+00002d30: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+00002d40: 2020 2063 6865 636b 5f73 6361 6c61 7228     check_scalar(
+00002d50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00002d60: 2073 656c 662e 6261 6e64 7769 6474 682c   self.bandwidth,
+00002d70: 206e 616d 653d 2262 616e 6477 6964 7468   name="bandwidth
+00002d80: 222c 2074 6172 6765 745f 7479 7065 3d66  ", target_type=f
+00002d90: 6c6f 6174 2c20 6d69 6e5f 7661 6c3d 302e  loat, min_val=0.
+00002da0: 300a 2020 2020 2020 2020 2020 2020 290a  0.            ).
+00002db0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00002dc0: 662e 696e 7075 745f 6469 6374 5f20 3d20  f.input_dict_ = 
+00002dd0: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
+00002de0: 2020 2273 7465 705f 7065 725f 7472 616a    "step_per_traj
+00002df0: 6563 746f 7279 223a 2073 656c 662e 7374  ectory": self.st
+00002e00: 6570 5f70 6572 5f74 7261 6a65 6374 6f72  ep_per_trajector
+00002e10: 792c 0a20 2020 2020 2020 2020 2020 2020  y,.             
+00002e20: 2020 2022 6163 7469 6f6e 223a 2073 656c     "action": sel
+00002e30: 662e 6c6f 6767 6564 5f64 6174 6173 6574  f.logged_dataset
+00002e40: 5b22 6163 7469 6f6e 225d 2e61 7374 7970  ["action"].astyp
+00002e50: 6528 696e 7429 2c0a 2020 2020 2020 2020  e(int),.        
+00002e60: 2020 2020 2020 2020 2272 6577 6172 6422          "reward"
+00002e70: 3a20 7365 6c66 2e62 6568 6176 696f 725f  : self.behavior_
+00002e80: 706f 6c69 6379 5f72 6577 6172 642e 666c  policy_reward.fl
+00002e90: 6174 7465 6e28 292c 0a20 2020 2020 2020  atten(),.       
+00002ea0: 2020 2020 2020 2020 2022 646f 6e65 223a           "done":
+00002eb0: 2073 656c 662e 6c6f 6767 6564 5f64 6174   self.logged_dat
+00002ec0: 6173 6574 5b22 646f 6e65 225d 2c0a 2020  aset["done"],.  
+00002ed0: 2020 2020 2020 2020 2020 2020 2020 2270                "p
+00002ee0: 7363 6f72 6522 3a20 7365 6c66 2e6c 6f67  score": self.log
+00002ef0: 6765 645f 6461 7461 7365 745b 2270 7363  ged_dataset["psc
+00002f00: 6f72 6522 5d2c 0a20 2020 2020 2020 2020  ore"],.         
+00002f10: 2020 2020 2020 2022 6163 7469 6f6e 5f73         "action_s
+00002f20: 6361 6c65 7222 3a20 7365 6c66 2e61 6374  caler": self.act
+00002f30: 696f 6e5f 7363 616c 6572 2c0a 2020 2020  ion_scaler,.    
+00002f40: 2020 2020 2020 2020 2020 2020 2262 616e              "ban
+00002f50: 6477 6964 7468 223a 2073 656c 662e 6261  dwidth": self.ba
+00002f60: 6e64 7769 6474 682c 0a20 2020 2020 2020  ndwidth,.       
+00002f70: 2020 2020 207d 0a0a 2020 2020 6465 6620       }..    def 
+00002f80: 5f65 7374 696d 6174 655f 706f 6c69 6379  _estimate_policy
+00002f90: 5f76 616c 7565 280a 2020 2020 2020 2020  _value(.        
+00002fa0: 7365 6c66 2c0a 2020 2020 2020 2020 696e  self,.        in
+00002fb0: 7075 745f 6469 6374 3a20 4f50 4549 6e70  put_dict: OPEInp
+00002fc0: 7574 4469 6374 2c0a 2020 2020 2020 2020  utDict,.        
+00002fd0: 636f 6d70 6172 6564 5f65 7374 696d 6174  compared_estimat
+00002fe0: 6f72 733a 204f 7074 696f 6e61 6c5b 4c69  ors: Optional[Li
+00002ff0: 7374 5b73 7472 5d5d 203d 204e 6f6e 652c  st[str]] = None,
+00003000: 0a20 2020 2029 202d 3e20 4469 6374 5b73  .    ) -> Dict[s
+00003010: 7472 2c20 666c 6f61 745d 3a0a 2020 2020  tr, float]:.    
+00003020: 2020 2020 2222 2245 7374 696d 6174 6520      """Estimate 
+00003030: 7468 6520 706f 6c69 6379 2076 616c 7565  the policy value
+00003040: 206f 6620 7468 6520 6769 7665 6e20 6576   of the given ev
+00003050: 616c 7561 7469 6f6e 2070 6f6c 6963 6965  aluation policie
+00003060: 732e 0a0a 2020 2020 2020 2020 5061 7261  s...        Para
+00003070: 6d65 7465 7273 0a20 2020 2020 2020 202d  meters.        -
+00003080: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2069  ------.        i
+00003090: 6e70 7574 5f64 6963 743a 204f 5045 496e  nput_dict: OPEIn
+000030a0: 7075 7444 6963 740a 2020 2020 2020 2020  putDict.        
+000030b0: 2020 2020 4469 6374 696f 6e61 7279 206f      Dictionary o
+000030c0: 6620 7468 6520 4f50 4520 696e 7075 7473  f the OPE inputs
+000030d0: 2066 6f72 2065 6163 6820 6576 616c 7561   for each evalua
+000030e0: 7469 6f6e 2070 6f6c 6963 792e 0a0a 2020  tion policy...  
+000030f0: 2020 2020 2020 2020 2020 2e2e 2063 6f64            .. cod
+00003100: 652d 626c 6f63 6b3a 3a20 7079 7468 6f6e  e-block:: python
+00003110: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00003120: 2020 6b65 793a 205b 6576 616c 7561 7469    key: [evaluati
+00003130: 6f6e 5f70 6f6c 6963 795d 5b0a 2020 2020  on_policy][.    
+00003140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003150: 6576 616c 7561 7469 6f6e 5f70 6f6c 6963  evaluation_polic
+00003160: 795f 6163 7469 6f6e 2c0a 2020 2020 2020  y_action,.      
+00003170: 2020 2020 2020 2020 2020 2020 2020 6576                ev
+00003180: 616c 7561 7469 6f6e 5f70 6f6c 6963 795f  aluation_policy_
+00003190: 6163 7469 6f6e 5f64 6973 742c 0a20 2020  action_dist,.   
+000031a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000031b0: 2073 7461 7465 5f61 6374 696f 6e5f 7661   state_action_va
+000031c0: 6c75 655f 7072 6564 6963 7469 6f6e 2c0a  lue_prediction,.
+000031d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000031e0: 2020 2020 696e 6974 6961 6c5f 7374 6174      initial_stat
+000031f0: 655f 7661 6c75 655f 7072 6564 6963 7469  e_value_predicti
+00003200: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
+00003210: 2020 2020 2020 2020 7374 6174 655f 6163          state_ac
+00003220: 7469 6f6e 5f6d 6172 6769 6e61 6c5f 696d  tion_marginal_im
+00003230: 706f 7274 616e 6365 5f77 6569 6768 742c  portance_weight,
+00003240: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00003250: 2020 2020 2073 7461 7465 5f6d 6172 6769       state_margi
+00003260: 6e61 6c5f 696d 706f 7274 616e 6365 5f77  nal_importance_w
+00003270: 6569 6768 742c 0a20 2020 2020 2020 2020  eight,.         
+00003280: 2020 2020 2020 2020 2020 206f 6e5f 706f             on_po
+00003290: 6c69 6379 5f70 6f6c 6963 795f 7661 6c75  licy_policy_valu
+000032a0: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+000032b0: 2020 2020 2020 2067 616d 6d61 2c0a 2020         gamma,.  
+000032c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000032d0: 2020 6265 6861 7669 6f72 5f70 6f6c 6963    behavior_polic
+000032e0: 792c 0a20 2020 2020 2020 2020 2020 2020  y,.             
+000032f0: 2020 2020 2020 2065 7661 6c75 6174 696f         evaluatio
+00003300: 6e5f 706f 6c69 6379 2c0a 2020 2020 2020  n_policy,.      
+00003310: 2020 2020 2020 2020 2020 2020 2020 6461                da
+00003320: 7461 7365 745f 6964 2c0a 2020 2020 2020  taset_id,.      
+00003330: 2020 2020 2020 2020 2020 5d0a 0a20 2020            ]..   
+00003340: 2020 2020 2020 2020 202e 2e20 7365 6561           .. seea
+00003350: 6c73 6f3a 3a0a 0a20 2020 2020 2020 2020  lso::..         
+00003360: 2020 2020 2020 203a 636c 6173 733a 6073         :class:`s
+00003370: 636f 7065 5f72 6c2e 6f70 652e 696e 7075  cope_rl.ope.inpu
+00003380: 742e 4372 6561 7465 4f50 4549 6e70 7574  t.CreateOPEInput
+00003390: 6020 6465 7363 7269 6265 7320 7468 6520  ` describes the 
+000033a0: 636f 6d70 6f6e 656e 7473 206f 6620 3a63  components of :c
+000033b0: 6c61 7373 3a60 696e 7075 745f 6469 6374  lass:`input_dict
+000033c0: 602e 0a0a 2020 2020 2020 2020 636f 6d70  `...        comp
+000033d0: 6172 6564 5f65 7374 696d 6174 6f72 733a  ared_estimators:
+000033e0: 206c 6973 7420 6f66 2073 7472 2c20 6465   list of str, de
+000033f0: 6661 756c 743d 4e6f 6e65 0a20 2020 2020  fault=None.     
+00003400: 2020 2020 2020 204e 616d 6520 6f66 2063         Name of c
+00003410: 6f6d 7061 7265 6420 6573 7469 6d61 746f  ompared estimato
+00003420: 7273 2e0a 2020 2020 2020 2020 2020 2020  rs..            
+00003430: 4966 2060 4e6f 6e65 6020 6973 2067 6976  If `None` is giv
+00003440: 656e 2c20 616c 6c20 7468 6520 6573 7469  en, all the esti
+00003450: 6d61 746f 7273 2061 7265 2063 6f6d 7061  mators are compa
+00003460: 7265 642e 0a0a 2020 2020 2020 2020 5265  red...        Re
+00003470: 7475 726e 0a20 2020 2020 2020 202d 2d2d  turn.        ---
+00003480: 2d2d 2d2d 0a20 2020 2020 2020 2070 6f6c  ----.        pol
+00003490: 6963 795f 7661 6c75 655f 6469 6374 3a20  icy_value_dict: 
+000034a0: 6469 6374 0a20 2020 2020 2020 2020 2020  dict.           
+000034b0: 2044 6963 7469 6f6e 6172 7920 636f 6e74   Dictionary cont
+000034c0: 6169 6e69 6e67 2074 6865 2070 6f6c 6963  aining the polic
+000034d0: 7920 7661 6c75 6520 6f66 2065 6163 6820  y value of each 
+000034e0: 6576 616c 7561 7469 6f6e 2070 6f6c 6963  evaluation polic
+000034f0: 7920 6573 7469 6d61 7465 6420 6279 204f  y estimated by O
+00003500: 5045 2065 7374 696d 6174 6f72 732e 0a20  PE estimators.. 
+00003510: 2020 2020 2020 2020 2020 206b 6579 3a20             key: 
+00003520: 3a63 6c61 7373 3a60 5b65 7661 6c75 6174  :class:`[evaluat
+00003530: 696f 6e5f 706f 6c69 6379 5d5b 4f50 455f  ion_policy][OPE_
+00003540: 6573 7469 6d61 746f 725f 6e61 6d65 5d60  estimator_name]`
+00003550: 0a0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+00003560: 2020 2020 2020 6368 6563 6b5f 696e 7075        check_inpu
+00003570: 745f 6469 6374 2869 6e70 7574 5f64 6963  t_dict(input_dic
+00003580: 7429 0a0a 2020 2020 2020 2020 706f 6c69  t)..        poli
+00003590: 6379 5f76 616c 7565 5f64 6963 7420 3d20  cy_value_dict = 
+000035a0: 6465 6661 756c 7464 6963 7428 6469 6374  defaultdict(dict
+000035b0: 290a 2020 2020 2020 2020 666f 7220 6576  ).        for ev
+000035c0: 616c 5f70 6f6c 6963 7920 696e 2069 6e70  al_policy in inp
+000035d0: 7574 5f64 6963 742e 6b65 7973 2829 3a0a  ut_dict.keys():.
+000035e0: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+000035f0: 6e70 7574 5f64 6963 745b 6576 616c 5f70  nput_dict[eval_p
+00003600: 6f6c 6963 795d 5b22 6f6e 5f70 6f6c 6963  olicy]["on_polic
+00003610: 795f 706f 6c69 6379 5f76 616c 7565 225d  y_policy_value"]
+00003620: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
+00003630: 2020 2020 2020 2020 2020 2020 2020 706f                po
+00003640: 6c69 6379 5f76 616c 7565 5f64 6963 745b  licy_value_dict[
+00003650: 6576 616c 5f70 6f6c 6963 795d 5b22 6f6e  eval_policy]["on
+00003660: 5f70 6f6c 6963 7922 5d20 3d20 696e 7075  _policy"] = inpu
+00003670: 745f 6469 6374 5b65 7661 6c5f 706f 6c69  t_dict[eval_poli
+00003680: 6379 5d5b 0a20 2020 2020 2020 2020 2020  cy][.           
+00003690: 2020 2020 2020 2020 2022 6f6e 5f70 6f6c           "on_pol
+000036a0: 6963 795f 706f 6c69 6379 5f76 616c 7565  icy_policy_value
+000036b0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+000036c0: 2020 5d2e 6d65 616e 2829 0a20 2020 2020    ].mean().     
+000036d0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+000036e0: 2020 2020 2020 2020 2020 2020 2070 6f6c               pol
+000036f0: 6963 795f 7661 6c75 655f 6469 6374 5b65  icy_value_dict[e
+00003700: 7661 6c5f 706f 6c69 6379 5d5b 226f 6e5f  val_policy]["on_
+00003710: 706f 6c69 6379 225d 203d 204e 6f6e 650a  policy"] = None.
+00003720: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+00003730: 2065 7374 696d 6174 6f72 5f6e 616d 6520   estimator_name 
+00003740: 696e 2063 6f6d 7061 7265 645f 6573 7469  in compared_esti
+00003750: 6d61 746f 7273 3a0a 2020 2020 2020 2020  mators:.        
+00003760: 2020 2020 2020 2020 6573 7469 6d61 746f          estimato
+00003770: 7220 3d20 7365 6c66 2e6f 7065 5f65 7374  r = self.ope_est
+00003780: 696d 6174 6f72 735f 5b65 7374 696d 6174  imators_[estimat
+00003790: 6f72 5f6e 616d 655d 0a20 2020 2020 2020  or_name].       
+000037a0: 2020 2020 2020 2020 2070 6f6c 6963 795f           policy_
+000037b0: 7661 6c75 655f 6469 6374 5b65 7661 6c5f  value_dict[eval_
+000037c0: 706f 6c69 6379 5d5b 0a20 2020 2020 2020  policy][.       
+000037d0: 2020 2020 2020 2020 2020 2020 2065 7374               est
+000037e0: 696d 6174 6f72 5f6e 616d 650a 2020 2020  imator_name.    
+000037f0: 2020 2020 2020 2020 2020 2020 5d20 3d20              ] = 
+00003800: 6573 7469 6d61 746f 722e 6573 7469 6d61  estimator.estima
+00003810: 7465 5f70 6f6c 6963 795f 7661 6c75 6528  te_policy_value(
+00003820: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00003830: 2020 2020 202a 2a69 6e70 7574 5f64 6963       **input_dic
+00003840: 745b 6576 616c 5f70 6f6c 6963 795d 2c0a  t[eval_policy],.
+00003850: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003860: 2020 2020 2a2a 7365 6c66 2e69 6e70 7574      **self.input
+00003870: 5f64 6963 745f 2c0a 2020 2020 2020 2020  _dict_,.        
+00003880: 2020 2020 2020 2020 2020 2020 6e5f 7374              n_st
+00003890: 6570 5f70 6469 733d 7365 6c66 2e6e 5f73  ep_pdis=self.n_s
+000038a0: 7465 705f 7064 6973 2c0a 2020 2020 2020  tep_pdis,.      
+000038b0: 2020 2020 2020 2020 2020 2020 2020 6469                di
+000038c0: 7361 626c 655f 7265 7761 7264 5f61 6674  sable_reward_aft
+000038d0: 6572 5f64 6f6e 653d 7365 6c66 2e64 6973  er_done=self.dis
+000038e0: 6162 6c65 5f72 6577 6172 645f 6166 7465  able_reward_afte
+000038f0: 725f 646f 6e65 2c0a 2020 2020 2020 2020  r_done,.        
+00003900: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00003910: 2020 7265 7475 726e 2064 6566 6175 6c74    return default
+00003920: 6469 6374 5f74 6f5f 6469 6374 2870 6f6c  dict_to_dict(pol
+00003930: 6963 795f 7661 6c75 655f 6469 6374 290a  icy_value_dict).
+00003940: 0a20 2020 2064 6566 205f 6573 7469 6d61  .    def _estima
+00003950: 7465 5f69 6e74 6572 7661 6c73 280a 2020  te_intervals(.  
+00003960: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
+00003970: 2020 2020 696e 7075 745f 6469 6374 3a20      input_dict: 
+00003980: 4f50 4549 6e70 7574 4469 6374 2c0a 2020  OPEInputDict,.  
+00003990: 2020 2020 2020 636f 6d70 6172 6564 5f65        compared_e
+000039a0: 7374 696d 6174 6f72 733a 204f 7074 696f  stimators: Optio
+000039b0: 6e61 6c5b 4c69 7374 5b73 7472 5d5d 203d  nal[List[str]] =
+000039c0: 204e 6f6e 652c 0a20 2020 2020 2020 2061   None,.        a
+000039d0: 6c70 6861 3a20 666c 6f61 7420 3d20 302e  lpha: float = 0.
+000039e0: 3035 2c0a 2020 2020 2020 2020 6369 3a20  05,.        ci: 
+000039f0: 7374 7220 3d20 2262 6f6f 7473 7472 6170  str = "bootstrap
+00003a00: 222c 0a20 2020 2020 2020 206e 5f62 6f6f  ",.        n_boo
+00003a10: 7473 7472 6170 5f73 616d 706c 6573 3a20  tstrap_samples: 
+00003a20: 696e 7420 3d20 3130 302c 0a20 2020 2020  int = 100,.     
+00003a30: 2020 2072 616e 646f 6d5f 7374 6174 653a     random_state:
+00003a40: 204f 7074 696f 6e61 6c5b 696e 745d 203d   Optional[int] =
+00003a50: 204e 6f6e 652c 0a20 2020 2029 202d 3e20   None,.    ) -> 
+00003a60: 4469 6374 5b73 7472 2c20 4469 6374 5b73  Dict[str, Dict[s
+00003a70: 7472 2c20 666c 6f61 745d 5d3a 0a20 2020  tr, float]]:.   
+00003a80: 2020 2020 2022 2222 4573 7469 6d61 7465       """Estimate
+00003a90: 2074 6865 2063 6f6e 6669 6465 6e63 6520   the confidence 
+00003aa0: 696e 7465 7276 616c 7320 6f66 2074 6865  intervals of the
+00003ab0: 2070 6f6c 6963 7920 7661 6c75 6520 6279   policy value by
+00003ac0: 206e 6f6e 7061 7261 6d65 7472 6963 2062   nonparametric b
+00003ad0: 6f6f 7473 7472 6170 2e0a 0a20 2020 2020  ootstrap...     
+00003ae0: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
+00003af0: 2020 2020 2020 2d2d 2d2d 2d2d 2d0a 2020        -------.  
+00003b00: 2020 2020 2020 696e 7075 745f 6469 6374        input_dict
+00003b10: 3a20 4f50 4549 6e70 7574 4469 6374 0a20  : OPEInputDict. 
+00003b20: 2020 2020 2020 2020 2020 2044 6963 7469             Dicti
+00003b30: 6f6e 6172 7920 6f66 2074 6865 204f 5045  onary of the OPE
+00003b40: 2069 6e70 7574 7320 666f 7220 6561 6368   inputs for each
+00003b50: 2065 7661 6c75 6174 696f 6e20 706f 6c69   evaluation poli
+00003b60: 6379 2e0a 0a20 2020 2020 2020 2020 2020  cy...           
+00003b70: 202e 2e20 636f 6465 2d62 6c6f 636b 3a3a   .. code-block::
+00003b80: 2070 7974 686f 6e0a 0a20 2020 2020 2020   python..       
+00003b90: 2020 2020 2020 2020 206b 6579 3a20 5b65           key: [e
+00003ba0: 7661 6c75 6174 696f 6e5f 706f 6c69 6379  valuation_policy
+00003bb0: 5d5b 0a20 2020 2020 2020 2020 2020 2020  ][.             
+00003bc0: 2020 2020 2020 2065 7661 6c75 6174 696f         evaluatio
+00003bd0: 6e5f 706f 6c69 6379 5f61 6374 696f 6e2c  n_policy_action,
+00003be0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00003bf0: 2020 2020 2065 7661 6c75 6174 696f 6e5f       evaluation_
+00003c00: 706f 6c69 6379 5f61 6374 696f 6e5f 6469  policy_action_di
+00003c10: 7374 2c0a 2020 2020 2020 2020 2020 2020  st,.            
+00003c20: 2020 2020 2020 2020 7374 6174 655f 6163          state_ac
+00003c30: 7469 6f6e 5f76 616c 7565 5f70 7265 6469  tion_value_predi
+00003c40: 6374 696f 6e2c 0a20 2020 2020 2020 2020  ction,.         
+00003c50: 2020 2020 2020 2020 2020 2069 6e69 7469             initi
+00003c60: 616c 5f73 7461 7465 5f76 616c 7565 5f70  al_state_value_p
+00003c70: 7265 6469 6374 696f 6e2c 0a20 2020 2020  rediction,.     
+00003c80: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00003c90: 7461 7465 5f61 6374 696f 6e5f 6d61 7267  tate_action_marg
+00003ca0: 696e 616c 5f69 6d70 6f72 7461 6e63 655f  inal_importance_
+00003cb0: 7765 6967 6874 2c0a 2020 2020 2020 2020  weight,.        
+00003cc0: 2020 2020 2020 2020 2020 2020 7374 6174              stat
+00003cd0: 655f 6d61 7267 696e 616c 5f69 6d70 6f72  e_marginal_impor
+00003ce0: 7461 6e63 655f 7765 6967 6874 2c0a 2020  tance_weight,.  
+00003cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003d00: 2020 6f6e 5f70 6f6c 6963 795f 706f 6c69    on_policy_poli
+00003d10: 6379 5f76 616c 7565 2c0a 2020 2020 2020  cy_value,.      
+00003d20: 2020 2020 2020 2020 2020 2020 2020 6761                ga
+00003d30: 6d6d 612c 0a20 2020 2020 2020 2020 2020  mma,.           
+00003d40: 2020 2020 2020 2020 2062 6568 6176 696f           behavio
+00003d50: 725f 706f 6c69 6379 2c0a 2020 2020 2020  r_policy,.      
+00003d60: 2020 2020 2020 2020 2020 2020 2020 6576                ev
+00003d70: 616c 7561 7469 6f6e 5f70 6f6c 6963 792c  aluation_policy,
+00003d80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00003d90: 2020 2020 2064 6174 6173 6574 5f69 642c       dataset_id,
+00003da0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00003db0: 205d 0a0a 2020 2020 2020 2020 2020 2020   ]..            
+00003dc0: 2e2e 2073 6565 616c 736f 3a3a 0a0a 2020  .. seealso::..  
+00003dd0: 2020 2020 2020 2020 2020 2020 2020 3a63                :c
+00003de0: 6c61 7373 3a60 7363 6f70 655f 726c 2e6f  lass:`scope_rl.o
+00003df0: 7065 2e69 6e70 7574 2e43 7265 6174 654f  pe.input.CreateO
+00003e00: 5045 496e 7075 7460 2064 6573 6372 6962  PEInput` describ
+00003e10: 6573 2074 6865 2063 6f6d 706f 6e65 6e74  es the component
+00003e20: 7320 6f66 203a 636c 6173 733a 6069 6e70  s of :class:`inp
+00003e30: 7574 5f64 6963 7460 2e0a 0a20 2020 2020  ut_dict`...     
+00003e40: 2020 2063 6f6d 7061 7265 645f 6573 7469     compared_esti
+00003e50: 6d61 746f 7273 3a20 6c69 7374 206f 6620  mators: list of 
+00003e60: 7374 722c 2064 6566 6175 6c74 3d4e 6f6e  str, default=Non
+00003e70: 650a 2020 2020 2020 2020 2020 2020 4e61  e.            Na
+00003e80: 6d65 206f 6620 636f 6d70 6172 6564 2065  me of compared e
+00003e90: 7374 696d 6174 6f72 732e 0a20 2020 2020  stimators..     
+00003ea0: 2020 2020 2020 2049 6620 604e 6f6e 6560         If `None`
+00003eb0: 2069 7320 6769 7665 6e2c 2061 6c6c 2074   is given, all t
+00003ec0: 6865 2065 7374 696d 6174 6f72 7320 6172  he estimators ar
+00003ed0: 6520 636f 6d70 6172 6564 2e0a 0a20 2020  e compared...   
+00003ee0: 2020 2020 2061 6c70 6861 3a20 666c 6f61       alpha: floa
+00003ef0: 742c 2064 6566 6175 6c74 3d30 2e30 350a  t, default=0.05.
+00003f00: 2020 2020 2020 2020 2020 2020 5369 676e              Sign
+00003f10: 6966 6963 616e 6365 206c 6576 656c 2e20  ificance level. 
+00003f20: 5468 6520 7661 6c75 6520 7368 6f75 6c64  The value should
+00003f30: 2062 6520 7769 7468 696e 2060 5b30 2c20   be within `[0, 
+00003f40: 3129 602e 0a0a 2020 2020 2020 2020 6369  1)`...        ci
+00003f50: 3a20 7b22 626f 6f74 7374 7261 7022 2c20  : {"bootstrap", 
+00003f60: 2268 6f65 6666 6469 6e67 222c 2022 6265  "hoeffding", "be
+00003f70: 726e 7374 6569 6e22 2c20 2274 7465 7374  rnstein", "ttest
+00003f80: 227d 2c20 6465 6661 756c 743d 2262 6f6f  "}, default="boo
+00003f90: 7473 7472 6170 220a 2020 2020 2020 2020  tstrap".        
+00003fa0: 2020 2020 4d65 7468 6f64 2074 6f20 6573      Method to es
+00003fb0: 7469 6d61 7465 2074 6865 2063 6f6e 6669  timate the confi
+00003fc0: 6465 6e63 6520 696e 7465 7276 616c 2e0a  dence interval..
+00003fd0: 0a20 2020 2020 2020 206e 5f62 6f6f 7473  .        n_boots
+00003fe0: 7472 6170 5f73 616d 706c 6573 3a20 696e  trap_samples: in
+00003ff0: 742c 2064 6566 6175 6c74 3d31 3030 2028  t, default=100 (
+00004000: 3e20 3029 0a20 2020 2020 2020 2020 2020  > 0).           
+00004010: 204e 756d 6265 7220 6f66 2072 6573 616d   Number of resam
+00004020: 706c 696e 6720 7065 7266 6f72 6d65 6420  pling performed 
+00004030: 696e 2074 6865 2062 6f6f 7473 7472 6170  in the bootstrap
+00004040: 2070 726f 6365 6475 7265 2e0a 0a20 2020   procedure...   
+00004050: 2020 2020 2072 616e 646f 6d5f 7374 6174       random_stat
+00004060: 653a 2069 6e74 2c20 6465 6661 756c 743d  e: int, default=
+00004070: 4e6f 6e65 2028 3e3d 2030 290a 2020 2020  None (>= 0).    
+00004080: 2020 2020 2020 2020 5261 6e64 6f6d 2073          Random s
+00004090: 7461 7465 2e0a 0a20 2020 2020 2020 2052  tate...        R
+000040a0: 6574 7572 6e0a 2020 2020 2020 2020 2d2d  eturn.        --
+000040b0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 706f  -----.        po
+000040c0: 6c69 6379 5f76 616c 7565 5f69 6e74 6572  licy_value_inter
+000040d0: 7661 6c5f 6469 6374 3a20 6469 6374 0a20  val_dict: dict. 
+000040e0: 2020 2020 2020 2020 2020 2044 6963 7469             Dicti
+000040f0: 6f6e 6172 7920 636f 6e74 6169 6e69 6e67  onary containing
+00004100: 2074 6865 2063 6f6e 6669 6465 6e63 6520   the confidence 
+00004110: 696e 7465 7276 616c 7320 6573 7469 6d61  intervals estima
+00004120: 7465 6420 6279 206e 6f6e 7061 7261 6d65  ted by nonparame
+00004130: 7472 6963 2062 6f6f 7473 7472 6170 2e0a  tric bootstrap..
+00004140: 2020 2020 2020 2020 2020 2020 6b65 793a              key:
+00004150: 203a 636c 6173 733a 605b 6576 616c 7561   :class:`[evalua
+00004160: 7469 6f6e 5f70 6f6c 6963 795d 5b4f 5045  tion_policy][OPE
+00004170: 5f65 7374 696d 6174 6f72 5f6e 616d 655d  _estimator_name]
+00004180: 600a 0a20 2020 2020 2020 2052 6566 6572  `..        Refer
+00004190: 656e 6365 730a 2020 2020 2020 2020 2d2d  ences.        --
+000041a0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 4a6f  -----.        Jo
+000041b0: 7369 6168 2050 2e20 4861 6e6e 612c 2050  siah P. Hanna, P
+000041c0: 6574 6572 2053 746f 6e65 2c20 616e 6420  eter Stone, and 
+000041d0: 5363 6f74 7420 4e69 656b 756d 2e0a 2020  Scott Niekum..  
+000041e0: 2020 2020 2020 2242 6f6f 7473 7472 6170        "Bootstrap
+000041f0: 7069 6e67 2077 6974 6820 4d6f 6465 6c73  ping with Models
+00004200: 3a20 436f 6e66 6964 656e 6365 2049 6e74  : Confidence Int
+00004210: 6572 7661 6c73 2066 6f72 204f 6666 2d50  ervals for Off-P
+00004220: 6f6c 6963 7920 4576 616c 7561 7469 6f6e  olicy Evaluation
+00004230: 2e22 2032 3031 372e 0a0a 2020 2020 2020  ." 2017...      
+00004240: 2020 5068 696c 6970 2053 2e20 5468 6f6d    Philip S. Thom
+00004250: 6173 2c20 4765 6f72 6769 6f73 2054 6865  as, Georgios The
+00004260: 6f63 6861 726f 7573 2c20 616e 6420 4d6f  ocharous, and Mo
+00004270: 6861 6d6d 6164 2047 6861 7661 6d7a 6164  hammad Ghavamzad
+00004280: 6568 2e0a 2020 2020 2020 2020 2248 6967  eh..        "Hig
+00004290: 6820 436f 6e66 6964 656e 6365 2050 6f6c  h Confidence Pol
+000042a0: 6963 7920 496d 7072 6f76 656d 656e 742e  icy Improvement.
+000042b0: 2220 3230 3135 2e0a 0a20 2020 2020 2020  " 2015...       
+000042c0: 2050 6869 6c69 7020 532e 2054 686f 6d61   Philip S. Thoma
+000042d0: 732c 2047 656f 7267 696f 7320 5468 656f  s, Georgios Theo
+000042e0: 6368 6172 6f75 732c 2061 6e64 204d 6f68  charous, and Moh
+000042f0: 616d 6d61 6420 4768 6176 616d 7a61 6465  ammad Ghavamzade
+00004300: 682e 0a20 2020 2020 2020 2022 4869 6768  h..        "High
+00004310: 2043 6f6e 6669 6465 6e63 6520 4f66 662d   Confidence Off-
+00004320: 506f 6c69 6379 2045 7661 6c75 6174 696f  Policy Evaluatio
+00004330: 6e2e 2220 3230 3135 2e0a 0a20 2020 2020  n." 2015...     
+00004340: 2020 2022 2222 0a20 2020 2020 2020 2063     """.        c
+00004350: 6865 636b 5f69 6e70 7574 5f64 6963 7428  heck_input_dict(
+00004360: 696e 7075 745f 6469 6374 290a 0a20 2020  input_dict)..   
+00004370: 2020 2020 2070 6f6c 6963 795f 7661 6c75       policy_valu
+00004380: 655f 696e 7465 7276 616c 5f64 6963 7420  e_interval_dict 
+00004390: 3d20 6465 6661 756c 7464 6963 7428 6469  = defaultdict(di
+000043a0: 6374 290a 2020 2020 2020 2020 666f 7220  ct).        for 
+000043b0: 6576 616c 5f70 6f6c 6963 7920 696e 2069  eval_policy in i
+000043c0: 6e70 7574 5f64 6963 742e 6b65 7973 2829  nput_dict.keys()
+000043d0: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+000043e0: 2069 6e70 7574 5f64 6963 745b 6576 616c   input_dict[eval
+000043f0: 5f70 6f6c 6963 795d 5b22 6f6e 5f70 6f6c  _policy]["on_pol
+00004400: 6963 795f 706f 6c69 6379 5f76 616c 7565  icy_policy_value
+00004410: 225d 2069 7320 6e6f 7420 4e6f 6e65 3a0a  "] is not None:.
+00004420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004430: 706f 6c69 6379 5f76 616c 7565 5f69 6e74  policy_value_int
+00004440: 6572 7661 6c5f 6469 6374 5b65 7661 6c5f  erval_dict[eval_
+00004450: 706f 6c69 6379 5d5b 0a20 2020 2020 2020  policy][.       
+00004460: 2020 2020 2020 2020 2020 2020 2022 6f6e               "on
+00004470: 5f70 6f6c 6963 7922 0a20 2020 2020 2020  _policy".       
+00004480: 2020 2020 2020 2020 205d 203d 2073 656c           ] = sel
+00004490: 662e 5f65 7374 696d 6174 655f 636f 6e66  f._estimate_conf
+000044a0: 6964 656e 6365 5f69 6e74 6572 7661 6c5b  idence_interval[
+000044b0: 6369 5d28 0a20 2020 2020 2020 2020 2020  ci](.           
+000044c0: 2020 2020 2020 2020 2069 6e70 7574 5f64           input_d
+000044d0: 6963 745b 6576 616c 5f70 6f6c 6963 795d  ict[eval_policy]
+000044e0: 5b22 6f6e 5f70 6f6c 6963 795f 706f 6c69  ["on_policy_poli
+000044f0: 6379 5f76 616c 7565 225d 2c0a 2020 2020  cy_value"],.    
+00004500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004510: 616c 7068 613d 616c 7068 612c 0a20 2020  alpha=alpha,.   
 00004520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004530: 2020 2069 6e70 7574 5f64 6963 745b 6576     input_dict[ev
-00004540: 616c 5f70 6f6c 6963 795d 5b22 6f6e 5f70  al_policy]["on_p
-00004550: 6f6c 6963 795f 706f 6c69 6379 5f76 616c  olicy_policy_val
-00004560: 7565 225d 2c0a 2020 2020 2020 2020 2020  ue"],.          
-00004570: 2020 2020 2020 2020 2020 616c 7068 613d            alpha=
-00004580: 616c 7068 612c 0a20 2020 2020 2020 2020  alpha,.         
-00004590: 2020 2020 2020 2020 2020 206e 5f62 6f6f             n_boo
-000045a0: 7473 7472 6170 5f73 616d 706c 6573 3d6e  tstrap_samples=n
-000045b0: 5f62 6f6f 7473 7472 6170 5f73 616d 706c  _bootstrap_sampl
-000045c0: 6573 2c0a 2020 2020 2020 2020 2020 2020  es,.            
-000045d0: 2020 2020 2020 2020 7261 6e64 6f6d 5f73          random_s
-000045e0: 7461 7465 3d72 616e 646f 6d5f 7374 6174  tate=random_stat
-000045f0: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
-00004600: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-00004610: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00004620: 2020 2020 2020 2070 6f6c 6963 795f 7661         policy_va
-00004630: 6c75 655f 696e 7465 7276 616c 5f64 6963  lue_interval_dic
-00004640: 745b 6576 616c 5f70 6f6c 6963 795d 5b22  t[eval_policy]["
-00004650: 6f6e 5f70 6f6c 6963 7922 5d20 3d20 4e6f  on_policy"] = No
-00004660: 6e65 0a0a 2020 2020 2020 2020 2020 2020  ne..            
-00004670: 666f 7220 6573 7469 6d61 746f 725f 6e61  for estimator_na
-00004680: 6d65 2069 6e20 636f 6d70 6172 6564 5f65  me in compared_e
-00004690: 7374 696d 6174 6f72 733a 0a20 2020 2020  stimators:.     
-000046a0: 2020 2020 2020 2020 2020 2065 7374 696d             estim
-000046b0: 6174 6f72 203d 2073 656c 662e 6f70 655f  ator = self.ope_
-000046c0: 6573 7469 6d61 746f 7273 5f5b 6573 7469  estimators_[esti
-000046d0: 6d61 746f 725f 6e61 6d65 5d0a 2020 2020  mator_name].    
-000046e0: 2020 2020 2020 2020 2020 2020 706f 6c69              poli
-000046f0: 6379 5f76 616c 7565 5f69 6e74 6572 7661  cy_value_interva
-00004700: 6c5f 6469 6374 5b65 7661 6c5f 706f 6c69  l_dict[eval_poli
-00004710: 6379 5d5b 0a20 2020 2020 2020 2020 2020  cy][.           
-00004720: 2020 2020 2020 2020 2065 7374 696d 6174           estimat
-00004730: 6f72 5f6e 616d 650a 2020 2020 2020 2020  or_name.        
-00004740: 2020 2020 2020 2020 5d20 3d20 6573 7469          ] = esti
-00004750: 6d61 746f 722e 6573 7469 6d61 7465 5f69  mator.estimate_i
-00004760: 6e74 6572 7661 6c28 0a20 2020 2020 2020  nterval(.       
-00004770: 2020 2020 2020 2020 2020 2020 202a 2a69               **i
-00004780: 6e70 7574 5f64 6963 745b 6576 616c 5f70  nput_dict[eval_p
-00004790: 6f6c 6963 795d 2c0a 2020 2020 2020 2020  olicy],.        
-000047a0: 2020 2020 2020 2020 2020 2020 2a2a 7365              **se
-000047b0: 6c66 2e69 6e70 7574 5f64 6963 745f 2c0a  lf.input_dict_,.
-000047c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000047d0: 2020 2020 6e5f 7374 6570 5f70 6469 733d      n_step_pdis=
-000047e0: 7365 6c66 2e6e 5f73 7465 705f 7064 6973  self.n_step_pdis
-000047f0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00004800: 2020 2020 2020 6469 7361 626c 655f 7265        disable_re
-00004810: 7761 7264 5f61 6674 6572 5f64 6f6e 653d  ward_after_done=
-00004820: 7365 6c66 2e64 6973 6162 6c65 5f72 6577  self.disable_rew
-00004830: 6172 645f 6166 7465 725f 646f 6e65 2c0a  ard_after_done,.
-00004840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004850: 2020 2020 616c 7068 613d 616c 7068 612c      alpha=alpha,
-00004860: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00004870: 2020 2020 2063 693d 6369 2c0a 2020 2020       ci=ci,.    
-00004880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004890: 6e5f 626f 6f74 7374 7261 705f 7361 6d70  n_bootstrap_samp
-000048a0: 6c65 733d 6e5f 626f 6f74 7374 7261 705f  les=n_bootstrap_
-000048b0: 7361 6d70 6c65 732c 0a20 2020 2020 2020  samples,.       
-000048c0: 2020 2020 2020 2020 2020 2020 2072 616e               ran
-000048d0: 646f 6d5f 7374 6174 653d 7261 6e64 6f6d  dom_state=random
-000048e0: 5f73 7461 7465 2c0a 2020 2020 2020 2020  _state,.        
-000048f0: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
-00004900: 2020 2072 6574 7572 6e20 6465 6661 756c     return defaul
-00004910: 7464 6963 745f 746f 5f64 6963 7428 706f  tdict_to_dict(po
-00004920: 6c69 6379 5f76 616c 7565 5f69 6e74 6572  licy_value_inter
-00004930: 7661 6c5f 6469 6374 290a 0a20 2020 2064  val_dict)..    d
-00004940: 6566 205f 7375 6d6d 6172 697a 655f 6f66  ef _summarize_of
-00004950: 665f 706f 6c69 6379 5f65 7374 696d 6174  f_policy_estimat
-00004960: 6573 280a 2020 2020 2020 2020 7365 6c66  es(.        self
-00004970: 2c0a 2020 2020 2020 2020 706f 6c69 6379  ,.        policy
-00004980: 5f76 616c 7565 5f64 6963 743a 2044 6963  _value_dict: Dic
-00004990: 745b 7374 722c 2041 6e79 5d2c 0a20 2020  t[str, Any],.   
-000049a0: 2020 2020 2070 6f6c 6963 795f 7661 6c75       policy_valu
-000049b0: 655f 696e 7465 7276 616c 5f64 6963 743a  e_interval_dict:
-000049c0: 2044 6963 745b 7374 722c 2041 6e79 5d2c   Dict[str, Any],
-000049d0: 0a20 2020 2029 202d 3e20 5475 706c 655b  .    ) -> Tuple[
-000049e0: 4469 6374 5b73 7472 2c20 4461 7461 4672  Dict[str, DataFr
-000049f0: 616d 655d 2c20 4469 6374 5b73 7472 2c20  ame], Dict[str, 
-00004a00: 4461 7461 4672 616d 655d 5d3a 0a20 2020  DataFrame]]:.   
-00004a10: 2020 2020 2022 2222 5375 6d6d 6172 697a       """Summariz
-00004a20: 6520 7468 6520 706f 6c69 6379 2076 616c  e the policy val
-00004a30: 7565 2061 6e64 2074 6865 6972 2063 6f6e  ue and their con
-00004a40: 6669 6465 6e63 6520 696e 7465 7276 616c  fidence interval
-00004a50: 7320 6573 7469 6d61 7465 6420 6279 204f  s estimated by O
-00004a60: 5045 2065 7374 696d 6174 6f72 732e 0a0a  PE estimators...
-00004a70: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
-00004a80: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
-00004a90: 2d2d 0a20 2020 2020 2020 2070 6f6c 6963  --.        polic
-00004aa0: 795f 7661 6c75 655f 6469 6374 3a20 6469  y_value_dict: di
-00004ab0: 6374 0a20 2020 2020 2020 2020 2020 2044  ct.            D
-00004ac0: 6963 7469 6f6e 6172 7920 636f 6e74 6169  ictionary contai
-00004ad0: 6e69 6e67 2074 6865 2070 6f6c 6963 7920  ning the policy 
-00004ae0: 7661 6c75 6520 6f66 2065 6163 6820 6576  value of each ev
-00004af0: 616c 7561 7469 6f6e 2070 6f6c 6963 7920  aluation policy 
-00004b00: 6573 7469 6d61 7465 6420 6279 204f 5045  estimated by OPE
-00004b10: 2065 7374 696d 6174 6f72 732e 0a20 2020   estimators..   
-00004b20: 2020 2020 2020 2020 206b 6579 3a20 3a63           key: :c
-00004b30: 6c61 7373 3a60 5b65 7661 6c75 6174 696f  lass:`[evaluatio
-00004b40: 6e5f 706f 6c69 6379 5d5b 4f50 455f 6573  n_policy][OPE_es
-00004b50: 7469 6d61 746f 725f 6e61 6d65 5d60 0a0a  timator_name]`..
-00004b60: 2020 2020 2020 2020 706f 6c69 6379 5f76          policy_v
-00004b70: 616c 7565 5f69 6e74 6572 7661 6c5f 6469  alue_interval_di
-00004b80: 6374 3a20 6469 6374 0a20 2020 2020 2020  ct: dict.       
-00004b90: 2020 2020 2044 6963 7469 6f6e 6172 7920       Dictionary 
-00004ba0: 636f 6e74 6169 6e69 6e67 2074 6865 2063  containing the c
-00004bb0: 6f6e 6669 6465 6e63 6520 696e 7465 7276  onfidence interv
-00004bc0: 616c 7320 6573 7469 6d61 7465 6420 6279  als estimated by
-00004bd0: 206e 6f6e 7061 7261 6d65 7472 6963 2062   nonparametric b
-00004be0: 6f6f 7473 7472 6170 2e0a 2020 2020 2020  ootstrap..      
-00004bf0: 2020 2020 2020 6b65 793a 203a 636c 6173        key: :clas
-00004c00: 733a 605b 6576 616c 7561 7469 6f6e 5f70  s:`[evaluation_p
-00004c10: 6f6c 6963 795d 5b4f 5045 5f65 7374 696d  olicy][OPE_estim
-00004c20: 6174 6f72 5f6e 616d 655d 600a 0a20 2020  ator_name]`..   
-00004c30: 2020 2020 2052 6574 7572 6e0a 2020 2020       Return.    
-00004c40: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
-00004c50: 2020 2020 706f 6c69 6379 5f76 616c 7565      policy_value
-00004c60: 5f64 665f 6469 6374 3a20 6469 6374 0a20  _df_dict: dict. 
-00004c70: 2020 2020 2020 2020 2020 2044 6963 7469             Dicti
-00004c80: 6f6e 6172 7920 636f 6e74 6169 6e69 6e67  onary containing
-00004c90: 2074 6865 2070 6f6c 6963 7920 7661 6c75   the policy valu
-00004ca0: 6520 6f66 2065 6163 6820 6576 616c 7561  e of each evalua
-00004cb0: 7469 6f6e 2070 6f6c 6963 7920 6573 7469  tion policy esti
-00004cc0: 6d61 7465 6420 6279 204f 5045 2065 7374  mated by OPE est
-00004cd0: 696d 6174 6f72 732e 0a20 2020 2020 2020  imators..       
-00004ce0: 2020 2020 206b 6579 3a20 3a63 6c61 7373       key: :class
-00004cf0: 3a60 5b65 7661 6c75 6174 696f 6e5f 706f  :`[evaluation_po
-00004d00: 6c69 6379 5d5b 4f50 455f 6573 7469 6d61  licy][OPE_estima
-00004d10: 746f 725f 6e61 6d65 5d60 0a0a 2020 2020  tor_name]`..    
-00004d20: 2020 2020 706f 6c69 6379 5f76 616c 7565      policy_value
-00004d30: 5f69 6e74 6572 7661 6c5f 6466 5f64 6963  _interval_df_dic
-00004d40: 743a 2064 6963 740a 2020 2020 2020 2020  t: dict.        
-00004d50: 2020 2020 4469 6374 696f 6e61 7279 2063      Dictionary c
-00004d60: 6f6e 7461 696e 696e 6720 7468 6520 636f  ontaining the co
-00004d70: 6e66 6964 656e 6365 2069 6e74 6572 7661  nfidence interva
-00004d80: 6c73 2065 7374 696d 6174 6564 2062 7920  ls estimated by 
-00004d90: 6e6f 6e70 6172 616d 6574 7269 6320 626f  nonparametric bo
-00004da0: 6f74 7374 7261 702e 0a20 2020 2020 2020  otstrap..       
-00004db0: 2020 2020 206b 6579 3a20 3a63 6c61 7373       key: :class
-00004dc0: 3a60 5b65 7661 6c75 6174 696f 6e5f 706f  :`[evaluation_po
-00004dd0: 6c69 6379 5d5b 4f50 455f 6573 7469 6d61  licy][OPE_estima
-00004de0: 746f 725f 6e61 6d65 5d60 0a0a 2020 2020  tor_name]`..    
-00004df0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00004e00: 706f 6c69 6379 5f76 616c 7565 5f64 665f  policy_value_df_
-00004e10: 6469 6374 203d 2064 6963 7428 290a 2020  dict = dict().  
-00004e20: 2020 2020 2020 706f 6c69 6379 5f76 616c        policy_val
-00004e30: 7565 5f69 6e74 6572 7661 6c5f 6466 5f64  ue_interval_df_d
-00004e40: 6963 7420 3d20 6469 6374 2829 0a0a 2020  ict = dict()..  
-00004e50: 2020 2020 2020 666f 7220 6576 616c 5f70        for eval_p
-00004e60: 6f6c 6963 7920 696e 2070 6f6c 6963 795f  olicy in policy_
-00004e70: 7661 6c75 655f 6469 6374 2e6b 6579 7328  value_dict.keys(
-00004e80: 293a 0a20 2020 2020 2020 2020 2020 2070  ):.            p
-00004e90: 6f6c 6963 795f 7661 6c75 655f 6466 5f20  olicy_value_df_ 
-00004ea0: 3d20 4461 7461 4672 616d 6528 0a20 2020  = DataFrame(.   
-00004eb0: 2020 2020 2020 2020 2020 2020 2070 6f6c               pol
-00004ec0: 6963 795f 7661 6c75 655f 6469 6374 5b65  icy_value_dict[e
-00004ed0: 7661 6c5f 706f 6c69 6379 5d2c 0a20 2020  val_policy],.   
-00004ee0: 2020 2020 2020 2020 2020 2020 2069 6e64               ind
-00004ef0: 6578 3d5b 2270 6f6c 6963 795f 7661 6c75  ex=["policy_valu
-00004f00: 6522 5d2c 0a20 2020 2020 2020 2020 2020  e"],.           
-00004f10: 2029 2e54 0a0a 2020 2020 2020 2020 2020   ).T..          
-00004f20: 2020 6f6e 5f70 6f6c 6963 795f 706f 6c69    on_policy_poli
-00004f30: 6379 5f76 616c 7565 203d 204e 6f6e 650a  cy_value = None.
-00004f40: 2020 2020 2020 2020 2020 2020 6966 2070              if p
-00004f50: 6f6c 6963 795f 7661 6c75 655f 6469 6374  olicy_value_dict
-00004f60: 5b65 7661 6c5f 706f 6c69 6379 5d5b 226f  [eval_policy]["o
-00004f70: 6e5f 706f 6c69 6379 225d 2069 7320 6e6f  n_policy"] is no
-00004f80: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-00004f90: 2020 2020 2020 2020 6f6e 5f70 6f6c 6963          on_polic
-00004fa0: 795f 706f 6c69 6379 5f76 616c 7565 203d  y_policy_value =
-00004fb0: 2070 6f6c 6963 795f 7661 6c75 655f 6469   policy_value_di
-00004fc0: 6374 5b65 7661 6c5f 706f 6c69 6379 5d5b  ct[eval_policy][
-00004fd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00004fe0: 2020 2020 2022 6f6e 5f70 6f6c 6963 7922       "on_policy"
-00004ff0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00005000: 205d 2e6d 6561 6e28 290a 2020 2020 2020   ].mean().      
-00005010: 2020 2020 2020 6966 206f 6e5f 706f 6c69        if on_poli
-00005020: 6379 5f70 6f6c 6963 795f 7661 6c75 6520  cy_policy_value 
-00005030: 6973 206e 6f74 204e 6f6e 6520 616e 6420  is not None and 
-00005040: 6f6e 5f70 6f6c 6963 795f 706f 6c69 6379  on_policy_policy
-00005050: 5f76 616c 7565 203e 2030 3a0a 2020 2020  _value > 0:.    
-00005060: 2020 2020 2020 2020 2020 2020 706f 6c69              poli
-00005070: 6379 5f76 616c 7565 5f64 665f 5b22 7265  cy_value_df_["re
-00005080: 6c61 7469 7665 5f70 6f6c 6963 795f 7661  lative_policy_va
-00005090: 6c75 6522 5d20 3d20 280a 2020 2020 2020  lue"] = (.      
-000050a0: 2020 2020 2020 2020 2020 2020 2020 706f                po
-000050b0: 6c69 6379 5f76 616c 7565 5f64 665f 202f  licy_value_df_ /
-000050c0: 206f 6e5f 706f 6c69 6379 5f70 6f6c 6963   on_policy_polic
-000050d0: 795f 7661 6c75 650a 2020 2020 2020 2020  y_value.        
-000050e0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-000050f0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-00005100: 2020 2020 2020 2020 2020 2020 706f 6c69              poli
-00005110: 6379 5f76 616c 7565 5f64 665f 5b22 7265  cy_value_df_["re
-00005120: 6c61 7469 7665 5f70 6f6c 6963 795f 7661  lative_policy_va
-00005130: 6c75 6522 5d20 3d20 6e70 2e6e 616e 0a0a  lue"] = np.nan..
-00005140: 2020 2020 2020 2020 2020 2020 706f 6c69              poli
-00005150: 6379 5f76 616c 7565 5f64 665f 6469 6374  cy_value_df_dict
-00005160: 5b65 7661 6c5f 706f 6c69 6379 5d20 3d20  [eval_policy] = 
-00005170: 706f 6c69 6379 5f76 616c 7565 5f64 665f  policy_value_df_
-00005180: 0a20 2020 2020 2020 2020 2020 2070 6f6c  .            pol
-00005190: 6963 795f 7661 6c75 655f 696e 7465 7276  icy_value_interv
-000051a0: 616c 5f64 665f 6469 6374 5b65 7661 6c5f  al_df_dict[eval_
-000051b0: 706f 6c69 6379 5d20 3d20 4461 7461 4672  policy] = DataFr
-000051c0: 616d 6528 0a20 2020 2020 2020 2020 2020  ame(.           
-000051d0: 2020 2020 2070 6f6c 6963 795f 7661 6c75       policy_valu
-000051e0: 655f 696e 7465 7276 616c 5f64 6963 745b  e_interval_dict[
-000051f0: 6576 616c 5f70 6f6c 6963 795d 2c0a 2020  eval_policy],.  
-00005200: 2020 2020 2020 2020 2020 292e 540a 0a20            ).T.. 
-00005210: 2020 2020 2020 2072 6574 7572 6e20 706f         return po
-00005220: 6c69 6379 5f76 616c 7565 5f64 665f 6469  licy_value_df_di
-00005230: 6374 2c20 706f 6c69 6379 5f76 616c 7565  ct, policy_value
-00005240: 5f69 6e74 6572 7661 6c5f 6466 5f64 6963  _interval_df_dic
-00005250: 740a 0a20 2020 2064 6566 205f 6576 616c  t..    def _eval
-00005260: 7561 7465 5f70 6572 666f 726d 616e 6365  uate_performance
-00005270: 5f6f 665f 6f70 655f 6573 7469 6d61 746f  _of_ope_estimato
-00005280: 7273 280a 2020 2020 2020 2020 7365 6c66  rs(.        self
-00005290: 2c0a 2020 2020 2020 2020 696e 7075 745f  ,.        input_
-000052a0: 6469 6374 3a20 4f50 4549 6e70 7574 4469  dict: OPEInputDi
-000052b0: 6374 2c0a 2020 2020 2020 2020 706f 6c69  ct,.        poli
-000052c0: 6379 5f76 616c 7565 5f64 6963 743a 2044  cy_value_dict: D
-000052d0: 6963 745b 7374 722c 2041 6e79 5d2c 0a20  ict[str, Any],. 
-000052e0: 2020 2020 2020 2063 6f6d 7061 7265 645f         compared_
-000052f0: 6573 7469 6d61 746f 7273 3a20 4f70 7469  estimators: Opti
-00005300: 6f6e 616c 5b4c 6973 745b 7374 725d 5d20  onal[List[str]] 
-00005310: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-00005320: 6d65 7472 6963 3a20 7374 7220 3d20 2272  metric: str = "r
-00005330: 656c 6174 6976 652d 6565 222c 0a20 2020  elative-ee",.   
-00005340: 2020 2020 2072 6574 7572 6e5f 6279 5f64       return_by_d
-00005350: 6174 6166 7261 6d65 3a20 626f 6f6c 203d  ataframe: bool =
-00005360: 2046 616c 7365 2c0a 2020 2020 2920 2d3e   False,.    ) ->
-00005370: 2044 6963 745b 7374 722c 2044 6963 745b   Dict[str, Dict[
-00005380: 7374 722c 2066 6c6f 6174 5d5d 3a0a 2020  str, float]]:.  
-00005390: 2020 2020 2020 2222 2245 7661 6c75 6174        """Evaluat
-000053a0: 6520 7468 6520 6573 7469 6d61 7469 6f6e  e the estimation
-000053b0: 2070 6572 666f 726d 616e 6365 2f61 6363   performance/acc
-000053c0: 7572 6163 7920 6f66 204f 5045 2065 7374  uracy of OPE est
-000053d0: 696d 6174 6f72 732e 0a0a 2020 2020 2020  imators...      
-000053e0: 2020 4e6f 7465 0a20 2020 2020 2020 202d    Note.        -
-000053f0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2045  ------.        E
-00005400: 7661 6c75 6174 6520 7468 6520 6573 7469  valuate the esti
-00005410: 6d61 7469 6f6e 2070 6572 666f 726d 616e  mation performan
-00005420: 6365 2f61 6363 7572 6163 7920 6f66 204f  ce/accuracy of O
-00005430: 5045 2065 7374 696d 6174 6f72 7320 6279  PE estimators by
-00005440: 2072 656c 6174 6976 6520 6573 7469 6d61   relative estima
-00005450: 7469 6f6e 2065 7272 6f72 2028 7265 6c61  tion error (rela
-00005460: 7469 7665 2d45 4529 206f 7220 7371 7561  tive-EE) or squa
-00005470: 7265 6420 6572 726f 7220 2853 4529 2e0a  red error (SE)..
-00005480: 0a20 2020 2020 2020 202e 2e20 6d61 7468  .        .. math
-00005490: 3a3a 0a0a 2020 2020 2020 2020 2020 2020  ::..            
-000054a0: 5c5c 6d61 7468 726d 7b52 656c 6174 6976  \\mathrm{Relativ
-000054b0: 652d 4545 7d28 5c5c 6861 747b 567d 3b20  e-EE}(\\hat{V}; 
-000054c0: 5c5c 6d61 7468 6361 6c7b 447d 290a 2020  \\mathcal{D}).  
-000054d0: 2020 2020 2020 2020 2020 3a3d 205c 5c6c            := \\l
-000054e0: 6566 747c 205c 5c66 7261 637b 5c5c 6861  eft| \\frac{\\ha
-000054f0: 747b 567d 285c 5c70 693b 205c 5c6d 6174  t{V}(\\pi; \\mat
-00005500: 6863 616c 7b44 7d29 202d 2056 5f7b 5c5c  hcal{D}) - V_{\\
-00005510: 6d61 7468 726d 7b6f 6e7d 7d28 5c5c 7069  mathrm{on}}(\\pi
-00005520: 297d 7b56 5f7b 5c5c 6d61 7468 726d 7b6f  )}{V_{\\mathrm{o
-00005530: 6e7d 7d28 5c5c 7069 297d 205c 5c72 6967  n}}(\\pi)} \\rig
-00005540: 6874 7c2c 0a0a 2020 2020 2020 2020 2e2e  ht|,..        ..
-00005550: 206d 6174 683a 3a0a 0a20 2020 2020 2020   math::..       
-00005560: 2020 2020 205c 5c6d 6174 6872 6d7b 5345       \\mathrm{SE
-00005570: 7d28 5c5c 6861 747b 567d 3b20 5c5c 6d61  }(\\hat{V}; \\ma
-00005580: 7468 6361 6c7b 447d 2920 3a3d 205c 5c6c  thcal{D}) := \\l
-00005590: 6566 7428 205c 5c68 6174 7b56 7d28 5c5c  eft( \\hat{V}(\\
-000055a0: 7069 3b20 5c5c 6d61 7468 6361 6c7b 447d  pi; \\mathcal{D}
-000055b0: 2920 2d20 565f 7b5c 5c6d 6174 6872 6d7b  ) - V_{\\mathrm{
-000055c0: 6f6e 7d7d 205c 5c72 6967 6874 295e 322c  on}} \\right)^2,
-000055d0: 0a0a 2020 2020 2020 2020 7768 6572 6520  ..        where 
-000055e0: 3a6d 6174 683a 6056 5f7b 5c5c 6d61 7468  :math:`V_{\\math
-000055f0: 726d 7b6f 6e7d 7d28 5c5c 7069 2960 2069  rm{on}}(\\pi)` i
-00005600: 7320 7468 6520 6f6e 2d70 6f6c 6963 7920  s the on-policy 
-00005610: 706f 6c69 6379 2076 616c 7565 206f 6620  policy value of 
-00005620: 7468 6520 6576 616c 7561 7469 6f6e 2070  the evaluation p
-00005630: 6f6c 6963 7920 3a6d 6174 683a 605c 5c70  olicy :math:`\\p
-00005640: 6960 2e0a 2020 2020 2020 2020 3a6d 6174  i`..        :mat
-00005650: 683a 605c 5c68 6174 7b56 7d28 5c5c 7069  h:`\\hat{V}(\\pi
-00005660: 3b20 5c5c 6d61 7468 6361 6c7b 447d 2960  ; \\mathcal{D})`
-00005670: 2069 7320 7468 6520 706f 6c69 6379 2076   is the policy v
-00005680: 616c 7565 2065 7374 696d 6174 6564 2062  alue estimated b
-00005690: 7920 7468 6520 4f50 4520 6573 7469 6d61  y the OPE estima
-000056a0: 746f 7220 3a6d 6174 683a 605c 5c68 6174  tor :math:`\\hat
-000056b0: 7b56 7d60 2061 6e64 206c 6f67 6765 6420  {V}` and logged 
-000056c0: 6461 7461 7365 7420 3a6d 6174 683a 605c  dataset :math:`\
-000056d0: 5c6d 6174 6863 616c 7b44 7d60 2e0a 0a20  \mathcal{D}`... 
-000056e0: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
-000056f0: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
-00005700: 2d0a 2020 2020 2020 2020 696e 7075 745f  -.        input_
-00005710: 6469 6374 3a20 4f50 4549 6e70 7574 4469  dict: OPEInputDi
-00005720: 6374 206f 7220 4d75 6c74 6970 6c65 496e  ct or MultipleIn
-00005730: 7075 7444 6963 740a 2020 2020 2020 2020  putDict.        
-00005740: 2020 2020 4469 6374 696f 6e61 7279 206f      Dictionary o
-00005750: 6620 7468 6520 4f50 4520 696e 7075 7473  f the OPE inputs
-00005760: 2066 6f72 2065 6163 6820 6576 616c 7561   for each evalua
-00005770: 7469 6f6e 2070 6f6c 6963 792e 0a0a 2020  tion policy...  
-00005780: 2020 2020 2020 2020 2020 2e2e 2063 6f64            .. cod
-00005790: 652d 626c 6f63 6b3a 3a20 7079 7468 6f6e  e-block:: python
-000057a0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000057b0: 2020 6b65 793a 205b 6576 616c 7561 7469    key: [evaluati
-000057c0: 6f6e 5f70 6f6c 6963 795d 5b0a 2020 2020  on_policy][.    
-000057d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000057e0: 6576 616c 7561 7469 6f6e 5f70 6f6c 6963  evaluation_polic
-000057f0: 795f 6163 7469 6f6e 2c0a 2020 2020 2020  y_action,.      
-00005800: 2020 2020 2020 2020 2020 2020 2020 6576                ev
-00005810: 616c 7561 7469 6f6e 5f70 6f6c 6963 795f  aluation_policy_
-00005820: 6163 7469 6f6e 5f64 6973 742c 0a20 2020  action_dist,.   
-00005830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005840: 2073 7461 7465 5f61 6374 696f 6e5f 7661   state_action_va
-00005850: 6c75 655f 7072 6564 6963 7469 6f6e 2c0a  lue_prediction,.
-00005860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005870: 2020 2020 696e 6974 6961 6c5f 7374 6174      initial_stat
-00005880: 655f 7661 6c75 655f 7072 6564 6963 7469  e_value_predicti
-00005890: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
-000058a0: 2020 2020 2020 2020 7374 6174 655f 6163          state_ac
-000058b0: 7469 6f6e 5f6d 6172 6769 6e61 6c5f 696d  tion_marginal_im
-000058c0: 706f 7274 616e 6365 5f77 6569 6768 742c  portance_weight,
-000058d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000058e0: 2020 2020 2073 7461 7465 5f6d 6172 6769       state_margi
-000058f0: 6e61 6c5f 696d 706f 7274 616e 6365 5f77  nal_importance_w
-00005900: 6569 6768 742c 0a20 2020 2020 2020 2020  eight,.         
-00005910: 2020 2020 2020 2020 2020 206f 6e5f 706f             on_po
-00005920: 6c69 6379 5f70 6f6c 6963 795f 7661 6c75  licy_policy_valu
-00005930: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
-00005940: 2020 2020 2020 2067 616d 6d61 2c0a 2020         gamma,.  
+00004530: 206e 5f62 6f6f 7473 7472 6170 5f73 616d   n_bootstrap_sam
+00004540: 706c 6573 3d6e 5f62 6f6f 7473 7472 6170  ples=n_bootstrap
+00004550: 5f73 616d 706c 6573 2c0a 2020 2020 2020  _samples,.      
+00004560: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+00004570: 6e64 6f6d 5f73 7461 7465 3d72 616e 646f  ndom_state=rando
+00004580: 6d5f 7374 6174 652c 0a20 2020 2020 2020  m_state,.       
+00004590: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+000045a0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+000045b0: 2020 2020 2020 2020 2020 2020 2070 6f6c               pol
+000045c0: 6963 795f 7661 6c75 655f 696e 7465 7276  icy_value_interv
+000045d0: 616c 5f64 6963 745b 6576 616c 5f70 6f6c  al_dict[eval_pol
+000045e0: 6963 795d 5b22 6f6e 5f70 6f6c 6963 7922  icy]["on_policy"
+000045f0: 5d20 3d20 4e6f 6e65 0a0a 2020 2020 2020  ] = None..      
+00004600: 2020 2020 2020 666f 7220 6573 7469 6d61        for estima
+00004610: 746f 725f 6e61 6d65 2069 6e20 636f 6d70  tor_name in comp
+00004620: 6172 6564 5f65 7374 696d 6174 6f72 733a  ared_estimators:
+00004630: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00004640: 2065 7374 696d 6174 6f72 203d 2073 656c   estimator = sel
+00004650: 662e 6f70 655f 6573 7469 6d61 746f 7273  f.ope_estimators
+00004660: 5f5b 6573 7469 6d61 746f 725f 6e61 6d65  _[estimator_name
+00004670: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+00004680: 2020 706f 6c69 6379 5f76 616c 7565 5f69    policy_value_i
+00004690: 6e74 6572 7661 6c5f 6469 6374 5b65 7661  nterval_dict[eva
+000046a0: 6c5f 706f 6c69 6379 5d5b 0a20 2020 2020  l_policy][.     
+000046b0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+000046c0: 7374 696d 6174 6f72 5f6e 616d 650a 2020  stimator_name.  
+000046d0: 2020 2020 2020 2020 2020 2020 2020 5d20                ] 
+000046e0: 3d20 6573 7469 6d61 746f 722e 6573 7469  = estimator.esti
+000046f0: 6d61 7465 5f69 6e74 6572 7661 6c28 0a20  mate_interval(. 
+00004700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004710: 2020 202a 2a69 6e70 7574 5f64 6963 745b     **input_dict[
+00004720: 6576 616c 5f70 6f6c 6963 795d 2c0a 2020  eval_policy],.  
+00004730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004740: 2020 2a2a 7365 6c66 2e69 6e70 7574 5f64    **self.input_d
+00004750: 6963 745f 2c0a 2020 2020 2020 2020 2020  ict_,.          
+00004760: 2020 2020 2020 2020 2020 6e5f 7374 6570            n_step
+00004770: 5f70 6469 733d 7365 6c66 2e6e 5f73 7465  _pdis=self.n_ste
+00004780: 705f 7064 6973 2c0a 2020 2020 2020 2020  p_pdis,.        
+00004790: 2020 2020 2020 2020 2020 2020 6469 7361              disa
+000047a0: 626c 655f 7265 7761 7264 5f61 6674 6572  ble_reward_after
+000047b0: 5f64 6f6e 653d 7365 6c66 2e64 6973 6162  _done=self.disab
+000047c0: 6c65 5f72 6577 6172 645f 6166 7465 725f  le_reward_after_
+000047d0: 646f 6e65 2c0a 2020 2020 2020 2020 2020  done,.          
+000047e0: 2020 2020 2020 2020 2020 616c 7068 613d            alpha=
+000047f0: 616c 7068 612c 0a20 2020 2020 2020 2020  alpha,.         
+00004800: 2020 2020 2020 2020 2020 2063 693d 6369             ci=ci
+00004810: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00004820: 2020 2020 2020 6e5f 626f 6f74 7374 7261        n_bootstra
+00004830: 705f 7361 6d70 6c65 733d 6e5f 626f 6f74  p_samples=n_boot
+00004840: 7374 7261 705f 7361 6d70 6c65 732c 0a20  strap_samples,. 
+00004850: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004860: 2020 2072 616e 646f 6d5f 7374 6174 653d     random_state=
+00004870: 7261 6e64 6f6d 5f73 7461 7465 2c0a 2020  random_state,.  
+00004880: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+00004890: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+000048a0: 6465 6661 756c 7464 6963 745f 746f 5f64  defaultdict_to_d
+000048b0: 6963 7428 706f 6c69 6379 5f76 616c 7565  ict(policy_value
+000048c0: 5f69 6e74 6572 7661 6c5f 6469 6374 290a  _interval_dict).
+000048d0: 0a20 2020 2064 6566 205f 7375 6d6d 6172  .    def _summar
+000048e0: 697a 655f 6f66 665f 706f 6c69 6379 5f65  ize_off_policy_e
+000048f0: 7374 696d 6174 6573 280a 2020 2020 2020  stimates(.      
+00004900: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
+00004910: 706f 6c69 6379 5f76 616c 7565 5f64 6963  policy_value_dic
+00004920: 743a 2044 6963 745b 7374 722c 2041 6e79  t: Dict[str, Any
+00004930: 5d2c 0a20 2020 2020 2020 2070 6f6c 6963  ],.        polic
+00004940: 795f 7661 6c75 655f 696e 7465 7276 616c  y_value_interval
+00004950: 5f64 6963 743a 2044 6963 745b 7374 722c  _dict: Dict[str,
+00004960: 2041 6e79 5d2c 0a20 2020 2029 202d 3e20   Any],.    ) -> 
+00004970: 5475 706c 655b 4469 6374 5b73 7472 2c20  Tuple[Dict[str, 
+00004980: 4461 7461 4672 616d 655d 2c20 4469 6374  DataFrame], Dict
+00004990: 5b73 7472 2c20 4461 7461 4672 616d 655d  [str, DataFrame]
+000049a0: 5d3a 0a20 2020 2020 2020 2022 2222 5375  ]:.        """Su
+000049b0: 6d6d 6172 697a 6520 7468 6520 706f 6c69  mmarize the poli
+000049c0: 6379 2076 616c 7565 2061 6e64 2074 6865  cy value and the
+000049d0: 6972 2063 6f6e 6669 6465 6e63 6520 696e  ir confidence in
+000049e0: 7465 7276 616c 7320 6573 7469 6d61 7465  tervals estimate
+000049f0: 6420 6279 204f 5045 2065 7374 696d 6174  d by OPE estimat
+00004a00: 6f72 732e 0a0a 2020 2020 2020 2020 5061  ors...        Pa
+00004a10: 7261 6d65 7465 7273 0a20 2020 2020 2020  rameters.       
+00004a20: 202d 2d2d 2d2d 2d2d 0a20 2020 2020 2020   -------.       
+00004a30: 2070 6f6c 6963 795f 7661 6c75 655f 6469   policy_value_di
+00004a40: 6374 3a20 6469 6374 0a20 2020 2020 2020  ct: dict.       
+00004a50: 2020 2020 2044 6963 7469 6f6e 6172 7920       Dictionary 
+00004a60: 636f 6e74 6169 6e69 6e67 2074 6865 2070  containing the p
+00004a70: 6f6c 6963 7920 7661 6c75 6520 6f66 2065  olicy value of e
+00004a80: 6163 6820 6576 616c 7561 7469 6f6e 2070  ach evaluation p
+00004a90: 6f6c 6963 7920 6573 7469 6d61 7465 6420  olicy estimated 
+00004aa0: 6279 204f 5045 2065 7374 696d 6174 6f72  by OPE estimator
+00004ab0: 732e 0a20 2020 2020 2020 2020 2020 206b  s..            k
+00004ac0: 6579 3a20 3a63 6c61 7373 3a60 5b65 7661  ey: :class:`[eva
+00004ad0: 6c75 6174 696f 6e5f 706f 6c69 6379 5d5b  luation_policy][
+00004ae0: 4f50 455f 6573 7469 6d61 746f 725f 6e61  OPE_estimator_na
+00004af0: 6d65 5d60 0a0a 2020 2020 2020 2020 706f  me]`..        po
+00004b00: 6c69 6379 5f76 616c 7565 5f69 6e74 6572  licy_value_inter
+00004b10: 7661 6c5f 6469 6374 3a20 6469 6374 0a20  val_dict: dict. 
+00004b20: 2020 2020 2020 2020 2020 2044 6963 7469             Dicti
+00004b30: 6f6e 6172 7920 636f 6e74 6169 6e69 6e67  onary containing
+00004b40: 2074 6865 2063 6f6e 6669 6465 6e63 6520   the confidence 
+00004b50: 696e 7465 7276 616c 7320 6573 7469 6d61  intervals estima
+00004b60: 7465 6420 6279 206e 6f6e 7061 7261 6d65  ted by nonparame
+00004b70: 7472 6963 2062 6f6f 7473 7472 6170 2e0a  tric bootstrap..
+00004b80: 2020 2020 2020 2020 2020 2020 6b65 793a              key:
+00004b90: 203a 636c 6173 733a 605b 6576 616c 7561   :class:`[evalua
+00004ba0: 7469 6f6e 5f70 6f6c 6963 795d 5b4f 5045  tion_policy][OPE
+00004bb0: 5f65 7374 696d 6174 6f72 5f6e 616d 655d  _estimator_name]
+00004bc0: 600a 0a20 2020 2020 2020 2052 6574 7572  `..        Retur
+00004bd0: 6e0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  n.        ------
+00004be0: 2d0a 2020 2020 2020 2020 706f 6c69 6379  -.        policy
+00004bf0: 5f76 616c 7565 5f64 665f 6469 6374 3a20  _value_df_dict: 
+00004c00: 6469 6374 0a20 2020 2020 2020 2020 2020  dict.           
+00004c10: 2044 6963 7469 6f6e 6172 7920 636f 6e74   Dictionary cont
+00004c20: 6169 6e69 6e67 2074 6865 2070 6f6c 6963  aining the polic
+00004c30: 7920 7661 6c75 6520 6f66 2065 6163 6820  y value of each 
+00004c40: 6576 616c 7561 7469 6f6e 2070 6f6c 6963  evaluation polic
+00004c50: 7920 6573 7469 6d61 7465 6420 6279 204f  y estimated by O
+00004c60: 5045 2065 7374 696d 6174 6f72 732e 0a20  PE estimators.. 
+00004c70: 2020 2020 2020 2020 2020 206b 6579 3a20             key: 
+00004c80: 3a63 6c61 7373 3a60 5b65 7661 6c75 6174  :class:`[evaluat
+00004c90: 696f 6e5f 706f 6c69 6379 5d5b 4f50 455f  ion_policy][OPE_
+00004ca0: 6573 7469 6d61 746f 725f 6e61 6d65 5d60  estimator_name]`
+00004cb0: 0a0a 2020 2020 2020 2020 706f 6c69 6379  ..        policy
+00004cc0: 5f76 616c 7565 5f69 6e74 6572 7661 6c5f  _value_interval_
+00004cd0: 6466 5f64 6963 743a 2064 6963 740a 2020  df_dict: dict.  
+00004ce0: 2020 2020 2020 2020 2020 4469 6374 696f            Dictio
+00004cf0: 6e61 7279 2063 6f6e 7461 696e 696e 6720  nary containing 
+00004d00: 7468 6520 636f 6e66 6964 656e 6365 2069  the confidence i
+00004d10: 6e74 6572 7661 6c73 2065 7374 696d 6174  ntervals estimat
+00004d20: 6564 2062 7920 6e6f 6e70 6172 616d 6574  ed by nonparamet
+00004d30: 7269 6320 626f 6f74 7374 7261 702e 0a20  ric bootstrap.. 
+00004d40: 2020 2020 2020 2020 2020 206b 6579 3a20             key: 
+00004d50: 3a63 6c61 7373 3a60 5b65 7661 6c75 6174  :class:`[evaluat
+00004d60: 696f 6e5f 706f 6c69 6379 5d5b 4f50 455f  ion_policy][OPE_
+00004d70: 6573 7469 6d61 746f 725f 6e61 6d65 5d60  estimator_name]`
+00004d80: 0a0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+00004d90: 2020 2020 2020 706f 6c69 6379 5f76 616c        policy_val
+00004da0: 7565 5f64 665f 6469 6374 203d 2064 6963  ue_df_dict = dic
+00004db0: 7428 290a 2020 2020 2020 2020 706f 6c69  t().        poli
+00004dc0: 6379 5f76 616c 7565 5f69 6e74 6572 7661  cy_value_interva
+00004dd0: 6c5f 6466 5f64 6963 7420 3d20 6469 6374  l_df_dict = dict
+00004de0: 2829 0a0a 2020 2020 2020 2020 666f 7220  ()..        for 
+00004df0: 6576 616c 5f70 6f6c 6963 7920 696e 2070  eval_policy in p
+00004e00: 6f6c 6963 795f 7661 6c75 655f 6469 6374  olicy_value_dict
+00004e10: 2e6b 6579 7328 293a 0a20 2020 2020 2020  .keys():.       
+00004e20: 2020 2020 2070 6f6c 6963 795f 7661 6c75       policy_valu
+00004e30: 655f 6466 5f20 3d20 4461 7461 4672 616d  e_df_ = DataFram
+00004e40: 6528 0a20 2020 2020 2020 2020 2020 2020  e(.             
+00004e50: 2020 2070 6f6c 6963 795f 7661 6c75 655f     policy_value_
+00004e60: 6469 6374 5b65 7661 6c5f 706f 6c69 6379  dict[eval_policy
+00004e70: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+00004e80: 2020 2069 6e64 6578 3d5b 2270 6f6c 6963     index=["polic
+00004e90: 795f 7661 6c75 6522 5d2c 0a20 2020 2020  y_value"],.     
+00004ea0: 2020 2020 2020 2029 2e54 0a0a 2020 2020         ).T..    
+00004eb0: 2020 2020 2020 2020 6f6e 5f70 6f6c 6963          on_polic
+00004ec0: 795f 706f 6c69 6379 5f76 616c 7565 203d  y_policy_value =
+00004ed0: 204e 6f6e 650a 2020 2020 2020 2020 2020   None.          
+00004ee0: 2020 6966 2070 6f6c 6963 795f 7661 6c75    if policy_valu
+00004ef0: 655f 6469 6374 5b65 7661 6c5f 706f 6c69  e_dict[eval_poli
+00004f00: 6379 5d5b 226f 6e5f 706f 6c69 6379 225d  cy]["on_policy"]
+00004f10: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
+00004f20: 2020 2020 2020 2020 2020 2020 2020 6f6e                on
+00004f30: 5f70 6f6c 6963 795f 706f 6c69 6379 5f76  _policy_policy_v
+00004f40: 616c 7565 203d 2070 6f6c 6963 795f 7661  alue = policy_va
+00004f50: 6c75 655f 6469 6374 5b65 7661 6c5f 706f  lue_dict[eval_po
+00004f60: 6c69 6379 5d5b 0a20 2020 2020 2020 2020  licy][.         
+00004f70: 2020 2020 2020 2020 2020 2022 6f6e 5f70             "on_p
+00004f80: 6f6c 6963 7922 0a20 2020 2020 2020 2020  olicy".         
+00004f90: 2020 2020 2020 205d 2e6d 6561 6e28 290a         ].mean().
+00004fa0: 2020 2020 2020 2020 2020 2020 6966 206f              if o
+00004fb0: 6e5f 706f 6c69 6379 5f70 6f6c 6963 795f  n_policy_policy_
+00004fc0: 7661 6c75 6520 6973 206e 6f74 204e 6f6e  value is not Non
+00004fd0: 6520 616e 6420 6f6e 5f70 6f6c 6963 795f  e and on_policy_
+00004fe0: 706f 6c69 6379 5f76 616c 7565 203e 2030  policy_value > 0
+00004ff0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00005000: 2020 706f 6c69 6379 5f76 616c 7565 5f64    policy_value_d
+00005010: 665f 5b22 7265 6c61 7469 7665 5f70 6f6c  f_["relative_pol
+00005020: 6963 795f 7661 6c75 6522 5d20 3d20 280a  icy_value"] = (.
+00005030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005040: 2020 2020 706f 6c69 6379 5f76 616c 7565      policy_value
+00005050: 5f64 665f 202f 206f 6e5f 706f 6c69 6379  _df_ / on_policy
+00005060: 5f70 6f6c 6963 795f 7661 6c75 650a 2020  _policy_value.  
+00005070: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+00005080: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00005090: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000050a0: 2020 706f 6c69 6379 5f76 616c 7565 5f64    policy_value_d
+000050b0: 665f 5b22 7265 6c61 7469 7665 5f70 6f6c  f_["relative_pol
+000050c0: 6963 795f 7661 6c75 6522 5d20 3d20 6e70  icy_value"] = np
+000050d0: 2e6e 616e 0a0a 2020 2020 2020 2020 2020  .nan..          
+000050e0: 2020 706f 6c69 6379 5f76 616c 7565 5f64    policy_value_d
+000050f0: 665f 6469 6374 5b65 7661 6c5f 706f 6c69  f_dict[eval_poli
+00005100: 6379 5d20 3d20 706f 6c69 6379 5f76 616c  cy] = policy_val
+00005110: 7565 5f64 665f 0a20 2020 2020 2020 2020  ue_df_.         
+00005120: 2020 2070 6f6c 6963 795f 7661 6c75 655f     policy_value_
+00005130: 696e 7465 7276 616c 5f64 665f 6469 6374  interval_df_dict
+00005140: 5b65 7661 6c5f 706f 6c69 6379 5d20 3d20  [eval_policy] = 
+00005150: 4461 7461 4672 616d 6528 0a20 2020 2020  DataFrame(.     
+00005160: 2020 2020 2020 2020 2020 2070 6f6c 6963             polic
+00005170: 795f 7661 6c75 655f 696e 7465 7276 616c  y_value_interval
+00005180: 5f64 6963 745b 6576 616c 5f70 6f6c 6963  _dict[eval_polic
+00005190: 795d 2c0a 2020 2020 2020 2020 2020 2020  y],.            
+000051a0: 292e 540a 0a20 2020 2020 2020 2072 6574  ).T..        ret
+000051b0: 7572 6e20 706f 6c69 6379 5f76 616c 7565  urn policy_value
+000051c0: 5f64 665f 6469 6374 2c20 706f 6c69 6379  _df_dict, policy
+000051d0: 5f76 616c 7565 5f69 6e74 6572 7661 6c5f  _value_interval_
+000051e0: 6466 5f64 6963 740a 0a20 2020 2064 6566  df_dict..    def
+000051f0: 205f 6576 616c 7561 7465 5f70 6572 666f   _evaluate_perfo
+00005200: 726d 616e 6365 5f6f 665f 6f70 655f 6573  rmance_of_ope_es
+00005210: 7469 6d61 746f 7273 280a 2020 2020 2020  timators(.      
+00005220: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
+00005230: 696e 7075 745f 6469 6374 3a20 4f50 4549  input_dict: OPEI
+00005240: 6e70 7574 4469 6374 2c0a 2020 2020 2020  nputDict,.      
+00005250: 2020 706f 6c69 6379 5f76 616c 7565 5f64    policy_value_d
+00005260: 6963 743a 2044 6963 745b 7374 722c 2041  ict: Dict[str, A
+00005270: 6e79 5d2c 0a20 2020 2020 2020 2063 6f6d  ny],.        com
+00005280: 7061 7265 645f 6573 7469 6d61 746f 7273  pared_estimators
+00005290: 3a20 4f70 7469 6f6e 616c 5b4c 6973 745b  : Optional[List[
+000052a0: 7374 725d 5d20 3d20 4e6f 6e65 2c0a 2020  str]] = None,.  
+000052b0: 2020 2020 2020 6d65 7472 6963 3a20 7374        metric: st
+000052c0: 7220 3d20 2272 656c 6174 6976 652d 6565  r = "relative-ee
+000052d0: 222c 0a20 2020 2020 2020 2072 6574 7572  ",.        retur
+000052e0: 6e5f 6279 5f64 6174 6166 7261 6d65 3a20  n_by_dataframe: 
+000052f0: 626f 6f6c 203d 2046 616c 7365 2c0a 2020  bool = False,.  
+00005300: 2020 2920 2d3e 2044 6963 745b 7374 722c    ) -> Dict[str,
+00005310: 2044 6963 745b 7374 722c 2066 6c6f 6174   Dict[str, float
+00005320: 5d5d 3a0a 2020 2020 2020 2020 2222 2245  ]]:.        """E
+00005330: 7661 6c75 6174 6520 7468 6520 6573 7469  valuate the esti
+00005340: 6d61 7469 6f6e 2070 6572 666f 726d 616e  mation performan
+00005350: 6365 2f61 6363 7572 6163 7920 6f66 204f  ce/accuracy of O
+00005360: 5045 2065 7374 696d 6174 6f72 732e 0a0a  PE estimators...
+00005370: 2020 2020 2020 2020 4e6f 7465 0a20 2020          Note.   
+00005380: 2020 2020 202d 2d2d 2d2d 2d2d 0a20 2020       -------.   
+00005390: 2020 2020 2045 7661 6c75 6174 6520 7468       Evaluate th
+000053a0: 6520 6573 7469 6d61 7469 6f6e 2070 6572  e estimation per
+000053b0: 666f 726d 616e 6365 2f61 6363 7572 6163  formance/accurac
+000053c0: 7920 6f66 204f 5045 2065 7374 696d 6174  y of OPE estimat
+000053d0: 6f72 7320 6279 2072 656c 6174 6976 6520  ors by relative 
+000053e0: 6573 7469 6d61 7469 6f6e 2065 7272 6f72  estimation error
+000053f0: 2028 7265 6c61 7469 7665 2d45 4529 206f   (relative-EE) o
+00005400: 7220 7371 7561 7265 6420 6572 726f 7220  r squared error 
+00005410: 2853 4529 2e0a 0a20 2020 2020 2020 202e  (SE)...        .
+00005420: 2e20 6d61 7468 3a3a 0a0a 2020 2020 2020  . math::..      
+00005430: 2020 2020 2020 5c5c 6d61 7468 726d 7b52        \\mathrm{R
+00005440: 656c 6174 6976 652d 4545 7d28 5c5c 6861  elative-EE}(\\ha
+00005450: 747b 567d 3b20 5c5c 6d61 7468 6361 6c7b  t{V}; \\mathcal{
+00005460: 447d 290a 2020 2020 2020 2020 2020 2020  D}).            
+00005470: 3a3d 205c 5c6c 6566 747c 205c 5c66 7261  := \\left| \\fra
+00005480: 637b 5c5c 6861 747b 567d 285c 5c70 693b  c{\\hat{V}(\\pi;
+00005490: 205c 5c6d 6174 6863 616c 7b44 7d29 202d   \\mathcal{D}) -
+000054a0: 2056 5f7b 5c5c 6d61 7468 726d 7b6f 6e7d   V_{\\mathrm{on}
+000054b0: 7d28 5c5c 7069 297d 7b56 5f7b 5c5c 6d61  }(\\pi)}{V_{\\ma
+000054c0: 7468 726d 7b6f 6e7d 7d28 5c5c 7069 297d  thrm{on}}(\\pi)}
+000054d0: 205c 5c72 6967 6874 7c2c 0a0a 2020 2020   \\right|,..    
+000054e0: 2020 2020 2e2e 206d 6174 683a 3a0a 0a20      .. math::.. 
+000054f0: 2020 2020 2020 2020 2020 205c 5c6d 6174             \\mat
+00005500: 6872 6d7b 5345 7d28 5c5c 6861 747b 567d  hrm{SE}(\\hat{V}
+00005510: 3b20 5c5c 6d61 7468 6361 6c7b 447d 2920  ; \\mathcal{D}) 
+00005520: 3a3d 205c 5c6c 6566 7428 205c 5c68 6174  := \\left( \\hat
+00005530: 7b56 7d28 5c5c 7069 3b20 5c5c 6d61 7468  {V}(\\pi; \\math
+00005540: 6361 6c7b 447d 2920 2d20 565f 7b5c 5c6d  cal{D}) - V_{\\m
+00005550: 6174 6872 6d7b 6f6e 7d7d 205c 5c72 6967  athrm{on}} \\rig
+00005560: 6874 295e 322c 0a0a 2020 2020 2020 2020  ht)^2,..        
+00005570: 7768 6572 6520 3a6d 6174 683a 6056 5f7b  where :math:`V_{
+00005580: 5c5c 6d61 7468 726d 7b6f 6e7d 7d28 5c5c  \\mathrm{on}}(\\
+00005590: 7069 2960 2069 7320 7468 6520 6f6e 2d70  pi)` is the on-p
+000055a0: 6f6c 6963 7920 706f 6c69 6379 2076 616c  olicy policy val
+000055b0: 7565 206f 6620 7468 6520 6576 616c 7561  ue of the evalua
+000055c0: 7469 6f6e 2070 6f6c 6963 7920 3a6d 6174  tion policy :mat
+000055d0: 683a 605c 5c70 6960 2e0a 2020 2020 2020  h:`\\pi`..      
+000055e0: 2020 3a6d 6174 683a 605c 5c68 6174 7b56    :math:`\\hat{V
+000055f0: 7d28 5c5c 7069 3b20 5c5c 6d61 7468 6361  }(\\pi; \\mathca
+00005600: 6c7b 447d 2960 2069 7320 7468 6520 706f  l{D})` is the po
+00005610: 6c69 6379 2076 616c 7565 2065 7374 696d  licy value estim
+00005620: 6174 6564 2062 7920 7468 6520 4f50 4520  ated by the OPE 
+00005630: 6573 7469 6d61 746f 7220 3a6d 6174 683a  estimator :math:
+00005640: 605c 5c68 6174 7b56 7d60 2061 6e64 206c  `\\hat{V}` and l
+00005650: 6f67 6765 6420 6461 7461 7365 7420 3a6d  ogged dataset :m
+00005660: 6174 683a 605c 5c6d 6174 6863 616c 7b44  ath:`\\mathcal{D
+00005670: 7d60 2e0a 0a20 2020 2020 2020 2050 6172  }`...        Par
+00005680: 616d 6574 6572 730a 2020 2020 2020 2020  ameters.        
+00005690: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+000056a0: 696e 7075 745f 6469 6374 3a20 4f50 4549  input_dict: OPEI
+000056b0: 6e70 7574 4469 6374 206f 7220 4d75 6c74  nputDict or Mult
+000056c0: 6970 6c65 496e 7075 7444 6963 740a 2020  ipleInputDict.  
+000056d0: 2020 2020 2020 2020 2020 4469 6374 696f            Dictio
+000056e0: 6e61 7279 206f 6620 7468 6520 4f50 4520  nary of the OPE 
+000056f0: 696e 7075 7473 2066 6f72 2065 6163 6820  inputs for each 
+00005700: 6576 616c 7561 7469 6f6e 2070 6f6c 6963  evaluation polic
+00005710: 792e 0a0a 2020 2020 2020 2020 2020 2020  y...            
+00005720: 2e2e 2063 6f64 652d 626c 6f63 6b3a 3a20  .. code-block:: 
+00005730: 7079 7468 6f6e 0a0a 2020 2020 2020 2020  python..        
+00005740: 2020 2020 2020 2020 6b65 793a 205b 6576          key: [ev
+00005750: 616c 7561 7469 6f6e 5f70 6f6c 6963 795d  aluation_policy]
+00005760: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
+00005770: 2020 2020 2020 6576 616c 7561 7469 6f6e        evaluation
+00005780: 5f70 6f6c 6963 795f 6163 7469 6f6e 2c0a  _policy_action,.
+00005790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000057a0: 2020 2020 6576 616c 7561 7469 6f6e 5f70      evaluation_p
+000057b0: 6f6c 6963 795f 6163 7469 6f6e 5f64 6973  olicy_action_dis
+000057c0: 742c 0a20 2020 2020 2020 2020 2020 2020  t,.             
+000057d0: 2020 2020 2020 2073 7461 7465 5f61 6374         state_act
+000057e0: 696f 6e5f 7661 6c75 655f 7072 6564 6963  ion_value_predic
+000057f0: 7469 6f6e 2c0a 2020 2020 2020 2020 2020  tion,.          
+00005800: 2020 2020 2020 2020 2020 696e 6974 6961            initia
+00005810: 6c5f 7374 6174 655f 7661 6c75 655f 7072  l_state_value_pr
+00005820: 6564 6963 7469 6f6e 2c0a 2020 2020 2020  ediction,.      
+00005830: 2020 2020 2020 2020 2020 2020 2020 7374                st
+00005840: 6174 655f 6163 7469 6f6e 5f6d 6172 6769  ate_action_margi
+00005850: 6e61 6c5f 696d 706f 7274 616e 6365 5f77  nal_importance_w
+00005860: 6569 6768 742c 0a20 2020 2020 2020 2020  eight,.         
+00005870: 2020 2020 2020 2020 2020 2073 7461 7465             state
+00005880: 5f6d 6172 6769 6e61 6c5f 696d 706f 7274  _marginal_import
+00005890: 616e 6365 5f77 6569 6768 742c 0a20 2020  ance_weight,.   
+000058a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000058b0: 206f 6e5f 706f 6c69 6379 5f70 6f6c 6963   on_policy_polic
+000058c0: 795f 7661 6c75 652c 0a20 2020 2020 2020  y_value,.       
+000058d0: 2020 2020 2020 2020 2020 2020 2067 616d               gam
+000058e0: 6d61 2c0a 2020 2020 2020 2020 2020 2020  ma,.            
+000058f0: 2020 2020 2020 2020 6265 6861 7669 6f72          behavior
+00005900: 5f70 6f6c 6963 792c 0a20 2020 2020 2020  _policy,.       
+00005910: 2020 2020 2020 2020 2020 2020 2065 7661               eva
+00005920: 6c75 6174 696f 6e5f 706f 6c69 6379 2c0a  luation_policy,.
+00005930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005940: 2020 2020 6461 7461 7365 745f 6964 2c0a      dataset_id,.
 00005950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005960: 2020 6265 6861 7669 6f72 5f70 6f6c 6963    behavior_polic
-00005970: 792c 0a20 2020 2020 2020 2020 2020 2020  y,.             
-00005980: 2020 2020 2020 2065 7661 6c75 6174 696f         evaluatio
-00005990: 6e5f 706f 6c69 6379 2c0a 2020 2020 2020  n_policy,.      
-000059a0: 2020 2020 2020 2020 2020 2020 2020 6461                da
-000059b0: 7461 7365 745f 6964 2c0a 2020 2020 2020  taset_id,.      
-000059c0: 2020 2020 2020 2020 2020 5d0a 0a20 2020            ]..   
-000059d0: 2020 2020 2020 2020 202e 2e20 7365 6561           .. seea
-000059e0: 6c73 6f3a 3a0a 0a20 2020 2020 2020 2020  lso::..         
-000059f0: 2020 2020 2020 203a 636c 6173 733a 6073         :class:`s
-00005a00: 636f 7065 5f72 6c2e 6f70 652e 696e 7075  cope_rl.ope.inpu
-00005a10: 742e 4372 6561 7465 4f50 4549 6e70 7574  t.CreateOPEInput
-00005a20: 6020 6465 7363 7269 6265 7320 7468 6520  ` describes the 
-00005a30: 636f 6d70 6f6e 656e 7473 206f 6620 3a63  components of :c
-00005a40: 6c61 7373 3a60 696e 7075 745f 6469 6374  lass:`input_dict
-00005a50: 602e 0a0a 2020 2020 2020 2020 706f 6c69  `...        poli
-00005a60: 6379 5f76 616c 7565 5f64 6963 743a 2064  cy_value_dict: d
-00005a70: 6963 740a 2020 2020 2020 2020 2020 2020  ict.            
-00005a80: 4469 6374 696f 6e61 7279 2063 6f6e 7461  Dictionary conta
-00005a90: 696e 696e 6720 7468 6520 706f 6c69 6379  ining the policy
-00005aa0: 2076 616c 7565 206f 6620 6561 6368 2065   value of each e
-00005ab0: 7661 6c75 6174 696f 6e20 706f 6c69 6379  valuation policy
-00005ac0: 2065 7374 696d 6174 6564 2062 7920 4f50   estimated by OP
-00005ad0: 4520 6573 7469 6d61 746f 7273 2e0a 2020  E estimators..  
-00005ae0: 2020 2020 2020 2020 2020 6b65 793a 203a            key: :
-00005af0: 636c 6173 733a 605b 6576 616c 7561 7469  class:`[evaluati
-00005b00: 6f6e 5f70 6f6c 6963 795d 5b4f 5045 5f65  on_policy][OPE_e
-00005b10: 7374 696d 6174 6f72 5f6e 616d 655d 600a  stimator_name]`.
-00005b20: 0a20 2020 2020 2020 2063 6f6d 7061 7265  .        compare
-00005b30: 645f 6573 7469 6d61 746f 7273 3a20 6c69  d_estimators: li
-00005b40: 7374 206f 6620 7374 722c 2064 6566 6175  st of str, defau
-00005b50: 6c74 3d4e 6f6e 650a 2020 2020 2020 2020  lt=None.        
-00005b60: 2020 2020 4e61 6d65 206f 6620 636f 6d70      Name of comp
-00005b70: 6172 6564 2065 7374 696d 6174 6f72 732e  ared estimators.
-00005b80: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
-00005b90: 604e 6f6e 6560 2069 7320 6769 7665 6e2c  `None` is given,
-00005ba0: 2061 6c6c 2074 6865 2065 7374 696d 6174   all the estimat
-00005bb0: 6f72 7320 6172 6520 636f 6d70 6172 6564  ors are compared
-00005bc0: 2e0a 0a20 2020 2020 2020 206d 6574 7269  ...        metri
-00005bd0: 633a 207b 2272 656c 6174 6976 652d 6565  c: {"relative-ee
-00005be0: 222c 2022 7365 227d 2c20 6465 6661 756c  ", "se"}, defaul
-00005bf0: 743d 2272 656c 6174 6976 652d 6565 220a  t="relative-ee".
-00005c00: 2020 2020 2020 2020 2020 2020 4576 616c              Eval
-00005c10: 7561 7469 6f6e 206d 6574 7269 6320 7573  uation metric us
-00005c20: 6564 2074 6f20 6576 616c 7561 7465 2061  ed to evaluate a
-00005c30: 6e64 2063 6f6d 7061 7265 2074 6865 2065  nd compare the e
-00005c40: 7374 696d 6174 696f 6e20 7065 7266 6f72  stimation perfor
-00005c50: 6d61 6e63 652f 6163 6375 7261 6379 206f  mance/accuracy o
-00005c60: 6620 4f50 4520 6573 7469 6d61 746f 7273  f OPE estimators
-00005c70: 2e0a 0a20 2020 2020 2020 2072 6574 7572  ...        retur
-00005c80: 6e5f 6279 5f64 6174 6166 7261 6d65 3a20  n_by_dataframe: 
-00005c90: 626f 6f6c 2c20 6465 6661 756c 743d 4661  bool, default=Fa
-00005ca0: 6c73 650a 2020 2020 2020 2020 2020 2020  lse.            
-00005cb0: 5768 6574 6865 7220 746f 2072 6574 7572  Whether to retur
-00005cc0: 6e20 7468 6520 7265 7375 6c74 2069 6e20  n the result in 
-00005cd0: 6120 6461 7461 6672 616d 6520 666f 726d  a dataframe form
-00005ce0: 6174 2e0a 0a20 2020 2020 2020 2052 6574  at...        Ret
-00005cf0: 7572 6e0a 2020 2020 2020 2020 2d2d 2d2d  urn.        ----
-00005d00: 2d2d 2d0a 2020 2020 2020 2020 6576 616c  ---.        eval
-00005d10: 5f6d 6574 7269 635f 6f70 655f 6469 6374  _metric_ope_dict
-00005d20: 2f65 7661 6c5f 6d65 7472 6963 5f6f 7065  /eval_metric_ope
-00005d30: 5f64 663a 2064 6963 7420 6f72 2064 6174  _df: dict or dat
-00005d40: 6166 7261 6d65 0a20 2020 2020 2020 2020  aframe.         
-00005d50: 2020 2044 6963 7469 6f6e 6172 792f 6461     Dictionary/da
-00005d60: 7461 6672 616d 6520 636f 6e74 6169 6e69  taframe containi
-00005d70: 6e67 2065 7661 6c75 6174 696f 6e20 6d65  ng evaluation me
-00005d80: 7472 6963 2066 6f72 2065 7661 6c75 6174  tric for evaluat
-00005d90: 696e 6720 7468 6520 6573 7469 6d61 7469  ing the estimati
-00005da0: 6f6e 2070 6572 666f 726d 616e 6365 2f61  on performance/a
-00005db0: 6363 7572 6163 7920 6f66 204f 5045 2065  ccuracy of OPE e
-00005dc0: 7374 696d 6174 6f72 732e 0a20 2020 2020  stimators..     
-00005dd0: 2020 2020 2020 206b 6579 3a20 3a63 6c61         key: :cla
-00005de0: 7373 3a60 5b65 7661 6c75 6174 696f 6e5f  ss:`[evaluation_
-00005df0: 706f 6c69 6379 5d5b 4f50 455f 6573 7469  policy][OPE_esti
-00005e00: 6d61 746f 725f 6e61 6d65 5d60 0a0a 2020  mator_name]`..  
-00005e10: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00005e20: 2020 6368 6563 6b5f 696e 7075 745f 6469    check_input_di
-00005e30: 6374 2869 6e70 7574 5f64 6963 7429 0a20  ct(input_dict). 
-00005e40: 2020 2020 2020 2065 7661 6c5f 6d65 7472         eval_metr
-00005e50: 6963 5f6f 7065 5f64 6963 7420 3d20 6465  ic_ope_dict = de
-00005e60: 6661 756c 7464 6963 7428 6469 6374 290a  faultdict(dict).
-00005e70: 0a20 2020 2020 2020 2069 6620 6d65 7472  .        if metr
-00005e80: 6963 203d 3d20 2272 656c 6174 6976 652d  ic == "relative-
-00005e90: 6565 223a 0a20 2020 2020 2020 2020 2020  ee":.           
-00005ea0: 2066 6f72 2065 7661 6c5f 706f 6c69 6379   for eval_policy
-00005eb0: 2069 6e20 696e 7075 745f 6469 6374 2e6b   in input_dict.k
-00005ec0: 6579 7328 293a 0a20 2020 2020 2020 2020  eys():.         
-00005ed0: 2020 2020 2020 206f 6e5f 706f 6c69 6379         on_policy
-00005ee0: 5f70 6f6c 6963 795f 7661 6c75 6520 3d20  _policy_value = 
-00005ef0: 696e 7075 745f 6469 6374 5b65 7661 6c5f  input_dict[eval_
-00005f00: 706f 6c69 6379 5d5b 0a20 2020 2020 2020  policy][.       
-00005f10: 2020 2020 2020 2020 2020 2020 2022 6f6e               "on
-00005f20: 5f70 6f6c 6963 795f 706f 6c69 6379 5f76  _policy_policy_v
-00005f30: 616c 7565 220a 2020 2020 2020 2020 2020  alue".          
-00005f40: 2020 2020 2020 5d0a 0a20 2020 2020 2020        ]..       
-00005f50: 2020 2020 2020 2020 2066 6f72 2065 7374           for est
-00005f60: 696d 6174 6f72 2069 6e20 636f 6d70 6172  imator in compar
-00005f70: 6564 5f65 7374 696d 6174 6f72 733a 0a20  ed_estimators:. 
+00005960: 5d0a 0a20 2020 2020 2020 2020 2020 202e  ]..            .
+00005970: 2e20 7365 6561 6c73 6f3a 3a0a 0a20 2020  . seealso::..   
+00005980: 2020 2020 2020 2020 2020 2020 203a 636c               :cl
+00005990: 6173 733a 6073 636f 7065 5f72 6c2e 6f70  ass:`scope_rl.op
+000059a0: 652e 696e 7075 742e 4372 6561 7465 4f50  e.input.CreateOP
+000059b0: 4549 6e70 7574 6020 6465 7363 7269 6265  EInput` describe
+000059c0: 7320 7468 6520 636f 6d70 6f6e 656e 7473  s the components
+000059d0: 206f 6620 3a63 6c61 7373 3a60 696e 7075   of :class:`inpu
+000059e0: 745f 6469 6374 602e 0a0a 2020 2020 2020  t_dict`...      
+000059f0: 2020 706f 6c69 6379 5f76 616c 7565 5f64    policy_value_d
+00005a00: 6963 743a 2064 6963 740a 2020 2020 2020  ict: dict.      
+00005a10: 2020 2020 2020 4469 6374 696f 6e61 7279        Dictionary
+00005a20: 2063 6f6e 7461 696e 696e 6720 7468 6520   containing the 
+00005a30: 706f 6c69 6379 2076 616c 7565 206f 6620  policy value of 
+00005a40: 6561 6368 2065 7661 6c75 6174 696f 6e20  each evaluation 
+00005a50: 706f 6c69 6379 2065 7374 696d 6174 6564  policy estimated
+00005a60: 2062 7920 4f50 4520 6573 7469 6d61 746f   by OPE estimato
+00005a70: 7273 2e0a 2020 2020 2020 2020 2020 2020  rs..            
+00005a80: 6b65 793a 203a 636c 6173 733a 605b 6576  key: :class:`[ev
+00005a90: 616c 7561 7469 6f6e 5f70 6f6c 6963 795d  aluation_policy]
+00005aa0: 5b4f 5045 5f65 7374 696d 6174 6f72 5f6e  [OPE_estimator_n
+00005ab0: 616d 655d 600a 0a20 2020 2020 2020 2063  ame]`..        c
+00005ac0: 6f6d 7061 7265 645f 6573 7469 6d61 746f  ompared_estimato
+00005ad0: 7273 3a20 6c69 7374 206f 6620 7374 722c  rs: list of str,
+00005ae0: 2064 6566 6175 6c74 3d4e 6f6e 650a 2020   default=None.  
+00005af0: 2020 2020 2020 2020 2020 4e61 6d65 206f            Name o
+00005b00: 6620 636f 6d70 6172 6564 2065 7374 696d  f compared estim
+00005b10: 6174 6f72 732e 0a20 2020 2020 2020 2020  ators..         
+00005b20: 2020 2049 6620 604e 6f6e 6560 2069 7320     If `None` is 
+00005b30: 6769 7665 6e2c 2061 6c6c 2074 6865 2065  given, all the e
+00005b40: 7374 696d 6174 6f72 7320 6172 6520 636f  stimators are co
+00005b50: 6d70 6172 6564 2e0a 0a20 2020 2020 2020  mpared...       
+00005b60: 206d 6574 7269 633a 207b 2272 656c 6174   metric: {"relat
+00005b70: 6976 652d 6565 222c 2022 7365 227d 2c20  ive-ee", "se"}, 
+00005b80: 6465 6661 756c 743d 2272 656c 6174 6976  default="relativ
+00005b90: 652d 6565 220a 2020 2020 2020 2020 2020  e-ee".          
+00005ba0: 2020 4576 616c 7561 7469 6f6e 206d 6574    Evaluation met
+00005bb0: 7269 6320 7573 6564 2074 6f20 6576 616c  ric used to eval
+00005bc0: 7561 7465 2061 6e64 2063 6f6d 7061 7265  uate and compare
+00005bd0: 2074 6865 2065 7374 696d 6174 696f 6e20   the estimation 
+00005be0: 7065 7266 6f72 6d61 6e63 652f 6163 6375  performance/accu
+00005bf0: 7261 6379 206f 6620 4f50 4520 6573 7469  racy of OPE esti
+00005c00: 6d61 746f 7273 2e0a 0a20 2020 2020 2020  mators...       
+00005c10: 2072 6574 7572 6e5f 6279 5f64 6174 6166   return_by_dataf
+00005c20: 7261 6d65 3a20 626f 6f6c 2c20 6465 6661  rame: bool, defa
+00005c30: 756c 743d 4661 6c73 650a 2020 2020 2020  ult=False.      
+00005c40: 2020 2020 2020 5768 6574 6865 7220 746f        Whether to
+00005c50: 2072 6574 7572 6e20 7468 6520 7265 7375   return the resu
+00005c60: 6c74 2069 6e20 6120 6461 7461 6672 616d  lt in a datafram
+00005c70: 6520 666f 726d 6174 2e0a 0a20 2020 2020  e format...     
+00005c80: 2020 2052 6574 7572 6e0a 2020 2020 2020     Return.      
+00005c90: 2020 2d2d 2d2d 2d2d 2d0a 2020 2020 2020    -------.      
+00005ca0: 2020 6576 616c 5f6d 6574 7269 635f 6f70    eval_metric_op
+00005cb0: 655f 6469 6374 2f65 7661 6c5f 6d65 7472  e_dict/eval_metr
+00005cc0: 6963 5f6f 7065 5f64 663a 2064 6963 7420  ic_ope_df: dict 
+00005cd0: 6f72 2064 6174 6166 7261 6d65 0a20 2020  or dataframe.   
+00005ce0: 2020 2020 2020 2020 2044 6963 7469 6f6e           Diction
+00005cf0: 6172 792f 6461 7461 6672 616d 6520 636f  ary/dataframe co
+00005d00: 6e74 6169 6e69 6e67 2065 7661 6c75 6174  ntaining evaluat
+00005d10: 696f 6e20 6d65 7472 6963 2066 6f72 2065  ion metric for e
+00005d20: 7661 6c75 6174 696e 6720 7468 6520 6573  valuating the es
+00005d30: 7469 6d61 7469 6f6e 2070 6572 666f 726d  timation perform
+00005d40: 616e 6365 2f61 6363 7572 6163 7920 6f66  ance/accuracy of
+00005d50: 204f 5045 2065 7374 696d 6174 6f72 732e   OPE estimators.
+00005d60: 0a20 2020 2020 2020 2020 2020 206b 6579  .            key
+00005d70: 3a20 3a63 6c61 7373 3a60 5b65 7661 6c75  : :class:`[evalu
+00005d80: 6174 696f 6e5f 706f 6c69 6379 5d5b 4f50  ation_policy][OP
+00005d90: 455f 6573 7469 6d61 746f 725f 6e61 6d65  E_estimator_name
+00005da0: 5d60 0a0a 2020 2020 2020 2020 2222 220a  ]`..        """.
+00005db0: 2020 2020 2020 2020 6368 6563 6b5f 696e          check_in
+00005dc0: 7075 745f 6469 6374 2869 6e70 7574 5f64  put_dict(input_d
+00005dd0: 6963 7429 0a20 2020 2020 2020 2065 7661  ict).        eva
+00005de0: 6c5f 6d65 7472 6963 5f6f 7065 5f64 6963  l_metric_ope_dic
+00005df0: 7420 3d20 6465 6661 756c 7464 6963 7428  t = defaultdict(
+00005e00: 6469 6374 290a 0a20 2020 2020 2020 2069  dict)..        i
+00005e10: 6620 6d65 7472 6963 203d 3d20 2272 656c  f metric == "rel
+00005e20: 6174 6976 652d 6565 223a 0a20 2020 2020  ative-ee":.     
+00005e30: 2020 2020 2020 2066 6f72 2065 7661 6c5f         for eval_
+00005e40: 706f 6c69 6379 2069 6e20 696e 7075 745f  policy in input_
+00005e50: 6469 6374 2e6b 6579 7328 293a 0a20 2020  dict.keys():.   
+00005e60: 2020 2020 2020 2020 2020 2020 206f 6e5f               on_
+00005e70: 706f 6c69 6379 5f70 6f6c 6963 795f 7661  policy_policy_va
+00005e80: 6c75 6520 3d20 696e 7075 745f 6469 6374  lue = input_dict
+00005e90: 5b65 7661 6c5f 706f 6c69 6379 5d5b 0a20  [eval_policy][. 
+00005ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005eb0: 2020 2022 6f6e 5f70 6f6c 6963 795f 706f     "on_policy_po
+00005ec0: 6c69 6379 5f76 616c 7565 220a 2020 2020  licy_value".    
+00005ed0: 2020 2020 2020 2020 2020 2020 5d0a 0a20              ].. 
+00005ee0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00005ef0: 6f72 2065 7374 696d 6174 6f72 2069 6e20  or estimator in 
+00005f00: 636f 6d70 6172 6564 5f65 7374 696d 6174  compared_estimat
+00005f10: 6f72 733a 0a20 2020 2020 2020 2020 2020  ors:.           
+00005f20: 2020 2020 2020 2020 2072 656c 6174 6976           relativ
+00005f30: 655f 6565 5f20 3d20 280a 2020 2020 2020  e_ee_ = (.      
+00005f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005f50: 2020 706f 6c69 6379 5f76 616c 7565 5f64    policy_value_d
+00005f60: 6963 745b 6576 616c 5f70 6f6c 6963 795d  ict[eval_policy]
+00005f70: 5b65 7374 696d 6174 6f72 5d0a 2020 2020  [estimator].    
 00005f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005f90: 2020 2072 656c 6174 6976 655f 6565 5f20     relative_ee_ 
-00005fa0: 3d20 280a 2020 2020 2020 2020 2020 2020  = (.            
-00005fb0: 2020 2020 2020 2020 2020 2020 706f 6c69              poli
-00005fc0: 6379 5f76 616c 7565 5f64 6963 745b 6576  cy_value_dict[ev
-00005fd0: 616c 5f70 6f6c 6963 795d 5b65 7374 696d  al_policy][estim
-00005fe0: 6174 6f72 5d0a 2020 2020 2020 2020 2020  ator].          
-00005ff0: 2020 2020 2020 2020 2020 2020 2020 2d20                - 
-00006000: 6f6e 5f70 6f6c 6963 795f 706f 6c69 6379  on_policy_policy
-00006010: 5f76 616c 7565 0a20 2020 2020 2020 2020  _value.         
-00006020: 2020 2020 2020 2020 2020 2029 202f 206f             ) / o
-00006030: 6e5f 706f 6c69 6379 5f70 6f6c 6963 795f  n_policy_policy_
-00006040: 7661 6c75 650a 2020 2020 2020 2020 2020  value.          
-00006050: 2020 2020 2020 2020 2020 6576 616c 5f6d            eval_m
-00006060: 6574 7269 635f 6f70 655f 6469 6374 5b65  etric_ope_dict[e
-00006070: 7661 6c5f 706f 6c69 6379 5d5b 6573 7469  val_policy][esti
-00006080: 6d61 746f 725d 203d 206e 702e 6162 7328  mator] = np.abs(
-00006090: 7265 6c61 7469 7665 5f65 655f 290a 0a20  relative_ee_).. 
-000060a0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-000060b0: 2020 2020 2020 2020 2066 6f72 2065 7661           for eva
-000060c0: 6c5f 706f 6c69 6379 2069 6e20 696e 7075  l_policy in inpu
-000060d0: 745f 6469 6374 2e6b 6579 7328 293a 0a20  t_dict.keys():. 
-000060e0: 2020 2020 2020 2020 2020 2020 2020 206f                 o
-000060f0: 6e5f 706f 6c69 6379 5f70 6f6c 6963 795f  n_policy_policy_
-00006100: 7661 6c75 6520 3d20 696e 7075 745f 6469  value = input_di
-00006110: 6374 5b65 7661 6c5f 706f 6c69 6379 5d5b  ct[eval_policy][
-00006120: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00006130: 2020 2020 2022 6f6e 5f70 6f6c 6963 795f       "on_policy_
-00006140: 706f 6c69 6379 5f76 616c 7565 220a 2020  policy_value".  
-00006150: 2020 2020 2020 2020 2020 2020 2020 5d2e                ].
-00006160: 6d65 616e 2829 0a0a 2020 2020 2020 2020  mean()..        
-00006170: 2020 2020 2020 2020 666f 7220 6573 7469          for esti
-00006180: 6d61 746f 7220 696e 2063 6f6d 7061 7265  mator in compare
-00006190: 645f 6573 7469 6d61 746f 7273 3a0a 2020  d_estimators:.  
-000061a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000061b0: 2020 7365 5f20 3d20 280a 2020 2020 2020    se_ = (.      
-000061c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000061d0: 2020 706f 6c69 6379 5f76 616c 7565 5f64    policy_value_d
-000061e0: 6963 745b 6576 616c 5f70 6f6c 6963 795d  ict[eval_policy]
-000061f0: 5b65 7374 696d 6174 6f72 5d0a 2020 2020  [estimator].    
-00006200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006210: 2020 2020 2d20 6f6e 5f70 6f6c 6963 795f      - on_policy_
-00006220: 706f 6c69 6379 5f76 616c 7565 0a20 2020  policy_value.   
-00006230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006240: 2029 202a 2a20 320a 2020 2020 2020 2020   ) ** 2.        
-00006250: 2020 2020 2020 2020 2020 2020 6576 616c              eval
-00006260: 5f6d 6574 7269 635f 6f70 655f 6469 6374  _metric_ope_dict
-00006270: 5b65 7661 6c5f 706f 6c69 6379 5d5b 6573  [eval_policy][es
-00006280: 7469 6d61 746f 725d 203d 2073 655f 0a0a  timator] = se_..
-00006290: 2020 2020 2020 2020 6576 616c 5f6d 6574          eval_met
-000062a0: 7269 635f 6f70 655f 6469 6374 203d 2064  ric_ope_dict = d
-000062b0: 6566 6175 6c74 6469 6374 5f74 6f5f 6469  efaultdict_to_di
-000062c0: 6374 2865 7661 6c5f 6d65 7472 6963 5f6f  ct(eval_metric_o
-000062d0: 7065 5f64 6963 7429 0a0a 2020 2020 2020  pe_dict)..      
-000062e0: 2020 6966 2072 6574 7572 6e5f 6279 5f64    if return_by_d
-000062f0: 6174 6166 7261 6d65 3a0a 2020 2020 2020  ataframe:.      
-00006300: 2020 2020 2020 6576 616c 5f6d 6574 7269        eval_metri
-00006310: 635f 6f70 655f 6466 203d 2044 6174 6146  c_ope_df = DataF
-00006320: 7261 6d65 2829 0a20 2020 2020 2020 2020  rame().         
-00006330: 2020 2066 6f72 2065 7661 6c5f 706f 6c69     for eval_poli
-00006340: 6379 2069 6e20 696e 7075 745f 6469 6374  cy in input_dict
-00006350: 2e6b 6579 7328 293a 0a20 2020 2020 2020  .keys():.       
-00006360: 2020 2020 2020 2020 2065 7661 6c5f 6d65           eval_me
-00006370: 7472 6963 5f6f 7065 5f64 665b 6576 616c  tric_ope_df[eval
-00006380: 5f70 6f6c 6963 795d 203d 2044 6174 6146  _policy] = DataF
-00006390: 7261 6d65 280a 2020 2020 2020 2020 2020  rame(.          
-000063a0: 2020 2020 2020 2020 2020 6576 616c 5f6d            eval_m
-000063b0: 6574 7269 635f 6f70 655f 6469 6374 5b65  etric_ope_dict[e
-000063c0: 7661 6c5f 706f 6c69 6379 5d2c 2069 6e64  val_policy], ind
-000063d0: 6578 3d5b 6576 616c 5f70 6f6c 6963 795d  ex=[eval_policy]
-000063e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000063f0: 2029 2e54 0a0a 2020 2020 2020 2020 7265   ).T..        re
-00006400: 7475 726e 2065 7661 6c5f 6d65 7472 6963  turn eval_metric
-00006410: 5f6f 7065 5f64 6620 6966 2072 6574 7572  _ope_df if retur
-00006420: 6e5f 6279 5f64 6174 6166 7261 6d65 2065  n_by_dataframe e
-00006430: 6c73 6520 6576 616c 5f6d 6574 7269 635f  lse eval_metric_
-00006440: 6f70 655f 6469 6374 0a0a 2020 2020 6465  ope_dict..    de
-00006450: 6620 6573 7469 6d61 7465 5f70 6f6c 6963  f estimate_polic
-00006460: 795f 7661 6c75 6528 0a20 2020 2020 2020  y_value(.       
-00006470: 2073 656c 662c 0a20 2020 2020 2020 2069   self,.        i
-00006480: 6e70 7574 5f64 6963 743a 2055 6e69 6f6e  nput_dict: Union
-00006490: 5b4f 5045 496e 7075 7444 6963 742c 204d  [OPEInputDict, M
-000064a0: 756c 7469 706c 6549 6e70 7574 4469 6374  ultipleInputDict
-000064b0: 5d2c 0a20 2020 2020 2020 2063 6f6d 7061  ],.        compa
-000064c0: 7265 645f 6573 7469 6d61 746f 7273 3a20  red_estimators: 
-000064d0: 4f70 7469 6f6e 616c 5b4c 6973 745b 7374  Optional[List[st
-000064e0: 725d 5d20 3d20 4e6f 6e65 2c0a 2020 2020  r]] = None,.    
-000064f0: 2020 2020 6265 6861 7669 6f72 5f70 6f6c      behavior_pol
-00006500: 6963 795f 6e61 6d65 3a20 4f70 7469 6f6e  icy_name: Option
-00006510: 616c 5b73 7472 5d20 3d20 4e6f 6e65 2c0a  al[str] = None,.
-00006520: 2020 2020 2020 2020 6461 7461 7365 745f          dataset_
-00006530: 6964 3a20 4f70 7469 6f6e 616c 5b69 6e74  id: Optional[int
-00006540: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2920  ] = None,.    ) 
-00006550: 2d3e 2044 6963 745b 7374 722c 2066 6c6f  -> Dict[str, flo
-00006560: 6174 5d3a 0a20 2020 2020 2020 2022 2222  at]:.        """
-00006570: 4573 7469 6d61 7465 2074 6865 2070 6f6c  Estimate the pol
-00006580: 6963 7920 7661 6c75 6520 6f66 2074 6865  icy value of the
-00006590: 2067 6976 656e 2065 7661 6c75 6174 696f   given evaluatio
-000065a0: 6e20 706f 6c69 6369 6573 2e0a 0a20 2020  n policies...   
-000065b0: 2020 2020 2050 6172 616d 6574 6572 730a       Parameters.
-000065c0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0a          -------.
-000065d0: 2020 2020 2020 2020 696e 7075 745f 6469          input_di
-000065e0: 6374 3a20 4f50 4549 6e70 7574 4469 6374  ct: OPEInputDict
-000065f0: 206f 7220 4d75 6c74 6970 6c65 496e 7075   or MultipleInpu
-00006600: 7444 6963 740a 2020 2020 2020 2020 2020  tDict.          
-00006610: 2020 4469 6374 696f 6e61 7279 206f 6620    Dictionary of 
-00006620: 7468 6520 4f50 4520 696e 7075 7473 2066  the OPE inputs f
-00006630: 6f72 2065 6163 6820 6576 616c 7561 7469  or each evaluati
-00006640: 6f6e 2070 6f6c 6963 792e 0a0a 2020 2020  on policy...    
-00006650: 2020 2020 2020 2020 2e2e 2063 6f64 652d          .. code-
-00006660: 626c 6f63 6b3a 3a20 7079 7468 6f6e 0a0a  block:: python..
-00006670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006680: 6b65 793a 205b 6576 616c 7561 7469 6f6e  key: [evaluation
-00006690: 5f70 6f6c 6963 795d 5b0a 2020 2020 2020  _policy][.      
-000066a0: 2020 2020 2020 2020 2020 2020 2020 6576                ev
-000066b0: 616c 7561 7469 6f6e 5f70 6f6c 6963 795f  aluation_policy_
-000066c0: 6163 7469 6f6e 2c0a 2020 2020 2020 2020  action,.        
-000066d0: 2020 2020 2020 2020 2020 2020 6576 616c              eval
-000066e0: 7561 7469 6f6e 5f70 6f6c 6963 795f 6163  uation_policy_ac
-000066f0: 7469 6f6e 5f64 6973 742c 0a20 2020 2020  tion_dist,.     
-00006700: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00006710: 7461 7465 5f61 6374 696f 6e5f 7661 6c75  tate_action_valu
-00006720: 655f 7072 6564 6963 7469 6f6e 2c0a 2020  e_prediction,.  
-00006730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006740: 2020 696e 6974 6961 6c5f 7374 6174 655f    initial_state_
-00006750: 7661 6c75 655f 7072 6564 6963 7469 6f6e  value_prediction
-00006760: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00006770: 2020 2020 2020 7374 6174 655f 6163 7469        state_acti
-00006780: 6f6e 5f6d 6172 6769 6e61 6c5f 696d 706f  on_marginal_impo
-00006790: 7274 616e 6365 5f77 6569 6768 742c 0a20  rtance_weight,. 
-000067a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000067b0: 2020 2073 7461 7465 5f6d 6172 6769 6e61     state_margina
-000067c0: 6c5f 696d 706f 7274 616e 6365 5f77 6569  l_importance_wei
-000067d0: 6768 742c 0a20 2020 2020 2020 2020 2020  ght,.           
-000067e0: 2020 2020 2020 2020 206f 6e5f 706f 6c69           on_poli
-000067f0: 6379 5f70 6f6c 6963 795f 7661 6c75 652c  cy_policy_value,
-00006800: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00006810: 2020 2020 2067 616d 6d61 2c0a 2020 2020       gamma,.    
-00006820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006830: 6265 6861 7669 6f72 5f70 6f6c 6963 792c  behavior_policy,
-00006840: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00006850: 2020 2020 2065 7661 6c75 6174 696f 6e5f       evaluation_
-00006860: 706f 6c69 6379 2c0a 2020 2020 2020 2020  policy,.        
-00006870: 2020 2020 2020 2020 2020 2020 6461 7461              data
-00006880: 7365 745f 6964 2c0a 2020 2020 2020 2020  set_id,.        
-00006890: 2020 2020 2020 2020 5d0a 0a20 2020 2020          ]..     
-000068a0: 2020 2020 2020 202e 2e20 7365 6561 6c73         .. seeals
-000068b0: 6f3a 3a0a 0a20 2020 2020 2020 2020 2020  o::..           
-000068c0: 2020 2020 203a 636c 6173 733a 6073 636f       :class:`sco
-000068d0: 7065 5f72 6c2e 6f70 652e 696e 7075 742e  pe_rl.ope.input.
-000068e0: 4372 6561 7465 4f50 4549 6e70 7574 6020  CreateOPEInput` 
-000068f0: 6465 7363 7269 6265 7320 7468 6520 636f  describes the co
-00006900: 6d70 6f6e 656e 7473 206f 6620 3a63 6c61  mponents of :cla
-00006910: 7373 3a60 696e 7075 745f 6469 6374 602e  ss:`input_dict`.
-00006920: 0a0a 2020 2020 2020 2020 636f 6d70 6172  ..        compar
-00006930: 6564 5f65 7374 696d 6174 6f72 733a 206c  ed_estimators: l
-00006940: 6973 7420 6f66 2073 7472 2c20 6465 6661  ist of str, defa
-00006950: 756c 743d 4e6f 6e65 0a20 2020 2020 2020  ult=None.       
-00006960: 2020 2020 204e 616d 6520 6f66 2063 6f6d       Name of com
-00006970: 7061 7265 6420 6573 7469 6d61 746f 7273  pared estimators
-00006980: 2e0a 2020 2020 2020 2020 2020 2020 4966  ..            If
-00006990: 2060 4e6f 6e65 6020 6973 2067 6976 656e   `None` is given
-000069a0: 2c20 616c 6c20 7468 6520 6573 7469 6d61  , all the estima
-000069b0: 746f 7273 2061 7265 2063 6f6d 7061 7265  tors are compare
-000069c0: 642e 0a0a 2020 2020 2020 2020 6265 6861  d...        beha
-000069d0: 7669 6f72 5f70 6f6c 6963 795f 6e61 6d65  vior_policy_name
-000069e0: 3a20 7374 722c 2064 6566 6175 6c74 3d4e  : str, default=N
-000069f0: 6f6e 650a 2020 2020 2020 2020 2020 2020  one.            
-00006a00: 4e61 6d65 206f 6620 7468 6520 6265 6861  Name of the beha
-00006a10: 7669 6f72 2070 6f6c 6963 792e 0a0a 2020  vior policy...  
-00006a20: 2020 2020 2020 6461 7461 7365 745f 6964        dataset_id
-00006a30: 3a20 696e 742c 2064 6566 6175 6c74 3d4e  : int, default=N
-00006a40: 6f6e 650a 2020 2020 2020 2020 2020 2020  one.            
-00006a50: 4964 206f 6620 7468 6520 6c6f 6767 6564  Id of the logged
-00006a60: 2064 6174 6173 6574 2e0a 0a20 2020 2020   dataset...     
-00006a70: 2020 2052 6574 7572 6e0a 2020 2020 2020     Return.      
-00006a80: 2020 2d2d 2d2d 2d2d 2d0a 2020 2020 2020    -------.      
-00006a90: 2020 706f 6c69 6379 5f76 616c 7565 5f64    policy_value_d
-00006aa0: 6963 743a 2064 6963 7420 282c 2064 6963  ict: dict (, dic
-00006ab0: 7420 6f66 206c 6973 7420 6f66 2064 6963  t of list of dic
-00006ac0: 7429 0a20 2020 2020 2020 2020 2020 2044  t).            D
-00006ad0: 6963 7469 6f6e 6172 7920 636f 6e74 6169  ictionary contai
-00006ae0: 6e69 6e67 2074 6865 2070 6f6c 6963 7920  ning the policy 
-00006af0: 7661 6c75 6520 6f66 2065 6163 6820 6576  value of each ev
-00006b00: 616c 7561 7469 6f6e 2070 6f6c 6963 7920  aluation policy 
-00006b10: 6573 7469 6d61 7465 6420 6279 204f 5045  estimated by OPE
-00006b20: 2065 7374 696d 6174 6f72 732e 0a20 2020   estimators..   
-00006b30: 2020 2020 2020 2020 206b 6579 3a20 3a63           key: :c
-00006b40: 6c61 7373 3a60 5b65 7661 6c75 6174 696f  lass:`[evaluatio
-00006b50: 6e5f 706f 6c69 6379 5d5b 4f50 455f 6573  n_policy][OPE_es
-00006b60: 7469 6d61 746f 725f 6e61 6d65 5d60 0a0a  timator_name]`..
-00006b70: 2020 2020 2020 2020 2020 2020 5768 656e              When
-00006b80: 2062 6568 6176 696f 725f 706f 6c69 6379   behavior_policy
-00006b90: 5f6e 616d 6520 6973 2060 4e6f 6e65 6020  _name is `None` 
-00006ba0: 616e 6420 6461 7461 7365 745f 6964 2069  and dataset_id i
-00006bb0: 7320 604e 6f6e 6560 2c0a 2020 2020 2020  s `None`,.      
-00006bc0: 2020 2020 2020 6b65 793a 203a 636c 6173        key: :clas
-00006bd0: 733a 605b 6265 6861 7669 6f72 5f70 6f6c  s:`[behavior_pol
-00006be0: 6963 795f 6e61 6d65 5d5b 6461 7461 7365  icy_name][datase
-00006bf0: 745f 6964 5d5b 6576 616c 7561 7469 6f6e  t_id][evaluation
-00006c00: 5f70 6f6c 6963 795d 5b4f 5045 5f65 7374  _policy][OPE_est
-00006c10: 696d 6174 6f72 5f6e 616d 655d 600a 0a20  imator_name]`.. 
-00006c20: 2020 2020 2020 2020 2020 2057 6865 6e20             When 
-00006c30: 6265 6861 7669 6f72 5f70 6f6c 6963 7920  behavior_policy 
-00006c40: 6973 2060 4e6f 6e65 6020 616e 6420 6461  is `None` and da
-00006c50: 7461 7365 745f 6964 2069 7320 7370 6563  taset_id is spec
-00006c60: 6966 6965 642c 0a20 2020 2020 2020 2020  ified,.         
-00006c70: 2020 206b 6579 3a20 3a63 6c61 7373 3a60     key: :class:`
-00006c80: 5b62 6568 6176 696f 725f 706f 6c69 6379  [behavior_policy
-00006c90: 5f6e 616d 655d 5b65 7661 6c75 6174 696f  _name][evaluatio
-00006ca0: 6e5f 706f 6c69 6379 5d5b 4f50 455f 6573  n_policy][OPE_es
-00006cb0: 7469 6d61 746f 725f 6e61 6d65 5d60 0a0a  timator_name]`..
-00006cc0: 2020 2020 2020 2020 2020 2020 5768 656e              When
-00006cd0: 2062 6568 6176 696f 725f 706f 6c69 6379   behavior_policy
-00006ce0: 5f6e 616d 6520 6973 2073 7065 6369 6669  _name is specifi
-00006cf0: 6564 2061 6e64 2064 6174 6173 6574 5f69  ed and dataset_i
-00006d00: 6420 6973 2060 4e6f 6e65 602c 0a20 2020  d is `None`,.   
-00006d10: 2020 2020 2020 2020 206b 6579 3a20 3a63           key: :c
-00006d20: 6c61 7373 3a60 5b64 6174 6173 6574 5f69  lass:`[dataset_i
-00006d30: 645d 5b4f 5045 5f65 7374 696d 6174 6f72  d][OPE_estimator
-00006d40: 5f6e 616d 655d 600a 0a20 2020 2020 2020  _name]`..       
-00006d50: 2022 2222 0a20 2020 2020 2020 2063 6f6d   """.        com
-00006d60: 7061 7265 645f 6573 7469 6d61 746f 7273  pared_estimators
-00006d70: 203d 2073 656c 662e 5f63 6865 636b 5f63   = self._check_c
-00006d80: 6f6d 7061 7265 645f 6573 7469 6d61 746f  ompared_estimato
-00006d90: 7273 2863 6f6d 7061 7265 645f 6573 7469  rs(compared_esti
-00006da0: 6d61 746f 7273 290a 0a20 2020 2020 2020  mators)..       
-00006db0: 2069 6620 7365 6c66 2e75 7365 5f6d 756c   if self.use_mul
-00006dc0: 7469 706c 655f 6c6f 6767 6564 5f64 6174  tiple_logged_dat
-00006dd0: 6173 6574 3a0a 2020 2020 2020 2020 2020  aset:.          
-00006de0: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-00006df0: 696e 7075 745f 6469 6374 2c20 4d75 6c74  input_dict, Mult
-00006e00: 6970 6c65 496e 7075 7444 6963 7429 3a0a  ipleInputDict):.
-00006e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006e20: 6966 2062 6568 6176 696f 725f 706f 6c69  if behavior_poli
-00006e30: 6379 5f6e 616d 6520 6973 204e 6f6e 6520  cy_name is None 
-00006e40: 616e 6420 6461 7461 7365 745f 6964 2069  and dataset_id i
-00006e50: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
-00006e60: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-00006e70: 656c 662e 6d75 6c74 6970 6c65 5f6c 6f67  elf.multiple_log
-00006e80: 6765 645f 6461 7461 7365 742e 6e5f 6461  ged_dataset.n_da
-00006e90: 7461 7365 7473 2021 3d20 696e 7075 745f  tasets != input_
-00006ea0: 6469 6374 2e6e 5f64 6174 6173 6574 733a  dict.n_datasets:
-00006eb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00006ec0: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-00006ed0: 616c 7565 4572 726f 7228 0a20 2020 2020  alueError(.     
-00006ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006ef0: 2020 2020 2020 2022 4578 7065 6374 6564         "Expected
-00006f00: 2074 6861 7420 6c6f 6767 6564 2064 6174   that logged dat
-00006f10: 6173 6574 7320 616e 6420 696e 7075 7420  asets and input 
-00006f20: 6469 6374 7320 636f 6e73 6973 7473 206f  dicts consists o
-00006f30: 6620 7468 6520 7361 6d65 2062 6568 6176  f the same behav
-00006f40: 696f 7220 706f 6c69 6369 6573 2061 6e64  ior policies and
-00006f50: 2064 6174 6173 6574 2069 6473 2c20 6275   dataset ids, bu
-00006f60: 7420 666f 756e 6420 4661 6c73 652e 220a  t found False.".
-00006f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006f80: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
-00006f90: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00006fa0: 6f6c 6963 795f 7661 6c75 655f 6469 6374  olicy_value_dict
-00006fb0: 203d 2064 6566 6175 6c74 6469 6374 286c   = defaultdict(l
-00006fc0: 6973 7429 0a20 2020 2020 2020 2020 2020  ist).           
-00006fd0: 2020 2020 2020 2020 2066 6f72 2028 0a20           for (. 
-00006fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006ff0: 2020 2020 2020 2062 6568 6176 696f 725f         behavior_
-00007000: 706f 6c69 6379 2c0a 2020 2020 2020 2020  policy,.        
-00007010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007020: 6e5f 6461 7461 7365 7473 2c0a 2020 2020  n_datasets,.    
-00007030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007040: 2920 696e 2069 6e70 7574 5f64 6963 742e  ) in input_dict.
-00007050: 6e5f 6461 7461 7365 7473 2e69 7465 6d73  n_datasets.items
-00007060: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
-00007070: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00007080: 6461 7461 7365 745f 6964 5f20 696e 2072  dataset_id_ in r
-00007090: 616e 6765 286e 5f64 6174 6173 6574 7329  ange(n_datasets)
-000070a0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000070b0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-000070c0: 6c66 2e5f 7265 6769 7374 6572 5f6c 6f67  lf._register_log
-000070d0: 6765 645f 6461 7461 7365 7428 0a20 2020  ged_dataset(.   
-000070e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000070f0: 2020 2020 2020 2020 2020 2020 2062 6568               beh
-00007100: 6176 696f 725f 706f 6c69 6379 5f6e 616d  avior_policy_nam
-00007110: 653d 6265 6861 7669 6f72 5f70 6f6c 6963  e=behavior_polic
-00007120: 792c 0a20 2020 2020 2020 2020 2020 2020  y,.             
-00007130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007140: 2020 2064 6174 6173 6574 5f69 643d 6461     dataset_id=da
-00007150: 7461 7365 745f 6964 5f2c 0a20 2020 2020  taset_id_,.     
-00007160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007170: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00007180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007190: 2020 2020 2069 6e70 7574 5f64 6963 745f       input_dict_
-000071a0: 203d 2069 6e70 7574 5f64 6963 742e 6765   = input_dict.ge
-000071b0: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
-000071c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000071d0: 2020 2062 6568 6176 696f 725f 706f 6c69     behavior_poli
-000071e0: 6379 5f6e 616d 653d 6265 6861 7669 6f72  cy_name=behavior
-000071f0: 5f70 6f6c 6963 792c 0a20 2020 2020 2020  _policy,.       
-00007200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007210: 2020 2020 2020 2020 2064 6174 6173 6574           dataset
-00007220: 5f69 643d 6461 7461 7365 745f 6964 5f2c  _id=dataset_id_,
-00007230: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00007240: 2020 2020 2020 2020 2020 2020 2029 0a0a               )..
-00007250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007260: 2020 2020 2020 2020 2020 2020 706f 6c69              poli
-00007270: 6379 5f76 616c 7565 5f64 6963 745f 203d  cy_value_dict_ =
-00007280: 2073 656c 662e 5f65 7374 696d 6174 655f   self._estimate_
-00007290: 706f 6c69 6379 5f76 616c 7565 280a 2020  policy_value(.  
-000072a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000072b0: 2020 2020 2020 2020 2020 2020 2020 696e                in
-000072c0: 7075 745f 6469 6374 5f2c 0a20 2020 2020  put_dict_,.     
+00005f90: 2020 2020 2d20 6f6e 5f70 6f6c 6963 795f      - on_policy_
+00005fa0: 706f 6c69 6379 5f76 616c 7565 0a20 2020  policy_value.   
+00005fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005fc0: 2029 202f 206f 6e5f 706f 6c69 6379 5f70   ) / on_policy_p
+00005fd0: 6f6c 6963 795f 7661 6c75 650a 2020 2020  olicy_value.    
+00005fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005ff0: 6576 616c 5f6d 6574 7269 635f 6f70 655f  eval_metric_ope_
+00006000: 6469 6374 5b65 7661 6c5f 706f 6c69 6379  dict[eval_policy
+00006010: 5d5b 6573 7469 6d61 746f 725d 203d 206e  ][estimator] = n
+00006020: 702e 6162 7328 7265 6c61 7469 7665 5f65  p.abs(relative_e
+00006030: 655f 290a 0a20 2020 2020 2020 2065 6c73  e_)..        els
+00006040: 653a 0a20 2020 2020 2020 2020 2020 2066  e:.            f
+00006050: 6f72 2065 7661 6c5f 706f 6c69 6379 2069  or eval_policy i
+00006060: 6e20 696e 7075 745f 6469 6374 2e6b 6579  n input_dict.key
+00006070: 7328 293a 0a20 2020 2020 2020 2020 2020  s():.           
+00006080: 2020 2020 206f 6e5f 706f 6c69 6379 5f70       on_policy_p
+00006090: 6f6c 6963 795f 7661 6c75 6520 3d20 696e  olicy_value = in
+000060a0: 7075 745f 6469 6374 5b65 7661 6c5f 706f  put_dict[eval_po
+000060b0: 6c69 6379 5d5b 0a20 2020 2020 2020 2020  licy][.         
+000060c0: 2020 2020 2020 2020 2020 2022 6f6e 5f70             "on_p
+000060d0: 6f6c 6963 795f 706f 6c69 6379 5f76 616c  olicy_policy_val
+000060e0: 7565 220a 2020 2020 2020 2020 2020 2020  ue".            
+000060f0: 2020 2020 5d2e 6d65 616e 2829 0a0a 2020      ].mean()..  
+00006100: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+00006110: 7220 6573 7469 6d61 746f 7220 696e 2063  r estimator in c
+00006120: 6f6d 7061 7265 645f 6573 7469 6d61 746f  ompared_estimato
+00006130: 7273 3a0a 2020 2020 2020 2020 2020 2020  rs:.            
+00006140: 2020 2020 2020 2020 7365 5f20 3d20 280a          se_ = (.
+00006150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006160: 2020 2020 2020 2020 706f 6c69 6379 5f76          policy_v
+00006170: 616c 7565 5f64 6963 745b 6576 616c 5f70  alue_dict[eval_p
+00006180: 6f6c 6963 795d 5b65 7374 696d 6174 6f72  olicy][estimator
+00006190: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+000061a0: 2020 2020 2020 2020 2020 2d20 6f6e 5f70            - on_p
+000061b0: 6f6c 6963 795f 706f 6c69 6379 5f76 616c  olicy_policy_val
+000061c0: 7565 0a20 2020 2020 2020 2020 2020 2020  ue.             
+000061d0: 2020 2020 2020 2029 202a 2a20 320a 2020         ) ** 2.  
+000061e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000061f0: 2020 6576 616c 5f6d 6574 7269 635f 6f70    eval_metric_op
+00006200: 655f 6469 6374 5b65 7661 6c5f 706f 6c69  e_dict[eval_poli
+00006210: 6379 5d5b 6573 7469 6d61 746f 725d 203d  cy][estimator] =
+00006220: 2073 655f 0a0a 2020 2020 2020 2020 6576   se_..        ev
+00006230: 616c 5f6d 6574 7269 635f 6f70 655f 6469  al_metric_ope_di
+00006240: 6374 203d 2064 6566 6175 6c74 6469 6374  ct = defaultdict
+00006250: 5f74 6f5f 6469 6374 2865 7661 6c5f 6d65  _to_dict(eval_me
+00006260: 7472 6963 5f6f 7065 5f64 6963 7429 0a0a  tric_ope_dict)..
+00006270: 2020 2020 2020 2020 6966 2072 6574 7572          if retur
+00006280: 6e5f 6279 5f64 6174 6166 7261 6d65 3a0a  n_by_dataframe:.
+00006290: 2020 2020 2020 2020 2020 2020 6576 616c              eval
+000062a0: 5f6d 6574 7269 635f 6f70 655f 6466 203d  _metric_ope_df =
+000062b0: 2044 6174 6146 7261 6d65 2829 0a20 2020   DataFrame().   
+000062c0: 2020 2020 2020 2020 2066 6f72 2065 7661           for eva
+000062d0: 6c5f 706f 6c69 6379 2069 6e20 696e 7075  l_policy in inpu
+000062e0: 745f 6469 6374 2e6b 6579 7328 293a 0a20  t_dict.keys():. 
+000062f0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00006300: 7661 6c5f 6d65 7472 6963 5f6f 7065 5f64  val_metric_ope_d
+00006310: 665b 6576 616c 5f70 6f6c 6963 795d 203d  f[eval_policy] =
+00006320: 2044 6174 6146 7261 6d65 280a 2020 2020   DataFrame(.    
+00006330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006340: 6576 616c 5f6d 6574 7269 635f 6f70 655f  eval_metric_ope_
+00006350: 6469 6374 5b65 7661 6c5f 706f 6c69 6379  dict[eval_policy
+00006360: 5d2c 2069 6e64 6578 3d5b 6576 616c 5f70  ], index=[eval_p
+00006370: 6f6c 6963 795d 0a20 2020 2020 2020 2020  olicy].         
+00006380: 2020 2020 2020 2029 2e54 0a0a 2020 2020         ).T..    
+00006390: 2020 2020 7265 7475 726e 2065 7661 6c5f      return eval_
+000063a0: 6d65 7472 6963 5f6f 7065 5f64 6620 6966  metric_ope_df if
+000063b0: 2072 6574 7572 6e5f 6279 5f64 6174 6166   return_by_dataf
+000063c0: 7261 6d65 2065 6c73 6520 6576 616c 5f6d  rame else eval_m
+000063d0: 6574 7269 635f 6f70 655f 6469 6374 0a0a  etric_ope_dict..
+000063e0: 2020 2020 6465 6620 6573 7469 6d61 7465      def estimate
+000063f0: 5f70 6f6c 6963 795f 7661 6c75 6528 0a20  _policy_value(. 
+00006400: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+00006410: 2020 2020 2069 6e70 7574 5f64 6963 743a       input_dict:
+00006420: 2055 6e69 6f6e 5b4f 5045 496e 7075 7444   Union[OPEInputD
+00006430: 6963 742c 204d 756c 7469 706c 6549 6e70  ict, MultipleInp
+00006440: 7574 4469 6374 5d2c 0a20 2020 2020 2020  utDict],.       
+00006450: 2063 6f6d 7061 7265 645f 6573 7469 6d61   compared_estima
+00006460: 746f 7273 3a20 4f70 7469 6f6e 616c 5b4c  tors: Optional[L
+00006470: 6973 745b 7374 725d 5d20 3d20 4e6f 6e65  ist[str]] = None
+00006480: 2c0a 2020 2020 2020 2020 6265 6861 7669  ,.        behavi
+00006490: 6f72 5f70 6f6c 6963 795f 6e61 6d65 3a20  or_policy_name: 
+000064a0: 4f70 7469 6f6e 616c 5b73 7472 5d20 3d20  Optional[str] = 
+000064b0: 4e6f 6e65 2c0a 2020 2020 2020 2020 6461  None,.        da
+000064c0: 7461 7365 745f 6964 3a20 4f70 7469 6f6e  taset_id: Option
+000064d0: 616c 5b69 6e74 5d20 3d20 4e6f 6e65 2c0a  al[int] = None,.
+000064e0: 2020 2020 2920 2d3e 2044 6963 745b 7374      ) -> Dict[st
+000064f0: 722c 2066 6c6f 6174 5d3a 0a20 2020 2020  r, float]:.     
+00006500: 2020 2022 2222 4573 7469 6d61 7465 2074     """Estimate t
+00006510: 6865 2070 6f6c 6963 7920 7661 6c75 6520  he policy value 
+00006520: 6f66 2074 6865 2067 6976 656e 2065 7661  of the given eva
+00006530: 6c75 6174 696f 6e20 706f 6c69 6369 6573  luation policies
+00006540: 2e0a 0a20 2020 2020 2020 2050 6172 616d  ...        Param
+00006550: 6574 6572 730a 2020 2020 2020 2020 2d2d  eters.        --
+00006560: 2d2d 2d2d 2d0a 2020 2020 2020 2020 696e  -----.        in
+00006570: 7075 745f 6469 6374 3a20 4f50 4549 6e70  put_dict: OPEInp
+00006580: 7574 4469 6374 206f 7220 4d75 6c74 6970  utDict or Multip
+00006590: 6c65 496e 7075 7444 6963 740a 2020 2020  leInputDict.    
+000065a0: 2020 2020 2020 2020 4469 6374 696f 6e61          Dictiona
+000065b0: 7279 206f 6620 7468 6520 4f50 4520 696e  ry of the OPE in
+000065c0: 7075 7473 2066 6f72 2065 6163 6820 6576  puts for each ev
+000065d0: 616c 7561 7469 6f6e 2070 6f6c 6963 792e  aluation policy.
+000065e0: 0a0a 2020 2020 2020 2020 2020 2020 2e2e  ..            ..
+000065f0: 2063 6f64 652d 626c 6f63 6b3a 3a20 7079   code-block:: py
+00006600: 7468 6f6e 0a0a 2020 2020 2020 2020 2020  thon..          
+00006610: 2020 2020 2020 6b65 793a 205b 6576 616c        key: [eval
+00006620: 7561 7469 6f6e 5f70 6f6c 6963 795d 5b0a  uation_policy][.
+00006630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006640: 2020 2020 6576 616c 7561 7469 6f6e 5f70      evaluation_p
+00006650: 6f6c 6963 795f 6163 7469 6f6e 2c0a 2020  olicy_action,.  
+00006660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006670: 2020 6576 616c 7561 7469 6f6e 5f70 6f6c    evaluation_pol
+00006680: 6963 795f 6163 7469 6f6e 5f64 6973 742c  icy_action_dist,
+00006690: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000066a0: 2020 2020 2073 7461 7465 5f61 6374 696f       state_actio
+000066b0: 6e5f 7661 6c75 655f 7072 6564 6963 7469  n_value_predicti
+000066c0: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
+000066d0: 2020 2020 2020 2020 696e 6974 6961 6c5f          initial_
+000066e0: 7374 6174 655f 7661 6c75 655f 7072 6564  state_value_pred
+000066f0: 6963 7469 6f6e 2c0a 2020 2020 2020 2020  iction,.        
+00006700: 2020 2020 2020 2020 2020 2020 7374 6174              stat
+00006710: 655f 6163 7469 6f6e 5f6d 6172 6769 6e61  e_action_margina
+00006720: 6c5f 696d 706f 7274 616e 6365 5f77 6569  l_importance_wei
+00006730: 6768 742c 0a20 2020 2020 2020 2020 2020  ght,.           
+00006740: 2020 2020 2020 2020 2073 7461 7465 5f6d           state_m
+00006750: 6172 6769 6e61 6c5f 696d 706f 7274 616e  arginal_importan
+00006760: 6365 5f77 6569 6768 742c 0a20 2020 2020  ce_weight,.     
+00006770: 2020 2020 2020 2020 2020 2020 2020 206f                 o
+00006780: 6e5f 706f 6c69 6379 5f70 6f6c 6963 795f  n_policy_policy_
+00006790: 7661 6c75 652c 0a20 2020 2020 2020 2020  value,.         
+000067a0: 2020 2020 2020 2020 2020 2067 616d 6d61             gamma
+000067b0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000067c0: 2020 2020 2020 6265 6861 7669 6f72 5f70        behavior_p
+000067d0: 6f6c 6963 792c 0a20 2020 2020 2020 2020  olicy,.         
+000067e0: 2020 2020 2020 2020 2020 2065 7661 6c75             evalu
+000067f0: 6174 696f 6e5f 706f 6c69 6379 2c0a 2020  ation_policy,.  
+00006800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006810: 2020 6461 7461 7365 745f 6964 2c0a 2020    dataset_id,.  
+00006820: 2020 2020 2020 2020 2020 2020 2020 5d0a                ].
+00006830: 0a20 2020 2020 2020 2020 2020 202e 2e20  .            .. 
+00006840: 7365 6561 6c73 6f3a 3a0a 0a20 2020 2020  seealso::..     
+00006850: 2020 2020 2020 2020 2020 203a 636c 6173             :clas
+00006860: 733a 6073 636f 7065 5f72 6c2e 6f70 652e  s:`scope_rl.ope.
+00006870: 696e 7075 742e 4372 6561 7465 4f50 4549  input.CreateOPEI
+00006880: 6e70 7574 6020 6465 7363 7269 6265 7320  nput` describes 
+00006890: 7468 6520 636f 6d70 6f6e 656e 7473 206f  the components o
+000068a0: 6620 3a63 6c61 7373 3a60 696e 7075 745f  f :class:`input_
+000068b0: 6469 6374 602e 0a0a 2020 2020 2020 2020  dict`...        
+000068c0: 636f 6d70 6172 6564 5f65 7374 696d 6174  compared_estimat
+000068d0: 6f72 733a 206c 6973 7420 6f66 2073 7472  ors: list of str
+000068e0: 2c20 6465 6661 756c 743d 4e6f 6e65 0a20  , default=None. 
+000068f0: 2020 2020 2020 2020 2020 204e 616d 6520             Name 
+00006900: 6f66 2063 6f6d 7061 7265 6420 6573 7469  of compared esti
+00006910: 6d61 746f 7273 2e0a 2020 2020 2020 2020  mators..        
+00006920: 2020 2020 4966 2060 4e6f 6e65 6020 6973      If `None` is
+00006930: 2067 6976 656e 2c20 616c 6c20 7468 6520   given, all the 
+00006940: 6573 7469 6d61 746f 7273 2061 7265 2063  estimators are c
+00006950: 6f6d 7061 7265 642e 0a0a 2020 2020 2020  ompared...      
+00006960: 2020 6265 6861 7669 6f72 5f70 6f6c 6963    behavior_polic
+00006970: 795f 6e61 6d65 3a20 7374 722c 2064 6566  y_name: str, def
+00006980: 6175 6c74 3d4e 6f6e 650a 2020 2020 2020  ault=None.      
+00006990: 2020 2020 2020 4e61 6d65 206f 6620 7468        Name of th
+000069a0: 6520 6265 6861 7669 6f72 2070 6f6c 6963  e behavior polic
+000069b0: 792e 0a0a 2020 2020 2020 2020 6461 7461  y...        data
+000069c0: 7365 745f 6964 3a20 696e 742c 2064 6566  set_id: int, def
+000069d0: 6175 6c74 3d4e 6f6e 650a 2020 2020 2020  ault=None.      
+000069e0: 2020 2020 2020 4964 206f 6620 7468 6520        Id of the 
+000069f0: 6c6f 6767 6564 2064 6174 6173 6574 2e0a  logged dataset..
+00006a00: 0a20 2020 2020 2020 2052 6574 7572 6e0a  .        Return.
+00006a10: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0a          -------.
+00006a20: 2020 2020 2020 2020 706f 6c69 6379 5f76          policy_v
+00006a30: 616c 7565 5f64 6963 743a 2064 6963 7420  alue_dict: dict 
+00006a40: 282c 2064 6963 7420 6f66 206c 6973 7420  (, dict of list 
+00006a50: 6f66 2064 6963 7429 0a20 2020 2020 2020  of dict).       
+00006a60: 2020 2020 2044 6963 7469 6f6e 6172 7920       Dictionary 
+00006a70: 636f 6e74 6169 6e69 6e67 2074 6865 2070  containing the p
+00006a80: 6f6c 6963 7920 7661 6c75 6520 6f66 2065  olicy value of e
+00006a90: 6163 6820 6576 616c 7561 7469 6f6e 2070  ach evaluation p
+00006aa0: 6f6c 6963 7920 6573 7469 6d61 7465 6420  olicy estimated 
+00006ab0: 6279 204f 5045 2065 7374 696d 6174 6f72  by OPE estimator
+00006ac0: 732e 0a20 2020 2020 2020 2020 2020 206b  s..            k
+00006ad0: 6579 3a20 3a63 6c61 7373 3a60 5b65 7661  ey: :class:`[eva
+00006ae0: 6c75 6174 696f 6e5f 706f 6c69 6379 5d5b  luation_policy][
+00006af0: 4f50 455f 6573 7469 6d61 746f 725f 6e61  OPE_estimator_na
+00006b00: 6d65 5d60 0a0a 2020 2020 2020 2020 2020  me]`..          
+00006b10: 2020 5768 656e 2062 6568 6176 696f 725f    When behavior_
+00006b20: 706f 6c69 6379 5f6e 616d 6520 6973 2060  policy_name is `
+00006b30: 4e6f 6e65 6020 616e 6420 6461 7461 7365  None` and datase
+00006b40: 745f 6964 2069 7320 604e 6f6e 6560 2c0a  t_id is `None`,.
+00006b50: 2020 2020 2020 2020 2020 2020 6b65 793a              key:
+00006b60: 203a 636c 6173 733a 605b 6265 6861 7669   :class:`[behavi
+00006b70: 6f72 5f70 6f6c 6963 795f 6e61 6d65 5d5b  or_policy_name][
+00006b80: 6461 7461 7365 745f 6964 5d5b 6576 616c  dataset_id][eval
+00006b90: 7561 7469 6f6e 5f70 6f6c 6963 795d 5b4f  uation_policy][O
+00006ba0: 5045 5f65 7374 696d 6174 6f72 5f6e 616d  PE_estimator_nam
+00006bb0: 655d 600a 0a20 2020 2020 2020 2020 2020  e]`..           
+00006bc0: 2057 6865 6e20 6265 6861 7669 6f72 5f70   When behavior_p
+00006bd0: 6f6c 6963 7920 6973 2060 4e6f 6e65 6020  olicy is `None` 
+00006be0: 616e 6420 6461 7461 7365 745f 6964 2069  and dataset_id i
+00006bf0: 7320 7370 6563 6966 6965 642c 0a20 2020  s specified,.   
+00006c00: 2020 2020 2020 2020 206b 6579 3a20 3a63           key: :c
+00006c10: 6c61 7373 3a60 5b62 6568 6176 696f 725f  lass:`[behavior_
+00006c20: 706f 6c69 6379 5f6e 616d 655d 5b65 7661  policy_name][eva
+00006c30: 6c75 6174 696f 6e5f 706f 6c69 6379 5d5b  luation_policy][
+00006c40: 4f50 455f 6573 7469 6d61 746f 725f 6e61  OPE_estimator_na
+00006c50: 6d65 5d60 0a0a 2020 2020 2020 2020 2020  me]`..          
+00006c60: 2020 5768 656e 2062 6568 6176 696f 725f    When behavior_
+00006c70: 706f 6c69 6379 5f6e 616d 6520 6973 2073  policy_name is s
+00006c80: 7065 6369 6669 6564 2061 6e64 2064 6174  pecified and dat
+00006c90: 6173 6574 5f69 6420 6973 2060 4e6f 6e65  aset_id is `None
+00006ca0: 602c 0a20 2020 2020 2020 2020 2020 206b  `,.            k
+00006cb0: 6579 3a20 3a63 6c61 7373 3a60 5b64 6174  ey: :class:`[dat
+00006cc0: 6173 6574 5f69 645d 5b4f 5045 5f65 7374  aset_id][OPE_est
+00006cd0: 696d 6174 6f72 5f6e 616d 655d 600a 0a20  imator_name]`.. 
+00006ce0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00006cf0: 2020 2063 6f6d 7061 7265 645f 6573 7469     compared_esti
+00006d00: 6d61 746f 7273 203d 2073 656c 662e 5f63  mators = self._c
+00006d10: 6865 636b 5f63 6f6d 7061 7265 645f 6573  heck_compared_es
+00006d20: 7469 6d61 746f 7273 2863 6f6d 7061 7265  timators(compare
+00006d30: 645f 6573 7469 6d61 746f 7273 290a 0a20  d_estimators).. 
+00006d40: 2020 2020 2020 2069 6620 7365 6c66 2e75         if self.u
+00006d50: 7365 5f6d 756c 7469 706c 655f 6c6f 6767  se_multiple_logg
+00006d60: 6564 5f64 6174 6173 6574 3a0a 2020 2020  ed_dataset:.    
+00006d70: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+00006d80: 7461 6e63 6528 696e 7075 745f 6469 6374  tance(input_dict
+00006d90: 2c20 4d75 6c74 6970 6c65 496e 7075 7444  , MultipleInputD
+00006da0: 6963 7429 3a0a 2020 2020 2020 2020 2020  ict):.          
+00006db0: 2020 2020 2020 6966 2062 6568 6176 696f        if behavio
+00006dc0: 725f 706f 6c69 6379 5f6e 616d 6520 6973  r_policy_name is
+00006dd0: 204e 6f6e 6520 616e 6420 6461 7461 7365   None and datase
+00006de0: 745f 6964 2069 7320 4e6f 6e65 3a0a 2020  t_id is None:.  
+00006df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006e00: 2020 6966 2073 656c 662e 6d75 6c74 6970    if self.multip
+00006e10: 6c65 5f6c 6f67 6765 645f 6461 7461 7365  le_logged_datase
+00006e20: 742e 6e5f 6461 7461 7365 7473 2021 3d20  t.n_datasets != 
+00006e30: 696e 7075 745f 6469 6374 2e6e 5f64 6174  input_dict.n_dat
+00006e40: 6173 6574 733a 0a20 2020 2020 2020 2020  asets:.         
+00006e50: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00006e60: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+00006e70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00006e80: 2020 2020 2020 2020 2020 2020 2022 4578               "Ex
+00006e90: 7065 6374 6564 2074 6861 7420 6c6f 6767  pected that logg
+00006ea0: 6564 2064 6174 6173 6574 7320 616e 6420  ed datasets and 
+00006eb0: 696e 7075 7420 6469 6374 7320 636f 6e73  input dicts cons
+00006ec0: 6973 7473 206f 6620 7468 6520 7361 6d65  ists of the same
+00006ed0: 2062 6568 6176 696f 7220 706f 6c69 6369   behavior polici
+00006ee0: 6573 2061 6e64 2064 6174 6173 6574 2069  es and dataset i
+00006ef0: 6473 2c20 6275 7420 666f 756e 6420 4661  ds, but found Fa
+00006f00: 6c73 652e 220a 2020 2020 2020 2020 2020  lse.".          
+00006f10: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+00006f20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00006f30: 2020 2020 2070 6f6c 6963 795f 7661 6c75       policy_valu
+00006f40: 655f 6469 6374 203d 2064 6566 6175 6c74  e_dict = default
+00006f50: 6469 6374 286c 6973 7429 0a20 2020 2020  dict(list).     
+00006f60: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00006f70: 6f72 2028 0a20 2020 2020 2020 2020 2020  or (.           
+00006f80: 2020 2020 2020 2020 2020 2020 2062 6568               beh
+00006f90: 6176 696f 725f 706f 6c69 6379 2c0a 2020  avior_policy,.  
+00006fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006fb0: 2020 2020 2020 6e5f 6461 7461 7365 7473        n_datasets
+00006fc0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00006fd0: 2020 2020 2020 2920 696e 2069 6e70 7574        ) in input
+00006fe0: 5f64 6963 742e 6e5f 6461 7461 7365 7473  _dict.n_datasets
+00006ff0: 2e69 7465 6d73 2829 3a0a 2020 2020 2020  .items():.      
+00007000: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007010: 2020 666f 7220 6461 7461 7365 745f 6964    for dataset_id
+00007020: 5f20 696e 2072 616e 6765 286e 5f64 6174  _ in range(n_dat
+00007030: 6173 6574 7329 3a0a 2020 2020 2020 2020  asets):.        
+00007040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007050: 2020 2020 7365 6c66 2e5f 7265 6769 7374      self._regist
+00007060: 6572 5f6c 6f67 6765 645f 6461 7461 7365  er_logged_datase
+00007070: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
+00007080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007090: 2020 2062 6568 6176 696f 725f 706f 6c69     behavior_poli
+000070a0: 6379 5f6e 616d 653d 6265 6861 7669 6f72  cy_name=behavior
+000070b0: 5f70 6f6c 6963 792c 0a20 2020 2020 2020  _policy,.       
+000070c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000070d0: 2020 2020 2020 2020 2064 6174 6173 6574           dataset
+000070e0: 5f69 643d 6461 7461 7365 745f 6964 5f2c  _id=dataset_id_,
+000070f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00007100: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
+00007110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007120: 2020 2020 2020 2020 2020 2069 6e70 7574             input
+00007130: 5f64 6963 745f 203d 2069 6e70 7574 5f64  _dict_ = input_d
+00007140: 6963 742e 6765 7428 0a20 2020 2020 2020  ict.get(.       
+00007150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007160: 2020 2020 2020 2020 2062 6568 6176 696f           behavio
+00007170: 725f 706f 6c69 6379 5f6e 616d 653d 6265  r_policy_name=be
+00007180: 6861 7669 6f72 5f70 6f6c 6963 792c 0a20  havior_policy,. 
+00007190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000071a0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+000071b0: 6174 6173 6574 5f69 643d 6461 7461 7365  ataset_id=datase
+000071c0: 745f 6964 5f2c 0a20 2020 2020 2020 2020  t_id_,.         
+000071d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000071e0: 2020 2029 0a0a 2020 2020 2020 2020 2020     )..          
+000071f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007200: 2020 706f 6c69 6379 5f76 616c 7565 5f64    policy_value_d
+00007210: 6963 745f 203d 2073 656c 662e 5f65 7374  ict_ = self._est
+00007220: 696d 6174 655f 706f 6c69 6379 5f76 616c  imate_policy_val
+00007230: 7565 280a 2020 2020 2020 2020 2020 2020  ue(.            
+00007240: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007250: 2020 2020 696e 7075 745f 6469 6374 5f2c      input_dict_,
+00007260: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00007270: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007280: 2063 6f6d 7061 7265 645f 6573 7469 6d61   compared_estima
+00007290: 746f 7273 3d63 6f6d 7061 7265 645f 6573  tors=compared_es
+000072a0: 7469 6d61 746f 7273 2c0a 2020 2020 2020  timators,.      
+000072b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000072c0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
 000072d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000072e0: 2020 2020 2020 2020 2020 2063 6f6d 7061             compa
-000072f0: 7265 645f 6573 7469 6d61 746f 7273 3d63  red_estimators=c
-00007300: 6f6d 7061 7265 645f 6573 7469 6d61 746f  ompared_estimato
-00007310: 7273 2c0a 2020 2020 2020 2020 2020 2020  rs,.            
-00007320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007330: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00007340: 2020 2020 2020 2020 2020 2020 2020 706f                po
-00007350: 6c69 6379 5f76 616c 7565 5f64 6963 745b  licy_value_dict[
-00007360: 6265 6861 7669 6f72 5f70 6f6c 6963 795d  behavior_policy]
-00007370: 2e61 7070 656e 6428 0a20 2020 2020 2020  .append(.       
-00007380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007390: 2020 2020 2020 2020 2070 6f6c 6963 795f           policy_
-000073a0: 7661 6c75 655f 6469 6374 5f0a 2020 2020  value_dict_.    
-000073b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000073c0: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
-000073d0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-000073e0: 6f6c 6963 795f 7661 6c75 655f 6469 6374  olicy_value_dict
-000073f0: 203d 2064 6566 6175 6c74 6469 6374 5f74   = defaultdict_t
-00007400: 6f5f 6469 6374 2870 6f6c 6963 795f 7661  o_dict(policy_va
-00007410: 6c75 655f 6469 6374 290a 0a20 2020 2020  lue_dict)..     
-00007420: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
-00007430: 6265 6861 7669 6f72 5f70 6f6c 6963 795f  behavior_policy_
-00007440: 6e61 6d65 2069 7320 4e6f 6e65 2061 6e64  name is None and
-00007450: 2064 6174 6173 6574 5f69 6420 6973 206e   dataset_id is n
-00007460: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
-00007470: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00007480: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00007490: 2020 2020 2020 2020 2020 7365 6c66 2e6d            self.m
-000074a0: 756c 7469 706c 655f 6c6f 6767 6564 5f64  ultiple_logged_d
-000074b0: 6174 6173 6574 2e62 6568 6176 696f 725f  ataset.behavior_
-000074c0: 706f 6c69 6379 5f6e 616d 6573 0a20 2020  policy_names.   
-000074d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000074e0: 2020 2020 2021 3d20 696e 7075 745f 6469       != input_di
-000074f0: 6374 2e62 6568 6176 696f 725f 706f 6c69  ct.behavior_poli
-00007500: 6379 5f6e 616d 6573 0a20 2020 2020 2020  cy_names.       
-00007510: 2020 2020 2020 2020 2020 2020 2029 3a0a               ):.
-00007520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007530: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-00007540: 6c75 6545 7272 6f72 280a 2020 2020 2020  lueError(.      
-00007550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007560: 2020 2020 2020 2245 7870 6563 7465 6420        "Expected 
-00007570: 7468 6174 206c 6f67 6765 6420 6461 7461  that logged data
-00007580: 7365 7473 2061 6e64 2069 6e70 7574 2064  sets and input d
-00007590: 6963 7473 2063 6f6e 7369 7374 7320 6f66  icts consists of
-000075a0: 2074 6865 2073 616d 6520 6265 6861 7669   the same behavi
-000075b0: 6f72 2070 6f6c 6963 6965 732c 2062 7574  or policies, but
-000075c0: 2066 6f75 6e64 2046 616c 7365 2e22 0a20   found False.". 
-000075d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000075e0: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-000075f0: 2020 2020 2020 2020 2020 2020 2020 706f                po
-00007600: 6c69 6379 5f76 616c 7565 5f64 6963 7420  licy_value_dict 
-00007610: 3d20 7b7d 0a20 2020 2020 2020 2020 2020  = {}.           
-00007620: 2020 2020 2020 2020 2066 6f72 2062 6568           for beh
-00007630: 6176 696f 725f 706f 6c69 6379 2069 6e20  avior_policy in 
-00007640: 696e 7075 745f 6469 6374 2e62 6568 6176  input_dict.behav
-00007650: 696f 725f 706f 6c69 6379 5f6e 616d 6573  ior_policy_names
-00007660: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00007670: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-00007680: 7265 6769 7374 6572 5f6c 6f67 6765 645f  register_logged_
-00007690: 6461 7461 7365 7428 0a20 2020 2020 2020  dataset(.       
-000076a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000076b0: 2020 2020 2062 6568 6176 696f 725f 706f       behavior_po
-000076c0: 6c69 6379 5f6e 616d 653d 6265 6861 7669  licy_name=behavi
-000076d0: 6f72 5f70 6f6c 6963 792c 2064 6174 6173  or_policy, datas
-000076e0: 6574 5f69 643d 6461 7461 7365 745f 6964  et_id=dataset_id
-000076f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00007700: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-00007710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007720: 2020 2069 6e70 7574 5f64 6963 745f 203d     input_dict_ =
-00007730: 2069 6e70 7574 5f64 6963 742e 6765 7428   input_dict.get(
-00007740: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00007750: 2020 2020 2020 2020 2020 2020 2062 6568               beh
-00007760: 6176 696f 725f 706f 6c69 6379 5f6e 616d  avior_policy_nam
-00007770: 653d 6265 6861 7669 6f72 5f70 6f6c 6963  e=behavior_polic
-00007780: 792c 0a20 2020 2020 2020 2020 2020 2020  y,.             
-00007790: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-000077a0: 6174 6173 6574 5f69 643d 6461 7461 7365  ataset_id=datase
-000077b0: 745f 6964 2c0a 2020 2020 2020 2020 2020  t_id,.          
-000077c0: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-000077d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000077e0: 2020 2020 2020 2020 2070 6f6c 6963 795f           policy_
-000077f0: 7661 6c75 655f 6469 6374 5f20 3d20 7365  value_dict_ = se
-00007800: 6c66 2e5f 6573 7469 6d61 7465 5f70 6f6c  lf._estimate_pol
-00007810: 6963 795f 7661 6c75 6528 0a20 2020 2020  icy_value(.     
+000072e0: 2020 2020 706f 6c69 6379 5f76 616c 7565      policy_value
+000072f0: 5f64 6963 745b 6265 6861 7669 6f72 5f70  _dict[behavior_p
+00007300: 6f6c 6963 795d 2e61 7070 656e 6428 0a20  olicy].append(. 
+00007310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007320: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00007330: 6f6c 6963 795f 7661 6c75 655f 6469 6374  olicy_value_dict
+00007340: 5f0a 2020 2020 2020 2020 2020 2020 2020  _.              
+00007350: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+00007360: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00007370: 2020 2020 2070 6f6c 6963 795f 7661 6c75       policy_valu
+00007380: 655f 6469 6374 203d 2064 6566 6175 6c74  e_dict = default
+00007390: 6469 6374 5f74 6f5f 6469 6374 2870 6f6c  dict_to_dict(pol
+000073a0: 6963 795f 7661 6c75 655f 6469 6374 290a  icy_value_dict).
+000073b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000073c0: 2065 6c69 6620 6265 6861 7669 6f72 5f70   elif behavior_p
+000073d0: 6f6c 6963 795f 6e61 6d65 2069 7320 4e6f  olicy_name is No
+000073e0: 6e65 2061 6e64 2064 6174 6173 6574 5f69  ne and dataset_i
+000073f0: 6420 6973 206e 6f74 204e 6f6e 653a 0a20  d is not None:. 
+00007400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007410: 2020 2069 6620 280a 2020 2020 2020 2020     if (.        
+00007420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007430: 7365 6c66 2e6d 756c 7469 706c 655f 6c6f  self.multiple_lo
+00007440: 6767 6564 5f64 6174 6173 6574 2e62 6568  gged_dataset.beh
+00007450: 6176 696f 725f 706f 6c69 6379 5f6e 616d  avior_policy_nam
+00007460: 6573 0a20 2020 2020 2020 2020 2020 2020  es.             
+00007470: 2020 2020 2020 2020 2020 2021 3d20 696e             != in
+00007480: 7075 745f 6469 6374 2e62 6568 6176 696f  put_dict.behavio
+00007490: 725f 706f 6c69 6379 5f6e 616d 6573 0a20  r_policy_names. 
+000074a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000074b0: 2020 2029 3a0a 2020 2020 2020 2020 2020     ):.          
+000074c0: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+000074d0: 6973 6520 5661 6c75 6545 7272 6f72 280a  ise ValueError(.
+000074e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000074f0: 2020 2020 2020 2020 2020 2020 2245 7870              "Exp
+00007500: 6563 7465 6420 7468 6174 206c 6f67 6765  ected that logge
+00007510: 6420 6461 7461 7365 7473 2061 6e64 2069  d datasets and i
+00007520: 6e70 7574 2064 6963 7473 2063 6f6e 7369  nput dicts consi
+00007530: 7374 7320 6f66 2074 6865 2073 616d 6520  sts of the same 
+00007540: 6265 6861 7669 6f72 2070 6f6c 6963 6965  behavior policie
+00007550: 732c 2062 7574 2066 6f75 6e64 2046 616c  s, but found Fal
+00007560: 7365 2e22 0a20 2020 2020 2020 2020 2020  se.".           
+00007570: 2020 2020 2020 2020 2020 2020 2029 0a0a               )..
+00007580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007590: 2020 2020 706f 6c69 6379 5f76 616c 7565      policy_value
+000075a0: 5f64 6963 7420 3d20 7b7d 0a20 2020 2020  _dict = {}.     
+000075b0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+000075c0: 6f72 2062 6568 6176 696f 725f 706f 6c69  or behavior_poli
+000075d0: 6379 2069 6e20 696e 7075 745f 6469 6374  cy in input_dict
+000075e0: 2e62 6568 6176 696f 725f 706f 6c69 6379  .behavior_policy
+000075f0: 5f6e 616d 6573 3a0a 2020 2020 2020 2020  _names:.        
+00007600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007610: 7365 6c66 2e5f 7265 6769 7374 6572 5f6c  self._register_l
+00007620: 6f67 6765 645f 6461 7461 7365 7428 0a20  ogged_dataset(. 
+00007630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007640: 2020 2020 2020 2020 2020 2062 6568 6176             behav
+00007650: 696f 725f 706f 6c69 6379 5f6e 616d 653d  ior_policy_name=
+00007660: 6265 6861 7669 6f72 5f70 6f6c 6963 792c  behavior_policy,
+00007670: 2064 6174 6173 6574 5f69 643d 6461 7461   dataset_id=data
+00007680: 7365 745f 6964 0a20 2020 2020 2020 2020  set_id.         
+00007690: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+000076a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000076b0: 2020 2020 2020 2020 2069 6e70 7574 5f64           input_d
+000076c0: 6963 745f 203d 2069 6e70 7574 5f64 6963  ict_ = input_dic
+000076d0: 742e 6765 7428 0a20 2020 2020 2020 2020  t.get(.         
+000076e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000076f0: 2020 2062 6568 6176 696f 725f 706f 6c69     behavior_poli
+00007700: 6379 5f6e 616d 653d 6265 6861 7669 6f72  cy_name=behavior
+00007710: 5f70 6f6c 6963 792c 0a20 2020 2020 2020  _policy,.       
+00007720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007730: 2020 2020 2064 6174 6173 6574 5f69 643d       dataset_id=
+00007740: 6461 7461 7365 745f 6964 2c0a 2020 2020  dataset_id,.    
+00007750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007760: 2020 2020 290a 0a20 2020 2020 2020 2020      )..         
+00007770: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00007780: 6f6c 6963 795f 7661 6c75 655f 6469 6374  olicy_value_dict
+00007790: 5f20 3d20 7365 6c66 2e5f 6573 7469 6d61  _ = self._estima
+000077a0: 7465 5f70 6f6c 6963 795f 7661 6c75 6528  te_policy_value(
+000077b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000077c0: 2020 2020 2020 2020 2020 2020 2069 6e70               inp
+000077d0: 7574 5f64 6963 745f 2c0a 2020 2020 2020  ut_dict_,.      
+000077e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000077f0: 2020 2020 2020 636f 6d70 6172 6564 5f65        compared_e
+00007800: 7374 696d 6174 6f72 733d 636f 6d70 6172  stimators=compar
+00007810: 6564 5f65 7374 696d 6174 6f72 732c 0a20  ed_estimators,. 
 00007820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007830: 2020 2020 2020 2069 6e70 7574 5f64 6963         input_dic
-00007840: 745f 2c0a 2020 2020 2020 2020 2020 2020  t_,.            
-00007850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007860: 636f 6d70 6172 6564 5f65 7374 696d 6174  compared_estimat
-00007870: 6f72 733d 636f 6d70 6172 6564 5f65 7374  ors=compared_est
-00007880: 696d 6174 6f72 732c 0a20 2020 2020 2020  imators,.       
-00007890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000078a0: 2029 0a20 2020 2020 2020 2020 2020 2020   ).             
-000078b0: 2020 2020 2020 2020 2020 2070 6f6c 6963             polic
-000078c0: 795f 7661 6c75 655f 6469 6374 5b62 6568  y_value_dict[beh
-000078d0: 6176 696f 725f 706f 6c69 6379 5d20 3d20  avior_policy] = 
-000078e0: 706f 6c69 6379 5f76 616c 7565 5f64 6963  policy_value_dic
-000078f0: 745f 0a0a 2020 2020 2020 2020 2020 2020  t_..            
-00007900: 2020 2020 656c 6966 2062 6568 6176 696f      elif behavio
-00007910: 725f 706f 6c69 6379 5f6e 616d 6520 6973  r_policy_name is
-00007920: 206e 6f74 204e 6f6e 6520 616e 6420 6461   not None and da
-00007930: 7461 7365 745f 6964 2069 7320 4e6f 6e65  taset_id is None
-00007940: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00007950: 2020 2020 2020 6966 2028 0a20 2020 2020        if (.     
-00007960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007970: 2020 2073 656c 662e 6d75 6c74 6970 6c65     self.multiple
-00007980: 5f6c 6f67 6765 645f 6461 7461 7365 742e  _logged_dataset.
-00007990: 6e5f 6461 7461 7365 7473 5b62 6568 6176  n_datasets[behav
-000079a0: 696f 725f 706f 6c69 6379 5f6e 616d 655d  ior_policy_name]
-000079b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000079c0: 2020 2020 2020 2020 2021 3d20 696e 7075           != inpu
-000079d0: 745f 6469 6374 2e6e 5f64 6174 6173 6574  t_dict.n_dataset
-000079e0: 735b 6265 6861 7669 6f72 5f70 6f6c 6963  s[behavior_polic
-000079f0: 795f 6e61 6d65 5d0a 2020 2020 2020 2020  y_name].        
-00007a00: 2020 2020 2020 2020 2020 2020 293a 0a20              ):. 
-00007a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007a20: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
-00007a30: 7565 4572 726f 7228 0a20 2020 2020 2020  ueError(.       
-00007a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007a50: 2020 2020 2022 4578 7065 6374 6564 2074       "Expected t
-00007a60: 6861 7420 6c6f 6767 6564 2064 6174 6173  hat logged datas
-00007a70: 6574 7320 616e 6420 696e 7075 7420 6469  ets and input di
-00007a80: 6374 7320 636f 6e73 6973 7473 206f 6620  cts consists of 
-00007a90: 7468 6520 7361 6d65 2064 6174 6173 6574  the same dataset
-00007aa0: 2069 6473 2c20 6275 7420 666f 756e 6420   ids, but found 
-00007ab0: 4661 6c73 652e 220a 2020 2020 2020 2020  False.".        
-00007ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007ad0: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
-00007ae0: 2020 2020 2020 2070 6f6c 6963 795f 7661         policy_va
-00007af0: 6c75 655f 6469 6374 203d 205b 5d0a 2020  lue_dict = [].  
-00007b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007b10: 2020 666f 7220 6461 7461 7365 745f 6964    for dataset_id
-00007b20: 5f20 696e 2072 616e 6765 280a 2020 2020  _ in range(.    
-00007b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007b40: 2020 2020 696e 7075 745f 6469 6374 2e6e      input_dict.n
-00007b50: 5f64 6174 6173 6574 735b 6265 6861 7669  _datasets[behavi
-00007b60: 6f72 5f70 6f6c 6963 795f 6e61 6d65 5d0a  or_policy_name].
-00007b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007b80: 2020 2020 293a 0a20 2020 2020 2020 2020      ):.         
-00007b90: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00007ba0: 656c 662e 5f72 6567 6973 7465 725f 6c6f  elf._register_lo
-00007bb0: 6767 6564 5f64 6174 6173 6574 280a 2020  gged_dataset(.  
-00007bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007bd0: 2020 2020 2020 2020 2020 6265 6861 7669            behavi
-00007be0: 6f72 5f70 6f6c 6963 795f 6e61 6d65 3d62  or_policy_name=b
-00007bf0: 6568 6176 696f 725f 706f 6c69 6379 5f6e  ehavior_policy_n
-00007c00: 616d 652c 0a20 2020 2020 2020 2020 2020  ame,.           
-00007c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007c20: 2064 6174 6173 6574 5f69 643d 6461 7461   dataset_id=data
-00007c30: 7365 745f 6964 5f2c 0a20 2020 2020 2020  set_id_,.       
-00007c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007c50: 2029 0a20 2020 2020 2020 2020 2020 2020   ).             
-00007c60: 2020 2020 2020 2020 2020 2069 6e70 7574             input
-00007c70: 5f64 6963 745f 203d 2069 6e70 7574 5f64  _dict_ = input_d
-00007c80: 6963 742e 6765 7428 0a20 2020 2020 2020  ict.get(.       
-00007c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007ca0: 2020 2020 2062 6568 6176 696f 725f 706f       behavior_po
-00007cb0: 6c69 6379 5f6e 616d 653d 6265 6861 7669  licy_name=behavi
-00007cc0: 6f72 5f70 6f6c 6963 795f 6e61 6d65 2c0a  or_policy_name,.
-00007cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007ce0: 2020 2020 2020 2020 2020 2020 6461 7461              data
-00007cf0: 7365 745f 6964 3d64 6174 6173 6574 5f69  set_id=dataset_i
-00007d00: 645f 2c0a 2020 2020 2020 2020 2020 2020  d_,.            
-00007d10: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-00007d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007d30: 2020 2020 2020 2070 6f6c 6963 795f 7661         policy_va
-00007d40: 6c75 655f 6469 6374 5f20 3d20 7365 6c66  lue_dict_ = self
-00007d50: 2e5f 6573 7469 6d61 7465 5f70 6f6c 6963  ._estimate_polic
-00007d60: 795f 7661 6c75 6528 0a20 2020 2020 2020  y_value(.       
+00007830: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00007840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007850: 2070 6f6c 6963 795f 7661 6c75 655f 6469   policy_value_di
+00007860: 6374 5b62 6568 6176 696f 725f 706f 6c69  ct[behavior_poli
+00007870: 6379 5d20 3d20 706f 6c69 6379 5f76 616c  cy] = policy_val
+00007880: 7565 5f64 6963 745f 0a0a 2020 2020 2020  ue_dict_..      
+00007890: 2020 2020 2020 2020 2020 656c 6966 2062            elif b
+000078a0: 6568 6176 696f 725f 706f 6c69 6379 5f6e  ehavior_policy_n
+000078b0: 616d 6520 6973 206e 6f74 204e 6f6e 6520  ame is not None 
+000078c0: 616e 6420 6461 7461 7365 745f 6964 2069  and dataset_id i
+000078d0: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
+000078e0: 2020 2020 2020 2020 2020 2020 6966 2028              if (
+000078f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00007900: 2020 2020 2020 2020 2073 656c 662e 6d75           self.mu
+00007910: 6c74 6970 6c65 5f6c 6f67 6765 645f 6461  ltiple_logged_da
+00007920: 7461 7365 742e 6e5f 6461 7461 7365 7473  taset.n_datasets
+00007930: 5b62 6568 6176 696f 725f 706f 6c69 6379  [behavior_policy
+00007940: 5f6e 616d 655d 0a20 2020 2020 2020 2020  _name].         
+00007950: 2020 2020 2020 2020 2020 2020 2020 2021                 !
+00007960: 3d20 696e 7075 745f 6469 6374 2e6e 5f64  = input_dict.n_d
+00007970: 6174 6173 6574 735b 6265 6861 7669 6f72  atasets[behavior
+00007980: 5f70 6f6c 6963 795f 6e61 6d65 5d0a 2020  _policy_name].  
+00007990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000079a0: 2020 293a 0a20 2020 2020 2020 2020 2020    ):.           
+000079b0: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+000079c0: 7365 2056 616c 7565 4572 726f 7228 0a20  se ValueError(. 
+000079d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000079e0: 2020 2020 2020 2020 2020 2022 4578 7065             "Expe
+000079f0: 6374 6564 2074 6861 7420 6c6f 6767 6564  cted that logged
+00007a00: 2064 6174 6173 6574 7320 616e 6420 696e   datasets and in
+00007a10: 7075 7420 6469 6374 7320 636f 6e73 6973  put dicts consis
+00007a20: 7473 206f 6620 7468 6520 7361 6d65 2064  ts of the same d
+00007a30: 6174 6173 6574 2069 6473 2c20 6275 7420  ataset ids, but 
+00007a40: 666f 756e 6420 4661 6c73 652e 220a 2020  found False.".  
+00007a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007a60: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+00007a70: 2020 2020 2020 2020 2020 2020 2070 6f6c               pol
+00007a80: 6963 795f 7661 6c75 655f 6469 6374 203d  icy_value_dict =
+00007a90: 205b 5d0a 2020 2020 2020 2020 2020 2020   [].            
+00007aa0: 2020 2020 2020 2020 666f 7220 6461 7461          for data
+00007ab0: 7365 745f 6964 5f20 696e 2072 616e 6765  set_id_ in range
+00007ac0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00007ad0: 2020 2020 2020 2020 2020 696e 7075 745f            input_
+00007ae0: 6469 6374 2e6e 5f64 6174 6173 6574 735b  dict.n_datasets[
+00007af0: 6265 6861 7669 6f72 5f70 6f6c 6963 795f  behavior_policy_
+00007b00: 6e61 6d65 5d0a 2020 2020 2020 2020 2020  name].          
+00007b10: 2020 2020 2020 2020 2020 293a 0a20 2020            ):.   
+00007b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007b30: 2020 2020 2073 656c 662e 5f72 6567 6973       self._regis
+00007b40: 7465 725f 6c6f 6767 6564 5f64 6174 6173  ter_logged_datas
+00007b50: 6574 280a 2020 2020 2020 2020 2020 2020  et(.            
+00007b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007b70: 6265 6861 7669 6f72 5f70 6f6c 6963 795f  behavior_policy_
+00007b80: 6e61 6d65 3d62 6568 6176 696f 725f 706f  name=behavior_po
+00007b90: 6c69 6379 5f6e 616d 652c 0a20 2020 2020  licy_name,.     
+00007ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007bb0: 2020 2020 2020 2064 6174 6173 6574 5f69         dataset_i
+00007bc0: 643d 6461 7461 7365 745f 6964 5f2c 0a20  d=dataset_id_,. 
+00007bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007be0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00007bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007c00: 2069 6e70 7574 5f64 6963 745f 203d 2069   input_dict_ = i
+00007c10: 6e70 7574 5f64 6963 742e 6765 7428 0a20  nput_dict.get(. 
+00007c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007c30: 2020 2020 2020 2020 2020 2062 6568 6176             behav
+00007c40: 696f 725f 706f 6c69 6379 5f6e 616d 653d  ior_policy_name=
+00007c50: 6265 6861 7669 6f72 5f70 6f6c 6963 795f  behavior_policy_
+00007c60: 6e61 6d65 2c0a 2020 2020 2020 2020 2020  name,.          
+00007c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007c80: 2020 6461 7461 7365 745f 6964 3d64 6174    dataset_id=dat
+00007c90: 6173 6574 5f69 645f 2c0a 2020 2020 2020  aset_id_,.      
+00007ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007cb0: 2020 290a 0a20 2020 2020 2020 2020 2020    )..           
+00007cc0: 2020 2020 2020 2020 2020 2020 2070 6f6c               pol
+00007cd0: 6963 795f 7661 6c75 655f 6469 6374 5f20  icy_value_dict_ 
+00007ce0: 3d20 7365 6c66 2e5f 6573 7469 6d61 7465  = self._estimate
+00007cf0: 5f70 6f6c 6963 795f 7661 6c75 6528 0a20  _policy_value(. 
+00007d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007d10: 2020 2020 2020 2020 2020 2069 6e70 7574             input
+00007d20: 5f64 6963 745f 2c0a 2020 2020 2020 2020  _dict_,.        
+00007d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007d40: 2020 2020 636f 6d70 6172 6564 5f65 7374      compared_est
+00007d50: 696d 6174 6f72 733d 636f 6d70 6172 6564  imators=compared
+00007d60: 5f65 7374 696d 6174 6f72 732c 0a20 2020  _estimators,.   
 00007d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007d80: 2020 2020 2069 6e70 7574 5f64 6963 745f       input_dict_
-00007d90: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00007da0: 2020 2020 2020 2020 2020 2020 2020 636f                co
-00007db0: 6d70 6172 6564 5f65 7374 696d 6174 6f72  mpared_estimator
-00007dc0: 733d 636f 6d70 6172 6564 5f65 7374 696d  s=compared_estim
-00007dd0: 6174 6f72 732c 0a20 2020 2020 2020 2020  ators,.         
-00007de0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-00007df0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00007e00: 2020 2020 2020 2020 2070 6f6c 6963 795f           policy_
-00007e10: 7661 6c75 655f 6469 6374 2e61 7070 656e  value_dict.appen
-00007e20: 6428 706f 6c69 6379 5f76 616c 7565 5f64  d(policy_value_d
-00007e30: 6963 745f 290a 0a20 2020 2020 2020 2020  ict_)..         
-00007e40: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00007e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007e60: 2073 656c 662e 5f72 6567 6973 7465 725f   self._register_
-00007e70: 6c6f 6767 6564 5f64 6174 6173 6574 280a  logged_dataset(.
-00007e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007e90: 2020 2020 2020 2020 6265 6861 7669 6f72          behavior
-00007ea0: 5f70 6f6c 6963 795f 6e61 6d65 3d62 6568  _policy_name=beh
-00007eb0: 6176 696f 725f 706f 6c69 6379 5f6e 616d  avior_policy_nam
-00007ec0: 652c 2064 6174 6173 6574 5f69 643d 6461  e, dataset_id=da
-00007ed0: 7461 7365 745f 6964 0a20 2020 2020 2020  taset_id.       
-00007ee0: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
-00007ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007f00: 2020 2069 6e70 7574 5f64 6963 745f 203d     input_dict_ =
-00007f10: 2069 6e70 7574 5f64 6963 742e 6765 7428   input_dict.get(
-00007f20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00007f30: 2020 2020 2020 2020 2062 6568 6176 696f           behavio
-00007f40: 725f 706f 6c69 6379 5f6e 616d 653d 6265  r_policy_name=be
-00007f50: 6861 7669 6f72 5f70 6f6c 6963 795f 6e61  havior_policy_na
-00007f60: 6d65 2c20 6461 7461 7365 745f 6964 3d64  me, dataset_id=d
-00007f70: 6174 6173 6574 5f69 640a 2020 2020 2020  ataset_id.      
-00007f80: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+00007d80: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+00007d90: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00007da0: 6f6c 6963 795f 7661 6c75 655f 6469 6374  olicy_value_dict
+00007db0: 2e61 7070 656e 6428 706f 6c69 6379 5f76  .append(policy_v
+00007dc0: 616c 7565 5f64 6963 745f 290a 0a20 2020  alue_dict_)..   
+00007dd0: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+00007de0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00007df0: 2020 2020 2020 2073 656c 662e 5f72 6567         self._reg
+00007e00: 6973 7465 725f 6c6f 6767 6564 5f64 6174  ister_logged_dat
+00007e10: 6173 6574 280a 2020 2020 2020 2020 2020  aset(.          
+00007e20: 2020 2020 2020 2020 2020 2020 2020 6265                be
+00007e30: 6861 7669 6f72 5f70 6f6c 6963 795f 6e61  havior_policy_na
+00007e40: 6d65 3d62 6568 6176 696f 725f 706f 6c69  me=behavior_poli
+00007e50: 6379 5f6e 616d 652c 2064 6174 6173 6574  cy_name, dataset
+00007e60: 5f69 643d 6461 7461 7365 745f 6964 0a20  _id=dataset_id. 
+00007e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007e80: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+00007e90: 2020 2020 2020 2020 2069 6e70 7574 5f64           input_d
+00007ea0: 6963 745f 203d 2069 6e70 7574 5f64 6963  ict_ = input_dic
+00007eb0: 742e 6765 7428 0a20 2020 2020 2020 2020  t.get(.         
+00007ec0: 2020 2020 2020 2020 2020 2020 2020 2062                 b
+00007ed0: 6568 6176 696f 725f 706f 6c69 6379 5f6e  ehavior_policy_n
+00007ee0: 616d 653d 6265 6861 7669 6f72 5f70 6f6c  ame=behavior_pol
+00007ef0: 6963 795f 6e61 6d65 2c20 6461 7461 7365  icy_name, datase
+00007f00: 745f 6964 3d64 6174 6173 6574 5f69 640a  t_id=dataset_id.
+00007f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007f20: 2020 2020 290a 0a20 2020 2020 2020 2020      )..         
+00007f30: 2020 2020 2020 2020 2020 2070 6f6c 6963             polic
+00007f40: 795f 7661 6c75 655f 6469 6374 203d 2073  y_value_dict = s
+00007f50: 656c 662e 5f65 7374 696d 6174 655f 706f  elf._estimate_po
+00007f60: 6c69 6379 5f76 616c 7565 280a 2020 2020  licy_value(.    
+00007f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007f80: 2020 2020 696e 7075 745f 6469 6374 5f2c      input_dict_,
 00007f90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00007fa0: 2020 2020 2070 6f6c 6963 795f 7661 6c75       policy_valu
-00007fb0: 655f 6469 6374 203d 2073 656c 662e 5f65  e_dict = self._e
-00007fc0: 7374 696d 6174 655f 706f 6c69 6379 5f76  stimate_policy_v
-00007fd0: 616c 7565 280a 2020 2020 2020 2020 2020  alue(.          
-00007fe0: 2020 2020 2020 2020 2020 2020 2020 696e                in
-00007ff0: 7075 745f 6469 6374 5f2c 0a20 2020 2020  put_dict_,.     
-00008000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008010: 2020 2063 6f6d 7061 7265 645f 6573 7469     compared_esti
-00008020: 6d61 746f 7273 3d63 6f6d 7061 7265 645f  mators=compared_
-00008030: 6573 7469 6d61 746f 7273 2c0a 2020 2020  estimators,.    
-00008040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008050: 290a 0a20 2020 2020 2020 2020 2020 2065  )..            e
-00008060: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00008070: 2020 2020 2062 6568 6176 696f 725f 706f       behavior_po
-00008080: 6c69 6379 5f6e 616d 6520 3d20 6c69 7374  licy_name = list
-00008090: 2869 6e70 7574 5f64 6963 742e 7661 6c75  (input_dict.valu
-000080a0: 6573 2829 295b 305d 5b22 6265 6861 7669  es())[0]["behavi
-000080b0: 6f72 5f70 6f6c 6963 7922 5d0a 2020 2020  or_policy"].    
-000080c0: 2020 2020 2020 2020 2020 2020 6461 7461              data
-000080d0: 7365 745f 6964 203d 206c 6973 7428 696e  set_id = list(in
-000080e0: 7075 745f 6469 6374 2e76 616c 7565 7328  put_dict.values(
-000080f0: 2929 5b30 5d5b 2264 6174 6173 6574 5f69  ))[0]["dataset_i
-00008100: 6422 5d0a 0a20 2020 2020 2020 2020 2020  d"]..           
-00008110: 2020 2020 2073 656c 662e 5f72 6567 6973       self._regis
-00008120: 7465 725f 6c6f 6767 6564 5f64 6174 6173  ter_logged_datas
-00008130: 6574 280a 2020 2020 2020 2020 2020 2020  et(.            
-00008140: 2020 2020 2020 2020 6265 6861 7669 6f72          behavior
-00008150: 5f70 6f6c 6963 795f 6e61 6d65 3d62 6568  _policy_name=beh
-00008160: 6176 696f 725f 706f 6c69 6379 5f6e 616d  avior_policy_nam
-00008170: 652c 2064 6174 6173 6574 5f69 643d 6461  e, dataset_id=da
-00008180: 7461 7365 745f 6964 0a20 2020 2020 2020  taset_id.       
-00008190: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-000081a0: 2020 2020 2020 2020 2020 2020 706f 6c69              poli
-000081b0: 6379 5f76 616c 7565 5f64 6963 7420 3d20  cy_value_dict = 
-000081c0: 7365 6c66 2e5f 6573 7469 6d61 7465 5f70  self._estimate_p
-000081d0: 6f6c 6963 795f 7661 6c75 6528 0a20 2020  olicy_value(.   
-000081e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000081f0: 2069 6e70 7574 5f64 6963 742c 0a20 2020   input_dict,.   
-00008200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008210: 2063 6f6d 7061 7265 645f 6573 7469 6d61   compared_estima
-00008220: 746f 7273 3d63 6f6d 7061 7265 645f 6573  tors=compared_es
-00008230: 7469 6d61 746f 7273 2c0a 2020 2020 2020  timators,.      
-00008240: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
-00008250: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00008260: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-00008270: 616e 6365 2869 6e70 7574 5f64 6963 742c  ance(input_dict,
-00008280: 204d 756c 7469 706c 6549 6e70 7574 4469   MultipleInputDi
-00008290: 6374 293a 0a20 2020 2020 2020 2020 2020  ct):.           
-000082a0: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-000082b0: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
-000082c0: 2020 2020 2020 2020 2020 2022 7768 656e             "when
-000082d0: 2075 7369 6e67 204c 6f67 6765 6444 6174   using LoggedDat
-000082e0: 6173 6574 2c20 706c 6561 7365 2075 7365  aset, please use
-000082f0: 2049 6e70 7574 4469 6374 2069 6e73 7465   InputDict inste
-00008300: 6164 206f 6620 4d75 6c74 6970 6c65 496e  ad of MultipleIn
-00008310: 7075 7444 6963 7422 0a20 2020 2020 2020  putDict".       
-00008320: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-00008330: 2020 2020 2020 2020 706f 6c69 6379 5f76          policy_v
-00008340: 616c 7565 5f64 6963 7420 3d20 7365 6c66  alue_dict = self
-00008350: 2e5f 6573 7469 6d61 7465 5f70 6f6c 6963  ._estimate_polic
-00008360: 795f 7661 6c75 6528 0a20 2020 2020 2020  y_value(.       
-00008370: 2020 2020 2020 2020 2069 6e70 7574 5f64           input_d
-00008380: 6963 742c 0a20 2020 2020 2020 2020 2020  ict,.           
-00008390: 2020 2020 2063 6f6d 7061 7265 645f 6573       compared_es
-000083a0: 7469 6d61 746f 7273 3d63 6f6d 7061 7265  timators=compare
-000083b0: 645f 6573 7469 6d61 746f 7273 2c0a 2020  d_estimators,.  
-000083c0: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
-000083d0: 2020 2020 2072 6574 7572 6e20 706f 6c69       return poli
-000083e0: 6379 5f76 616c 7565 5f64 6963 740a 0a20  cy_value_dict.. 
-000083f0: 2020 2064 6566 2065 7374 696d 6174 655f     def estimate_
-00008400: 696e 7465 7276 616c 7328 0a20 2020 2020  intervals(.     
-00008410: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-00008420: 2069 6e70 7574 5f64 6963 743a 2055 6e69   input_dict: Uni
-00008430: 6f6e 5b4f 5045 496e 7075 7444 6963 742c  on[OPEInputDict,
-00008440: 204d 756c 7469 706c 6549 6e70 7574 4469   MultipleInputDi
-00008450: 6374 5d2c 0a20 2020 2020 2020 2063 6f6d  ct],.        com
-00008460: 7061 7265 645f 6573 7469 6d61 746f 7273  pared_estimators
-00008470: 3a20 4f70 7469 6f6e 616c 5b4c 6973 745b  : Optional[List[
-00008480: 7374 725d 5d20 3d20 4e6f 6e65 2c0a 2020  str]] = None,.  
-00008490: 2020 2020 2020 6265 6861 7669 6f72 5f70        behavior_p
-000084a0: 6f6c 6963 795f 6e61 6d65 3a20 4f70 7469  olicy_name: Opti
-000084b0: 6f6e 616c 5b73 7472 5d20 3d20 4e6f 6e65  onal[str] = None
-000084c0: 2c0a 2020 2020 2020 2020 6461 7461 7365  ,.        datase
-000084d0: 745f 6964 3a20 4f70 7469 6f6e 616c 5b69  t_id: Optional[i
-000084e0: 6e74 5d20 3d20 4e6f 6e65 2c0a 2020 2020  nt] = None,.    
-000084f0: 2020 2020 616c 7068 613a 2066 6c6f 6174      alpha: float
-00008500: 203d 2030 2e30 352c 0a20 2020 2020 2020   = 0.05,.       
-00008510: 2063 693a 2073 7472 203d 2022 626f 6f74   ci: str = "boot
-00008520: 7374 7261 7022 2c0a 2020 2020 2020 2020  strap",.        
-00008530: 6e5f 626f 6f74 7374 7261 705f 7361 6d70  n_bootstrap_samp
-00008540: 6c65 733a 2069 6e74 203d 2031 3030 2c0a  les: int = 100,.
-00008550: 2020 2020 2020 2020 7261 6e64 6f6d 5f73          random_s
-00008560: 7461 7465 3a20 4f70 7469 6f6e 616c 5b69  tate: Optional[i
-00008570: 6e74 5d20 3d20 4e6f 6e65 2c0a 2020 2020  nt] = None,.    
-00008580: 2920 2d3e 2044 6963 745b 7374 722c 2044  ) -> Dict[str, D
-00008590: 6963 745b 7374 722c 2066 6c6f 6174 5d5d  ict[str, float]]
-000085a0: 3a0a 2020 2020 2020 2020 2222 2245 7374  :.        """Est
-000085b0: 696d 6174 6520 7468 6520 636f 6e66 6964  imate the confid
-000085c0: 656e 6365 2069 6e74 6572 7661 6c73 206f  ence intervals o
-000085d0: 6620 7468 6520 706f 6c69 6379 2076 616c  f the policy val
-000085e0: 7565 2062 7920 6e6f 6e70 6172 616d 6574  ue by nonparamet
-000085f0: 7269 6320 626f 6f74 7374 7261 702e 0a0a  ric bootstrap...
-00008600: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
-00008610: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
-00008620: 2d2d 0a20 2020 2020 2020 2069 6e70 7574  --.        input
-00008630: 5f64 6963 743a 204f 5045 496e 7075 7444  _dict: OPEInputD
-00008640: 6963 7420 6f72 204d 756c 7469 706c 6549  ict or MultipleI
-00008650: 6e70 7574 4469 6374 0a20 2020 2020 2020  nputDict.       
-00008660: 2020 2020 2044 6963 7469 6f6e 6172 7920       Dictionary 
-00008670: 6f66 2074 6865 204f 5045 2069 6e70 7574  of the OPE input
-00008680: 7320 666f 7220 6561 6368 2065 7661 6c75  s for each evalu
-00008690: 6174 696f 6e20 706f 6c69 6379 2e0a 0a20  ation policy... 
-000086a0: 2020 2020 2020 2020 2020 202e 2e20 636f             .. co
-000086b0: 6465 2d62 6c6f 636b 3a3a 2070 7974 686f  de-block:: pytho
-000086c0: 6e0a 0a20 2020 2020 2020 2020 2020 2020  n..             
-000086d0: 2020 206b 6579 3a20 5b65 7661 6c75 6174     key: [evaluat
-000086e0: 696f 6e5f 706f 6c69 6379 5d5b 0a20 2020  ion_policy][.   
-000086f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008700: 2065 7661 6c75 6174 696f 6e5f 706f 6c69   evaluation_poli
-00008710: 6379 5f61 6374 696f 6e2c 0a20 2020 2020  cy_action,.     
-00008720: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00008730: 7661 6c75 6174 696f 6e5f 706f 6c69 6379  valuation_policy
-00008740: 5f61 6374 696f 6e5f 6469 7374 2c0a 2020  _action_dist,.  
-00008750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008760: 2020 7374 6174 655f 6163 7469 6f6e 5f76    state_action_v
-00008770: 616c 7565 5f70 7265 6469 6374 696f 6e2c  alue_prediction,
-00008780: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00008790: 2020 2020 2069 6e69 7469 616c 5f73 7461       initial_sta
-000087a0: 7465 5f76 616c 7565 5f70 7265 6469 6374  te_value_predict
-000087b0: 696f 6e2c 0a20 2020 2020 2020 2020 2020  ion,.           
-000087c0: 2020 2020 2020 2020 2073 7461 7465 5f61           state_a
-000087d0: 6374 696f 6e5f 6d61 7267 696e 616c 5f69  ction_marginal_i
-000087e0: 6d70 6f72 7461 6e63 655f 7765 6967 6874  mportance_weight
-000087f0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00008800: 2020 2020 2020 7374 6174 655f 6d61 7267        state_marg
-00008810: 696e 616c 5f69 6d70 6f72 7461 6e63 655f  inal_importance_
-00008820: 7765 6967 6874 2c0a 2020 2020 2020 2020  weight,.        
-00008830: 2020 2020 2020 2020 2020 2020 6f6e 5f70              on_p
-00008840: 6f6c 6963 795f 706f 6c69 6379 5f76 616c  olicy_policy_val
-00008850: 7565 2c0a 2020 2020 2020 2020 2020 2020  ue,.            
-00008860: 2020 2020 2020 2020 6761 6d6d 612c 0a20          gamma,. 
-00008870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008880: 2020 2062 6568 6176 696f 725f 706f 6c69     behavior_poli
-00008890: 6379 2c0a 2020 2020 2020 2020 2020 2020  cy,.            
-000088a0: 2020 2020 2020 2020 6576 616c 7561 7469          evaluati
-000088b0: 6f6e 5f70 6f6c 6963 792c 0a20 2020 2020  on_policy,.     
-000088c0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-000088d0: 6174 6173 6574 5f69 642c 0a20 2020 2020  ataset_id,.     
-000088e0: 2020 2020 2020 2020 2020 205d 0a0a 2020             ]..  
-000088f0: 2020 2020 2020 2020 2020 2e2e 2073 6565            .. see
-00008900: 616c 736f 3a3a 0a0a 2020 2020 2020 2020  also::..        
-00008910: 2020 2020 2020 2020 3a63 6c61 7373 3a60          :class:`
-00008920: 7363 6f70 655f 726c 2e6f 7065 2e69 6e70  scope_rl.ope.inp
-00008930: 7574 2e43 7265 6174 654f 5045 496e 7075  ut.CreateOPEInpu
-00008940: 7460 2064 6573 6372 6962 6573 2074 6865  t` describes the
-00008950: 2063 6f6d 706f 6e65 6e74 7320 6f66 203a   components of :
-00008960: 636c 6173 733a 6069 6e70 7574 5f64 6963  class:`input_dic
-00008970: 7460 2e0a 0a20 2020 2020 2020 2063 6f6d  t`...        com
-00008980: 7061 7265 645f 6573 7469 6d61 746f 7273  pared_estimators
-00008990: 3a20 6c69 7374 206f 6620 7374 722c 2064  : list of str, d
-000089a0: 6566 6175 6c74 3d4e 6f6e 650a 2020 2020  efault=None.    
-000089b0: 2020 2020 2020 2020 4e61 6d65 206f 6620          Name of 
-000089c0: 636f 6d70 6172 6564 2065 7374 696d 6174  compared estimat
-000089d0: 6f72 732e 0a20 2020 2020 2020 2020 2020  ors..           
-000089e0: 2049 6620 604e 6f6e 6560 2069 7320 6769   If `None` is gi
-000089f0: 7665 6e2c 2061 6c6c 2074 6865 2065 7374  ven, all the est
-00008a00: 696d 6174 6f72 7320 6172 6520 636f 6d70  imators are comp
-00008a10: 6172 6564 2e0a 0a20 2020 2020 2020 2062  ared...        b
-00008a20: 6568 6176 696f 725f 706f 6c69 6379 5f6e  ehavior_policy_n
-00008a30: 616d 653a 2073 7472 2c20 6465 6661 756c  ame: str, defaul
-00008a40: 743d 4e6f 6e65 0a20 2020 2020 2020 2020  t=None.         
-00008a50: 2020 204e 616d 6520 6f66 2074 6865 2062     Name of the b
-00008a60: 6568 6176 696f 7220 706f 6c69 6379 2e0a  ehavior policy..
-00008a70: 0a20 2020 2020 2020 2064 6174 6173 6574  .        dataset
-00008a80: 5f69 643a 2069 6e74 2c20 6465 6661 756c  _id: int, defaul
-00008a90: 743d 4e6f 6e65 0a20 2020 2020 2020 2020  t=None.         
-00008aa0: 2020 2049 6420 6f66 2074 6865 206c 6f67     Id of the log
-00008ab0: 6765 6420 6461 7461 7365 742e 0a0a 2020  ged dataset...  
-00008ac0: 2020 2020 2020 616c 7068 613a 2066 6c6f        alpha: flo
-00008ad0: 6174 2c20 6465 6661 756c 743d 302e 3035  at, default=0.05
-00008ae0: 0a20 2020 2020 2020 2020 2020 2053 6967  .            Sig
-00008af0: 6e69 6669 6361 6e63 6520 6c65 7665 6c2e  nificance level.
-00008b00: 2054 6865 2076 616c 7565 2073 686f 756c   The value shoul
-00008b10: 6420 6265 2077 6974 6869 6e20 605b 302c  d be within `[0,
-00008b20: 2031 2960 2e0a 0a20 2020 2020 2020 2063   1)`...        c
-00008b30: 693a 207b 2262 6f6f 7473 7472 6170 222c  i: {"bootstrap",
-00008b40: 2022 686f 6566 6664 696e 6722 2c20 2262   "hoeffding", "b
-00008b50: 6572 6e73 7465 696e 222c 2022 7474 6573  ernstein", "ttes
-00008b60: 7422 7d2c 2064 6566 6175 6c74 3d22 626f  t"}, default="bo
-00008b70: 6f74 7374 7261 7022 0a20 2020 2020 2020  otstrap".       
-00008b80: 2020 2020 204d 6574 686f 6420 746f 2065       Method to e
-00008b90: 7374 696d 6174 6520 7468 6520 636f 6e66  stimate the conf
-00008ba0: 6964 656e 6365 2069 6e74 6572 7661 6c2e  idence interval.
-00008bb0: 0a0a 2020 2020 2020 2020 6e5f 626f 6f74  ..        n_boot
-00008bc0: 7374 7261 705f 7361 6d70 6c65 733a 2069  strap_samples: i
-00008bd0: 6e74 2c20 6465 6661 756c 743d 3130 3020  nt, default=100 
-00008be0: 283e 2030 290a 2020 2020 2020 2020 2020  (> 0).          
-00008bf0: 2020 4e75 6d62 6572 206f 6620 7265 7361    Number of resa
-00008c00: 6d70 6c69 6e67 2070 6572 666f 726d 6564  mpling performed
-00008c10: 2069 6e20 7468 6520 626f 6f74 7374 7261   in the bootstra
-00008c20: 7020 7072 6f63 6564 7572 652e 0a0a 2020  p procedure...  
-00008c30: 2020 2020 2020 7261 6e64 6f6d 5f73 7461        random_sta
-00008c40: 7465 3a20 696e 742c 2064 6566 6175 6c74  te: int, default
-00008c50: 3d4e 6f6e 6520 283e 3d20 3029 0a20 2020  =None (>= 0).   
-00008c60: 2020 2020 2020 2020 2052 616e 646f 6d20           Random 
-00008c70: 7374 6174 652e 0a0a 2020 2020 2020 2020  state...        
-00008c80: 5265 7475 726e 0a20 2020 2020 2020 202d  Return.        -
-00008c90: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2070  ------.        p
-00008ca0: 6f6c 6963 795f 7661 6c75 655f 696e 7465  olicy_value_inte
-00008cb0: 7276 616c 5f64 6963 743a 2064 6963 740a  rval_dict: dict.
-00008cc0: 2020 2020 2020 2020 2020 2020 4469 6374              Dict
-00008cd0: 696f 6e61 7279 2063 6f6e 7461 696e 696e  ionary containin
-00008ce0: 6720 7468 6520 636f 6e66 6964 656e 6365  g the confidence
-00008cf0: 2069 6e74 6572 7661 6c73 2065 7374 696d   intervals estim
-00008d00: 6174 6564 2062 7920 6e6f 6e70 6172 616d  ated by nonparam
-00008d10: 6574 7269 6320 626f 6f74 7374 7261 702e  etric bootstrap.
-00008d20: 0a20 2020 2020 2020 2020 2020 206b 6579  .            key
-00008d30: 3a20 3a63 6c61 7373 3a60 5b65 7661 6c75  : :class:`[evalu
-00008d40: 6174 696f 6e5f 706f 6c69 6379 5d5b 4f50  ation_policy][OP
-00008d50: 455f 6573 7469 6d61 746f 725f 6e61 6d65  E_estimator_name
-00008d60: 5d60 0a0a 2020 2020 2020 2020 2020 2020  ]`..            
-00008d70: 5768 656e 2062 6568 6176 696f 725f 706f  When behavior_po
-00008d80: 6c69 6379 5f6e 616d 6520 6973 2060 4e6f  licy_name is `No
-00008d90: 6e65 6020 616e 6420 6461 7461 7365 745f  ne` and dataset_
-00008da0: 6964 2069 7320 604e 6f6e 6560 2c0a 2020  id is `None`,.  
-00008db0: 2020 2020 2020 2020 2020 6b65 793a 203a            key: :
-00008dc0: 636c 6173 733a 605b 6265 6861 7669 6f72  class:`[behavior
-00008dd0: 5f70 6f6c 6963 795f 6e61 6d65 5d5b 6461  _policy_name][da
-00008de0: 7461 7365 745f 6964 5d5b 6576 616c 7561  taset_id][evalua
-00008df0: 7469 6f6e 5f70 6f6c 6963 795d 5b4f 5045  tion_policy][OPE
-00008e00: 5f65 7374 696d 6174 6f72 5f6e 616d 655d  _estimator_name]
-00008e10: 600a 0a20 2020 2020 2020 2020 2020 2057  `..            W
-00008e20: 6865 6e20 6265 6861 7669 6f72 5f70 6f6c  hen behavior_pol
-00008e30: 6963 795f 6e61 6d65 2069 7320 604e 6f6e  icy_name is `Non
-00008e40: 6560 2061 6e64 2064 6174 6173 6574 5f69  e` and dataset_i
-00008e50: 6420 6973 2073 7065 6369 6669 6564 2c0a  d is specified,.
-00008e60: 2020 2020 2020 2020 2020 2020 6b65 793a              key:
-00008e70: 203a 636c 6173 733a 605b 6265 6861 7669   :class:`[behavi
-00008e80: 6f72 5f70 6f6c 6963 795f 6e61 6d65 5d5b  or_policy_name][
-00008e90: 6576 616c 7561 7469 6f6e 5f70 6f6c 6963  evaluation_polic
-00008ea0: 795d 5b4f 5045 5f65 7374 696d 6174 6f72  y][OPE_estimator
-00008eb0: 5f6e 616d 655d 600a 0a20 2020 2020 2020  _name]`..       
-00008ec0: 2020 2020 2057 6865 6e20 6265 6861 7669       When behavi
-00008ed0: 6f72 5f70 6f6c 6963 795f 6e61 6d65 2069  or_policy_name i
-00008ee0: 7320 7370 6563 6966 6965 6420 616e 6420  s specified and 
-00008ef0: 6461 7461 7365 745f 6964 2069 7320 604e  dataset_id is `N
-00008f00: 6f6e 6560 2c0a 2020 2020 2020 2020 2020  one`,.          
-00008f10: 2020 6b65 793a 203a 636c 6173 733a 605b    key: :class:`[
-00008f20: 6461 7461 7365 745f 6964 5d5b 4f50 455f  dataset_id][OPE_
-00008f30: 6573 7469 6d61 746f 725f 6e61 6d65 5d60  estimator_name]`
-00008f40: 0a0a 2020 2020 2020 2020 5265 6665 7265  ..        Refere
-00008f50: 6e63 6573 0a20 2020 2020 2020 202d 2d2d  nces.        ---
-00008f60: 2d2d 2d2d 0a20 2020 2020 2020 204a 6f73  ----.        Jos
-00008f70: 6961 6820 502e 2048 616e 6e61 2c20 5065  iah P. Hanna, Pe
-00008f80: 7465 7220 5374 6f6e 652c 2061 6e64 2053  ter Stone, and S
-00008f90: 636f 7474 204e 6965 6b75 6d2e 0a20 2020  cott Niekum..   
-00008fa0: 2020 2020 2022 426f 6f74 7374 7261 7070       "Bootstrapp
-00008fb0: 696e 6720 7769 7468 204d 6f64 656c 733a  ing with Models:
-00008fc0: 2043 6f6e 6669 6465 6e63 6520 496e 7465   Confidence Inte
-00008fd0: 7276 616c 7320 666f 7220 4f66 662d 506f  rvals for Off-Po
-00008fe0: 6c69 6379 2045 7661 6c75 6174 696f 6e2e  licy Evaluation.
-00008ff0: 2220 3230 3137 2e0a 0a20 2020 2020 2020  " 2017...       
-00009000: 2050 6869 6c69 7020 532e 2054 686f 6d61   Philip S. Thoma
-00009010: 732c 2047 656f 7267 696f 7320 5468 656f  s, Georgios Theo
-00009020: 6368 6172 6f75 732c 2061 6e64 204d 6f68  charous, and Moh
-00009030: 616d 6d61 6420 4768 6176 616d 7a61 6465  ammad Ghavamzade
-00009040: 682e 0a20 2020 2020 2020 2022 4869 6768  h..        "High
-00009050: 2043 6f6e 6669 6465 6e63 6520 506f 6c69   Confidence Poli
-00009060: 6379 2049 6d70 726f 7665 6d65 6e74 2e22  cy Improvement."
-00009070: 2032 3031 352e 0a0a 2020 2020 2020 2020   2015...        
-00009080: 5068 696c 6970 2053 2e20 5468 6f6d 6173  Philip S. Thomas
-00009090: 2c20 4765 6f72 6769 6f73 2054 6865 6f63  , Georgios Theoc
-000090a0: 6861 726f 7573 2c20 616e 6420 4d6f 6861  harous, and Moha
-000090b0: 6d6d 6164 2047 6861 7661 6d7a 6164 6568  mmad Ghavamzadeh
-000090c0: 2e0a 2020 2020 2020 2020 2248 6967 6820  ..        "High 
-000090d0: 436f 6e66 6964 656e 6365 204f 6666 2d50  Confidence Off-P
-000090e0: 6f6c 6963 7920 4576 616c 7561 7469 6f6e  olicy Evaluation
-000090f0: 2e22 2032 3031 352e 0a0a 2020 2020 2020  ." 2015...      
-00009100: 2020 2222 220a 2020 2020 2020 2020 636f    """.        co
-00009110: 6d70 6172 6564 5f65 7374 696d 6174 6f72  mpared_estimator
-00009120: 7320 3d20 7365 6c66 2e5f 6368 6563 6b5f  s = self._check_
-00009130: 636f 6d70 6172 6564 5f65 7374 696d 6174  compared_estimat
-00009140: 6f72 7328 636f 6d70 6172 6564 5f65 7374  ors(compared_est
-00009150: 696d 6174 6f72 7329 0a0a 2020 2020 2020  imators)..      
-00009160: 2020 6966 2063 6920 6e6f 7420 696e 2073    if ci not in s
-00009170: 656c 662e 5f65 7374 696d 6174 655f 636f  elf._estimate_co
-00009180: 6e66 6964 656e 6365 5f69 6e74 6572 7661  nfidence_interva
-00009190: 6c2e 6b65 7973 2829 3a0a 2020 2020 2020  l.keys():.      
-000091a0: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-000091b0: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
-000091c0: 2020 2020 2020 2020 6622 6369 206d 7573          f"ci mus
-000091d0: 7420 6265 206f 6e65 206f 6620 2762 6f6f  t be one of 'boo
-000091e0: 7473 7472 6170 272c 2027 686f 6566 6664  tstrap', 'hoeffd
-000091f0: 696e 6727 2c20 2762 6572 6e73 7465 696e  ing', 'bernstein
-00009200: 272c 206f 7220 2774 7465 7374 272c 2062  ', or 'ttest', b
-00009210: 7574 207b 6369 7d20 6973 2067 6976 656e  ut {ci} is given
-00009220: 220a 2020 2020 2020 2020 2020 2020 290a  ".            ).
-00009230: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
-00009240: 2e75 7365 5f6d 756c 7469 706c 655f 6c6f  .use_multiple_lo
-00009250: 6767 6564 5f64 6174 6173 6574 3a0a 2020  gged_dataset:.  
-00009260: 2020 2020 2020 2020 2020 6966 2069 7369            if isi
-00009270: 6e73 7461 6e63 6528 696e 7075 745f 6469  nstance(input_di
-00009280: 6374 2c20 4d75 6c74 6970 6c65 496e 7075  ct, MultipleInpu
-00009290: 7444 6963 7429 3a0a 2020 2020 2020 2020  tDict):.        
-000092a0: 2020 2020 2020 2020 6966 2062 6568 6176          if behav
-000092b0: 696f 725f 706f 6c69 6379 5f6e 616d 6520  ior_policy_name 
-000092c0: 6973 204e 6f6e 6520 616e 6420 6461 7461  is None and data
-000092d0: 7365 745f 6964 2069 7320 4e6f 6e65 3a0a  set_id is None:.
-000092e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000092f0: 2020 2020 6966 2073 656c 662e 6d75 6c74      if self.mult
-00009300: 6970 6c65 5f6c 6f67 6765 645f 6461 7461  iple_logged_data
-00009310: 7365 742e 6e5f 6461 7461 7365 7473 2021  set.n_datasets !
-00009320: 3d20 696e 7075 745f 6469 6374 2e6e 5f64  = input_dict.n_d
-00009330: 6174 6173 6574 733a 0a20 2020 2020 2020  atasets:.       
-00009340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009350: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-00009360: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
-00009370: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00009380: 4578 7065 6374 6564 2074 6861 7420 6c6f  Expected that lo
-00009390: 6767 6564 2064 6174 6173 6574 7320 616e  gged datasets an
-000093a0: 6420 696e 7075 7420 6469 6374 7320 636f  d input dicts co
-000093b0: 6e73 6973 7473 206f 6620 7468 6520 7361  nsists of the sa
-000093c0: 6d65 2062 6568 6176 696f 7220 706f 6c69  me behavior poli
-000093d0: 6369 6573 2061 6e64 2064 6174 6173 6574  cies and dataset
-000093e0: 2069 6473 2c20 6275 7420 666f 756e 6420   ids, but found 
-000093f0: 4661 6c73 652e 220a 2020 2020 2020 2020  False.".        
-00009400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009410: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
-00009420: 2020 2020 2020 2070 6f6c 6963 795f 7661         policy_va
-00009430: 6c75 655f 696e 7465 7276 616c 5f64 6963  lue_interval_dic
-00009440: 7420 3d20 6465 6661 756c 7464 6963 7428  t = defaultdict(
-00009450: 6c69 7374 290a 2020 2020 2020 2020 2020  list).          
-00009460: 2020 2020 2020 2020 2020 666f 7220 280a            for (.
-00009470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009480: 2020 2020 2020 2020 6265 6861 7669 6f72          behavior
-00009490: 5f70 6f6c 6963 792c 0a20 2020 2020 2020  _policy,.       
-000094a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000094b0: 206e 5f64 6174 6173 6574 732c 0a20 2020   n_datasets,.   
-000094c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000094d0: 2029 2069 6e20 696e 7075 745f 6469 6374   ) in input_dict
-000094e0: 2e6e 5f64 6174 6173 6574 732e 6974 656d  .n_datasets.item
-000094f0: 7328 293a 0a20 2020 2020 2020 2020 2020  s():.           
-00009500: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-00009510: 2064 6174 6173 6574 5f69 645f 2069 6e20   dataset_id_ in 
-00009520: 7261 6e67 6528 6e5f 6461 7461 7365 7473  range(n_datasets
-00009530: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-00009540: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00009550: 656c 662e 5f72 6567 6973 7465 725f 6c6f  elf._register_lo
-00009560: 6767 6564 5f64 6174 6173 6574 280a 2020  gged_dataset(.  
-00009570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009580: 2020 2020 2020 2020 2020 2020 2020 6265                be
-00009590: 6861 7669 6f72 5f70 6f6c 6963 795f 6e61  havior_policy_na
-000095a0: 6d65 3d62 6568 6176 696f 725f 706f 6c69  me=behavior_poli
-000095b0: 6379 2c0a 2020 2020 2020 2020 2020 2020  cy,.            
-000095c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000095d0: 2020 2020 6461 7461 7365 745f 6964 3d64      dataset_id=d
-000095e0: 6174 6173 6574 5f69 645f 2c0a 2020 2020  ataset_id_,.    
-000095f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009600: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00009610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009620: 2020 2020 2020 696e 7075 745f 6469 6374        input_dict
-00009630: 5f20 3d20 696e 7075 745f 6469 6374 2e67  _ = input_dict.g
-00009640: 6574 280a 2020 2020 2020 2020 2020 2020  et(.            
-00009650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009660: 2020 2020 6265 6861 7669 6f72 5f70 6f6c      behavior_pol
-00009670: 6963 795f 6e61 6d65 3d62 6568 6176 696f  icy_name=behavio
-00009680: 725f 706f 6c69 6379 2c0a 2020 2020 2020  r_policy,.      
-00009690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000096a0: 2020 2020 2020 2020 2020 6461 7461 7365            datase
-000096b0: 745f 6964 3d64 6174 6173 6574 5f69 645f  t_id=dataset_id_
-000096c0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000096d0: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-000096e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000096f0: 2020 2020 2020 2020 2020 2020 2070 6f6c               pol
-00009700: 6963 795f 7661 6c75 655f 696e 7465 7276  icy_value_interv
-00009710: 616c 5f64 6963 745f 203d 2073 656c 662e  al_dict_ = self.
-00009720: 5f65 7374 696d 6174 655f 696e 7465 7276  _estimate_interv
-00009730: 616c 7328 0a20 2020 2020 2020 2020 2020  als(.           
-00009740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009750: 2020 2020 2069 6e70 7574 5f64 6963 745f       input_dict_
-00009760: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00007fa0: 2020 2020 2020 2020 2063 6f6d 7061 7265           compare
+00007fb0: 645f 6573 7469 6d61 746f 7273 3d63 6f6d  d_estimators=com
+00007fc0: 7061 7265 645f 6573 7469 6d61 746f 7273  pared_estimators
+00007fd0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00007fe0: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+00007ff0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00008000: 2020 2020 2020 2020 2020 2062 6568 6176             behav
+00008010: 696f 725f 706f 6c69 6379 5f6e 616d 6520  ior_policy_name 
+00008020: 3d20 6c69 7374 2869 6e70 7574 5f64 6963  = list(input_dic
+00008030: 742e 7661 6c75 6573 2829 295b 305d 5b22  t.values())[0]["
+00008040: 6265 6861 7669 6f72 5f70 6f6c 6963 7922  behavior_policy"
+00008050: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+00008060: 2020 6461 7461 7365 745f 6964 203d 206c    dataset_id = l
+00008070: 6973 7428 696e 7075 745f 6469 6374 2e76  ist(input_dict.v
+00008080: 616c 7565 7328 2929 5b30 5d5b 2264 6174  alues())[0]["dat
+00008090: 6173 6574 5f69 6422 5d0a 0a20 2020 2020  aset_id"]..     
+000080a0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000080b0: 5f72 6567 6973 7465 725f 6c6f 6767 6564  _register_logged
+000080c0: 5f64 6174 6173 6574 280a 2020 2020 2020  _dataset(.      
+000080d0: 2020 2020 2020 2020 2020 2020 2020 6265                be
+000080e0: 6861 7669 6f72 5f70 6f6c 6963 795f 6e61  havior_policy_na
+000080f0: 6d65 3d62 6568 6176 696f 725f 706f 6c69  me=behavior_poli
+00008100: 6379 5f6e 616d 652c 2064 6174 6173 6574  cy_name, dataset
+00008110: 5f69 643d 6461 7461 7365 745f 6964 0a20  _id=dataset_id. 
+00008120: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+00008130: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00008140: 2020 706f 6c69 6379 5f76 616c 7565 5f64    policy_value_d
+00008150: 6963 7420 3d20 7365 6c66 2e5f 6573 7469  ict = self._esti
+00008160: 6d61 7465 5f70 6f6c 6963 795f 7661 6c75  mate_policy_valu
+00008170: 6528 0a20 2020 2020 2020 2020 2020 2020  e(.             
+00008180: 2020 2020 2020 2069 6e70 7574 5f64 6963         input_dic
+00008190: 742c 0a20 2020 2020 2020 2020 2020 2020  t,.             
+000081a0: 2020 2020 2020 2063 6f6d 7061 7265 645f         compared_
+000081b0: 6573 7469 6d61 746f 7273 3d63 6f6d 7061  estimators=compa
+000081c0: 7265 645f 6573 7469 6d61 746f 7273 2c0a  red_estimators,.
+000081d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000081e0: 290a 0a20 2020 2020 2020 2065 6c73 653a  )..        else:
+000081f0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00008200: 6973 696e 7374 616e 6365 2869 6e70 7574  isinstance(input
+00008210: 5f64 6963 742c 204d 756c 7469 706c 6549  _dict, MultipleI
+00008220: 6e70 7574 4469 6374 293a 0a20 2020 2020  nputDict):.     
+00008230: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00008240: 2056 616c 7565 4572 726f 7228 0a20 2020   ValueError(.   
+00008250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008260: 2022 7768 656e 2075 7369 6e67 204c 6f67   "when using Log
+00008270: 6765 6444 6174 6173 6574 2c20 706c 6561  gedDataset, plea
+00008280: 7365 2075 7365 2049 6e70 7574 4469 6374  se use InputDict
+00008290: 2069 6e73 7465 6164 206f 6620 4d75 6c74   instead of Mult
+000082a0: 6970 6c65 496e 7075 7444 6963 7422 0a20  ipleInputDict". 
+000082b0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+000082c0: 0a0a 2020 2020 2020 2020 2020 2020 706f  ..            po
+000082d0: 6c69 6379 5f76 616c 7565 5f64 6963 7420  licy_value_dict 
+000082e0: 3d20 7365 6c66 2e5f 6573 7469 6d61 7465  = self._estimate
+000082f0: 5f70 6f6c 6963 795f 7661 6c75 6528 0a20  _policy_value(. 
+00008300: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00008310: 6e70 7574 5f64 6963 742c 0a20 2020 2020  nput_dict,.     
+00008320: 2020 2020 2020 2020 2020 2063 6f6d 7061             compa
+00008330: 7265 645f 6573 7469 6d61 746f 7273 3d63  red_estimators=c
+00008340: 6f6d 7061 7265 645f 6573 7469 6d61 746f  ompared_estimato
+00008350: 7273 2c0a 2020 2020 2020 2020 2020 2020  rs,.            
+00008360: 290a 0a20 2020 2020 2020 2072 6574 7572  )..        retur
+00008370: 6e20 706f 6c69 6379 5f76 616c 7565 5f64  n policy_value_d
+00008380: 6963 740a 0a20 2020 2064 6566 2065 7374  ict..    def est
+00008390: 696d 6174 655f 696e 7465 7276 616c 7328  imate_intervals(
+000083a0: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+000083b0: 2020 2020 2020 2069 6e70 7574 5f64 6963         input_dic
+000083c0: 743a 2055 6e69 6f6e 5b4f 5045 496e 7075  t: Union[OPEInpu
+000083d0: 7444 6963 742c 204d 756c 7469 706c 6549  tDict, MultipleI
+000083e0: 6e70 7574 4469 6374 5d2c 0a20 2020 2020  nputDict],.     
+000083f0: 2020 2063 6f6d 7061 7265 645f 6573 7469     compared_esti
+00008400: 6d61 746f 7273 3a20 4f70 7469 6f6e 616c  mators: Optional
+00008410: 5b4c 6973 745b 7374 725d 5d20 3d20 4e6f  [List[str]] = No
+00008420: 6e65 2c0a 2020 2020 2020 2020 6265 6861  ne,.        beha
+00008430: 7669 6f72 5f70 6f6c 6963 795f 6e61 6d65  vior_policy_name
+00008440: 3a20 4f70 7469 6f6e 616c 5b73 7472 5d20  : Optional[str] 
+00008450: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
+00008460: 6461 7461 7365 745f 6964 3a20 4f70 7469  dataset_id: Opti
+00008470: 6f6e 616c 5b69 6e74 5d20 3d20 4e6f 6e65  onal[int] = None
+00008480: 2c0a 2020 2020 2020 2020 616c 7068 613a  ,.        alpha:
+00008490: 2066 6c6f 6174 203d 2030 2e30 352c 0a20   float = 0.05,. 
+000084a0: 2020 2020 2020 2063 693a 2073 7472 203d         ci: str =
+000084b0: 2022 626f 6f74 7374 7261 7022 2c0a 2020   "bootstrap",.  
+000084c0: 2020 2020 2020 6e5f 626f 6f74 7374 7261        n_bootstra
+000084d0: 705f 7361 6d70 6c65 733a 2069 6e74 203d  p_samples: int =
+000084e0: 2031 3030 2c0a 2020 2020 2020 2020 7261   100,.        ra
+000084f0: 6e64 6f6d 5f73 7461 7465 3a20 4f70 7469  ndom_state: Opti
+00008500: 6f6e 616c 5b69 6e74 5d20 3d20 4e6f 6e65  onal[int] = None
+00008510: 2c0a 2020 2020 2920 2d3e 2044 6963 745b  ,.    ) -> Dict[
+00008520: 7374 722c 2044 6963 745b 7374 722c 2066  str, Dict[str, f
+00008530: 6c6f 6174 5d5d 3a0a 2020 2020 2020 2020  loat]]:.        
+00008540: 2222 2245 7374 696d 6174 6520 7468 6520  """Estimate the 
+00008550: 636f 6e66 6964 656e 6365 2069 6e74 6572  confidence inter
+00008560: 7661 6c73 206f 6620 7468 6520 706f 6c69  vals of the poli
+00008570: 6379 2076 616c 7565 2062 7920 6e6f 6e70  cy value by nonp
+00008580: 6172 616d 6574 7269 6320 626f 6f74 7374  arametric bootst
+00008590: 7261 702e 0a0a 2020 2020 2020 2020 5061  rap...        Pa
+000085a0: 7261 6d65 7465 7273 0a20 2020 2020 2020  rameters.       
+000085b0: 202d 2d2d 2d2d 2d2d 0a20 2020 2020 2020   -------.       
+000085c0: 2069 6e70 7574 5f64 6963 743a 204f 5045   input_dict: OPE
+000085d0: 496e 7075 7444 6963 7420 6f72 204d 756c  InputDict or Mul
+000085e0: 7469 706c 6549 6e70 7574 4469 6374 0a20  tipleInputDict. 
+000085f0: 2020 2020 2020 2020 2020 2044 6963 7469             Dicti
+00008600: 6f6e 6172 7920 6f66 2074 6865 204f 5045  onary of the OPE
+00008610: 2069 6e70 7574 7320 666f 7220 6561 6368   inputs for each
+00008620: 2065 7661 6c75 6174 696f 6e20 706f 6c69   evaluation poli
+00008630: 6379 2e0a 0a20 2020 2020 2020 2020 2020  cy...           
+00008640: 202e 2e20 636f 6465 2d62 6c6f 636b 3a3a   .. code-block::
+00008650: 2070 7974 686f 6e0a 0a20 2020 2020 2020   python..       
+00008660: 2020 2020 2020 2020 206b 6579 3a20 5b65           key: [e
+00008670: 7661 6c75 6174 696f 6e5f 706f 6c69 6379  valuation_policy
+00008680: 5d5b 0a20 2020 2020 2020 2020 2020 2020  ][.             
+00008690: 2020 2020 2020 2065 7661 6c75 6174 696f         evaluatio
+000086a0: 6e5f 706f 6c69 6379 5f61 6374 696f 6e2c  n_policy_action,
+000086b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000086c0: 2020 2020 2065 7661 6c75 6174 696f 6e5f       evaluation_
+000086d0: 706f 6c69 6379 5f61 6374 696f 6e5f 6469  policy_action_di
+000086e0: 7374 2c0a 2020 2020 2020 2020 2020 2020  st,.            
+000086f0: 2020 2020 2020 2020 7374 6174 655f 6163          state_ac
+00008700: 7469 6f6e 5f76 616c 7565 5f70 7265 6469  tion_value_predi
+00008710: 6374 696f 6e2c 0a20 2020 2020 2020 2020  ction,.         
+00008720: 2020 2020 2020 2020 2020 2069 6e69 7469             initi
+00008730: 616c 5f73 7461 7465 5f76 616c 7565 5f70  al_state_value_p
+00008740: 7265 6469 6374 696f 6e2c 0a20 2020 2020  rediction,.     
+00008750: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00008760: 7461 7465 5f61 6374 696f 6e5f 6d61 7267  tate_action_marg
+00008770: 696e 616c 5f69 6d70 6f72 7461 6e63 655f  inal_importance_
+00008780: 7765 6967 6874 2c0a 2020 2020 2020 2020  weight,.        
+00008790: 2020 2020 2020 2020 2020 2020 7374 6174              stat
+000087a0: 655f 6d61 7267 696e 616c 5f69 6d70 6f72  e_marginal_impor
+000087b0: 7461 6e63 655f 7765 6967 6874 2c0a 2020  tance_weight,.  
+000087c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000087d0: 2020 6f6e 5f70 6f6c 6963 795f 706f 6c69    on_policy_poli
+000087e0: 6379 5f76 616c 7565 2c0a 2020 2020 2020  cy_value,.      
+000087f0: 2020 2020 2020 2020 2020 2020 2020 6761                ga
+00008800: 6d6d 612c 0a20 2020 2020 2020 2020 2020  mma,.           
+00008810: 2020 2020 2020 2020 2062 6568 6176 696f           behavio
+00008820: 725f 706f 6c69 6379 2c0a 2020 2020 2020  r_policy,.      
+00008830: 2020 2020 2020 2020 2020 2020 2020 6576                ev
+00008840: 616c 7561 7469 6f6e 5f70 6f6c 6963 792c  aluation_policy,
+00008850: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00008860: 2020 2020 2064 6174 6173 6574 5f69 642c       dataset_id,
+00008870: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00008880: 205d 0a0a 2020 2020 2020 2020 2020 2020   ]..            
+00008890: 2e2e 2073 6565 616c 736f 3a3a 0a0a 2020  .. seealso::..  
+000088a0: 2020 2020 2020 2020 2020 2020 2020 3a63                :c
+000088b0: 6c61 7373 3a60 7363 6f70 655f 726c 2e6f  lass:`scope_rl.o
+000088c0: 7065 2e69 6e70 7574 2e43 7265 6174 654f  pe.input.CreateO
+000088d0: 5045 496e 7075 7460 2064 6573 6372 6962  PEInput` describ
+000088e0: 6573 2074 6865 2063 6f6d 706f 6e65 6e74  es the component
+000088f0: 7320 6f66 203a 636c 6173 733a 6069 6e70  s of :class:`inp
+00008900: 7574 5f64 6963 7460 2e0a 0a20 2020 2020  ut_dict`...     
+00008910: 2020 2063 6f6d 7061 7265 645f 6573 7469     compared_esti
+00008920: 6d61 746f 7273 3a20 6c69 7374 206f 6620  mators: list of 
+00008930: 7374 722c 2064 6566 6175 6c74 3d4e 6f6e  str, default=Non
+00008940: 650a 2020 2020 2020 2020 2020 2020 4e61  e.            Na
+00008950: 6d65 206f 6620 636f 6d70 6172 6564 2065  me of compared e
+00008960: 7374 696d 6174 6f72 732e 0a20 2020 2020  stimators..     
+00008970: 2020 2020 2020 2049 6620 604e 6f6e 6560         If `None`
+00008980: 2069 7320 6769 7665 6e2c 2061 6c6c 2074   is given, all t
+00008990: 6865 2065 7374 696d 6174 6f72 7320 6172  he estimators ar
+000089a0: 6520 636f 6d70 6172 6564 2e0a 0a20 2020  e compared...   
+000089b0: 2020 2020 2062 6568 6176 696f 725f 706f       behavior_po
+000089c0: 6c69 6379 5f6e 616d 653a 2073 7472 2c20  licy_name: str, 
+000089d0: 6465 6661 756c 743d 4e6f 6e65 0a20 2020  default=None.   
+000089e0: 2020 2020 2020 2020 204e 616d 6520 6f66           Name of
+000089f0: 2074 6865 2062 6568 6176 696f 7220 706f   the behavior po
+00008a00: 6c69 6379 2e0a 0a20 2020 2020 2020 2064  licy...        d
+00008a10: 6174 6173 6574 5f69 643a 2069 6e74 2c20  ataset_id: int, 
+00008a20: 6465 6661 756c 743d 4e6f 6e65 0a20 2020  default=None.   
+00008a30: 2020 2020 2020 2020 2049 6420 6f66 2074           Id of t
+00008a40: 6865 206c 6f67 6765 6420 6461 7461 7365  he logged datase
+00008a50: 742e 0a0a 2020 2020 2020 2020 616c 7068  t...        alph
+00008a60: 613a 2066 6c6f 6174 2c20 6465 6661 756c  a: float, defaul
+00008a70: 743d 302e 3035 0a20 2020 2020 2020 2020  t=0.05.         
+00008a80: 2020 2053 6967 6e69 6669 6361 6e63 6520     Significance 
+00008a90: 6c65 7665 6c2e 2054 6865 2076 616c 7565  level. The value
+00008aa0: 2073 686f 756c 6420 6265 2077 6974 6869   should be withi
+00008ab0: 6e20 605b 302c 2031 2960 2e0a 0a20 2020  n `[0, 1)`...   
+00008ac0: 2020 2020 2063 693a 207b 2262 6f6f 7473       ci: {"boots
+00008ad0: 7472 6170 222c 2022 686f 6566 6664 696e  trap", "hoeffdin
+00008ae0: 6722 2c20 2262 6572 6e73 7465 696e 222c  g", "bernstein",
+00008af0: 2022 7474 6573 7422 7d2c 2064 6566 6175   "ttest"}, defau
+00008b00: 6c74 3d22 626f 6f74 7374 7261 7022 0a20  lt="bootstrap". 
+00008b10: 2020 2020 2020 2020 2020 204d 6574 686f             Metho
+00008b20: 6420 746f 2065 7374 696d 6174 6520 7468  d to estimate th
+00008b30: 6520 636f 6e66 6964 656e 6365 2069 6e74  e confidence int
+00008b40: 6572 7661 6c2e 0a0a 2020 2020 2020 2020  erval...        
+00008b50: 6e5f 626f 6f74 7374 7261 705f 7361 6d70  n_bootstrap_samp
+00008b60: 6c65 733a 2069 6e74 2c20 6465 6661 756c  les: int, defaul
+00008b70: 743d 3130 3020 283e 2030 290a 2020 2020  t=100 (> 0).    
+00008b80: 2020 2020 2020 2020 4e75 6d62 6572 206f          Number o
+00008b90: 6620 7265 7361 6d70 6c69 6e67 2070 6572  f resampling per
+00008ba0: 666f 726d 6564 2069 6e20 7468 6520 626f  formed in the bo
+00008bb0: 6f74 7374 7261 7020 7072 6f63 6564 7572  otstrap procedur
+00008bc0: 652e 0a0a 2020 2020 2020 2020 7261 6e64  e...        rand
+00008bd0: 6f6d 5f73 7461 7465 3a20 696e 742c 2064  om_state: int, d
+00008be0: 6566 6175 6c74 3d4e 6f6e 6520 283e 3d20  efault=None (>= 
+00008bf0: 3029 0a20 2020 2020 2020 2020 2020 2052  0).            R
+00008c00: 616e 646f 6d20 7374 6174 652e 0a0a 2020  andom state...  
+00008c10: 2020 2020 2020 5265 7475 726e 0a20 2020        Return.   
+00008c20: 2020 2020 202d 2d2d 2d2d 2d2d 0a20 2020       -------.   
+00008c30: 2020 2020 2070 6f6c 6963 795f 7661 6c75       policy_valu
+00008c40: 655f 696e 7465 7276 616c 5f64 6963 743a  e_interval_dict:
+00008c50: 2064 6963 740a 2020 2020 2020 2020 2020   dict.          
+00008c60: 2020 4469 6374 696f 6e61 7279 2063 6f6e    Dictionary con
+00008c70: 7461 696e 696e 6720 7468 6520 636f 6e66  taining the conf
+00008c80: 6964 656e 6365 2069 6e74 6572 7661 6c73  idence intervals
+00008c90: 2065 7374 696d 6174 6564 2062 7920 6e6f   estimated by no
+00008ca0: 6e70 6172 616d 6574 7269 6320 626f 6f74  nparametric boot
+00008cb0: 7374 7261 702e 0a20 2020 2020 2020 2020  strap..         
+00008cc0: 2020 206b 6579 3a20 3a63 6c61 7373 3a60     key: :class:`
+00008cd0: 5b65 7661 6c75 6174 696f 6e5f 706f 6c69  [evaluation_poli
+00008ce0: 6379 5d5b 4f50 455f 6573 7469 6d61 746f  cy][OPE_estimato
+00008cf0: 725f 6e61 6d65 5d60 0a0a 2020 2020 2020  r_name]`..      
+00008d00: 2020 2020 2020 5768 656e 2062 6568 6176        When behav
+00008d10: 696f 725f 706f 6c69 6379 5f6e 616d 6520  ior_policy_name 
+00008d20: 6973 2060 4e6f 6e65 6020 616e 6420 6461  is `None` and da
+00008d30: 7461 7365 745f 6964 2069 7320 604e 6f6e  taset_id is `Non
+00008d40: 6560 2c0a 2020 2020 2020 2020 2020 2020  e`,.            
+00008d50: 6b65 793a 203a 636c 6173 733a 605b 6265  key: :class:`[be
+00008d60: 6861 7669 6f72 5f70 6f6c 6963 795f 6e61  havior_policy_na
+00008d70: 6d65 5d5b 6461 7461 7365 745f 6964 5d5b  me][dataset_id][
+00008d80: 6576 616c 7561 7469 6f6e 5f70 6f6c 6963  evaluation_polic
+00008d90: 795d 5b4f 5045 5f65 7374 696d 6174 6f72  y][OPE_estimator
+00008da0: 5f6e 616d 655d 600a 0a20 2020 2020 2020  _name]`..       
+00008db0: 2020 2020 2057 6865 6e20 6265 6861 7669       When behavi
+00008dc0: 6f72 5f70 6f6c 6963 795f 6e61 6d65 2069  or_policy_name i
+00008dd0: 7320 604e 6f6e 6560 2061 6e64 2064 6174  s `None` and dat
+00008de0: 6173 6574 5f69 6420 6973 2073 7065 6369  aset_id is speci
+00008df0: 6669 6564 2c0a 2020 2020 2020 2020 2020  fied,.          
+00008e00: 2020 6b65 793a 203a 636c 6173 733a 605b    key: :class:`[
+00008e10: 6265 6861 7669 6f72 5f70 6f6c 6963 795f  behavior_policy_
+00008e20: 6e61 6d65 5d5b 6576 616c 7561 7469 6f6e  name][evaluation
+00008e30: 5f70 6f6c 6963 795d 5b4f 5045 5f65 7374  _policy][OPE_est
+00008e40: 696d 6174 6f72 5f6e 616d 655d 600a 0a20  imator_name]`.. 
+00008e50: 2020 2020 2020 2020 2020 2057 6865 6e20             When 
+00008e60: 6265 6861 7669 6f72 5f70 6f6c 6963 795f  behavior_policy_
+00008e70: 6e61 6d65 2069 7320 7370 6563 6966 6965  name is specifie
+00008e80: 6420 616e 6420 6461 7461 7365 745f 6964  d and dataset_id
+00008e90: 2069 7320 604e 6f6e 6560 2c0a 2020 2020   is `None`,.    
+00008ea0: 2020 2020 2020 2020 6b65 793a 203a 636c          key: :cl
+00008eb0: 6173 733a 605b 6461 7461 7365 745f 6964  ass:`[dataset_id
+00008ec0: 5d5b 4f50 455f 6573 7469 6d61 746f 725f  ][OPE_estimator_
+00008ed0: 6e61 6d65 5d60 0a0a 2020 2020 2020 2020  name]`..        
+00008ee0: 5265 6665 7265 6e63 6573 0a20 2020 2020  References.     
+00008ef0: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 2020     -------.     
+00008f00: 2020 204a 6f73 6961 6820 502e 2048 616e     Josiah P. Han
+00008f10: 6e61 2c20 5065 7465 7220 5374 6f6e 652c  na, Peter Stone,
+00008f20: 2061 6e64 2053 636f 7474 204e 6965 6b75   and Scott Nieku
+00008f30: 6d2e 0a20 2020 2020 2020 2022 426f 6f74  m..        "Boot
+00008f40: 7374 7261 7070 696e 6720 7769 7468 204d  strapping with M
+00008f50: 6f64 656c 733a 2043 6f6e 6669 6465 6e63  odels: Confidenc
+00008f60: 6520 496e 7465 7276 616c 7320 666f 7220  e Intervals for 
+00008f70: 4f66 662d 506f 6c69 6379 2045 7661 6c75  Off-Policy Evalu
+00008f80: 6174 696f 6e2e 2220 3230 3137 2e0a 0a20  ation." 2017... 
+00008f90: 2020 2020 2020 2050 6869 6c69 7020 532e         Philip S.
+00008fa0: 2054 686f 6d61 732c 2047 656f 7267 696f   Thomas, Georgio
+00008fb0: 7320 5468 656f 6368 6172 6f75 732c 2061  s Theocharous, a
+00008fc0: 6e64 204d 6f68 616d 6d61 6420 4768 6176  nd Mohammad Ghav
+00008fd0: 616d 7a61 6465 682e 0a20 2020 2020 2020  amzadeh..       
+00008fe0: 2022 4869 6768 2043 6f6e 6669 6465 6e63   "High Confidenc
+00008ff0: 6520 506f 6c69 6379 2049 6d70 726f 7665  e Policy Improve
+00009000: 6d65 6e74 2e22 2032 3031 352e 0a0a 2020  ment." 2015...  
+00009010: 2020 2020 2020 5068 696c 6970 2053 2e20        Philip S. 
+00009020: 5468 6f6d 6173 2c20 4765 6f72 6769 6f73  Thomas, Georgios
+00009030: 2054 6865 6f63 6861 726f 7573 2c20 616e   Theocharous, an
+00009040: 6420 4d6f 6861 6d6d 6164 2047 6861 7661  d Mohammad Ghava
+00009050: 6d7a 6164 6568 2e0a 2020 2020 2020 2020  mzadeh..        
+00009060: 2248 6967 6820 436f 6e66 6964 656e 6365  "High Confidence
+00009070: 204f 6666 2d50 6f6c 6963 7920 4576 616c   Off-Policy Eval
+00009080: 7561 7469 6f6e 2e22 2032 3031 352e 0a0a  uation." 2015...
+00009090: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+000090a0: 2020 2020 636f 6d70 6172 6564 5f65 7374      compared_est
+000090b0: 696d 6174 6f72 7320 3d20 7365 6c66 2e5f  imators = self._
+000090c0: 6368 6563 6b5f 636f 6d70 6172 6564 5f65  check_compared_e
+000090d0: 7374 696d 6174 6f72 7328 636f 6d70 6172  stimators(compar
+000090e0: 6564 5f65 7374 696d 6174 6f72 7329 0a0a  ed_estimators)..
+000090f0: 2020 2020 2020 2020 6966 2063 6920 6e6f          if ci no
+00009100: 7420 696e 2073 656c 662e 5f65 7374 696d  t in self._estim
+00009110: 6174 655f 636f 6e66 6964 656e 6365 5f69  ate_confidence_i
+00009120: 6e74 6572 7661 6c2e 6b65 7973 2829 3a0a  nterval.keys():.
+00009130: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00009140: 6520 5661 6c75 6545 7272 6f72 280a 2020  e ValueError(.  
+00009150: 2020 2020 2020 2020 2020 2020 2020 6622                f"
+00009160: 6369 206d 7573 7420 6265 206f 6e65 206f  ci must be one o
+00009170: 6620 2762 6f6f 7473 7472 6170 272c 2027  f 'bootstrap', '
+00009180: 686f 6566 6664 696e 6727 2c20 2762 6572  hoeffding', 'ber
+00009190: 6e73 7465 696e 272c 206f 7220 2774 7465  nstein', or 'tte
+000091a0: 7374 272c 2062 7574 207b 6369 7d20 6973  st', but {ci} is
+000091b0: 2067 6976 656e 220a 2020 2020 2020 2020   given".        
+000091c0: 2020 2020 290a 0a20 2020 2020 2020 2069      )..        i
+000091d0: 6620 7365 6c66 2e75 7365 5f6d 756c 7469  f self.use_multi
+000091e0: 706c 655f 6c6f 6767 6564 5f64 6174 6173  ple_logged_datas
+000091f0: 6574 3a0a 2020 2020 2020 2020 2020 2020  et:.            
+00009200: 6966 2069 7369 6e73 7461 6e63 6528 696e  if isinstance(in
+00009210: 7075 745f 6469 6374 2c20 4d75 6c74 6970  put_dict, Multip
+00009220: 6c65 496e 7075 7444 6963 7429 3a0a 2020  leInputDict):.  
+00009230: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00009240: 2062 6568 6176 696f 725f 706f 6c69 6379   behavior_policy
+00009250: 5f6e 616d 6520 6973 204e 6f6e 6520 616e  _name is None an
+00009260: 6420 6461 7461 7365 745f 6964 2069 7320  d dataset_id is 
+00009270: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+00009280: 2020 2020 2020 2020 2020 6966 2073 656c            if sel
+00009290: 662e 6d75 6c74 6970 6c65 5f6c 6f67 6765  f.multiple_logge
+000092a0: 645f 6461 7461 7365 742e 6e5f 6461 7461  d_dataset.n_data
+000092b0: 7365 7473 2021 3d20 696e 7075 745f 6469  sets != input_di
+000092c0: 6374 2e6e 5f64 6174 6173 6574 733a 0a20  ct.n_datasets:. 
+000092d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000092e0: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+000092f0: 7565 4572 726f 7228 0a20 2020 2020 2020  ueError(.       
+00009300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009310: 2020 2020 2022 4578 7065 6374 6564 2074       "Expected t
+00009320: 6861 7420 6c6f 6767 6564 2064 6174 6173  hat logged datas
+00009330: 6574 7320 616e 6420 696e 7075 7420 6469  ets and input di
+00009340: 6374 7320 636f 6e73 6973 7473 206f 6620  cts consists of 
+00009350: 7468 6520 7361 6d65 2062 6568 6176 696f  the same behavio
+00009360: 7220 706f 6c69 6369 6573 2061 6e64 2064  r policies and d
+00009370: 6174 6173 6574 2069 6473 2c20 6275 7420  ataset ids, but 
+00009380: 666f 756e 6420 4661 6c73 652e 220a 2020  found False.".  
+00009390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000093a0: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+000093b0: 2020 2020 2020 2020 2020 2020 2070 6f6c               pol
+000093c0: 6963 795f 7661 6c75 655f 696e 7465 7276  icy_value_interv
+000093d0: 616c 5f64 6963 7420 3d20 6465 6661 756c  al_dict = defaul
+000093e0: 7464 6963 7428 6c69 7374 290a 2020 2020  tdict(list).    
+000093f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009400: 666f 7220 280a 2020 2020 2020 2020 2020  for (.          
+00009410: 2020 2020 2020 2020 2020 2020 2020 6265                be
+00009420: 6861 7669 6f72 5f70 6f6c 6963 792c 0a20  havior_policy,. 
+00009430: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009440: 2020 2020 2020 206e 5f64 6174 6173 6574         n_dataset
+00009450: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
+00009460: 2020 2020 2020 2029 2069 6e20 696e 7075         ) in inpu
+00009470: 745f 6469 6374 2e6e 5f64 6174 6173 6574  t_dict.n_dataset
+00009480: 732e 6974 656d 7328 293a 0a20 2020 2020  s.items():.     
+00009490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000094a0: 2020 2066 6f72 2064 6174 6173 6574 5f69     for dataset_i
+000094b0: 645f 2069 6e20 7261 6e67 6528 6e5f 6461  d_ in range(n_da
+000094c0: 7461 7365 7473 293a 0a20 2020 2020 2020  tasets):.       
+000094d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000094e0: 2020 2020 2073 656c 662e 5f72 6567 6973       self._regis
+000094f0: 7465 725f 6c6f 6767 6564 5f64 6174 6173  ter_logged_datas
+00009500: 6574 280a 2020 2020 2020 2020 2020 2020  et(.            
+00009510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009520: 2020 2020 6265 6861 7669 6f72 5f70 6f6c      behavior_pol
+00009530: 6963 795f 6e61 6d65 3d62 6568 6176 696f  icy_name=behavio
+00009540: 725f 706f 6c69 6379 2c0a 2020 2020 2020  r_policy,.      
+00009550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009560: 2020 2020 2020 2020 2020 6461 7461 7365            datase
+00009570: 745f 6964 3d64 6174 6173 6574 5f69 645f  t_id=dataset_id_
+00009580: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00009590: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+000095a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000095b0: 2020 2020 2020 2020 2020 2020 696e 7075              inpu
+000095c0: 745f 6469 6374 5f20 3d20 696e 7075 745f  t_dict_ = input_
+000095d0: 6469 6374 2e67 6574 280a 2020 2020 2020  dict.get(.      
+000095e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000095f0: 2020 2020 2020 2020 2020 6265 6861 7669            behavi
+00009600: 6f72 5f70 6f6c 6963 795f 6e61 6d65 3d62  or_policy_name=b
+00009610: 6568 6176 696f 725f 706f 6c69 6379 2c0a  ehavior_policy,.
+00009620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009640: 6461 7461 7365 745f 6964 3d64 6174 6173  dataset_id=datas
+00009650: 6574 5f69 645f 2c0a 2020 2020 2020 2020  et_id_,.        
+00009660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009670: 2020 2020 290a 0a20 2020 2020 2020 2020      )..         
+00009680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009690: 2020 2070 6f6c 6963 795f 7661 6c75 655f     policy_value_
+000096a0: 696e 7465 7276 616c 5f64 6963 745f 203d  interval_dict_ =
+000096b0: 2073 656c 662e 5f65 7374 696d 6174 655f   self._estimate_
+000096c0: 696e 7465 7276 616c 7328 0a20 2020 2020  intervals(.     
+000096d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000096e0: 2020 2020 2020 2020 2020 2069 6e70 7574             input
+000096f0: 5f64 6963 745f 2c0a 2020 2020 2020 2020  _dict_,.        
+00009700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009710: 2020 2020 2020 2020 636f 6d70 6172 6564          compared
+00009720: 5f65 7374 696d 6174 6f72 733d 636f 6d70  _estimators=comp
+00009730: 6172 6564 5f65 7374 696d 6174 6f72 732c  ared_estimators,
+00009740: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00009750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009760: 2061 6c70 6861 3d61 6c70 6861 2c0a 2020   alpha=alpha,.  
 00009770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009780: 2020 636f 6d70 6172 6564 5f65 7374 696d    compared_estim
-00009790: 6174 6f72 733d 636f 6d70 6172 6564 5f65  ators=compared_e
-000097a0: 7374 696d 6174 6f72 732c 0a20 2020 2020  stimators,.     
-000097b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000097c0: 2020 2020 2020 2020 2020 2061 6c70 6861             alpha
-000097d0: 3d61 6c70 6861 2c0a 2020 2020 2020 2020  =alpha,.        
+00009780: 2020 2020 2020 2020 2020 2020 2020 6369                ci
+00009790: 3d63 692c 0a20 2020 2020 2020 2020 2020  =ci,.           
+000097a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000097b0: 2020 2020 206e 5f62 6f6f 7473 7472 6170       n_bootstrap
+000097c0: 5f73 616d 706c 6573 3d6e 5f62 6f6f 7473  _samples=n_boots
+000097d0: 7472 6170 5f73 616d 706c 6573 2c0a 2020  trap_samples,.  
 000097e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000097f0: 2020 2020 2020 2020 6369 3d63 692c 0a20          ci=ci,. 
-00009800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009810: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-00009820: 5f62 6f6f 7473 7472 6170 5f73 616d 706c  _bootstrap_sampl
-00009830: 6573 3d6e 5f62 6f6f 7473 7472 6170 5f73  es=n_bootstrap_s
-00009840: 616d 706c 6573 2c0a 2020 2020 2020 2020  amples,.        
-00009850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009860: 2020 2020 2020 2020 7261 6e64 6f6d 5f73          random_s
-00009870: 7461 7465 3d72 616e 646f 6d5f 7374 6174  tate=random_stat
-00009880: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
-00009890: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-000098a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000098b0: 2020 2020 2020 2020 2020 2020 2070 6f6c               pol
-000098c0: 6963 795f 7661 6c75 655f 696e 7465 7276  icy_value_interv
-000098d0: 616c 5f64 6963 745b 6265 6861 7669 6f72  al_dict[behavior
-000098e0: 5f70 6f6c 6963 795d 2e61 7070 656e 6428  _policy].append(
-000098f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00009900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009910: 2070 6f6c 6963 795f 7661 6c75 655f 696e   policy_value_in
-00009920: 7465 7276 616c 5f64 6963 745f 0a20 2020  terval_dict_.   
+000097f0: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+00009800: 6e64 6f6d 5f73 7461 7465 3d72 616e 646f  ndom_state=rando
+00009810: 6d5f 7374 6174 652c 0a20 2020 2020 2020  m_state,.       
+00009820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009830: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+00009840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009850: 2020 2070 6f6c 6963 795f 7661 6c75 655f     policy_value_
+00009860: 696e 7465 7276 616c 5f64 6963 745b 6265  interval_dict[be
+00009870: 6861 7669 6f72 5f70 6f6c 6963 795d 2e61  havior_policy].a
+00009880: 7070 656e 6428 0a20 2020 2020 2020 2020  ppend(.         
+00009890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000098a0: 2020 2020 2020 2070 6f6c 6963 795f 7661         policy_va
+000098b0: 6c75 655f 696e 7465 7276 616c 5f64 6963  lue_interval_dic
+000098c0: 745f 0a20 2020 2020 2020 2020 2020 2020  t_.             
+000098d0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+000098e0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000098f0: 2020 2020 2020 706f 6c69 6379 5f76 616c        policy_val
+00009900: 7565 5f69 6e74 6572 7661 6c5f 6469 6374  ue_interval_dict
+00009910: 203d 2064 6566 6175 6c74 6469 6374 5f74   = defaultdict_t
+00009920: 6f5f 6469 6374 280a 2020 2020 2020 2020  o_dict(.        
 00009930: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009940: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-00009950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009960: 706f 6c69 6379 5f76 616c 7565 5f69 6e74  policy_value_int
-00009970: 6572 7661 6c5f 6469 6374 203d 2064 6566  erval_dict = def
-00009980: 6175 6c74 6469 6374 5f74 6f5f 6469 6374  aultdict_to_dict
-00009990: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-000099a0: 2020 2020 2020 2020 2020 706f 6c69 6379            policy
-000099b0: 5f76 616c 7565 5f69 6e74 6572 7661 6c5f  _value_interval_
-000099c0: 6469 6374 0a20 2020 2020 2020 2020 2020  dict.           
-000099d0: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-000099e0: 2020 2020 2020 2020 2020 2020 656c 6966              elif
-000099f0: 2062 6568 6176 696f 725f 706f 6c69 6379   behavior_policy
-00009a00: 5f6e 616d 6520 6973 204e 6f6e 6520 616e  _name is None an
-00009a10: 6420 6461 7461 7365 745f 6964 2069 7320  d dataset_id is 
-00009a20: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
-00009a30: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00009a40: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
-00009a50: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00009a60: 6d75 6c74 6970 6c65 5f6c 6f67 6765 645f  multiple_logged_
-00009a70: 6461 7461 7365 742e 6265 6861 7669 6f72  dataset.behavior
-00009a80: 5f70 6f6c 6963 795f 6e61 6d65 730a 2020  _policy_names.  
-00009a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009aa0: 2020 2020 2020 213d 2069 6e70 7574 5f64        != input_d
-00009ab0: 6963 742e 6265 6861 7669 6f72 5f70 6f6c  ict.behavior_pol
-00009ac0: 6963 795f 6e61 6d65 730a 2020 2020 2020  icy_names.      
-00009ad0: 2020 2020 2020 2020 2020 2020 2020 293a                ):
-00009ae0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00009af0: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-00009b00: 616c 7565 4572 726f 7228 0a20 2020 2020  alueError(.     
-00009b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009b20: 2020 2020 2020 2022 4578 7065 6374 6564         "Expected
-00009b30: 2074 6861 7420 6c6f 6767 6564 2064 6174   that logged dat
-00009b40: 6173 6574 7320 616e 6420 696e 7075 7420  asets and input 
-00009b50: 6469 6374 7320 636f 6e73 6973 7473 206f  dicts consists o
-00009b60: 6620 7468 6520 7361 6d65 2062 6568 6176  f the same behav
-00009b70: 696f 7220 706f 6c69 6369 6573 2c20 6275  ior policies, bu
-00009b80: 7420 666f 756e 6420 4661 6c73 652e 220a  t found False.".
-00009b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009ba0: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
-00009bb0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00009bc0: 6f6c 6963 795f 7661 6c75 655f 696e 7465  olicy_value_inte
-00009bd0: 7276 616c 5f64 6963 7420 3d20 7b7d 0a20  rval_dict = {}. 
-00009be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009bf0: 2020 2066 6f72 2062 6568 6176 696f 725f     for behavior_
-00009c00: 706f 6c69 6379 2069 6e20 696e 7075 745f  policy in input_
-00009c10: 6469 6374 2e62 6568 6176 696f 725f 706f  dict.behavior_po
-00009c20: 6c69 6379 5f6e 616d 6573 3a0a 2020 2020  licy_names:.    
-00009c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009c40: 2020 2020 7365 6c66 2e5f 7265 6769 7374      self._regist
-00009c50: 6572 5f6c 6f67 6765 645f 6461 7461 7365  er_logged_datase
-00009c60: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
-00009c70: 2020 2020 2020 2020 2020 2020 2020 2062                 b
-00009c80: 6568 6176 696f 725f 706f 6c69 6379 5f6e  ehavior_policy_n
-00009c90: 616d 653d 6265 6861 7669 6f72 5f70 6f6c  ame=behavior_pol
-00009ca0: 6963 792c 0a20 2020 2020 2020 2020 2020  icy,.           
-00009cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009cc0: 2064 6174 6173 6574 5f69 643d 6461 7461   dataset_id=data
-00009cd0: 7365 745f 6964 2c0a 2020 2020 2020 2020  set_id,.        
-00009ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009cf0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00009d00: 2020 2020 2020 2020 2020 696e 7075 745f            input_
-00009d10: 6469 6374 5f20 3d20 696e 7075 745f 6469  dict_ = input_di
-00009d20: 6374 2e67 6574 280a 2020 2020 2020 2020  ct.get(.        
-00009d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009d40: 2020 2020 6265 6861 7669 6f72 5f70 6f6c      behavior_pol
-00009d50: 6963 795f 6e61 6d65 3d62 6568 6176 696f  icy_name=behavio
-00009d60: 725f 706f 6c69 6379 2c0a 2020 2020 2020  r_policy,.      
-00009d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009d80: 2020 2020 2020 6461 7461 7365 745f 6964        dataset_id
-00009d90: 3d64 6174 6173 6574 5f69 642c 0a20 2020  =dataset_id,.   
+00009940: 706f 6c69 6379 5f76 616c 7565 5f69 6e74  policy_value_int
+00009950: 6572 7661 6c5f 6469 6374 0a20 2020 2020  erval_dict.     
+00009960: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+00009970: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00009980: 2020 656c 6966 2062 6568 6176 696f 725f    elif behavior_
+00009990: 706f 6c69 6379 5f6e 616d 6520 6973 204e  policy_name is N
+000099a0: 6f6e 6520 616e 6420 6461 7461 7365 745f  one and dataset_
+000099b0: 6964 2069 7320 6e6f 7420 4e6f 6e65 3a0a  id is not None:.
+000099c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000099d0: 2020 2020 6966 2028 0a20 2020 2020 2020      if (.       
+000099e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000099f0: 2073 656c 662e 6d75 6c74 6970 6c65 5f6c   self.multiple_l
+00009a00: 6f67 6765 645f 6461 7461 7365 742e 6265  ogged_dataset.be
+00009a10: 6861 7669 6f72 5f70 6f6c 6963 795f 6e61  havior_policy_na
+00009a20: 6d65 730a 2020 2020 2020 2020 2020 2020  mes.            
+00009a30: 2020 2020 2020 2020 2020 2020 213d 2069              != i
+00009a40: 6e70 7574 5f64 6963 742e 6265 6861 7669  nput_dict.behavi
+00009a50: 6f72 5f70 6f6c 6963 795f 6e61 6d65 730a  or_policy_names.
+00009a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009a70: 2020 2020 293a 0a20 2020 2020 2020 2020      ):.         
+00009a80: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00009a90: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+00009aa0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00009ab0: 2020 2020 2020 2020 2020 2020 2022 4578               "Ex
+00009ac0: 7065 6374 6564 2074 6861 7420 6c6f 6767  pected that logg
+00009ad0: 6564 2064 6174 6173 6574 7320 616e 6420  ed datasets and 
+00009ae0: 696e 7075 7420 6469 6374 7320 636f 6e73  input dicts cons
+00009af0: 6973 7473 206f 6620 7468 6520 7361 6d65  ists of the same
+00009b00: 2062 6568 6176 696f 7220 706f 6c69 6369   behavior polici
+00009b10: 6573 2c20 6275 7420 666f 756e 6420 4661  es, but found Fa
+00009b20: 6c73 652e 220a 2020 2020 2020 2020 2020  lse.".          
+00009b30: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+00009b40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00009b50: 2020 2020 2070 6f6c 6963 795f 7661 6c75       policy_valu
+00009b60: 655f 696e 7465 7276 616c 5f64 6963 7420  e_interval_dict 
+00009b70: 3d20 7b7d 0a20 2020 2020 2020 2020 2020  = {}.           
+00009b80: 2020 2020 2020 2020 2066 6f72 2062 6568           for beh
+00009b90: 6176 696f 725f 706f 6c69 6379 2069 6e20  avior_policy in 
+00009ba0: 696e 7075 745f 6469 6374 2e62 6568 6176  input_dict.behav
+00009bb0: 696f 725f 706f 6c69 6379 5f6e 616d 6573  ior_policy_names
+00009bc0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00009bd0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+00009be0: 7265 6769 7374 6572 5f6c 6f67 6765 645f  register_logged_
+00009bf0: 6461 7461 7365 7428 0a20 2020 2020 2020  dataset(.       
+00009c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009c10: 2020 2020 2062 6568 6176 696f 725f 706f       behavior_po
+00009c20: 6c69 6379 5f6e 616d 653d 6265 6861 7669  licy_name=behavi
+00009c30: 6f72 5f70 6f6c 6963 792c 0a20 2020 2020  or_policy,.     
+00009c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009c50: 2020 2020 2020 2064 6174 6173 6574 5f69         dataset_i
+00009c60: 643d 6461 7461 7365 745f 6964 2c0a 2020  d=dataset_id,.  
+00009c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009c80: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00009c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009ca0: 696e 7075 745f 6469 6374 5f20 3d20 696e  input_dict_ = in
+00009cb0: 7075 745f 6469 6374 2e67 6574 280a 2020  put_dict.get(.  
+00009cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009cd0: 2020 2020 2020 2020 2020 6265 6861 7669            behavi
+00009ce0: 6f72 5f70 6f6c 6963 795f 6e61 6d65 3d62  or_policy_name=b
+00009cf0: 6568 6176 696f 725f 706f 6c69 6379 2c0a  ehavior_policy,.
+00009d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009d10: 2020 2020 2020 2020 2020 2020 6461 7461              data
+00009d20: 7365 745f 6964 3d64 6174 6173 6574 5f69  set_id=dataset_i
+00009d30: 642c 0a20 2020 2020 2020 2020 2020 2020  d,.             
+00009d40: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
+00009d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009d60: 2020 2020 2020 706f 6c69 6379 5f76 616c        policy_val
+00009d70: 7565 5f69 6e74 6572 7661 6c5f 6469 6374  ue_interval_dict
+00009d80: 5f20 3d20 7365 6c66 2e5f 6573 7469 6d61  _ = self._estima
+00009d90: 7465 5f69 6e74 6572 7661 6c73 280a 2020  te_intervals(.  
 00009da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009db0: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
-00009dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009dd0: 706f 6c69 6379 5f76 616c 7565 5f69 6e74  policy_value_int
-00009de0: 6572 7661 6c5f 6469 6374 5f20 3d20 7365  erval_dict_ = se
-00009df0: 6c66 2e5f 6573 7469 6d61 7465 5f69 6e74  lf._estimate_int
-00009e00: 6572 7661 6c73 280a 2020 2020 2020 2020  ervals(.        
+00009db0: 2020 2020 2020 2020 2020 696e 7075 745f            input_
+00009dc0: 6469 6374 5f2c 0a20 2020 2020 2020 2020  dict_,.         
+00009dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009de0: 2020 2063 6f6d 7061 7265 645f 6573 7469     compared_esti
+00009df0: 6d61 746f 7273 3d63 6f6d 7061 7265 645f  mators=compared_
+00009e00: 6573 7469 6d61 746f 7273 2c0a 2020 2020  estimators,.    
 00009e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009e20: 2020 2020 696e 7075 745f 6469 6374 5f2c      input_dict_,
-00009e30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00009e40: 2020 2020 2020 2020 2020 2020 2063 6f6d               com
-00009e50: 7061 7265 645f 6573 7469 6d61 746f 7273  pared_estimators
-00009e60: 3d63 6f6d 7061 7265 645f 6573 7469 6d61  =compared_estima
-00009e70: 746f 7273 2c0a 2020 2020 2020 2020 2020  tors,.          
-00009e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009e90: 2020 616c 7068 613d 616c 7068 612c 0a20    alpha=alpha,. 
+00009e20: 2020 2020 2020 2020 616c 7068 613d 616c          alpha=al
+00009e30: 7068 612c 0a20 2020 2020 2020 2020 2020  pha,.           
+00009e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009e50: 2063 693d 6369 2c0a 2020 2020 2020 2020   ci=ci,.        
+00009e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009e70: 2020 2020 6e5f 626f 6f74 7374 7261 705f      n_bootstrap_
+00009e80: 7361 6d70 6c65 733d 6e5f 626f 6f74 7374  samples=n_bootst
+00009e90: 7261 705f 7361 6d70 6c65 732c 0a20 2020  rap_samples,.   
 00009ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009eb0: 2020 2020 2020 2020 2020 2063 693d 6369             ci=ci
-00009ec0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00009ed0: 2020 2020 2020 2020 2020 2020 2020 6e5f                n_
-00009ee0: 626f 6f74 7374 7261 705f 7361 6d70 6c65  bootstrap_sample
-00009ef0: 733d 6e5f 626f 6f74 7374 7261 705f 7361  s=n_bootstrap_sa
-00009f00: 6d70 6c65 732c 0a20 2020 2020 2020 2020  mples,.         
-00009f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009f20: 2020 2072 616e 646f 6d5f 7374 6174 653d     random_state=
-00009f30: 7261 6e64 6f6d 5f73 7461 7465 2c0a 2020  random_state,.  
-00009f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009f50: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00009f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009f70: 706f 6c69 6379 5f76 616c 7565 5f69 6e74  policy_value_int
-00009f80: 6572 7661 6c5f 6469 6374 5b0a 2020 2020  erval_dict[.    
-00009f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009fa0: 2020 2020 2020 2020 6265 6861 7669 6f72          behavior
-00009fb0: 5f70 6f6c 6963 790a 2020 2020 2020 2020  _policy.        
-00009fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009fd0: 5d20 3d20 706f 6c69 6379 5f76 616c 7565  ] = policy_value
-00009fe0: 5f69 6e74 6572 7661 6c5f 6469 6374 5f0a  _interval_dict_.
-00009ff0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000a000: 2065 6c69 6620 6265 6861 7669 6f72 5f70   elif behavior_p
-0000a010: 6f6c 6963 795f 6e61 6d65 2069 7320 6e6f  olicy_name is no
-0000a020: 7420 4e6f 6e65 2061 6e64 2064 6174 6173  t None and datas
-0000a030: 6574 5f69 6420 6973 204e 6f6e 653a 0a20  et_id is None:. 
-0000a040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a050: 2020 2069 6620 280a 2020 2020 2020 2020     if (.        
-0000a060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a070: 7365 6c66 2e6d 756c 7469 706c 655f 6c6f  self.multiple_lo
-0000a080: 6767 6564 5f64 6174 6173 6574 2e6e 5f64  gged_dataset.n_d
-0000a090: 6174 6173 6574 735b 6265 6861 7669 6f72  atasets[behavior
-0000a0a0: 5f70 6f6c 6963 795f 6e61 6d65 5d0a 2020  _policy_name].  
-0000a0b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a0c0: 2020 2020 2020 213d 2069 6e70 7574 5f64        != input_d
-0000a0d0: 6963 742e 6e5f 6461 7461 7365 7473 5b62  ict.n_datasets[b
-0000a0e0: 6568 6176 696f 725f 706f 6c69 6379 5f6e  ehavior_policy_n
-0000a0f0: 616d 655d 0a20 2020 2020 2020 2020 2020  ame].           
-0000a100: 2020 2020 2020 2020 2029 3a0a 2020 2020           ):.    
-0000a110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a120: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-0000a130: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
-0000a140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a150: 2020 2245 7870 6563 7465 6420 7468 6174    "Expected that
-0000a160: 206c 6f67 6765 6420 6461 7461 7365 7473   logged datasets
-0000a170: 2061 6e64 2069 6e70 7574 2064 6963 7473   and input dicts
-0000a180: 2063 6f6e 7369 7374 7320 6f66 2074 6865   consists of the
-0000a190: 2073 616d 6520 6461 7461 7365 7420 6964   same dataset id
-0000a1a0: 732c 2062 7574 2066 6f75 6e64 2046 616c  s, but found Fal
-0000a1b0: 7365 2e22 0a20 2020 2020 2020 2020 2020  se.".           
-0000a1c0: 2020 2020 2020 2020 2020 2020 2029 0a0a               )..
+00009eb0: 2020 2020 2020 2020 2072 616e 646f 6d5f           random_
+00009ec0: 7374 6174 653d 7261 6e64 6f6d 5f73 7461  state=random_sta
+00009ed0: 7465 2c0a 2020 2020 2020 2020 2020 2020  te,.            
+00009ee0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00009ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009f00: 2020 2020 2020 706f 6c69 6379 5f76 616c        policy_val
+00009f10: 7565 5f69 6e74 6572 7661 6c5f 6469 6374  ue_interval_dict
+00009f20: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
+00009f30: 2020 2020 2020 2020 2020 2020 2020 6265                be
+00009f40: 6861 7669 6f72 5f70 6f6c 6963 790a 2020  havior_policy.  
+00009f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009f60: 2020 2020 2020 5d20 3d20 706f 6c69 6379        ] = policy
+00009f70: 5f76 616c 7565 5f69 6e74 6572 7661 6c5f  _value_interval_
+00009f80: 6469 6374 5f0a 0a20 2020 2020 2020 2020  dict_..         
+00009f90: 2020 2020 2020 2065 6c69 6620 6265 6861         elif beha
+00009fa0: 7669 6f72 5f70 6f6c 6963 795f 6e61 6d65  vior_policy_name
+00009fb0: 2069 7320 6e6f 7420 4e6f 6e65 2061 6e64   is not None and
+00009fc0: 2064 6174 6173 6574 5f69 6420 6973 204e   dataset_id is N
+00009fd0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+00009fe0: 2020 2020 2020 2020 2069 6620 280a 2020           if (.  
+00009ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a000: 2020 2020 2020 7365 6c66 2e6d 756c 7469        self.multi
+0000a010: 706c 655f 6c6f 6767 6564 5f64 6174 6173  ple_logged_datas
+0000a020: 6574 2e6e 5f64 6174 6173 6574 735b 6265  et.n_datasets[be
+0000a030: 6861 7669 6f72 5f70 6f6c 6963 795f 6e61  havior_policy_na
+0000a040: 6d65 5d0a 2020 2020 2020 2020 2020 2020  me].            
+0000a050: 2020 2020 2020 2020 2020 2020 213d 2069              != i
+0000a060: 6e70 7574 5f64 6963 742e 6e5f 6461 7461  nput_dict.n_data
+0000a070: 7365 7473 5b62 6568 6176 696f 725f 706f  sets[behavior_po
+0000a080: 6c69 6379 5f6e 616d 655d 0a20 2020 2020  licy_name].     
+0000a090: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+0000a0a0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0000a0b0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+0000a0c0: 5661 6c75 6545 7272 6f72 280a 2020 2020  ValueError(.    
+0000a0d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a0e0: 2020 2020 2020 2020 2245 7870 6563 7465          "Expecte
+0000a0f0: 6420 7468 6174 206c 6f67 6765 6420 6461  d that logged da
+0000a100: 7461 7365 7473 2061 6e64 2069 6e70 7574  tasets and input
+0000a110: 2064 6963 7473 2063 6f6e 7369 7374 7320   dicts consists 
+0000a120: 6f66 2074 6865 2073 616d 6520 6461 7461  of the same data
+0000a130: 7365 7420 6964 732c 2062 7574 2066 6f75  set ids, but fou
+0000a140: 6e64 2046 616c 7365 2e22 0a20 2020 2020  nd False.".     
+0000a150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a160: 2020 2029 0a0a 2020 2020 2020 2020 2020     )..          
+0000a170: 2020 2020 2020 2020 2020 706f 6c69 6379            policy
+0000a180: 5f76 616c 7565 5f69 6e74 6572 7661 6c5f  _value_interval_
+0000a190: 6469 6374 203d 205b 5d0a 2020 2020 2020  dict = [].      
+0000a1a0: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+0000a1b0: 7220 6461 7461 7365 745f 6964 5f20 696e  r dataset_id_ in
+0000a1c0: 2072 616e 6765 280a 2020 2020 2020 2020   range(.        
 0000a1d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a1e0: 2020 2020 706f 6c69 6379 5f76 616c 7565      policy_value
-0000a1f0: 5f69 6e74 6572 7661 6c5f 6469 6374 203d  _interval_dict =
-0000a200: 205b 5d0a 2020 2020 2020 2020 2020 2020   [].            
-0000a210: 2020 2020 2020 2020 666f 7220 6461 7461          for data
-0000a220: 7365 745f 6964 5f20 696e 2072 616e 6765  set_id_ in range
-0000a230: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0000a240: 2020 2020 2020 2020 2020 696e 7075 745f            input_
-0000a250: 6469 6374 2e6e 5f64 6174 6173 6574 735b  dict.n_datasets[
-0000a260: 6265 6861 7669 6f72 5f70 6f6c 6963 795f  behavior_policy_
-0000a270: 6e61 6d65 5d0a 2020 2020 2020 2020 2020  name].          
-0000a280: 2020 2020 2020 2020 2020 293a 0a20 2020            ):.   
-0000a290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a2a0: 2020 2020 2073 656c 662e 5f72 6567 6973       self._regis
-0000a2b0: 7465 725f 6c6f 6767 6564 5f64 6174 6173  ter_logged_datas
-0000a2c0: 6574 280a 2020 2020 2020 2020 2020 2020  et(.            
-0000a2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a2e0: 6265 6861 7669 6f72 5f70 6f6c 6963 795f  behavior_policy_
-0000a2f0: 6e61 6d65 3d62 6568 6176 696f 725f 706f  name=behavior_po
-0000a300: 6c69 6379 5f6e 616d 652c 0a20 2020 2020  licy_name,.     
-0000a310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a320: 2020 2020 2020 2064 6174 6173 6574 5f69         dataset_i
-0000a330: 643d 6461 7461 7365 745f 6964 5f2c 0a20  d=dataset_id_,. 
-0000a340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a350: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0000a360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a370: 2069 6e70 7574 5f64 6963 745f 203d 2069   input_dict_ = i
-0000a380: 6e70 7574 5f64 6963 742e 6765 7428 0a20  nput_dict.get(. 
-0000a390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a3a0: 2020 2020 2020 2020 2020 2062 6568 6176             behav
-0000a3b0: 696f 725f 706f 6c69 6379 5f6e 616d 653d  ior_policy_name=
-0000a3c0: 6265 6861 7669 6f72 5f70 6f6c 6963 795f  behavior_policy_
-0000a3d0: 6e61 6d65 2c0a 2020 2020 2020 2020 2020  name,.          
-0000a3e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a3f0: 2020 6461 7461 7365 745f 6964 3d64 6174    dataset_id=dat
-0000a400: 6173 6574 5f69 645f 2c0a 2020 2020 2020  aset_id_,.      
+0000a1e0: 696e 7075 745f 6469 6374 2e6e 5f64 6174  input_dict.n_dat
+0000a1f0: 6173 6574 735b 6265 6861 7669 6f72 5f70  asets[behavior_p
+0000a200: 6f6c 6963 795f 6e61 6d65 5d0a 2020 2020  olicy_name].    
+0000a210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a220: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+0000a230: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0000a240: 5f72 6567 6973 7465 725f 6c6f 6767 6564  _register_logged
+0000a250: 5f64 6174 6173 6574 280a 2020 2020 2020  _dataset(.      
+0000a260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a270: 2020 2020 2020 6265 6861 7669 6f72 5f70        behavior_p
+0000a280: 6f6c 6963 795f 6e61 6d65 3d62 6568 6176  olicy_name=behav
+0000a290: 696f 725f 706f 6c69 6379 5f6e 616d 652c  ior_policy_name,
+0000a2a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000a2b0: 2020 2020 2020 2020 2020 2020 2064 6174               dat
+0000a2c0: 6173 6574 5f69 643d 6461 7461 7365 745f  aset_id=dataset_
+0000a2d0: 6964 5f2c 0a20 2020 2020 2020 2020 2020  id_,.           
+0000a2e0: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
+0000a2f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a300: 2020 2020 2020 2069 6e70 7574 5f64 6963         input_dic
+0000a310: 745f 203d 2069 6e70 7574 5f64 6963 742e  t_ = input_dict.
+0000a320: 6765 7428 0a20 2020 2020 2020 2020 2020  get(.           
+0000a330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a340: 2062 6568 6176 696f 725f 706f 6c69 6379   behavior_policy
+0000a350: 5f6e 616d 653d 6265 6861 7669 6f72 5f70  _name=behavior_p
+0000a360: 6f6c 6963 795f 6e61 6d65 2c0a 2020 2020  olicy_name,.    
+0000a370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a380: 2020 2020 2020 2020 6461 7461 7365 745f          dataset_
+0000a390: 6964 3d64 6174 6173 6574 5f69 645f 2c0a  id=dataset_id_,.
+0000a3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a3b0: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+0000a3c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a3d0: 2020 2070 6f6c 6963 795f 7661 6c75 655f     policy_value_
+0000a3e0: 696e 7465 7276 616c 5f64 6963 745f 203d  interval_dict_ =
+0000a3f0: 2073 656c 662e 5f65 7374 696d 6174 655f   self._estimate_
+0000a400: 696e 7465 7276 616c 7328 0a20 2020 2020  intervals(.     
 0000a410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a420: 2020 290a 0a20 2020 2020 2020 2020 2020    )..           
-0000a430: 2020 2020 2020 2020 2020 2020 2070 6f6c               pol
-0000a440: 6963 795f 7661 6c75 655f 696e 7465 7276  icy_value_interv
-0000a450: 616c 5f64 6963 745f 203d 2073 656c 662e  al_dict_ = self.
-0000a460: 5f65 7374 696d 6174 655f 696e 7465 7276  _estimate_interv
-0000a470: 616c 7328 0a20 2020 2020 2020 2020 2020  als(.           
+0000a420: 2020 2020 2020 2069 6e70 7574 5f64 6963         input_dic
+0000a430: 745f 2c0a 2020 2020 2020 2020 2020 2020  t_,.            
+0000a440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a450: 636f 6d70 6172 6564 5f65 7374 696d 6174  compared_estimat
+0000a460: 6f72 733d 636f 6d70 6172 6564 5f65 7374  ors=compared_est
+0000a470: 696d 6174 6f72 732c 0a20 2020 2020 2020  imators,.       
 0000a480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a490: 2069 6e70 7574 5f64 6963 745f 2c0a 2020   input_dict_,.  
-0000a4a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a4b0: 2020 2020 2020 2020 2020 636f 6d70 6172            compar
-0000a4c0: 6564 5f65 7374 696d 6174 6f72 733d 636f  ed_estimators=co
-0000a4d0: 6d70 6172 6564 5f65 7374 696d 6174 6f72  mpared_estimator
-0000a4e0: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
-0000a4f0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-0000a500: 6c70 6861 3d61 6c70 6861 2c0a 2020 2020  lpha=alpha,.    
+0000a490: 2020 2020 2061 6c70 6861 3d61 6c70 6861       alpha=alpha
+0000a4a0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0000a4b0: 2020 2020 2020 2020 2020 2020 2020 6369                ci
+0000a4c0: 3d63 692c 0a20 2020 2020 2020 2020 2020  =ci,.           
+0000a4d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a4e0: 206e 5f62 6f6f 7473 7472 6170 5f73 616d   n_bootstrap_sam
+0000a4f0: 706c 6573 3d6e 5f62 6f6f 7473 7472 6170  ples=n_bootstrap
+0000a500: 5f73 616d 706c 6573 2c0a 2020 2020 2020  _samples,.      
 0000a510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a520: 2020 2020 2020 2020 6369 3d63 692c 0a20          ci=ci,. 
-0000a530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a540: 2020 2020 2020 2020 2020 206e 5f62 6f6f             n_boo
-0000a550: 7473 7472 6170 5f73 616d 706c 6573 3d6e  tstrap_samples=n
-0000a560: 5f62 6f6f 7473 7472 6170 5f73 616d 706c  _bootstrap_sampl
-0000a570: 6573 2c0a 2020 2020 2020 2020 2020 2020  es,.            
-0000a580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a590: 7261 6e64 6f6d 5f73 7461 7465 3d72 616e  random_state=ran
-0000a5a0: 646f 6d5f 7374 6174 652c 0a20 2020 2020  dom_state,.     
-0000a5b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a5c0: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-0000a5d0: 2020 2020 2020 2020 2020 2020 2070 6f6c               pol
-0000a5e0: 6963 795f 7661 6c75 655f 696e 7465 7276  icy_value_interv
-0000a5f0: 616c 5f64 6963 742e 6170 7065 6e64 2870  al_dict.append(p
-0000a600: 6f6c 6963 795f 7661 6c75 655f 696e 7465  olicy_value_inte
-0000a610: 7276 616c 5f64 6963 745f 290a 0a20 2020  rval_dict_)..   
-0000a620: 2020 2020 2020 2020 2020 2020 2065 6c73               els
-0000a630: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-0000a640: 2020 2020 2020 2073 656c 662e 5f72 6567         self._reg
-0000a650: 6973 7465 725f 6c6f 6767 6564 5f64 6174  ister_logged_dat
-0000a660: 6173 6574 280a 2020 2020 2020 2020 2020  aset(.          
-0000a670: 2020 2020 2020 2020 2020 2020 2020 6265                be
-0000a680: 6861 7669 6f72 5f70 6f6c 6963 795f 6e61  havior_policy_na
-0000a690: 6d65 3d62 6568 6176 696f 725f 706f 6c69  me=behavior_poli
-0000a6a0: 6379 5f6e 616d 652c 2064 6174 6173 6574  cy_name, dataset
-0000a6b0: 5f69 643d 6461 7461 7365 745f 6964 0a20  _id=dataset_id. 
-0000a6c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a6d0: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-0000a6e0: 2020 2020 2020 2020 2069 6e70 7574 5f64           input_d
-0000a6f0: 6963 745f 203d 2069 6e70 7574 5f64 6963  ict_ = input_dic
-0000a700: 742e 6765 7428 0a20 2020 2020 2020 2020  t.get(.         
-0000a710: 2020 2020 2020 2020 2020 2020 2020 2062                 b
-0000a720: 6568 6176 696f 725f 706f 6c69 6379 5f6e  ehavior_policy_n
-0000a730: 616d 653d 6265 6861 7669 6f72 5f70 6f6c  ame=behavior_pol
-0000a740: 6963 795f 6e61 6d65 2c20 6461 7461 7365  icy_name, datase
-0000a750: 745f 6964 3d64 6174 6173 6574 5f69 640a  t_id=dataset_id.
+0000a520: 2020 2020 2020 7261 6e64 6f6d 5f73 7461        random_sta
+0000a530: 7465 3d72 616e 646f 6d5f 7374 6174 652c  te=random_state,
+0000a540: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000a550: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+0000a560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a570: 2020 2070 6f6c 6963 795f 7661 6c75 655f     policy_value_
+0000a580: 696e 7465 7276 616c 5f64 6963 742e 6170  interval_dict.ap
+0000a590: 7065 6e64 2870 6f6c 6963 795f 7661 6c75  pend(policy_valu
+0000a5a0: 655f 696e 7465 7276 616c 5f64 6963 745f  e_interval_dict_
+0000a5b0: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
+0000a5c0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0000a5d0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+0000a5e0: 662e 5f72 6567 6973 7465 725f 6c6f 6767  f._register_logg
+0000a5f0: 6564 5f64 6174 6173 6574 280a 2020 2020  ed_dataset(.    
+0000a600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a610: 2020 2020 6265 6861 7669 6f72 5f70 6f6c      behavior_pol
+0000a620: 6963 795f 6e61 6d65 3d62 6568 6176 696f  icy_name=behavio
+0000a630: 725f 706f 6c69 6379 5f6e 616d 652c 2064  r_policy_name, d
+0000a640: 6174 6173 6574 5f69 643d 6461 7461 7365  ataset_id=datase
+0000a650: 745f 6964 0a20 2020 2020 2020 2020 2020  t_id.           
+0000a660: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+0000a670: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0000a680: 6e70 7574 5f64 6963 745f 203d 2069 6e70  nput_dict_ = inp
+0000a690: 7574 5f64 6963 742e 6765 7428 0a20 2020  ut_dict.get(.   
+0000a6a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a6b0: 2020 2020 2062 6568 6176 696f 725f 706f       behavior_po
+0000a6c0: 6c69 6379 5f6e 616d 653d 6265 6861 7669  licy_name=behavi
+0000a6d0: 6f72 5f70 6f6c 6963 795f 6e61 6d65 2c20  or_policy_name, 
+0000a6e0: 6461 7461 7365 745f 6964 3d64 6174 6173  dataset_id=datas
+0000a6f0: 6574 5f69 640a 2020 2020 2020 2020 2020  et_id.          
+0000a700: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+0000a710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a720: 2070 6f6c 6963 795f 7661 6c75 655f 696e   policy_value_in
+0000a730: 7465 7276 616c 5f64 6963 7420 3d20 7365  terval_dict = se
+0000a740: 6c66 2e5f 6573 7469 6d61 7465 5f69 6e74  lf._estimate_int
+0000a750: 6572 7661 6c73 280a 2020 2020 2020 2020  ervals(.        
 0000a760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a770: 2020 2020 290a 0a20 2020 2020 2020 2020      )..         
-0000a780: 2020 2020 2020 2020 2020 2070 6f6c 6963             polic
-0000a790: 795f 7661 6c75 655f 696e 7465 7276 616c  y_value_interval
-0000a7a0: 5f64 6963 7420 3d20 7365 6c66 2e5f 6573  _dict = self._es
-0000a7b0: 7469 6d61 7465 5f69 6e74 6572 7661 6c73  timate_intervals
-0000a7c0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0000a7d0: 2020 2020 2020 2020 2020 696e 7075 745f            input_
-0000a7e0: 6469 6374 5f2c 0a20 2020 2020 2020 2020  dict_,.         
-0000a7f0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-0000a800: 6f6d 7061 7265 645f 6573 7469 6d61 746f  ompared_estimato
-0000a810: 7273 3d63 6f6d 7061 7265 645f 6573 7469  rs=compared_esti
-0000a820: 6d61 746f 7273 2c0a 2020 2020 2020 2020  mators,.        
-0000a830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a840: 616c 7068 613d 616c 7068 612c 0a20 2020  alpha=alpha,.   
-0000a850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a860: 2020 2020 2063 693d 6369 2c0a 2020 2020       ci=ci,.    
-0000a870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a880: 2020 2020 6e5f 626f 6f74 7374 7261 705f      n_bootstrap_
-0000a890: 7361 6d70 6c65 733d 6e5f 626f 6f74 7374  samples=n_bootst
-0000a8a0: 7261 705f 7361 6d70 6c65 732c 0a20 2020  rap_samples,.   
-0000a8b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a8c0: 2020 2020 2072 616e 646f 6d5f 7374 6174       random_stat
-0000a8d0: 653d 7261 6e64 6f6d 5f73 7461 7465 2c0a  e=random_state,.
-0000a8e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a8f0: 2020 2020 290a 0a20 2020 2020 2020 2020      )..         
-0000a900: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0000a910: 2020 2020 2020 2020 2062 6568 6176 696f           behavio
-0000a920: 725f 706f 6c69 6379 5f6e 616d 6520 3d20  r_policy_name = 
-0000a930: 6c69 7374 2869 6e70 7574 5f64 6963 742e  list(input_dict.
-0000a940: 7661 6c75 6573 2829 295b 305d 5b22 6265  values())[0]["be
-0000a950: 6861 7669 6f72 5f70 6f6c 6963 7922 5d0a  havior_policy"].
-0000a960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a970: 6461 7461 7365 745f 6964 203d 206c 6973  dataset_id = lis
-0000a980: 7428 696e 7075 745f 6469 6374 2e76 616c  t(input_dict.val
-0000a990: 7565 7328 2929 5b30 5d5b 2264 6174 6173  ues())[0]["datas
-0000a9a0: 6574 5f69 6422 5d0a 0a20 2020 2020 2020  et_id"]..       
-0000a9b0: 2020 2020 2020 2020 2073 656c 662e 5f72           self._r
-0000a9c0: 6567 6973 7465 725f 6c6f 6767 6564 5f64  egister_logged_d
-0000a9d0: 6174 6173 6574 280a 2020 2020 2020 2020  ataset(.        
-0000a9e0: 2020 2020 2020 2020 2020 2020 6265 6861              beha
-0000a9f0: 7669 6f72 5f70 6f6c 6963 795f 6e61 6d65  vior_policy_name
-0000aa00: 3d62 6568 6176 696f 725f 706f 6c69 6379  =behavior_policy
-0000aa10: 5f6e 616d 652c 2064 6174 6173 6574 5f69  _name, dataset_i
-0000aa20: 643d 6461 7461 7365 745f 6964 0a20 2020  d=dataset_id.   
-0000aa30: 2020 2020 2020 2020 2020 2020 2029 0a0a               )..
+0000a770: 696e 7075 745f 6469 6374 5f2c 0a20 2020  input_dict_,.   
+0000a780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a790: 2020 2020 2063 6f6d 7061 7265 645f 6573       compared_es
+0000a7a0: 7469 6d61 746f 7273 3d63 6f6d 7061 7265  timators=compare
+0000a7b0: 645f 6573 7469 6d61 746f 7273 2c0a 2020  d_estimators,.  
+0000a7c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a7d0: 2020 2020 2020 616c 7068 613d 616c 7068        alpha=alph
+0000a7e0: 612c 0a20 2020 2020 2020 2020 2020 2020  a,.             
+0000a7f0: 2020 2020 2020 2020 2020 2063 693d 6369             ci=ci
+0000a800: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0000a810: 2020 2020 2020 2020 2020 6e5f 626f 6f74            n_boot
+0000a820: 7374 7261 705f 7361 6d70 6c65 733d 6e5f  strap_samples=n_
+0000a830: 626f 6f74 7374 7261 705f 7361 6d70 6c65  bootstrap_sample
+0000a840: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
+0000a850: 2020 2020 2020 2020 2020 2072 616e 646f             rando
+0000a860: 6d5f 7374 6174 653d 7261 6e64 6f6d 5f73  m_state=random_s
+0000a870: 7461 7465 2c0a 2020 2020 2020 2020 2020  tate,.          
+0000a880: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+0000a890: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+0000a8a0: 2020 2020 2020 2020 2020 2020 2020 2062                 b
+0000a8b0: 6568 6176 696f 725f 706f 6c69 6379 5f6e  ehavior_policy_n
+0000a8c0: 616d 6520 3d20 6c69 7374 2869 6e70 7574  ame = list(input
+0000a8d0: 5f64 6963 742e 7661 6c75 6573 2829 295b  _dict.values())[
+0000a8e0: 305d 5b22 6265 6861 7669 6f72 5f70 6f6c  0]["behavior_pol
+0000a8f0: 6963 7922 5d0a 2020 2020 2020 2020 2020  icy"].          
+0000a900: 2020 2020 2020 6461 7461 7365 745f 6964        dataset_id
+0000a910: 203d 206c 6973 7428 696e 7075 745f 6469   = list(input_di
+0000a920: 6374 2e76 616c 7565 7328 2929 5b30 5d5b  ct.values())[0][
+0000a930: 2264 6174 6173 6574 5f69 6422 5d0a 0a20  "dataset_id"].. 
+0000a940: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0000a950: 656c 662e 5f72 6567 6973 7465 725f 6c6f  elf._register_lo
+0000a960: 6767 6564 5f64 6174 6173 6574 280a 2020  gged_dataset(.  
+0000a970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a980: 2020 6265 6861 7669 6f72 5f70 6f6c 6963    behavior_polic
+0000a990: 795f 6e61 6d65 3d62 6568 6176 696f 725f  y_name=behavior_
+0000a9a0: 706f 6c69 6379 5f6e 616d 652c 2064 6174  policy_name, dat
+0000a9b0: 6173 6574 5f69 643d 6461 7461 7365 745f  aset_id=dataset_
+0000a9c0: 6964 0a20 2020 2020 2020 2020 2020 2020  id.             
+0000a9d0: 2020 2029 0a0a 2020 2020 2020 2020 2020     )..          
+0000a9e0: 2020 2020 2020 706f 6c69 6379 5f76 616c        policy_val
+0000a9f0: 7565 5f69 6e74 6572 7661 6c5f 6469 6374  ue_interval_dict
+0000aa00: 203d 2073 656c 662e 5f65 7374 696d 6174   = self._estimat
+0000aa10: 655f 696e 7465 7276 616c 7328 0a20 2020  e_intervals(.   
+0000aa20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000aa30: 2069 6e70 7574 5f64 6963 742c 0a20 2020   input_dict,.   
 0000aa40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000aa50: 706f 6c69 6379 5f76 616c 7565 5f69 6e74  policy_value_int
-0000aa60: 6572 7661 6c5f 6469 6374 203d 2073 656c  erval_dict = sel
-0000aa70: 662e 5f65 7374 696d 6174 655f 696e 7465  f._estimate_inte
-0000aa80: 7276 616c 7328 0a20 2020 2020 2020 2020  rvals(.         
-0000aa90: 2020 2020 2020 2020 2020 2069 6e70 7574             input
-0000aaa0: 5f64 6963 742c 0a20 2020 2020 2020 2020  _dict,.         
-0000aab0: 2020 2020 2020 2020 2020 2063 6f6d 7061             compa
-0000aac0: 7265 645f 6573 7469 6d61 746f 7273 3d63  red_estimators=c
-0000aad0: 6f6d 7061 7265 645f 6573 7469 6d61 746f  ompared_estimato
-0000aae0: 7273 2c0a 2020 2020 2020 2020 2020 2020  rs,.            
-0000aaf0: 2020 2020 2020 2020 616c 7068 613d 616c          alpha=al
-0000ab00: 7068 612c 0a20 2020 2020 2020 2020 2020  pha,.           
-0000ab10: 2020 2020 2020 2020 2063 693d 6369 2c0a           ci=ci,.
-0000ab20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ab30: 2020 2020 6e5f 626f 6f74 7374 7261 705f      n_bootstrap_
-0000ab40: 7361 6d70 6c65 733d 6e5f 626f 6f74 7374  samples=n_bootst
-0000ab50: 7261 705f 7361 6d70 6c65 732c 0a20 2020  rap_samples,.   
-0000ab60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ab70: 2072 616e 646f 6d5f 7374 6174 653d 7261   random_state=ra
-0000ab80: 6e64 6f6d 5f73 7461 7465 2c0a 2020 2020  ndom_state,.    
-0000ab90: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-0000aba0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-0000abb0: 2020 2020 2020 2020 2069 6620 6973 696e           if isin
-0000abc0: 7374 616e 6365 2869 6e70 7574 5f64 6963  stance(input_dic
-0000abd0: 742c 204d 756c 7469 706c 6549 6e70 7574  t, MultipleInput
-0000abe0: 4469 6374 293a 0a20 2020 2020 2020 2020  Dict):.         
-0000abf0: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
-0000ac00: 7565 4572 726f 7228 0a20 2020 2020 2020  ueError(.       
-0000ac10: 2020 2020 2020 2020 2020 2020 2022 7768               "wh
-0000ac20: 656e 2075 7369 6e67 204c 6f67 6765 6444  en using LoggedD
-0000ac30: 6174 6173 6574 2c20 706c 6561 7365 2075  ataset, please u
-0000ac40: 7365 2049 6e70 7574 4469 6374 2069 6e73  se InputDict ins
-0000ac50: 7465 6164 206f 6620 4d75 6c74 6970 6c65  tead of Multiple
-0000ac60: 496e 7075 7444 6963 7422 0a20 2020 2020  InputDict".     
-0000ac70: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
-0000ac80: 2020 2020 2020 2020 2020 706f 6c69 6379            policy
-0000ac90: 5f76 616c 7565 5f69 6e74 6572 7661 6c5f  _value_interval_
-0000aca0: 6469 6374 203d 2073 656c 662e 5f65 7374  dict = self._est
-0000acb0: 696d 6174 655f 696e 7465 7276 616c 7328  imate_intervals(
-0000acc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000acd0: 2069 6e70 7574 5f64 6963 742c 0a20 2020   input_dict,.   
-0000ace0: 2020 2020 2020 2020 2020 2020 2063 6f6d               com
-0000acf0: 7061 7265 645f 6573 7469 6d61 746f 7273  pared_estimators
-0000ad00: 3d63 6f6d 7061 7265 645f 6573 7469 6d61  =compared_estima
-0000ad10: 746f 7273 2c0a 2020 2020 2020 2020 2020  tors,.          
-0000ad20: 2020 2020 2020 616c 7068 613d 616c 7068        alpha=alph
-0000ad30: 612c 0a20 2020 2020 2020 2020 2020 2020  a,.             
-0000ad40: 2020 2063 693d 6369 2c0a 2020 2020 2020     ci=ci,.      
-0000ad50: 2020 2020 2020 2020 2020 6e5f 626f 6f74            n_boot
-0000ad60: 7374 7261 705f 7361 6d70 6c65 733d 6e5f  strap_samples=n_
-0000ad70: 626f 6f74 7374 7261 705f 7361 6d70 6c65  bootstrap_sample
-0000ad80: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
-0000ad90: 2020 2072 616e 646f 6d5f 7374 6174 653d     random_state=
-0000ada0: 7261 6e64 6f6d 5f73 7461 7465 2c0a 2020  random_state,.  
-0000adb0: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
-0000adc0: 2020 2020 2072 6574 7572 6e20 706f 6c69       return poli
-0000add0: 6379 5f76 616c 7565 5f69 6e74 6572 7661  cy_value_interva
-0000ade0: 6c5f 6469 6374 0a0a 2020 2020 6465 6620  l_dict..    def 
-0000adf0: 7375 6d6d 6172 697a 655f 6f66 665f 706f  summarize_off_po
-0000ae00: 6c69 6379 5f65 7374 696d 6174 6573 280a  licy_estimates(.
-0000ae10: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-0000ae20: 2020 2020 2020 696e 7075 745f 6469 6374        input_dict
-0000ae30: 3a20 556e 696f 6e5b 4f50 4549 6e70 7574  : Union[OPEInput
-0000ae40: 4469 6374 2c20 4d75 6c74 6970 6c65 496e  Dict, MultipleIn
-0000ae50: 7075 7444 6963 745d 2c0a 2020 2020 2020  putDict],.      
-0000ae60: 2020 636f 6d70 6172 6564 5f65 7374 696d    compared_estim
-0000ae70: 6174 6f72 733a 204f 7074 696f 6e61 6c5b  ators: Optional[
-0000ae80: 4c69 7374 5b73 7472 5d5d 203d 204e 6f6e  List[str]] = Non
-0000ae90: 652c 0a20 2020 2020 2020 2062 6568 6176  e,.        behav
-0000aea0: 696f 725f 706f 6c69 6379 5f6e 616d 653a  ior_policy_name:
-0000aeb0: 204f 7074 696f 6e61 6c5b 7374 725d 203d   Optional[str] =
-0000aec0: 204e 6f6e 652c 0a20 2020 2020 2020 2064   None,.        d
-0000aed0: 6174 6173 6574 5f69 643a 204f 7074 696f  ataset_id: Optio
-0000aee0: 6e61 6c5b 696e 745d 203d 204e 6f6e 652c  nal[int] = None,
-0000aef0: 0a20 2020 2020 2020 2061 6c70 6861 3a20  .        alpha: 
-0000af00: 666c 6f61 7420 3d20 302e 3035 2c0a 2020  float = 0.05,.  
-0000af10: 2020 2020 2020 6369 3a20 7374 7220 3d20        ci: str = 
-0000af20: 2262 6f6f 7473 7472 6170 222c 0a20 2020  "bootstrap",.   
-0000af30: 2020 2020 206e 5f62 6f6f 7473 7472 6170       n_bootstrap
-0000af40: 5f73 616d 706c 6573 3a20 696e 7420 3d20  _samples: int = 
-0000af50: 3130 302c 0a20 2020 2020 2020 2072 616e  100,.        ran
-0000af60: 646f 6d5f 7374 6174 653a 204f 7074 696f  dom_state: Optio
-0000af70: 6e61 6c5b 696e 745d 203d 204e 6f6e 652c  nal[int] = None,
-0000af80: 0a20 2020 2029 202d 3e20 5475 706c 655b  .    ) -> Tuple[
-0000af90: 4469 6374 5b73 7472 2c20 4461 7461 4672  Dict[str, DataFr
-0000afa0: 616d 655d 2c20 4469 6374 5b73 7472 2c20  ame], Dict[str, 
-0000afb0: 4461 7461 4672 616d 655d 5d3a 0a20 2020  DataFrame]]:.   
-0000afc0: 2020 2020 2022 2222 5375 6d6d 6172 697a       """Summariz
-0000afd0: 6520 7468 6520 706f 6c69 6379 2076 616c  e the policy val
-0000afe0: 7565 2061 6e64 2074 6865 6972 2063 6f6e  ue and their con
-0000aff0: 6669 6465 6e63 6520 696e 7465 7276 616c  fidence interval
-0000b000: 7320 6573 7469 6d61 7465 6420 6279 204f  s estimated by O
-0000b010: 5045 2065 7374 696d 6174 6f72 732e 0a0a  PE estimators...
-0000b020: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
-0000b030: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
-0000b040: 2d2d 0a20 2020 2020 2020 2069 6e70 7574  --.        input
-0000b050: 5f64 6963 743a 204f 5045 496e 7075 7444  _dict: OPEInputD
-0000b060: 6963 7420 6f72 204d 756c 7469 706c 6549  ict or MultipleI
-0000b070: 6e70 7574 4469 6374 0a20 2020 2020 2020  nputDict.       
-0000b080: 2020 2020 2044 6963 7469 6f6e 6172 7920       Dictionary 
-0000b090: 6f66 2074 6865 204f 5045 2069 6e70 7574  of the OPE input
-0000b0a0: 7320 666f 7220 6561 6368 2065 7661 6c75  s for each evalu
-0000b0b0: 6174 696f 6e20 706f 6c69 6379 2e0a 0a20  ation policy... 
-0000b0c0: 2020 2020 2020 2020 2020 202e 2e20 636f             .. co
-0000b0d0: 6465 2d62 6c6f 636b 3a3a 2070 7974 686f  de-block:: pytho
-0000b0e0: 6e0a 0a20 2020 2020 2020 2020 2020 2020  n..             
-0000b0f0: 2020 206b 6579 3a20 5b65 7661 6c75 6174     key: [evaluat
-0000b100: 696f 6e5f 706f 6c69 6379 5d5b 0a20 2020  ion_policy][.   
-0000b110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b120: 2065 7661 6c75 6174 696f 6e5f 706f 6c69   evaluation_poli
-0000b130: 6379 5f61 6374 696f 6e2c 0a20 2020 2020  cy_action,.     
-0000b140: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0000b150: 7661 6c75 6174 696f 6e5f 706f 6c69 6379  valuation_policy
-0000b160: 5f61 6374 696f 6e5f 6469 7374 2c0a 2020  _action_dist,.  
-0000b170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b180: 2020 7374 6174 655f 6163 7469 6f6e 5f76    state_action_v
-0000b190: 616c 7565 5f70 7265 6469 6374 696f 6e2c  alue_prediction,
-0000b1a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000b1b0: 2020 2020 2069 6e69 7469 616c 5f73 7461       initial_sta
-0000b1c0: 7465 5f76 616c 7565 5f70 7265 6469 6374  te_value_predict
-0000b1d0: 696f 6e2c 0a20 2020 2020 2020 2020 2020  ion,.           
-0000b1e0: 2020 2020 2020 2020 2073 7461 7465 5f61           state_a
-0000b1f0: 6374 696f 6e5f 6d61 7267 696e 616c 5f69  ction_marginal_i
-0000b200: 6d70 6f72 7461 6e63 655f 7765 6967 6874  mportance_weight
-0000b210: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000b220: 2020 2020 2020 7374 6174 655f 6d61 7267        state_marg
-0000b230: 696e 616c 5f69 6d70 6f72 7461 6e63 655f  inal_importance_
-0000b240: 7765 6967 6874 2c0a 2020 2020 2020 2020  weight,.        
-0000b250: 2020 2020 2020 2020 2020 2020 6f6e 5f70              on_p
-0000b260: 6f6c 6963 795f 706f 6c69 6379 5f76 616c  olicy_policy_val
-0000b270: 7565 2c0a 2020 2020 2020 2020 2020 2020  ue,.            
-0000b280: 2020 2020 2020 2020 6761 6d6d 612c 0a20          gamma,. 
-0000b290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b2a0: 2020 2062 6568 6176 696f 725f 706f 6c69     behavior_poli
-0000b2b0: 6379 2c0a 2020 2020 2020 2020 2020 2020  cy,.            
-0000b2c0: 2020 2020 2020 2020 6576 616c 7561 7469          evaluati
-0000b2d0: 6f6e 5f70 6f6c 6963 792c 0a20 2020 2020  on_policy,.     
-0000b2e0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-0000b2f0: 6174 6173 6574 5f69 642c 0a20 2020 2020  ataset_id,.     
-0000b300: 2020 2020 2020 2020 2020 205d 0a0a 2020             ]..  
-0000b310: 2020 2020 2020 2020 2020 2e2e 2073 6565            .. see
-0000b320: 616c 736f 3a3a 0a0a 2020 2020 2020 2020  also::..        
-0000b330: 2020 2020 2020 2020 3a63 6c61 7373 3a60          :class:`
-0000b340: 7363 6f70 655f 726c 2e6f 7065 2e69 6e70  scope_rl.ope.inp
-0000b350: 7574 2e43 7265 6174 654f 5045 496e 7075  ut.CreateOPEInpu
-0000b360: 7460 2064 6573 6372 6962 6573 2074 6865  t` describes the
-0000b370: 2063 6f6d 706f 6e65 6e74 7320 6f66 203a   components of :
-0000b380: 636c 6173 733a 6069 6e70 7574 5f64 6963  class:`input_dic
-0000b390: 7460 2e0a 0a20 2020 2020 2020 2063 6f6d  t`...        com
-0000b3a0: 7061 7265 645f 6573 7469 6d61 746f 7273  pared_estimators
-0000b3b0: 3a20 6c69 7374 206f 6620 7374 722c 2064  : list of str, d
-0000b3c0: 6566 6175 6c74 3d4e 6f6e 650a 2020 2020  efault=None.    
-0000b3d0: 2020 2020 2020 2020 4e61 6d65 206f 6620          Name of 
-0000b3e0: 636f 6d70 6172 6564 2065 7374 696d 6174  compared estimat
-0000b3f0: 6f72 732e 0a20 2020 2020 2020 2020 2020  ors..           
-0000b400: 2049 6620 604e 6f6e 6560 2069 7320 6769   If `None` is gi
-0000b410: 7665 6e2c 2061 6c6c 2074 6865 2065 7374  ven, all the est
-0000b420: 696d 6174 6f72 7320 6172 6520 636f 6d70  imators are comp
-0000b430: 6172 6564 2e0a 0a20 2020 2020 2020 2062  ared...        b
-0000b440: 6568 6176 696f 725f 706f 6c69 6379 5f6e  ehavior_policy_n
-0000b450: 616d 653a 2073 7472 2c20 6465 6661 756c  ame: str, defaul
-0000b460: 743d 4e6f 6e65 0a20 2020 2020 2020 2020  t=None.         
-0000b470: 2020 204e 616d 6520 6f66 2074 6865 2062     Name of the b
-0000b480: 6568 6176 696f 7220 706f 6c69 6379 2e0a  ehavior policy..
-0000b490: 0a20 2020 2020 2020 2064 6174 6173 6574  .        dataset
-0000b4a0: 5f69 643a 2069 6e74 2c20 6465 6661 756c  _id: int, defaul
-0000b4b0: 743d 4e6f 6e65 0a20 2020 2020 2020 2020  t=None.         
-0000b4c0: 2020 2049 6420 6f66 2074 6865 206c 6f67     Id of the log
-0000b4d0: 6765 6420 6461 7461 7365 742e 0a0a 2020  ged dataset...  
-0000b4e0: 2020 2020 2020 616c 7068 613a 2066 6c6f        alpha: flo
-0000b4f0: 6174 2c20 6465 6661 756c 743d 302e 3035  at, default=0.05
-0000b500: 0a20 2020 2020 2020 2020 2020 2053 6967  .            Sig
-0000b510: 6e69 6669 6361 6e63 6520 6c65 7665 6c2e  nificance level.
-0000b520: 2054 6865 2076 616c 7565 2073 686f 756c   The value shoul
-0000b530: 6420 6265 2077 6974 6869 6e20 605b 302c  d be within `[0,
-0000b540: 2031 2960 2e0a 0a20 2020 2020 2020 206e   1)`...        n
-0000b550: 5f62 6f6f 7473 7472 6170 5f73 616d 706c  _bootstrap_sampl
-0000b560: 6573 3a20 696e 742c 2064 6566 6175 6c74  es: int, default
-0000b570: 3d31 3030 3030 2028 3e20 3029 0a20 2020  =10000 (> 0).   
-0000b580: 2020 2020 2020 2020 204e 756d 6265 7220           Number 
-0000b590: 6f66 2072 6573 616d 706c 696e 6720 7065  of resampling pe
-0000b5a0: 7266 6f72 6d65 6420 696e 2074 6865 2062  rformed in the b
-0000b5b0: 6f6f 7473 7472 6170 2070 726f 6365 6475  ootstrap procedu
-0000b5c0: 7265 2e0a 0a20 2020 2020 2020 2063 693a  re...        ci:
-0000b5d0: 207b 2262 6f6f 7473 7472 6170 222c 2022   {"bootstrap", "
-0000b5e0: 686f 6566 6664 696e 6722 2c20 2262 6572  hoeffding", "ber
-0000b5f0: 6e73 7465 696e 222c 2022 7474 6573 7422  nstein", "ttest"
-0000b600: 7d2c 2064 6566 6175 6c74 3d22 626f 6f74  }, default="boot
-0000b610: 7374 7261 7022 0a20 2020 2020 2020 2020  strap".         
-0000b620: 2020 204d 6574 686f 6420 746f 2065 7374     Method to est
-0000b630: 696d 6174 6520 7468 6520 636f 6e66 6964  imate the confid
-0000b640: 656e 6365 2069 6e74 6572 7661 6c2e 0a0a  ence interval...
-0000b650: 2020 2020 2020 2020 7261 6e64 6f6d 5f73          random_s
-0000b660: 7461 7465 3a20 696e 742c 2064 6566 6175  tate: int, defau
-0000b670: 6c74 3d4e 6f6e 6520 283e 3d20 3029 0a20  lt=None (>= 0). 
-0000b680: 2020 2020 2020 2020 2020 2052 616e 646f             Rando
-0000b690: 6d20 7374 6174 652e 0a0a 2020 2020 2020  m state...      
-0000b6a0: 2020 5265 7475 726e 0a20 2020 2020 2020    Return.       
-0000b6b0: 202d 2d2d 2d2d 2d2d 0a20 2020 2020 2020   -------.       
-0000b6c0: 2070 6f6c 6963 795f 7661 6c75 655f 6466   policy_value_df
-0000b6d0: 5f64 6963 743a 2064 6963 7420 282c 206c  _dict: dict (, l
-0000b6e0: 6973 7420 6f66 2064 6963 7429 0a20 2020  ist of dict).   
-0000b6f0: 2020 2020 2020 2020 2044 6963 7469 6f6e           Diction
-0000b700: 6172 7920 636f 6e74 6169 6e69 6e67 2074  ary containing t
-0000b710: 6865 2070 6f6c 6963 7920 7661 6c75 6520  he policy value 
-0000b720: 6f66 2065 6163 6820 6576 616c 7561 7469  of each evaluati
-0000b730: 6f6e 2070 6f6c 6963 7920 6573 7469 6d61  on policy estima
-0000b740: 7465 6420 6279 204f 5045 2065 7374 696d  ted by OPE estim
-0000b750: 6174 6f72 732e 0a20 2020 2020 2020 2020  ators..         
-0000b760: 2020 206b 6579 3a20 3a63 6c61 7373 3a60     key: :class:`
-0000b770: 5b65 7661 6c75 6174 696f 6e5f 706f 6c69  [evaluation_poli
-0000b780: 6379 5d5b 4f50 455f 6573 7469 6d61 746f  cy][OPE_estimato
-0000b790: 725f 6e61 6d65 5d60 0a0a 2020 2020 2020  r_name]`..      
-0000b7a0: 2020 2020 2020 5768 656e 2062 6568 6176        When behav
-0000b7b0: 696f 725f 706f 6c69 6379 5f6e 616d 6520  ior_policy_name 
-0000b7c0: 6973 2060 4e6f 6e65 6020 616e 6420 6461  is `None` and da
-0000b7d0: 7461 7365 745f 6964 2069 7320 604e 6f6e  taset_id is `Non
-0000b7e0: 6560 2c0a 2020 2020 2020 2020 2020 2020  e`,.            
-0000b7f0: 6b65 793a 203a 636c 6173 733a 605b 6265  key: :class:`[be
-0000b800: 6861 7669 6f72 5f70 6f6c 6963 795f 6e61  havior_policy_na
-0000b810: 6d65 5d5b 6461 7461 7365 745f 6964 5d5b  me][dataset_id][
-0000b820: 6576 616c 7561 7469 6f6e 5f70 6f6c 6963  evaluation_polic
-0000b830: 795d 5b4f 5045 5f65 7374 696d 6174 6f72  y][OPE_estimator
-0000b840: 5f6e 616d 655d 600a 0a20 2020 2020 2020  _name]`..       
-0000b850: 2020 2020 2057 6865 6e20 6265 6861 7669       When behavi
-0000b860: 6f72 5f70 6f6c 6963 795f 6e61 6d65 2069  or_policy_name i
-0000b870: 7320 604e 6f6e 6560 2061 6e64 2064 6174  s `None` and dat
-0000b880: 6173 6574 5f69 6420 6973 2073 7065 6369  aset_id is speci
-0000b890: 6669 6564 2c0a 2020 2020 2020 2020 2020  fied,.          
-0000b8a0: 2020 6b65 793a 203a 636c 6173 733a 605b    key: :class:`[
-0000b8b0: 6265 6861 7669 6f72 5f70 6f6c 6963 795f  behavior_policy_
-0000b8c0: 6e61 6d65 5d5b 6576 616c 7561 7469 6f6e  name][evaluation
-0000b8d0: 5f70 6f6c 6963 795d 5b4f 5045 5f65 7374  _policy][OPE_est
-0000b8e0: 696d 6174 6f72 5f6e 616d 655d 600a 0a20  imator_name]`.. 
-0000b8f0: 2020 2020 2020 2020 2020 2057 6865 6e20             When 
-0000b900: 6265 6861 7669 6f72 5f70 6f6c 6963 795f  behavior_policy_
-0000b910: 6e61 6d65 2069 7320 7370 6563 6966 6965  name is specifie
-0000b920: 6420 616e 6420 6461 7461 7365 745f 6964  d and dataset_id
-0000b930: 2069 7320 604e 6f6e 6560 2c0a 2020 2020   is `None`,.    
-0000b940: 2020 2020 2020 2020 6b65 793a 203a 636c          key: :cl
-0000b950: 6173 733a 605b 6461 7461 7365 745f 6964  ass:`[dataset_id
-0000b960: 5d5b 4f50 455f 6573 7469 6d61 746f 725f  ][OPE_estimator_
-0000b970: 6e61 6d65 5d60 0a0a 2020 2020 2020 2020  name]`..        
-0000b980: 706f 6c69 6379 5f76 616c 7565 5f69 6e74  policy_value_int
-0000b990: 6572 7661 6c5f 6466 5f64 6963 743a 2064  erval_df_dict: d
-0000b9a0: 6963 7420 282c 206c 6973 7420 6f66 2064  ict (, list of d
-0000b9b0: 6963 7429 0a20 2020 2020 2020 2020 2020  ict).           
-0000b9c0: 2044 6963 7469 6f6e 6172 7920 636f 6e74   Dictionary cont
-0000b9d0: 6169 6e69 6e67 2074 6865 2063 6f6e 6669  aining the confi
-0000b9e0: 6465 6e63 6520 696e 7465 7276 616c 7320  dence intervals 
-0000b9f0: 6573 7469 6d61 7465 6420 6279 206e 6f6e  estimated by non
-0000ba00: 7061 7261 6d65 7472 6963 2062 6f6f 7473  parametric boots
-0000ba10: 7472 6170 2e0a 2020 2020 2020 2020 2020  trap..          
-0000ba20: 2020 6b65 793a 203a 636c 6173 733a 605b    key: :class:`[
-0000ba30: 6576 616c 7561 7469 6f6e 5f70 6f6c 6963  evaluation_polic
-0000ba40: 795d 5b4f 5045 5f65 7374 696d 6174 6f72  y][OPE_estimator
-0000ba50: 5f6e 616d 655d 600a 0a20 2020 2020 2020  _name]`..       
-0000ba60: 2020 2020 2057 6865 6e20 6265 6861 7669       When behavi
-0000ba70: 6f72 5f70 6f6c 6963 795f 6e61 6d65 2069  or_policy_name i
-0000ba80: 7320 604e 6f6e 6560 2061 6e64 2064 6174  s `None` and dat
-0000ba90: 6173 6574 5f69 6420 6973 2060 4e6f 6e65  aset_id is `None
-0000baa0: 602c 0a20 2020 2020 2020 2020 2020 206b  `,.            k
-0000bab0: 6579 3a20 3a63 6c61 7373 3a60 5b62 6568  ey: :class:`[beh
-0000bac0: 6176 696f 725f 706f 6c69 6379 5f6e 616d  avior_policy_nam
-0000bad0: 655d 5b64 6174 6173 6574 5f69 645d 5b65  e][dataset_id][e
-0000bae0: 7661 6c75 6174 696f 6e5f 706f 6c69 6379  valuation_policy
-0000baf0: 5d5b 4f50 455f 6573 7469 6d61 746f 725f  ][OPE_estimator_
-0000bb00: 6e61 6d65 5d60 0a0a 2020 2020 2020 2020  name]`..        
-0000bb10: 2020 2020 5768 656e 2062 6568 6176 696f      When behavio
-0000bb20: 725f 706f 6c69 6379 5f6e 616d 6520 6973  r_policy_name is
-0000bb30: 2060 4e6f 6e65 6020 616e 6420 6461 7461   `None` and data
-0000bb40: 7365 745f 6964 2069 7320 7370 6563 6966  set_id is specif
-0000bb50: 6965 642c 0a20 2020 2020 2020 2020 2020  ied,.           
-0000bb60: 206b 6579 3a20 3a63 6c61 7373 3a60 5b62   key: :class:`[b
-0000bb70: 6568 6176 696f 725f 706f 6c69 6379 5f6e  ehavior_policy_n
-0000bb80: 616d 655d 5b65 7661 6c75 6174 696f 6e5f  ame][evaluation_
-0000bb90: 706f 6c69 6379 5d5b 4f50 455f 6573 7469  policy][OPE_esti
-0000bba0: 6d61 746f 725f 6e61 6d65 5d60 0a0a 2020  mator_name]`..  
-0000bbb0: 2020 2020 2020 2020 2020 5768 656e 2062            When b
-0000bbc0: 6568 6176 696f 725f 706f 6c69 6379 5f6e  ehavior_policy_n
-0000bbd0: 616d 6520 6973 2073 7065 6369 6669 6564  ame is specified
-0000bbe0: 2061 6e64 2064 6174 6173 6574 5f69 6420   and dataset_id 
-0000bbf0: 6973 2060 4e6f 6e65 602c 0a20 2020 2020  is `None`,.     
-0000bc00: 2020 2020 2020 206b 6579 3a20 3a63 6c61         key: :cla
-0000bc10: 7373 3a60 5b64 6174 6173 6574 5f69 645d  ss:`[dataset_id]
-0000bc20: 5b4f 5045 5f65 7374 696d 6174 6f72 5f6e  [OPE_estimator_n
-0000bc30: 616d 655d 600a 0a20 2020 2020 2020 2022  ame]`..        "
-0000bc40: 2222 0a20 2020 2020 2020 2070 6f6c 6963  "".        polic
-0000bc50: 795f 7661 6c75 655f 6469 6374 203d 2073  y_value_dict = s
-0000bc60: 656c 662e 6573 7469 6d61 7465 5f70 6f6c  elf.estimate_pol
-0000bc70: 6963 795f 7661 6c75 6528 0a20 2020 2020  icy_value(.     
-0000bc80: 2020 2020 2020 2069 6e70 7574 5f64 6963         input_dic
-0000bc90: 742c 0a20 2020 2020 2020 2020 2020 2063  t,.            c
-0000bca0: 6f6d 7061 7265 645f 6573 7469 6d61 746f  ompared_estimato
-0000bcb0: 7273 3d63 6f6d 7061 7265 645f 6573 7469  rs=compared_esti
-0000bcc0: 6d61 746f 7273 2c0a 2020 2020 2020 2020  mators,.        
-0000bcd0: 2020 2020 6265 6861 7669 6f72 5f70 6f6c      behavior_pol
-0000bce0: 6963 795f 6e61 6d65 3d62 6568 6176 696f  icy_name=behavio
-0000bcf0: 725f 706f 6c69 6379 5f6e 616d 652c 0a20  r_policy_name,. 
-0000bd00: 2020 2020 2020 2020 2020 2064 6174 6173             datas
-0000bd10: 6574 5f69 643d 6461 7461 7365 745f 6964  et_id=dataset_id
-0000bd20: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
-0000bd30: 2020 2020 706f 6c69 6379 5f76 616c 7565      policy_value
-0000bd40: 5f69 6e74 6572 7661 6c5f 6469 6374 203d  _interval_dict =
-0000bd50: 2073 656c 662e 6573 7469 6d61 7465 5f69   self.estimate_i
-0000bd60: 6e74 6572 7661 6c73 280a 2020 2020 2020  ntervals(.      
-0000bd70: 2020 2020 2020 696e 7075 745f 6469 6374        input_dict
-0000bd80: 2c0a 2020 2020 2020 2020 2020 2020 636f  ,.            co
-0000bd90: 6d70 6172 6564 5f65 7374 696d 6174 6f72  mpared_estimator
-0000bda0: 733d 636f 6d70 6172 6564 5f65 7374 696d  s=compared_estim
-0000bdb0: 6174 6f72 732c 0a20 2020 2020 2020 2020  ators,.         
-0000bdc0: 2020 2062 6568 6176 696f 725f 706f 6c69     behavior_poli
-0000bdd0: 6379 5f6e 616d 653d 6265 6861 7669 6f72  cy_name=behavior
-0000bde0: 5f70 6f6c 6963 795f 6e61 6d65 2c0a 2020  _policy_name,.  
-0000bdf0: 2020 2020 2020 2020 2020 6461 7461 7365            datase
-0000be00: 745f 6964 3d64 6174 6173 6574 5f69 642c  t_id=dataset_id,
-0000be10: 0a20 2020 2020 2020 2020 2020 2061 6c70  .            alp
-0000be20: 6861 3d61 6c70 6861 2c0a 2020 2020 2020  ha=alpha,.      
-0000be30: 2020 2020 2020 6369 3d63 692c 0a20 2020        ci=ci,.   
-0000be40: 2020 2020 2020 2020 206e 5f62 6f6f 7473           n_boots
-0000be50: 7472 6170 5f73 616d 706c 6573 3d6e 5f62  trap_samples=n_b
-0000be60: 6f6f 7473 7472 6170 5f73 616d 706c 6573  ootstrap_samples
-0000be70: 2c0a 2020 2020 2020 2020 2020 2020 7261  ,.            ra
-0000be80: 6e64 6f6d 5f73 7461 7465 3d72 616e 646f  ndom_state=rando
-0000be90: 6d5f 7374 6174 652c 0a20 2020 2020 2020  m_state,.       
-0000bea0: 2029 0a0a 2020 2020 2020 2020 706f 6c69   )..        poli
-0000beb0: 6379 5f76 616c 7565 5f64 665f 6469 6374  cy_value_df_dict
-0000bec0: 203d 204e 6f6e 650a 2020 2020 2020 2020   = None.        
-0000bed0: 706f 6c69 6379 5f76 616c 7565 5f69 6e74  policy_value_int
-0000bee0: 6572 7661 6c5f 6466 5f64 6963 7420 3d20  erval_df_dict = 
-0000bef0: 4e6f 6e65 0a0a 2020 2020 2020 2020 6966  None..        if
-0000bf00: 2073 656c 662e 7573 655f 6d75 6c74 6970   self.use_multip
-0000bf10: 6c65 5f6c 6f67 6765 645f 6461 7461 7365  le_logged_datase
-0000bf20: 743a 0a20 2020 2020 2020 2020 2020 2069  t:.            i
-0000bf30: 6620 6973 696e 7374 616e 6365 2869 6e70  f isinstance(inp
-0000bf40: 7574 5f64 6963 742c 204d 756c 7469 706c  ut_dict, Multipl
-0000bf50: 6549 6e70 7574 4469 6374 293a 0a20 2020  eInputDict):.   
-0000bf60: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-0000bf70: 6265 6861 7669 6f72 5f70 6f6c 6963 795f  behavior_policy_
-0000bf80: 6e61 6d65 2069 7320 4e6f 6e65 2061 6e64  name is None and
-0000bf90: 2064 6174 6173 6574 5f69 6420 6973 204e   dataset_id is N
-0000bfa0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-0000bfb0: 2020 2020 2020 2020 2070 6f6c 6963 795f           policy_
-0000bfc0: 7661 6c75 655f 6466 5f64 6963 7420 3d20  value_df_dict = 
-0000bfd0: 6465 6661 756c 7464 6963 7428 6c69 7374  defaultdict(list
-0000bfe0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0000bff0: 2020 2020 2020 706f 6c69 6379 5f76 616c        policy_val
-0000c000: 7565 5f69 6e74 6572 7661 6c5f 6466 5f64  ue_interval_df_d
-0000c010: 6963 7420 3d20 6465 6661 756c 7464 6963  ict = defaultdic
-0000c020: 7428 6c69 7374 290a 0a20 2020 2020 2020  t(list)..       
-0000c030: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-0000c040: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
-0000c050: 2020 2020 2020 2020 2020 2062 6568 6176             behav
-0000c060: 696f 725f 706f 6c69 6379 2c0a 2020 2020  ior_policy,.    
-0000c070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c080: 2020 2020 6e5f 6461 7461 7365 7473 2c0a      n_datasets,.
-0000c090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c0a0: 2020 2020 2920 696e 2069 6e70 7574 5f64      ) in input_d
-0000c0b0: 6963 742e 6e5f 6461 7461 7365 7473 2e69  ict.n_datasets.i
-0000c0c0: 7465 6d73 2829 3a0a 2020 2020 2020 2020  tems():.        
-0000c0d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c0e0: 666f 7220 6461 7461 7365 745f 6964 5f20  for dataset_id_ 
-0000c0f0: 696e 2072 616e 6765 286e 5f64 6174 6173  in range(n_datas
-0000c100: 6574 7329 3a0a 2020 2020 2020 2020 2020  ets):.          
-0000c110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c120: 2020 280a 2020 2020 2020 2020 2020 2020    (.            
-0000c130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c140: 2020 2020 706f 6c69 6379 5f76 616c 7565      policy_value
-0000c150: 5f64 665f 6469 6374 5f2c 0a20 2020 2020  _df_dict_,.     
-0000c160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c170: 2020 2020 2020 2020 2020 2070 6f6c 6963             polic
-0000c180: 795f 7661 6c75 655f 696e 7465 7276 616c  y_value_interval
-0000c190: 5f64 665f 6469 6374 5f2c 0a20 2020 2020  _df_dict_,.     
-0000c1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c1b0: 2020 2020 2020 2029 203d 2073 656c 662e         ) = self.
-0000c1c0: 5f73 756d 6d61 7269 7a65 5f6f 6666 5f70  _summarize_off_p
-0000c1d0: 6f6c 6963 795f 6573 7469 6d61 7465 7328  olicy_estimates(
-0000c1e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000c1f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c200: 2070 6f6c 6963 795f 7661 6c75 655f 6469   policy_value_di
-0000c210: 6374 3d70 6f6c 6963 795f 7661 6c75 655f  ct=policy_value_
-0000c220: 6469 6374 5b62 6568 6176 696f 725f 706f  dict[behavior_po
-0000c230: 6c69 6379 5d5b 0a20 2020 2020 2020 2020  licy][.         
-0000c240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c250: 2020 2020 2020 2020 2020 2064 6174 6173             datas
-0000c260: 6574 5f69 645f 0a20 2020 2020 2020 2020  et_id_.         
-0000c270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c280: 2020 2020 2020 205d 2c0a 2020 2020 2020         ],.      
-0000c290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c2a0: 2020 2020 2020 2020 2020 706f 6c69 6379            policy
-0000c2b0: 5f76 616c 7565 5f69 6e74 6572 7661 6c5f  _value_interval_
-0000c2c0: 6469 6374 3d70 6f6c 6963 795f 7661 6c75  dict=policy_valu
-0000c2d0: 655f 696e 7465 7276 616c 5f64 6963 745b  e_interval_dict[
-0000c2e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000c2f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c300: 2020 2020 2062 6568 6176 696f 725f 706f       behavior_po
-0000c310: 6c69 6379 0a20 2020 2020 2020 2020 2020  licy.           
-0000c320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c330: 2020 2020 205d 5b64 6174 6173 6574 5f69       ][dataset_i
-0000c340: 645f 5d2c 0a20 2020 2020 2020 2020 2020  d_],.           
+0000aa50: 2063 6f6d 7061 7265 645f 6573 7469 6d61   compared_estima
+0000aa60: 746f 7273 3d63 6f6d 7061 7265 645f 6573  tors=compared_es
+0000aa70: 7469 6d61 746f 7273 2c0a 2020 2020 2020  timators,.      
+0000aa80: 2020 2020 2020 2020 2020 2020 2020 616c                al
+0000aa90: 7068 613d 616c 7068 612c 0a20 2020 2020  pha=alpha,.     
+0000aaa0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+0000aab0: 693d 6369 2c0a 2020 2020 2020 2020 2020  i=ci,.          
+0000aac0: 2020 2020 2020 2020 2020 6e5f 626f 6f74            n_boot
+0000aad0: 7374 7261 705f 7361 6d70 6c65 733d 6e5f  strap_samples=n_
+0000aae0: 626f 6f74 7374 7261 705f 7361 6d70 6c65  bootstrap_sample
+0000aaf0: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
+0000ab00: 2020 2020 2020 2072 616e 646f 6d5f 7374         random_st
+0000ab10: 6174 653d 7261 6e64 6f6d 5f73 7461 7465  ate=random_state
+0000ab20: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0000ab30: 2020 290a 0a20 2020 2020 2020 2065 6c73    )..        els
+0000ab40: 653a 0a20 2020 2020 2020 2020 2020 2069  e:.            i
+0000ab50: 6620 6973 696e 7374 616e 6365 2869 6e70  f isinstance(inp
+0000ab60: 7574 5f64 6963 742c 204d 756c 7469 706c  ut_dict, Multipl
+0000ab70: 6549 6e70 7574 4469 6374 293a 0a20 2020  eInputDict):.   
+0000ab80: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+0000ab90: 7365 2056 616c 7565 4572 726f 7228 0a20  se ValueError(. 
+0000aba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000abb0: 2020 2022 7768 656e 2075 7369 6e67 204c     "when using L
+0000abc0: 6f67 6765 6444 6174 6173 6574 2c20 706c  oggedDataset, pl
+0000abd0: 6561 7365 2075 7365 2049 6e70 7574 4469  ease use InputDi
+0000abe0: 6374 2069 6e73 7465 6164 206f 6620 4d75  ct instead of Mu
+0000abf0: 6c74 6970 6c65 496e 7075 7444 6963 7422  ltipleInputDict"
+0000ac00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000ac10: 2029 0a0a 2020 2020 2020 2020 2020 2020   )..            
+0000ac20: 706f 6c69 6379 5f76 616c 7565 5f69 6e74  policy_value_int
+0000ac30: 6572 7661 6c5f 6469 6374 203d 2073 656c  erval_dict = sel
+0000ac40: 662e 5f65 7374 696d 6174 655f 696e 7465  f._estimate_inte
+0000ac50: 7276 616c 7328 0a20 2020 2020 2020 2020  rvals(.         
+0000ac60: 2020 2020 2020 2069 6e70 7574 5f64 6963         input_dic
+0000ac70: 742c 0a20 2020 2020 2020 2020 2020 2020  t,.             
+0000ac80: 2020 2063 6f6d 7061 7265 645f 6573 7469     compared_esti
+0000ac90: 6d61 746f 7273 3d63 6f6d 7061 7265 645f  mators=compared_
+0000aca0: 6573 7469 6d61 746f 7273 2c0a 2020 2020  estimators,.    
+0000acb0: 2020 2020 2020 2020 2020 2020 616c 7068              alph
+0000acc0: 613d 616c 7068 612c 0a20 2020 2020 2020  a=alpha,.       
+0000acd0: 2020 2020 2020 2020 2063 693d 6369 2c0a           ci=ci,.
+0000ace0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000acf0: 6e5f 626f 6f74 7374 7261 705f 7361 6d70  n_bootstrap_samp
+0000ad00: 6c65 733d 6e5f 626f 6f74 7374 7261 705f  les=n_bootstrap_
+0000ad10: 7361 6d70 6c65 732c 0a20 2020 2020 2020  samples,.       
+0000ad20: 2020 2020 2020 2020 2072 616e 646f 6d5f           random_
+0000ad30: 7374 6174 653d 7261 6e64 6f6d 5f73 7461  state=random_sta
+0000ad40: 7465 2c0a 2020 2020 2020 2020 2020 2020  te,.            
+0000ad50: 290a 0a20 2020 2020 2020 2072 6574 7572  )..        retur
+0000ad60: 6e20 706f 6c69 6379 5f76 616c 7565 5f69  n policy_value_i
+0000ad70: 6e74 6572 7661 6c5f 6469 6374 0a0a 2020  nterval_dict..  
+0000ad80: 2020 6465 6620 7375 6d6d 6172 697a 655f    def summarize_
+0000ad90: 6f66 665f 706f 6c69 6379 5f65 7374 696d  off_policy_estim
+0000ada0: 6174 6573 280a 2020 2020 2020 2020 7365  ates(.        se
+0000adb0: 6c66 2c0a 2020 2020 2020 2020 696e 7075  lf,.        inpu
+0000adc0: 745f 6469 6374 3a20 556e 696f 6e5b 4f50  t_dict: Union[OP
+0000add0: 4549 6e70 7574 4469 6374 2c20 4d75 6c74  EInputDict, Mult
+0000ade0: 6970 6c65 496e 7075 7444 6963 745d 2c0a  ipleInputDict],.
+0000adf0: 2020 2020 2020 2020 636f 6d70 6172 6564          compared
+0000ae00: 5f65 7374 696d 6174 6f72 733a 204f 7074  _estimators: Opt
+0000ae10: 696f 6e61 6c5b 4c69 7374 5b73 7472 5d5d  ional[List[str]]
+0000ae20: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
+0000ae30: 2062 6568 6176 696f 725f 706f 6c69 6379   behavior_policy
+0000ae40: 5f6e 616d 653a 204f 7074 696f 6e61 6c5b  _name: Optional[
+0000ae50: 7374 725d 203d 204e 6f6e 652c 0a20 2020  str] = None,.   
+0000ae60: 2020 2020 2064 6174 6173 6574 5f69 643a       dataset_id:
+0000ae70: 204f 7074 696f 6e61 6c5b 696e 745d 203d   Optional[int] =
+0000ae80: 204e 6f6e 652c 0a20 2020 2020 2020 2061   None,.        a
+0000ae90: 6c70 6861 3a20 666c 6f61 7420 3d20 302e  lpha: float = 0.
+0000aea0: 3035 2c0a 2020 2020 2020 2020 6369 3a20  05,.        ci: 
+0000aeb0: 7374 7220 3d20 2262 6f6f 7473 7472 6170  str = "bootstrap
+0000aec0: 222c 0a20 2020 2020 2020 206e 5f62 6f6f  ",.        n_boo
+0000aed0: 7473 7472 6170 5f73 616d 706c 6573 3a20  tstrap_samples: 
+0000aee0: 696e 7420 3d20 3130 302c 0a20 2020 2020  int = 100,.     
+0000aef0: 2020 2072 616e 646f 6d5f 7374 6174 653a     random_state:
+0000af00: 204f 7074 696f 6e61 6c5b 696e 745d 203d   Optional[int] =
+0000af10: 204e 6f6e 652c 0a20 2020 2029 202d 3e20   None,.    ) -> 
+0000af20: 5475 706c 655b 4469 6374 5b73 7472 2c20  Tuple[Dict[str, 
+0000af30: 4461 7461 4672 616d 655d 2c20 4469 6374  DataFrame], Dict
+0000af40: 5b73 7472 2c20 4461 7461 4672 616d 655d  [str, DataFrame]
+0000af50: 5d3a 0a20 2020 2020 2020 2022 2222 5375  ]:.        """Su
+0000af60: 6d6d 6172 697a 6520 7468 6520 706f 6c69  mmarize the poli
+0000af70: 6379 2076 616c 7565 2061 6e64 2074 6865  cy value and the
+0000af80: 6972 2063 6f6e 6669 6465 6e63 6520 696e  ir confidence in
+0000af90: 7465 7276 616c 7320 6573 7469 6d61 7465  tervals estimate
+0000afa0: 6420 6279 204f 5045 2065 7374 696d 6174  d by OPE estimat
+0000afb0: 6f72 732e 0a0a 2020 2020 2020 2020 5061  ors...        Pa
+0000afc0: 7261 6d65 7465 7273 0a20 2020 2020 2020  rameters.       
+0000afd0: 202d 2d2d 2d2d 2d2d 0a20 2020 2020 2020   -------.       
+0000afe0: 2069 6e70 7574 5f64 6963 743a 204f 5045   input_dict: OPE
+0000aff0: 496e 7075 7444 6963 7420 6f72 204d 756c  InputDict or Mul
+0000b000: 7469 706c 6549 6e70 7574 4469 6374 0a20  tipleInputDict. 
+0000b010: 2020 2020 2020 2020 2020 2044 6963 7469             Dicti
+0000b020: 6f6e 6172 7920 6f66 2074 6865 204f 5045  onary of the OPE
+0000b030: 2069 6e70 7574 7320 666f 7220 6561 6368   inputs for each
+0000b040: 2065 7661 6c75 6174 696f 6e20 706f 6c69   evaluation poli
+0000b050: 6379 2e0a 0a20 2020 2020 2020 2020 2020  cy...           
+0000b060: 202e 2e20 636f 6465 2d62 6c6f 636b 3a3a   .. code-block::
+0000b070: 2070 7974 686f 6e0a 0a20 2020 2020 2020   python..       
+0000b080: 2020 2020 2020 2020 206b 6579 3a20 5b65           key: [e
+0000b090: 7661 6c75 6174 696f 6e5f 706f 6c69 6379  valuation_policy
+0000b0a0: 5d5b 0a20 2020 2020 2020 2020 2020 2020  ][.             
+0000b0b0: 2020 2020 2020 2065 7661 6c75 6174 696f         evaluatio
+0000b0c0: 6e5f 706f 6c69 6379 5f61 6374 696f 6e2c  n_policy_action,
+0000b0d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000b0e0: 2020 2020 2065 7661 6c75 6174 696f 6e5f       evaluation_
+0000b0f0: 706f 6c69 6379 5f61 6374 696f 6e5f 6469  policy_action_di
+0000b100: 7374 2c0a 2020 2020 2020 2020 2020 2020  st,.            
+0000b110: 2020 2020 2020 2020 7374 6174 655f 6163          state_ac
+0000b120: 7469 6f6e 5f76 616c 7565 5f70 7265 6469  tion_value_predi
+0000b130: 6374 696f 6e2c 0a20 2020 2020 2020 2020  ction,.         
+0000b140: 2020 2020 2020 2020 2020 2069 6e69 7469             initi
+0000b150: 616c 5f73 7461 7465 5f76 616c 7565 5f70  al_state_value_p
+0000b160: 7265 6469 6374 696f 6e2c 0a20 2020 2020  rediction,.     
+0000b170: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0000b180: 7461 7465 5f61 6374 696f 6e5f 6d61 7267  tate_action_marg
+0000b190: 696e 616c 5f69 6d70 6f72 7461 6e63 655f  inal_importance_
+0000b1a0: 7765 6967 6874 2c0a 2020 2020 2020 2020  weight,.        
+0000b1b0: 2020 2020 2020 2020 2020 2020 7374 6174              stat
+0000b1c0: 655f 6d61 7267 696e 616c 5f69 6d70 6f72  e_marginal_impor
+0000b1d0: 7461 6e63 655f 7765 6967 6874 2c0a 2020  tance_weight,.  
+0000b1e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b1f0: 2020 6f6e 5f70 6f6c 6963 795f 706f 6c69    on_policy_poli
+0000b200: 6379 5f76 616c 7565 2c0a 2020 2020 2020  cy_value,.      
+0000b210: 2020 2020 2020 2020 2020 2020 2020 6761                ga
+0000b220: 6d6d 612c 0a20 2020 2020 2020 2020 2020  mma,.           
+0000b230: 2020 2020 2020 2020 2062 6568 6176 696f           behavio
+0000b240: 725f 706f 6c69 6379 2c0a 2020 2020 2020  r_policy,.      
+0000b250: 2020 2020 2020 2020 2020 2020 2020 6576                ev
+0000b260: 616c 7561 7469 6f6e 5f70 6f6c 6963 792c  aluation_policy,
+0000b270: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000b280: 2020 2020 2064 6174 6173 6574 5f69 642c       dataset_id,
+0000b290: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000b2a0: 205d 0a0a 2020 2020 2020 2020 2020 2020   ]..            
+0000b2b0: 2e2e 2073 6565 616c 736f 3a3a 0a0a 2020  .. seealso::..  
+0000b2c0: 2020 2020 2020 2020 2020 2020 2020 3a63                :c
+0000b2d0: 6c61 7373 3a60 7363 6f70 655f 726c 2e6f  lass:`scope_rl.o
+0000b2e0: 7065 2e69 6e70 7574 2e43 7265 6174 654f  pe.input.CreateO
+0000b2f0: 5045 496e 7075 7460 2064 6573 6372 6962  PEInput` describ
+0000b300: 6573 2074 6865 2063 6f6d 706f 6e65 6e74  es the component
+0000b310: 7320 6f66 203a 636c 6173 733a 6069 6e70  s of :class:`inp
+0000b320: 7574 5f64 6963 7460 2e0a 0a20 2020 2020  ut_dict`...     
+0000b330: 2020 2063 6f6d 7061 7265 645f 6573 7469     compared_esti
+0000b340: 6d61 746f 7273 3a20 6c69 7374 206f 6620  mators: list of 
+0000b350: 7374 722c 2064 6566 6175 6c74 3d4e 6f6e  str, default=Non
+0000b360: 650a 2020 2020 2020 2020 2020 2020 4e61  e.            Na
+0000b370: 6d65 206f 6620 636f 6d70 6172 6564 2065  me of compared e
+0000b380: 7374 696d 6174 6f72 732e 0a20 2020 2020  stimators..     
+0000b390: 2020 2020 2020 2049 6620 604e 6f6e 6560         If `None`
+0000b3a0: 2069 7320 6769 7665 6e2c 2061 6c6c 2074   is given, all t
+0000b3b0: 6865 2065 7374 696d 6174 6f72 7320 6172  he estimators ar
+0000b3c0: 6520 636f 6d70 6172 6564 2e0a 0a20 2020  e compared...   
+0000b3d0: 2020 2020 2062 6568 6176 696f 725f 706f       behavior_po
+0000b3e0: 6c69 6379 5f6e 616d 653a 2073 7472 2c20  licy_name: str, 
+0000b3f0: 6465 6661 756c 743d 4e6f 6e65 0a20 2020  default=None.   
+0000b400: 2020 2020 2020 2020 204e 616d 6520 6f66           Name of
+0000b410: 2074 6865 2062 6568 6176 696f 7220 706f   the behavior po
+0000b420: 6c69 6379 2e0a 0a20 2020 2020 2020 2064  licy...        d
+0000b430: 6174 6173 6574 5f69 643a 2069 6e74 2c20  ataset_id: int, 
+0000b440: 6465 6661 756c 743d 4e6f 6e65 0a20 2020  default=None.   
+0000b450: 2020 2020 2020 2020 2049 6420 6f66 2074           Id of t
+0000b460: 6865 206c 6f67 6765 6420 6461 7461 7365  he logged datase
+0000b470: 742e 0a0a 2020 2020 2020 2020 616c 7068  t...        alph
+0000b480: 613a 2066 6c6f 6174 2c20 6465 6661 756c  a: float, defaul
+0000b490: 743d 302e 3035 0a20 2020 2020 2020 2020  t=0.05.         
+0000b4a0: 2020 2053 6967 6e69 6669 6361 6e63 6520     Significance 
+0000b4b0: 6c65 7665 6c2e 2054 6865 2076 616c 7565  level. The value
+0000b4c0: 2073 686f 756c 6420 6265 2077 6974 6869   should be withi
+0000b4d0: 6e20 605b 302c 2031 2960 2e0a 0a20 2020  n `[0, 1)`...   
+0000b4e0: 2020 2020 206e 5f62 6f6f 7473 7472 6170       n_bootstrap
+0000b4f0: 5f73 616d 706c 6573 3a20 696e 742c 2064  _samples: int, d
+0000b500: 6566 6175 6c74 3d31 3030 3030 2028 3e20  efault=10000 (> 
+0000b510: 3029 0a20 2020 2020 2020 2020 2020 204e  0).            N
+0000b520: 756d 6265 7220 6f66 2072 6573 616d 706c  umber of resampl
+0000b530: 696e 6720 7065 7266 6f72 6d65 6420 696e  ing performed in
+0000b540: 2074 6865 2062 6f6f 7473 7472 6170 2070   the bootstrap p
+0000b550: 726f 6365 6475 7265 2e0a 0a20 2020 2020  rocedure...     
+0000b560: 2020 2063 693a 207b 2262 6f6f 7473 7472     ci: {"bootstr
+0000b570: 6170 222c 2022 686f 6566 6664 696e 6722  ap", "hoeffding"
+0000b580: 2c20 2262 6572 6e73 7465 696e 222c 2022  , "bernstein", "
+0000b590: 7474 6573 7422 7d2c 2064 6566 6175 6c74  ttest"}, default
+0000b5a0: 3d22 626f 6f74 7374 7261 7022 0a20 2020  ="bootstrap".   
+0000b5b0: 2020 2020 2020 2020 204d 6574 686f 6420           Method 
+0000b5c0: 746f 2065 7374 696d 6174 6520 7468 6520  to estimate the 
+0000b5d0: 636f 6e66 6964 656e 6365 2069 6e74 6572  confidence inter
+0000b5e0: 7661 6c2e 0a0a 2020 2020 2020 2020 7261  val...        ra
+0000b5f0: 6e64 6f6d 5f73 7461 7465 3a20 696e 742c  ndom_state: int,
+0000b600: 2064 6566 6175 6c74 3d4e 6f6e 6520 283e   default=None (>
+0000b610: 3d20 3029 0a20 2020 2020 2020 2020 2020  = 0).           
+0000b620: 2052 616e 646f 6d20 7374 6174 652e 0a0a   Random state...
+0000b630: 2020 2020 2020 2020 5265 7475 726e 0a20          Return. 
+0000b640: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0a20         -------. 
+0000b650: 2020 2020 2020 2070 6f6c 6963 795f 7661         policy_va
+0000b660: 6c75 655f 6466 5f64 6963 743a 2064 6963  lue_df_dict: dic
+0000b670: 7420 282c 206c 6973 7420 6f66 2064 6963  t (, list of dic
+0000b680: 7429 0a20 2020 2020 2020 2020 2020 2044  t).            D
+0000b690: 6963 7469 6f6e 6172 7920 636f 6e74 6169  ictionary contai
+0000b6a0: 6e69 6e67 2074 6865 2070 6f6c 6963 7920  ning the policy 
+0000b6b0: 7661 6c75 6520 6f66 2065 6163 6820 6576  value of each ev
+0000b6c0: 616c 7561 7469 6f6e 2070 6f6c 6963 7920  aluation policy 
+0000b6d0: 6573 7469 6d61 7465 6420 6279 204f 5045  estimated by OPE
+0000b6e0: 2065 7374 696d 6174 6f72 732e 0a20 2020   estimators..   
+0000b6f0: 2020 2020 2020 2020 206b 6579 3a20 3a63           key: :c
+0000b700: 6c61 7373 3a60 5b65 7661 6c75 6174 696f  lass:`[evaluatio
+0000b710: 6e5f 706f 6c69 6379 5d5b 4f50 455f 6573  n_policy][OPE_es
+0000b720: 7469 6d61 746f 725f 6e61 6d65 5d60 0a0a  timator_name]`..
+0000b730: 2020 2020 2020 2020 2020 2020 5768 656e              When
+0000b740: 2062 6568 6176 696f 725f 706f 6c69 6379   behavior_policy
+0000b750: 5f6e 616d 6520 6973 2060 4e6f 6e65 6020  _name is `None` 
+0000b760: 616e 6420 6461 7461 7365 745f 6964 2069  and dataset_id i
+0000b770: 7320 604e 6f6e 6560 2c0a 2020 2020 2020  s `None`,.      
+0000b780: 2020 2020 2020 6b65 793a 203a 636c 6173        key: :clas
+0000b790: 733a 605b 6265 6861 7669 6f72 5f70 6f6c  s:`[behavior_pol
+0000b7a0: 6963 795f 6e61 6d65 5d5b 6461 7461 7365  icy_name][datase
+0000b7b0: 745f 6964 5d5b 6576 616c 7561 7469 6f6e  t_id][evaluation
+0000b7c0: 5f70 6f6c 6963 795d 5b4f 5045 5f65 7374  _policy][OPE_est
+0000b7d0: 696d 6174 6f72 5f6e 616d 655d 600a 0a20  imator_name]`.. 
+0000b7e0: 2020 2020 2020 2020 2020 2057 6865 6e20             When 
+0000b7f0: 6265 6861 7669 6f72 5f70 6f6c 6963 795f  behavior_policy_
+0000b800: 6e61 6d65 2069 7320 604e 6f6e 6560 2061  name is `None` a
+0000b810: 6e64 2064 6174 6173 6574 5f69 6420 6973  nd dataset_id is
+0000b820: 2073 7065 6369 6669 6564 2c0a 2020 2020   specified,.    
+0000b830: 2020 2020 2020 2020 6b65 793a 203a 636c          key: :cl
+0000b840: 6173 733a 605b 6265 6861 7669 6f72 5f70  ass:`[behavior_p
+0000b850: 6f6c 6963 795f 6e61 6d65 5d5b 6576 616c  olicy_name][eval
+0000b860: 7561 7469 6f6e 5f70 6f6c 6963 795d 5b4f  uation_policy][O
+0000b870: 5045 5f65 7374 696d 6174 6f72 5f6e 616d  PE_estimator_nam
+0000b880: 655d 600a 0a20 2020 2020 2020 2020 2020  e]`..           
+0000b890: 2057 6865 6e20 6265 6861 7669 6f72 5f70   When behavior_p
+0000b8a0: 6f6c 6963 795f 6e61 6d65 2069 7320 7370  olicy_name is sp
+0000b8b0: 6563 6966 6965 6420 616e 6420 6461 7461  ecified and data
+0000b8c0: 7365 745f 6964 2069 7320 604e 6f6e 6560  set_id is `None`
+0000b8d0: 2c0a 2020 2020 2020 2020 2020 2020 6b65  ,.            ke
+0000b8e0: 793a 203a 636c 6173 733a 605b 6461 7461  y: :class:`[data
+0000b8f0: 7365 745f 6964 5d5b 4f50 455f 6573 7469  set_id][OPE_esti
+0000b900: 6d61 746f 725f 6e61 6d65 5d60 0a0a 2020  mator_name]`..  
+0000b910: 2020 2020 2020 706f 6c69 6379 5f76 616c        policy_val
+0000b920: 7565 5f69 6e74 6572 7661 6c5f 6466 5f64  ue_interval_df_d
+0000b930: 6963 743a 2064 6963 7420 282c 206c 6973  ict: dict (, lis
+0000b940: 7420 6f66 2064 6963 7429 0a20 2020 2020  t of dict).     
+0000b950: 2020 2020 2020 2044 6963 7469 6f6e 6172         Dictionar
+0000b960: 7920 636f 6e74 6169 6e69 6e67 2074 6865  y containing the
+0000b970: 2063 6f6e 6669 6465 6e63 6520 696e 7465   confidence inte
+0000b980: 7276 616c 7320 6573 7469 6d61 7465 6420  rvals estimated 
+0000b990: 6279 206e 6f6e 7061 7261 6d65 7472 6963  by nonparametric
+0000b9a0: 2062 6f6f 7473 7472 6170 2e0a 2020 2020   bootstrap..    
+0000b9b0: 2020 2020 2020 2020 6b65 793a 203a 636c          key: :cl
+0000b9c0: 6173 733a 605b 6576 616c 7561 7469 6f6e  ass:`[evaluation
+0000b9d0: 5f70 6f6c 6963 795d 5b4f 5045 5f65 7374  _policy][OPE_est
+0000b9e0: 696d 6174 6f72 5f6e 616d 655d 600a 0a20  imator_name]`.. 
+0000b9f0: 2020 2020 2020 2020 2020 2057 6865 6e20             When 
+0000ba00: 6265 6861 7669 6f72 5f70 6f6c 6963 795f  behavior_policy_
+0000ba10: 6e61 6d65 2069 7320 604e 6f6e 6560 2061  name is `None` a
+0000ba20: 6e64 2064 6174 6173 6574 5f69 6420 6973  nd dataset_id is
+0000ba30: 2060 4e6f 6e65 602c 0a20 2020 2020 2020   `None`,.       
+0000ba40: 2020 2020 206b 6579 3a20 3a63 6c61 7373       key: :class
+0000ba50: 3a60 5b62 6568 6176 696f 725f 706f 6c69  :`[behavior_poli
+0000ba60: 6379 5f6e 616d 655d 5b64 6174 6173 6574  cy_name][dataset
+0000ba70: 5f69 645d 5b65 7661 6c75 6174 696f 6e5f  _id][evaluation_
+0000ba80: 706f 6c69 6379 5d5b 4f50 455f 6573 7469  policy][OPE_esti
+0000ba90: 6d61 746f 725f 6e61 6d65 5d60 0a0a 2020  mator_name]`..  
+0000baa0: 2020 2020 2020 2020 2020 5768 656e 2062            When b
+0000bab0: 6568 6176 696f 725f 706f 6c69 6379 5f6e  ehavior_policy_n
+0000bac0: 616d 6520 6973 2060 4e6f 6e65 6020 616e  ame is `None` an
+0000bad0: 6420 6461 7461 7365 745f 6964 2069 7320  d dataset_id is 
+0000bae0: 7370 6563 6966 6965 642c 0a20 2020 2020  specified,.     
+0000baf0: 2020 2020 2020 206b 6579 3a20 3a63 6c61         key: :cla
+0000bb00: 7373 3a60 5b62 6568 6176 696f 725f 706f  ss:`[behavior_po
+0000bb10: 6c69 6379 5f6e 616d 655d 5b65 7661 6c75  licy_name][evalu
+0000bb20: 6174 696f 6e5f 706f 6c69 6379 5d5b 4f50  ation_policy][OP
+0000bb30: 455f 6573 7469 6d61 746f 725f 6e61 6d65  E_estimator_name
+0000bb40: 5d60 0a0a 2020 2020 2020 2020 2020 2020  ]`..            
+0000bb50: 5768 656e 2062 6568 6176 696f 725f 706f  When behavior_po
+0000bb60: 6c69 6379 5f6e 616d 6520 6973 2073 7065  licy_name is spe
+0000bb70: 6369 6669 6564 2061 6e64 2064 6174 6173  cified and datas
+0000bb80: 6574 5f69 6420 6973 2060 4e6f 6e65 602c  et_id is `None`,
+0000bb90: 0a20 2020 2020 2020 2020 2020 206b 6579  .            key
+0000bba0: 3a20 3a63 6c61 7373 3a60 5b64 6174 6173  : :class:`[datas
+0000bbb0: 6574 5f69 645d 5b4f 5045 5f65 7374 696d  et_id][OPE_estim
+0000bbc0: 6174 6f72 5f6e 616d 655d 600a 0a20 2020  ator_name]`..   
+0000bbd0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0000bbe0: 2070 6f6c 6963 795f 7661 6c75 655f 6469   policy_value_di
+0000bbf0: 6374 203d 2073 656c 662e 6573 7469 6d61  ct = self.estima
+0000bc00: 7465 5f70 6f6c 6963 795f 7661 6c75 6528  te_policy_value(
+0000bc10: 0a20 2020 2020 2020 2020 2020 2069 6e70  .            inp
+0000bc20: 7574 5f64 6963 742c 0a20 2020 2020 2020  ut_dict,.       
+0000bc30: 2020 2020 2063 6f6d 7061 7265 645f 6573       compared_es
+0000bc40: 7469 6d61 746f 7273 3d63 6f6d 7061 7265  timators=compare
+0000bc50: 645f 6573 7469 6d61 746f 7273 2c0a 2020  d_estimators,.  
+0000bc60: 2020 2020 2020 2020 2020 6265 6861 7669            behavi
+0000bc70: 6f72 5f70 6f6c 6963 795f 6e61 6d65 3d62  or_policy_name=b
+0000bc80: 6568 6176 696f 725f 706f 6c69 6379 5f6e  ehavior_policy_n
+0000bc90: 616d 652c 0a20 2020 2020 2020 2020 2020  ame,.           
+0000bca0: 2064 6174 6173 6574 5f69 643d 6461 7461   dataset_id=data
+0000bcb0: 7365 745f 6964 2c0a 2020 2020 2020 2020  set_id,.        
+0000bcc0: 290a 2020 2020 2020 2020 706f 6c69 6379  ).        policy
+0000bcd0: 5f76 616c 7565 5f69 6e74 6572 7661 6c5f  _value_interval_
+0000bce0: 6469 6374 203d 2073 656c 662e 6573 7469  dict = self.esti
+0000bcf0: 6d61 7465 5f69 6e74 6572 7661 6c73 280a  mate_intervals(.
+0000bd00: 2020 2020 2020 2020 2020 2020 696e 7075              inpu
+0000bd10: 745f 6469 6374 2c0a 2020 2020 2020 2020  t_dict,.        
+0000bd20: 2020 2020 636f 6d70 6172 6564 5f65 7374      compared_est
+0000bd30: 696d 6174 6f72 733d 636f 6d70 6172 6564  imators=compared
+0000bd40: 5f65 7374 696d 6174 6f72 732c 0a20 2020  _estimators,.   
+0000bd50: 2020 2020 2020 2020 2062 6568 6176 696f           behavio
+0000bd60: 725f 706f 6c69 6379 5f6e 616d 653d 6265  r_policy_name=be
+0000bd70: 6861 7669 6f72 5f70 6f6c 6963 795f 6e61  havior_policy_na
+0000bd80: 6d65 2c0a 2020 2020 2020 2020 2020 2020  me,.            
+0000bd90: 6461 7461 7365 745f 6964 3d64 6174 6173  dataset_id=datas
+0000bda0: 6574 5f69 642c 0a20 2020 2020 2020 2020  et_id,.         
+0000bdb0: 2020 2061 6c70 6861 3d61 6c70 6861 2c0a     alpha=alpha,.
+0000bdc0: 2020 2020 2020 2020 2020 2020 6369 3d63              ci=c
+0000bdd0: 692c 0a20 2020 2020 2020 2020 2020 206e  i,.            n
+0000bde0: 5f62 6f6f 7473 7472 6170 5f73 616d 706c  _bootstrap_sampl
+0000bdf0: 6573 3d6e 5f62 6f6f 7473 7472 6170 5f73  es=n_bootstrap_s
+0000be00: 616d 706c 6573 2c0a 2020 2020 2020 2020  amples,.        
+0000be10: 2020 2020 7261 6e64 6f6d 5f73 7461 7465      random_state
+0000be20: 3d72 616e 646f 6d5f 7374 6174 652c 0a20  =random_state,. 
+0000be30: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+0000be40: 2020 706f 6c69 6379 5f76 616c 7565 5f64    policy_value_d
+0000be50: 665f 6469 6374 203d 204e 6f6e 650a 2020  f_dict = None.  
+0000be60: 2020 2020 2020 706f 6c69 6379 5f76 616c        policy_val
+0000be70: 7565 5f69 6e74 6572 7661 6c5f 6466 5f64  ue_interval_df_d
+0000be80: 6963 7420 3d20 4e6f 6e65 0a0a 2020 2020  ict = None..    
+0000be90: 2020 2020 6966 2073 656c 662e 7573 655f      if self.use_
+0000bea0: 6d75 6c74 6970 6c65 5f6c 6f67 6765 645f  multiple_logged_
+0000beb0: 6461 7461 7365 743a 0a20 2020 2020 2020  dataset:.       
+0000bec0: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
+0000bed0: 6365 2869 6e70 7574 5f64 6963 742c 204d  ce(input_dict, M
+0000bee0: 756c 7469 706c 6549 6e70 7574 4469 6374  ultipleInputDict
+0000bef0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+0000bf00: 2020 2069 6620 6265 6861 7669 6f72 5f70     if behavior_p
+0000bf10: 6f6c 6963 795f 6e61 6d65 2069 7320 4e6f  olicy_name is No
+0000bf20: 6e65 2061 6e64 2064 6174 6173 6574 5f69  ne and dataset_i
+0000bf30: 6420 6973 204e 6f6e 653a 0a20 2020 2020  d is None:.     
+0000bf40: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+0000bf50: 6f6c 6963 795f 7661 6c75 655f 6466 5f64  olicy_value_df_d
+0000bf60: 6963 7420 3d20 6465 6661 756c 7464 6963  ict = defaultdic
+0000bf70: 7428 6c69 7374 290a 2020 2020 2020 2020  t(list).        
+0000bf80: 2020 2020 2020 2020 2020 2020 706f 6c69              poli
+0000bf90: 6379 5f76 616c 7565 5f69 6e74 6572 7661  cy_value_interva
+0000bfa0: 6c5f 6466 5f64 6963 7420 3d20 6465 6661  l_df_dict = defa
+0000bfb0: 756c 7464 6963 7428 6c69 7374 290a 0a20  ultdict(list).. 
+0000bfc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bfd0: 2020 2066 6f72 2028 0a20 2020 2020 2020     for (.       
+0000bfe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000bff0: 2062 6568 6176 696f 725f 706f 6c69 6379   behavior_policy
+0000c000: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0000c010: 2020 2020 2020 2020 2020 6e5f 6461 7461            n_data
+0000c020: 7365 7473 2c0a 2020 2020 2020 2020 2020  sets,.          
+0000c030: 2020 2020 2020 2020 2020 2920 696e 2069            ) in i
+0000c040: 6e70 7574 5f64 6963 742e 6e5f 6461 7461  nput_dict.n_data
+0000c050: 7365 7473 2e69 7465 6d73 2829 3a0a 2020  sets.items():.  
+0000c060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c070: 2020 2020 2020 666f 7220 6461 7461 7365        for datase
+0000c080: 745f 6964 5f20 696e 2072 616e 6765 286e  t_id_ in range(n
+0000c090: 5f64 6174 6173 6574 7329 3a0a 2020 2020  _datasets):.    
+0000c0a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c0b0: 2020 2020 2020 2020 280a 2020 2020 2020          (.      
+0000c0c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c0d0: 2020 2020 2020 2020 2020 706f 6c69 6379            policy
+0000c0e0: 5f76 616c 7565 5f64 665f 6469 6374 5f2c  _value_df_dict_,
+0000c0f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000c100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c110: 2070 6f6c 6963 795f 7661 6c75 655f 696e   policy_value_in
+0000c120: 7465 7276 616c 5f64 665f 6469 6374 5f2c  terval_df_dict_,
+0000c130: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000c140: 2020 2020 2020 2020 2020 2020 2029 203d               ) =
+0000c150: 2073 656c 662e 5f73 756d 6d61 7269 7a65   self._summarize
+0000c160: 5f6f 6666 5f70 6f6c 6963 795f 6573 7469  _off_policy_esti
+0000c170: 6d61 7465 7328 0a20 2020 2020 2020 2020  mates(.         
+0000c180: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c190: 2020 2020 2020 2070 6f6c 6963 795f 7661         policy_va
+0000c1a0: 6c75 655f 6469 6374 3d70 6f6c 6963 795f  lue_dict=policy_
+0000c1b0: 7661 6c75 655f 6469 6374 5b62 6568 6176  value_dict[behav
+0000c1c0: 696f 725f 706f 6c69 6379 5d5b 0a20 2020  ior_policy][.   
+0000c1d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c1e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c1f0: 2064 6174 6173 6574 5f69 645f 0a20 2020   dataset_id_.   
+0000c200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c210: 2020 2020 2020 2020 2020 2020 205d 2c0a               ],.
+0000c220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c240: 706f 6c69 6379 5f76 616c 7565 5f69 6e74  policy_value_int
+0000c250: 6572 7661 6c5f 6469 6374 3d70 6f6c 6963  erval_dict=polic
+0000c260: 795f 7661 6c75 655f 696e 7465 7276 616c  y_value_interval
+0000c270: 5f64 6963 745b 0a20 2020 2020 2020 2020  _dict[.         
+0000c280: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c290: 2020 2020 2020 2020 2020 2062 6568 6176             behav
+0000c2a0: 696f 725f 706f 6c69 6379 0a20 2020 2020  ior_policy.     
+0000c2b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c2c0: 2020 2020 2020 2020 2020 205d 5b64 6174             ][dat
+0000c2d0: 6173 6574 5f69 645f 5d2c 0a20 2020 2020  aset_id_],.     
+0000c2e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c2f0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0000c300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c310: 2020 2020 2070 6f6c 6963 795f 7661 6c75       policy_valu
+0000c320: 655f 6466 5f64 6963 745b 6265 6861 7669  e_df_dict[behavi
+0000c330: 6f72 5f70 6f6c 6963 795d 2e61 7070 656e  or_policy].appen
+0000c340: 6428 0a20 2020 2020 2020 2020 2020 2020  d(.             
 0000c350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c360: 2029 0a20 2020 2020 2020 2020 2020 2020   ).             
-0000c370: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0000c380: 6f6c 6963 795f 7661 6c75 655f 6466 5f64  olicy_value_df_d
-0000c390: 6963 745b 6265 6861 7669 6f72 5f70 6f6c  ict[behavior_pol
-0000c3a0: 6963 795d 2e61 7070 656e 6428 0a20 2020  icy].append(.   
-0000c3b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c3c0: 2020 2020 2020 2020 2020 2020 2070 6f6c               pol
-0000c3d0: 6963 795f 7661 6c75 655f 6466 5f64 6963  icy_value_df_dic
-0000c3e0: 745f 0a20 2020 2020 2020 2020 2020 2020  t_.             
-0000c3f0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-0000c400: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000c410: 2020 2020 2020 2020 2020 2020 2070 6f6c               pol
-0000c420: 6963 795f 7661 6c75 655f 696e 7465 7276  icy_value_interv
-0000c430: 616c 5f64 665f 6469 6374 5b62 6568 6176  al_df_dict[behav
-0000c440: 696f 725f 706f 6c69 6379 5d2e 6170 7065  ior_policy].appe
-0000c450: 6e64 280a 2020 2020 2020 2020 2020 2020  nd(.            
-0000c460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c470: 2020 2020 706f 6c69 6379 5f76 616c 7565      policy_value
-0000c480: 5f69 6e74 6572 7661 6c5f 6466 5f64 6963  _interval_df_dic
-0000c490: 745f 0a20 2020 2020 2020 2020 2020 2020  t_.             
-0000c4a0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-0000c4b0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000c4c0: 2020 2020 2020 706f 6c69 6379 5f76 616c        policy_val
-0000c4d0: 7565 5f64 665f 6469 6374 203d 2064 6566  ue_df_dict = def
-0000c4e0: 6175 6c74 6469 6374 5f74 6f5f 6469 6374  aultdict_to_dict
-0000c4f0: 2870 6f6c 6963 795f 7661 6c75 655f 6466  (policy_value_df
-0000c500: 5f64 6963 7429 0a20 2020 2020 2020 2020  _dict).         
-0000c510: 2020 2020 2020 2020 2020 2070 6f6c 6963             polic
-0000c520: 795f 7661 6c75 655f 696e 7465 7276 616c  y_value_interval
-0000c530: 5f64 665f 6469 6374 203d 2064 6566 6175  _df_dict = defau
-0000c540: 6c74 6469 6374 5f74 6f5f 6469 6374 280a  ltdict_to_dict(.
-0000c550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c560: 2020 2020 2020 2020 706f 6c69 6379 5f76          policy_v
-0000c570: 616c 7565 5f69 6e74 6572 7661 6c5f 6466  alue_interval_df
-0000c580: 5f64 6963 740a 2020 2020 2020 2020 2020  _dict.          
-0000c590: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
-0000c5a0: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
-0000c5b0: 6620 6265 6861 7669 6f72 5f70 6f6c 6963  f behavior_polic
-0000c5c0: 795f 6e61 6d65 2069 7320 4e6f 6e65 2061  y_name is None a
-0000c5d0: 6e64 2064 6174 6173 6574 5f69 6420 6973  nd dataset_id is
-0000c5e0: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
-0000c5f0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0000c600: 6f6c 6963 795f 7661 6c75 655f 6466 5f64  olicy_value_df_d
-0000c610: 6963 7420 3d20 7b7d 0a20 2020 2020 2020  ict = {}.       
-0000c620: 2020 2020 2020 2020 2020 2020 2070 6f6c               pol
-0000c630: 6963 795f 7661 6c75 655f 696e 7465 7276  icy_value_interv
-0000c640: 616c 5f64 665f 6469 6374 203d 207b 7d0a  al_df_dict = {}.
-0000c650: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000c660: 2020 2020 2066 6f72 2062 6568 6176 696f       for behavio
-0000c670: 725f 706f 6c69 6379 2069 6e20 696e 7075  r_policy in inpu
-0000c680: 745f 6469 6374 2e62 6568 6176 696f 725f  t_dict.behavior_
-0000c690: 706f 6c69 6379 5f6e 616d 6573 3a0a 2020  policy_names:.  
-0000c6a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c6b0: 2020 2020 2020 280a 2020 2020 2020 2020        (.        
+0000c360: 2020 2070 6f6c 6963 795f 7661 6c75 655f     policy_value_
+0000c370: 6466 5f64 6963 745f 0a20 2020 2020 2020  df_dict_.       
+0000c380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c390: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+0000c3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c3b0: 2020 2070 6f6c 6963 795f 7661 6c75 655f     policy_value_
+0000c3c0: 696e 7465 7276 616c 5f64 665f 6469 6374  interval_df_dict
+0000c3d0: 5b62 6568 6176 696f 725f 706f 6c69 6379  [behavior_policy
+0000c3e0: 5d2e 6170 7065 6e64 280a 2020 2020 2020  ].append(.      
+0000c3f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c400: 2020 2020 2020 2020 2020 706f 6c69 6379            policy
+0000c410: 5f76 616c 7565 5f69 6e74 6572 7661 6c5f  _value_interval_
+0000c420: 6466 5f64 6963 745f 0a20 2020 2020 2020  df_dict_.       
+0000c430: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c440: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+0000c450: 2020 2020 2020 2020 2020 2020 706f 6c69              poli
+0000c460: 6379 5f76 616c 7565 5f64 665f 6469 6374  cy_value_df_dict
+0000c470: 203d 2064 6566 6175 6c74 6469 6374 5f74   = defaultdict_t
+0000c480: 6f5f 6469 6374 2870 6f6c 6963 795f 7661  o_dict(policy_va
+0000c490: 6c75 655f 6466 5f64 6963 7429 0a20 2020  lue_df_dict).   
+0000c4a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c4b0: 2070 6f6c 6963 795f 7661 6c75 655f 696e   policy_value_in
+0000c4c0: 7465 7276 616c 5f64 665f 6469 6374 203d  terval_df_dict =
+0000c4d0: 2064 6566 6175 6c74 6469 6374 5f74 6f5f   defaultdict_to_
+0000c4e0: 6469 6374 280a 2020 2020 2020 2020 2020  dict(.          
+0000c4f0: 2020 2020 2020 2020 2020 2020 2020 706f                po
+0000c500: 6c69 6379 5f76 616c 7565 5f69 6e74 6572  licy_value_inter
+0000c510: 7661 6c5f 6466 5f64 6963 740a 2020 2020  val_df_dict.    
+0000c520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c530: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
+0000c540: 2020 2065 6c69 6620 6265 6861 7669 6f72     elif behavior
+0000c550: 5f70 6f6c 6963 795f 6e61 6d65 2069 7320  _policy_name is 
+0000c560: 4e6f 6e65 2061 6e64 2064 6174 6173 6574  None and dataset
+0000c570: 5f69 6420 6973 206e 6f74 204e 6f6e 653a  _id is not None:
+0000c580: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000c590: 2020 2020 2070 6f6c 6963 795f 7661 6c75       policy_valu
+0000c5a0: 655f 6466 5f64 6963 7420 3d20 7b7d 0a20  e_df_dict = {}. 
+0000c5b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c5c0: 2020 2070 6f6c 6963 795f 7661 6c75 655f     policy_value_
+0000c5d0: 696e 7465 7276 616c 5f64 665f 6469 6374  interval_df_dict
+0000c5e0: 203d 207b 7d0a 0a20 2020 2020 2020 2020   = {}..         
+0000c5f0: 2020 2020 2020 2020 2020 2066 6f72 2062             for b
+0000c600: 6568 6176 696f 725f 706f 6c69 6379 2069  ehavior_policy i
+0000c610: 6e20 696e 7075 745f 6469 6374 2e62 6568  n input_dict.beh
+0000c620: 6176 696f 725f 706f 6c69 6379 5f6e 616d  avior_policy_nam
+0000c630: 6573 3a0a 2020 2020 2020 2020 2020 2020  es:.            
+0000c640: 2020 2020 2020 2020 2020 2020 280a 2020              (.  
+0000c650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c660: 2020 2020 2020 2020 2020 706f 6c69 6379            policy
+0000c670: 5f76 616c 7565 5f64 665f 6469 6374 5f2c  _value_df_dict_,
+0000c680: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000c690: 2020 2020 2020 2020 2020 2020 2070 6f6c               pol
+0000c6a0: 6963 795f 7661 6c75 655f 696e 7465 7276  icy_value_interv
+0000c6b0: 616c 5f64 665f 6469 6374 5f2c 0a20 2020  al_df_dict_,.   
 0000c6c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c6d0: 2020 2020 706f 6c69 6379 5f76 616c 7565      policy_value
-0000c6e0: 5f64 665f 6469 6374 5f2c 0a20 2020 2020  _df_dict_,.     
-0000c6f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c700: 2020 2020 2020 2070 6f6c 6963 795f 7661         policy_va
-0000c710: 6c75 655f 696e 7465 7276 616c 5f64 665f  lue_interval_df_
-0000c720: 6469 6374 5f2c 0a20 2020 2020 2020 2020  dict_,.         
-0000c730: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-0000c740: 203d 2073 656c 662e 5f73 756d 6d61 7269   = self._summari
-0000c750: 7a65 5f6f 6666 5f70 6f6c 6963 795f 6573  ze_off_policy_es
-0000c760: 7469 6d61 7465 7328 0a20 2020 2020 2020  timates(.       
-0000c770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c780: 2020 2020 2070 6f6c 6963 795f 7661 6c75       policy_valu
-0000c790: 655f 6469 6374 3d70 6f6c 6963 795f 7661  e_dict=policy_va
-0000c7a0: 6c75 655f 6469 6374 5b62 6568 6176 696f  lue_dict[behavio
-0000c7b0: 725f 706f 6c69 6379 5d2c 0a20 2020 2020  r_policy],.     
-0000c7c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c7d0: 2020 2020 2020 2070 6f6c 6963 795f 7661         policy_va
-0000c7e0: 6c75 655f 696e 7465 7276 616c 5f64 6963  lue_interval_dic
-0000c7f0: 743d 706f 6c69 6379 5f76 616c 7565 5f69  t=policy_value_i
-0000c800: 6e74 6572 7661 6c5f 6469 6374 5b0a 2020  nterval_dict[.  
+0000c6d0: 2020 2020 2029 203d 2073 656c 662e 5f73       ) = self._s
+0000c6e0: 756d 6d61 7269 7a65 5f6f 6666 5f70 6f6c  ummarize_off_pol
+0000c6f0: 6963 795f 6573 7469 6d61 7465 7328 0a20  icy_estimates(. 
+0000c700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c710: 2020 2020 2020 2020 2020 2070 6f6c 6963             polic
+0000c720: 795f 7661 6c75 655f 6469 6374 3d70 6f6c  y_value_dict=pol
+0000c730: 6963 795f 7661 6c75 655f 6469 6374 5b62  icy_value_dict[b
+0000c740: 6568 6176 696f 725f 706f 6c69 6379 5d2c  ehavior_policy],
+0000c750: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000c760: 2020 2020 2020 2020 2020 2020 2070 6f6c               pol
+0000c770: 6963 795f 7661 6c75 655f 696e 7465 7276  icy_value_interv
+0000c780: 616c 5f64 6963 743d 706f 6c69 6379 5f76  al_dict=policy_v
+0000c790: 616c 7565 5f69 6e74 6572 7661 6c5f 6469  alue_interval_di
+0000c7a0: 6374 5b0a 2020 2020 2020 2020 2020 2020  ct[.            
+0000c7b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c7c0: 2020 2020 6265 6861 7669 6f72 5f70 6f6c      behavior_pol
+0000c7d0: 6963 790a 2020 2020 2020 2020 2020 2020  icy.            
+0000c7e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c7f0: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+0000c800: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
 0000c810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c820: 2020 2020 2020 2020 2020 2020 2020 6265                be
-0000c830: 6861 7669 6f72 5f70 6f6c 6963 790a 2020  havior_policy.  
-0000c840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c850: 2020 2020 2020 2020 2020 5d2c 0a20 2020            ],.   
-0000c860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c870: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-0000c880: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0000c890: 6f6c 6963 795f 7661 6c75 655f 6466 5f64  olicy_value_df_d
-0000c8a0: 6963 745b 6265 6861 7669 6f72 5f70 6f6c  ict[behavior_pol
-0000c8b0: 6963 795d 203d 2070 6f6c 6963 795f 7661  icy] = policy_va
-0000c8c0: 6c75 655f 6466 5f64 6963 745f 0a20 2020  lue_df_dict_.   
-0000c8d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c8e0: 2020 2020 2070 6f6c 6963 795f 7661 6c75       policy_valu
-0000c8f0: 655f 696e 7465 7276 616c 5f64 665f 6469  e_interval_df_di
-0000c900: 6374 5b0a 2020 2020 2020 2020 2020 2020  ct[.            
-0000c910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c920: 6265 6861 7669 6f72 5f70 6f6c 6963 790a  behavior_policy.
-0000c930: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c940: 2020 2020 2020 2020 5d20 3d20 706f 6c69          ] = poli
-0000c950: 6379 5f76 616c 7565 5f69 6e74 6572 7661  cy_value_interva
-0000c960: 6c5f 6466 5f64 6963 745f 0a0a 2020 2020  l_df_dict_..    
-0000c970: 2020 2020 2020 2020 2020 2020 656c 6966              elif
-0000c980: 2062 6568 6176 696f 725f 706f 6c69 6379   behavior_policy
-0000c990: 5f6e 616d 6520 6973 206e 6f74 204e 6f6e  _name is not Non
-0000c9a0: 6520 616e 6420 6461 7461 7365 745f 6964  e and dataset_id
-0000c9b0: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
-0000c9c0: 2020 2020 2020 2020 2020 2020 2020 706f                po
-0000c9d0: 6c69 6379 5f76 616c 7565 5f64 665f 6469  licy_value_df_di
-0000c9e0: 6374 203d 205b 5d0a 2020 2020 2020 2020  ct = [].        
-0000c9f0: 2020 2020 2020 2020 2020 2020 706f 6c69              poli
-0000ca00: 6379 5f76 616c 7565 5f69 6e74 6572 7661  cy_value_interva
-0000ca10: 6c5f 6466 5f64 6963 7420 3d20 5b5d 0a0a  l_df_dict = []..
-0000ca20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ca30: 2020 2020 666f 7220 6461 7461 7365 745f      for dataset_
-0000ca40: 6964 5f20 696e 2072 616e 6765 280a 2020  id_ in range(.  
-0000ca50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ca60: 2020 2020 2020 696e 7075 745f 6469 6374        input_dict
-0000ca70: 2e6e 5f64 6174 6173 6574 735b 6265 6861  .n_datasets[beha
-0000ca80: 7669 6f72 5f70 6f6c 6963 795f 6e61 6d65  vior_policy_name
-0000ca90: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-0000caa0: 2020 2020 2020 293a 0a20 2020 2020 2020        ):.       
-0000cab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cac0: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
-0000cad0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0000cae0: 6f6c 6963 795f 7661 6c75 655f 6466 5f64  olicy_value_df_d
-0000caf0: 6963 745f 2c0a 2020 2020 2020 2020 2020  ict_,.          
-0000cb00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cb10: 2020 706f 6c69 6379 5f76 616c 7565 5f69    policy_value_i
-0000cb20: 6e74 6572 7661 6c5f 6466 5f64 6963 745f  nterval_df_dict_
-0000cb30: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000cb40: 2020 2020 2020 2020 2020 2920 3d20 7365            ) = se
-0000cb50: 6c66 2e5f 7375 6d6d 6172 697a 655f 6f66  lf._summarize_of
-0000cb60: 665f 706f 6c69 6379 5f65 7374 696d 6174  f_policy_estimat
-0000cb70: 6573 280a 2020 2020 2020 2020 2020 2020  es(.            
-0000cb80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cb90: 706f 6c69 6379 5f76 616c 7565 5f64 6963  policy_value_dic
-0000cba0: 743d 706f 6c69 6379 5f76 616c 7565 5f64  t=policy_value_d
-0000cbb0: 6963 745b 6461 7461 7365 745f 6964 5f5d  ict[dataset_id_]
-0000cbc0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000cbd0: 2020 2020 2020 2020 2020 2020 2020 706f                po
-0000cbe0: 6c69 6379 5f76 616c 7565 5f69 6e74 6572  licy_value_inter
-0000cbf0: 7661 6c5f 6469 6374 3d70 6f6c 6963 795f  val_dict=policy_
-0000cc00: 7661 6c75 655f 696e 7465 7276 616c 5f64  value_interval_d
-0000cc10: 6963 745b 0a20 2020 2020 2020 2020 2020  ict[.           
-0000cc20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cc30: 2020 2020 2064 6174 6173 6574 5f69 645f       dataset_id_
-0000cc40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000cc50: 2020 2020 2020 2020 2020 2020 205d 2c0a               ],.
+0000c820: 2020 2020 2070 6f6c 6963 795f 7661 6c75       policy_valu
+0000c830: 655f 6466 5f64 6963 745b 6265 6861 7669  e_df_dict[behavi
+0000c840: 6f72 5f70 6f6c 6963 795d 203d 2070 6f6c  or_policy] = pol
+0000c850: 6963 795f 7661 6c75 655f 6466 5f64 6963  icy_value_df_dic
+0000c860: 745f 0a20 2020 2020 2020 2020 2020 2020  t_.             
+0000c870: 2020 2020 2020 2020 2020 2070 6f6c 6963             polic
+0000c880: 795f 7661 6c75 655f 696e 7465 7276 616c  y_value_interval
+0000c890: 5f64 665f 6469 6374 5b0a 2020 2020 2020  _df_dict[.      
+0000c8a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c8b0: 2020 2020 2020 6265 6861 7669 6f72 5f70        behavior_p
+0000c8c0: 6f6c 6963 790a 2020 2020 2020 2020 2020  olicy.          
+0000c8d0: 2020 2020 2020 2020 2020 2020 2020 5d20                ] 
+0000c8e0: 3d20 706f 6c69 6379 5f76 616c 7565 5f69  = policy_value_i
+0000c8f0: 6e74 6572 7661 6c5f 6466 5f64 6963 745f  nterval_df_dict_
+0000c900: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000c910: 2020 656c 6966 2062 6568 6176 696f 725f    elif behavior_
+0000c920: 706f 6c69 6379 5f6e 616d 6520 6973 206e  policy_name is n
+0000c930: 6f74 204e 6f6e 6520 616e 6420 6461 7461  ot None and data
+0000c940: 7365 745f 6964 2069 7320 4e6f 6e65 3a0a  set_id is None:.
+0000c950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c960: 2020 2020 706f 6c69 6379 5f76 616c 7565      policy_value
+0000c970: 5f64 665f 6469 6374 203d 205b 5d0a 2020  _df_dict = [].  
+0000c980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c990: 2020 706f 6c69 6379 5f76 616c 7565 5f69    policy_value_i
+0000c9a0: 6e74 6572 7661 6c5f 6466 5f64 6963 7420  nterval_df_dict 
+0000c9b0: 3d20 5b5d 0a0a 2020 2020 2020 2020 2020  = []..          
+0000c9c0: 2020 2020 2020 2020 2020 666f 7220 6461            for da
+0000c9d0: 7461 7365 745f 6964 5f20 696e 2072 616e  taset_id_ in ran
+0000c9e0: 6765 280a 2020 2020 2020 2020 2020 2020  ge(.            
+0000c9f0: 2020 2020 2020 2020 2020 2020 696e 7075              inpu
+0000ca00: 745f 6469 6374 2e6e 5f64 6174 6173 6574  t_dict.n_dataset
+0000ca10: 735b 6265 6861 7669 6f72 5f70 6f6c 6963  s[behavior_polic
+0000ca20: 795f 6e61 6d65 5d0a 2020 2020 2020 2020  y_name].        
+0000ca30: 2020 2020 2020 2020 2020 2020 293a 0a20              ):. 
+0000ca40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ca50: 2020 2020 2020 2028 0a20 2020 2020 2020         (.       
+0000ca60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ca70: 2020 2020 2070 6f6c 6963 795f 7661 6c75       policy_valu
+0000ca80: 655f 6466 5f64 6963 745f 2c0a 2020 2020  e_df_dict_,.    
+0000ca90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000caa0: 2020 2020 2020 2020 706f 6c69 6379 5f76          policy_v
+0000cab0: 616c 7565 5f69 6e74 6572 7661 6c5f 6466  alue_interval_df
+0000cac0: 5f64 6963 745f 2c0a 2020 2020 2020 2020  _dict_,.        
+0000cad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000cae0: 2920 3d20 7365 6c66 2e5f 7375 6d6d 6172  ) = self._summar
+0000caf0: 697a 655f 6f66 665f 706f 6c69 6379 5f65  ize_off_policy_e
+0000cb00: 7374 696d 6174 6573 280a 2020 2020 2020  stimates(.      
+0000cb10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000cb20: 2020 2020 2020 706f 6c69 6379 5f76 616c        policy_val
+0000cb30: 7565 5f64 6963 743d 706f 6c69 6379 5f76  ue_dict=policy_v
+0000cb40: 616c 7565 5f64 6963 745b 6461 7461 7365  alue_dict[datase
+0000cb50: 745f 6964 5f5d 2c0a 2020 2020 2020 2020  t_id_],.        
+0000cb60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000cb70: 2020 2020 706f 6c69 6379 5f76 616c 7565      policy_value
+0000cb80: 5f69 6e74 6572 7661 6c5f 6469 6374 3d70  _interval_dict=p
+0000cb90: 6f6c 6963 795f 7661 6c75 655f 696e 7465  olicy_value_inte
+0000cba0: 7276 616c 5f64 6963 745b 0a20 2020 2020  rval_dict[.     
+0000cbb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000cbc0: 2020 2020 2020 2020 2020 2064 6174 6173             datas
+0000cbd0: 6574 5f69 645f 0a20 2020 2020 2020 2020  et_id_.         
+0000cbe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000cbf0: 2020 205d 2c0a 2020 2020 2020 2020 2020     ],.          
+0000cc00: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+0000cc10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000cc20: 2020 2020 2020 2020 706f 6c69 6379 5f76          policy_v
+0000cc30: 616c 7565 5f64 665f 6469 6374 2e61 7070  alue_df_dict.app
+0000cc40: 656e 6428 706f 6c69 6379 5f76 616c 7565  end(policy_value
+0000cc50: 5f64 665f 6469 6374 5f29 0a20 2020 2020  _df_dict_).     
 0000cc60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cc70: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0000cc80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cc90: 2020 706f 6c69 6379 5f76 616c 7565 5f64    policy_value_d
-0000cca0: 665f 6469 6374 2e61 7070 656e 6428 706f  f_dict.append(po
-0000ccb0: 6c69 6379 5f76 616c 7565 5f64 665f 6469  licy_value_df_di
-0000ccc0: 6374 5f29 0a20 2020 2020 2020 2020 2020  ct_).           
-0000ccd0: 2020 2020 2020 2020 2020 2020 2070 6f6c               pol
-0000cce0: 6963 795f 7661 6c75 655f 696e 7465 7276  icy_value_interv
-0000ccf0: 616c 5f64 665f 6469 6374 2e61 7070 656e  al_df_dict.appen
-0000cd00: 6428 0a20 2020 2020 2020 2020 2020 2020  d(.             
-0000cd10: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0000cd20: 6f6c 6963 795f 7661 6c75 655f 696e 7465  olicy_value_inte
-0000cd30: 7276 616c 5f64 665f 6469 6374 5f0a 2020  rval_df_dict_.  
-0000cd40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cd50: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-0000cd60: 2069 6620 706f 6c69 6379 5f76 616c 7565   if policy_value
-0000cd70: 5f64 665f 6469 6374 2069 7320 4e6f 6e65  _df_dict is None
-0000cd80: 3a0a 2020 2020 2020 2020 2020 2020 280a  :.            (.
-0000cd90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cda0: 706f 6c69 6379 5f76 616c 7565 5f64 665f  policy_value_df_
-0000cdb0: 6469 6374 2c0a 2020 2020 2020 2020 2020  dict,.          
-0000cdc0: 2020 2020 2020 706f 6c69 6379 5f76 616c        policy_val
-0000cdd0: 7565 5f69 6e74 6572 7661 6c5f 6466 5f64  ue_interval_df_d
-0000cde0: 6963 742c 0a20 2020 2020 2020 2020 2020  ict,.           
-0000cdf0: 2029 203d 2073 656c 662e 5f73 756d 6d61   ) = self._summa
-0000ce00: 7269 7a65 5f6f 6666 5f70 6f6c 6963 795f  rize_off_policy_
-0000ce10: 6573 7469 6d61 7465 7328 0a20 2020 2020  estimates(.     
-0000ce20: 2020 2020 2020 2020 2020 2070 6f6c 6963             polic
-0000ce30: 795f 7661 6c75 655f 6469 6374 3d70 6f6c  y_value_dict=pol
-0000ce40: 6963 795f 7661 6c75 655f 6469 6374 2c0a  icy_value_dict,.
-0000ce50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ce60: 706f 6c69 6379 5f76 616c 7565 5f69 6e74  policy_value_int
-0000ce70: 6572 7661 6c5f 6469 6374 3d70 6f6c 6963  erval_dict=polic
-0000ce80: 795f 7661 6c75 655f 696e 7465 7276 616c  y_value_interval
-0000ce90: 5f64 6963 742c 0a20 2020 2020 2020 2020  _dict,.         
-0000cea0: 2020 2029 0a0a 2020 2020 2020 2020 7265     )..        re
-0000ceb0: 7475 726e 2070 6f6c 6963 795f 7661 6c75  turn policy_valu
-0000cec0: 655f 6466 5f64 6963 742c 2070 6f6c 6963  e_df_dict, polic
-0000ced0: 795f 7661 6c75 655f 696e 7465 7276 616c  y_value_interval
-0000cee0: 5f64 665f 6469 6374 0a0a 2020 2020 6465  _df_dict..    de
-0000cef0: 6620 6576 616c 7561 7465 5f70 6572 666f  f evaluate_perfo
-0000cf00: 726d 616e 6365 5f6f 665f 6f70 655f 6573  rmance_of_ope_es
-0000cf10: 7469 6d61 746f 7273 280a 2020 2020 2020  timators(.      
-0000cf20: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-0000cf30: 696e 7075 745f 6469 6374 3a20 556e 696f  input_dict: Unio
-0000cf40: 6e5b 4f50 4549 6e70 7574 4469 6374 2c20  n[OPEInputDict, 
-0000cf50: 4d75 6c74 6970 6c65 496e 7075 7444 6963  MultipleInputDic
-0000cf60: 745d 2c0a 2020 2020 2020 2020 636f 6d70  t],.        comp
-0000cf70: 6172 6564 5f65 7374 696d 6174 6f72 733a  ared_estimators:
-0000cf80: 204f 7074 696f 6e61 6c5b 4c69 7374 5b73   Optional[List[s
-0000cf90: 7472 5d5d 203d 204e 6f6e 652c 0a20 2020  tr]] = None,.   
-0000cfa0: 2020 2020 2062 6568 6176 696f 725f 706f       behavior_po
-0000cfb0: 6c69 6379 5f6e 616d 653a 204f 7074 696f  licy_name: Optio
-0000cfc0: 6e61 6c5b 7374 725d 203d 204e 6f6e 652c  nal[str] = None,
-0000cfd0: 0a20 2020 2020 2020 2064 6174 6173 6574  .        dataset
-0000cfe0: 5f69 643a 204f 7074 696f 6e61 6c5b 696e  _id: Optional[in
-0000cff0: 745d 203d 204e 6f6e 652c 0a20 2020 2020  t] = None,.     
-0000d000: 2020 206d 6574 7269 633a 2073 7472 203d     metric: str =
-0000d010: 2022 7265 6c61 7469 7665 2d65 6522 2c0a   "relative-ee",.
-0000d020: 2020 2020 2020 2020 7265 7475 726e 5f62          return_b
-0000d030: 795f 6461 7461 6672 616d 653a 2062 6f6f  y_dataframe: boo
-0000d040: 6c20 3d20 4661 6c73 652c 0a20 2020 2029  l = False,.    )
-0000d050: 202d 3e20 4469 6374 5b73 7472 2c20 4469   -> Dict[str, Di
-0000d060: 6374 5b73 7472 2c20 666c 6f61 745d 5d3a  ct[str, float]]:
-0000d070: 0a20 2020 2020 2020 2022 2222 4576 616c  .        """Eval
-0000d080: 7561 7465 2074 6865 2065 7374 696d 6174  uate the estimat
-0000d090: 696f 6e20 7065 7266 6f72 6d61 6e63 652f  ion performance/
-0000d0a0: 6163 6375 7261 6379 206f 6620 4f50 4520  accuracy of OPE 
-0000d0b0: 6573 7469 6d61 746f 7273 2e0a 0a20 2020  estimators...   
-0000d0c0: 2020 2020 204e 6f74 650a 2020 2020 2020       Note.      
-0000d0d0: 2020 2d2d 2d2d 2d2d 2d0a 2020 2020 2020    -------.      
-0000d0e0: 2020 4576 616c 7561 7465 2074 6865 2065    Evaluate the e
-0000d0f0: 7374 696d 6174 696f 6e20 7065 7266 6f72  stimation perfor
-0000d100: 6d61 6e63 652f 6163 6375 7261 6379 206f  mance/accuracy o
-0000d110: 6620 4f50 4520 6573 7469 6d61 746f 7273  f OPE estimators
-0000d120: 2062 7920 7265 6c61 7469 7665 2065 7374   by relative est
-0000d130: 696d 6174 696f 6e20 6572 726f 7220 2872  imation error (r
-0000d140: 656c 6174 6976 652d 4545 2920 6f72 2073  elative-EE) or s
-0000d150: 7175 6172 6564 2065 7272 6f72 2028 5345  quared error (SE
-0000d160: 292e 0a0a 2020 2020 2020 2020 2e2e 206d  )...        .. m
-0000d170: 6174 683a 3a0a 0a20 2020 2020 2020 2020  ath::..         
-0000d180: 2020 205c 5c6d 6174 6872 6d7b 5265 6c61     \\mathrm{Rela
-0000d190: 7469 7665 2d45 457d 285c 5c68 6174 7b56  tive-EE}(\\hat{V
-0000d1a0: 7d3b 205c 5c6d 6174 6863 616c 7b44 7d29  }; \\mathcal{D})
-0000d1b0: 0a20 2020 2020 2020 2020 2020 203a 3d20  .            := 
-0000d1c0: 5c5c 6c65 6674 7c20 5c5c 6672 6163 7b5c  \\left| \\frac{\
-0000d1d0: 5c68 6174 7b56 7d28 5c5c 7069 3b20 5c5c  \hat{V}(\\pi; \\
-0000d1e0: 6d61 7468 6361 6c7b 447d 2920 2d20 565f  mathcal{D}) - V_
-0000d1f0: 7b5c 5c6d 6174 6872 6d7b 6f6e 7d7d 285c  {\\mathrm{on}}(\
-0000d200: 5c70 6929 7d7b 565f 7b5c 5c6d 6174 6872  \pi)}{V_{\\mathr
-0000d210: 6d7b 6f6e 7d7d 285c 5c70 6929 7d20 5c5c  m{on}}(\\pi)} \\
-0000d220: 7269 6768 747c 2c0a 0a20 2020 2020 2020  right|,..       
-0000d230: 202e 2e20 6d61 7468 3a3a 0a0a 2020 2020   .. math::..    
-0000d240: 2020 2020 2020 2020 5c5c 6d61 7468 726d          \\mathrm
-0000d250: 7b53 457d 285c 5c68 6174 7b56 7d3b 205c  {SE}(\\hat{V}; \
-0000d260: 5c6d 6174 6863 616c 7b44 7d29 203a 3d20  \mathcal{D}) := 
-0000d270: 5c5c 6c65 6674 2820 5c5c 6861 747b 567d  \\left( \\hat{V}
-0000d280: 285c 5c70 693b 205c 5c6d 6174 6863 616c  (\\pi; \\mathcal
-0000d290: 7b44 7d29 202d 2056 5f7b 5c5c 6d61 7468  {D}) - V_{\\math
-0000d2a0: 726d 7b6f 6e7d 7d20 5c5c 7269 6768 7429  rm{on}} \\right)
-0000d2b0: 5e32 2c0a 0a20 2020 2020 2020 2077 6865  ^2,..        whe
-0000d2c0: 7265 203a 6d61 7468 3a60 565f 7b5c 5c6d  re :math:`V_{\\m
-0000d2d0: 6174 6872 6d7b 6f6e 7d7d 285c 5c70 6929  athrm{on}}(\\pi)
-0000d2e0: 6020 6973 2074 6865 206f 6e2d 706f 6c69  ` is the on-poli
-0000d2f0: 6379 2070 6f6c 6963 7920 7661 6c75 6520  cy policy value 
-0000d300: 6f66 2074 6865 2065 7661 6c75 6174 696f  of the evaluatio
-0000d310: 6e20 706f 6c69 6379 203a 6d61 7468 3a60  n policy :math:`
-0000d320: 5c5c 7069 602e 0a20 2020 2020 2020 203a  \\pi`..        :
-0000d330: 6d61 7468 3a60 5c5c 6861 747b 567d 285c  math:`\\hat{V}(\
-0000d340: 5c70 693b 205c 5c6d 6174 6863 616c 7b44  \pi; \\mathcal{D
-0000d350: 7d29 6020 6973 2074 6865 2070 6f6c 6963  })` is the polic
-0000d360: 7920 7661 6c75 6520 6573 7469 6d61 7465  y value estimate
-0000d370: 6420 6279 2074 6865 204f 5045 2065 7374  d by the OPE est
-0000d380: 696d 6174 6f72 203a 6d61 7468 3a60 5c5c  imator :math:`\\
-0000d390: 6861 747b 567d 6020 616e 6420 6c6f 6767  hat{V}` and logg
-0000d3a0: 6564 2064 6174 6173 6574 203a 6d61 7468  ed dataset :math
-0000d3b0: 3a60 5c5c 6d61 7468 6361 6c7b 447d 602e  :`\\mathcal{D}`.
-0000d3c0: 0a0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
-0000d3d0: 7465 7273 0a20 2020 2020 2020 202d 2d2d  ters.        ---
-0000d3e0: 2d2d 2d2d 0a20 2020 2020 2020 2069 6e70  ----.        inp
-0000d3f0: 7574 5f64 6963 743a 204f 5045 496e 7075  ut_dict: OPEInpu
-0000d400: 7444 6963 7420 6f72 204d 756c 7469 706c  tDict or Multipl
-0000d410: 6549 6e70 7574 4469 6374 0a20 2020 2020  eInputDict.     
-0000d420: 2020 2020 2020 2044 6963 7469 6f6e 6172         Dictionar
-0000d430: 7920 6f66 2074 6865 204f 5045 2069 6e70  y of the OPE inp
-0000d440: 7574 7320 666f 7220 6561 6368 2065 7661  uts for each eva
-0000d450: 6c75 6174 696f 6e20 706f 6c69 6379 2e0a  luation policy..
-0000d460: 0a20 2020 2020 2020 2020 2020 202e 2e20  .            .. 
-0000d470: 636f 6465 2d62 6c6f 636b 3a3a 2070 7974  code-block:: pyt
-0000d480: 686f 6e0a 0a20 2020 2020 2020 2020 2020  hon..           
-0000d490: 2020 2020 206b 6579 3a20 5b65 7661 6c75       key: [evalu
-0000d4a0: 6174 696f 6e5f 706f 6c69 6379 5d5b 0a20  ation_policy][. 
-0000d4b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d4c0: 2020 2065 7661 6c75 6174 696f 6e5f 706f     evaluation_po
-0000d4d0: 6c69 6379 5f61 6374 696f 6e2c 0a20 2020  licy_action,.   
-0000d4e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d4f0: 2065 7661 6c75 6174 696f 6e5f 706f 6c69   evaluation_poli
-0000d500: 6379 5f61 6374 696f 6e5f 6469 7374 2c0a  cy_action_dist,.
+0000cc70: 2020 2070 6f6c 6963 795f 7661 6c75 655f     policy_value_
+0000cc80: 696e 7465 7276 616c 5f64 665f 6469 6374  interval_df_dict
+0000cc90: 2e61 7070 656e 6428 0a20 2020 2020 2020  .append(.       
+0000cca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ccb0: 2020 2020 2070 6f6c 6963 795f 7661 6c75       policy_valu
+0000ccc0: 655f 696e 7465 7276 616c 5f64 665f 6469  e_interval_df_di
+0000ccd0: 6374 5f0a 2020 2020 2020 2020 2020 2020  ct_.            
+0000cce0: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+0000ccf0: 2020 2020 2020 2069 6620 706f 6c69 6379         if policy
+0000cd00: 5f76 616c 7565 5f64 665f 6469 6374 2069  _value_df_dict i
+0000cd10: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
+0000cd20: 2020 2020 280a 2020 2020 2020 2020 2020      (.          
+0000cd30: 2020 2020 2020 706f 6c69 6379 5f76 616c        policy_val
+0000cd40: 7565 5f64 665f 6469 6374 2c0a 2020 2020  ue_df_dict,.    
+0000cd50: 2020 2020 2020 2020 2020 2020 706f 6c69              poli
+0000cd60: 6379 5f76 616c 7565 5f69 6e74 6572 7661  cy_value_interva
+0000cd70: 6c5f 6466 5f64 6963 742c 0a20 2020 2020  l_df_dict,.     
+0000cd80: 2020 2020 2020 2029 203d 2073 656c 662e         ) = self.
+0000cd90: 5f73 756d 6d61 7269 7a65 5f6f 6666 5f70  _summarize_off_p
+0000cda0: 6f6c 6963 795f 6573 7469 6d61 7465 7328  olicy_estimates(
+0000cdb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000cdc0: 2070 6f6c 6963 795f 7661 6c75 655f 6469   policy_value_di
+0000cdd0: 6374 3d70 6f6c 6963 795f 7661 6c75 655f  ct=policy_value_
+0000cde0: 6469 6374 2c0a 2020 2020 2020 2020 2020  dict,.          
+0000cdf0: 2020 2020 2020 706f 6c69 6379 5f76 616c        policy_val
+0000ce00: 7565 5f69 6e74 6572 7661 6c5f 6469 6374  ue_interval_dict
+0000ce10: 3d70 6f6c 6963 795f 7661 6c75 655f 696e  =policy_value_in
+0000ce20: 7465 7276 616c 5f64 6963 742c 0a20 2020  terval_dict,.   
+0000ce30: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
+0000ce40: 2020 2020 7265 7475 726e 2070 6f6c 6963      return polic
+0000ce50: 795f 7661 6c75 655f 6466 5f64 6963 742c  y_value_df_dict,
+0000ce60: 2070 6f6c 6963 795f 7661 6c75 655f 696e   policy_value_in
+0000ce70: 7465 7276 616c 5f64 665f 6469 6374 0a0a  terval_df_dict..
+0000ce80: 2020 2020 6465 6620 6576 616c 7561 7465      def evaluate
+0000ce90: 5f70 6572 666f 726d 616e 6365 5f6f 665f  _performance_of_
+0000cea0: 6f70 655f 6573 7469 6d61 746f 7273 280a  ope_estimators(.
+0000ceb0: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+0000cec0: 2020 2020 2020 696e 7075 745f 6469 6374        input_dict
+0000ced0: 3a20 556e 696f 6e5b 4f50 4549 6e70 7574  : Union[OPEInput
+0000cee0: 4469 6374 2c20 4d75 6c74 6970 6c65 496e  Dict, MultipleIn
+0000cef0: 7075 7444 6963 745d 2c0a 2020 2020 2020  putDict],.      
+0000cf00: 2020 636f 6d70 6172 6564 5f65 7374 696d    compared_estim
+0000cf10: 6174 6f72 733a 204f 7074 696f 6e61 6c5b  ators: Optional[
+0000cf20: 4c69 7374 5b73 7472 5d5d 203d 204e 6f6e  List[str]] = Non
+0000cf30: 652c 0a20 2020 2020 2020 2062 6568 6176  e,.        behav
+0000cf40: 696f 725f 706f 6c69 6379 5f6e 616d 653a  ior_policy_name:
+0000cf50: 204f 7074 696f 6e61 6c5b 7374 725d 203d   Optional[str] =
+0000cf60: 204e 6f6e 652c 0a20 2020 2020 2020 2064   None,.        d
+0000cf70: 6174 6173 6574 5f69 643a 204f 7074 696f  ataset_id: Optio
+0000cf80: 6e61 6c5b 696e 745d 203d 204e 6f6e 652c  nal[int] = None,
+0000cf90: 0a20 2020 2020 2020 206d 6574 7269 633a  .        metric:
+0000cfa0: 2073 7472 203d 2022 7265 6c61 7469 7665   str = "relative
+0000cfb0: 2d65 6522 2c0a 2020 2020 2020 2020 7265  -ee",.        re
+0000cfc0: 7475 726e 5f62 795f 6461 7461 6672 616d  turn_by_datafram
+0000cfd0: 653a 2062 6f6f 6c20 3d20 4661 6c73 652c  e: bool = False,
+0000cfe0: 0a20 2020 2029 202d 3e20 4469 6374 5b73  .    ) -> Dict[s
+0000cff0: 7472 2c20 4469 6374 5b73 7472 2c20 666c  tr, Dict[str, fl
+0000d000: 6f61 745d 5d3a 0a20 2020 2020 2020 2022  oat]]:.        "
+0000d010: 2222 4576 616c 7561 7465 2074 6865 2065  ""Evaluate the e
+0000d020: 7374 696d 6174 696f 6e20 7065 7266 6f72  stimation perfor
+0000d030: 6d61 6e63 652f 6163 6375 7261 6379 206f  mance/accuracy o
+0000d040: 6620 4f50 4520 6573 7469 6d61 746f 7273  f OPE estimators
+0000d050: 2e0a 0a20 2020 2020 2020 204e 6f74 650a  ...        Note.
+0000d060: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0a          -------.
+0000d070: 2020 2020 2020 2020 4576 616c 7561 7465          Evaluate
+0000d080: 2074 6865 2065 7374 696d 6174 696f 6e20   the estimation 
+0000d090: 7065 7266 6f72 6d61 6e63 652f 6163 6375  performance/accu
+0000d0a0: 7261 6379 206f 6620 4f50 4520 6573 7469  racy of OPE esti
+0000d0b0: 6d61 746f 7273 2062 7920 7265 6c61 7469  mators by relati
+0000d0c0: 7665 2065 7374 696d 6174 696f 6e20 6572  ve estimation er
+0000d0d0: 726f 7220 2872 656c 6174 6976 652d 4545  ror (relative-EE
+0000d0e0: 2920 6f72 2073 7175 6172 6564 2065 7272  ) or squared err
+0000d0f0: 6f72 2028 5345 292e 0a0a 2020 2020 2020  or (SE)...      
+0000d100: 2020 2e2e 206d 6174 683a 3a0a 0a20 2020    .. math::..   
+0000d110: 2020 2020 2020 2020 205c 5c6d 6174 6872           \\mathr
+0000d120: 6d7b 5265 6c61 7469 7665 2d45 457d 285c  m{Relative-EE}(\
+0000d130: 5c68 6174 7b56 7d3b 205c 5c6d 6174 6863  \hat{V}; \\mathc
+0000d140: 616c 7b44 7d29 0a20 2020 2020 2020 2020  al{D}).         
+0000d150: 2020 203a 3d20 5c5c 6c65 6674 7c20 5c5c     := \\left| \\
+0000d160: 6672 6163 7b5c 5c68 6174 7b56 7d28 5c5c  frac{\\hat{V}(\\
+0000d170: 7069 3b20 5c5c 6d61 7468 6361 6c7b 447d  pi; \\mathcal{D}
+0000d180: 2920 2d20 565f 7b5c 5c6d 6174 6872 6d7b  ) - V_{\\mathrm{
+0000d190: 6f6e 7d7d 285c 5c70 6929 7d7b 565f 7b5c  on}}(\\pi)}{V_{\
+0000d1a0: 5c6d 6174 6872 6d7b 6f6e 7d7d 285c 5c70  \mathrm{on}}(\\p
+0000d1b0: 6929 7d20 5c5c 7269 6768 747c 2c0a 0a20  i)} \\right|,.. 
+0000d1c0: 2020 2020 2020 202e 2e20 6d61 7468 3a3a         .. math::
+0000d1d0: 0a0a 2020 2020 2020 2020 2020 2020 5c5c  ..            \\
+0000d1e0: 6d61 7468 726d 7b53 457d 285c 5c68 6174  mathrm{SE}(\\hat
+0000d1f0: 7b56 7d3b 205c 5c6d 6174 6863 616c 7b44  {V}; \\mathcal{D
+0000d200: 7d29 203a 3d20 5c5c 6c65 6674 2820 5c5c  }) := \\left( \\
+0000d210: 6861 747b 567d 285c 5c70 693b 205c 5c6d  hat{V}(\\pi; \\m
+0000d220: 6174 6863 616c 7b44 7d29 202d 2056 5f7b  athcal{D}) - V_{
+0000d230: 5c5c 6d61 7468 726d 7b6f 6e7d 7d20 5c5c  \\mathrm{on}} \\
+0000d240: 7269 6768 7429 5e32 2c0a 0a20 2020 2020  right)^2,..     
+0000d250: 2020 2077 6865 7265 203a 6d61 7468 3a60     where :math:`
+0000d260: 565f 7b5c 5c6d 6174 6872 6d7b 6f6e 7d7d  V_{\\mathrm{on}}
+0000d270: 285c 5c70 6929 6020 6973 2074 6865 206f  (\\pi)` is the o
+0000d280: 6e2d 706f 6c69 6379 2070 6f6c 6963 7920  n-policy policy 
+0000d290: 7661 6c75 6520 6f66 2074 6865 2065 7661  value of the eva
+0000d2a0: 6c75 6174 696f 6e20 706f 6c69 6379 203a  luation policy :
+0000d2b0: 6d61 7468 3a60 5c5c 7069 602e 0a20 2020  math:`\\pi`..   
+0000d2c0: 2020 2020 203a 6d61 7468 3a60 5c5c 6861       :math:`\\ha
+0000d2d0: 747b 567d 285c 5c70 693b 205c 5c6d 6174  t{V}(\\pi; \\mat
+0000d2e0: 6863 616c 7b44 7d29 6020 6973 2074 6865  hcal{D})` is the
+0000d2f0: 2070 6f6c 6963 7920 7661 6c75 6520 6573   policy value es
+0000d300: 7469 6d61 7465 6420 6279 2074 6865 204f  timated by the O
+0000d310: 5045 2065 7374 696d 6174 6f72 203a 6d61  PE estimator :ma
+0000d320: 7468 3a60 5c5c 6861 747b 567d 6020 616e  th:`\\hat{V}` an
+0000d330: 6420 6c6f 6767 6564 2064 6174 6173 6574  d logged dataset
+0000d340: 203a 6d61 7468 3a60 5c5c 6d61 7468 6361   :math:`\\mathca
+0000d350: 6c7b 447d 602e 0a0a 2020 2020 2020 2020  l{D}`...        
+0000d360: 5061 7261 6d65 7465 7273 0a20 2020 2020  Parameters.     
+0000d370: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 2020     -------.     
+0000d380: 2020 2069 6e70 7574 5f64 6963 743a 204f     input_dict: O
+0000d390: 5045 496e 7075 7444 6963 7420 6f72 204d  PEInputDict or M
+0000d3a0: 756c 7469 706c 6549 6e70 7574 4469 6374  ultipleInputDict
+0000d3b0: 0a20 2020 2020 2020 2020 2020 2044 6963  .            Dic
+0000d3c0: 7469 6f6e 6172 7920 6f66 2074 6865 204f  tionary of the O
+0000d3d0: 5045 2069 6e70 7574 7320 666f 7220 6561  PE inputs for ea
+0000d3e0: 6368 2065 7661 6c75 6174 696f 6e20 706f  ch evaluation po
+0000d3f0: 6c69 6379 2e0a 0a20 2020 2020 2020 2020  licy...         
+0000d400: 2020 202e 2e20 636f 6465 2d62 6c6f 636b     .. code-block
+0000d410: 3a3a 2070 7974 686f 6e0a 0a20 2020 2020  :: python..     
+0000d420: 2020 2020 2020 2020 2020 206b 6579 3a20             key: 
+0000d430: 5b65 7661 6c75 6174 696f 6e5f 706f 6c69  [evaluation_poli
+0000d440: 6379 5d5b 0a20 2020 2020 2020 2020 2020  cy][.           
+0000d450: 2020 2020 2020 2020 2065 7661 6c75 6174           evaluat
+0000d460: 696f 6e5f 706f 6c69 6379 5f61 6374 696f  ion_policy_actio
+0000d470: 6e2c 0a20 2020 2020 2020 2020 2020 2020  n,.             
+0000d480: 2020 2020 2020 2065 7661 6c75 6174 696f         evaluatio
+0000d490: 6e5f 706f 6c69 6379 5f61 6374 696f 6e5f  n_policy_action_
+0000d4a0: 6469 7374 2c0a 2020 2020 2020 2020 2020  dist,.          
+0000d4b0: 2020 2020 2020 2020 2020 7374 6174 655f            state_
+0000d4c0: 6163 7469 6f6e 5f76 616c 7565 5f70 7265  action_value_pre
+0000d4d0: 6469 6374 696f 6e2c 0a20 2020 2020 2020  diction,.       
+0000d4e0: 2020 2020 2020 2020 2020 2020 2069 6e69               ini
+0000d4f0: 7469 616c 5f73 7461 7465 5f76 616c 7565  tial_state_value
+0000d500: 5f70 7265 6469 6374 696f 6e2c 0a20 2020  _prediction,.   
 0000d510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d520: 2020 2020 7374 6174 655f 6163 7469 6f6e      state_action
-0000d530: 5f76 616c 7565 5f70 7265 6469 6374 696f  _value_predictio
-0000d540: 6e2c 0a20 2020 2020 2020 2020 2020 2020  n,.             
-0000d550: 2020 2020 2020 2069 6e69 7469 616c 5f73         initial_s
-0000d560: 7461 7465 5f76 616c 7565 5f70 7265 6469  tate_value_predi
-0000d570: 6374 696f 6e2c 0a20 2020 2020 2020 2020  ction,.         
-0000d580: 2020 2020 2020 2020 2020 2073 7461 7465             state
-0000d590: 5f61 6374 696f 6e5f 6d61 7267 696e 616c  _action_marginal
-0000d5a0: 5f69 6d70 6f72 7461 6e63 655f 7765 6967  _importance_weig
-0000d5b0: 6874 2c0a 2020 2020 2020 2020 2020 2020  ht,.            
-0000d5c0: 2020 2020 2020 2020 7374 6174 655f 6d61          state_ma
-0000d5d0: 7267 696e 616c 5f69 6d70 6f72 7461 6e63  rginal_importanc
-0000d5e0: 655f 7765 6967 6874 2c0a 2020 2020 2020  e_weight,.      
-0000d5f0: 2020 2020 2020 2020 2020 2020 2020 6f6e                on
-0000d600: 5f70 6f6c 6963 795f 706f 6c69 6379 5f76  _policy_policy_v
-0000d610: 616c 7565 2c0a 2020 2020 2020 2020 2020  alue,.          
-0000d620: 2020 2020 2020 2020 2020 6761 6d6d 612c            gamma,
-0000d630: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000d640: 2020 2020 2062 6568 6176 696f 725f 706f       behavior_po
-0000d650: 6c69 6379 2c0a 2020 2020 2020 2020 2020  licy,.          
-0000d660: 2020 2020 2020 2020 2020 6576 616c 7561            evalua
-0000d670: 7469 6f6e 5f70 6f6c 6963 792c 0a20 2020  tion_policy,.   
-0000d680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d690: 2064 6174 6173 6574 5f69 642c 0a20 2020   dataset_id,.   
-0000d6a0: 2020 2020 2020 2020 2020 2020 205d 0a0a               ]..
-0000d6b0: 2020 2020 2020 2020 2020 2020 2e2e 2073              .. s
-0000d6c0: 6565 616c 736f 3a3a 0a0a 2020 2020 2020  eealso::..      
-0000d6d0: 2020 2020 2020 2020 2020 3a63 6c61 7373            :class
-0000d6e0: 3a60 7363 6f70 655f 726c 2e6f 7065 2e69  :`scope_rl.ope.i
-0000d6f0: 6e70 7574 2e43 7265 6174 654f 5045 496e  nput.CreateOPEIn
-0000d700: 7075 7460 2064 6573 6372 6962 6573 2074  put` describes t
-0000d710: 6865 2063 6f6d 706f 6e65 6e74 7320 6f66  he components of
-0000d720: 203a 636c 6173 733a 6069 6e70 7574 5f64   :class:`input_d
-0000d730: 6963 7460 2e0a 0a20 2020 2020 2020 2063  ict`...        c
-0000d740: 6f6d 7061 7265 645f 6573 7469 6d61 746f  ompared_estimato
-0000d750: 7273 3a20 6c69 7374 206f 6620 7374 722c  rs: list of str,
-0000d760: 2064 6566 6175 6c74 3d4e 6f6e 650a 2020   default=None.  
-0000d770: 2020 2020 2020 2020 2020 4e61 6d65 206f            Name o
-0000d780: 6620 636f 6d70 6172 6564 2065 7374 696d  f compared estim
-0000d790: 6174 6f72 732e 0a20 2020 2020 2020 2020  ators..         
-0000d7a0: 2020 2049 6620 604e 6f6e 6560 2069 7320     If `None` is 
-0000d7b0: 6769 7665 6e2c 2061 6c6c 2074 6865 2065  given, all the e
-0000d7c0: 7374 696d 6174 6f72 7320 6172 6520 636f  stimators are co
-0000d7d0: 6d70 6172 6564 2e0a 0a20 2020 2020 2020  mpared...       
-0000d7e0: 2062 6568 6176 696f 725f 706f 6c69 6379   behavior_policy
-0000d7f0: 5f6e 616d 653a 2073 7472 2c20 6465 6661  _name: str, defa
-0000d800: 756c 743d 4e6f 6e65 0a20 2020 2020 2020  ult=None.       
-0000d810: 2020 2020 204e 616d 6520 6f66 2074 6865       Name of the
-0000d820: 2062 6568 6176 696f 7220 706f 6c69 6379   behavior policy
-0000d830: 2e0a 0a20 2020 2020 2020 2064 6174 6173  ...        datas
-0000d840: 6574 5f69 643a 2069 6e74 2c20 6465 6661  et_id: int, defa
-0000d850: 756c 743d 4e6f 6e65 0a20 2020 2020 2020  ult=None.       
-0000d860: 2020 2020 2049 6420 6f66 2074 6865 206c       Id of the l
-0000d870: 6f67 6765 6420 6461 7461 7365 742e 0a0a  ogged dataset...
-0000d880: 2020 2020 2020 2020 6d65 7472 6963 3a20          metric: 
-0000d890: 7b22 7265 6c61 7469 7665 2d65 6522 2c20  {"relative-ee", 
-0000d8a0: 2273 6522 7d2c 2064 6566 6175 6c74 3d22  "se"}, default="
-0000d8b0: 7265 6c61 7469 7665 2d65 6522 0a20 2020  relative-ee".   
-0000d8c0: 2020 2020 2020 2020 2045 7661 6c75 6174           Evaluat
-0000d8d0: 696f 6e20 6d65 7472 6963 2075 7365 6420  ion metric used 
-0000d8e0: 746f 2065 7661 6c75 6174 6520 616e 6420  to evaluate and 
-0000d8f0: 636f 6d70 6172 6520 7468 6520 6573 7469  compare the esti
-0000d900: 6d61 7469 6f6e 2070 6572 666f 726d 616e  mation performan
-0000d910: 6365 2f61 6363 7572 6163 7920 6f66 204f  ce/accuracy of O
-0000d920: 5045 2065 7374 696d 6174 6f72 732e 0a0a  PE estimators...
-0000d930: 2020 2020 2020 2020 7265 7475 726e 5f62          return_b
-0000d940: 795f 6461 7461 6672 616d 653a 2062 6f6f  y_dataframe: boo
-0000d950: 6c2c 2064 6566 6175 6c74 3d46 616c 7365  l, default=False
-0000d960: 0a20 2020 2020 2020 2020 2020 2057 6865  .            Whe
-0000d970: 7468 6572 2074 6f20 7265 7475 726e 2074  ther to return t
-0000d980: 6865 2072 6573 756c 7420 696e 2061 2064  he result in a d
-0000d990: 6174 6166 7261 6d65 2066 6f72 6d61 742e  ataframe format.
-0000d9a0: 0a0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
-0000d9b0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0000d9c0: 0a20 2020 2020 2020 2065 7661 6c5f 6d65  .        eval_me
-0000d9d0: 7472 6963 5f6f 7065 5f64 6963 742f 6576  tric_ope_dict/ev
-0000d9e0: 616c 5f6d 6574 7269 635f 6f70 655f 6466  al_metric_ope_df
-0000d9f0: 3a20 6469 6374 206f 7220 6461 7461 6672  : dict or datafr
-0000da00: 616d 6520 282c 206c 6973 7420 6f66 2064  ame (, list of d
-0000da10: 6963 7420 6f72 2064 6174 6166 7261 6d65  ict or dataframe
-0000da20: 290a 2020 2020 2020 2020 2020 2020 4469  ).            Di
-0000da30: 6374 696f 6e61 7279 2f64 6174 6166 7261  ctionary/datafra
-0000da40: 6d65 2063 6f6e 7461 696e 696e 6720 6576  me containing ev
-0000da50: 616c 7561 7469 6f6e 206d 6574 7269 6320  aluation metric 
-0000da60: 666f 7220 6576 616c 7561 7469 6e67 2074  for evaluating t
-0000da70: 6865 2065 7374 696d 6174 696f 6e20 7065  he estimation pe
-0000da80: 7266 6f72 6d61 6e63 652f 6163 6375 7261  rformance/accura
-0000da90: 6379 206f 6620 4f50 4520 6573 7469 6d61  cy of OPE estima
-0000daa0: 746f 7273 2e0a 2020 2020 2020 2020 2020  tors..          
-0000dab0: 2020 6b65 793a 203a 636c 6173 733a 605b    key: :class:`[
-0000dac0: 6576 616c 7561 7469 6f6e 5f70 6f6c 6963  evaluation_polic
-0000dad0: 795d 5b4f 5045 5f65 7374 696d 6174 6f72  y][OPE_estimator
-0000dae0: 5f6e 616d 655d 600a 0a20 2020 2020 2020  _name]`..       
-0000daf0: 2020 2020 2057 6865 6e20 6265 6861 7669       When behavi
-0000db00: 6f72 5f70 6f6c 6963 795f 6e61 6d65 2069  or_policy_name i
-0000db10: 7320 604e 6f6e 6560 2061 6e64 2064 6174  s `None` and dat
-0000db20: 6173 6574 5f69 6420 6973 2060 4e6f 6e65  aset_id is `None
-0000db30: 602c 0a20 2020 2020 2020 2020 2020 206b  `,.            k
-0000db40: 6579 3a20 3a63 6c61 7373 3a60 5b62 6568  ey: :class:`[beh
-0000db50: 6176 696f 725f 706f 6c69 6379 5f6e 616d  avior_policy_nam
-0000db60: 655d 5b64 6174 6173 6574 5f69 645d 5b65  e][dataset_id][e
-0000db70: 7661 6c75 6174 696f 6e5f 706f 6c69 6379  valuation_policy
-0000db80: 5d5b 4f50 455f 6573 7469 6d61 746f 725f  ][OPE_estimator_
-0000db90: 6e61 6d65 5d60 0a0a 2020 2020 2020 2020  name]`..        
-0000dba0: 2020 2020 5768 656e 2062 6568 6176 696f      When behavio
-0000dbb0: 725f 706f 6c69 6379 5f6e 616d 6520 6973  r_policy_name is
-0000dbc0: 2060 4e6f 6e65 6020 616e 6420 6461 7461   `None` and data
-0000dbd0: 7365 745f 6964 2069 7320 7370 6563 6966  set_id is specif
-0000dbe0: 6965 642c 0a20 2020 2020 2020 2020 2020  ied,.           
-0000dbf0: 206b 6579 3a20 3a63 6c61 7373 3a60 5b62   key: :class:`[b
-0000dc00: 6568 6176 696f 725f 706f 6c69 6379 5f6e  ehavior_policy_n
-0000dc10: 616d 655d 5b65 7661 6c75 6174 696f 6e5f  ame][evaluation_
-0000dc20: 706f 6c69 6379 5d5b 4f50 455f 6573 7469  policy][OPE_esti
-0000dc30: 6d61 746f 725f 6e61 6d65 5d60 0a0a 2020  mator_name]`..  
-0000dc40: 2020 2020 2020 2020 2020 5768 656e 2062            When b
-0000dc50: 6568 6176 696f 725f 706f 6c69 6379 5f6e  ehavior_policy_n
-0000dc60: 616d 6520 6973 2073 7065 6369 6669 6564  ame is specified
-0000dc70: 2061 6e64 2064 6174 6173 6574 5f69 6420   and dataset_id 
-0000dc80: 6973 2060 4e6f 6e65 602c 0a20 2020 2020  is `None`,.     
-0000dc90: 2020 2020 2020 206b 6579 3a20 3a63 6c61         key: :cla
-0000dca0: 7373 3a60 5b64 6174 6173 6574 5f69 645d  ss:`[dataset_id]
-0000dcb0: 5b4f 5045 5f65 7374 696d 6174 6f72 5f6e  [OPE_estimator_n
-0000dcc0: 616d 655d 600a 0a20 2020 2020 2020 2022  ame]`..        "
-0000dcd0: 2222 0a20 2020 2020 2020 2063 6f6d 7061  "".        compa
-0000dce0: 7265 645f 6573 7469 6d61 746f 7273 203d  red_estimators =
-0000dcf0: 2073 656c 662e 5f63 6865 636b 5f63 6f6d   self._check_com
-0000dd00: 7061 7265 645f 6573 7469 6d61 746f 7273  pared_estimators
-0000dd10: 2863 6f6d 7061 7265 645f 6573 7469 6d61  (compared_estima
-0000dd20: 746f 7273 290a 0a20 2020 2020 2020 2069  tors)..        i
-0000dd30: 6620 6d65 7472 6963 206e 6f74 2069 6e20  f metric not in 
-0000dd40: 5b22 7265 6c61 7469 7665 2d65 6522 2c20  ["relative-ee", 
-0000dd50: 2273 6522 5d3a 0a20 2020 2020 2020 2020  "se"]:.         
-0000dd60: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-0000dd70: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
-0000dd80: 2020 2020 2066 226d 6574 7269 6320 6d75       f"metric mu
-0000dd90: 7374 2062 6520 6569 7468 6572 2027 7265  st be either 're
-0000dda0: 6c61 7469 7665 2d65 6527 206f 7220 2773  lative-ee' or 's
-0000ddb0: 6527 2c20 6275 7420 7b6d 6574 7269 637d  e', but {metric}
-0000ddc0: 2069 7320 6769 7665 6e22 0a20 2020 2020   is given".     
-0000ddd0: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-0000dde0: 2020 706f 6c69 6379 5f76 616c 7565 5f64    policy_value_d
-0000ddf0: 6963 7420 3d20 7365 6c66 2e65 7374 696d  ict = self.estim
-0000de00: 6174 655f 706f 6c69 6379 5f76 616c 7565  ate_policy_value
-0000de10: 280a 2020 2020 2020 2020 2020 2020 696e  (.            in
-0000de20: 7075 745f 6469 6374 2c0a 2020 2020 2020  put_dict,.      
-0000de30: 2020 2020 2020 636f 6d70 6172 6564 5f65        compared_e
-0000de40: 7374 696d 6174 6f72 733d 636f 6d70 6172  stimators=compar
-0000de50: 6564 5f65 7374 696d 6174 6f72 732c 0a20  ed_estimators,. 
-0000de60: 2020 2020 2020 2020 2020 2062 6568 6176             behav
-0000de70: 696f 725f 706f 6c69 6379 5f6e 616d 653d  ior_policy_name=
-0000de80: 6265 6861 7669 6f72 5f70 6f6c 6963 795f  behavior_policy_
-0000de90: 6e61 6d65 2c0a 2020 2020 2020 2020 2020  name,.          
-0000dea0: 2020 6461 7461 7365 745f 6964 3d64 6174    dataset_id=dat
-0000deb0: 6173 6574 5f69 642c 0a20 2020 2020 2020  aset_id,.       
-0000dec0: 2029 0a0a 2020 2020 2020 2020 6966 2073   )..        if s
-0000ded0: 656c 662e 7573 655f 6d75 6c74 6970 6c65  elf.use_multiple
-0000dee0: 5f6c 6f67 6765 645f 6461 7461 7365 743a  _logged_dataset:
-0000def0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0000df00: 6973 696e 7374 616e 6365 2869 6e70 7574  isinstance(input
-0000df10: 5f64 6963 742c 204d 756c 7469 706c 6549  _dict, MultipleI
-0000df20: 6e70 7574 4469 6374 293a 0a20 2020 2020  nputDict):.     
-0000df30: 2020 2020 2020 2020 2020 2069 6620 6265             if be
-0000df40: 6861 7669 6f72 5f70 6f6c 6963 795f 6e61  havior_policy_na
-0000df50: 6d65 2069 7320 4e6f 6e65 2061 6e64 2064  me is None and d
-0000df60: 6174 6173 6574 5f69 6420 6973 204e 6f6e  ataset_id is Non
-0000df70: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-0000df80: 2020 2020 2020 2065 7661 6c5f 6d65 7472         eval_metr
-0000df90: 6963 5f6f 7065 203d 2064 6566 6175 6c74  ic_ope = default
-0000dfa0: 6469 6374 286c 6973 7429 0a0a 2020 2020  dict(list)..    
-0000dfb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000dfc0: 666f 7220 280a 2020 2020 2020 2020 2020  for (.          
-0000dfd0: 2020 2020 2020 2020 2020 2020 2020 6265                be
-0000dfe0: 6861 7669 6f72 5f70 6f6c 6963 792c 0a20  havior_policy,. 
-0000dff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e000: 2020 2020 2020 206e 5f64 6174 6173 6574         n_dataset
-0000e010: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
-0000e020: 2020 2020 2020 2029 2069 6e20 696e 7075         ) in inpu
-0000e030: 745f 6469 6374 2e6e 5f64 6174 6173 6574  t_dict.n_dataset
-0000e040: 732e 6974 656d 7328 293a 0a20 2020 2020  s.items():.     
-0000e050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e060: 2020 2066 6f72 2064 6174 6173 6574 5f69     for dataset_i
-0000e070: 645f 2069 6e20 7261 6e67 6528 6e5f 6461  d_ in range(n_da
-0000e080: 7461 7365 7473 293a 0a20 2020 2020 2020  tasets):.       
-0000e090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e0a0: 2020 2020 2069 6e70 7574 5f64 6963 745f       input_dict_
-0000e0b0: 203d 2069 6e70 7574 5f64 6963 742e 6765   = input_dict.ge
-0000e0c0: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
-0000e0d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e0e0: 2020 2062 6568 6176 696f 725f 706f 6c69     behavior_poli
-0000e0f0: 6379 5f6e 616d 653d 6265 6861 7669 6f72  cy_name=behavior
-0000e100: 5f70 6f6c 6963 792c 0a20 2020 2020 2020  _policy,.       
-0000e110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e120: 2020 2020 2020 2020 2064 6174 6173 6574           dataset
-0000e130: 5f69 643d 6461 7461 7365 745f 6964 5f2c  _id=dataset_id_,
-0000e140: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000e150: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
-0000e160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e170: 2020 2020 2020 2020 2020 2065 7661 6c5f             eval_
-0000e180: 6d65 7472 6963 5f6f 7065 5f20 3d20 280a  metric_ope_ = (.
-0000e190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e1b0: 7365 6c66 2e5f 6576 616c 7561 7465 5f70  self._evaluate_p
-0000e1c0: 6572 666f 726d 616e 6365 5f6f 665f 6f70  erformance_of_op
-0000e1d0: 655f 6573 7469 6d61 746f 7273 280a 2020  e_estimators(.  
-0000e1e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e1f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e200: 2020 696e 7075 745f 6469 6374 3d69 6e70    input_dict=inp
-0000e210: 7574 5f64 6963 745f 2c0a 2020 2020 2020  ut_dict_,.      
-0000e220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e230: 2020 2020 2020 2020 2020 2020 2020 706f                po
-0000e240: 6c69 6379 5f76 616c 7565 5f64 6963 743d  licy_value_dict=
-0000e250: 706f 6c69 6379 5f76 616c 7565 5f64 6963  policy_value_dic
-0000e260: 745b 0a20 2020 2020 2020 2020 2020 2020  t[.             
+0000d520: 2073 7461 7465 5f61 6374 696f 6e5f 6d61   state_action_ma
+0000d530: 7267 696e 616c 5f69 6d70 6f72 7461 6e63  rginal_importanc
+0000d540: 655f 7765 6967 6874 2c0a 2020 2020 2020  e_weight,.      
+0000d550: 2020 2020 2020 2020 2020 2020 2020 7374                st
+0000d560: 6174 655f 6d61 7267 696e 616c 5f69 6d70  ate_marginal_imp
+0000d570: 6f72 7461 6e63 655f 7765 6967 6874 2c0a  ortance_weight,.
+0000d580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d590: 2020 2020 6f6e 5f70 6f6c 6963 795f 706f      on_policy_po
+0000d5a0: 6c69 6379 5f76 616c 7565 2c0a 2020 2020  licy_value,.    
+0000d5b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d5c0: 6761 6d6d 612c 0a20 2020 2020 2020 2020  gamma,.         
+0000d5d0: 2020 2020 2020 2020 2020 2062 6568 6176             behav
+0000d5e0: 696f 725f 706f 6c69 6379 2c0a 2020 2020  ior_policy,.    
+0000d5f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d600: 6576 616c 7561 7469 6f6e 5f70 6f6c 6963  evaluation_polic
+0000d610: 792c 0a20 2020 2020 2020 2020 2020 2020  y,.             
+0000d620: 2020 2020 2020 2064 6174 6173 6574 5f69         dataset_i
+0000d630: 642c 0a20 2020 2020 2020 2020 2020 2020  d,.             
+0000d640: 2020 205d 0a0a 2020 2020 2020 2020 2020     ]..          
+0000d650: 2020 2e2e 2073 6565 616c 736f 3a3a 0a0a    .. seealso::..
+0000d660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d670: 3a63 6c61 7373 3a60 7363 6f70 655f 726c  :class:`scope_rl
+0000d680: 2e6f 7065 2e69 6e70 7574 2e43 7265 6174  .ope.input.Creat
+0000d690: 654f 5045 496e 7075 7460 2064 6573 6372  eOPEInput` descr
+0000d6a0: 6962 6573 2074 6865 2063 6f6d 706f 6e65  ibes the compone
+0000d6b0: 6e74 7320 6f66 203a 636c 6173 733a 6069  nts of :class:`i
+0000d6c0: 6e70 7574 5f64 6963 7460 2e0a 0a20 2020  nput_dict`...   
+0000d6d0: 2020 2020 2063 6f6d 7061 7265 645f 6573       compared_es
+0000d6e0: 7469 6d61 746f 7273 3a20 6c69 7374 206f  timators: list o
+0000d6f0: 6620 7374 722c 2064 6566 6175 6c74 3d4e  f str, default=N
+0000d700: 6f6e 650a 2020 2020 2020 2020 2020 2020  one.            
+0000d710: 4e61 6d65 206f 6620 636f 6d70 6172 6564  Name of compared
+0000d720: 2065 7374 696d 6174 6f72 732e 0a20 2020   estimators..   
+0000d730: 2020 2020 2020 2020 2049 6620 604e 6f6e           If `Non
+0000d740: 6560 2069 7320 6769 7665 6e2c 2061 6c6c  e` is given, all
+0000d750: 2074 6865 2065 7374 696d 6174 6f72 7320   the estimators 
+0000d760: 6172 6520 636f 6d70 6172 6564 2e0a 0a20  are compared... 
+0000d770: 2020 2020 2020 2062 6568 6176 696f 725f         behavior_
+0000d780: 706f 6c69 6379 5f6e 616d 653a 2073 7472  policy_name: str
+0000d790: 2c20 6465 6661 756c 743d 4e6f 6e65 0a20  , default=None. 
+0000d7a0: 2020 2020 2020 2020 2020 204e 616d 6520             Name 
+0000d7b0: 6f66 2074 6865 2062 6568 6176 696f 7220  of the behavior 
+0000d7c0: 706f 6c69 6379 2e0a 0a20 2020 2020 2020  policy...       
+0000d7d0: 2064 6174 6173 6574 5f69 643a 2069 6e74   dataset_id: int
+0000d7e0: 2c20 6465 6661 756c 743d 4e6f 6e65 0a20  , default=None. 
+0000d7f0: 2020 2020 2020 2020 2020 2049 6420 6f66             Id of
+0000d800: 2074 6865 206c 6f67 6765 6420 6461 7461   the logged data
+0000d810: 7365 742e 0a0a 2020 2020 2020 2020 6d65  set...        me
+0000d820: 7472 6963 3a20 7b22 7265 6c61 7469 7665  tric: {"relative
+0000d830: 2d65 6522 2c20 2273 6522 7d2c 2064 6566  -ee", "se"}, def
+0000d840: 6175 6c74 3d22 7265 6c61 7469 7665 2d65  ault="relative-e
+0000d850: 6522 0a20 2020 2020 2020 2020 2020 2045  e".            E
+0000d860: 7661 6c75 6174 696f 6e20 6d65 7472 6963  valuation metric
+0000d870: 2075 7365 6420 746f 2065 7661 6c75 6174   used to evaluat
+0000d880: 6520 616e 6420 636f 6d70 6172 6520 7468  e and compare th
+0000d890: 6520 6573 7469 6d61 7469 6f6e 2070 6572  e estimation per
+0000d8a0: 666f 726d 616e 6365 2f61 6363 7572 6163  formance/accurac
+0000d8b0: 7920 6f66 204f 5045 2065 7374 696d 6174  y of OPE estimat
+0000d8c0: 6f72 732e 0a0a 2020 2020 2020 2020 7265  ors...        re
+0000d8d0: 7475 726e 5f62 795f 6461 7461 6672 616d  turn_by_datafram
+0000d8e0: 653a 2062 6f6f 6c2c 2064 6566 6175 6c74  e: bool, default
+0000d8f0: 3d46 616c 7365 0a20 2020 2020 2020 2020  =False.         
+0000d900: 2020 2057 6865 7468 6572 2074 6f20 7265     Whether to re
+0000d910: 7475 726e 2074 6865 2072 6573 756c 7420  turn the result 
+0000d920: 696e 2061 2064 6174 6166 7261 6d65 2066  in a dataframe f
+0000d930: 6f72 6d61 742e 0a0a 2020 2020 2020 2020  ormat...        
+0000d940: 5265 7475 726e 0a20 2020 2020 2020 202d  Return.        -
+0000d950: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2065  ------.        e
+0000d960: 7661 6c5f 6d65 7472 6963 5f6f 7065 5f64  val_metric_ope_d
+0000d970: 6963 742f 6576 616c 5f6d 6574 7269 635f  ict/eval_metric_
+0000d980: 6f70 655f 6466 3a20 6469 6374 206f 7220  ope_df: dict or 
+0000d990: 6461 7461 6672 616d 6520 282c 206c 6973  dataframe (, lis
+0000d9a0: 7420 6f66 2064 6963 7420 6f72 2064 6174  t of dict or dat
+0000d9b0: 6166 7261 6d65 290a 2020 2020 2020 2020  aframe).        
+0000d9c0: 2020 2020 4469 6374 696f 6e61 7279 2f64      Dictionary/d
+0000d9d0: 6174 6166 7261 6d65 2063 6f6e 7461 696e  ataframe contain
+0000d9e0: 696e 6720 6576 616c 7561 7469 6f6e 206d  ing evaluation m
+0000d9f0: 6574 7269 6320 666f 7220 6576 616c 7561  etric for evalua
+0000da00: 7469 6e67 2074 6865 2065 7374 696d 6174  ting the estimat
+0000da10: 696f 6e20 7065 7266 6f72 6d61 6e63 652f  ion performance/
+0000da20: 6163 6375 7261 6379 206f 6620 4f50 4520  accuracy of OPE 
+0000da30: 6573 7469 6d61 746f 7273 2e0a 2020 2020  estimators..    
+0000da40: 2020 2020 2020 2020 6b65 793a 203a 636c          key: :cl
+0000da50: 6173 733a 605b 6576 616c 7561 7469 6f6e  ass:`[evaluation
+0000da60: 5f70 6f6c 6963 795d 5b4f 5045 5f65 7374  _policy][OPE_est
+0000da70: 696d 6174 6f72 5f6e 616d 655d 600a 0a20  imator_name]`.. 
+0000da80: 2020 2020 2020 2020 2020 2057 6865 6e20             When 
+0000da90: 6265 6861 7669 6f72 5f70 6f6c 6963 795f  behavior_policy_
+0000daa0: 6e61 6d65 2069 7320 604e 6f6e 6560 2061  name is `None` a
+0000dab0: 6e64 2064 6174 6173 6574 5f69 6420 6973  nd dataset_id is
+0000dac0: 2060 4e6f 6e65 602c 0a20 2020 2020 2020   `None`,.       
+0000dad0: 2020 2020 206b 6579 3a20 3a63 6c61 7373       key: :class
+0000dae0: 3a60 5b62 6568 6176 696f 725f 706f 6c69  :`[behavior_poli
+0000daf0: 6379 5f6e 616d 655d 5b64 6174 6173 6574  cy_name][dataset
+0000db00: 5f69 645d 5b65 7661 6c75 6174 696f 6e5f  _id][evaluation_
+0000db10: 706f 6c69 6379 5d5b 4f50 455f 6573 7469  policy][OPE_esti
+0000db20: 6d61 746f 725f 6e61 6d65 5d60 0a0a 2020  mator_name]`..  
+0000db30: 2020 2020 2020 2020 2020 5768 656e 2062            When b
+0000db40: 6568 6176 696f 725f 706f 6c69 6379 5f6e  ehavior_policy_n
+0000db50: 616d 6520 6973 2060 4e6f 6e65 6020 616e  ame is `None` an
+0000db60: 6420 6461 7461 7365 745f 6964 2069 7320  d dataset_id is 
+0000db70: 7370 6563 6966 6965 642c 0a20 2020 2020  specified,.     
+0000db80: 2020 2020 2020 206b 6579 3a20 3a63 6c61         key: :cla
+0000db90: 7373 3a60 5b62 6568 6176 696f 725f 706f  ss:`[behavior_po
+0000dba0: 6c69 6379 5f6e 616d 655d 5b65 7661 6c75  licy_name][evalu
+0000dbb0: 6174 696f 6e5f 706f 6c69 6379 5d5b 4f50  ation_policy][OP
+0000dbc0: 455f 6573 7469 6d61 746f 725f 6e61 6d65  E_estimator_name
+0000dbd0: 5d60 0a0a 2020 2020 2020 2020 2020 2020  ]`..            
+0000dbe0: 5768 656e 2062 6568 6176 696f 725f 706f  When behavior_po
+0000dbf0: 6c69 6379 5f6e 616d 6520 6973 2073 7065  licy_name is spe
+0000dc00: 6369 6669 6564 2061 6e64 2064 6174 6173  cified and datas
+0000dc10: 6574 5f69 6420 6973 2060 4e6f 6e65 602c  et_id is `None`,
+0000dc20: 0a20 2020 2020 2020 2020 2020 206b 6579  .            key
+0000dc30: 3a20 3a63 6c61 7373 3a60 5b64 6174 6173  : :class:`[datas
+0000dc40: 6574 5f69 645d 5b4f 5045 5f65 7374 696d  et_id][OPE_estim
+0000dc50: 6174 6f72 5f6e 616d 655d 600a 0a20 2020  ator_name]`..   
+0000dc60: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0000dc70: 2063 6f6d 7061 7265 645f 6573 7469 6d61   compared_estima
+0000dc80: 746f 7273 203d 2073 656c 662e 5f63 6865  tors = self._che
+0000dc90: 636b 5f63 6f6d 7061 7265 645f 6573 7469  ck_compared_esti
+0000dca0: 6d61 746f 7273 2863 6f6d 7061 7265 645f  mators(compared_
+0000dcb0: 6573 7469 6d61 746f 7273 290a 0a20 2020  estimators)..   
+0000dcc0: 2020 2020 2069 6620 6d65 7472 6963 206e       if metric n
+0000dcd0: 6f74 2069 6e20 5b22 7265 6c61 7469 7665  ot in ["relative
+0000dce0: 2d65 6522 2c20 2273 6522 5d3a 0a20 2020  -ee", "se"]:.   
+0000dcf0: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+0000dd00: 616c 7565 4572 726f 7228 0a20 2020 2020  alueError(.     
+0000dd10: 2020 2020 2020 2020 2020 2066 226d 6574             f"met
+0000dd20: 7269 6320 6d75 7374 2062 6520 6569 7468  ric must be eith
+0000dd30: 6572 2027 7265 6c61 7469 7665 2d65 6527  er 'relative-ee'
+0000dd40: 206f 7220 2773 6527 2c20 6275 7420 7b6d   or 'se', but {m
+0000dd50: 6574 7269 637d 2069 7320 6769 7665 6e22  etric} is given"
+0000dd60: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
+0000dd70: 2020 2020 2020 2020 706f 6c69 6379 5f76          policy_v
+0000dd80: 616c 7565 5f64 6963 7420 3d20 7365 6c66  alue_dict = self
+0000dd90: 2e65 7374 696d 6174 655f 706f 6c69 6379  .estimate_policy
+0000dda0: 5f76 616c 7565 280a 2020 2020 2020 2020  _value(.        
+0000ddb0: 2020 2020 696e 7075 745f 6469 6374 2c0a      input_dict,.
+0000ddc0: 2020 2020 2020 2020 2020 2020 636f 6d70              comp
+0000ddd0: 6172 6564 5f65 7374 696d 6174 6f72 733d  ared_estimators=
+0000dde0: 636f 6d70 6172 6564 5f65 7374 696d 6174  compared_estimat
+0000ddf0: 6f72 732c 0a20 2020 2020 2020 2020 2020  ors,.           
+0000de00: 2062 6568 6176 696f 725f 706f 6c69 6379   behavior_policy
+0000de10: 5f6e 616d 653d 6265 6861 7669 6f72 5f70  _name=behavior_p
+0000de20: 6f6c 6963 795f 6e61 6d65 2c0a 2020 2020  olicy_name,.    
+0000de30: 2020 2020 2020 2020 6461 7461 7365 745f          dataset_
+0000de40: 6964 3d64 6174 6173 6574 5f69 642c 0a20  id=dataset_id,. 
+0000de50: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+0000de60: 2020 6966 2073 656c 662e 7573 655f 6d75    if self.use_mu
+0000de70: 6c74 6970 6c65 5f6c 6f67 6765 645f 6461  ltiple_logged_da
+0000de80: 7461 7365 743a 0a20 2020 2020 2020 2020  taset:.         
+0000de90: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+0000dea0: 2869 6e70 7574 5f64 6963 742c 204d 756c  (input_dict, Mul
+0000deb0: 7469 706c 6549 6e70 7574 4469 6374 293a  tipleInputDict):
+0000dec0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000ded0: 2069 6620 6265 6861 7669 6f72 5f70 6f6c   if behavior_pol
+0000dee0: 6963 795f 6e61 6d65 2069 7320 4e6f 6e65  icy_name is None
+0000def0: 2061 6e64 2064 6174 6173 6574 5f69 6420   and dataset_id 
+0000df00: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
+0000df10: 2020 2020 2020 2020 2020 2020 2065 7661               eva
+0000df20: 6c5f 6d65 7472 6963 5f6f 7065 203d 2064  l_metric_ope = d
+0000df30: 6566 6175 6c74 6469 6374 286c 6973 7429  efaultdict(list)
+0000df40: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000df50: 2020 2020 2020 666f 7220 280a 2020 2020        for (.    
+0000df60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000df70: 2020 2020 6265 6861 7669 6f72 5f70 6f6c      behavior_pol
+0000df80: 6963 792c 0a20 2020 2020 2020 2020 2020  icy,.           
+0000df90: 2020 2020 2020 2020 2020 2020 206e 5f64               n_d
+0000dfa0: 6174 6173 6574 732c 0a20 2020 2020 2020  atasets,.       
+0000dfb0: 2020 2020 2020 2020 2020 2020 2029 2069               ) i
+0000dfc0: 6e20 696e 7075 745f 6469 6374 2e6e 5f64  n input_dict.n_d
+0000dfd0: 6174 6173 6574 732e 6974 656d 7328 293a  atasets.items():
+0000dfe0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000dff0: 2020 2020 2020 2020 2066 6f72 2064 6174           for dat
+0000e000: 6173 6574 5f69 645f 2069 6e20 7261 6e67  aset_id_ in rang
+0000e010: 6528 6e5f 6461 7461 7365 7473 293a 0a20  e(n_datasets):. 
+0000e020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e030: 2020 2020 2020 2020 2020 2069 6e70 7574             input
+0000e040: 5f64 6963 745f 203d 2069 6e70 7574 5f64  _dict_ = input_d
+0000e050: 6963 742e 6765 7428 0a20 2020 2020 2020  ict.get(.       
+0000e060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e070: 2020 2020 2020 2020 2062 6568 6176 696f           behavio
+0000e080: 725f 706f 6c69 6379 5f6e 616d 653d 6265  r_policy_name=be
+0000e090: 6861 7669 6f72 5f70 6f6c 6963 792c 0a20  havior_policy,. 
+0000e0a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e0b0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+0000e0c0: 6174 6173 6574 5f69 643d 6461 7461 7365  ataset_id=datase
+0000e0d0: 745f 6964 5f2c 0a20 2020 2020 2020 2020  t_id_,.         
+0000e0e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e0f0: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+0000e100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e110: 2065 7661 6c5f 6d65 7472 6963 5f6f 7065   eval_metric_ope
+0000e120: 5f20 3d20 280a 2020 2020 2020 2020 2020  _ = (.          
+0000e130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e140: 2020 2020 2020 7365 6c66 2e5f 6576 616c        self._eval
+0000e150: 7561 7465 5f70 6572 666f 726d 616e 6365  uate_performance
+0000e160: 5f6f 665f 6f70 655f 6573 7469 6d61 746f  _of_ope_estimato
+0000e170: 7273 280a 2020 2020 2020 2020 2020 2020  rs(.            
+0000e180: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e190: 2020 2020 2020 2020 696e 7075 745f 6469          input_di
+0000e1a0: 6374 3d69 6e70 7574 5f64 6963 745f 2c0a  ct=input_dict_,.
+0000e1b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e1c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e1d0: 2020 2020 706f 6c69 6379 5f76 616c 7565      policy_value
+0000e1e0: 5f64 6963 743d 706f 6c69 6379 5f76 616c  _dict=policy_val
+0000e1f0: 7565 5f64 6963 745b 0a20 2020 2020 2020  ue_dict[.       
+0000e200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e220: 2062 6568 6176 696f 725f 706f 6c69 6379   behavior_policy
+0000e230: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000e240: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e250: 2020 2020 205d 5b64 6174 6173 6574 5f69       ][dataset_i
+0000e260: 645f 5d2c 0a20 2020 2020 2020 2020 2020  d_],.           
 0000e270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e280: 2020 2020 2020 2020 2020 2062 6568 6176             behav
-0000e290: 696f 725f 706f 6c69 6379 0a20 2020 2020  ior_policy.     
-0000e2a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e2b0: 2020 2020 2020 2020 2020 2020 2020 205d                 ]
-0000e2c0: 5b64 6174 6173 6574 5f69 645f 5d2c 0a20  [dataset_id_],. 
-0000e2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e2e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e2f0: 2020 2063 6f6d 7061 7265 645f 6573 7469     compared_esti
-0000e300: 6d61 746f 7273 3d63 6f6d 7061 7265 645f  mators=compared_
-0000e310: 6573 7469 6d61 746f 7273 2c0a 2020 2020  estimators,.    
-0000e320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e340: 6d65 7472 6963 3d6d 6574 7269 632c 0a20  metric=metric,. 
-0000e350: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e280: 2020 2020 2020 2020 2063 6f6d 7061 7265           compare
+0000e290: 645f 6573 7469 6d61 746f 7273 3d63 6f6d  d_estimators=com
+0000e2a0: 7061 7265 645f 6573 7469 6d61 746f 7273  pared_estimators
+0000e2b0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0000e2c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e2d0: 2020 2020 2020 6d65 7472 6963 3d6d 6574        metric=met
+0000e2e0: 7269 632c 0a20 2020 2020 2020 2020 2020  ric,.           
+0000e2f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e300: 2020 2020 2020 2020 2072 6574 7572 6e5f           return_
+0000e310: 6279 5f64 6174 6166 7261 6d65 3d72 6574  by_dataframe=ret
+0000e320: 7572 6e5f 6279 5f64 6174 6166 7261 6d65  urn_by_dataframe
+0000e330: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0000e340: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e350: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
 0000e360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e370: 2020 2072 6574 7572 6e5f 6279 5f64 6174     return_by_dat
-0000e380: 6166 7261 6d65 3d72 6574 7572 6e5f 6279  aframe=return_by
-0000e390: 5f64 6174 6166 7261 6d65 2c0a 2020 2020  _dataframe,.    
-0000e3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e3b0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-0000e3c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e3d0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-0000e3e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e3f0: 2020 2020 2020 2020 6576 616c 5f6d 6574          eval_met
-0000e400: 7269 635f 6f70 655b 6265 6861 7669 6f72  ric_ope[behavior
-0000e410: 5f70 6f6c 6963 795d 2e61 7070 656e 6428  _policy].append(
-0000e420: 6576 616c 5f6d 6574 7269 635f 6f70 655f  eval_metric_ope_
-0000e430: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
-0000e440: 2020 2020 2020 2065 7661 6c5f 6d65 7472         eval_metr
-0000e450: 6963 5f6f 7065 203d 2064 6566 6175 6c74  ic_ope = default
-0000e460: 6469 6374 5f74 6f5f 6469 6374 2865 7661  dict_to_dict(eva
-0000e470: 6c5f 6d65 7472 6963 5f6f 7065 290a 0a20  l_metric_ope).. 
-0000e480: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0000e490: 6c69 6620 6265 6861 7669 6f72 5f70 6f6c  lif behavior_pol
-0000e4a0: 6963 795f 6e61 6d65 2069 7320 4e6f 6e65  icy_name is None
-0000e4b0: 2061 6e64 2064 6174 6173 6574 5f69 6420   and dataset_id 
-0000e4c0: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
-0000e4d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e4e0: 2065 7661 6c5f 6d65 7472 6963 5f6f 7065   eval_metric_ope
-0000e4f0: 203d 207b 7d0a 0a20 2020 2020 2020 2020   = {}..         
-0000e500: 2020 2020 2020 2020 2020 2066 6f72 2062             for b
-0000e510: 6568 6176 696f 725f 706f 6c69 6379 2069  ehavior_policy i
-0000e520: 6e20 696e 7075 745f 6469 6374 2e62 6568  n input_dict.beh
-0000e530: 6176 696f 725f 706f 6c69 6379 5f6e 616d  avior_policy_nam
-0000e540: 6573 3a0a 2020 2020 2020 2020 2020 2020  es:.            
-0000e550: 2020 2020 2020 2020 2020 2020 696e 7075              inpu
-0000e560: 745f 6469 6374 5f20 3d20 696e 7075 745f  t_dict_ = input_
-0000e570: 6469 6374 2e67 6574 280a 2020 2020 2020  dict.get(.      
-0000e580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e590: 2020 2020 2020 6265 6861 7669 6f72 5f70        behavior_p
-0000e5a0: 6f6c 6963 795f 6e61 6d65 3d62 6568 6176  olicy_name=behav
-0000e5b0: 696f 725f 706f 6c69 6379 2c20 6461 7461  ior_policy, data
-0000e5c0: 7365 745f 6964 3d64 6174 6173 6574 5f69  set_id=dataset_i
-0000e5d0: 640a 2020 2020 2020 2020 2020 2020 2020  d.              
-0000e5e0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-0000e5f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e600: 2020 2020 6576 616c 5f6d 6574 7269 635f      eval_metric_
-0000e610: 6f70 655f 203d 2073 656c 662e 5f65 7661  ope_ = self._eva
-0000e620: 6c75 6174 655f 7065 7266 6f72 6d61 6e63  luate_performanc
-0000e630: 655f 6f66 5f6f 7065 5f65 7374 696d 6174  e_of_ope_estimat
-0000e640: 6f72 7328 0a20 2020 2020 2020 2020 2020  ors(.           
-0000e650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e660: 2069 6e70 7574 5f64 6963 743d 696e 7075   input_dict=inpu
-0000e670: 745f 6469 6374 5f2c 0a20 2020 2020 2020  t_dict_,.       
-0000e680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e690: 2020 2020 2070 6f6c 6963 795f 7661 6c75       policy_valu
-0000e6a0: 655f 6469 6374 3d70 6f6c 6963 795f 7661  e_dict=policy_va
-0000e6b0: 6c75 655f 6469 6374 5b62 6568 6176 696f  lue_dict[behavio
-0000e6c0: 725f 706f 6c69 6379 5d2c 0a20 2020 2020  r_policy],.     
-0000e6d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e6e0: 2020 2020 2020 2063 6f6d 7061 7265 645f         compared_
-0000e6f0: 6573 7469 6d61 746f 7273 3d63 6f6d 7061  estimators=compa
-0000e700: 7265 645f 6573 7469 6d61 746f 7273 2c0a  red_estimators,.
-0000e710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e720: 2020 2020 2020 2020 2020 2020 6d65 7472              metr
-0000e730: 6963 3d6d 6574 7269 632c 0a20 2020 2020  ic=metric,.     
-0000e740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e750: 2020 2020 2020 2072 6574 7572 6e5f 6279         return_by
-0000e760: 5f64 6174 6166 7261 6d65 3d72 6574 7572  _dataframe=retur
-0000e770: 6e5f 6279 5f64 6174 6166 7261 6d65 2c0a  n_by_dataframe,.
-0000e780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e790: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0000e7a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e7b0: 2020 6576 616c 5f6d 6574 7269 635f 6f70    eval_metric_op
-0000e7c0: 655b 6265 6861 7669 6f72 5f70 6f6c 6963  e[behavior_polic
-0000e7d0: 795d 203d 2065 7661 6c5f 6d65 7472 6963  y] = eval_metric
-0000e7e0: 5f6f 7065 5f0a 0a20 2020 2020 2020 2020  _ope_..         
-0000e7f0: 2020 2020 2020 2065 6c69 6620 6265 6861         elif beha
-0000e800: 7669 6f72 5f70 6f6c 6963 795f 6e61 6d65  vior_policy_name
-0000e810: 2069 7320 6e6f 7420 4e6f 6e65 2061 6e64   is not None and
-0000e820: 2064 6174 6173 6574 5f69 6420 6973 204e   dataset_id is N
-0000e830: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-0000e840: 2020 2020 2020 2020 2065 7661 6c5f 6d65           eval_me
-0000e850: 7472 6963 5f6f 7065 203d 205b 5d0a 0a20  tric_ope = [].. 
-0000e860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e870: 2020 2066 6f72 2064 6174 6173 6574 5f69     for dataset_i
-0000e880: 645f 2069 6e20 7261 6e67 6528 0a20 2020  d_ in range(.   
-0000e890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e8a0: 2020 2020 2069 6e70 7574 5f64 6963 742e       input_dict.
-0000e8b0: 6e5f 6461 7461 7365 7473 5b62 6568 6176  n_datasets[behav
-0000e8c0: 696f 725f 706f 6c69 6379 5f6e 616d 655d  ior_policy_name]
-0000e8d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000e8e0: 2020 2020 2029 3a0a 2020 2020 2020 2020       ):.        
-0000e8f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e900: 696e 7075 745f 6469 6374 5f20 3d20 696e  input_dict_ = in
-0000e910: 7075 745f 6469 6374 2e67 6574 280a 2020  put_dict.get(.  
-0000e920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e930: 2020 2020 2020 2020 2020 6265 6861 7669            behavi
-0000e940: 6f72 5f70 6f6c 6963 795f 6e61 6d65 3d62  or_policy_name=b
-0000e950: 6568 6176 696f 725f 706f 6c69 6379 2c0a  ehavior_policy,.
-0000e960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e970: 2020 2020 2020 2020 2020 2020 6461 7461              data
-0000e980: 7365 745f 6964 3d64 6174 6173 6574 5f69  set_id=dataset_i
-0000e990: 645f 2c0a 2020 2020 2020 2020 2020 2020  d_,.            
-0000e9a0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-0000e9b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e9c0: 2020 2020 2020 6576 616c 5f6d 6574 7269        eval_metri
-0000e9d0: 635f 6f70 655f 203d 2073 656c 662e 5f65  c_ope_ = self._e
-0000e9e0: 7661 6c75 6174 655f 7065 7266 6f72 6d61  valuate_performa
-0000e9f0: 6e63 655f 6f66 5f6f 7065 5f65 7374 696d  nce_of_ope_estim
-0000ea00: 6174 6f72 7328 0a20 2020 2020 2020 2020  ators(.         
-0000ea10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ea20: 2020 2069 6e70 7574 5f64 6963 743d 696e     input_dict=in
-0000ea30: 7075 745f 6469 6374 5f2c 0a20 2020 2020  put_dict_,.     
-0000ea40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ea50: 2020 2020 2020 2070 6f6c 6963 795f 7661         policy_va
-0000ea60: 6c75 655f 6469 6374 3d70 6f6c 6963 795f  lue_dict=policy_
-0000ea70: 7661 6c75 655f 6469 6374 5b64 6174 6173  value_dict[datas
-0000ea80: 6574 5f69 645f 5d2c 0a20 2020 2020 2020  et_id_],.       
+0000e370: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0000e380: 2020 2020 2020 2020 2020 2020 2020 6576                ev
+0000e390: 616c 5f6d 6574 7269 635f 6f70 655b 6265  al_metric_ope[be
+0000e3a0: 6861 7669 6f72 5f70 6f6c 6963 795d 2e61  havior_policy].a
+0000e3b0: 7070 656e 6428 6576 616c 5f6d 6574 7269  ppend(eval_metri
+0000e3c0: 635f 6f70 655f 290a 0a20 2020 2020 2020  c_ope_)..       
+0000e3d0: 2020 2020 2020 2020 2020 2020 2065 7661               eva
+0000e3e0: 6c5f 6d65 7472 6963 5f6f 7065 203d 2064  l_metric_ope = d
+0000e3f0: 6566 6175 6c74 6469 6374 5f74 6f5f 6469  efaultdict_to_di
+0000e400: 6374 2865 7661 6c5f 6d65 7472 6963 5f6f  ct(eval_metric_o
+0000e410: 7065 290a 0a20 2020 2020 2020 2020 2020  pe)..           
+0000e420: 2020 2020 2065 6c69 6620 6265 6861 7669       elif behavi
+0000e430: 6f72 5f70 6f6c 6963 795f 6e61 6d65 2069  or_policy_name i
+0000e440: 7320 4e6f 6e65 2061 6e64 2064 6174 6173  s None and datas
+0000e450: 6574 5f69 6420 6973 206e 6f74 204e 6f6e  et_id is not Non
+0000e460: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+0000e470: 2020 2020 2020 2065 7661 6c5f 6d65 7472         eval_metr
+0000e480: 6963 5f6f 7065 203d 207b 7d0a 0a20 2020  ic_ope = {}..   
+0000e490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e4a0: 2066 6f72 2062 6568 6176 696f 725f 706f   for behavior_po
+0000e4b0: 6c69 6379 2069 6e20 696e 7075 745f 6469  licy in input_di
+0000e4c0: 6374 2e62 6568 6176 696f 725f 706f 6c69  ct.behavior_poli
+0000e4d0: 6379 5f6e 616d 6573 3a0a 2020 2020 2020  cy_names:.      
+0000e4e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e4f0: 2020 696e 7075 745f 6469 6374 5f20 3d20    input_dict_ = 
+0000e500: 696e 7075 745f 6469 6374 2e67 6574 280a  input_dict.get(.
+0000e510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e520: 2020 2020 2020 2020 2020 2020 6265 6861              beha
+0000e530: 7669 6f72 5f70 6f6c 6963 795f 6e61 6d65  vior_policy_name
+0000e540: 3d62 6568 6176 696f 725f 706f 6c69 6379  =behavior_policy
+0000e550: 2c20 6461 7461 7365 745f 6964 3d64 6174  , dataset_id=dat
+0000e560: 6173 6574 5f69 640a 2020 2020 2020 2020  aset_id.        
+0000e570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e580: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0000e590: 2020 2020 2020 2020 2020 6576 616c 5f6d            eval_m
+0000e5a0: 6574 7269 635f 6f70 655f 203d 2073 656c  etric_ope_ = sel
+0000e5b0: 662e 5f65 7661 6c75 6174 655f 7065 7266  f._evaluate_perf
+0000e5c0: 6f72 6d61 6e63 655f 6f66 5f6f 7065 5f65  ormance_of_ope_e
+0000e5d0: 7374 696d 6174 6f72 7328 0a20 2020 2020  stimators(.     
+0000e5e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e5f0: 2020 2020 2020 2069 6e70 7574 5f64 6963         input_dic
+0000e600: 743d 696e 7075 745f 6469 6374 5f2c 0a20  t=input_dict_,. 
+0000e610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e620: 2020 2020 2020 2020 2020 2070 6f6c 6963             polic
+0000e630: 795f 7661 6c75 655f 6469 6374 3d70 6f6c  y_value_dict=pol
+0000e640: 6963 795f 7661 6c75 655f 6469 6374 5b62  icy_value_dict[b
+0000e650: 6568 6176 696f 725f 706f 6c69 6379 5d2c  ehavior_policy],
+0000e660: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000e670: 2020 2020 2020 2020 2020 2020 2063 6f6d               com
+0000e680: 7061 7265 645f 6573 7469 6d61 746f 7273  pared_estimators
+0000e690: 3d63 6f6d 7061 7265 645f 6573 7469 6d61  =compared_estima
+0000e6a0: 746f 7273 2c0a 2020 2020 2020 2020 2020  tors,.          
+0000e6b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e6c0: 2020 6d65 7472 6963 3d6d 6574 7269 632c    metric=metric,
+0000e6d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000e6e0: 2020 2020 2020 2020 2020 2020 2072 6574               ret
+0000e6f0: 7572 6e5f 6279 5f64 6174 6166 7261 6d65  urn_by_dataframe
+0000e700: 3d72 6574 7572 6e5f 6279 5f64 6174 6166  =return_by_dataf
+0000e710: 7261 6d65 2c0a 2020 2020 2020 2020 2020  rame,.          
+0000e720: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+0000e730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e740: 2020 2020 2020 2020 6576 616c 5f6d 6574          eval_met
+0000e750: 7269 635f 6f70 655b 6265 6861 7669 6f72  ric_ope[behavior
+0000e760: 5f70 6f6c 6963 795d 203d 2065 7661 6c5f  _policy] = eval_
+0000e770: 6d65 7472 6963 5f6f 7065 5f0a 0a20 2020  metric_ope_..   
+0000e780: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
+0000e790: 6620 6265 6861 7669 6f72 5f70 6f6c 6963  f behavior_polic
+0000e7a0: 795f 6e61 6d65 2069 7320 6e6f 7420 4e6f  y_name is not No
+0000e7b0: 6e65 2061 6e64 2064 6174 6173 6574 5f69  ne and dataset_i
+0000e7c0: 6420 6973 204e 6f6e 653a 0a20 2020 2020  d is None:.     
+0000e7d0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0000e7e0: 7661 6c5f 6d65 7472 6963 5f6f 7065 203d  val_metric_ope =
+0000e7f0: 205b 5d0a 0a20 2020 2020 2020 2020 2020   []..           
+0000e800: 2020 2020 2020 2020 2066 6f72 2064 6174           for dat
+0000e810: 6173 6574 5f69 645f 2069 6e20 7261 6e67  aset_id_ in rang
+0000e820: 6528 0a20 2020 2020 2020 2020 2020 2020  e(.             
+0000e830: 2020 2020 2020 2020 2020 2069 6e70 7574             input
+0000e840: 5f64 6963 742e 6e5f 6461 7461 7365 7473  _dict.n_datasets
+0000e850: 5b62 6568 6176 696f 725f 706f 6c69 6379  [behavior_policy
+0000e860: 5f6e 616d 655d 0a20 2020 2020 2020 2020  _name].         
+0000e870: 2020 2020 2020 2020 2020 2029 3a0a 2020             ):.  
+0000e880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e890: 2020 2020 2020 696e 7075 745f 6469 6374        input_dict
+0000e8a0: 5f20 3d20 696e 7075 745f 6469 6374 2e67  _ = input_dict.g
+0000e8b0: 6574 280a 2020 2020 2020 2020 2020 2020  et(.            
+0000e8c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e8d0: 6265 6861 7669 6f72 5f70 6f6c 6963 795f  behavior_policy_
+0000e8e0: 6e61 6d65 3d62 6568 6176 696f 725f 706f  name=behavior_po
+0000e8f0: 6c69 6379 2c0a 2020 2020 2020 2020 2020  licy,.          
+0000e900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e910: 2020 6461 7461 7365 745f 6964 3d64 6174    dataset_id=dat
+0000e920: 6173 6574 5f69 645f 2c0a 2020 2020 2020  aset_id_,.      
+0000e930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e940: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+0000e950: 2020 2020 2020 2020 2020 2020 6576 616c              eval
+0000e960: 5f6d 6574 7269 635f 6f70 655f 203d 2073  _metric_ope_ = s
+0000e970: 656c 662e 5f65 7661 6c75 6174 655f 7065  elf._evaluate_pe
+0000e980: 7266 6f72 6d61 6e63 655f 6f66 5f6f 7065  rformance_of_ope
+0000e990: 5f65 7374 696d 6174 6f72 7328 0a20 2020  _estimators(.   
+0000e9a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e9b0: 2020 2020 2020 2020 2069 6e70 7574 5f64           input_d
+0000e9c0: 6963 743d 696e 7075 745f 6469 6374 5f2c  ict=input_dict_,
+0000e9d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000e9e0: 2020 2020 2020 2020 2020 2020 2070 6f6c               pol
+0000e9f0: 6963 795f 7661 6c75 655f 6469 6374 3d70  icy_value_dict=p
+0000ea00: 6f6c 6963 795f 7661 6c75 655f 6469 6374  olicy_value_dict
+0000ea10: 5b64 6174 6173 6574 5f69 645f 5d2c 0a20  [dataset_id_],. 
+0000ea20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ea30: 2020 2020 2020 2020 2020 2063 6f6d 7061             compa
+0000ea40: 7265 645f 6573 7469 6d61 746f 7273 3d63  red_estimators=c
+0000ea50: 6f6d 7061 7265 645f 6573 7469 6d61 746f  ompared_estimato
+0000ea60: 7273 2c0a 2020 2020 2020 2020 2020 2020  rs,.            
+0000ea70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ea80: 6d65 7472 6963 3d6d 6574 7269 632c 0a20  metric=metric,. 
 0000ea90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000eaa0: 2020 2020 2063 6f6d 7061 7265 645f 6573       compared_es
-0000eab0: 7469 6d61 746f 7273 3d63 6f6d 7061 7265  timators=compare
-0000eac0: 645f 6573 7469 6d61 746f 7273 2c0a 2020  d_estimators,.  
-0000ead0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000eae0: 2020 2020 2020 2020 2020 6d65 7472 6963            metric
-0000eaf0: 3d6d 6574 7269 632c 0a20 2020 2020 2020  =metric,.       
-0000eb00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000eb10: 2020 2020 2072 6574 7572 6e5f 6279 5f64       return_by_d
-0000eb20: 6174 6166 7261 6d65 3d72 6574 7572 6e5f  ataframe=return_
-0000eb30: 6279 5f64 6174 6166 7261 6d65 2c0a 2020  by_dataframe,.  
-0000eb40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000eb50: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-0000eb60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000eb70: 6576 616c 5f6d 6574 7269 635f 6f70 652e  eval_metric_ope.
-0000eb80: 6170 7065 6e64 2865 7661 6c5f 6d65 7472  append(eval_metr
-0000eb90: 6963 5f6f 7065 5f29 0a0a 2020 2020 2020  ic_ope_)..      
-0000eba0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-0000ebb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ebc0: 2020 2020 696e 7075 745f 6469 6374 203d      input_dict =
-0000ebd0: 2069 6e70 7574 5f64 6963 742e 6765 7428   input_dict.get(
-0000ebe0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000ebf0: 2020 2020 2020 2020 2062 6568 6176 696f           behavio
-0000ec00: 725f 706f 6c69 6379 5f6e 616d 653d 6265  r_policy_name=be
-0000ec10: 6861 7669 6f72 5f70 6f6c 6963 792c 0a20  havior_policy,. 
-0000ec20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ec30: 2020 2020 2020 2064 6174 6173 6574 5f69         dataset_i
-0000ec40: 643d 6461 7461 7365 745f 6964 2c0a 2020  d=dataset_id,.  
+0000eaa0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0000eab0: 6e5f 6279 5f64 6174 6166 7261 6d65 3d72  n_by_dataframe=r
+0000eac0: 6574 7572 6e5f 6279 5f64 6174 6166 7261  eturn_by_datafra
+0000ead0: 6d65 2c0a 2020 2020 2020 2020 2020 2020  me,.            
+0000eae0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+0000eaf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000eb00: 2020 2020 2020 6576 616c 5f6d 6574 7269        eval_metri
+0000eb10: 635f 6f70 652e 6170 7065 6e64 2865 7661  c_ope.append(eva
+0000eb20: 6c5f 6d65 7472 6963 5f6f 7065 5f29 0a0a  l_metric_ope_)..
+0000eb30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000eb40: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0000eb50: 2020 2020 2020 2020 2020 696e 7075 745f            input_
+0000eb60: 6469 6374 203d 2069 6e70 7574 5f64 6963  dict = input_dic
+0000eb70: 742e 6765 7428 0a20 2020 2020 2020 2020  t.get(.         
+0000eb80: 2020 2020 2020 2020 2020 2020 2020 2062                 b
+0000eb90: 6568 6176 696f 725f 706f 6c69 6379 5f6e  ehavior_policy_n
+0000eba0: 616d 653d 6265 6861 7669 6f72 5f70 6f6c  ame=behavior_pol
+0000ebb0: 6963 792c 0a20 2020 2020 2020 2020 2020  icy,.           
+0000ebc0: 2020 2020 2020 2020 2020 2020 2064 6174               dat
+0000ebd0: 6173 6574 5f69 643d 6461 7461 7365 745f  aset_id=dataset_
+0000ebe0: 6964 2c0a 2020 2020 2020 2020 2020 2020  id,.            
+0000ebf0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0000ec00: 2020 2020 2020 2020 2020 2020 2020 6576                ev
+0000ec10: 616c 5f6d 6574 7269 635f 6f70 6520 3d20  al_metric_ope = 
+0000ec20: 7365 6c66 2e5f 6576 616c 7561 7465 5f70  self._evaluate_p
+0000ec30: 6572 666f 726d 616e 6365 5f6f 665f 6f70  erformance_of_op
+0000ec40: 655f 6573 7469 6d61 746f 7273 280a 2020  e_estimators(.  
 0000ec50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ec60: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-0000ec70: 2020 2020 2020 2020 6576 616c 5f6d 6574          eval_met
-0000ec80: 7269 635f 6f70 6520 3d20 7365 6c66 2e5f  ric_ope = self._
-0000ec90: 6576 616c 7561 7465 5f70 6572 666f 726d  evaluate_perform
-0000eca0: 616e 6365 5f6f 665f 6f70 655f 6573 7469  ance_of_ope_esti
-0000ecb0: 6d61 746f 7273 280a 2020 2020 2020 2020  mators(.        
+0000ec60: 2020 2020 2020 696e 7075 745f 6469 6374        input_dict
+0000ec70: 3d69 6e70 7574 5f64 6963 742c 0a20 2020  =input_dict,.   
+0000ec80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ec90: 2020 2020 2070 6f6c 6963 795f 7661 6c75       policy_valu
+0000eca0: 655f 6469 6374 3d70 6f6c 6963 795f 7661  e_dict=policy_va
+0000ecb0: 6c75 655f 6469 6374 2c0a 2020 2020 2020  lue_dict,.      
 0000ecc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ecd0: 696e 7075 745f 6469 6374 3d69 6e70 7574  input_dict=input
-0000ece0: 5f64 6963 742c 0a20 2020 2020 2020 2020  _dict,.         
-0000ecf0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0000ed00: 6f6c 6963 795f 7661 6c75 655f 6469 6374  olicy_value_dict
-0000ed10: 3d70 6f6c 6963 795f 7661 6c75 655f 6469  =policy_value_di
-0000ed20: 6374 2c0a 2020 2020 2020 2020 2020 2020  ct,.            
-0000ed30: 2020 2020 2020 2020 2020 2020 636f 6d70              comp
-0000ed40: 6172 6564 5f65 7374 696d 6174 6f72 733d  ared_estimators=
-0000ed50: 636f 6d70 6172 6564 5f65 7374 696d 6174  compared_estimat
-0000ed60: 6f72 732c 0a20 2020 2020 2020 2020 2020  ors,.           
-0000ed70: 2020 2020 2020 2020 2020 2020 206d 6574               met
-0000ed80: 7269 633d 6d65 7472 6963 2c0a 2020 2020  ric=metric,.    
-0000ed90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000eda0: 2020 2020 7265 7475 726e 5f62 795f 6461      return_by_da
-0000edb0: 7461 6672 616d 653d 7265 7475 726e 5f62  taframe=return_b
-0000edc0: 795f 6461 7461 6672 616d 652c 0a20 2020  y_dataframe,.   
-0000edd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ede0: 2029 0a20 2020 2020 2020 2020 2020 2065   ).            e
-0000edf0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0000ee00: 2020 2020 2062 6568 6176 696f 725f 706f       behavior_po
-0000ee10: 6c69 6379 5f6e 616d 6520 3d20 6c69 7374  licy_name = list
-0000ee20: 2869 6e70 7574 5f64 6963 742e 7661 6c75  (input_dict.valu
-0000ee30: 6573 2829 295b 305d 5b22 6265 6861 7669  es())[0]["behavi
-0000ee40: 6f72 5f70 6f6c 6963 7922 5d0a 2020 2020  or_policy"].    
-0000ee50: 2020 2020 2020 2020 2020 2020 6461 7461              data
-0000ee60: 7365 745f 6964 203d 206c 6973 7428 696e  set_id = list(in
-0000ee70: 7075 745f 6469 6374 2e76 616c 7565 7328  put_dict.values(
-0000ee80: 2929 5b30 5d5b 2264 6174 6173 6574 5f69  ))[0]["dataset_i
-0000ee90: 6422 5d0a 0a20 2020 2020 2020 2020 2020  d"]..           
-0000eea0: 2020 2020 2069 6e70 7574 5f64 6963 7420       input_dict 
-0000eeb0: 3d20 696e 7075 745f 6469 6374 2e67 6574  = input_dict.get
-0000eec0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0000eed0: 2020 2020 2020 6265 6861 7669 6f72 5f70        behavior_p
-0000eee0: 6f6c 6963 795f 6e61 6d65 3d62 6568 6176  olicy_name=behav
-0000eef0: 696f 725f 706f 6c69 6379 2c20 6461 7461  ior_policy, data
-0000ef00: 7365 745f 6964 3d64 6174 6173 6574 5f69  set_id=dataset_i
-0000ef10: 640a 2020 2020 2020 2020 2020 2020 2020  d.              
-0000ef20: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-0000ef30: 2020 2020 6576 616c 5f6d 6574 7269 635f      eval_metric_
-0000ef40: 6f70 6520 3d20 7365 6c66 2e5f 6576 616c  ope = self._eval
-0000ef50: 7561 7465 5f70 6572 666f 726d 616e 6365  uate_performance
-0000ef60: 5f6f 665f 6f70 655f 6573 7469 6d61 746f  _of_ope_estimato
-0000ef70: 7273 280a 2020 2020 2020 2020 2020 2020  rs(.            
-0000ef80: 2020 2020 2020 2020 696e 7075 745f 6469          input_di
-0000ef90: 6374 3d69 6e70 7574 5f64 6963 742c 0a20  ct=input_dict,. 
-0000efa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000efb0: 2020 2070 6f6c 6963 795f 7661 6c75 655f     policy_value_
-0000efc0: 6469 6374 3d70 6f6c 6963 795f 7661 6c75  dict=policy_valu
-0000efd0: 655f 6469 6374 2c0a 2020 2020 2020 2020  e_dict,.        
-0000efe0: 2020 2020 2020 2020 2020 2020 636f 6d70              comp
-0000eff0: 6172 6564 5f65 7374 696d 6174 6f72 733d  ared_estimators=
-0000f000: 636f 6d70 6172 6564 5f65 7374 696d 6174  compared_estimat
-0000f010: 6f72 732c 0a20 2020 2020 2020 2020 2020  ors,.           
-0000f020: 2020 2020 2020 2020 206d 6574 7269 633d           metric=
-0000f030: 6d65 7472 6963 2c0a 2020 2020 2020 2020  metric,.        
-0000f040: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0000f050: 726e 5f62 795f 6461 7461 6672 616d 653d  rn_by_dataframe=
-0000f060: 7265 7475 726e 5f62 795f 6461 7461 6672  return_by_datafr
-0000f070: 616d 652c 0a20 2020 2020 2020 2020 2020  ame,.           
-0000f080: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
-0000f090: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-0000f0a0: 2020 6576 616c 5f6d 6574 7269 635f 6f70    eval_metric_op
-0000f0b0: 6520 3d20 7365 6c66 2e5f 6576 616c 7561  e = self._evalua
-0000f0c0: 7465 5f70 6572 666f 726d 616e 6365 5f6f  te_performance_o
-0000f0d0: 665f 6f70 655f 6573 7469 6d61 746f 7273  f_ope_estimators
-0000f0e0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0000f0f0: 2020 696e 7075 745f 6469 6374 3d69 6e70    input_dict=inp
-0000f100: 7574 5f64 6963 742c 0a20 2020 2020 2020  ut_dict,.       
-0000f110: 2020 2020 2020 2020 2070 6f6c 6963 795f           policy_
-0000f120: 7661 6c75 655f 6469 6374 3d70 6f6c 6963  value_dict=polic
-0000f130: 795f 7661 6c75 655f 6469 6374 2c0a 2020  y_value_dict,.  
-0000f140: 2020 2020 2020 2020 2020 2020 2020 636f                co
-0000f150: 6d70 6172 6564 5f65 7374 696d 6174 6f72  mpared_estimator
-0000f160: 733d 636f 6d70 6172 6564 5f65 7374 696d  s=compared_estim
-0000f170: 6174 6f72 732c 0a20 2020 2020 2020 2020  ators,.         
-0000f180: 2020 2020 2020 206d 6574 7269 633d 6d65         metric=me
-0000f190: 7472 6963 2c0a 2020 2020 2020 2020 2020  tric,.          
-0000f1a0: 2020 2020 2020 7265 7475 726e 5f62 795f        return_by_
-0000f1b0: 6461 7461 6672 616d 653d 7265 7475 726e  dataframe=return
-0000f1c0: 5f62 795f 6461 7461 6672 616d 652c 0a20  _by_dataframe,. 
-0000f1d0: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
-0000f1e0: 2020 2020 2020 7265 7475 726e 2065 7661        return eva
-0000f1f0: 6c5f 6d65 7472 6963 5f6f 7065 0a0a 2020  l_metric_ope..  
-0000f200: 2020 6465 6620 7669 7375 616c 697a 655f    def visualize_
-0000f210: 6f66 665f 706f 6c69 6379 5f65 7374 696d  off_policy_estim
-0000f220: 6174 6573 280a 2020 2020 2020 2020 7365  ates(.        se
-0000f230: 6c66 2c0a 2020 2020 2020 2020 696e 7075  lf,.        inpu
-0000f240: 745f 6469 6374 3a20 556e 696f 6e5b 4f50  t_dict: Union[OP
-0000f250: 4549 6e70 7574 4469 6374 2c20 4d75 6c74  EInputDict, Mult
-0000f260: 6970 6c65 496e 7075 7444 6963 745d 2c0a  ipleInputDict],.
-0000f270: 2020 2020 2020 2020 636f 6d70 6172 6564          compared
-0000f280: 5f65 7374 696d 6174 6f72 733a 204f 7074  _estimators: Opt
-0000f290: 696f 6e61 6c5b 4c69 7374 5b73 7472 5d5d  ional[List[str]]
-0000f2a0: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
-0000f2b0: 2062 6568 6176 696f 725f 706f 6c69 6379   behavior_policy
-0000f2c0: 5f6e 616d 653a 204f 7074 696f 6e61 6c5b  _name: Optional[
-0000f2d0: 7374 725d 203d 204e 6f6e 652c 0a20 2020  str] = None,.   
-0000f2e0: 2020 2020 2064 6174 6173 6574 5f69 643a       dataset_id:
-0000f2f0: 204f 7074 696f 6e61 6c5b 696e 745d 203d   Optional[int] =
-0000f300: 204e 6f6e 652c 0a20 2020 2020 2020 2061   None,.        a
-0000f310: 6c70 6861 3a20 666c 6f61 7420 3d20 302e  lpha: float = 0.
-0000f320: 3035 2c0a 2020 2020 2020 2020 6369 3a20  05,.        ci: 
-0000f330: 7374 7220 3d20 2262 6f6f 7473 7472 6170  str = "bootstrap
-0000f340: 222c 0a20 2020 2020 2020 206e 5f62 6f6f  ",.        n_boo
-0000f350: 7473 7472 6170 5f73 616d 706c 6573 3a20  tstrap_samples: 
-0000f360: 696e 7420 3d20 3130 302c 0a20 2020 2020  int = 100,.     
-0000f370: 2020 2072 616e 646f 6d5f 7374 6174 653a     random_state:
-0000f380: 204f 7074 696f 6e61 6c5b 696e 745d 203d   Optional[int] =
-0000f390: 204e 6f6e 652c 0a20 2020 2020 2020 2069   None,.        i
-0000f3a0: 735f 7265 6c61 7469 7665 3a20 626f 6f6c  s_relative: bool
-0000f3b0: 203d 2046 616c 7365 2c0a 2020 2020 2020   = False,.      
-0000f3c0: 2020 6875 653a 2073 7472 203d 2022 6573    hue: str = "es
-0000f3d0: 7469 6d61 746f 7222 2c0a 2020 2020 2020  timator",.      
-0000f3e0: 2020 7368 6172 6579 3a20 626f 6f6c 203d    sharey: bool =
-0000f3f0: 2046 616c 7365 2c0a 2020 2020 2020 2020   False,.        
-0000f400: 6669 675f 6469 723a 204f 7074 696f 6e61  fig_dir: Optiona
-0000f410: 6c5b 5061 7468 5d20 3d20 4e6f 6e65 2c0a  l[Path] = None,.
-0000f420: 2020 2020 2020 2020 6669 675f 6e61 6d65          fig_name
-0000f430: 3a20 7374 7220 3d20 2265 7374 696d 6174  : str = "estimat
-0000f440: 6564 5f70 6f6c 6963 795f 7661 6c75 652e  ed_policy_value.
-0000f450: 706e 6722 2c0a 2020 2020 2920 2d3e 204e  png",.    ) -> N
-0000f460: 6f6e 653a 0a20 2020 2020 2020 2022 2222  one:.        """
-0000f470: 5669 7375 616c 697a 6520 7468 6520 706f  Visualize the po
-0000f480: 6c69 6379 2076 616c 7565 2065 7374 696d  licy value estim
-0000f490: 6174 6564 2062 7920 4f50 4520 6573 7469  ated by OPE esti
-0000f4a0: 6d61 746f 7273 2e0a 0a20 2020 2020 2020  mators...       
-0000f4b0: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
-0000f4c0: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
-0000f4d0: 2020 2020 696e 7075 745f 6469 6374 3a20      input_dict: 
-0000f4e0: 4f50 4549 6e70 7574 4469 6374 206f 7220  OPEInputDict or 
-0000f4f0: 4d75 6c74 6970 6c65 496e 7075 7444 6963  MultipleInputDic
-0000f500: 740a 2020 2020 2020 2020 2020 2020 4469  t.            Di
-0000f510: 6374 696f 6e61 7279 206f 6620 7468 6520  ctionary of the 
-0000f520: 4f50 4520 696e 7075 7473 2066 6f72 2065  OPE inputs for e
-0000f530: 6163 6820 6576 616c 7561 7469 6f6e 2070  ach evaluation p
-0000f540: 6f6c 6963 792e 0a0a 2020 2020 2020 2020  olicy...        
-0000f550: 2020 2020 2e2e 2063 6f64 652d 626c 6f63      .. code-bloc
-0000f560: 6b3a 3a20 7079 7468 6f6e 0a0a 2020 2020  k:: python..    
-0000f570: 2020 2020 2020 2020 2020 2020 6b65 793a              key:
-0000f580: 205b 6576 616c 7561 7469 6f6e 5f70 6f6c   [evaluation_pol
-0000f590: 6963 795d 5b0a 2020 2020 2020 2020 2020  icy][.          
-0000f5a0: 2020 2020 2020 2020 2020 6576 616c 7561            evalua
-0000f5b0: 7469 6f6e 5f70 6f6c 6963 795f 6163 7469  tion_policy_acti
-0000f5c0: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
-0000f5d0: 2020 2020 2020 2020 6576 616c 7561 7469          evaluati
-0000f5e0: 6f6e 5f70 6f6c 6963 795f 6163 7469 6f6e  on_policy_action
-0000f5f0: 5f64 6973 742c 0a20 2020 2020 2020 2020  _dist,.         
-0000f600: 2020 2020 2020 2020 2020 2073 7461 7465             state
-0000f610: 5f61 6374 696f 6e5f 7661 6c75 655f 7072  _action_value_pr
-0000f620: 6564 6963 7469 6f6e 2c0a 2020 2020 2020  ediction,.      
-0000f630: 2020 2020 2020 2020 2020 2020 2020 696e                in
-0000f640: 6974 6961 6c5f 7374 6174 655f 7661 6c75  itial_state_valu
-0000f650: 655f 7072 6564 6963 7469 6f6e 2c0a 2020  e_prediction,.  
-0000f660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f670: 2020 7374 6174 655f 6163 7469 6f6e 5f6d    state_action_m
-0000f680: 6172 6769 6e61 6c5f 696d 706f 7274 616e  arginal_importan
-0000f690: 6365 5f77 6569 6768 742c 0a20 2020 2020  ce_weight,.     
-0000f6a0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0000f6b0: 7461 7465 5f6d 6172 6769 6e61 6c5f 696d  tate_marginal_im
-0000f6c0: 706f 7274 616e 6365 5f77 6569 6768 742c  portance_weight,
-0000f6d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000f6e0: 2020 2020 206f 6e5f 706f 6c69 6379 5f70       on_policy_p
-0000f6f0: 6f6c 6963 795f 7661 6c75 652c 0a20 2020  olicy_value,.   
-0000f700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f710: 2067 616d 6d61 2c0a 2020 2020 2020 2020   gamma,.        
-0000f720: 2020 2020 2020 2020 2020 2020 6265 6861              beha
-0000f730: 7669 6f72 5f70 6f6c 6963 792c 0a20 2020  vior_policy,.   
-0000f740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f750: 2065 7661 6c75 6174 696f 6e5f 706f 6c69   evaluation_poli
-0000f760: 6379 2c0a 2020 2020 2020 2020 2020 2020  cy,.            
-0000f770: 2020 2020 2020 2020 6461 7461 7365 745f          dataset_
-0000f780: 6964 2c0a 2020 2020 2020 2020 2020 2020  id,.            
-0000f790: 2020 2020 5d0a 0a20 2020 2020 2020 2020      ]..         
-0000f7a0: 2020 202e 2e20 7365 6561 6c73 6f3a 3a0a     .. seealso::.
-0000f7b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000f7c0: 203a 636c 6173 733a 6073 636f 7065 5f72   :class:`scope_r
-0000f7d0: 6c2e 6f70 652e 696e 7075 742e 4372 6561  l.ope.input.Crea
-0000f7e0: 7465 4f50 4549 6e70 7574 6020 6465 7363  teOPEInput` desc
-0000f7f0: 7269 6265 7320 7468 6520 636f 6d70 6f6e  ribes the compon
-0000f800: 656e 7473 206f 6620 3a63 6c61 7373 3a60  ents of :class:`
-0000f810: 696e 7075 745f 6469 6374 602e 0a0a 2020  input_dict`...  
-0000f820: 2020 2020 2020 636f 6d70 6172 6564 5f65        compared_e
-0000f830: 7374 696d 6174 6f72 733a 206c 6973 7420  stimators: list 
-0000f840: 6f66 2073 7472 2c20 6465 6661 756c 743d  of str, default=
-0000f850: 4e6f 6e65 0a20 2020 2020 2020 2020 2020  None.           
-0000f860: 204e 616d 6520 6f66 2063 6f6d 7061 7265   Name of compare
-0000f870: 6420 6573 7469 6d61 746f 7273 2e0a 2020  d estimators..  
-0000f880: 2020 2020 2020 2020 2020 4966 2060 4e6f            If `No
-0000f890: 6e65 6020 6973 2067 6976 656e 2c20 616c  ne` is given, al
-0000f8a0: 6c20 7468 6520 6573 7469 6d61 746f 7273  l the estimators
-0000f8b0: 2061 7265 2063 6f6d 7061 7265 642e 0a0a   are compared...
-0000f8c0: 2020 2020 2020 2020 6265 6861 7669 6f72          behavior
-0000f8d0: 5f70 6f6c 6963 795f 6e61 6d65 3a20 7374  _policy_name: st
-0000f8e0: 722c 2064 6566 6175 6c74 3d4e 6f6e 650a  r, default=None.
-0000f8f0: 2020 2020 2020 2020 2020 2020 4e61 6d65              Name
-0000f900: 206f 6620 7468 6520 6265 6861 7669 6f72   of the behavior
-0000f910: 2070 6f6c 6963 792e 0a0a 2020 2020 2020   policy...      
-0000f920: 2020 6461 7461 7365 745f 6964 3a20 696e    dataset_id: in
-0000f930: 742c 2064 6566 6175 6c74 3d4e 6f6e 650a  t, default=None.
-0000f940: 2020 2020 2020 2020 2020 2020 4964 206f              Id o
-0000f950: 6620 7468 6520 6c6f 6767 6564 2064 6174  f the logged dat
-0000f960: 6173 6574 2e0a 0a20 2020 2020 2020 2061  aset...        a
-0000f970: 6c70 6861 3a20 666c 6f61 742c 2064 6566  lpha: float, def
-0000f980: 6175 6c74 3d30 2e30 350a 2020 2020 2020  ault=0.05.      
-0000f990: 2020 2020 2020 5369 676e 6966 6963 616e        Significan
-0000f9a0: 6365 206c 6576 656c 2e20 5468 6520 7661  ce level. The va
-0000f9b0: 6c75 6520 7368 6f75 6c64 2062 6520 7769  lue should be wi
-0000f9c0: 7468 696e 2028 302c 2031 5d2e 0a0a 2020  thin (0, 1]...  
-0000f9d0: 2020 2020 2020 6369 3a20 7b22 626f 6f74        ci: {"boot
-0000f9e0: 7374 7261 7022 2c20 2268 6f65 6666 6469  strap", "hoeffdi
-0000f9f0: 6e67 222c 2022 6265 726e 7374 6569 6e22  ng", "bernstein"
-0000fa00: 2c20 2274 7465 7374 227d 2c20 6465 6661  , "ttest"}, defa
-0000fa10: 756c 743d 2262 6f6f 7473 7472 6170 220a  ult="bootstrap".
-0000fa20: 2020 2020 2020 2020 2020 2020 4d65 7468              Meth
-0000fa30: 6f64 2074 6f20 6573 7469 6d61 7465 2074  od to estimate t
-0000fa40: 6865 2063 6f6e 6669 6465 6e63 6520 696e  he confidence in
-0000fa50: 7465 7276 616c 2e0a 0a20 2020 2020 2020  terval...       
-0000fa60: 206e 5f62 6f6f 7473 7472 6170 5f73 616d   n_bootstrap_sam
-0000fa70: 706c 6573 3a20 696e 742c 2064 6566 6175  ples: int, defau
-0000fa80: 6c74 3d31 3030 3030 2028 3e20 3029 0a20  lt=10000 (> 0). 
-0000fa90: 2020 2020 2020 2020 2020 204e 756d 6265             Numbe
-0000faa0: 7220 6f66 2072 6573 616d 706c 696e 6720  r of resampling 
-0000fab0: 7065 7266 6f72 6d65 6420 696e 2074 6865  performed in the
-0000fac0: 2062 6f6f 7473 7472 6170 2070 726f 6365   bootstrap proce
-0000fad0: 6475 7265 2e0a 0a20 2020 2020 2020 2072  dure...        r
-0000fae0: 616e 646f 6d5f 7374 6174 653a 2069 6e74  andom_state: int
-0000faf0: 2c20 6465 6661 756c 743d 4e6f 6e65 2028  , default=None (
-0000fb00: 3e3d 2030 290a 2020 2020 2020 2020 2020  >= 0).          
-0000fb10: 2020 5261 6e64 6f6d 2073 7461 7465 2e0a    Random state..
-0000fb20: 0a20 2020 2020 2020 2069 735f 7265 6c61  .        is_rela
-0000fb30: 7469 7665 3a20 626f 6f6c 2c20 6465 6661  tive: bool, defa
-0000fb40: 756c 743d 4661 6c73 650a 2020 2020 2020  ult=False.      
-0000fb50: 2020 2020 2020 4966 2060 5472 7565 602c        If `True`,
-0000fb60: 2077 6520 6765 7420 7468 6520 6573 7469   we get the esti
-0000fb70: 6d61 7465 6420 706f 6c69 6379 2076 616c  mated policy val
-0000fb80: 7565 7320 6f66 2074 6865 2065 7661 6c75  ues of the evalu
-0000fb90: 6174 696f 6e20 706f 6c69 6369 6573 0a20  ation policies. 
-0000fba0: 2020 2020 2020 2020 2020 2072 656c 6174             relat
-0000fbb0: 6976 6520 746f 2074 6865 206f 6e2d 706f  ive to the on-po
-0000fbc0: 6c69 6379 2070 6f6c 6963 7920 7661 6c75  licy policy valu
-0000fbd0: 6520 6f66 2074 6865 2062 6568 6176 696f  e of the behavio
-0000fbe0: 7220 706f 6c69 6379 2e20 284f 6e6c 7920  r policy. (Only 
-0000fbf0: 6170 706c 6963 6162 6c65 2077 6865 6e20  applicable when 
-0000fc00: 7573 696e 6720 6120 7369 6e67 6c65 2069  using a single i
-0000fc10: 6e70 7574 5f64 6963 742e 290a 0a20 2020  nput_dict.)..   
-0000fc20: 2020 2020 2068 7565 3a20 7b22 6573 7469       hue: {"esti
-0000fc30: 6d61 746f 7222 2c20 2270 6f6c 6963 7922  mator", "policy"
-0000fc40: 7d2c 2064 6566 6175 6c74 3d22 6573 7469  }, default="esti
-0000fc50: 6d61 746f 7222 0a20 2020 2020 2020 2020  mator".         
-0000fc60: 2020 2048 7565 206f 6620 7468 6520 706c     Hue of the pl
-0000fc70: 6f74 2e0a 0a20 2020 2020 2020 2073 6861  ot...        sha
-0000fc80: 7265 793a 2062 6f6f 6c2c 2064 6566 6175  rey: bool, defau
-0000fc90: 6c74 3d46 616c 7365 0a20 2020 2020 2020  lt=False.       
-0000fca0: 2020 2020 2049 6620 6054 7275 6560 2c20       If `True`, 
-0000fcb0: 7468 6520 792d 6178 6973 2077 696c 6c20  the y-axis will 
-0000fcc0: 6265 2073 6861 7265 6420 616d 6f6e 6720  be shared among 
-0000fcd0: 6469 6666 6572 656e 7420 6573 7469 6d61  different estima
-0000fce0: 746f 7273 206f 7220 6576 616c 7561 7469  tors or evaluati
-0000fcf0: 6f6e 2070 6f6c 6963 6965 732e 0a0a 2020  on policies...  
-0000fd00: 2020 2020 2020 6669 675f 6469 723a 2050        fig_dir: P
-0000fd10: 6174 682c 2064 6566 6175 6c74 3d4e 6f6e  ath, default=Non
-0000fd20: 650a 2020 2020 2020 2020 2020 2020 5061  e.            Pa
-0000fd30: 7468 2074 6f20 7374 6f72 6520 7468 6520  th to store the 
-0000fd40: 6261 7220 6669 6775 7265 2e0a 2020 2020  bar figure..    
-0000fd50: 2020 2020 2020 2020 4966 2060 4e6f 6e65          If `None
-0000fd60: 6020 6973 2067 6976 656e 2c20 7468 6520  ` is given, the 
-0000fd70: 6669 6775 7265 2077 696c 6c20 6e6f 7420  figure will not 
-0000fd80: 6265 2073 6176 6564 2e0a 0a20 2020 2020  be saved...     
-0000fd90: 2020 2066 6967 5f6e 616d 653a 2073 7472     fig_name: str
-0000fda0: 2c20 6465 6661 756c 743d 2265 7374 696d  , default="estim
-0000fdb0: 6174 6564 5f70 6f6c 6963 795f 7661 6c75  ated_policy_valu
-0000fdc0: 652e 706e 6722 0a20 2020 2020 2020 2020  e.png".         
-0000fdd0: 2020 204e 616d 6520 6f66 2074 6865 2062     Name of the b
-0000fde0: 6172 2066 6967 7572 652e 0a0a 2020 2020  ar figure...    
-0000fdf0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0000fe00: 636f 6d70 6172 6564 5f65 7374 696d 6174  compared_estimat
-0000fe10: 6f72 7320 3d20 7365 6c66 2e5f 6368 6563  ors = self._chec
-0000fe20: 6b5f 636f 6d70 6172 6564 5f65 7374 696d  k_compared_estim
-0000fe30: 6174 6f72 7328 636f 6d70 6172 6564 5f65  ators(compared_e
-0000fe40: 7374 696d 6174 6f72 7329 0a20 2020 2020  stimators).     
-0000fe50: 2020 2073 656c 662e 5f63 6865 636b 5f62     self._check_b
-0000fe60: 6173 6963 5f76 6973 7561 6c69 7a61 7469  asic_visualizati
-0000fe70: 6f6e 5f69 6e70 7574 7328 0a20 2020 2020  on_inputs(.     
-0000fe80: 2020 2020 2020 2068 7565 3d68 7565 2c20         hue=hue, 
-0000fe90: 6669 675f 6469 723d 6669 675f 6469 722c  fig_dir=fig_dir,
-0000fea0: 2066 6967 5f6e 616d 653d 6669 675f 6e61   fig_name=fig_na
-0000feb0: 6d65 0a20 2020 2020 2020 2029 0a0a 2020  me.        )..  
-0000fec0: 2020 2020 2020 6966 2073 656c 662e 7573        if self.us
-0000fed0: 655f 6d75 6c74 6970 6c65 5f6c 6f67 6765  e_multiple_logge
-0000fee0: 645f 6461 7461 7365 743a 0a20 2020 2020  d_dataset:.     
-0000fef0: 2020 2020 2020 2069 6620 6265 6861 7669         if behavi
-0000ff00: 6f72 5f70 6f6c 6963 795f 6e61 6d65 2069  or_policy_name i
-0000ff10: 7320 4e6f 6e65 206f 7220 6461 7461 7365  s None or datase
-0000ff20: 745f 6964 2069 7320 4e6f 6e65 3a0a 2020  t_id is None:.  
-0000ff30: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-0000ff40: 6973 6520 5661 6c75 6545 7272 6f72 280a  ise ValueError(.
-0000ff50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ff60: 2020 2020 2262 6568 6176 696f 725f 706f      "behavior_po
-0000ff70: 6c69 6379 5f6e 616d 6520 616e 6420 6461  licy_name and da
-0000ff80: 7461 7365 745f 6964 206d 7573 7420 6265  taset_id must be
-0000ff90: 2073 7065 6369 6669 6564 2077 6865 6e20   specified when 
-0000ffa0: 7573 696e 6720 4d75 6c74 6970 6c65 4c6f  using MultipleLo
-0000ffb0: 6767 6564 4461 7461 7365 742e 220a 2020  ggedDataset.".  
-0000ffc0: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-0000ffd0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0000ffe0: 6973 696e 7374 616e 6365 2869 6e70 7574  isinstance(input
-0000fff0: 5f64 6963 742c 204d 756c 7469 706c 6549  _dict, MultipleI
-00010000: 6e70 7574 4469 6374 293a 0a20 2020 2020  nputDict):.     
-00010010: 2020 2020 2020 2020 2020 2069 6e70 7574             input
-00010020: 5f64 6963 7420 3d20 696e 7075 745f 6469  _dict = input_di
-00010030: 6374 2e67 6574 280a 2020 2020 2020 2020  ct.get(.        
-00010040: 2020 2020 2020 2020 2020 2020 6265 6861              beha
-00010050: 7669 6f72 5f70 6f6c 6963 795f 6e61 6d65  vior_policy_name
-00010060: 3d62 6568 6176 696f 725f 706f 6c69 6379  =behavior_policy
-00010070: 5f6e 616d 652c 2064 6174 6173 6574 5f69  _name, dataset_i
-00010080: 643d 6461 7461 7365 745f 6964 0a20 2020  d=dataset_id.   
-00010090: 2020 2020 2020 2020 2020 2020 2029 0a0a               )..
-000100a0: 2020 2020 2020 2020 706f 6c69 6379 5f76          policy_v
-000100b0: 616c 7565 5f69 6e74 6572 7661 6c5f 6469  alue_interval_di
-000100c0: 6374 203d 2073 656c 662e 6573 7469 6d61  ct = self.estima
-000100d0: 7465 5f69 6e74 6572 7661 6c73 280a 2020  te_intervals(.  
-000100e0: 2020 2020 2020 2020 2020 696e 7075 745f            input_
-000100f0: 6469 6374 3d69 6e70 7574 5f64 6963 742c  dict=input_dict,
-00010100: 0a20 2020 2020 2020 2020 2020 2063 6f6d  .            com
-00010110: 7061 7265 645f 6573 7469 6d61 746f 7273  pared_estimators
-00010120: 3d63 6f6d 7061 7265 645f 6573 7469 6d61  =compared_estima
-00010130: 746f 7273 2c0a 2020 2020 2020 2020 2020  tors,.          
-00010140: 2020 6265 6861 7669 6f72 5f70 6f6c 6963    behavior_polic
-00010150: 795f 6e61 6d65 3d62 6568 6176 696f 725f  y_name=behavior_
-00010160: 706f 6c69 6379 5f6e 616d 652c 0a20 2020  policy_name,.   
-00010170: 2020 2020 2020 2020 2064 6174 6173 6574           dataset
-00010180: 5f69 643d 6461 7461 7365 745f 6964 2c0a  _id=dataset_id,.
-00010190: 2020 2020 2020 2020 2020 2020 616c 7068              alph
-000101a0: 613d 616c 7068 612c 0a20 2020 2020 2020  a=alpha,.       
-000101b0: 2020 2020 2063 693d 6369 2c0a 2020 2020       ci=ci,.    
-000101c0: 2020 2020 2020 2020 6e5f 626f 6f74 7374          n_bootst
-000101d0: 7261 705f 7361 6d70 6c65 733d 6e5f 626f  rap_samples=n_bo
-000101e0: 6f74 7374 7261 705f 7361 6d70 6c65 732c  otstrap_samples,
-000101f0: 0a20 2020 2020 2020 2020 2020 2072 616e  .            ran
-00010200: 646f 6d5f 7374 6174 653d 7261 6e64 6f6d  dom_state=random
-00010210: 5f73 7461 7465 2c0a 2020 2020 2020 2020  _state,.        
-00010220: 290a 0a20 2020 2020 2020 2069 6620 6973  )..        if is
-00010230: 5f72 656c 6174 6976 653a 0a20 2020 2020  _relative:.     
-00010240: 2020 2020 2020 2067 616d 6d61 203d 2069         gamma = i
-00010250: 6e70 7574 5f64 6963 745b 6c69 7374 2869  nput_dict[list(i
-00010260: 6e70 7574 5f64 6963 742e 6b65 7973 2829  nput_dict.keys()
-00010270: 295b 305d 5d5b 2267 616d 6d61 225d 0a20  )[0]]["gamma"]. 
-00010280: 2020 2020 2020 2020 2020 2064 6973 636f             disco
-00010290: 756e 7420 3d20 6e70 2e66 756c 6c28 7365  unt = np.full(se
-000102a0: 6c66 2e73 7465 705f 7065 725f 7472 616a  lf.step_per_traj
-000102b0: 6563 746f 7279 2c20 6761 6d6d 6129 2e63  ectory, gamma).c
-000102c0: 756d 7072 6f64 2829 202f 2067 616d 6d61  umprod() / gamma
-000102d0: 0a20 2020 2020 2020 2020 2020 2062 6568  .            beh
-000102e0: 6176 696f 725f 706f 6c69 6379 5f76 616c  avior_policy_val
-000102f0: 7565 203d 2028 0a20 2020 2020 2020 2020  ue = (.         
-00010300: 2020 2020 2020 2064 6973 636f 756e 745b         discount[
-00010310: 6e70 2e6e 6577 6178 6973 2c20 3a5d 202a  np.newaxis, :] *
-00010320: 2073 656c 662e 6265 6861 7669 6f72 5f70   self.behavior_p
-00010330: 6f6c 6963 795f 7265 7761 7264 0a20 2020  olicy_reward.   
-00010340: 2020 2020 2020 2020 2029 2e73 756d 280a           ).sum(.
-00010350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010360: 6178 6973 3d31 0a20 2020 2020 2020 2020  axis=1.         
-00010370: 2020 2029 2e6d 6561 6e28 2920 2b20 3165     ).mean() + 1e
-00010380: 2d31 3020 2023 2074 6f20 6176 6f69 6420  -10  # to avoid 
-00010390: 7a65 726f 2064 6976 6973 696f 6e0a 0a20  zero division.. 
-000103a0: 2020 2020 2020 2070 6c74 2e73 7479 6c65         plt.style
-000103b0: 2e75 7365 2822 6767 706c 6f74 2229 0a20  .use("ggplot"). 
-000103c0: 2020 2020 2020 2063 6f6c 6f72 203d 2070         color = p
-000103d0: 6c74 2e72 6350 6172 616d 735b 2261 7865  lt.rcParams["axe
-000103e0: 732e 7072 6f70 5f63 7963 6c65 225d 2e62  s.prop_cycle"].b
-000103f0: 795f 6b65 7928 295b 2263 6f6c 6f72 225d  y_key()["color"]
-00010400: 0a0a 2020 2020 2020 2020 6e5f 706f 6c69  ..        n_poli
-00010410: 6369 6573 203d 206c 656e 2869 6e70 7574  cies = len(input
-00010420: 5f64 6963 7429 0a20 2020 2020 2020 206e  _dict).        n
-00010430: 5f65 7374 696d 6174 6f72 7320 3d20 6c65  _estimators = le
-00010440: 6e28 636f 6d70 6172 6564 5f65 7374 696d  n(compared_estim
-00010450: 6174 6f72 7329 0a0a 2020 2020 2020 2020  ators)..        
-00010460: 6966 2068 7565 203d 3d20 2265 7374 696d  if hue == "estim
-00010470: 6174 6f72 223a 0a20 2020 2020 2020 2020  ator":.         
-00010480: 2020 2066 6967 203d 2070 6c74 2e66 6967     fig = plt.fig
-00010490: 7572 6528 6669 6773 697a 653d 2832 202a  ure(figsize=(2 *
-000104a0: 206e 5f65 7374 696d 6174 6f72 732c 2034   n_estimators, 4
-000104b0: 202a 206e 5f70 6f6c 6963 6965 7329 290a   * n_policies)).
-000104c0: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
-000104d0: 2069 2c20 6576 616c 5f70 6f6c 6963 7920   i, eval_policy 
-000104e0: 696e 2065 6e75 6d65 7261 7465 2869 6e70  in enumerate(inp
-000104f0: 7574 5f64 6963 742e 6b65 7973 2829 293a  ut_dict.keys()):
-00010500: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00010510: 2069 6620 6920 3d3d 2030 3a0a 2020 2020   if i == 0:.    
-00010520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010530: 6178 203d 2061 7830 203d 2066 6967 2e61  ax = ax0 = fig.a
-00010540: 6464 5f73 7562 706c 6f74 286e 5f70 6f6c  dd_subplot(n_pol
-00010550: 6963 6965 732c 2031 2c20 6920 2b20 3129  icies, 1, i + 1)
-00010560: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00010570: 2065 6c69 6620 7368 6172 6579 3a0a 2020   elif sharey:.  
-00010580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010590: 2020 6178 203d 2066 6967 2e61 6464 5f73    ax = fig.add_s
-000105a0: 7562 706c 6f74 286e 5f70 6f6c 6963 6965  ubplot(n_policie
-000105b0: 732c 2031 2c20 6920 2b20 312c 2073 6861  s, 1, i + 1, sha
-000105c0: 7265 793d 6178 3029 0a20 2020 2020 2020  rey=ax0).       
-000105d0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-000105e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000105f0: 2020 2061 7820 3d20 6669 672e 6164 645f     ax = fig.add_
-00010600: 7375 6270 6c6f 7428 6e5f 706f 6c69 6369  subplot(n_polici
-00010610: 6573 2c20 312c 2069 202b 2031 290a 0a20  es, 1, i + 1).. 
-00010620: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-00010630: 6561 6e20 3d20 6e70 2e7a 6572 6f73 286e  ean = np.zeros(n
-00010640: 5f65 7374 696d 6174 6f72 7329 0a20 2020  _estimators).   
-00010650: 2020 2020 2020 2020 2020 2020 206c 6f77               low
-00010660: 6572 203d 206e 702e 7a65 726f 7328 6e5f  er = np.zeros(n_
-00010670: 6573 7469 6d61 746f 7273 290a 2020 2020  estimators).    
-00010680: 2020 2020 2020 2020 2020 2020 7570 7065              uppe
-00010690: 7220 3d20 6e70 2e7a 6572 6f73 286e 5f65  r = np.zeros(n_e
-000106a0: 7374 696d 6174 6f72 7329 0a0a 2020 2020  stimators)..    
-000106b0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-000106c0: 6a2c 2065 7374 696d 6174 6f72 2069 6e20  j, estimator in 
-000106d0: 656e 756d 6572 6174 6528 636f 6d70 6172  enumerate(compar
-000106e0: 6564 5f65 7374 696d 6174 6f72 7329 3a0a  ed_estimators):.
-000106f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010700: 2020 2020 6d65 616e 5b6a 5d20 3d20 706f      mean[j] = po
-00010710: 6c69 6379 5f76 616c 7565 5f69 6e74 6572  licy_value_inter
-00010720: 7661 6c5f 6469 6374 5b65 7661 6c5f 706f  val_dict[eval_po
-00010730: 6c69 6379 5d5b 6573 7469 6d61 746f 725d  licy][estimator]
-00010740: 5b22 6d65 616e 225d 0a20 2020 2020 2020  ["mean"].       
-00010750: 2020 2020 2020 2020 2020 2020 206c 6f77               low
-00010760: 6572 5b6a 5d20 3d20 706f 6c69 6379 5f76  er[j] = policy_v
-00010770: 616c 7565 5f69 6e74 6572 7661 6c5f 6469  alue_interval_di
-00010780: 6374 5b65 7661 6c5f 706f 6c69 6379 5d5b  ct[eval_policy][
-00010790: 6573 7469 6d61 746f 725d 5b0a 2020 2020  estimator][.    
-000107a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000107b0: 2020 2020 6622 7b31 3030 202a 2028 312e      f"{100 * (1.
-000107c0: 202d 2061 6c70 6861 297d 2520 4349 2028   - alpha)}% CI (
-000107d0: 6c6f 7765 7229 220a 2020 2020 2020 2020  lower)".        
-000107e0: 2020 2020 2020 2020 2020 2020 5d0a 2020              ].  
-000107f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010800: 2020 7570 7065 725b 6a5d 203d 2070 6f6c    upper[j] = pol
-00010810: 6963 795f 7661 6c75 655f 696e 7465 7276  icy_value_interv
-00010820: 616c 5f64 6963 745b 6576 616c 5f70 6f6c  al_dict[eval_pol
-00010830: 6963 795d 5b65 7374 696d 6174 6f72 5d5b  icy][estimator][
-00010840: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00010850: 2020 2020 2020 2020 2066 227b 3130 3020           f"{100 
-00010860: 2a20 2831 2e20 2d20 616c 7068 6129 7d25  * (1. - alpha)}%
-00010870: 2043 4920 2875 7070 6572 2922 0a20 2020   CI (upper)".   
-00010880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010890: 205d 0a0a 2020 2020 2020 2020 2020 2020   ]..            
-000108a0: 2020 2020 6966 2069 735f 7265 6c61 7469      if is_relati
-000108b0: 7665 3a0a 2020 2020 2020 2020 2020 2020  ve:.            
-000108c0: 2020 2020 2020 2020 6d65 616e 203d 206d          mean = m
-000108d0: 6561 6e20 2f20 6265 6861 7669 6f72 5f70  ean / behavior_p
-000108e0: 6f6c 6963 795f 7661 6c75 650a 2020 2020  olicy_value.    
-000108f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010900: 6c6f 7765 7220 3d20 6c6f 7765 7220 2f20  lower = lower / 
-00010910: 6265 6861 7669 6f72 5f70 6f6c 6963 795f  behavior_policy_
-00010920: 7661 6c75 650a 2020 2020 2020 2020 2020  value.          
-00010930: 2020 2020 2020 2020 2020 7570 7065 7220            upper 
-00010940: 3d20 7570 7065 7220 2f20 6265 6861 7669  = upper / behavi
-00010950: 6f72 5f70 6f6c 6963 795f 7661 6c75 650a  or_policy_value.
-00010960: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00010970: 2061 782e 6261 7228 0a20 2020 2020 2020   ax.bar(.       
-00010980: 2020 2020 2020 2020 2020 2020 206e 702e               np.
-00010990: 6172 616e 6765 286e 5f65 7374 696d 6174  arange(n_estimat
-000109a0: 6f72 7329 2c0a 2020 2020 2020 2020 2020  ors),.          
-000109b0: 2020 2020 2020 2020 2020 6d65 616e 2c0a            mean,.
-000109c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000109d0: 2020 2020 7965 7272 3d5b 7570 7065 7220      yerr=[upper 
-000109e0: 2d20 6d65 616e 2c20 6d65 616e 202d 206c  - mean, mean - l
-000109f0: 6f77 6572 5d2c 0a20 2020 2020 2020 2020  ower],.         
-00010a00: 2020 2020 2020 2020 2020 2063 6f6c 6f72             color
-00010a10: 3d63 6f6c 6f72 2c0a 2020 2020 2020 2020  =color,.        
-00010a20: 2020 2020 2020 2020 2020 2020 7469 636b              tick
-00010a30: 5f6c 6162 656c 3d63 6f6d 7061 7265 645f  _label=compared_
-00010a40: 6573 7469 6d61 746f 7273 2c0a 2020 2020  estimators,.    
-00010a50: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-00010a60: 2020 2020 2020 2020 2020 2020 2020 206f                 o
-00010a70: 6e5f 706f 6c69 6379 5f69 6e74 6572 7661  n_policy_interva
-00010a80: 6c20 3d20 706f 6c69 6379 5f76 616c 7565  l = policy_value
-00010a90: 5f69 6e74 6572 7661 6c5f 6469 6374 5b65  _interval_dict[e
-00010aa0: 7661 6c5f 706f 6c69 6379 5d5b 0a20 2020  val_policy][.   
-00010ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010ac0: 2022 6f6e 5f70 6f6c 6963 7922 0a20 2020   "on_policy".   
-00010ad0: 2020 2020 2020 2020 2020 2020 205d 0a20               ]. 
-00010ae0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00010af0: 6620 6f6e 5f70 6f6c 6963 795f 696e 7465  f on_policy_inte
-00010b00: 7276 616c 2069 7320 6e6f 7420 4e6f 6e65  rval is not None
-00010b10: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00010b20: 2020 2020 2020 6966 2069 735f 7265 6c61        if is_rela
-00010b30: 7469 7665 3a0a 2020 2020 2020 2020 2020  tive:.          
-00010b40: 2020 2020 2020 2020 2020 2020 2020 6178                ax
-00010b50: 2e61 7868 6c69 6e65 286f 6e5f 706f 6c69  .axhline(on_poli
-00010b60: 6379 5f69 6e74 6572 7661 6c5b 226d 6561  cy_interval["mea
-00010b70: 6e22 5d20 2f20 6265 6861 7669 6f72 5f70  n"] / behavior_p
-00010b80: 6f6c 6963 795f 7661 6c75 6529 0a20 2020  olicy_value).   
-00010b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010ba0: 2020 2020 2061 782e 6178 6873 7061 6e28       ax.axhspan(
-00010bb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00010bc0: 2020 2020 2020 2020 2020 2020 2079 6d69               ymi
-00010bd0: 6e3d 6f6e 5f70 6f6c 6963 795f 696e 7465  n=on_policy_inte
-00010be0: 7276 616c 5b66 227b 3130 3020 2a20 2831  rval[f"{100 * (1
-00010bf0: 2e20 2d20 616c 7068 6129 7d25 2043 4920  . - alpha)}% CI 
-00010c00: 286c 6f77 6572 2922 5d0a 2020 2020 2020  (lower)"].      
-00010c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010c20: 2020 2020 2020 2f20 6265 6861 7669 6f72        / behavior
-00010c30: 5f70 6f6c 6963 795f 7661 6c75 652c 0a20  _policy_value,. 
-00010c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010c50: 2020 2020 2020 2020 2020 2079 6d61 783d             ymax=
-00010c60: 6f6e 5f70 6f6c 6963 795f 696e 7465 7276  on_policy_interv
-00010c70: 616c 5b66 227b 3130 3020 2a20 2831 2e20  al[f"{100 * (1. 
-00010c80: 2d20 616c 7068 6129 7d25 2043 4920 2875  - alpha)}% CI (u
-00010c90: 7070 6572 2922 5d0a 2020 2020 2020 2020  pper)"].        
-00010ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010cb0: 2020 2020 2f20 6265 6861 7669 6f72 5f70      / behavior_p
-00010cc0: 6f6c 6963 795f 7661 6c75 652c 0a20 2020  olicy_value,.   
-00010cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010ce0: 2020 2020 2020 2020 2061 6c70 6861 3d30           alpha=0
-00010cf0: 2e33 2c0a 2020 2020 2020 2020 2020 2020  .3,.            
-00010d00: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-00010d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010d20: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00010d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010d40: 2061 782e 6178 686c 696e 6528 6f6e 5f70   ax.axhline(on_p
-00010d50: 6f6c 6963 795f 696e 7465 7276 616c 5b22  olicy_interval["
-00010d60: 6d65 616e 225d 290a 2020 2020 2020 2020  mean"]).        
-00010d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010d80: 6178 2e61 7868 7370 616e 280a 2020 2020  ax.axhspan(.    
-00010d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010da0: 2020 2020 2020 2020 796d 696e 3d6f 6e5f          ymin=on_
-00010db0: 706f 6c69 6379 5f69 6e74 6572 7661 6c5b  policy_interval[
-00010dc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00010dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010de0: 2066 227b 3130 3020 2a20 2831 2e20 2d20   f"{100 * (1. - 
-00010df0: 616c 7068 6129 7d25 2043 4920 286c 6f77  alpha)}% CI (low
-00010e00: 6572 2922 0a20 2020 2020 2020 2020 2020  er)".           
-00010e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010e20: 205d 2c0a 2020 2020 2020 2020 2020 2020   ],.            
-00010e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010e40: 796d 6178 3d6f 6e5f 706f 6c69 6379 5f69  ymax=on_policy_i
-00010e50: 6e74 6572 7661 6c5b 0a20 2020 2020 2020  nterval[.       
-00010e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010e70: 2020 2020 2020 2020 2066 227b 3130 3020           f"{100 
-00010e80: 2a20 2831 2e20 2d20 616c 7068 6129 7d25  * (1. - alpha)}%
-00010e90: 2043 4920 2875 7070 6572 2922 0a20 2020   CI (upper)".   
-00010ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010eb0: 2020 2020 2020 2020 205d 2c0a 2020 2020           ],.    
-00010ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010ed0: 2020 2020 2020 2020 616c 7068 613d 302e          alpha=0.
-00010ee0: 332c 0a20 2020 2020 2020 2020 2020 2020  3,.             
-00010ef0: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
-00010f00: 2020 2020 2020 2020 2020 2020 2020 6178                ax
-00010f10: 2e73 6574 5f74 6974 6c65 2865 7661 6c5f  .set_title(eval_
-00010f20: 706f 6c69 6379 2c20 666f 6e74 7369 7a65  policy, fontsize
-00010f30: 3d31 3629 0a20 2020 2020 2020 2020 2020  =16).           
-00010f40: 2020 2020 2061 782e 7365 745f 796c 6162       ax.set_ylab
-00010f50: 656c 280a 2020 2020 2020 2020 2020 2020  el(.            
-00010f60: 2020 2020 2020 2020 6622 4573 7469 6d61          f"Estima
-00010f70: 7465 6420 506f 6c69 6379 2056 616c 7565  ted Policy Value
-00010f80: 2028 c2b1 207b 6e70 2e69 6e74 3634 2831   (.. {np.int64(1
-00010f90: 3030 2a28 3120 2d20 616c 7068 6129 297d  00*(1 - alpha))}
-00010fa0: 2520 4349 2922 2c0a 2020 2020 2020 2020  % CI)",.        
-00010fb0: 2020 2020 2020 2020 2020 2020 666f 6e74              font
-00010fc0: 7369 7a65 3d31 322c 0a20 2020 2020 2020  size=12,.       
-00010fd0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-00010fe0: 2020 2020 2020 2020 2020 2070 6c74 2e79             plt.y
-00010ff0: 7469 636b 7328 666f 6e74 7369 7a65 3d31  ticks(fontsize=1
-00011000: 3229 0a20 2020 2020 2020 2020 2020 2020  2).             
-00011010: 2020 2070 6c74 2e78 7469 636b 7328 666f     plt.xticks(fo
-00011020: 6e74 7369 7a65 3d31 3229 0a0a 2020 2020  ntsize=12)..    
-00011030: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00011040: 2020 2020 2020 7669 7375 616c 697a 655f        visualize_
-00011050: 6f6e 5f70 6f6c 6963 7920 3d20 5472 7565  on_policy = True
-00011060: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
-00011070: 2065 7661 6c5f 706f 6c69 6379 2069 6e20   eval_policy in 
-00011080: 696e 7075 745f 6469 6374 2e6b 6579 7328  input_dict.keys(
-00011090: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-000110a0: 2020 2069 6620 696e 7075 745f 6469 6374     if input_dict
-000110b0: 5b65 7661 6c5f 706f 6c69 6379 5d5b 226f  [eval_policy]["o
-000110c0: 6e5f 706f 6c69 6379 5f70 6f6c 6963 795f  n_policy_policy_
-000110d0: 7661 6c75 6522 5d20 6973 204e 6f6e 653a  value"] is None:
-000110e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000110f0: 2020 2020 2076 6973 7561 6c69 7a65 5f6f       visualize_o
-00011100: 6e5f 706f 6c69 6379 203d 2046 616c 7365  n_policy = False
-00011110: 0a0a 2020 2020 2020 2020 2020 2020 6e5f  ..            n_
-00011120: 706f 6c69 6369 6573 203d 206c 656e 2869  policies = len(i
-00011130: 6e70 7574 5f64 6963 7429 0a20 2020 2020  nput_dict).     
-00011140: 2020 2020 2020 206e 5f65 7374 696d 6174         n_estimat
-00011150: 6f72 7320 3d20 280a 2020 2020 2020 2020  ors = (.        
-00011160: 2020 2020 2020 2020 6c65 6e28 636f 6d70          len(comp
-00011170: 6172 6564 5f65 7374 696d 6174 6f72 7329  ared_estimators)
-00011180: 202b 2031 0a20 2020 2020 2020 2020 2020   + 1.           
-00011190: 2020 2020 2069 6620 7669 7375 616c 697a       if visualiz
-000111a0: 655f 6f6e 5f70 6f6c 6963 790a 2020 2020  e_on_policy.    
-000111b0: 2020 2020 2020 2020 2020 2020 656c 7365              else
-000111c0: 206c 656e 2863 6f6d 7061 7265 645f 6573   len(compared_es
-000111d0: 7469 6d61 746f 7273 290a 2020 2020 2020  timators).      
-000111e0: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-000111f0: 2020 2020 2066 6967 203d 2070 6c74 2e66       fig = plt.f
-00011200: 6967 7572 6528 6669 6773 697a 653d 2832  igure(figsize=(2
-00011210: 202a 206e 5f70 6f6c 6963 6965 732c 2034   * n_policies, 4
-00011220: 202a 206e 5f65 7374 696d 6174 6f72 7329   * n_estimators)
-00011230: 290a 0a20 2020 2020 2020 2020 2020 2066  )..            f
-00011240: 6f72 2069 2c20 6573 7469 6d61 746f 7220  or i, estimator 
-00011250: 696e 2065 6e75 6d65 7261 7465 2863 6f6d  in enumerate(com
-00011260: 7061 7265 645f 6573 7469 6d61 746f 7273  pared_estimators
-00011270: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-00011280: 2020 2069 6620 6920 3d3d 2030 3a0a 2020     if i == 0:.  
-00011290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000112a0: 2020 6178 203d 2061 7830 203d 2066 6967    ax = ax0 = fig
-000112b0: 2e61 6464 5f73 7562 706c 6f74 286e 5f65  .add_subplot(n_e
-000112c0: 7374 696d 6174 6f72 732c 2031 2c20 6920  stimators, 1, i 
-000112d0: 2b20 3129 0a20 2020 2020 2020 2020 2020  + 1).           
-000112e0: 2020 2020 2065 6c69 6620 7368 6172 6579       elif sharey
-000112f0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00011300: 2020 2020 2020 6178 203d 2066 6967 2e61        ax = fig.a
-00011310: 6464 5f73 7562 706c 6f74 286e 5f65 7374  dd_subplot(n_est
-00011320: 696d 6174 6f72 732c 2031 2c20 6920 2b20  imators, 1, i + 
-00011330: 312c 2073 6861 7265 793d 6178 3029 0a20  1, sharey=ax0). 
-00011340: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00011350: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00011360: 2020 2020 2020 2020 2061 7820 3d20 6669           ax = fi
-00011370: 672e 6164 645f 7375 6270 6c6f 7428 6e5f  g.add_subplot(n_
-00011380: 6573 7469 6d61 746f 7273 2c20 312c 2069  estimators, 1, i
-00011390: 202b 2031 290a 0a20 2020 2020 2020 2020   + 1)..         
-000113a0: 2020 2020 2020 206d 6561 6e20 3d20 6e70         mean = np
-000113b0: 2e7a 6572 6f73 286e 5f70 6f6c 6963 6965  .zeros(n_policie
-000113c0: 7329 0a20 2020 2020 2020 2020 2020 2020  s).             
-000113d0: 2020 206c 6f77 6572 203d 206e 702e 7a65     lower = np.ze
-000113e0: 726f 7328 6e5f 706f 6c69 6369 6573 290a  ros(n_policies).
-000113f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011400: 7570 7065 7220 3d20 6e70 2e7a 6572 6f73  upper = np.zeros
-00011410: 286e 5f70 6f6c 6963 6965 7329 0a0a 2020  (n_policies)..  
-00011420: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-00011430: 7220 6a2c 2065 7661 6c5f 706f 6c69 6379  r j, eval_policy
-00011440: 2069 6e20 656e 756d 6572 6174 6528 696e   in enumerate(in
-00011450: 7075 745f 6469 6374 2e6b 6579 7328 2929  put_dict.keys())
-00011460: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00011470: 2020 2020 2020 6d65 616e 5b6a 5d20 3d20        mean[j] = 
-00011480: 706f 6c69 6379 5f76 616c 7565 5f69 6e74  policy_value_int
-00011490: 6572 7661 6c5f 6469 6374 5b65 7661 6c5f  erval_dict[eval_
-000114a0: 706f 6c69 6379 5d5b 6573 7469 6d61 746f  policy][estimato
-000114b0: 725d 5b22 6d65 616e 225d 0a20 2020 2020  r]["mean"].     
-000114c0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-000114d0: 6f77 6572 5b6a 5d20 3d20 706f 6c69 6379  ower[j] = policy
-000114e0: 5f76 616c 7565 5f69 6e74 6572 7661 6c5f  _value_interval_
-000114f0: 6469 6374 5b65 7661 6c5f 706f 6c69 6379  dict[eval_policy
-00011500: 5d5b 6573 7469 6d61 746f 725d 5b0a 2020  ][estimator][.  
-00011510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011520: 2020 2020 2020 6622 7b31 3030 202a 2028        f"{100 * (
-00011530: 312e 202d 2061 6c70 6861 297d 2520 4349  1. - alpha)}% CI
-00011540: 2028 6c6f 7765 7229 220a 2020 2020 2020   (lower)".      
-00011550: 2020 2020 2020 2020 2020 2020 2020 5d0a                ].
-00011560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011570: 2020 2020 7570 7065 725b 6a5d 203d 2070      upper[j] = p
-00011580: 6f6c 6963 795f 7661 6c75 655f 696e 7465  olicy_value_inte
-00011590: 7276 616c 5f64 6963 745b 6576 616c 5f70  rval_dict[eval_p
-000115a0: 6f6c 6963 795d 5b65 7374 696d 6174 6f72  olicy][estimator
-000115b0: 5d5b 0a20 2020 2020 2020 2020 2020 2020  ][.             
-000115c0: 2020 2020 2020 2020 2020 2066 227b 3130             f"{10
-000115d0: 3020 2a20 2831 2e20 2d20 616c 7068 6129  0 * (1. - alpha)
-000115e0: 7d25 2043 4920 2875 7070 6572 2922 0a20  }% CI (upper)". 
-000115f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011600: 2020 205d 0a0a 2020 2020 2020 2020 2020     ]..          
-00011610: 2020 2020 2020 6966 2069 735f 7265 6c61        if is_rela
-00011620: 7469 7665 3a0a 2020 2020 2020 2020 2020  tive:.          
-00011630: 2020 2020 2020 2020 2020 6d65 616e 203d            mean =
-00011640: 206d 6561 6e20 2f20 6265 6861 7669 6f72   mean / behavior
-00011650: 5f70 6f6c 6963 795f 7661 6c75 650a 2020  _policy_value.  
-00011660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011670: 2020 6c6f 7765 7220 3d20 6c6f 7765 7220    lower = lower 
-00011680: 2f20 6265 6861 7669 6f72 5f70 6f6c 6963  / behavior_polic
-00011690: 795f 7661 6c75 650a 2020 2020 2020 2020  y_value.        
-000116a0: 2020 2020 2020 2020 2020 2020 7570 7065              uppe
-000116b0: 7220 3d20 7570 7065 7220 2f20 6265 6861  r = upper / beha
-000116c0: 7669 6f72 5f70 6f6c 6963 795f 7661 6c75  vior_policy_valu
-000116d0: 650a 0a20 2020 2020 2020 2020 2020 2020  e..             
-000116e0: 2020 2061 782e 6261 7228 0a20 2020 2020     ax.bar(.     
-000116f0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-00011700: 702e 6172 616e 6765 286e 5f70 6f6c 6963  p.arange(n_polic
-00011710: 6965 7329 2c0a 2020 2020 2020 2020 2020  ies),.          
-00011720: 2020 2020 2020 2020 2020 6d65 616e 2c0a            mean,.
-00011730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011740: 2020 2020 7965 7272 3d5b 7570 7065 7220      yerr=[upper 
-00011750: 2d20 6d65 616e 2c20 6d65 616e 202d 206c  - mean, mean - l
-00011760: 6f77 6572 5d2c 0a20 2020 2020 2020 2020  ower],.         
-00011770: 2020 2020 2020 2020 2020 2063 6f6c 6f72             color
-00011780: 3d63 6f6c 6f72 2c0a 2020 2020 2020 2020  =color,.        
-00011790: 2020 2020 2020 2020 2020 2020 7469 636b              tick
-000117a0: 5f6c 6162 656c 3d6c 6973 7428 696e 7075  _label=list(inpu
-000117b0: 745f 6469 6374 2e6b 6579 7328 2929 2c0a  t_dict.keys()),.
+0000ecd0: 2020 636f 6d70 6172 6564 5f65 7374 696d    compared_estim
+0000ece0: 6174 6f72 733d 636f 6d70 6172 6564 5f65  ators=compared_e
+0000ecf0: 7374 696d 6174 6f72 732c 0a20 2020 2020  stimators,.     
+0000ed00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ed10: 2020 206d 6574 7269 633d 6d65 7472 6963     metric=metric
+0000ed20: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0000ed30: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0000ed40: 5f62 795f 6461 7461 6672 616d 653d 7265  _by_dataframe=re
+0000ed50: 7475 726e 5f62 795f 6461 7461 6672 616d  turn_by_datafram
+0000ed60: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+0000ed70: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0000ed80: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+0000ed90: 2020 2020 2020 2020 2020 2062 6568 6176             behav
+0000eda0: 696f 725f 706f 6c69 6379 5f6e 616d 6520  ior_policy_name 
+0000edb0: 3d20 6c69 7374 2869 6e70 7574 5f64 6963  = list(input_dic
+0000edc0: 742e 7661 6c75 6573 2829 295b 305d 5b22  t.values())[0]["
+0000edd0: 6265 6861 7669 6f72 5f70 6f6c 6963 7922  behavior_policy"
+0000ede0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+0000edf0: 2020 6461 7461 7365 745f 6964 203d 206c    dataset_id = l
+0000ee00: 6973 7428 696e 7075 745f 6469 6374 2e76  ist(input_dict.v
+0000ee10: 616c 7565 7328 2929 5b30 5d5b 2264 6174  alues())[0]["dat
+0000ee20: 6173 6574 5f69 6422 5d0a 0a20 2020 2020  aset_id"]..     
+0000ee30: 2020 2020 2020 2020 2020 2069 6e70 7574             input
+0000ee40: 5f64 6963 7420 3d20 696e 7075 745f 6469  _dict = input_di
+0000ee50: 6374 2e67 6574 280a 2020 2020 2020 2020  ct.get(.        
+0000ee60: 2020 2020 2020 2020 2020 2020 6265 6861              beha
+0000ee70: 7669 6f72 5f70 6f6c 6963 795f 6e61 6d65  vior_policy_name
+0000ee80: 3d62 6568 6176 696f 725f 706f 6c69 6379  =behavior_policy
+0000ee90: 2c20 6461 7461 7365 745f 6964 3d64 6174  , dataset_id=dat
+0000eea0: 6173 6574 5f69 640a 2020 2020 2020 2020  aset_id.        
+0000eeb0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0000eec0: 2020 2020 2020 2020 2020 6576 616c 5f6d            eval_m
+0000eed0: 6574 7269 635f 6f70 6520 3d20 7365 6c66  etric_ope = self
+0000eee0: 2e5f 6576 616c 7561 7465 5f70 6572 666f  ._evaluate_perfo
+0000eef0: 726d 616e 6365 5f6f 665f 6f70 655f 6573  rmance_of_ope_es
+0000ef00: 7469 6d61 746f 7273 280a 2020 2020 2020  timators(.      
+0000ef10: 2020 2020 2020 2020 2020 2020 2020 696e                in
+0000ef20: 7075 745f 6469 6374 3d69 6e70 7574 5f64  put_dict=input_d
+0000ef30: 6963 742c 0a20 2020 2020 2020 2020 2020  ict,.           
+0000ef40: 2020 2020 2020 2020 2070 6f6c 6963 795f           policy_
+0000ef50: 7661 6c75 655f 6469 6374 3d70 6f6c 6963  value_dict=polic
+0000ef60: 795f 7661 6c75 655f 6469 6374 2c0a 2020  y_value_dict,.  
+0000ef70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ef80: 2020 636f 6d70 6172 6564 5f65 7374 696d    compared_estim
+0000ef90: 6174 6f72 733d 636f 6d70 6172 6564 5f65  ators=compared_e
+0000efa0: 7374 696d 6174 6f72 732c 0a20 2020 2020  stimators,.     
+0000efb0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+0000efc0: 6574 7269 633d 6d65 7472 6963 2c0a 2020  etric=metric,.  
+0000efd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000efe0: 2020 7265 7475 726e 5f62 795f 6461 7461    return_by_data
+0000eff0: 6672 616d 653d 7265 7475 726e 5f62 795f  frame=return_by_
+0000f000: 6461 7461 6672 616d 652c 0a20 2020 2020  dataframe,.     
+0000f010: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
+0000f020: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0000f030: 2020 2020 2020 2020 6576 616c 5f6d 6574          eval_met
+0000f040: 7269 635f 6f70 6520 3d20 7365 6c66 2e5f  ric_ope = self._
+0000f050: 6576 616c 7561 7465 5f70 6572 666f 726d  evaluate_perform
+0000f060: 616e 6365 5f6f 665f 6f70 655f 6573 7469  ance_of_ope_esti
+0000f070: 6d61 746f 7273 280a 2020 2020 2020 2020  mators(.        
+0000f080: 2020 2020 2020 2020 696e 7075 745f 6469          input_di
+0000f090: 6374 3d69 6e70 7574 5f64 6963 742c 0a20  ct=input_dict,. 
+0000f0a0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+0000f0b0: 6f6c 6963 795f 7661 6c75 655f 6469 6374  olicy_value_dict
+0000f0c0: 3d70 6f6c 6963 795f 7661 6c75 655f 6469  =policy_value_di
+0000f0d0: 6374 2c0a 2020 2020 2020 2020 2020 2020  ct,.            
+0000f0e0: 2020 2020 636f 6d70 6172 6564 5f65 7374      compared_est
+0000f0f0: 696d 6174 6f72 733d 636f 6d70 6172 6564  imators=compared
+0000f100: 5f65 7374 696d 6174 6f72 732c 0a20 2020  _estimators,.   
+0000f110: 2020 2020 2020 2020 2020 2020 206d 6574               met
+0000f120: 7269 633d 6d65 7472 6963 2c0a 2020 2020  ric=metric,.    
+0000f130: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0000f140: 726e 5f62 795f 6461 7461 6672 616d 653d  rn_by_dataframe=
+0000f150: 7265 7475 726e 5f62 795f 6461 7461 6672  return_by_datafr
+0000f160: 616d 652c 0a20 2020 2020 2020 2020 2020  ame,.           
+0000f170: 2029 0a0a 2020 2020 2020 2020 7265 7475   )..        retu
+0000f180: 726e 2065 7661 6c5f 6d65 7472 6963 5f6f  rn eval_metric_o
+0000f190: 7065 0a0a 2020 2020 6465 6620 7669 7375  pe..    def visu
+0000f1a0: 616c 697a 655f 6f66 665f 706f 6c69 6379  alize_off_policy
+0000f1b0: 5f65 7374 696d 6174 6573 280a 2020 2020  _estimates(.    
+0000f1c0: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
+0000f1d0: 2020 696e 7075 745f 6469 6374 3a20 556e    input_dict: Un
+0000f1e0: 696f 6e5b 4f50 4549 6e70 7574 4469 6374  ion[OPEInputDict
+0000f1f0: 2c20 4d75 6c74 6970 6c65 496e 7075 7444  , MultipleInputD
+0000f200: 6963 745d 2c0a 2020 2020 2020 2020 636f  ict],.        co
+0000f210: 6d70 6172 6564 5f65 7374 696d 6174 6f72  mpared_estimator
+0000f220: 733a 204f 7074 696f 6e61 6c5b 4c69 7374  s: Optional[List
+0000f230: 5b73 7472 5d5d 203d 204e 6f6e 652c 0a20  [str]] = None,. 
+0000f240: 2020 2020 2020 2062 6568 6176 696f 725f         behavior_
+0000f250: 706f 6c69 6379 5f6e 616d 653a 204f 7074  policy_name: Opt
+0000f260: 696f 6e61 6c5b 7374 725d 203d 204e 6f6e  ional[str] = Non
+0000f270: 652c 0a20 2020 2020 2020 2064 6174 6173  e,.        datas
+0000f280: 6574 5f69 643a 204f 7074 696f 6e61 6c5b  et_id: Optional[
+0000f290: 696e 745d 203d 204e 6f6e 652c 0a20 2020  int] = None,.   
+0000f2a0: 2020 2020 2061 6c70 6861 3a20 666c 6f61       alpha: floa
+0000f2b0: 7420 3d20 302e 3035 2c0a 2020 2020 2020  t = 0.05,.      
+0000f2c0: 2020 6369 3a20 7374 7220 3d20 2262 6f6f    ci: str = "boo
+0000f2d0: 7473 7472 6170 222c 0a20 2020 2020 2020  tstrap",.       
+0000f2e0: 206e 5f62 6f6f 7473 7472 6170 5f73 616d   n_bootstrap_sam
+0000f2f0: 706c 6573 3a20 696e 7420 3d20 3130 302c  ples: int = 100,
+0000f300: 0a20 2020 2020 2020 2072 616e 646f 6d5f  .        random_
+0000f310: 7374 6174 653a 204f 7074 696f 6e61 6c5b  state: Optional[
+0000f320: 696e 745d 203d 204e 6f6e 652c 0a20 2020  int] = None,.   
+0000f330: 2020 2020 2069 735f 7265 6c61 7469 7665       is_relative
+0000f340: 3a20 626f 6f6c 203d 2046 616c 7365 2c0a  : bool = False,.
+0000f350: 2020 2020 2020 2020 6875 653a 2073 7472          hue: str
+0000f360: 203d 2022 6573 7469 6d61 746f 7222 2c0a   = "estimator",.
+0000f370: 2020 2020 2020 2020 7368 6172 6579 3a20          sharey: 
+0000f380: 626f 6f6c 203d 2046 616c 7365 2c0a 2020  bool = False,.  
+0000f390: 2020 2020 2020 6669 675f 6469 723a 204f        fig_dir: O
+0000f3a0: 7074 696f 6e61 6c5b 5061 7468 5d20 3d20  ptional[Path] = 
+0000f3b0: 4e6f 6e65 2c0a 2020 2020 2020 2020 6669  None,.        fi
+0000f3c0: 675f 6e61 6d65 3a20 7374 7220 3d20 2265  g_name: str = "e
+0000f3d0: 7374 696d 6174 6564 5f70 6f6c 6963 795f  stimated_policy_
+0000f3e0: 7661 6c75 652e 706e 6722 2c0a 2020 2020  value.png",.    
+0000f3f0: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
+0000f400: 2020 2022 2222 5669 7375 616c 697a 6520     """Visualize 
+0000f410: 7468 6520 706f 6c69 6379 2076 616c 7565  the policy value
+0000f420: 2065 7374 696d 6174 6564 2062 7920 4f50   estimated by OP
+0000f430: 4520 6573 7469 6d61 746f 7273 2e0a 0a20  E estimators... 
+0000f440: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
+0000f450: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
+0000f460: 2d0a 2020 2020 2020 2020 696e 7075 745f  -.        input_
+0000f470: 6469 6374 3a20 4f50 4549 6e70 7574 4469  dict: OPEInputDi
+0000f480: 6374 206f 7220 4d75 6c74 6970 6c65 496e  ct or MultipleIn
+0000f490: 7075 7444 6963 740a 2020 2020 2020 2020  putDict.        
+0000f4a0: 2020 2020 4469 6374 696f 6e61 7279 206f      Dictionary o
+0000f4b0: 6620 7468 6520 4f50 4520 696e 7075 7473  f the OPE inputs
+0000f4c0: 2066 6f72 2065 6163 6820 6576 616c 7561   for each evalua
+0000f4d0: 7469 6f6e 2070 6f6c 6963 792e 0a0a 2020  tion policy...  
+0000f4e0: 2020 2020 2020 2020 2020 2e2e 2063 6f64            .. cod
+0000f4f0: 652d 626c 6f63 6b3a 3a20 7079 7468 6f6e  e-block:: python
+0000f500: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000f510: 2020 6b65 793a 205b 6576 616c 7561 7469    key: [evaluati
+0000f520: 6f6e 5f70 6f6c 6963 795d 5b0a 2020 2020  on_policy][.    
+0000f530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f540: 6576 616c 7561 7469 6f6e 5f70 6f6c 6963  evaluation_polic
+0000f550: 795f 6163 7469 6f6e 2c0a 2020 2020 2020  y_action,.      
+0000f560: 2020 2020 2020 2020 2020 2020 2020 6576                ev
+0000f570: 616c 7561 7469 6f6e 5f70 6f6c 6963 795f  aluation_policy_
+0000f580: 6163 7469 6f6e 5f64 6973 742c 0a20 2020  action_dist,.   
+0000f590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f5a0: 2073 7461 7465 5f61 6374 696f 6e5f 7661   state_action_va
+0000f5b0: 6c75 655f 7072 6564 6963 7469 6f6e 2c0a  lue_prediction,.
+0000f5c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f5d0: 2020 2020 696e 6974 6961 6c5f 7374 6174      initial_stat
+0000f5e0: 655f 7661 6c75 655f 7072 6564 6963 7469  e_value_predicti
+0000f5f0: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
+0000f600: 2020 2020 2020 2020 7374 6174 655f 6163          state_ac
+0000f610: 7469 6f6e 5f6d 6172 6769 6e61 6c5f 696d  tion_marginal_im
+0000f620: 706f 7274 616e 6365 5f77 6569 6768 742c  portance_weight,
+0000f630: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000f640: 2020 2020 2073 7461 7465 5f6d 6172 6769       state_margi
+0000f650: 6e61 6c5f 696d 706f 7274 616e 6365 5f77  nal_importance_w
+0000f660: 6569 6768 742c 0a20 2020 2020 2020 2020  eight,.         
+0000f670: 2020 2020 2020 2020 2020 206f 6e5f 706f             on_po
+0000f680: 6c69 6379 5f70 6f6c 6963 795f 7661 6c75  licy_policy_valu
+0000f690: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+0000f6a0: 2020 2020 2020 2067 616d 6d61 2c0a 2020         gamma,.  
+0000f6b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f6c0: 2020 6265 6861 7669 6f72 5f70 6f6c 6963    behavior_polic
+0000f6d0: 792c 0a20 2020 2020 2020 2020 2020 2020  y,.             
+0000f6e0: 2020 2020 2020 2065 7661 6c75 6174 696f         evaluatio
+0000f6f0: 6e5f 706f 6c69 6379 2c0a 2020 2020 2020  n_policy,.      
+0000f700: 2020 2020 2020 2020 2020 2020 2020 6461                da
+0000f710: 7461 7365 745f 6964 2c0a 2020 2020 2020  taset_id,.      
+0000f720: 2020 2020 2020 2020 2020 5d0a 0a20 2020            ]..   
+0000f730: 2020 2020 2020 2020 202e 2e20 7365 6561           .. seea
+0000f740: 6c73 6f3a 3a0a 0a20 2020 2020 2020 2020  lso::..         
+0000f750: 2020 2020 2020 203a 636c 6173 733a 6073         :class:`s
+0000f760: 636f 7065 5f72 6c2e 6f70 652e 696e 7075  cope_rl.ope.inpu
+0000f770: 742e 4372 6561 7465 4f50 4549 6e70 7574  t.CreateOPEInput
+0000f780: 6020 6465 7363 7269 6265 7320 7468 6520  ` describes the 
+0000f790: 636f 6d70 6f6e 656e 7473 206f 6620 3a63  components of :c
+0000f7a0: 6c61 7373 3a60 696e 7075 745f 6469 6374  lass:`input_dict
+0000f7b0: 602e 0a0a 2020 2020 2020 2020 636f 6d70  `...        comp
+0000f7c0: 6172 6564 5f65 7374 696d 6174 6f72 733a  ared_estimators:
+0000f7d0: 206c 6973 7420 6f66 2073 7472 2c20 6465   list of str, de
+0000f7e0: 6661 756c 743d 4e6f 6e65 0a20 2020 2020  fault=None.     
+0000f7f0: 2020 2020 2020 204e 616d 6520 6f66 2063         Name of c
+0000f800: 6f6d 7061 7265 6420 6573 7469 6d61 746f  ompared estimato
+0000f810: 7273 2e0a 2020 2020 2020 2020 2020 2020  rs..            
+0000f820: 4966 2060 4e6f 6e65 6020 6973 2067 6976  If `None` is giv
+0000f830: 656e 2c20 616c 6c20 7468 6520 6573 7469  en, all the esti
+0000f840: 6d61 746f 7273 2061 7265 2063 6f6d 7061  mators are compa
+0000f850: 7265 642e 0a0a 2020 2020 2020 2020 6265  red...        be
+0000f860: 6861 7669 6f72 5f70 6f6c 6963 795f 6e61  havior_policy_na
+0000f870: 6d65 3a20 7374 722c 2064 6566 6175 6c74  me: str, default
+0000f880: 3d4e 6f6e 650a 2020 2020 2020 2020 2020  =None.          
+0000f890: 2020 4e61 6d65 206f 6620 7468 6520 6265    Name of the be
+0000f8a0: 6861 7669 6f72 2070 6f6c 6963 792e 0a0a  havior policy...
+0000f8b0: 2020 2020 2020 2020 6461 7461 7365 745f          dataset_
+0000f8c0: 6964 3a20 696e 742c 2064 6566 6175 6c74  id: int, default
+0000f8d0: 3d4e 6f6e 650a 2020 2020 2020 2020 2020  =None.          
+0000f8e0: 2020 4964 206f 6620 7468 6520 6c6f 6767    Id of the logg
+0000f8f0: 6564 2064 6174 6173 6574 2e0a 0a20 2020  ed dataset...   
+0000f900: 2020 2020 2061 6c70 6861 3a20 666c 6f61       alpha: floa
+0000f910: 742c 2064 6566 6175 6c74 3d30 2e30 350a  t, default=0.05.
+0000f920: 2020 2020 2020 2020 2020 2020 5369 676e              Sign
+0000f930: 6966 6963 616e 6365 206c 6576 656c 2e20  ificance level. 
+0000f940: 5468 6520 7661 6c75 6520 7368 6f75 6c64  The value should
+0000f950: 2062 6520 7769 7468 696e 2028 302c 2031   be within (0, 1
+0000f960: 5d2e 0a0a 2020 2020 2020 2020 6369 3a20  ]...        ci: 
+0000f970: 7b22 626f 6f74 7374 7261 7022 2c20 2268  {"bootstrap", "h
+0000f980: 6f65 6666 6469 6e67 222c 2022 6265 726e  oeffding", "bern
+0000f990: 7374 6569 6e22 2c20 2274 7465 7374 227d  stein", "ttest"}
+0000f9a0: 2c20 6465 6661 756c 743d 2262 6f6f 7473  , default="boots
+0000f9b0: 7472 6170 220a 2020 2020 2020 2020 2020  trap".          
+0000f9c0: 2020 4d65 7468 6f64 2074 6f20 6573 7469    Method to esti
+0000f9d0: 6d61 7465 2074 6865 2063 6f6e 6669 6465  mate the confide
+0000f9e0: 6e63 6520 696e 7465 7276 616c 2e0a 0a20  nce interval... 
+0000f9f0: 2020 2020 2020 206e 5f62 6f6f 7473 7472         n_bootstr
+0000fa00: 6170 5f73 616d 706c 6573 3a20 696e 742c  ap_samples: int,
+0000fa10: 2064 6566 6175 6c74 3d31 3030 3030 2028   default=10000 (
+0000fa20: 3e20 3029 0a20 2020 2020 2020 2020 2020  > 0).           
+0000fa30: 204e 756d 6265 7220 6f66 2072 6573 616d   Number of resam
+0000fa40: 706c 696e 6720 7065 7266 6f72 6d65 6420  pling performed 
+0000fa50: 696e 2074 6865 2062 6f6f 7473 7472 6170  in the bootstrap
+0000fa60: 2070 726f 6365 6475 7265 2e0a 0a20 2020   procedure...   
+0000fa70: 2020 2020 2072 616e 646f 6d5f 7374 6174       random_stat
+0000fa80: 653a 2069 6e74 2c20 6465 6661 756c 743d  e: int, default=
+0000fa90: 4e6f 6e65 2028 3e3d 2030 290a 2020 2020  None (>= 0).    
+0000faa0: 2020 2020 2020 2020 5261 6e64 6f6d 2073          Random s
+0000fab0: 7461 7465 2e0a 0a20 2020 2020 2020 2069  tate...        i
+0000fac0: 735f 7265 6c61 7469 7665 3a20 626f 6f6c  s_relative: bool
+0000fad0: 2c20 6465 6661 756c 743d 4661 6c73 650a  , default=False.
+0000fae0: 2020 2020 2020 2020 2020 2020 4966 2060              If `
+0000faf0: 5472 7565 602c 2077 6520 6765 7420 7468  True`, we get th
+0000fb00: 6520 6573 7469 6d61 7465 6420 706f 6c69  e estimated poli
+0000fb10: 6379 2076 616c 7565 7320 6f66 2074 6865  cy values of the
+0000fb20: 2065 7661 6c75 6174 696f 6e20 706f 6c69   evaluation poli
+0000fb30: 6369 6573 0a20 2020 2020 2020 2020 2020  cies.           
+0000fb40: 2072 656c 6174 6976 6520 746f 2074 6865   relative to the
+0000fb50: 206f 6e2d 706f 6c69 6379 2070 6f6c 6963   on-policy polic
+0000fb60: 7920 7661 6c75 6520 6f66 2074 6865 2062  y value of the b
+0000fb70: 6568 6176 696f 7220 706f 6c69 6379 2e20  ehavior policy. 
+0000fb80: 284f 6e6c 7920 6170 706c 6963 6162 6c65  (Only applicable
+0000fb90: 2077 6865 6e20 7573 696e 6720 6120 7369   when using a si
+0000fba0: 6e67 6c65 2069 6e70 7574 5f64 6963 742e  ngle input_dict.
+0000fbb0: 290a 0a20 2020 2020 2020 2068 7565 3a20  )..        hue: 
+0000fbc0: 7b22 6573 7469 6d61 746f 7222 2c20 2270  {"estimator", "p
+0000fbd0: 6f6c 6963 7922 7d2c 2064 6566 6175 6c74  olicy"}, default
+0000fbe0: 3d22 6573 7469 6d61 746f 7222 0a20 2020  ="estimator".   
+0000fbf0: 2020 2020 2020 2020 2048 7565 206f 6620           Hue of 
+0000fc00: 7468 6520 706c 6f74 2e0a 0a20 2020 2020  the plot...     
+0000fc10: 2020 2073 6861 7265 793a 2062 6f6f 6c2c     sharey: bool,
+0000fc20: 2064 6566 6175 6c74 3d46 616c 7365 0a20   default=False. 
+0000fc30: 2020 2020 2020 2020 2020 2049 6620 6054             If `T
+0000fc40: 7275 6560 2c20 7468 6520 792d 6178 6973  rue`, the y-axis
+0000fc50: 2077 696c 6c20 6265 2073 6861 7265 6420   will be shared 
+0000fc60: 616d 6f6e 6720 6469 6666 6572 656e 7420  among different 
+0000fc70: 6573 7469 6d61 746f 7273 206f 7220 6576  estimators or ev
+0000fc80: 616c 7561 7469 6f6e 2070 6f6c 6963 6965  aluation policie
+0000fc90: 732e 0a0a 2020 2020 2020 2020 6669 675f  s...        fig_
+0000fca0: 6469 723a 2050 6174 682c 2064 6566 6175  dir: Path, defau
+0000fcb0: 6c74 3d4e 6f6e 650a 2020 2020 2020 2020  lt=None.        
+0000fcc0: 2020 2020 5061 7468 2074 6f20 7374 6f72      Path to stor
+0000fcd0: 6520 7468 6520 6261 7220 6669 6775 7265  e the bar figure
+0000fce0: 2e0a 2020 2020 2020 2020 2020 2020 4966  ..            If
+0000fcf0: 2060 4e6f 6e65 6020 6973 2067 6976 656e   `None` is given
+0000fd00: 2c20 7468 6520 6669 6775 7265 2077 696c  , the figure wil
+0000fd10: 6c20 6e6f 7420 6265 2073 6176 6564 2e0a  l not be saved..
+0000fd20: 0a20 2020 2020 2020 2066 6967 5f6e 616d  .        fig_nam
+0000fd30: 653a 2073 7472 2c20 6465 6661 756c 743d  e: str, default=
+0000fd40: 2265 7374 696d 6174 6564 5f70 6f6c 6963  "estimated_polic
+0000fd50: 795f 7661 6c75 652e 706e 6722 0a20 2020  y_value.png".   
+0000fd60: 2020 2020 2020 2020 204e 616d 6520 6f66           Name of
+0000fd70: 2074 6865 2062 6172 2066 6967 7572 652e   the bar figure.
+0000fd80: 0a0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+0000fd90: 2020 2020 2020 636f 6d70 6172 6564 5f65        compared_e
+0000fda0: 7374 696d 6174 6f72 7320 3d20 7365 6c66  stimators = self
+0000fdb0: 2e5f 6368 6563 6b5f 636f 6d70 6172 6564  ._check_compared
+0000fdc0: 5f65 7374 696d 6174 6f72 7328 636f 6d70  _estimators(comp
+0000fdd0: 6172 6564 5f65 7374 696d 6174 6f72 7329  ared_estimators)
+0000fde0: 0a20 2020 2020 2020 2073 656c 662e 5f63  .        self._c
+0000fdf0: 6865 636b 5f62 6173 6963 5f76 6973 7561  heck_basic_visua
+0000fe00: 6c69 7a61 7469 6f6e 5f69 6e70 7574 7328  lization_inputs(
+0000fe10: 0a20 2020 2020 2020 2020 2020 2068 7565  .            hue
+0000fe20: 3d68 7565 2c20 6669 675f 6469 723d 6669  =hue, fig_dir=fi
+0000fe30: 675f 6469 722c 2066 6967 5f6e 616d 653d  g_dir, fig_name=
+0000fe40: 6669 675f 6e61 6d65 0a20 2020 2020 2020  fig_name.       
+0000fe50: 2029 0a0a 2020 2020 2020 2020 6966 2073   )..        if s
+0000fe60: 656c 662e 7573 655f 6d75 6c74 6970 6c65  elf.use_multiple
+0000fe70: 5f6c 6f67 6765 645f 6461 7461 7365 743a  _logged_dataset:
+0000fe80: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0000fe90: 6265 6861 7669 6f72 5f70 6f6c 6963 795f  behavior_policy_
+0000fea0: 6e61 6d65 2069 7320 4e6f 6e65 206f 7220  name is None or 
+0000feb0: 6461 7461 7365 745f 6964 2069 7320 4e6f  dataset_id is No
+0000fec0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+0000fed0: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+0000fee0: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
+0000fef0: 2020 2020 2020 2020 2020 2262 6568 6176            "behav
+0000ff00: 696f 725f 706f 6c69 6379 5f6e 616d 6520  ior_policy_name 
+0000ff10: 616e 6420 6461 7461 7365 745f 6964 206d  and dataset_id m
+0000ff20: 7573 7420 6265 2073 7065 6369 6669 6564  ust be specified
+0000ff30: 2077 6865 6e20 7573 696e 6720 4d75 6c74   when using Mult
+0000ff40: 6970 6c65 4c6f 6767 6564 4461 7461 7365  ipleLoggedDatase
+0000ff50: 742e 220a 2020 2020 2020 2020 2020 2020  t.".            
+0000ff60: 2020 2020 290a 0a20 2020 2020 2020 2020      )..         
+0000ff70: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+0000ff80: 2869 6e70 7574 5f64 6963 742c 204d 756c  (input_dict, Mul
+0000ff90: 7469 706c 6549 6e70 7574 4469 6374 293a  tipleInputDict):
+0000ffa0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000ffb0: 2069 6e70 7574 5f64 6963 7420 3d20 696e   input_dict = in
+0000ffc0: 7075 745f 6469 6374 2e67 6574 280a 2020  put_dict.get(.  
+0000ffd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ffe0: 2020 6265 6861 7669 6f72 5f70 6f6c 6963    behavior_polic
+0000fff0: 795f 6e61 6d65 3d62 6568 6176 696f 725f  y_name=behavior_
+00010000: 706f 6c69 6379 5f6e 616d 652c 2064 6174  policy_name, dat
+00010010: 6173 6574 5f69 643d 6461 7461 7365 745f  aset_id=dataset_
+00010020: 6964 0a20 2020 2020 2020 2020 2020 2020  id.             
+00010030: 2020 2029 0a0a 2020 2020 2020 2020 706f     )..        po
+00010040: 6c69 6379 5f76 616c 7565 5f69 6e74 6572  licy_value_inter
+00010050: 7661 6c5f 6469 6374 203d 2073 656c 662e  val_dict = self.
+00010060: 6573 7469 6d61 7465 5f69 6e74 6572 7661  estimate_interva
+00010070: 6c73 280a 2020 2020 2020 2020 2020 2020  ls(.            
+00010080: 696e 7075 745f 6469 6374 3d69 6e70 7574  input_dict=input
+00010090: 5f64 6963 742c 0a20 2020 2020 2020 2020  _dict,.         
+000100a0: 2020 2063 6f6d 7061 7265 645f 6573 7469     compared_esti
+000100b0: 6d61 746f 7273 3d63 6f6d 7061 7265 645f  mators=compared_
+000100c0: 6573 7469 6d61 746f 7273 2c0a 2020 2020  estimators,.    
+000100d0: 2020 2020 2020 2020 6265 6861 7669 6f72          behavior
+000100e0: 5f70 6f6c 6963 795f 6e61 6d65 3d62 6568  _policy_name=beh
+000100f0: 6176 696f 725f 706f 6c69 6379 5f6e 616d  avior_policy_nam
+00010100: 652c 0a20 2020 2020 2020 2020 2020 2064  e,.            d
+00010110: 6174 6173 6574 5f69 643d 6461 7461 7365  ataset_id=datase
+00010120: 745f 6964 2c0a 2020 2020 2020 2020 2020  t_id,.          
+00010130: 2020 616c 7068 613d 616c 7068 612c 0a20    alpha=alpha,. 
+00010140: 2020 2020 2020 2020 2020 2063 693d 6369             ci=ci
+00010150: 2c0a 2020 2020 2020 2020 2020 2020 6e5f  ,.            n_
+00010160: 626f 6f74 7374 7261 705f 7361 6d70 6c65  bootstrap_sample
+00010170: 733d 6e5f 626f 6f74 7374 7261 705f 7361  s=n_bootstrap_sa
+00010180: 6d70 6c65 732c 0a20 2020 2020 2020 2020  mples,.         
+00010190: 2020 2072 616e 646f 6d5f 7374 6174 653d     random_state=
+000101a0: 7261 6e64 6f6d 5f73 7461 7465 2c0a 2020  random_state,.  
+000101b0: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+000101c0: 2069 6620 6973 5f72 656c 6174 6976 653a   if is_relative:
+000101d0: 0a20 2020 2020 2020 2020 2020 2067 616d  .            gam
+000101e0: 6d61 203d 2069 6e70 7574 5f64 6963 745b  ma = input_dict[
+000101f0: 6c69 7374 2869 6e70 7574 5f64 6963 742e  list(input_dict.
+00010200: 6b65 7973 2829 295b 305d 5d5b 2267 616d  keys())[0]]["gam
+00010210: 6d61 225d 0a20 2020 2020 2020 2020 2020  ma"].           
+00010220: 2064 6973 636f 756e 7420 3d20 6e70 2e66   discount = np.f
+00010230: 756c 6c28 7365 6c66 2e73 7465 705f 7065  ull(self.step_pe
+00010240: 725f 7472 616a 6563 746f 7279 2c20 6761  r_trajectory, ga
+00010250: 6d6d 6129 2e63 756d 7072 6f64 2829 202f  mma).cumprod() /
+00010260: 2067 616d 6d61 0a20 2020 2020 2020 2020   gamma.         
+00010270: 2020 2062 6568 6176 696f 725f 706f 6c69     behavior_poli
+00010280: 6379 5f76 616c 7565 203d 2028 0a20 2020  cy_value = (.   
+00010290: 2020 2020 2020 2020 2020 2020 2064 6973               dis
+000102a0: 636f 756e 745b 6e70 2e6e 6577 6178 6973  count[np.newaxis
+000102b0: 2c20 3a5d 202a 2073 656c 662e 6265 6861  , :] * self.beha
+000102c0: 7669 6f72 5f70 6f6c 6963 795f 7265 7761  vior_policy_rewa
+000102d0: 7264 0a20 2020 2020 2020 2020 2020 2029  rd.            )
+000102e0: 2e73 756d 280a 2020 2020 2020 2020 2020  .sum(.          
+000102f0: 2020 2020 2020 6178 6973 3d31 0a20 2020        axis=1.   
+00010300: 2020 2020 2020 2020 2029 2e6d 6561 6e28           ).mean(
+00010310: 2920 2b20 3165 2d31 3020 2023 2074 6f20  ) + 1e-10  # to 
+00010320: 6176 6f69 6420 7a65 726f 2064 6976 6973  avoid zero divis
+00010330: 696f 6e0a 0a20 2020 2020 2020 2070 6c74  ion..        plt
+00010340: 2e73 7479 6c65 2e75 7365 2822 6767 706c  .style.use("ggpl
+00010350: 6f74 2229 0a20 2020 2020 2020 2063 6f6c  ot").        col
+00010360: 6f72 203d 2070 6c74 2e72 6350 6172 616d  or = plt.rcParam
+00010370: 735b 2261 7865 732e 7072 6f70 5f63 7963  s["axes.prop_cyc
+00010380: 6c65 225d 2e62 795f 6b65 7928 295b 2263  le"].by_key()["c
+00010390: 6f6c 6f72 225d 0a0a 2020 2020 2020 2020  olor"]..        
+000103a0: 6e5f 706f 6c69 6369 6573 203d 206c 656e  n_policies = len
+000103b0: 2869 6e70 7574 5f64 6963 7429 0a20 2020  (input_dict).   
+000103c0: 2020 2020 206e 5f65 7374 696d 6174 6f72       n_estimator
+000103d0: 7320 3d20 6c65 6e28 636f 6d70 6172 6564  s = len(compared
+000103e0: 5f65 7374 696d 6174 6f72 7329 0a0a 2020  _estimators)..  
+000103f0: 2020 2020 2020 6966 2068 7565 203d 3d20        if hue == 
+00010400: 2265 7374 696d 6174 6f72 223a 0a20 2020  "estimator":.   
+00010410: 2020 2020 2020 2020 2066 6967 203d 2070           fig = p
+00010420: 6c74 2e66 6967 7572 6528 6669 6773 697a  lt.figure(figsiz
+00010430: 653d 2832 202a 206e 5f65 7374 696d 6174  e=(2 * n_estimat
+00010440: 6f72 732c 2034 202a 206e 5f70 6f6c 6963  ors, 4 * n_polic
+00010450: 6965 7329 290a 0a20 2020 2020 2020 2020  ies))..         
+00010460: 2020 2066 6f72 2069 2c20 6576 616c 5f70     for i, eval_p
+00010470: 6f6c 6963 7920 696e 2065 6e75 6d65 7261  olicy in enumera
+00010480: 7465 2869 6e70 7574 5f64 6963 742e 6b65  te(input_dict.ke
+00010490: 7973 2829 293a 0a20 2020 2020 2020 2020  ys()):.         
+000104a0: 2020 2020 2020 2069 6620 6920 3d3d 2030         if i == 0
+000104b0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000104c0: 2020 2020 2020 6178 203d 2061 7830 203d        ax = ax0 =
+000104d0: 2066 6967 2e61 6464 5f73 7562 706c 6f74   fig.add_subplot
+000104e0: 286e 5f70 6f6c 6963 6965 732c 2031 2c20  (n_policies, 1, 
+000104f0: 6920 2b20 3129 0a20 2020 2020 2020 2020  i + 1).         
+00010500: 2020 2020 2020 2065 6c69 6620 7368 6172         elif shar
+00010510: 6579 3a0a 2020 2020 2020 2020 2020 2020  ey:.            
+00010520: 2020 2020 2020 2020 6178 203d 2066 6967          ax = fig
+00010530: 2e61 6464 5f73 7562 706c 6f74 286e 5f70  .add_subplot(n_p
+00010540: 6f6c 6963 6965 732c 2031 2c20 6920 2b20  olicies, 1, i + 
+00010550: 312c 2073 6861 7265 793d 6178 3029 0a20  1, sharey=ax0). 
+00010560: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00010570: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00010580: 2020 2020 2020 2020 2061 7820 3d20 6669           ax = fi
+00010590: 672e 6164 645f 7375 6270 6c6f 7428 6e5f  g.add_subplot(n_
+000105a0: 706f 6c69 6369 6573 2c20 312c 2069 202b  policies, 1, i +
+000105b0: 2031 290a 0a20 2020 2020 2020 2020 2020   1)..           
+000105c0: 2020 2020 206d 6561 6e20 3d20 6e70 2e7a       mean = np.z
+000105d0: 6572 6f73 286e 5f65 7374 696d 6174 6f72  eros(n_estimator
+000105e0: 7329 0a20 2020 2020 2020 2020 2020 2020  s).             
+000105f0: 2020 206c 6f77 6572 203d 206e 702e 7a65     lower = np.ze
+00010600: 726f 7328 6e5f 6573 7469 6d61 746f 7273  ros(n_estimators
+00010610: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00010620: 2020 7570 7065 7220 3d20 6e70 2e7a 6572    upper = np.zer
+00010630: 6f73 286e 5f65 7374 696d 6174 6f72 7329  os(n_estimators)
+00010640: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00010650: 2020 666f 7220 6a2c 2065 7374 696d 6174    for j, estimat
+00010660: 6f72 2069 6e20 656e 756d 6572 6174 6528  or in enumerate(
+00010670: 636f 6d70 6172 6564 5f65 7374 696d 6174  compared_estimat
+00010680: 6f72 7329 3a0a 2020 2020 2020 2020 2020  ors):.          
+00010690: 2020 2020 2020 2020 2020 6d65 616e 5b6a            mean[j
+000106a0: 5d20 3d20 706f 6c69 6379 5f76 616c 7565  ] = policy_value
+000106b0: 5f69 6e74 6572 7661 6c5f 6469 6374 5b65  _interval_dict[e
+000106c0: 7661 6c5f 706f 6c69 6379 5d5b 6573 7469  val_policy][esti
+000106d0: 6d61 746f 725d 5b22 6d65 616e 225d 0a20  mator]["mean"]. 
+000106e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000106f0: 2020 206c 6f77 6572 5b6a 5d20 3d20 706f     lower[j] = po
+00010700: 6c69 6379 5f76 616c 7565 5f69 6e74 6572  licy_value_inter
+00010710: 7661 6c5f 6469 6374 5b65 7661 6c5f 706f  val_dict[eval_po
+00010720: 6c69 6379 5d5b 6573 7469 6d61 746f 725d  licy][estimator]
+00010730: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
+00010740: 2020 2020 2020 2020 2020 6622 7b31 3030            f"{100
+00010750: 202a 2028 312e 202d 2061 6c70 6861 297d   * (1. - alpha)}
+00010760: 2520 4349 2028 6c6f 7765 7229 220a 2020  % CI (lower)".  
+00010770: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010780: 2020 5d0a 2020 2020 2020 2020 2020 2020    ].            
+00010790: 2020 2020 2020 2020 7570 7065 725b 6a5d          upper[j]
+000107a0: 203d 2070 6f6c 6963 795f 7661 6c75 655f   = policy_value_
+000107b0: 696e 7465 7276 616c 5f64 6963 745b 6576  interval_dict[ev
+000107c0: 616c 5f70 6f6c 6963 795d 5b65 7374 696d  al_policy][estim
+000107d0: 6174 6f72 5d5b 0a20 2020 2020 2020 2020  ator][.         
+000107e0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+000107f0: 227b 3130 3020 2a20 2831 2e20 2d20 616c  "{100 * (1. - al
+00010800: 7068 6129 7d25 2043 4920 2875 7070 6572  pha)}% CI (upper
+00010810: 2922 0a20 2020 2020 2020 2020 2020 2020  )".             
+00010820: 2020 2020 2020 205d 0a0a 2020 2020 2020         ]..      
+00010830: 2020 2020 2020 2020 2020 6966 2069 735f            if is_
+00010840: 7265 6c61 7469 7665 3a0a 2020 2020 2020  relative:.      
+00010850: 2020 2020 2020 2020 2020 2020 2020 6d65                me
+00010860: 616e 203d 206d 6561 6e20 2f20 6265 6861  an = mean / beha
+00010870: 7669 6f72 5f70 6f6c 6963 795f 7661 6c75  vior_policy_valu
+00010880: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
+00010890: 2020 2020 2020 6c6f 7765 7220 3d20 6c6f        lower = lo
+000108a0: 7765 7220 2f20 6265 6861 7669 6f72 5f70  wer / behavior_p
+000108b0: 6f6c 6963 795f 7661 6c75 650a 2020 2020  olicy_value.    
+000108c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000108d0: 7570 7065 7220 3d20 7570 7065 7220 2f20  upper = upper / 
+000108e0: 6265 6861 7669 6f72 5f70 6f6c 6963 795f  behavior_policy_
+000108f0: 7661 6c75 650a 0a20 2020 2020 2020 2020  value..         
+00010900: 2020 2020 2020 2061 782e 6261 7228 0a20         ax.bar(. 
+00010910: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010920: 2020 206e 702e 6172 616e 6765 286e 5f65     np.arange(n_e
+00010930: 7374 696d 6174 6f72 7329 2c0a 2020 2020  stimators),.    
+00010940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010950: 6d65 616e 2c0a 2020 2020 2020 2020 2020  mean,.          
+00010960: 2020 2020 2020 2020 2020 7965 7272 3d5b            yerr=[
+00010970: 7570 7065 7220 2d20 6d65 616e 2c20 6d65  upper - mean, me
+00010980: 616e 202d 206c 6f77 6572 5d2c 0a20 2020  an - lower],.   
+00010990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000109a0: 2063 6f6c 6f72 3d63 6f6c 6f72 2c0a 2020   color=color,.  
+000109b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000109c0: 2020 7469 636b 5f6c 6162 656c 3d63 6f6d    tick_label=com
+000109d0: 7061 7265 645f 6573 7469 6d61 746f 7273  pared_estimators
+000109e0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000109f0: 2020 290a 0a20 2020 2020 2020 2020 2020    )..           
+00010a00: 2020 2020 206f 6e5f 706f 6c69 6379 5f69       on_policy_i
+00010a10: 6e74 6572 7661 6c20 3d20 706f 6c69 6379  nterval = policy
+00010a20: 5f76 616c 7565 5f69 6e74 6572 7661 6c5f  _value_interval_
+00010a30: 6469 6374 5b65 7661 6c5f 706f 6c69 6379  dict[eval_policy
+00010a40: 5d5b 0a20 2020 2020 2020 2020 2020 2020  ][.             
+00010a50: 2020 2020 2020 2022 6f6e 5f70 6f6c 6963         "on_polic
+00010a60: 7922 0a20 2020 2020 2020 2020 2020 2020  y".             
+00010a70: 2020 205d 0a20 2020 2020 2020 2020 2020     ].           
+00010a80: 2020 2020 2069 6620 6f6e 5f70 6f6c 6963       if on_polic
+00010a90: 795f 696e 7465 7276 616c 2069 7320 6e6f  y_interval is no
+00010aa0: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
+00010ab0: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+00010ac0: 735f 7265 6c61 7469 7665 3a0a 2020 2020  s_relative:.    
+00010ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010ae0: 2020 2020 6178 2e61 7868 6c69 6e65 286f      ax.axhline(o
+00010af0: 6e5f 706f 6c69 6379 5f69 6e74 6572 7661  n_policy_interva
+00010b00: 6c5b 226d 6561 6e22 5d20 2f20 6265 6861  l["mean"] / beha
+00010b10: 7669 6f72 5f70 6f6c 6963 795f 7661 6c75  vior_policy_valu
+00010b20: 6529 0a20 2020 2020 2020 2020 2020 2020  e).             
+00010b30: 2020 2020 2020 2020 2020 2061 782e 6178             ax.ax
+00010b40: 6873 7061 6e28 0a20 2020 2020 2020 2020  hspan(.         
+00010b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010b60: 2020 2079 6d69 6e3d 6f6e 5f70 6f6c 6963     ymin=on_polic
+00010b70: 795f 696e 7465 7276 616c 5b66 227b 3130  y_interval[f"{10
+00010b80: 3020 2a20 2831 2e20 2d20 616c 7068 6129  0 * (1. - alpha)
+00010b90: 7d25 2043 4920 286c 6f77 6572 2922 5d0a  }% CI (lower)"].
+00010ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010bb0: 2020 2020 2020 2020 2020 2020 2f20 6265              / be
+00010bc0: 6861 7669 6f72 5f70 6f6c 6963 795f 7661  havior_policy_va
+00010bd0: 6c75 652c 0a20 2020 2020 2020 2020 2020  lue,.           
+00010be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010bf0: 2079 6d61 783d 6f6e 5f70 6f6c 6963 795f   ymax=on_policy_
+00010c00: 696e 7465 7276 616c 5b66 227b 3130 3020  interval[f"{100 
+00010c10: 2a20 2831 2e20 2d20 616c 7068 6129 7d25  * (1. - alpha)}%
+00010c20: 2043 4920 2875 7070 6572 2922 5d0a 2020   CI (upper)"].  
+00010c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010c40: 2020 2020 2020 2020 2020 2f20 6265 6861            / beha
+00010c50: 7669 6f72 5f70 6f6c 6963 795f 7661 6c75  vior_policy_valu
+00010c60: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+00010c70: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+00010c80: 6c70 6861 3d30 2e33 2c0a 2020 2020 2020  lpha=0.3,.      
+00010c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010ca0: 2020 290a 0a20 2020 2020 2020 2020 2020    )..           
+00010cb0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+00010cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010cd0: 2020 2020 2020 2061 782e 6178 686c 696e         ax.axhlin
+00010ce0: 6528 6f6e 5f70 6f6c 6963 795f 696e 7465  e(on_policy_inte
+00010cf0: 7276 616c 5b22 6d65 616e 225d 290a 2020  rval["mean"]).  
+00010d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010d10: 2020 2020 2020 6178 2e61 7868 7370 616e        ax.axhspan
+00010d20: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00010d30: 2020 2020 2020 2020 2020 2020 2020 796d                ym
+00010d40: 696e 3d6f 6e5f 706f 6c69 6379 5f69 6e74  in=on_policy_int
+00010d50: 6572 7661 6c5b 0a20 2020 2020 2020 2020  erval[.         
+00010d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010d70: 2020 2020 2020 2066 227b 3130 3020 2a20         f"{100 * 
+00010d80: 2831 2e20 2d20 616c 7068 6129 7d25 2043  (1. - alpha)}% C
+00010d90: 4920 286c 6f77 6572 2922 0a20 2020 2020  I (lower)".     
+00010da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010db0: 2020 2020 2020 205d 2c0a 2020 2020 2020         ],.      
+00010dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010dd0: 2020 2020 2020 796d 6178 3d6f 6e5f 706f        ymax=on_po
+00010de0: 6c69 6379 5f69 6e74 6572 7661 6c5b 0a20  licy_interval[. 
+00010df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010e00: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00010e10: 227b 3130 3020 2a20 2831 2e20 2d20 616c  "{100 * (1. - al
+00010e20: 7068 6129 7d25 2043 4920 2875 7070 6572  pha)}% CI (upper
+00010e30: 2922 0a20 2020 2020 2020 2020 2020 2020  )".             
+00010e40: 2020 2020 2020 2020 2020 2020 2020 205d                 ]
+00010e50: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00010e60: 2020 2020 2020 2020 2020 2020 2020 616c                al
+00010e70: 7068 613d 302e 332c 0a20 2020 2020 2020  pha=0.3,.       
+00010e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010e90: 2029 0a0a 2020 2020 2020 2020 2020 2020   )..            
+00010ea0: 2020 2020 6178 2e73 6574 5f74 6974 6c65      ax.set_title
+00010eb0: 2865 7661 6c5f 706f 6c69 6379 2c20 666f  (eval_policy, fo
+00010ec0: 6e74 7369 7a65 3d31 3629 0a20 2020 2020  ntsize=16).     
+00010ed0: 2020 2020 2020 2020 2020 2061 782e 7365             ax.se
+00010ee0: 745f 796c 6162 656c 280a 2020 2020 2020  t_ylabel(.      
+00010ef0: 2020 2020 2020 2020 2020 2020 2020 6622                f"
+00010f00: 4573 7469 6d61 7465 6420 506f 6c69 6379  Estimated Policy
+00010f10: 2056 616c 7565 2028 c2b1 207b 6e70 2e69   Value (.. {np.i
+00010f20: 6e74 3634 2831 3030 2a28 3120 2d20 616c  nt64(100*(1 - al
+00010f30: 7068 6129 297d 2520 4349 2922 2c0a 2020  pha))}% CI)",.  
+00010f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010f50: 2020 666f 6e74 7369 7a65 3d31 322c 0a20    fontsize=12,. 
+00010f60: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+00010f70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00010f80: 2070 6c74 2e79 7469 636b 7328 666f 6e74   plt.yticks(font
+00010f90: 7369 7a65 3d31 3229 0a20 2020 2020 2020  size=12).       
+00010fa0: 2020 2020 2020 2020 2070 6c74 2e78 7469           plt.xti
+00010fb0: 636b 7328 666f 6e74 7369 7a65 3d31 3229  cks(fontsize=12)
+00010fc0: 0a0a 2020 2020 2020 2020 656c 7365 3a0a  ..        else:.
+00010fd0: 2020 2020 2020 2020 2020 2020 7669 7375              visu
+00010fe0: 616c 697a 655f 6f6e 5f70 6f6c 6963 7920  alize_on_policy 
+00010ff0: 3d20 5472 7565 0a20 2020 2020 2020 2020  = True.         
+00011000: 2020 2066 6f72 2065 7661 6c5f 706f 6c69     for eval_poli
+00011010: 6379 2069 6e20 696e 7075 745f 6469 6374  cy in input_dict
+00011020: 2e6b 6579 7328 293a 0a20 2020 2020 2020  .keys():.       
+00011030: 2020 2020 2020 2020 2069 6620 696e 7075           if inpu
+00011040: 745f 6469 6374 5b65 7661 6c5f 706f 6c69  t_dict[eval_poli
+00011050: 6379 5d5b 226f 6e5f 706f 6c69 6379 5f70  cy]["on_policy_p
+00011060: 6f6c 6963 795f 7661 6c75 6522 5d20 6973  olicy_value"] is
+00011070: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+00011080: 2020 2020 2020 2020 2020 2076 6973 7561             visua
+00011090: 6c69 7a65 5f6f 6e5f 706f 6c69 6379 203d  lize_on_policy =
+000110a0: 2046 616c 7365 0a0a 2020 2020 2020 2020   False..        
+000110b0: 2020 2020 6e5f 706f 6c69 6369 6573 203d      n_policies =
+000110c0: 206c 656e 2869 6e70 7574 5f64 6963 7429   len(input_dict)
+000110d0: 0a20 2020 2020 2020 2020 2020 206e 5f65  .            n_e
+000110e0: 7374 696d 6174 6f72 7320 3d20 280a 2020  stimators = (.  
+000110f0: 2020 2020 2020 2020 2020 2020 2020 6c65                le
+00011100: 6e28 636f 6d70 6172 6564 5f65 7374 696d  n(compared_estim
+00011110: 6174 6f72 7329 202b 2031 0a20 2020 2020  ators) + 1.     
+00011120: 2020 2020 2020 2020 2020 2069 6620 7669             if vi
+00011130: 7375 616c 697a 655f 6f6e 5f70 6f6c 6963  sualize_on_polic
+00011140: 790a 2020 2020 2020 2020 2020 2020 2020  y.              
+00011150: 2020 656c 7365 206c 656e 2863 6f6d 7061    else len(compa
+00011160: 7265 645f 6573 7469 6d61 746f 7273 290a  red_estimators).
+00011170: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+00011180: 2020 2020 2020 2020 2020 2066 6967 203d             fig =
+00011190: 2070 6c74 2e66 6967 7572 6528 6669 6773   plt.figure(figs
+000111a0: 697a 653d 2832 202a 206e 5f70 6f6c 6963  ize=(2 * n_polic
+000111b0: 6965 732c 2034 202a 206e 5f65 7374 696d  ies, 4 * n_estim
+000111c0: 6174 6f72 7329 290a 0a20 2020 2020 2020  ators))..       
+000111d0: 2020 2020 2066 6f72 2069 2c20 6573 7469       for i, esti
+000111e0: 6d61 746f 7220 696e 2065 6e75 6d65 7261  mator in enumera
+000111f0: 7465 2863 6f6d 7061 7265 645f 6573 7469  te(compared_esti
+00011200: 6d61 746f 7273 293a 0a20 2020 2020 2020  mators):.       
+00011210: 2020 2020 2020 2020 2069 6620 6920 3d3d           if i ==
+00011220: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
+00011230: 2020 2020 2020 2020 6178 203d 2061 7830          ax = ax0
+00011240: 203d 2066 6967 2e61 6464 5f73 7562 706c   = fig.add_subpl
+00011250: 6f74 286e 5f65 7374 696d 6174 6f72 732c  ot(n_estimators,
+00011260: 2031 2c20 6920 2b20 3129 0a20 2020 2020   1, i + 1).     
+00011270: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
+00011280: 7368 6172 6579 3a0a 2020 2020 2020 2020  sharey:.        
+00011290: 2020 2020 2020 2020 2020 2020 6178 203d              ax =
+000112a0: 2066 6967 2e61 6464 5f73 7562 706c 6f74   fig.add_subplot
+000112b0: 286e 5f65 7374 696d 6174 6f72 732c 2031  (n_estimators, 1
+000112c0: 2c20 6920 2b20 312c 2073 6861 7265 793d  , i + 1, sharey=
+000112d0: 6178 3029 0a20 2020 2020 2020 2020 2020  ax0).           
+000112e0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+000112f0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+00011300: 7820 3d20 6669 672e 6164 645f 7375 6270  x = fig.add_subp
+00011310: 6c6f 7428 6e5f 6573 7469 6d61 746f 7273  lot(n_estimators
+00011320: 2c20 312c 2069 202b 2031 290a 0a20 2020  , 1, i + 1)..   
+00011330: 2020 2020 2020 2020 2020 2020 206d 6561               mea
+00011340: 6e20 3d20 6e70 2e7a 6572 6f73 286e 5f70  n = np.zeros(n_p
+00011350: 6f6c 6963 6965 7329 0a20 2020 2020 2020  olicies).       
+00011360: 2020 2020 2020 2020 206c 6f77 6572 203d           lower =
+00011370: 206e 702e 7a65 726f 7328 6e5f 706f 6c69   np.zeros(n_poli
+00011380: 6369 6573 290a 2020 2020 2020 2020 2020  cies).          
+00011390: 2020 2020 2020 7570 7065 7220 3d20 6e70        upper = np
+000113a0: 2e7a 6572 6f73 286e 5f70 6f6c 6963 6965  .zeros(n_policie
+000113b0: 7329 0a0a 2020 2020 2020 2020 2020 2020  s)..            
+000113c0: 2020 2020 666f 7220 6a2c 2065 7661 6c5f      for j, eval_
+000113d0: 706f 6c69 6379 2069 6e20 656e 756d 6572  policy in enumer
+000113e0: 6174 6528 696e 7075 745f 6469 6374 2e6b  ate(input_dict.k
+000113f0: 6579 7328 2929 3a0a 2020 2020 2020 2020  eys()):.        
+00011400: 2020 2020 2020 2020 2020 2020 6d65 616e              mean
+00011410: 5b6a 5d20 3d20 706f 6c69 6379 5f76 616c  [j] = policy_val
+00011420: 7565 5f69 6e74 6572 7661 6c5f 6469 6374  ue_interval_dict
+00011430: 5b65 7661 6c5f 706f 6c69 6379 5d5b 6573  [eval_policy][es
+00011440: 7469 6d61 746f 725d 5b22 6d65 616e 225d  timator]["mean"]
+00011450: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00011460: 2020 2020 206c 6f77 6572 5b6a 5d20 3d20       lower[j] = 
+00011470: 706f 6c69 6379 5f76 616c 7565 5f69 6e74  policy_value_int
+00011480: 6572 7661 6c5f 6469 6374 5b65 7661 6c5f  erval_dict[eval_
+00011490: 706f 6c69 6379 5d5b 6573 7469 6d61 746f  policy][estimato
+000114a0: 725d 5b0a 2020 2020 2020 2020 2020 2020  r][.            
+000114b0: 2020 2020 2020 2020 2020 2020 6622 7b31              f"{1
+000114c0: 3030 202a 2028 312e 202d 2061 6c70 6861  00 * (1. - alpha
+000114d0: 297d 2520 4349 2028 6c6f 7765 7229 220a  )}% CI (lower)".
+000114e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000114f0: 2020 2020 5d0a 2020 2020 2020 2020 2020      ].          
+00011500: 2020 2020 2020 2020 2020 7570 7065 725b            upper[
+00011510: 6a5d 203d 2070 6f6c 6963 795f 7661 6c75  j] = policy_valu
+00011520: 655f 696e 7465 7276 616c 5f64 6963 745b  e_interval_dict[
+00011530: 6576 616c 5f70 6f6c 6963 795d 5b65 7374  eval_policy][est
+00011540: 696d 6174 6f72 5d5b 0a20 2020 2020 2020  imator][.       
+00011550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011560: 2066 227b 3130 3020 2a20 2831 2e20 2d20   f"{100 * (1. - 
+00011570: 616c 7068 6129 7d25 2043 4920 2875 7070  alpha)}% CI (upp
+00011580: 6572 2922 0a20 2020 2020 2020 2020 2020  er)".           
+00011590: 2020 2020 2020 2020 205d 0a0a 2020 2020           ]..    
+000115a0: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+000115b0: 735f 7265 6c61 7469 7665 3a0a 2020 2020  s_relative:.    
+000115c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000115d0: 6d65 616e 203d 206d 6561 6e20 2f20 6265  mean = mean / be
+000115e0: 6861 7669 6f72 5f70 6f6c 6963 795f 7661  havior_policy_va
+000115f0: 6c75 650a 2020 2020 2020 2020 2020 2020  lue.            
+00011600: 2020 2020 2020 2020 6c6f 7765 7220 3d20          lower = 
+00011610: 6c6f 7765 7220 2f20 6265 6861 7669 6f72  lower / behavior
+00011620: 5f70 6f6c 6963 795f 7661 6c75 650a 2020  _policy_value.  
+00011630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011640: 2020 7570 7065 7220 3d20 7570 7065 7220    upper = upper 
+00011650: 2f20 6265 6861 7669 6f72 5f70 6f6c 6963  / behavior_polic
+00011660: 795f 7661 6c75 650a 0a20 2020 2020 2020  y_value..       
+00011670: 2020 2020 2020 2020 2061 782e 6261 7228           ax.bar(
+00011680: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00011690: 2020 2020 206e 702e 6172 616e 6765 286e       np.arange(n
+000116a0: 5f70 6f6c 6963 6965 7329 2c0a 2020 2020  _policies),.    
+000116b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000116c0: 6d65 616e 2c0a 2020 2020 2020 2020 2020  mean,.          
+000116d0: 2020 2020 2020 2020 2020 7965 7272 3d5b            yerr=[
+000116e0: 7570 7065 7220 2d20 6d65 616e 2c20 6d65  upper - mean, me
+000116f0: 616e 202d 206c 6f77 6572 5d2c 0a20 2020  an - lower],.   
+00011700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011710: 2063 6f6c 6f72 3d63 6f6c 6f72 2c0a 2020   color=color,.  
+00011720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011730: 2020 7469 636b 5f6c 6162 656c 3d6c 6973    tick_label=lis
+00011740: 7428 696e 7075 745f 6469 6374 2e6b 6579  t(input_dict.key
+00011750: 7328 2929 2c0a 2020 2020 2020 2020 2020  s()),.          
+00011760: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+00011770: 2020 2020 2020 2020 2061 782e 7365 745f           ax.set_
+00011780: 7469 746c 6528 6573 7469 6d61 746f 722c  title(estimator,
+00011790: 2066 6f6e 7473 697a 653d 3136 290a 2020   fontsize=16).  
+000117a0: 2020 2020 2020 2020 2020 2020 2020 6178                ax
+000117b0: 2e73 6574 5f79 6c61 6265 6c28 0a20 2020  .set_ylabel(.   
 000117c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000117d0: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
-000117e0: 2020 2061 782e 7365 745f 7469 746c 6528     ax.set_title(
-000117f0: 6573 7469 6d61 746f 722c 2066 6f6e 7473  estimator, fonts
-00011800: 697a 653d 3136 290a 2020 2020 2020 2020  ize=16).        
-00011810: 2020 2020 2020 2020 6178 2e73 6574 5f79          ax.set_y
-00011820: 6c61 6265 6c28 0a20 2020 2020 2020 2020  label(.         
-00011830: 2020 2020 2020 2020 2020 2066 2245 7374             f"Est
-00011840: 696d 6174 6564 2050 6f6c 6963 7920 5661  imated Policy Va
-00011850: 6c75 6520 28c2 b120 7b6e 702e 696e 7436  lue (.. {np.int6
-00011860: 3428 3130 302a 2831 202d 2061 6c70 6861  4(100*(1 - alpha
-00011870: 2929 7d25 2043 4929 222c 0a20 2020 2020  ))}% CI)",.     
-00011880: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00011890: 6f6e 7473 697a 653d 3132 2c0a 2020 2020  ontsize=12,.    
-000118a0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-000118b0: 2020 2020 2020 2020 2020 2020 2020 706c                pl
-000118c0: 742e 7974 6963 6b73 2866 6f6e 7473 697a  t.yticks(fontsiz
-000118d0: 653d 3132 290a 2020 2020 2020 2020 2020  e=12).          
-000118e0: 2020 2020 2020 706c 742e 7874 6963 6b73        plt.xticks
-000118f0: 2866 6f6e 7473 697a 653d 3132 290a 0a20  (fontsize=12).. 
-00011900: 2020 2020 2020 2020 2020 2069 6620 7669             if vi
-00011910: 7375 616c 697a 655f 6f6e 5f70 6f6c 6963  sualize_on_polic
-00011920: 793a 0a20 2020 2020 2020 2020 2020 2020  y:.             
-00011930: 2020 2069 6620 7368 6172 6579 3a0a 2020     if sharey:.  
-00011940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011950: 2020 6178 203d 2066 6967 2e61 6464 5f73    ax = fig.add_s
-00011960: 7562 706c 6f74 286e 5f65 7374 696d 6174  ubplot(n_estimat
-00011970: 6f72 732c 2031 2c20 6920 2b20 322c 2073  ors, 1, i + 2, s
-00011980: 6861 7265 793d 6178 3029 0a20 2020 2020  harey=ax0).     
-00011990: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-000119a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000119b0: 2020 2020 2061 7820 3d20 6669 672e 6164       ax = fig.ad
-000119c0: 645f 7375 6270 6c6f 7428 6e5f 6573 7469  d_subplot(n_esti
-000119d0: 6d61 746f 7273 2c20 312c 2069 202b 2032  mators, 1, i + 2
-000119e0: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
-000119f0: 2020 206d 6561 6e20 3d20 6e70 2e7a 6572     mean = np.zer
-00011a00: 6f73 286e 5f70 6f6c 6963 6965 7329 0a20  os(n_policies). 
-00011a10: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-00011a20: 6f77 6572 203d 206e 702e 7a65 726f 7328  ower = np.zeros(
-00011a30: 6e5f 706f 6c69 6369 6573 290a 2020 2020  n_policies).    
-00011a40: 2020 2020 2020 2020 2020 2020 7570 7065              uppe
-00011a50: 7220 3d20 6e70 2e7a 6572 6f73 286e 5f70  r = np.zeros(n_p
-00011a60: 6f6c 6963 6965 7329 0a0a 2020 2020 2020  olicies)..      
-00011a70: 2020 2020 2020 2020 2020 666f 7220 6a2c            for j,
-00011a80: 2065 7661 6c5f 706f 6c69 6379 2069 6e20   eval_policy in 
-00011a90: 656e 756d 6572 6174 6528 696e 7075 745f  enumerate(input_
-00011aa0: 6469 6374 2e6b 6579 7328 2929 3a0a 2020  dict.keys()):.  
-00011ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011ac0: 2020 6d65 616e 5b6a 5d20 3d20 706f 6c69    mean[j] = poli
-00011ad0: 6379 5f76 616c 7565 5f69 6e74 6572 7661  cy_value_interva
-00011ae0: 6c5f 6469 6374 5b65 7661 6c5f 706f 6c69  l_dict[eval_poli
-00011af0: 6379 5d5b 226f 6e5f 706f 6c69 6379 225d  cy]["on_policy"]
-00011b00: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
-00011b10: 2020 2020 2020 2020 2020 226d 6561 6e22            "mean"
-00011b20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00011b30: 2020 2020 205d 0a20 2020 2020 2020 2020       ].         
-00011b40: 2020 2020 2020 2020 2020 206c 6f77 6572             lower
-00011b50: 5b6a 5d20 3d20 706f 6c69 6379 5f76 616c  [j] = policy_val
-00011b60: 7565 5f69 6e74 6572 7661 6c5f 6469 6374  ue_interval_dict
-00011b70: 5b65 7661 6c5f 706f 6c69 6379 5d5b 226f  [eval_policy]["o
-00011b80: 6e5f 706f 6c69 6379 225d 5b0a 2020 2020  n_policy"][.    
-00011b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011ba0: 2020 2020 6622 7b31 3030 202a 2028 312e      f"{100 * (1.
-00011bb0: 202d 2061 6c70 6861 297d 2520 4349 2028   - alpha)}% CI (
-00011bc0: 6c6f 7765 7229 220a 2020 2020 2020 2020  lower)".        
-00011bd0: 2020 2020 2020 2020 2020 2020 5d0a 2020              ].  
-00011be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011bf0: 2020 7570 7065 725b 6a5d 203d 2070 6f6c    upper[j] = pol
-00011c00: 6963 795f 7661 6c75 655f 696e 7465 7276  icy_value_interv
-00011c10: 616c 5f64 6963 745b 6576 616c 5f70 6f6c  al_dict[eval_pol
-00011c20: 6963 795d 5b22 6f6e 5f70 6f6c 6963 7922  icy]["on_policy"
-00011c30: 5d5b 0a20 2020 2020 2020 2020 2020 2020  ][.             
-00011c40: 2020 2020 2020 2020 2020 2066 227b 3130             f"{10
-00011c50: 3020 2a20 2831 2e20 2d20 616c 7068 6129  0 * (1. - alpha)
-00011c60: 7d25 2043 4920 2875 7070 6572 2922 0a20  }% CI (upper)". 
-00011c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011c80: 2020 205d 0a0a 2020 2020 2020 2020 2020     ]..          
-00011c90: 2020 2020 2020 6966 2069 735f 7265 6c61        if is_rela
-00011ca0: 7469 7665 3a0a 2020 2020 2020 2020 2020  tive:.          
-00011cb0: 2020 2020 2020 2020 2020 6d65 616e 203d            mean =
-00011cc0: 206d 6561 6e20 2f20 6265 6861 7669 6f72   mean / behavior
-00011cd0: 5f70 6f6c 6963 795f 7661 6c75 650a 2020  _policy_value.  
-00011ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011cf0: 2020 6c6f 7765 7220 3d20 6c6f 7765 7220    lower = lower 
-00011d00: 2f20 6265 6861 7669 6f72 5f70 6f6c 6963  / behavior_polic
-00011d10: 795f 7661 6c75 650a 2020 2020 2020 2020  y_value.        
-00011d20: 2020 2020 2020 2020 2020 2020 7570 7065              uppe
-00011d30: 7220 3d20 7570 7065 7220 2f20 6265 6861  r = upper / beha
-00011d40: 7669 6f72 5f70 6f6c 6963 795f 7661 6c75  vior_policy_valu
-00011d50: 650a 0a20 2020 2020 2020 2020 2020 2020  e..             
-00011d60: 2020 2061 782e 6261 7228 0a20 2020 2020     ax.bar(.     
-00011d70: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-00011d80: 702e 6172 616e 6765 286e 5f70 6f6c 6963  p.arange(n_polic
-00011d90: 6965 7329 2c0a 2020 2020 2020 2020 2020  ies),.          
-00011da0: 2020 2020 2020 2020 2020 6d65 616e 2c0a            mean,.
-00011db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011dc0: 2020 2020 7965 7272 3d5b 7570 7065 7220      yerr=[upper 
-00011dd0: 2d20 6d65 616e 2c20 6d65 616e 202d 206c  - mean, mean - l
-00011de0: 6f77 6572 5d2c 0a20 2020 2020 2020 2020  ower],.         
-00011df0: 2020 2020 2020 2020 2020 2063 6f6c 6f72             color
-00011e00: 3d63 6f6c 6f72 2c0a 2020 2020 2020 2020  =color,.        
-00011e10: 2020 2020 2020 2020 2020 2020 7469 636b              tick
-00011e20: 5f6c 6162 656c 3d6c 6973 7428 696e 7075  _label=list(inpu
-00011e30: 745f 6469 6374 2e6b 6579 7328 2929 2c0a  t_dict.keys()),.
+000117d0: 2066 2245 7374 696d 6174 6564 2050 6f6c   f"Estimated Pol
+000117e0: 6963 7920 5661 6c75 6520 28c2 b120 7b6e  icy Value (.. {n
+000117f0: 702e 696e 7436 3428 3130 302a 2831 202d  p.int64(100*(1 -
+00011800: 2061 6c70 6861 2929 7d25 2043 4929 222c   alpha))}% CI)",
+00011810: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00011820: 2020 2020 2066 6f6e 7473 697a 653d 3132       fontsize=12
+00011830: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00011840: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+00011850: 2020 2020 706c 742e 7974 6963 6b73 2866      plt.yticks(f
+00011860: 6f6e 7473 697a 653d 3132 290a 2020 2020  ontsize=12).    
+00011870: 2020 2020 2020 2020 2020 2020 706c 742e              plt.
+00011880: 7874 6963 6b73 2866 6f6e 7473 697a 653d  xticks(fontsize=
+00011890: 3132 290a 0a20 2020 2020 2020 2020 2020  12)..           
+000118a0: 2069 6620 7669 7375 616c 697a 655f 6f6e   if visualize_on
+000118b0: 5f70 6f6c 6963 793a 0a20 2020 2020 2020  _policy:.       
+000118c0: 2020 2020 2020 2020 2069 6620 7368 6172           if shar
+000118d0: 6579 3a0a 2020 2020 2020 2020 2020 2020  ey:.            
+000118e0: 2020 2020 2020 2020 6178 203d 2066 6967          ax = fig
+000118f0: 2e61 6464 5f73 7562 706c 6f74 286e 5f65  .add_subplot(n_e
+00011900: 7374 696d 6174 6f72 732c 2031 2c20 6920  stimators, 1, i 
+00011910: 2b20 322c 2073 6861 7265 793d 6178 3029  + 2, sharey=ax0)
+00011920: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00011930: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00011940: 2020 2020 2020 2020 2020 2061 7820 3d20             ax = 
+00011950: 6669 672e 6164 645f 7375 6270 6c6f 7428  fig.add_subplot(
+00011960: 6e5f 6573 7469 6d61 746f 7273 2c20 312c  n_estimators, 1,
+00011970: 2069 202b 2032 290a 0a20 2020 2020 2020   i + 2)..       
+00011980: 2020 2020 2020 2020 206d 6561 6e20 3d20           mean = 
+00011990: 6e70 2e7a 6572 6f73 286e 5f70 6f6c 6963  np.zeros(n_polic
+000119a0: 6965 7329 0a20 2020 2020 2020 2020 2020  ies).           
+000119b0: 2020 2020 206c 6f77 6572 203d 206e 702e       lower = np.
+000119c0: 7a65 726f 7328 6e5f 706f 6c69 6369 6573  zeros(n_policies
+000119d0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+000119e0: 2020 7570 7065 7220 3d20 6e70 2e7a 6572    upper = np.zer
+000119f0: 6f73 286e 5f70 6f6c 6963 6965 7329 0a0a  os(n_policies)..
+00011a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011a10: 666f 7220 6a2c 2065 7661 6c5f 706f 6c69  for j, eval_poli
+00011a20: 6379 2069 6e20 656e 756d 6572 6174 6528  cy in enumerate(
+00011a30: 696e 7075 745f 6469 6374 2e6b 6579 7328  input_dict.keys(
+00011a40: 2929 3a0a 2020 2020 2020 2020 2020 2020  )):.            
+00011a50: 2020 2020 2020 2020 6d65 616e 5b6a 5d20          mean[j] 
+00011a60: 3d20 706f 6c69 6379 5f76 616c 7565 5f69  = policy_value_i
+00011a70: 6e74 6572 7661 6c5f 6469 6374 5b65 7661  nterval_dict[eva
+00011a80: 6c5f 706f 6c69 6379 5d5b 226f 6e5f 706f  l_policy]["on_po
+00011a90: 6c69 6379 225d 5b0a 2020 2020 2020 2020  licy"][.        
+00011aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011ab0: 226d 6561 6e22 0a20 2020 2020 2020 2020  "mean".         
+00011ac0: 2020 2020 2020 2020 2020 205d 0a20 2020             ].   
+00011ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011ae0: 206c 6f77 6572 5b6a 5d20 3d20 706f 6c69   lower[j] = poli
+00011af0: 6379 5f76 616c 7565 5f69 6e74 6572 7661  cy_value_interva
+00011b00: 6c5f 6469 6374 5b65 7661 6c5f 706f 6c69  l_dict[eval_poli
+00011b10: 6379 5d5b 226f 6e5f 706f 6c69 6379 225d  cy]["on_policy"]
+00011b20: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
+00011b30: 2020 2020 2020 2020 2020 6622 7b31 3030            f"{100
+00011b40: 202a 2028 312e 202d 2061 6c70 6861 297d   * (1. - alpha)}
+00011b50: 2520 4349 2028 6c6f 7765 7229 220a 2020  % CI (lower)".  
+00011b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011b70: 2020 5d0a 2020 2020 2020 2020 2020 2020    ].            
+00011b80: 2020 2020 2020 2020 7570 7065 725b 6a5d          upper[j]
+00011b90: 203d 2070 6f6c 6963 795f 7661 6c75 655f   = policy_value_
+00011ba0: 696e 7465 7276 616c 5f64 6963 745b 6576  interval_dict[ev
+00011bb0: 616c 5f70 6f6c 6963 795d 5b22 6f6e 5f70  al_policy]["on_p
+00011bc0: 6f6c 6963 7922 5d5b 0a20 2020 2020 2020  olicy"][.       
+00011bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011be0: 2066 227b 3130 3020 2a20 2831 2e20 2d20   f"{100 * (1. - 
+00011bf0: 616c 7068 6129 7d25 2043 4920 2875 7070  alpha)}% CI (upp
+00011c00: 6572 2922 0a20 2020 2020 2020 2020 2020  er)".           
+00011c10: 2020 2020 2020 2020 205d 0a0a 2020 2020           ]..    
+00011c20: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+00011c30: 735f 7265 6c61 7469 7665 3a0a 2020 2020  s_relative:.    
+00011c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011c50: 6d65 616e 203d 206d 6561 6e20 2f20 6265  mean = mean / be
+00011c60: 6861 7669 6f72 5f70 6f6c 6963 795f 7661  havior_policy_va
+00011c70: 6c75 650a 2020 2020 2020 2020 2020 2020  lue.            
+00011c80: 2020 2020 2020 2020 6c6f 7765 7220 3d20          lower = 
+00011c90: 6c6f 7765 7220 2f20 6265 6861 7669 6f72  lower / behavior
+00011ca0: 5f70 6f6c 6963 795f 7661 6c75 650a 2020  _policy_value.  
+00011cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011cc0: 2020 7570 7065 7220 3d20 7570 7065 7220    upper = upper 
+00011cd0: 2f20 6265 6861 7669 6f72 5f70 6f6c 6963  / behavior_polic
+00011ce0: 795f 7661 6c75 650a 0a20 2020 2020 2020  y_value..       
+00011cf0: 2020 2020 2020 2020 2061 782e 6261 7228           ax.bar(
+00011d00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00011d10: 2020 2020 206e 702e 6172 616e 6765 286e       np.arange(n
+00011d20: 5f70 6f6c 6963 6965 7329 2c0a 2020 2020  _policies),.    
+00011d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011d40: 6d65 616e 2c0a 2020 2020 2020 2020 2020  mean,.          
+00011d50: 2020 2020 2020 2020 2020 7965 7272 3d5b            yerr=[
+00011d60: 7570 7065 7220 2d20 6d65 616e 2c20 6d65  upper - mean, me
+00011d70: 616e 202d 206c 6f77 6572 5d2c 0a20 2020  an - lower],.   
+00011d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011d90: 2063 6f6c 6f72 3d63 6f6c 6f72 2c0a 2020   color=color,.  
+00011da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011db0: 2020 7469 636b 5f6c 6162 656c 3d6c 6973    tick_label=lis
+00011dc0: 7428 696e 7075 745f 6469 6374 2e6b 6579  t(input_dict.key
+00011dd0: 7328 2929 2c0a 2020 2020 2020 2020 2020  s()),.          
+00011de0: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+00011df0: 2020 2020 2020 2020 2061 782e 7365 745f           ax.set_
+00011e00: 7469 746c 6528 226f 6e5f 706f 6c69 6379  title("on_policy
+00011e10: 222c 2066 6f6e 7473 697a 653d 3136 290a  ", fontsize=16).
+00011e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011e30: 6178 2e73 6574 5f79 6c61 6265 6c28 0a20  ax.set_ylabel(. 
 00011e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011e50: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
-00011e60: 2020 2061 782e 7365 745f 7469 746c 6528     ax.set_title(
-00011e70: 226f 6e5f 706f 6c69 6379 222c 2066 6f6e  "on_policy", fon
-00011e80: 7473 697a 653d 3136 290a 2020 2020 2020  tsize=16).      
-00011e90: 2020 2020 2020 2020 2020 6178 2e73 6574            ax.set
-00011ea0: 5f79 6c61 6265 6c28 0a20 2020 2020 2020  _ylabel(.       
-00011eb0: 2020 2020 2020 2020 2020 2020 2066 2245               f"E
-00011ec0: 7374 696d 6174 6564 2050 6f6c 6963 7920  stimated Policy 
-00011ed0: 5661 6c75 6520 28c2 b120 7b6e 702e 696e  Value (.. {np.in
-00011ee0: 7436 3428 3130 302a 2831 202d 2061 6c70  t64(100*(1 - alp
-00011ef0: 6861 2929 7d25 2043 4929 222c 0a20 2020  ha))}% CI)",.   
-00011f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011f10: 2066 6f6e 7473 697a 653d 3132 2c0a 2020   fontsize=12,.  
-00011f20: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-00011f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011f40: 706c 742e 7974 6963 6b73 2866 6f6e 7473  plt.yticks(fonts
-00011f50: 697a 653d 3132 290a 2020 2020 2020 2020  ize=12).        
-00011f60: 2020 2020 2020 2020 706c 742e 7874 6963          plt.xtic
-00011f70: 6b73 2866 6f6e 7473 697a 653d 3132 290a  ks(fontsize=12).
-00011f80: 0a20 2020 2020 2020 2066 6967 2e73 7562  .        fig.sub
-00011f90: 706c 6f74 735f 6164 6a75 7374 2874 6f70  plots_adjust(top
-00011fa0: 3d31 2e30 290a 2020 2020 2020 2020 706c  =1.0).        pl
-00011fb0: 742e 7368 6f77 2829 0a0a 2020 2020 2020  t.show()..      
-00011fc0: 2020 6966 2066 6967 5f64 6972 3a0a 2020    if fig_dir:.  
-00011fd0: 2020 2020 2020 2020 2020 6669 672e 7361            fig.sa
-00011fe0: 7665 6669 6728 7374 7228 6669 675f 6469  vefig(str(fig_di
-00011ff0: 7220 2f20 6669 675f 6e61 6d65 292c 2064  r / fig_name), d
-00012000: 7069 3d33 3030 2c20 6262 6f78 5f69 6e63  pi=300, bbox_inc
-00012010: 6865 733d 2274 6967 6874 2229 0a0a 2020  hes="tight")..  
-00012020: 2020 6465 6620 7669 7375 616c 697a 655f    def visualize_
-00012030: 706f 6c69 6379 5f76 616c 7565 5f77 6974  policy_value_wit
-00012040: 685f 6d75 6c74 6970 6c65 5f65 7374 696d  h_multiple_estim
-00012050: 6174 6573 280a 2020 2020 2020 2020 7365  ates(.        se
-00012060: 6c66 2c0a 2020 2020 2020 2020 696e 7075  lf,.        inpu
-00012070: 745f 6469 6374 3a20 4d75 6c74 6970 6c65  t_dict: Multiple
-00012080: 496e 7075 7444 6963 742c 0a20 2020 2020  InputDict,.     
-00012090: 2020 2063 6f6d 7061 7265 645f 6573 7469     compared_esti
-000120a0: 6d61 746f 7273 3a20 4f70 7469 6f6e 616c  mators: Optional
-000120b0: 5b4c 6973 745b 7374 725d 5d20 3d20 4e6f  [List[str]] = No
-000120c0: 6e65 2c0a 2020 2020 2020 2020 6265 6861  ne,.        beha
-000120d0: 7669 6f72 5f70 6f6c 6963 795f 6e61 6d65  vior_policy_name
-000120e0: 3a20 4f70 7469 6f6e 616c 5b73 7472 5d20  : Optional[str] 
-000120f0: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-00012100: 706c 6f74 5f74 7970 653a 2073 7472 203d  plot_type: str =
-00012110: 2022 6369 222c 0a20 2020 2020 2020 2068   "ci",.        h
-00012120: 7565 3a20 7374 7220 3d20 2265 7374 696d  ue: str = "estim
-00012130: 6174 6f72 222c 0a20 2020 2020 2020 206c  ator",.        l
-00012140: 6567 656e 643a 2062 6f6f 6c20 3d20 5472  egend: bool = Tr
-00012150: 7565 2c0a 2020 2020 2020 2020 7368 6172  ue,.        shar
-00012160: 6579 3a20 626f 6f6c 203d 2046 616c 7365  ey: bool = False
-00012170: 2c0a 2020 2020 2020 2020 6669 675f 6469  ,.        fig_di
-00012180: 723a 204f 7074 696f 6e61 6c5b 5061 7468  r: Optional[Path
-00012190: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
-000121a0: 2020 6669 675f 6e61 6d65 3a20 7374 7220    fig_name: str 
-000121b0: 3d20 2265 7374 696d 6174 6564 5f70 6f6c  = "estimated_pol
-000121c0: 6963 795f 7661 6c75 655f 6d75 6c74 6970  icy_value_multip
-000121d0: 6c65 2e70 6e67 222c 0a20 2020 2029 202d  le.png",.    ) -
-000121e0: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
-000121f0: 2222 2256 6973 7561 6c69 7a65 2074 6865  """Visualize the
-00012200: 2070 6f6c 6963 7920 7661 6c75 6520 6573   policy value es
-00012210: 7469 6d61 7465 6420 6279 204f 5045 2065  timated by OPE e
-00012220: 7374 696d 6174 6f72 7320 6163 726f 7373  stimators across
-00012230: 206d 756c 7469 706c 6520 6c6f 6767 6564   multiple logged
-00012240: 2064 6174 6173 6574 2e0a 0a20 2020 2020   dataset...     
-00012250: 2020 204e 6f74 650a 2020 2020 2020 2020     Note.        
-00012260: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-00012270: 5468 6973 2066 756e 6374 696f 6e20 6973  This function is
-00012280: 2061 7070 6c69 6361 626c 6520 6f6e 6c79   applicable only
-00012290: 2077 6865 6e20 4d75 6c74 6970 6c65 4c6f   when MultipleLo
-000122a0: 6767 6564 4461 7461 7365 7420 6973 2075  ggedDataset is u
-000122b0: 7365 642e 0a0a 2020 2020 2020 2020 5061  sed...        Pa
-000122c0: 7261 6d65 7465 7273 0a20 2020 2020 2020  rameters.       
-000122d0: 202d 2d2d 2d2d 2d2d 0a20 2020 2020 2020   -------.       
-000122e0: 2069 6e70 7574 5f64 6963 743a 204f 5045   input_dict: OPE
-000122f0: 496e 7075 7444 6963 7420 6f72 204d 756c  InputDict or Mul
-00012300: 7469 706c 6549 6e70 7574 4469 6374 0a20  tipleInputDict. 
-00012310: 2020 2020 2020 2020 2020 2044 6963 7469             Dicti
-00012320: 6f6e 6172 7920 6f66 2074 6865 204f 5045  onary of the OPE
-00012330: 2069 6e70 7574 7320 666f 7220 6561 6368   inputs for each
-00012340: 2065 7661 6c75 6174 696f 6e20 706f 6c69   evaluation poli
-00012350: 6379 2e0a 0a20 2020 2020 2020 2020 2020  cy...           
-00012360: 202e 2e20 636f 6465 2d62 6c6f 636b 3a3a   .. code-block::
-00012370: 2070 7974 686f 6e0a 0a20 2020 2020 2020   python..       
-00012380: 2020 2020 2020 2020 206b 6579 3a20 5b65           key: [e
-00012390: 7661 6c75 6174 696f 6e5f 706f 6c69 6379  valuation_policy
-000123a0: 5d5b 0a20 2020 2020 2020 2020 2020 2020  ][.             
-000123b0: 2020 2020 2020 2065 7661 6c75 6174 696f         evaluatio
-000123c0: 6e5f 706f 6c69 6379 5f61 6374 696f 6e2c  n_policy_action,
-000123d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000123e0: 2020 2020 2065 7661 6c75 6174 696f 6e5f       evaluation_
-000123f0: 706f 6c69 6379 5f61 6374 696f 6e5f 6469  policy_action_di
-00012400: 7374 2c0a 2020 2020 2020 2020 2020 2020  st,.            
-00012410: 2020 2020 2020 2020 7374 6174 655f 6163          state_ac
-00012420: 7469 6f6e 5f76 616c 7565 5f70 7265 6469  tion_value_predi
-00012430: 6374 696f 6e2c 0a20 2020 2020 2020 2020  ction,.         
-00012440: 2020 2020 2020 2020 2020 2069 6e69 7469             initi
-00012450: 616c 5f73 7461 7465 5f76 616c 7565 5f70  al_state_value_p
-00012460: 7265 6469 6374 696f 6e2c 0a20 2020 2020  rediction,.     
-00012470: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00012480: 7461 7465 5f61 6374 696f 6e5f 6d61 7267  tate_action_marg
-00012490: 696e 616c 5f69 6d70 6f72 7461 6e63 655f  inal_importance_
-000124a0: 7765 6967 6874 2c0a 2020 2020 2020 2020  weight,.        
-000124b0: 2020 2020 2020 2020 2020 2020 7374 6174              stat
-000124c0: 655f 6d61 7267 696e 616c 5f69 6d70 6f72  e_marginal_impor
-000124d0: 7461 6e63 655f 7765 6967 6874 2c0a 2020  tance_weight,.  
+00011e50: 2020 2066 2245 7374 696d 6174 6564 2050     f"Estimated P
+00011e60: 6f6c 6963 7920 5661 6c75 6520 28c2 b120  olicy Value (.. 
+00011e70: 7b6e 702e 696e 7436 3428 3130 302a 2831  {np.int64(100*(1
+00011e80: 202d 2061 6c70 6861 2929 7d25 2043 4929   - alpha))}% CI)
+00011e90: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00011ea0: 2020 2020 2020 2066 6f6e 7473 697a 653d         fontsize=
+00011eb0: 3132 2c0a 2020 2020 2020 2020 2020 2020  12,.            
+00011ec0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+00011ed0: 2020 2020 2020 706c 742e 7974 6963 6b73        plt.yticks
+00011ee0: 2866 6f6e 7473 697a 653d 3132 290a 2020  (fontsize=12).  
+00011ef0: 2020 2020 2020 2020 2020 2020 2020 706c                pl
+00011f00: 742e 7874 6963 6b73 2866 6f6e 7473 697a  t.xticks(fontsiz
+00011f10: 653d 3132 290a 0a20 2020 2020 2020 2066  e=12)..        f
+00011f20: 6967 2e73 7562 706c 6f74 735f 6164 6a75  ig.subplots_adju
+00011f30: 7374 2874 6f70 3d31 2e30 290a 2020 2020  st(top=1.0).    
+00011f40: 2020 2020 706c 742e 7368 6f77 2829 0a0a      plt.show()..
+00011f50: 2020 2020 2020 2020 6966 2066 6967 5f64          if fig_d
+00011f60: 6972 3a0a 2020 2020 2020 2020 2020 2020  ir:.            
+00011f70: 6669 672e 7361 7665 6669 6728 7374 7228  fig.savefig(str(
+00011f80: 6669 675f 6469 7220 2f20 6669 675f 6e61  fig_dir / fig_na
+00011f90: 6d65 292c 2064 7069 3d33 3030 2c20 6262  me), dpi=300, bb
+00011fa0: 6f78 5f69 6e63 6865 733d 2274 6967 6874  ox_inches="tight
+00011fb0: 2229 0a0a 2020 2020 6465 6620 7669 7375  ")..    def visu
+00011fc0: 616c 697a 655f 706f 6c69 6379 5f76 616c  alize_policy_val
+00011fd0: 7565 5f77 6974 685f 6d75 6c74 6970 6c65  ue_with_multiple
+00011fe0: 5f65 7374 696d 6174 6573 280a 2020 2020  _estimates(.    
+00011ff0: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
+00012000: 2020 696e 7075 745f 6469 6374 3a20 4d75    input_dict: Mu
+00012010: 6c74 6970 6c65 496e 7075 7444 6963 742c  ltipleInputDict,
+00012020: 0a20 2020 2020 2020 2063 6f6d 7061 7265  .        compare
+00012030: 645f 6573 7469 6d61 746f 7273 3a20 4f70  d_estimators: Op
+00012040: 7469 6f6e 616c 5b4c 6973 745b 7374 725d  tional[List[str]
+00012050: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
+00012060: 2020 6265 6861 7669 6f72 5f70 6f6c 6963    behavior_polic
+00012070: 795f 6e61 6d65 3a20 4f70 7469 6f6e 616c  y_name: Optional
+00012080: 5b73 7472 5d20 3d20 4e6f 6e65 2c0a 2020  [str] = None,.  
+00012090: 2020 2020 2020 706c 6f74 5f74 7970 653a        plot_type:
+000120a0: 2073 7472 203d 2022 6369 222c 0a20 2020   str = "ci",.   
+000120b0: 2020 2020 2068 7565 3a20 7374 7220 3d20       hue: str = 
+000120c0: 2265 7374 696d 6174 6f72 222c 0a20 2020  "estimator",.   
+000120d0: 2020 2020 206c 6567 656e 643a 2062 6f6f       legend: boo
+000120e0: 6c20 3d20 5472 7565 2c0a 2020 2020 2020  l = True,.      
+000120f0: 2020 7368 6172 6579 3a20 626f 6f6c 203d    sharey: bool =
+00012100: 2046 616c 7365 2c0a 2020 2020 2020 2020   False,.        
+00012110: 6669 675f 6469 723a 204f 7074 696f 6e61  fig_dir: Optiona
+00012120: 6c5b 5061 7468 5d20 3d20 4e6f 6e65 2c0a  l[Path] = None,.
+00012130: 2020 2020 2020 2020 6669 675f 6e61 6d65          fig_name
+00012140: 3a20 7374 7220 3d20 2265 7374 696d 6174  : str = "estimat
+00012150: 6564 5f70 6f6c 6963 795f 7661 6c75 655f  ed_policy_value_
+00012160: 6d75 6c74 6970 6c65 2e70 6e67 222c 0a20  multiple.png",. 
+00012170: 2020 2029 202d 3e20 4e6f 6e65 3a0a 2020     ) -> None:.  
+00012180: 2020 2020 2020 2222 2256 6973 7561 6c69        """Visuali
+00012190: 7a65 2074 6865 2070 6f6c 6963 7920 7661  ze the policy va
+000121a0: 6c75 6520 6573 7469 6d61 7465 6420 6279  lue estimated by
+000121b0: 204f 5045 2065 7374 696d 6174 6f72 7320   OPE estimators 
+000121c0: 6163 726f 7373 206d 756c 7469 706c 6520  across multiple 
+000121d0: 6c6f 6767 6564 2064 6174 6173 6574 2e0a  logged dataset..
+000121e0: 0a20 2020 2020 2020 204e 6f74 650a 2020  .        Note.  
+000121f0: 2020 2020 2020 2d2d 2d2d 2d2d 2d0a 2020        -------.  
+00012200: 2020 2020 2020 5468 6973 2066 756e 6374        This funct
+00012210: 696f 6e20 6973 2061 7070 6c69 6361 626c  ion is applicabl
+00012220: 6520 6f6e 6c79 2077 6865 6e20 4d75 6c74  e only when Mult
+00012230: 6970 6c65 4c6f 6767 6564 4461 7461 7365  ipleLoggedDatase
+00012240: 7420 6973 2075 7365 642e 0a0a 2020 2020  t is used...    
+00012250: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
+00012260: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0a20         -------. 
+00012270: 2020 2020 2020 2069 6e70 7574 5f64 6963         input_dic
+00012280: 743a 204f 5045 496e 7075 7444 6963 7420  t: OPEInputDict 
+00012290: 6f72 204d 756c 7469 706c 6549 6e70 7574  or MultipleInput
+000122a0: 4469 6374 0a20 2020 2020 2020 2020 2020  Dict.           
+000122b0: 2044 6963 7469 6f6e 6172 7920 6f66 2074   Dictionary of t
+000122c0: 6865 204f 5045 2069 6e70 7574 7320 666f  he OPE inputs fo
+000122d0: 7220 6561 6368 2065 7661 6c75 6174 696f  r each evaluatio
+000122e0: 6e20 706f 6c69 6379 2e0a 0a20 2020 2020  n policy...     
+000122f0: 2020 2020 2020 202e 2e20 636f 6465 2d62         .. code-b
+00012300: 6c6f 636b 3a3a 2070 7974 686f 6e0a 0a20  lock:: python.. 
+00012310: 2020 2020 2020 2020 2020 2020 2020 206b                 k
+00012320: 6579 3a20 5b65 7661 6c75 6174 696f 6e5f  ey: [evaluation_
+00012330: 706f 6c69 6379 5d5b 0a20 2020 2020 2020  policy][.       
+00012340: 2020 2020 2020 2020 2020 2020 2065 7661               eva
+00012350: 6c75 6174 696f 6e5f 706f 6c69 6379 5f61  luation_policy_a
+00012360: 6374 696f 6e2c 0a20 2020 2020 2020 2020  ction,.         
+00012370: 2020 2020 2020 2020 2020 2065 7661 6c75             evalu
+00012380: 6174 696f 6e5f 706f 6c69 6379 5f61 6374  ation_policy_act
+00012390: 696f 6e5f 6469 7374 2c0a 2020 2020 2020  ion_dist,.      
+000123a0: 2020 2020 2020 2020 2020 2020 2020 7374                st
+000123b0: 6174 655f 6163 7469 6f6e 5f76 616c 7565  ate_action_value
+000123c0: 5f70 7265 6469 6374 696f 6e2c 0a20 2020  _prediction,.   
+000123d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000123e0: 2069 6e69 7469 616c 5f73 7461 7465 5f76   initial_state_v
+000123f0: 616c 7565 5f70 7265 6469 6374 696f 6e2c  alue_prediction,
+00012400: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00012410: 2020 2020 2073 7461 7465 5f61 6374 696f       state_actio
+00012420: 6e5f 6d61 7267 696e 616c 5f69 6d70 6f72  n_marginal_impor
+00012430: 7461 6e63 655f 7765 6967 6874 2c0a 2020  tance_weight,.  
+00012440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012450: 2020 7374 6174 655f 6d61 7267 696e 616c    state_marginal
+00012460: 5f69 6d70 6f72 7461 6e63 655f 7765 6967  _importance_weig
+00012470: 6874 2c0a 2020 2020 2020 2020 2020 2020  ht,.            
+00012480: 2020 2020 2020 2020 6f6e 5f70 6f6c 6963          on_polic
+00012490: 795f 706f 6c69 6379 5f76 616c 7565 2c0a  y_policy_value,.
+000124a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000124b0: 2020 2020 6761 6d6d 612c 0a20 2020 2020      gamma,.     
+000124c0: 2020 2020 2020 2020 2020 2020 2020 2062                 b
+000124d0: 6568 6176 696f 725f 706f 6c69 6379 2c0a  ehavior_policy,.
 000124e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000124f0: 2020 6f6e 5f70 6f6c 6963 795f 706f 6c69    on_policy_poli
-00012500: 6379 5f76 616c 7565 2c0a 2020 2020 2020  cy_value,.      
-00012510: 2020 2020 2020 2020 2020 2020 2020 6761                ga
-00012520: 6d6d 612c 0a20 2020 2020 2020 2020 2020  mma,.           
-00012530: 2020 2020 2020 2020 2062 6568 6176 696f           behavio
-00012540: 725f 706f 6c69 6379 2c0a 2020 2020 2020  r_policy,.      
-00012550: 2020 2020 2020 2020 2020 2020 2020 6576                ev
-00012560: 616c 7561 7469 6f6e 5f70 6f6c 6963 792c  aluation_policy,
-00012570: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00012580: 2020 2020 2064 6174 6173 6574 5f69 642c       dataset_id,
-00012590: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000125a0: 205d 0a0a 2020 2020 2020 2020 2020 2020   ]..            
-000125b0: 2e2e 2073 6565 616c 736f 3a3a 0a0a 2020  .. seealso::..  
-000125c0: 2020 2020 2020 2020 2020 2020 2020 3a63                :c
-000125d0: 6c61 7373 3a60 7363 6f70 655f 726c 2e6f  lass:`scope_rl.o
-000125e0: 7065 2e69 6e70 7574 2e43 7265 6174 654f  pe.input.CreateO
-000125f0: 5045 496e 7075 7460 2064 6573 6372 6962  PEInput` describ
-00012600: 6573 2074 6865 2063 6f6d 706f 6e65 6e74  es the component
-00012610: 7320 6f66 203a 636c 6173 733a 6069 6e70  s of :class:`inp
-00012620: 7574 5f64 6963 7460 2e0a 0a20 2020 2020  ut_dict`...     
-00012630: 2020 2063 6f6d 7061 7265 645f 6573 7469     compared_esti
-00012640: 6d61 746f 7273 3a20 6c69 7374 206f 6620  mators: list of 
-00012650: 7374 722c 2064 6566 6175 6c74 3d4e 6f6e  str, default=Non
-00012660: 650a 2020 2020 2020 2020 2020 2020 4e61  e.            Na
-00012670: 6d65 206f 6620 636f 6d70 6172 6564 2065  me of compared e
-00012680: 7374 696d 6174 6f72 732e 0a20 2020 2020  stimators..     
-00012690: 2020 2020 2020 2049 6620 604e 6f6e 6560         If `None`
-000126a0: 2069 7320 6769 7665 6e2c 2061 6c6c 2074   is given, all t
-000126b0: 6865 2065 7374 696d 6174 6f72 7320 6172  he estimators ar
-000126c0: 6520 636f 6d70 6172 6564 2e0a 0a20 2020  e compared...   
-000126d0: 2020 2020 2062 6568 6176 696f 725f 706f       behavior_po
-000126e0: 6c69 6379 5f6e 616d 653a 2073 7472 2c20  licy_name: str, 
-000126f0: 6465 6661 756c 743d 4e6f 6e65 0a20 2020  default=None.   
-00012700: 2020 2020 2020 2020 204e 616d 6520 6f66           Name of
-00012710: 2074 6865 2062 6568 6176 696f 7220 706f   the behavior po
-00012720: 6c69 6379 2e0a 0a20 2020 2020 2020 2070  licy...        p
-00012730: 6c6f 745f 7479 7065 3a20 7b22 6369 222c  lot_type: {"ci",
-00012740: 2022 7363 6174 7465 7222 2c20 2276 696f   "scatter", "vio
-00012750: 6c69 6e22 7d2c 2064 6566 6175 6c74 3d22  lin"}, default="
-00012760: 6369 220a 2020 2020 2020 2020 2020 2020  ci".            
-00012770: 5479 7065 206f 6620 706c 6f74 2e0a 2020  Type of plot..  
-00012780: 2020 2020 2020 2020 2020 4966 2022 6369            If "ci
-00012790: 2220 6973 2067 6976 656e 2c20 7765 2067  " is given, we g
-000127a0: 6574 2074 6865 2065 6d70 6972 6963 616c  et the empirical
-000127b0: 2061 7665 7261 6765 206f 6620 7468 6520   average of the 
-000127c0: 6573 7469 6d61 7465 6420 7661 6c75 6573  estimated values
-000127d0: 2077 6974 6820 7468 6569 7220 6573 7469   with their esti
-000127e0: 6d61 7465 6420 636f 6e66 6964 656e 6365  mated confidence
-000127f0: 2069 6e74 6572 7661 6c73 2e0a 2020 2020   intervals..    
-00012800: 2020 2020 2020 2020 4966 2022 7363 6174          If "scat
-00012810: 7465 7222 2069 7320 6769 7665 6e2c 2077  ter" is given, w
-00012820: 6520 6765 7420 6120 7363 6174 7465 7220  e get a scatter 
-00012830: 706c 6f74 206f 6620 6573 7469 6d61 7465  plot of estimate
-00012840: 6420 7661 6c75 6573 2e0a 0a20 2020 2020  d values...     
-00012850: 2020 2068 7565 3a20 7b22 6573 7469 6d61     hue: {"estima
-00012860: 746f 7222 2c20 2270 6f6c 6963 7922 7d2c  tor", "policy"},
-00012870: 2064 6566 6175 6c74 3d22 6573 7469 6d61   default="estima
-00012880: 746f 7222 0a20 2020 2020 2020 2020 2020  tor".           
-00012890: 2048 7565 206f 6620 7468 6520 706c 6f74   Hue of the plot
-000128a0: 2e0a 0a20 2020 2020 2020 206c 6567 656e  ...        legen
-000128b0: 643a 2062 6f6f 6c2c 2064 6566 6175 6c74  d: bool, default
-000128c0: 3d54 7275 650a 2020 2020 2020 2020 2020  =True.          
-000128d0: 2020 5768 6574 6865 7220 746f 2069 6e63    Whether to inc
-000128e0: 6c75 6465 2061 206c 6567 656e 6420 696e  lude a legend in
-000128f0: 2074 6865 2073 6361 7474 6572 2070 6c6f   the scatter plo
-00012900: 742e 0a0a 2020 2020 2020 2020 7368 6172  t...        shar
-00012910: 6579 3a20 626f 6f6c 2c20 6465 6661 756c  ey: bool, defaul
-00012920: 743d 4661 6c73 650a 2020 2020 2020 2020  t=False.        
-00012930: 2020 2020 4966 2060 5472 7565 602c 2074      If `True`, t
-00012940: 6865 2079 2d61 7869 7320 7769 6c6c 2062  he y-axis will b
-00012950: 6520 7368 6172 6564 2061 6d6f 6e67 2064  e shared among d
-00012960: 6966 6665 7265 6e74 2065 7374 696d 6174  ifferent estimat
-00012970: 6f72 7320 6f72 2065 7661 6c75 6174 696f  ors or evaluatio
-00012980: 6e20 706f 6c69 6369 6573 2e0a 0a20 2020  n policies...   
-00012990: 2020 2020 2066 6967 5f64 6972 3a20 5061       fig_dir: Pa
-000129a0: 7468 2c20 6465 6661 756c 743d 4e6f 6e65  th, default=None
-000129b0: 0a20 2020 2020 2020 2020 2020 2050 6174  .            Pat
-000129c0: 6820 746f 2073 746f 7265 2074 6865 2062  h to store the b
-000129d0: 6172 2066 6967 7572 652e 0a20 2020 2020  ar figure..     
-000129e0: 2020 2020 2020 2049 6620 604e 6f6e 6560         If `None`
-000129f0: 2069 7320 6769 7665 6e2c 2074 6865 2066   is given, the f
-00012a00: 6967 7572 6520 7769 6c6c 206e 6f74 2062  igure will not b
-00012a10: 6520 7361 7665 642e 0a0a 2020 2020 2020  e saved...      
-00012a20: 2020 6669 675f 6e61 6d65 3a20 7374 722c    fig_name: str,
-00012a30: 2064 6566 6175 6c74 3d22 6573 7469 6d61   default="estima
-00012a40: 7465 645f 706f 6c69 6379 5f76 616c 7565  ted_policy_value
-00012a50: 5f6d 756c 7469 706c 652e 706e 6722 0a20  _multiple.png". 
-00012a60: 2020 2020 2020 2020 2020 204e 616d 6520             Name 
-00012a70: 6f66 2074 6865 2062 6172 2066 6967 7572  of the bar figur
-00012a80: 652e 0a0a 2020 2020 2020 2020 2222 220a  e...        """.
-00012a90: 2020 2020 2020 2020 636f 6d70 6172 6564          compared
-00012aa0: 5f65 7374 696d 6174 6f72 7320 3d20 7365  _estimators = se
-00012ab0: 6c66 2e5f 6368 6563 6b5f 636f 6d70 6172  lf._check_compar
-00012ac0: 6564 5f65 7374 696d 6174 6f72 7328 636f  ed_estimators(co
-00012ad0: 6d70 6172 6564 5f65 7374 696d 6174 6f72  mpared_estimator
-00012ae0: 7329 0a20 2020 2020 2020 2073 656c 662e  s).        self.
-00012af0: 5f63 6865 636b 5f62 6173 6963 5f76 6973  _check_basic_vis
-00012b00: 7561 6c69 7a61 7469 6f6e 5f69 6e70 7574  ualization_input
-00012b10: 7328 0a20 2020 2020 2020 2020 2020 2068  s(.            h
-00012b20: 7565 3d68 7565 2c20 6669 675f 6469 723d  ue=hue, fig_dir=
-00012b30: 6669 675f 6469 722c 2066 6967 5f6e 616d  fig_dir, fig_nam
-00012b40: 653d 6669 675f 6e61 6d65 0a20 2020 2020  e=fig_name.     
-00012b50: 2020 2029 0a0a 2020 2020 2020 2020 6966     )..        if
-00012b60: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
-00012b70: 696e 7075 745f 6469 6374 2c20 4d75 6c74  input_dict, Mult
-00012b80: 6970 6c65 496e 7075 7444 6963 7429 3a0a  ipleInputDict):.
-00012b90: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00012ba0: 6520 5661 6c75 6545 7272 6f72 2822 696e  e ValueError("in
-00012bb0: 7075 745f 6469 6374 206d 7573 7420 6265  put_dict must be
-00012bc0: 2061 6e20 696e 7374 616e 6365 206f 6620   an instance of 
-00012bd0: 4d75 6c74 6970 6c65 496e 7075 7444 6963  MultipleInputDic
-00012be0: 742e 2229 0a20 2020 2020 2020 2023 2069  t.").        # i
-00012bf0: 6620 280a 2020 2020 2020 2020 2320 2020  f (.        #   
-00012c00: 2020 6e6f 7420 7365 6c66 2e75 7365 5f6d    not self.use_m
-00012c10: 756c 7469 706c 655f 6c6f 6767 6564 5f64  ultiple_logged_d
-00012c20: 6174 6173 6574 0a20 2020 2020 2020 2023  ataset.        #
-00012c30: 2020 2020 206f 7220 6e6f 7420 696e 7075       or not inpu
-00012c40: 745f 6469 6374 2e75 7365 5f73 616d 655f  t_dict.use_same_
-00012c50: 6576 616c 5f70 6f6c 6963 795f 6163 726f  eval_policy_acro
-00012c60: 7373 5f64 6174 6173 6574 0a20 2020 2020  ss_dataset.     
-00012c70: 2020 2023 2029 3a0a 2020 2020 2020 2020     # ):.        
-00012c80: 2320 2020 2020 7261 6973 6520 5275 6e74  #     raise Runt
-00012c90: 696d 6545 7272 6f72 280a 2020 2020 2020  imeError(.      
-00012ca0: 2020 2320 2020 2020 2020 2020 2254 6869    #         "Thi
-00012cb0: 7320 6675 6e63 7469 6f6e 2069 7320 6170  s function is ap
-00012cc0: 706c 6963 6162 6c65 206f 6e6c 7920 7768  plicable only wh
-00012cd0: 656e 204d 756c 7469 706c 654c 6f67 6765  en MultipleLogge
-00012ce0: 6444 6174 6173 6574 2069 7320 7573 6564  dDataset is used
-00012cf0: 2022 0a20 2020 2020 2020 2023 2020 2020   ".        #    
-00012d00: 2020 2020 2022 616e 6420 4d75 6c74 6970       "and Multip
-00012d10: 6c65 496e 7075 7444 6963 7420 6973 2063  leInputDict is c
-00012d20: 6f6c 6c65 6374 6564 2062 7920 7468 6520  ollected by the 
-00012d30: 7361 6d65 2065 7661 6c75 6174 696f 6e20  same evaluation 
-00012d40: 706f 6c69 6379 2061 6372 6f73 7320 6c6f  policy across lo
-00012d50: 6767 6564 2064 6174 6173 6574 732c 2022  gged datasets, "
-00012d60: 0a20 2020 2020 2020 2023 2020 2020 2020  .        #      
-00012d70: 2020 2022 6275 7420 666f 756e 6420 4661     "but found Fa
-00012d80: 6c73 652e 220a 2020 2020 2020 2020 2320  lse.".        # 
-00012d90: 2020 2020 290a 2020 2020 2020 2020 2320      ).        # 
-00012da0: 6966 206c 656e 2873 656c 662e 6d75 6c74  if len(self.mult
-00012db0: 6970 6c65 5f6c 6f67 6765 645f 6461 7461  iple_logged_data
-00012dc0: 7365 7429 2021 3d20 6c65 6e28 696e 7075  set) != len(inpu
-00012dd0: 745f 6469 6374 293a 0a20 2020 2020 2020  t_dict):.       
-00012de0: 2023 2020 2020 2072 6169 7365 2056 616c   #     raise Val
-00012df0: 7565 4572 726f 7228 0a20 2020 2020 2020  ueError(.       
-00012e00: 2023 2020 2020 2020 2020 2022 4578 7065   #         "Expe
-00012e10: 6374 6564 2060 6c65 6e28 696e 7075 745f  cted `len(input_
-00012e20: 6469 6374 2920 3d3d 206c 656e 2873 656c  dict) == len(sel
-00012e30: 662e 6d75 6c74 6970 6c65 5f6c 6f67 6765  f.multiple_logge
-00012e40: 645f 6461 7461 7365 7429 602c 2062 7574  d_dataset)`, but
-00012e50: 2066 6f75 6e64 2046 616c 7365 2e22 0a20   found False.". 
-00012e60: 2020 2020 2020 2023 2020 2020 2029 0a0a         #     )..
-00012e70: 2020 2020 2020 2020 706f 6c69 6379 5f76          policy_v
-00012e80: 616c 7565 5f64 6963 745f 203d 2073 656c  alue_dict_ = sel
-00012e90: 662e 6573 7469 6d61 7465 5f70 6f6c 6963  f.estimate_polic
-00012ea0: 795f 7661 6c75 6528 0a20 2020 2020 2020  y_value(.       
-00012eb0: 2020 2020 2069 6e70 7574 5f64 6963 743d       input_dict=
-00012ec0: 696e 7075 745f 6469 6374 2c0a 2020 2020  input_dict,.    
-00012ed0: 2020 2020 2020 2020 636f 6d70 6172 6564          compared
-00012ee0: 5f65 7374 696d 6174 6f72 733d 636f 6d70  _estimators=comp
-00012ef0: 6172 6564 5f65 7374 696d 6174 6f72 732c  ared_estimators,
-00012f00: 0a20 2020 2020 2020 2020 2020 2062 6568  .            beh
-00012f10: 6176 696f 725f 706f 6c69 6379 5f6e 616d  avior_policy_nam
-00012f20: 653d 6265 6861 7669 6f72 5f70 6f6c 6963  e=behavior_polic
-00012f30: 795f 6e61 6d65 2c0a 2020 2020 2020 2020  y_name,.        
-00012f40: 290a 0a20 2020 2020 2020 2069 6620 6c65  )..        if le
-00012f50: 6e28 696e 7075 745f 6469 6374 2e62 6568  n(input_dict.beh
-00012f60: 6176 696f 725f 706f 6c69 6379 5f6e 616d  avior_policy_nam
-00012f70: 6573 2920 3d3d 2031 3a0a 2020 2020 2020  es) == 1:.      
-00012f80: 2020 2020 2020 6265 6861 7669 6f72 5f70        behavior_p
-00012f90: 6f6c 6963 795f 6e61 6d65 203d 2069 6e70  olicy_name = inp
-00012fa0: 7574 5f64 6963 742e 6265 6861 7669 6f72  ut_dict.behavior
-00012fb0: 5f70 6f6c 6963 795f 6e61 6d65 735b 305d  _policy_names[0]
-00012fc0: 0a0a 2020 2020 2020 2020 6966 2062 6568  ..        if beh
-00012fd0: 6176 696f 725f 706f 6c69 6379 5f6e 616d  avior_policy_nam
-00012fe0: 6520 6973 204e 6f6e 653a 0a20 2020 2020  e is None:.     
-00012ff0: 2020 2020 2020 2070 6f6c 6963 795f 7661         policy_va
-00013000: 6c75 655f 6469 6374 203d 2064 6566 6175  lue_dict = defau
-00013010: 6c74 6469 6374 286c 616d 6264 613a 2064  ltdict(lambda: d
-00013020: 6566 6175 6c74 6469 6374 2864 6963 7429  efaultdict(dict)
-00013030: 290a 0a20 2020 2020 2020 2020 2020 2066  )..            f
-00013040: 6f72 2062 6568 6176 696f 725f 706f 6c69  or behavior_poli
-00013050: 6379 2069 6e20 696e 7075 745f 6469 6374  cy in input_dict
-00013060: 2e62 6568 6176 696f 725f 706f 6c69 6379  .behavior_policy
-00013070: 5f6e 616d 6573 3a0a 2020 2020 2020 2020  _names:.        
-00013080: 2020 2020 2020 2020 696e 7075 745f 6469          input_di
-00013090: 6374 5f30 203d 2069 6e70 7574 5f64 6963  ct_0 = input_dic
-000130a0: 742e 6765 7428 0a20 2020 2020 2020 2020  t.get(.         
-000130b0: 2020 2020 2020 2020 2020 2062 6568 6176             behav
-000130c0: 696f 725f 706f 6c69 6379 5f6e 616d 653d  ior_policy_name=
-000130d0: 6265 6861 7669 6f72 5f70 6f6c 6963 792c  behavior_policy,
-000130e0: 2064 6174 6173 6574 5f69 643d 300a 2020   dataset_id=0.  
-000130f0: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-00013100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013110: 6e5f 6461 7461 7365 7473 203d 2069 6e70  n_datasets = inp
-00013120: 7574 5f64 6963 742e 6e5f 6461 7461 7365  ut_dict.n_datase
-00013130: 7473 5b62 6568 6176 696f 725f 706f 6c69  ts[behavior_poli
-00013140: 6379 5d0a 0a20 2020 2020 2020 2020 2020  cy]..           
-00013150: 2020 2020 2066 6f72 2065 7661 6c5f 706f       for eval_po
-00013160: 6c69 6379 2069 6e20 696e 7075 745f 6469  licy in input_di
-00013170: 6374 5f30 2e6b 6579 7328 293a 0a20 2020  ct_0.keys():.   
-00013180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013190: 2066 6f72 2065 7374 696d 6174 6f72 2069   for estimator i
-000131a0: 6e20 636f 6d70 6172 6564 5f65 7374 696d  n compared_estim
-000131b0: 6174 6f72 733a 0a20 2020 2020 2020 2020  ators:.         
-000131c0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-000131d0: 6f6c 6963 795f 7661 6c75 6520 3d20 6e70  olicy_value = np
-000131e0: 2e7a 6572 6f73 2828 6e5f 6461 7461 7365  .zeros((n_datase
-000131f0: 7473 2c29 290a 2020 2020 2020 2020 2020  ts,)).          
-00013200: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-00013210: 7220 6461 7461 7365 745f 6964 5f20 696e  r dataset_id_ in
-00013220: 2072 616e 6765 286e 5f64 6174 6173 6574   range(n_dataset
-00013230: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
-00013240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013250: 706f 6c69 6379 5f76 616c 7565 5b64 6174  policy_value[dat
-00013260: 6173 6574 5f69 645f 5d20 3d20 706f 6c69  aset_id_] = poli
-00013270: 6379 5f76 616c 7565 5f64 6963 745f 5b0a  cy_value_dict_[.
-00013280: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000124f0: 2020 2020 6576 616c 7561 7469 6f6e 5f70      evaluation_p
+00012500: 6f6c 6963 792c 0a20 2020 2020 2020 2020  olicy,.         
+00012510: 2020 2020 2020 2020 2020 2064 6174 6173             datas
+00012520: 6574 5f69 642c 0a20 2020 2020 2020 2020  et_id,.         
+00012530: 2020 2020 2020 205d 0a0a 2020 2020 2020         ]..      
+00012540: 2020 2020 2020 2e2e 2073 6565 616c 736f        .. seealso
+00012550: 3a3a 0a0a 2020 2020 2020 2020 2020 2020  ::..            
+00012560: 2020 2020 3a63 6c61 7373 3a60 7363 6f70      :class:`scop
+00012570: 655f 726c 2e6f 7065 2e69 6e70 7574 2e43  e_rl.ope.input.C
+00012580: 7265 6174 654f 5045 496e 7075 7460 2064  reateOPEInput` d
+00012590: 6573 6372 6962 6573 2074 6865 2063 6f6d  escribes the com
+000125a0: 706f 6e65 6e74 7320 6f66 203a 636c 6173  ponents of :clas
+000125b0: 733a 6069 6e70 7574 5f64 6963 7460 2e0a  s:`input_dict`..
+000125c0: 0a20 2020 2020 2020 2063 6f6d 7061 7265  .        compare
+000125d0: 645f 6573 7469 6d61 746f 7273 3a20 6c69  d_estimators: li
+000125e0: 7374 206f 6620 7374 722c 2064 6566 6175  st of str, defau
+000125f0: 6c74 3d4e 6f6e 650a 2020 2020 2020 2020  lt=None.        
+00012600: 2020 2020 4e61 6d65 206f 6620 636f 6d70      Name of comp
+00012610: 6172 6564 2065 7374 696d 6174 6f72 732e  ared estimators.
+00012620: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
+00012630: 604e 6f6e 6560 2069 7320 6769 7665 6e2c  `None` is given,
+00012640: 2061 6c6c 2074 6865 2065 7374 696d 6174   all the estimat
+00012650: 6f72 7320 6172 6520 636f 6d70 6172 6564  ors are compared
+00012660: 2e0a 0a20 2020 2020 2020 2062 6568 6176  ...        behav
+00012670: 696f 725f 706f 6c69 6379 5f6e 616d 653a  ior_policy_name:
+00012680: 2073 7472 2c20 6465 6661 756c 743d 4e6f   str, default=No
+00012690: 6e65 0a20 2020 2020 2020 2020 2020 204e  ne.            N
+000126a0: 616d 6520 6f66 2074 6865 2062 6568 6176  ame of the behav
+000126b0: 696f 7220 706f 6c69 6379 2e0a 0a20 2020  ior policy...   
+000126c0: 2020 2020 2070 6c6f 745f 7479 7065 3a20       plot_type: 
+000126d0: 7b22 6369 222c 2022 7363 6174 7465 7222  {"ci", "scatter"
+000126e0: 2c20 2276 696f 6c69 6e22 7d2c 2064 6566  , "violin"}, def
+000126f0: 6175 6c74 3d22 6369 220a 2020 2020 2020  ault="ci".      
+00012700: 2020 2020 2020 5479 7065 206f 6620 706c        Type of pl
+00012710: 6f74 2e0a 2020 2020 2020 2020 2020 2020  ot..            
+00012720: 4966 2022 6369 2220 6973 2067 6976 656e  If "ci" is given
+00012730: 2c20 7765 2067 6574 2074 6865 2065 6d70  , we get the emp
+00012740: 6972 6963 616c 2061 7665 7261 6765 206f  irical average o
+00012750: 6620 7468 6520 6573 7469 6d61 7465 6420  f the estimated 
+00012760: 7661 6c75 6573 2077 6974 6820 7468 6569  values with thei
+00012770: 7220 6573 7469 6d61 7465 6420 636f 6e66  r estimated conf
+00012780: 6964 656e 6365 2069 6e74 6572 7661 6c73  idence intervals
+00012790: 2e0a 2020 2020 2020 2020 2020 2020 4966  ..            If
+000127a0: 2022 7363 6174 7465 7222 2069 7320 6769   "scatter" is gi
+000127b0: 7665 6e2c 2077 6520 6765 7420 6120 7363  ven, we get a sc
+000127c0: 6174 7465 7220 706c 6f74 206f 6620 6573  atter plot of es
+000127d0: 7469 6d61 7465 6420 7661 6c75 6573 2e0a  timated values..
+000127e0: 0a20 2020 2020 2020 2068 7565 3a20 7b22  .        hue: {"
+000127f0: 6573 7469 6d61 746f 7222 2c20 2270 6f6c  estimator", "pol
+00012800: 6963 7922 7d2c 2064 6566 6175 6c74 3d22  icy"}, default="
+00012810: 6573 7469 6d61 746f 7222 0a20 2020 2020  estimator".     
+00012820: 2020 2020 2020 2048 7565 206f 6620 7468         Hue of th
+00012830: 6520 706c 6f74 2e0a 0a20 2020 2020 2020  e plot...       
+00012840: 206c 6567 656e 643a 2062 6f6f 6c2c 2064   legend: bool, d
+00012850: 6566 6175 6c74 3d54 7275 650a 2020 2020  efault=True.    
+00012860: 2020 2020 2020 2020 5768 6574 6865 7220          Whether 
+00012870: 746f 2069 6e63 6c75 6465 2061 206c 6567  to include a leg
+00012880: 656e 6420 696e 2074 6865 2073 6361 7474  end in the scatt
+00012890: 6572 2070 6c6f 742e 0a0a 2020 2020 2020  er plot...      
+000128a0: 2020 7368 6172 6579 3a20 626f 6f6c 2c20    sharey: bool, 
+000128b0: 6465 6661 756c 743d 4661 6c73 650a 2020  default=False.  
+000128c0: 2020 2020 2020 2020 2020 4966 2060 5472            If `Tr
+000128d0: 7565 602c 2074 6865 2079 2d61 7869 7320  ue`, the y-axis 
+000128e0: 7769 6c6c 2062 6520 7368 6172 6564 2061  will be shared a
+000128f0: 6d6f 6e67 2064 6966 6665 7265 6e74 2065  mong different e
+00012900: 7374 696d 6174 6f72 7320 6f72 2065 7661  stimators or eva
+00012910: 6c75 6174 696f 6e20 706f 6c69 6369 6573  luation policies
+00012920: 2e0a 0a20 2020 2020 2020 2066 6967 5f64  ...        fig_d
+00012930: 6972 3a20 5061 7468 2c20 6465 6661 756c  ir: Path, defaul
+00012940: 743d 4e6f 6e65 0a20 2020 2020 2020 2020  t=None.         
+00012950: 2020 2050 6174 6820 746f 2073 746f 7265     Path to store
+00012960: 2074 6865 2062 6172 2066 6967 7572 652e   the bar figure.
+00012970: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
+00012980: 604e 6f6e 6560 2069 7320 6769 7665 6e2c  `None` is given,
+00012990: 2074 6865 2066 6967 7572 6520 7769 6c6c   the figure will
+000129a0: 206e 6f74 2062 6520 7361 7665 642e 0a0a   not be saved...
+000129b0: 2020 2020 2020 2020 6669 675f 6e61 6d65          fig_name
+000129c0: 3a20 7374 722c 2064 6566 6175 6c74 3d22  : str, default="
+000129d0: 6573 7469 6d61 7465 645f 706f 6c69 6379  estimated_policy
+000129e0: 5f76 616c 7565 5f6d 756c 7469 706c 652e  _value_multiple.
+000129f0: 706e 6722 0a20 2020 2020 2020 2020 2020  png".           
+00012a00: 204e 616d 6520 6f66 2074 6865 2062 6172   Name of the bar
+00012a10: 2066 6967 7572 652e 0a0a 2020 2020 2020   figure...      
+00012a20: 2020 2222 220a 2020 2020 2020 2020 636f    """.        co
+00012a30: 6d70 6172 6564 5f65 7374 696d 6174 6f72  mpared_estimator
+00012a40: 7320 3d20 7365 6c66 2e5f 6368 6563 6b5f  s = self._check_
+00012a50: 636f 6d70 6172 6564 5f65 7374 696d 6174  compared_estimat
+00012a60: 6f72 7328 636f 6d70 6172 6564 5f65 7374  ors(compared_est
+00012a70: 696d 6174 6f72 7329 0a20 2020 2020 2020  imators).       
+00012a80: 2073 656c 662e 5f63 6865 636b 5f62 6173   self._check_bas
+00012a90: 6963 5f76 6973 7561 6c69 7a61 7469 6f6e  ic_visualization
+00012aa0: 5f69 6e70 7574 7328 0a20 2020 2020 2020  _inputs(.       
+00012ab0: 2020 2020 2068 7565 3d68 7565 2c20 6669       hue=hue, fi
+00012ac0: 675f 6469 723d 6669 675f 6469 722c 2066  g_dir=fig_dir, f
+00012ad0: 6967 5f6e 616d 653d 6669 675f 6e61 6d65  ig_name=fig_name
+00012ae0: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+00012af0: 2020 2020 6966 206e 6f74 2069 7369 6e73      if not isins
+00012b00: 7461 6e63 6528 696e 7075 745f 6469 6374  tance(input_dict
+00012b10: 2c20 4d75 6c74 6970 6c65 496e 7075 7444  , MultipleInputD
+00012b20: 6963 7429 3a0a 2020 2020 2020 2020 2020  ict):.          
+00012b30: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+00012b40: 6f72 2822 696e 7075 745f 6469 6374 206d  or("input_dict m
+00012b50: 7573 7420 6265 2061 6e20 696e 7374 616e  ust be an instan
+00012b60: 6365 206f 6620 4d75 6c74 6970 6c65 496e  ce of MultipleIn
+00012b70: 7075 7444 6963 742e 2229 0a20 2020 2020  putDict.").     
+00012b80: 2020 2023 2069 6620 280a 2020 2020 2020     # if (.      
+00012b90: 2020 2320 2020 2020 6e6f 7420 7365 6c66    #     not self
+00012ba0: 2e75 7365 5f6d 756c 7469 706c 655f 6c6f  .use_multiple_lo
+00012bb0: 6767 6564 5f64 6174 6173 6574 0a20 2020  gged_dataset.   
+00012bc0: 2020 2020 2023 2020 2020 206f 7220 6e6f       #     or no
+00012bd0: 7420 696e 7075 745f 6469 6374 2e75 7365  t input_dict.use
+00012be0: 5f73 616d 655f 6576 616c 5f70 6f6c 6963  _same_eval_polic
+00012bf0: 795f 6163 726f 7373 5f64 6174 6173 6574  y_across_dataset
+00012c00: 0a20 2020 2020 2020 2023 2029 3a0a 2020  .        # ):.  
+00012c10: 2020 2020 2020 2320 2020 2020 7261 6973        #     rais
+00012c20: 6520 5275 6e74 696d 6545 7272 6f72 280a  e RuntimeError(.
+00012c30: 2020 2020 2020 2020 2320 2020 2020 2020          #       
+00012c40: 2020 2254 6869 7320 6675 6e63 7469 6f6e    "This function
+00012c50: 2069 7320 6170 706c 6963 6162 6c65 206f   is applicable o
+00012c60: 6e6c 7920 7768 656e 204d 756c 7469 706c  nly when Multipl
+00012c70: 654c 6f67 6765 6444 6174 6173 6574 2069  eLoggedDataset i
+00012c80: 7320 7573 6564 2022 0a20 2020 2020 2020  s used ".       
+00012c90: 2023 2020 2020 2020 2020 2022 616e 6420   #         "and 
+00012ca0: 4d75 6c74 6970 6c65 496e 7075 7444 6963  MultipleInputDic
+00012cb0: 7420 6973 2063 6f6c 6c65 6374 6564 2062  t is collected b
+00012cc0: 7920 7468 6520 7361 6d65 2065 7661 6c75  y the same evalu
+00012cd0: 6174 696f 6e20 706f 6c69 6379 2061 6372  ation policy acr
+00012ce0: 6f73 7320 6c6f 6767 6564 2064 6174 6173  oss logged datas
+00012cf0: 6574 732c 2022 0a20 2020 2020 2020 2023  ets, ".        #
+00012d00: 2020 2020 2020 2020 2022 6275 7420 666f           "but fo
+00012d10: 756e 6420 4661 6c73 652e 220a 2020 2020  und False.".    
+00012d20: 2020 2020 2320 2020 2020 290a 2020 2020      #     ).    
+00012d30: 2020 2020 2320 6966 206c 656e 2873 656c      # if len(sel
+00012d40: 662e 6d75 6c74 6970 6c65 5f6c 6f67 6765  f.multiple_logge
+00012d50: 645f 6461 7461 7365 7429 2021 3d20 6c65  d_dataset) != le
+00012d60: 6e28 696e 7075 745f 6469 6374 293a 0a20  n(input_dict):. 
+00012d70: 2020 2020 2020 2023 2020 2020 2072 6169         #     rai
+00012d80: 7365 2056 616c 7565 4572 726f 7228 0a20  se ValueError(. 
+00012d90: 2020 2020 2020 2023 2020 2020 2020 2020         #        
+00012da0: 2022 4578 7065 6374 6564 2060 6c65 6e28   "Expected `len(
+00012db0: 696e 7075 745f 6469 6374 2920 3d3d 206c  input_dict) == l
+00012dc0: 656e 2873 656c 662e 6d75 6c74 6970 6c65  en(self.multiple
+00012dd0: 5f6c 6f67 6765 645f 6461 7461 7365 7429  _logged_dataset)
+00012de0: 602c 2062 7574 2066 6f75 6e64 2046 616c  `, but found Fal
+00012df0: 7365 2e22 0a20 2020 2020 2020 2023 2020  se.".        #  
+00012e00: 2020 2029 0a0a 2020 2020 2020 2020 706f     )..        po
+00012e10: 6c69 6379 5f76 616c 7565 5f64 6963 745f  licy_value_dict_
+00012e20: 203d 2073 656c 662e 6573 7469 6d61 7465   = self.estimate
+00012e30: 5f70 6f6c 6963 795f 7661 6c75 6528 0a20  _policy_value(. 
+00012e40: 2020 2020 2020 2020 2020 2069 6e70 7574             input
+00012e50: 5f64 6963 743d 696e 7075 745f 6469 6374  _dict=input_dict
+00012e60: 2c0a 2020 2020 2020 2020 2020 2020 636f  ,.            co
+00012e70: 6d70 6172 6564 5f65 7374 696d 6174 6f72  mpared_estimator
+00012e80: 733d 636f 6d70 6172 6564 5f65 7374 696d  s=compared_estim
+00012e90: 6174 6f72 732c 0a20 2020 2020 2020 2020  ators,.         
+00012ea0: 2020 2062 6568 6176 696f 725f 706f 6c69     behavior_poli
+00012eb0: 6379 5f6e 616d 653d 6265 6861 7669 6f72  cy_name=behavior
+00012ec0: 5f70 6f6c 6963 795f 6e61 6d65 2c0a 2020  _policy_name,.  
+00012ed0: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+00012ee0: 2069 6620 6c65 6e28 696e 7075 745f 6469   if len(input_di
+00012ef0: 6374 2e62 6568 6176 696f 725f 706f 6c69  ct.behavior_poli
+00012f00: 6379 5f6e 616d 6573 2920 3d3d 2031 3a0a  cy_names) == 1:.
+00012f10: 2020 2020 2020 2020 2020 2020 6265 6861              beha
+00012f20: 7669 6f72 5f70 6f6c 6963 795f 6e61 6d65  vior_policy_name
+00012f30: 203d 2069 6e70 7574 5f64 6963 742e 6265   = input_dict.be
+00012f40: 6861 7669 6f72 5f70 6f6c 6963 795f 6e61  havior_policy_na
+00012f50: 6d65 735b 305d 0a0a 2020 2020 2020 2020  mes[0]..        
+00012f60: 6966 2062 6568 6176 696f 725f 706f 6c69  if behavior_poli
+00012f70: 6379 5f6e 616d 6520 6973 204e 6f6e 653a  cy_name is None:
+00012f80: 0a20 2020 2020 2020 2020 2020 2070 6f6c  .            pol
+00012f90: 6963 795f 7661 6c75 655f 6469 6374 203d  icy_value_dict =
+00012fa0: 2064 6566 6175 6c74 6469 6374 286c 616d   defaultdict(lam
+00012fb0: 6264 613a 2064 6566 6175 6c74 6469 6374  bda: defaultdict
+00012fc0: 2864 6963 7429 290a 0a20 2020 2020 2020  (dict))..       
+00012fd0: 2020 2020 2066 6f72 2062 6568 6176 696f       for behavio
+00012fe0: 725f 706f 6c69 6379 2069 6e20 696e 7075  r_policy in inpu
+00012ff0: 745f 6469 6374 2e62 6568 6176 696f 725f  t_dict.behavior_
+00013000: 706f 6c69 6379 5f6e 616d 6573 3a0a 2020  policy_names:.  
+00013010: 2020 2020 2020 2020 2020 2020 2020 696e                in
+00013020: 7075 745f 6469 6374 5f30 203d 2069 6e70  put_dict_0 = inp
+00013030: 7574 5f64 6963 742e 6765 7428 0a20 2020  ut_dict.get(.   
+00013040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013050: 2062 6568 6176 696f 725f 706f 6c69 6379   behavior_policy
+00013060: 5f6e 616d 653d 6265 6861 7669 6f72 5f70  _name=behavior_p
+00013070: 6f6c 6963 792c 2064 6174 6173 6574 5f69  olicy, dataset_i
+00013080: 643d 300a 2020 2020 2020 2020 2020 2020  d=0.            
+00013090: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+000130a0: 2020 2020 2020 6e5f 6461 7461 7365 7473        n_datasets
+000130b0: 203d 2069 6e70 7574 5f64 6963 742e 6e5f   = input_dict.n_
+000130c0: 6461 7461 7365 7473 5b62 6568 6176 696f  datasets[behavio
+000130d0: 725f 706f 6c69 6379 5d0a 0a20 2020 2020  r_policy]..     
+000130e0: 2020 2020 2020 2020 2020 2066 6f72 2065             for e
+000130f0: 7661 6c5f 706f 6c69 6379 2069 6e20 696e  val_policy in in
+00013100: 7075 745f 6469 6374 5f30 2e6b 6579 7328  put_dict_0.keys(
+00013110: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00013120: 2020 2020 2020 2066 6f72 2065 7374 696d         for estim
+00013130: 6174 6f72 2069 6e20 636f 6d70 6172 6564  ator in compared
+00013140: 5f65 7374 696d 6174 6f72 733a 0a20 2020  _estimators:.   
+00013150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013160: 2020 2020 2070 6f6c 6963 795f 7661 6c75       policy_valu
+00013170: 6520 3d20 6e70 2e7a 6572 6f73 2828 6e5f  e = np.zeros((n_
+00013180: 6461 7461 7365 7473 2c29 290a 2020 2020  datasets,)).    
+00013190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000131a0: 2020 2020 666f 7220 6461 7461 7365 745f      for dataset_
+000131b0: 6964 5f20 696e 2072 616e 6765 286e 5f64  id_ in range(n_d
+000131c0: 6174 6173 6574 7329 3a0a 2020 2020 2020  atasets):.      
+000131d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000131e0: 2020 2020 2020 706f 6c69 6379 5f76 616c        policy_val
+000131f0: 7565 5b64 6174 6173 6574 5f69 645f 5d20  ue[dataset_id_] 
+00013200: 3d20 706f 6c69 6379 5f76 616c 7565 5f64  = policy_value_d
+00013210: 6963 745f 5b0a 2020 2020 2020 2020 2020  ict_[.          
+00013220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013230: 2020 2020 2020 6265 6861 7669 6f72 5f70        behavior_p
+00013240: 6f6c 6963 790a 2020 2020 2020 2020 2020  olicy.          
+00013250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013260: 2020 5d5b 6461 7461 7365 745f 6964 5f5d    ][dataset_id_]
+00013270: 5b65 7661 6c5f 706f 6c69 6379 5d5b 6573  [eval_policy][es
+00013280: 7469 6d61 746f 725d 0a0a 2020 2020 2020  timator]..      
 00013290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000132a0: 6265 6861 7669 6f72 5f70 6f6c 6963 790a  behavior_policy.
-000132b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000132c0: 2020 2020 2020 2020 2020 2020 5d5b 6461              ][da
-000132d0: 7461 7365 745f 6964 5f5d 5b65 7661 6c5f  taset_id_][eval_
-000132e0: 706f 6c69 6379 5d5b 6573 7469 6d61 746f  policy][estimato
-000132f0: 725d 0a0a 2020 2020 2020 2020 2020 2020  r]..            
-00013300: 2020 2020 2020 2020 2020 2020 706f 6c69              poli
-00013310: 6379 5f76 616c 7565 5f64 6963 745b 6265  cy_value_dict[be
-00013320: 6861 7669 6f72 5f70 6f6c 6963 795d 5b65  havior_policy][e
-00013330: 7661 6c5f 706f 6c69 6379 5d5b 0a20 2020  val_policy][.   
-00013340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013350: 2020 2020 2020 2020 2065 7374 696d 6174           estimat
-00013360: 6f72 0a20 2020 2020 2020 2020 2020 2020  or.             
-00013370: 2020 2020 2020 2020 2020 205d 203d 2070             ] = p
-00013380: 6f6c 6963 795f 7661 6c75 650a 0a20 2020  olicy_value..   
-00013390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000133a0: 206f 6e5f 706f 6c69 6379 203d 2069 6e70   on_policy = inp
-000133b0: 7574 5f64 6963 745f 305b 6576 616c 5f70  ut_dict_0[eval_p
-000133c0: 6f6c 6963 795d 5b22 6f6e 5f70 6f6c 6963  olicy]["on_polic
-000133d0: 795f 706f 6c69 6379 5f76 616c 7565 225d  y_policy_value"]
-000133e0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000133f0: 2020 2020 2020 6966 206f 6e5f 706f 6c69        if on_poli
-00013400: 6379 2069 7320 6e6f 7420 4e6f 6e65 3a0a  cy is not None:.
-00013410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013420: 2020 2020 2020 2020 706f 6c69 6379 5f76          policy_v
-00013430: 616c 7565 5f64 6963 745b 6265 6861 7669  alue_dict[behavi
-00013440: 6f72 5f70 6f6c 6963 795d 5b65 7661 6c5f  or_policy][eval_
-00013450: 706f 6c69 6379 5d5b 0a20 2020 2020 2020  policy][.       
+000132a0: 2020 706f 6c69 6379 5f76 616c 7565 5f64    policy_value_d
+000132b0: 6963 745b 6265 6861 7669 6f72 5f70 6f6c  ict[behavior_pol
+000132c0: 6963 795d 5b65 7661 6c5f 706f 6c69 6379  icy][eval_policy
+000132d0: 5d5b 0a20 2020 2020 2020 2020 2020 2020  ][.             
+000132e0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+000132f0: 7374 696d 6174 6f72 0a20 2020 2020 2020  stimator.       
+00013300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013310: 205d 203d 2070 6f6c 6963 795f 7661 6c75   ] = policy_valu
+00013320: 650a 0a20 2020 2020 2020 2020 2020 2020  e..             
+00013330: 2020 2020 2020 206f 6e5f 706f 6c69 6379         on_policy
+00013340: 203d 2069 6e70 7574 5f64 6963 745f 305b   = input_dict_0[
+00013350: 6576 616c 5f70 6f6c 6963 795d 5b22 6f6e  eval_policy]["on
+00013360: 5f70 6f6c 6963 795f 706f 6c69 6379 5f76  _policy_policy_v
+00013370: 616c 7565 225d 0a0a 2020 2020 2020 2020  alue"]..        
+00013380: 2020 2020 2020 2020 2020 2020 6966 206f              if o
+00013390: 6e5f 706f 6c69 6379 2069 7320 6e6f 7420  n_policy is not 
+000133a0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+000133b0: 2020 2020 2020 2020 2020 2020 2020 706f                po
+000133c0: 6c69 6379 5f76 616c 7565 5f64 6963 745b  licy_value_dict[
+000133d0: 6265 6861 7669 6f72 5f70 6f6c 6963 795d  behavior_policy]
+000133e0: 5b65 7661 6c5f 706f 6c69 6379 5d5b 0a20  [eval_policy][. 
+000133f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013400: 2020 2020 2020 2020 2020 2022 6f6e 5f70             "on_p
+00013410: 6f6c 6963 7922 0a20 2020 2020 2020 2020  olicy".         
+00013420: 2020 2020 2020 2020 2020 2020 2020 205d                 ]
+00013430: 203d 206f 6e5f 706f 6c69 6379 2e6d 6561   = on_policy.mea
+00013440: 6e28 290a 2020 2020 2020 2020 2020 2020  n().            
+00013450: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
 00013460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013470: 2020 2020 2022 6f6e 5f70 6f6c 6963 7922       "on_policy"
-00013480: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00013490: 2020 2020 2020 2020 205d 203d 206f 6e5f           ] = on_
-000134a0: 706f 6c69 6379 2e6d 6561 6e28 290a 2020  policy.mean().  
+00013470: 2020 2020 2020 706f 6c69 6379 5f76 616c        policy_val
+00013480: 7565 5f64 6963 745b 6265 6861 7669 6f72  ue_dict[behavior
+00013490: 5f70 6f6c 6963 795d 5b65 7661 6c5f 706f  _policy][eval_po
+000134a0: 6c69 6379 5d5b 0a20 2020 2020 2020 2020  licy][.         
 000134b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000134c0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+000134c0: 2020 2022 6f6e 5f70 6f6c 6963 7922 0a20     "on_policy". 
 000134d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000134e0: 706f 6c69 6379 5f76 616c 7565 5f64 6963  policy_value_dic
-000134f0: 745b 6265 6861 7669 6f72 5f70 6f6c 6963  t[behavior_polic
-00013500: 795d 5b65 7661 6c5f 706f 6c69 6379 5d5b  y][eval_policy][
-00013510: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00013520: 2020 2020 2020 2020 2020 2020 2022 6f6e               "on
-00013530: 5f70 6f6c 6963 7922 0a20 2020 2020 2020  _policy".       
-00013540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013550: 205d 203d 204e 6f6e 650a 0a20 2020 2020   ] = None..     
-00013560: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00013570: 2020 2020 2070 6f6c 6963 795f 7661 6c75       policy_valu
-00013580: 655f 6469 6374 203d 2064 6566 6175 6c74  e_dict = default
-00013590: 6469 6374 2864 6963 7429 0a0a 2020 2020  dict(dict)..    
-000135a0: 2020 2020 2020 2020 696e 7075 745f 6469          input_di
-000135b0: 6374 5f30 203d 2069 6e70 7574 5f64 6963  ct_0 = input_dic
-000135c0: 742e 6765 7428 0a20 2020 2020 2020 2020  t.get(.         
-000135d0: 2020 2020 2020 2062 6568 6176 696f 725f         behavior_
-000135e0: 706f 6c69 6379 5f6e 616d 653d 6265 6861  policy_name=beha
-000135f0: 7669 6f72 5f70 6f6c 6963 795f 6e61 6d65  vior_policy_name
-00013600: 2c20 6461 7461 7365 745f 6964 3d30 0a20  , dataset_id=0. 
-00013610: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00013620: 2020 2020 2020 2020 206e 5f64 6174 6173           n_datas
-00013630: 6574 7320 3d20 696e 7075 745f 6469 6374  ets = input_dict
-00013640: 2e6e 5f64 6174 6173 6574 735b 6265 6861  .n_datasets[beha
-00013650: 7669 6f72 5f70 6f6c 6963 795f 6e61 6d65  vior_policy_name
-00013660: 5d0a 0a20 2020 2020 2020 2020 2020 2066  ]..            f
-00013670: 6f72 2065 7661 6c5f 706f 6c69 6379 2069  or eval_policy i
-00013680: 6e20 696e 7075 745f 6469 6374 5f30 2e6b  n input_dict_0.k
-00013690: 6579 7328 293a 0a20 2020 2020 2020 2020  eys():.         
-000136a0: 2020 2020 2020 2066 6f72 2065 7374 696d         for estim
-000136b0: 6174 6f72 2069 6e20 636f 6d70 6172 6564  ator in compared
-000136c0: 5f65 7374 696d 6174 6f72 733a 0a20 2020  _estimators:.   
-000136d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000136e0: 2070 6f6c 6963 795f 7661 6c75 6520 3d20   policy_value = 
-000136f0: 6e70 2e7a 6572 6f73 2828 6e5f 6461 7461  np.zeros((n_data
-00013700: 7365 7473 2c29 290a 2020 2020 2020 2020  sets,)).        
-00013710: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00013720: 6461 7461 7365 745f 6964 5f20 696e 2072  dataset_id_ in r
-00013730: 616e 6765 286e 5f64 6174 6173 6574 7329  ange(n_datasets)
-00013740: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00013750: 2020 2020 2020 2020 2020 706f 6c69 6379            policy
-00013760: 5f76 616c 7565 5b64 6174 6173 6574 5f69  _value[dataset_i
-00013770: 645f 5d20 3d20 706f 6c69 6379 5f76 616c  d_] = policy_val
-00013780: 7565 5f64 6963 745f 5b64 6174 6173 6574  ue_dict_[dataset
-00013790: 5f69 645f 5d5b 0a20 2020 2020 2020 2020  _id_][.         
-000137a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000137b0: 2020 2065 7661 6c5f 706f 6c69 6379 0a20     eval_policy. 
-000137c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000137d0: 2020 2020 2020 205d 5b65 7374 696d 6174         ][estimat
-000137e0: 6f72 5d0a 0a20 2020 2020 2020 2020 2020  or]..           
-000137f0: 2020 2020 2020 2020 2070 6f6c 6963 795f           policy_
-00013800: 7661 6c75 655f 6469 6374 5b65 7661 6c5f  value_dict[eval_
-00013810: 706f 6c69 6379 5d5b 6573 7469 6d61 746f  policy][estimato
-00013820: 725d 203d 2070 6f6c 6963 795f 7661 6c75  r] = policy_valu
-00013830: 650a 0a20 2020 2020 2020 2020 2020 2020  e..             
-00013840: 2020 206f 6e5f 706f 6c69 6379 203d 2069     on_policy = i
-00013850: 6e70 7574 5f64 6963 745f 305b 6576 616c  nput_dict_0[eval
-00013860: 5f70 6f6c 6963 795d 5b22 6f6e 5f70 6f6c  _policy]["on_pol
-00013870: 6963 795f 706f 6c69 6379 5f76 616c 7565  icy_policy_value
-00013880: 225d 0a0a 2020 2020 2020 2020 2020 2020  "]..            
-00013890: 2020 2020 6966 206f 6e5f 706f 6c69 6379      if on_policy
-000138a0: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
+000134e0: 2020 2020 2020 205d 203d 204e 6f6e 650a         ] = None.
+000134f0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+00013500: 2020 2020 2020 2020 2020 2070 6f6c 6963             polic
+00013510: 795f 7661 6c75 655f 6469 6374 203d 2064  y_value_dict = d
+00013520: 6566 6175 6c74 6469 6374 2864 6963 7429  efaultdict(dict)
+00013530: 0a0a 2020 2020 2020 2020 2020 2020 696e  ..            in
+00013540: 7075 745f 6469 6374 5f30 203d 2069 6e70  put_dict_0 = inp
+00013550: 7574 5f64 6963 742e 6765 7428 0a20 2020  ut_dict.get(.   
+00013560: 2020 2020 2020 2020 2020 2020 2062 6568               beh
+00013570: 6176 696f 725f 706f 6c69 6379 5f6e 616d  avior_policy_nam
+00013580: 653d 6265 6861 7669 6f72 5f70 6f6c 6963  e=behavior_polic
+00013590: 795f 6e61 6d65 2c20 6461 7461 7365 745f  y_name, dataset_
+000135a0: 6964 3d30 0a20 2020 2020 2020 2020 2020  id=0.           
+000135b0: 2029 0a20 2020 2020 2020 2020 2020 206e   ).            n
+000135c0: 5f64 6174 6173 6574 7320 3d20 696e 7075  _datasets = inpu
+000135d0: 745f 6469 6374 2e6e 5f64 6174 6173 6574  t_dict.n_dataset
+000135e0: 735b 6265 6861 7669 6f72 5f70 6f6c 6963  s[behavior_polic
+000135f0: 795f 6e61 6d65 5d0a 0a20 2020 2020 2020  y_name]..       
+00013600: 2020 2020 2066 6f72 2065 7661 6c5f 706f       for eval_po
+00013610: 6c69 6379 2069 6e20 696e 7075 745f 6469  licy in input_di
+00013620: 6374 5f30 2e6b 6579 7328 293a 0a20 2020  ct_0.keys():.   
+00013630: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+00013640: 2065 7374 696d 6174 6f72 2069 6e20 636f   estimator in co
+00013650: 6d70 6172 6564 5f65 7374 696d 6174 6f72  mpared_estimator
+00013660: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
+00013670: 2020 2020 2020 2070 6f6c 6963 795f 7661         policy_va
+00013680: 6c75 6520 3d20 6e70 2e7a 6572 6f73 2828  lue = np.zeros((
+00013690: 6e5f 6461 7461 7365 7473 2c29 290a 2020  n_datasets,)).  
+000136a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000136b0: 2020 666f 7220 6461 7461 7365 745f 6964    for dataset_id
+000136c0: 5f20 696e 2072 616e 6765 286e 5f64 6174  _ in range(n_dat
+000136d0: 6173 6574 7329 3a0a 2020 2020 2020 2020  asets):.        
+000136e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000136f0: 706f 6c69 6379 5f76 616c 7565 5b64 6174  policy_value[dat
+00013700: 6173 6574 5f69 645f 5d20 3d20 706f 6c69  aset_id_] = poli
+00013710: 6379 5f76 616c 7565 5f64 6963 745f 5b64  cy_value_dict_[d
+00013720: 6174 6173 6574 5f69 645f 5d5b 0a20 2020  ataset_id_][.   
+00013730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013740: 2020 2020 2020 2020 2065 7661 6c5f 706f           eval_po
+00013750: 6c69 6379 0a20 2020 2020 2020 2020 2020  licy.           
+00013760: 2020 2020 2020 2020 2020 2020 205d 5b65               ][e
+00013770: 7374 696d 6174 6f72 5d0a 0a20 2020 2020  stimator]..     
+00013780: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00013790: 6f6c 6963 795f 7661 6c75 655f 6469 6374  olicy_value_dict
+000137a0: 5b65 7661 6c5f 706f 6c69 6379 5d5b 6573  [eval_policy][es
+000137b0: 7469 6d61 746f 725d 203d 2070 6f6c 6963  timator] = polic
+000137c0: 795f 7661 6c75 650a 0a20 2020 2020 2020  y_value..       
+000137d0: 2020 2020 2020 2020 206f 6e5f 706f 6c69           on_poli
+000137e0: 6379 203d 2069 6e70 7574 5f64 6963 745f  cy = input_dict_
+000137f0: 305b 6576 616c 5f70 6f6c 6963 795d 5b22  0[eval_policy]["
+00013800: 6f6e 5f70 6f6c 6963 795f 706f 6c69 6379  on_policy_policy
+00013810: 5f76 616c 7565 225d 0a0a 2020 2020 2020  _value"]..      
+00013820: 2020 2020 2020 2020 2020 6966 206f 6e5f            if on_
+00013830: 706f 6c69 6379 2069 7320 6e6f 7420 4e6f  policy is not No
+00013840: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+00013850: 2020 2020 2020 2020 706f 6c69 6379 5f76          policy_v
+00013860: 616c 7565 5f64 6963 745b 6576 616c 5f70  alue_dict[eval_p
+00013870: 6f6c 6963 795d 5b22 6f6e 5f70 6f6c 6963  olicy]["on_polic
+00013880: 7922 5d20 3d20 6f6e 5f70 6f6c 6963 792e  y"] = on_policy.
+00013890: 6d65 616e 2829 0a20 2020 2020 2020 2020  mean().         
+000138a0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
 000138b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000138c0: 2020 706f 6c69 6379 5f76 616c 7565 5f64    policy_value_d
-000138d0: 6963 745b 6576 616c 5f70 6f6c 6963 795d  ict[eval_policy]
-000138e0: 5b22 6f6e 5f70 6f6c 6963 7922 5d20 3d20  ["on_policy"] = 
-000138f0: 6f6e 5f70 6f6c 6963 792e 6d65 616e 2829  on_policy.mean()
-00013900: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00013910: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00013920: 2020 2020 2020 2020 2020 2070 6f6c 6963             polic
-00013930: 795f 7661 6c75 655f 6469 6374 5b65 7661  y_value_dict[eva
-00013940: 6c5f 706f 6c69 6379 5d5b 226f 6e5f 706f  l_policy]["on_po
-00013950: 6c69 6379 225d 203d 204e 6f6e 650a 0a20  licy"] = None.. 
-00013960: 2020 2020 2020 2070 6f6c 6963 795f 7661         policy_va
-00013970: 6c75 655f 6469 6374 203d 2064 6566 6175  lue_dict = defau
-00013980: 6c74 6469 6374 5f74 6f5f 6469 6374 2870  ltdict_to_dict(p
-00013990: 6f6c 6963 795f 7661 6c75 655f 6469 6374  olicy_value_dict
-000139a0: 290a 0a20 2020 2020 2020 2070 6c74 2e73  )..        plt.s
-000139b0: 7479 6c65 2e75 7365 2822 6767 706c 6f74  tyle.use("ggplot
-000139c0: 2229 0a20 2020 2020 2020 2063 6f6c 6f72  ").        color
-000139d0: 203d 2070 6c74 2e72 6350 6172 616d 735b   = plt.rcParams[
-000139e0: 2261 7865 732e 7072 6f70 5f63 7963 6c65  "axes.prop_cycle
-000139f0: 225d 2e62 795f 6b65 7928 295b 2263 6f6c  "].by_key()["col
-00013a00: 6f72 225d 0a20 2020 2020 2020 206e 5f63  or"].        n_c
-00013a10: 6f6c 6f72 7320 3d20 6c65 6e28 636f 6c6f  olors = len(colo
-00013a20: 7229 0a0a 2020 2020 2020 2020 6e5f 6576  r)..        n_ev
-00013a30: 616c 5f70 6f6c 6963 6965 7320 3d20 6c65  al_policies = le
-00013a40: 6e28 696e 7075 745f 6469 6374 5f30 290a  n(input_dict_0).
-00013a50: 2020 2020 2020 2020 6e5f 6573 7469 6d61          n_estima
-00013a60: 746f 7273 203d 206c 656e 2863 6f6d 7061  tors = len(compa
-00013a70: 7265 645f 6573 7469 6d61 746f 7273 290a  red_estimators).
-00013a80: 2020 2020 2020 2020 6265 6861 7669 6f72          behavior
-00013a90: 5f70 6f6c 6963 795f 6e61 6d65 7320 3d20  _policy_names = 
-00013aa0: 696e 7075 745f 6469 6374 2e62 6568 6176  input_dict.behav
-00013ab0: 696f 725f 706f 6c69 6379 5f6e 616d 6573  ior_policy_names
-00013ac0: 0a0a 2020 2020 2020 2020 6966 2062 6568  ..        if beh
-00013ad0: 6176 696f 725f 706f 6c69 6379 5f6e 616d  avior_policy_nam
-00013ae0: 6520 6973 204e 6f6e 653a 0a20 2020 2020  e is None:.     
-00013af0: 2020 2020 2020 2070 616c 6574 7465 203d         palette =
-00013b00: 207b 7d0a 2020 2020 2020 2020 2020 2020   {}.            
-00013b10: 666f 7220 6a2c 2062 6568 6176 696f 725f  for j, behavior_
-00013b20: 706f 6c69 6379 2069 6e20 656e 756d 6572  policy in enumer
-00013b30: 6174 6528 6265 6861 7669 6f72 5f70 6f6c  ate(behavior_pol
-00013b40: 6963 795f 6e61 6d65 7329 3a0a 2020 2020  icy_names):.    
-00013b50: 2020 2020 2020 2020 2020 2020 7061 6c65              pale
-00013b60: 7474 655b 6265 6861 7669 6f72 5f70 6f6c  tte[behavior_pol
-00013b70: 6963 795d 203d 2063 6f6c 6f72 5b6a 2025  icy] = color[j %
-00013b80: 206e 5f63 6f6c 6f72 735d 0a0a 2020 2020   n_colors]..    
-00013b90: 2020 2020 2020 2020 6966 2068 7565 203d          if hue =
-00013ba0: 3d20 2265 7374 696d 6174 6f72 223a 0a20  = "estimator":. 
-00013bb0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00013bc0: 6967 203d 2070 6c74 2e66 6967 7572 6528  ig = plt.figure(
-00013bd0: 6669 6773 697a 653d 2832 202a 206e 5f65  figsize=(2 * n_e
-00013be0: 7374 696d 6174 6f72 732c 2034 202a 206e  stimators, 4 * n
-00013bf0: 5f65 7661 6c5f 706f 6c69 6369 6573 2929  _eval_policies))
-00013c00: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00013c10: 2020 666f 7220 692c 2065 7661 6c5f 706f    for i, eval_po
-00013c20: 6c69 6379 2069 6e20 656e 756d 6572 6174  licy in enumerat
-00013c30: 6528 696e 7075 745f 6469 6374 5f30 2e6b  e(input_dict_0.k
-00013c40: 6579 7328 2929 3a0a 2020 2020 2020 2020  eys()):.        
-00013c50: 2020 2020 2020 2020 2020 2020 6966 2069              if i
-00013c60: 203d 3d20 303a 0a20 2020 2020 2020 2020   == 0:.         
-00013c70: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-00013c80: 7820 3d20 6178 3020 3d20 6669 672e 6164  x = ax0 = fig.ad
-00013c90: 645f 7375 6270 6c6f 7428 6e5f 6576 616c  d_subplot(n_eval
-00013ca0: 5f70 6f6c 6963 6965 732c 2031 2c20 6920  _policies, 1, i 
-00013cb0: 2b20 3129 0a20 2020 2020 2020 2020 2020  + 1).           
-00013cc0: 2020 2020 2020 2020 2065 6c69 6620 7368           elif sh
-00013cd0: 6172 6579 3a0a 2020 2020 2020 2020 2020  arey:.          
-00013ce0: 2020 2020 2020 2020 2020 2020 2020 6178                ax
-00013cf0: 203d 2066 6967 2e61 6464 5f73 7562 706c   = fig.add_subpl
-00013d00: 6f74 286e 5f65 7661 6c5f 706f 6c69 6369  ot(n_eval_polici
-00013d10: 6573 2c20 312c 2069 202b 2031 2c20 7368  es, 1, i + 1, sh
-00013d20: 6172 6579 3d61 7830 290a 2020 2020 2020  arey=ax0).      
-00013d30: 2020 2020 2020 2020 2020 2020 2020 656c                el
-00013d40: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00013d50: 2020 2020 2020 2020 2020 2020 6178 203d              ax =
-00013d60: 2066 6967 2e61 6464 5f73 7562 706c 6f74   fig.add_subplot
-00013d70: 286e 5f65 7661 6c5f 706f 6c69 6369 6573  (n_eval_policies
-00013d80: 2c20 312c 2069 202b 2031 290a 0a20 2020  , 1, i + 1)..   
-00013d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013da0: 2064 6620 3d20 5b5d 0a20 2020 2020 2020   df = [].       
-00013db0: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-00013dc0: 2062 6568 6176 696f 725f 706f 6c69 6379   behavior_policy
-00013dd0: 2069 6e20 6265 6861 7669 6f72 5f70 6f6c   in behavior_pol
-00013de0: 6963 795f 6e61 6d65 733a 0a20 2020 2020  icy_names:.     
-00013df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013e00: 2020 206e 5f64 6174 6173 6574 7320 3d20     n_datasets = 
-00013e10: 696e 7075 745f 6469 6374 2e6e 5f64 6174  input_dict.n_dat
-00013e20: 6173 6574 735b 6265 6861 7669 6f72 5f70  asets[behavior_p
-00013e30: 6f6c 6963 795d 0a0a 2020 2020 2020 2020  olicy]..        
-00013e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013e50: 6466 5f20 3d20 4461 7461 4672 616d 6528  df_ = DataFrame(
-00013e60: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00013e70: 2020 2020 2020 2020 2020 666f 7220 6a2c            for j,
-00013e80: 2065 7374 696d 6174 6f72 2069 6e20 656e   estimator in en
-00013e90: 756d 6572 6174 6528 636f 6d70 6172 6564  umerate(compared
-00013ea0: 5f65 7374 696d 6174 6f72 7329 3a0a 2020  _estimators):.  
-00013eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013ec0: 2020 2020 2020 2020 2020 6466 5f5b 6573            df_[es
-00013ed0: 7469 6d61 746f 725d 203d 2070 6f6c 6963  timator] = polic
-00013ee0: 795f 7661 6c75 655f 6469 6374 5b62 6568  y_value_dict[beh
-00013ef0: 6176 696f 725f 706f 6c69 6379 5d5b 0a20  avior_policy][. 
-00013f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013f10: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00013f20: 7661 6c5f 706f 6c69 6379 0a20 2020 2020  val_policy.     
+000138c0: 2070 6f6c 6963 795f 7661 6c75 655f 6469   policy_value_di
+000138d0: 6374 5b65 7661 6c5f 706f 6c69 6379 5d5b  ct[eval_policy][
+000138e0: 226f 6e5f 706f 6c69 6379 225d 203d 204e  "on_policy"] = N
+000138f0: 6f6e 650a 0a20 2020 2020 2020 2070 6f6c  one..        pol
+00013900: 6963 795f 7661 6c75 655f 6469 6374 203d  icy_value_dict =
+00013910: 2064 6566 6175 6c74 6469 6374 5f74 6f5f   defaultdict_to_
+00013920: 6469 6374 2870 6f6c 6963 795f 7661 6c75  dict(policy_valu
+00013930: 655f 6469 6374 290a 0a20 2020 2020 2020  e_dict)..       
+00013940: 2070 6c74 2e73 7479 6c65 2e75 7365 2822   plt.style.use("
+00013950: 6767 706c 6f74 2229 0a20 2020 2020 2020  ggplot").       
+00013960: 2063 6f6c 6f72 203d 2070 6c74 2e72 6350   color = plt.rcP
+00013970: 6172 616d 735b 2261 7865 732e 7072 6f70  arams["axes.prop
+00013980: 5f63 7963 6c65 225d 2e62 795f 6b65 7928  _cycle"].by_key(
+00013990: 295b 2263 6f6c 6f72 225d 0a20 2020 2020  )["color"].     
+000139a0: 2020 206e 5f63 6f6c 6f72 7320 3d20 6c65     n_colors = le
+000139b0: 6e28 636f 6c6f 7229 0a0a 2020 2020 2020  n(color)..      
+000139c0: 2020 6e5f 6576 616c 5f70 6f6c 6963 6965    n_eval_policie
+000139d0: 7320 3d20 6c65 6e28 696e 7075 745f 6469  s = len(input_di
+000139e0: 6374 5f30 290a 2020 2020 2020 2020 6e5f  ct_0).        n_
+000139f0: 6573 7469 6d61 746f 7273 203d 206c 656e  estimators = len
+00013a00: 2863 6f6d 7061 7265 645f 6573 7469 6d61  (compared_estima
+00013a10: 746f 7273 290a 2020 2020 2020 2020 6265  tors).        be
+00013a20: 6861 7669 6f72 5f70 6f6c 6963 795f 6e61  havior_policy_na
+00013a30: 6d65 7320 3d20 696e 7075 745f 6469 6374  mes = input_dict
+00013a40: 2e62 6568 6176 696f 725f 706f 6c69 6379  .behavior_policy
+00013a50: 5f6e 616d 6573 0a0a 2020 2020 2020 2020  _names..        
+00013a60: 6966 2062 6568 6176 696f 725f 706f 6c69  if behavior_poli
+00013a70: 6379 5f6e 616d 6520 6973 204e 6f6e 653a  cy_name is None:
+00013a80: 0a20 2020 2020 2020 2020 2020 2070 616c  .            pal
+00013a90: 6574 7465 203d 207b 7d0a 2020 2020 2020  ette = {}.      
+00013aa0: 2020 2020 2020 666f 7220 6a2c 2062 6568        for j, beh
+00013ab0: 6176 696f 725f 706f 6c69 6379 2069 6e20  avior_policy in 
+00013ac0: 656e 756d 6572 6174 6528 6265 6861 7669  enumerate(behavi
+00013ad0: 6f72 5f70 6f6c 6963 795f 6e61 6d65 7329  or_policy_names)
+00013ae0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00013af0: 2020 7061 6c65 7474 655b 6265 6861 7669    palette[behavi
+00013b00: 6f72 5f70 6f6c 6963 795d 203d 2063 6f6c  or_policy] = col
+00013b10: 6f72 5b6a 2025 206e 5f63 6f6c 6f72 735d  or[j % n_colors]
+00013b20: 0a0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+00013b30: 2068 7565 203d 3d20 2265 7374 696d 6174   hue == "estimat
+00013b40: 6f72 223a 0a20 2020 2020 2020 2020 2020  or":.           
+00013b50: 2020 2020 2066 6967 203d 2070 6c74 2e66       fig = plt.f
+00013b60: 6967 7572 6528 6669 6773 697a 653d 2832  igure(figsize=(2
+00013b70: 202a 206e 5f65 7374 696d 6174 6f72 732c   * n_estimators,
+00013b80: 2034 202a 206e 5f65 7661 6c5f 706f 6c69   4 * n_eval_poli
+00013b90: 6369 6573 2929 0a0a 2020 2020 2020 2020  cies))..        
+00013ba0: 2020 2020 2020 2020 666f 7220 692c 2065          for i, e
+00013bb0: 7661 6c5f 706f 6c69 6379 2069 6e20 656e  val_policy in en
+00013bc0: 756d 6572 6174 6528 696e 7075 745f 6469  umerate(input_di
+00013bd0: 6374 5f30 2e6b 6579 7328 2929 3a0a 2020  ct_0.keys()):.  
+00013be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013bf0: 2020 6966 2069 203d 3d20 303a 0a20 2020    if i == 0:.   
+00013c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013c10: 2020 2020 2061 7820 3d20 6178 3020 3d20       ax = ax0 = 
+00013c20: 6669 672e 6164 645f 7375 6270 6c6f 7428  fig.add_subplot(
+00013c30: 6e5f 6576 616c 5f70 6f6c 6963 6965 732c  n_eval_policies,
+00013c40: 2031 2c20 6920 2b20 3129 0a20 2020 2020   1, i + 1).     
+00013c50: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00013c60: 6c69 6620 7368 6172 6579 3a0a 2020 2020  lif sharey:.    
+00013c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013c80: 2020 2020 6178 203d 2066 6967 2e61 6464      ax = fig.add
+00013c90: 5f73 7562 706c 6f74 286e 5f65 7661 6c5f  _subplot(n_eval_
+00013ca0: 706f 6c69 6369 6573 2c20 312c 2069 202b  policies, 1, i +
+00013cb0: 2031 2c20 7368 6172 6579 3d61 7830 290a   1, sharey=ax0).
+00013cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013cd0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00013ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013cf0: 2020 6178 203d 2066 6967 2e61 6464 5f73    ax = fig.add_s
+00013d00: 7562 706c 6f74 286e 5f65 7661 6c5f 706f  ubplot(n_eval_po
+00013d10: 6c69 6369 6573 2c20 312c 2069 202b 2031  licies, 1, i + 1
+00013d20: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
+00013d30: 2020 2020 2020 2064 6620 3d20 5b5d 0a20         df = []. 
+00013d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013d50: 2020 2066 6f72 2062 6568 6176 696f 725f     for behavior_
+00013d60: 706f 6c69 6379 2069 6e20 6265 6861 7669  policy in behavi
+00013d70: 6f72 5f70 6f6c 6963 795f 6e61 6d65 733a  or_policy_names:
+00013d80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00013d90: 2020 2020 2020 2020 206e 5f64 6174 6173           n_datas
+00013da0: 6574 7320 3d20 696e 7075 745f 6469 6374  ets = input_dict
+00013db0: 2e6e 5f64 6174 6173 6574 735b 6265 6861  .n_datasets[beha
+00013dc0: 7669 6f72 5f70 6f6c 6963 795d 0a0a 2020  vior_policy]..  
+00013dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013de0: 2020 2020 2020 6466 5f20 3d20 4461 7461        df_ = Data
+00013df0: 4672 616d 6528 290a 2020 2020 2020 2020  Frame().        
+00013e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013e10: 666f 7220 6a2c 2065 7374 696d 6174 6f72  for j, estimator
+00013e20: 2069 6e20 656e 756d 6572 6174 6528 636f   in enumerate(co
+00013e30: 6d70 6172 6564 5f65 7374 696d 6174 6f72  mpared_estimator
+00013e40: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
+00013e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013e60: 6466 5f5b 6573 7469 6d61 746f 725d 203d  df_[estimator] =
+00013e70: 2070 6f6c 6963 795f 7661 6c75 655f 6469   policy_value_di
+00013e80: 6374 5b62 6568 6176 696f 725f 706f 6c69  ct[behavior_poli
+00013e90: 6379 5d5b 0a20 2020 2020 2020 2020 2020  cy][.           
+00013ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013eb0: 2020 2020 2065 7661 6c5f 706f 6c69 6379       eval_policy
+00013ec0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00013ed0: 2020 2020 2020 2020 2020 2020 205d 5b65               ][e
+00013ee0: 7374 696d 6174 6f72 5d0a 0a20 2020 2020  stimator]..     
+00013ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013f00: 2020 2064 665f 5b22 6461 7461 7365 745f     df_["dataset_
+00013f10: 6964 225d 203d 206e 702e 6172 616e 6765  id"] = np.arange
+00013f20: 286e 5f64 6174 6173 6574 7329 0a20 2020  (n_datasets).   
 00013f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013f40: 2020 2020 2020 205d 5b65 7374 696d 6174         ][estimat
-00013f50: 6f72 5d0a 0a20 2020 2020 2020 2020 2020  or]..           
-00013f60: 2020 2020 2020 2020 2020 2020 2064 665f               df_
-00013f70: 5b22 6461 7461 7365 745f 6964 225d 203d  ["dataset_id"] =
-00013f80: 206e 702e 6172 616e 6765 286e 5f64 6174   np.arange(n_dat
-00013f90: 6173 6574 7329 0a20 2020 2020 2020 2020  asets).         
-00013fa0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-00013fb0: 665f 203d 2070 642e 6d65 6c74 280a 2020  f_ = pd.melt(.  
-00013fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013fd0: 2020 2020 2020 2020 2020 6466 5f2c 0a20            df_,. 
+00013f40: 2020 2020 2064 665f 203d 2070 642e 6d65       df_ = pd.me
+00013f50: 6c74 280a 2020 2020 2020 2020 2020 2020  lt(.            
+00013f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013f70: 6466 5f2c 0a20 2020 2020 2020 2020 2020  df_,.           
+00013f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013f90: 2069 645f 7661 7273 3d5b 2264 6174 6173   id_vars=["datas
+00013fa0: 6574 5f69 6422 5d2c 0a20 2020 2020 2020  et_id"],.       
+00013fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013fc0: 2020 2020 2076 6172 5f6e 616d 653d 2265       var_name="e
+00013fd0: 7374 696d 6174 6f72 222c 0a20 2020 2020  stimator",.     
 00013fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013ff0: 2020 2020 2020 2020 2020 2069 645f 7661             id_va
-00014000: 7273 3d5b 2264 6174 6173 6574 5f69 6422  rs=["dataset_id"
-00014010: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
-00014020: 2020 2020 2020 2020 2020 2020 2020 2076                 v
-00014030: 6172 5f6e 616d 653d 2265 7374 696d 6174  ar_name="estimat
-00014040: 6f72 222c 0a20 2020 2020 2020 2020 2020  or",.           
-00014050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014060: 2076 616c 7565 5f6e 616d 653d 2270 6f6c   value_name="pol
-00014070: 6963 795f 7661 6c75 6522 2c0a 2020 2020  icy_value",.    
-00014080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014090: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-000140a0: 2020 2020 2020 2020 2020 2020 2020 6466                df
-000140b0: 5f5b 2262 6568 6176 696f 725f 706f 6c69  _["behavior_poli
-000140c0: 6379 225d 203d 2062 6568 6176 696f 725f  cy"] = behavior_
-000140d0: 706f 6c69 6379 0a20 2020 2020 2020 2020  policy.         
-000140e0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-000140f0: 662e 6170 7065 6e64 2864 665f 290a 0a20  f.append(df_).. 
-00014100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014110: 2020 2064 6620 3d20 7064 2e63 6f6e 6361     df = pd.conca
-00014120: 7428 6466 2c20 6178 6973 3d30 290a 2020  t(df, axis=0).  
-00014130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014140: 2020 6966 2028 6466 5b22 706f 6c69 6379    if (df["policy
-00014150: 5f76 616c 7565 225d 203e 2031 6531 3029  _value"] > 1e10)
-00014160: 2e73 756d 2829 202b 2028 0a20 2020 2020  .sum() + (.     
-00014170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014180: 2020 2064 665b 2270 6f6c 6963 795f 7661     df["policy_va
-00014190: 6c75 6522 5d20 3c20 2d31 6531 300a 2020  lue"] < -1e10.  
-000141a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000141b0: 2020 292e 7375 6d28 2920 3e20 303a 0a20    ).sum() > 0:. 
-000141c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000141d0: 2020 2020 2020 2077 6172 6e28 0a20 2020         warn(.   
-000141e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000141f0: 2020 2020 2020 2020 2022 466f 756e 6420           "Found 
-00014200: 6120 6c61 7267 6520 6162 736f 6c75 7465  a large absolute
-00014210: 2076 616c 7565 2069 6e20 7468 6520 706f   value in the po
-00014220: 6c69 6379 2076 616c 7565 2065 7374 696d  licy value estim
-00014230: 6174 652e 2054 6865 2076 616c 7565 206d  ate. The value m
-00014240: 6f72 6520 7468 616e 2031 6531 3020 616e  ore than 1e10 an
-00014250: 6420 6c65 7373 2074 6861 6e20 2d31 6531  d less than -1e1
-00014260: 3020 7769 6c6c 2062 6520 7265 706c 6163  0 will be replac
-00014270: 6564 2074 6f20 6e70 2e6e 616e 2e22 0a20  ed to np.nan.". 
+00013ff0: 2020 2020 2020 2076 616c 7565 5f6e 616d         value_nam
+00014000: 653d 2270 6f6c 6963 795f 7661 6c75 6522  e="policy_value"
+00014010: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00014020: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00014030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014040: 2020 2020 6466 5f5b 2262 6568 6176 696f      df_["behavio
+00014050: 725f 706f 6c69 6379 225d 203d 2062 6568  r_policy"] = beh
+00014060: 6176 696f 725f 706f 6c69 6379 0a20 2020  avior_policy.   
+00014070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014080: 2020 2020 2064 662e 6170 7065 6e64 2864       df.append(d
+00014090: 665f 290a 0a20 2020 2020 2020 2020 2020  f_)..           
+000140a0: 2020 2020 2020 2020 2064 6620 3d20 7064           df = pd
+000140b0: 2e63 6f6e 6361 7428 6466 2c20 6178 6973  .concat(df, axis
+000140c0: 3d30 290a 2020 2020 2020 2020 2020 2020  =0).            
+000140d0: 2020 2020 2020 2020 6966 2028 6466 5b22          if (df["
+000140e0: 706f 6c69 6379 5f76 616c 7565 225d 203e  policy_value"] >
+000140f0: 2031 6531 3029 2e73 756d 2829 202b 2028   1e10).sum() + (
+00014100: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00014110: 2020 2020 2020 2020 2064 665b 2270 6f6c           df["pol
+00014120: 6963 795f 7661 6c75 6522 5d20 3c20 2d31  icy_value"] < -1
+00014130: 6531 300a 2020 2020 2020 2020 2020 2020  e10.            
+00014140: 2020 2020 2020 2020 292e 7375 6d28 2920          ).sum() 
+00014150: 3e20 303a 0a20 2020 2020 2020 2020 2020  > 0:.           
+00014160: 2020 2020 2020 2020 2020 2020 2077 6172               war
+00014170: 6e28 0a20 2020 2020 2020 2020 2020 2020  n(.             
+00014180: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00014190: 466f 756e 6420 6120 6c61 7267 6520 6162  Found a large ab
+000141a0: 736f 6c75 7465 2076 616c 7565 2069 6e20  solute value in 
+000141b0: 7468 6520 706f 6c69 6379 2076 616c 7565  the policy value
+000141c0: 2065 7374 696d 6174 652e 2054 6865 2076   estimate. The v
+000141d0: 616c 7565 206d 6f72 6520 7468 616e 2031  alue more than 1
+000141e0: 6531 3020 616e 6420 6c65 7373 2074 6861  e10 and less tha
+000141f0: 6e20 2d31 6531 3020 7769 6c6c 2062 6520  n -1e10 will be 
+00014200: 7265 706c 6163 6564 2074 6f20 6e70 2e6e  replaced to np.n
+00014210: 616e 2e22 0a20 2020 2020 2020 2020 2020  an.".           
+00014220: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
+00014230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014240: 2020 2020 2020 2064 665b 2270 6f6c 6963         df["polic
+00014250: 795f 7661 6c75 6522 5d20 3d20 6466 5b22  y_value"] = df["
+00014260: 706f 6c69 6379 5f76 616c 7565 225d 2e6d  policy_value"].m
+00014270: 6173 6b28 0a20 2020 2020 2020 2020 2020  ask(.           
 00014280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014290: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-000142a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000142b0: 2064 665b 2270 6f6c 6963 795f 7661 6c75   df["policy_valu
-000142c0: 6522 5d20 3d20 6466 5b22 706f 6c69 6379  e"] = df["policy
-000142d0: 5f76 616c 7565 225d 2e6d 6173 6b28 0a20  _value"].mask(. 
-000142e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000142f0: 2020 2020 2020 2020 2020 2064 665b 2270             df["p
-00014300: 6f6c 6963 795f 7661 6c75 6522 5d20 3e20  olicy_value"] > 
-00014310: 3165 2d31 302c 206e 702e 6e61 6e0a 2020  1e-10, np.nan.  
+00014290: 2064 665b 2270 6f6c 6963 795f 7661 6c75   df["policy_valu
+000142a0: 6522 5d20 3e20 3165 2d31 302c 206e 702e  e"] > 1e-10, np.
+000142b0: 6e61 6e0a 2020 2020 2020 2020 2020 2020  nan.            
+000142c0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+000142d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000142e0: 2020 2020 2020 6466 5b22 706f 6c69 6379        df["policy
+000142f0: 5f76 616c 7565 225d 203d 2064 665b 2270  _value"] = df["p
+00014300: 6f6c 6963 795f 7661 6c75 6522 5d2e 6d61  olicy_value"].ma
+00014310: 736b 280a 2020 2020 2020 2020 2020 2020  sk(.            
 00014320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014330: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00014340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014350: 6466 5b22 706f 6c69 6379 5f76 616c 7565  df["policy_value
-00014360: 225d 203d 2064 665b 2270 6f6c 6963 795f  "] = df["policy_
-00014370: 7661 6c75 6522 5d2e 6d61 736b 280a 2020  value"].mask(.  
-00014380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014390: 2020 2020 2020 2020 2020 6466 5b22 706f            df["po
-000143a0: 6c69 6379 5f76 616c 7565 225d 203c 202d  licy_value"] < -
-000143b0: 3165 2d31 302c 206e 702e 6e61 6e0a 2020  1e-10, np.nan.  
+00014330: 6466 5b22 706f 6c69 6379 5f76 616c 7565  df["policy_value
+00014340: 225d 203c 202d 3165 2d31 302c 206e 702e  "] < -1e-10, np.
+00014350: 6e61 6e0a 2020 2020 2020 2020 2020 2020  nan.            
+00014360: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+00014370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014380: 2020 2069 6620 706c 6f74 5f74 7970 6520     if plot_type 
+00014390: 3d3d 2022 6369 223a 0a20 2020 2020 2020  == "ci":.       
+000143a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000143b0: 2073 6e73 2e62 6172 706c 6f74 280a 2020   sns.barplot(.  
 000143c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000143d0: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-000143e0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-000143f0: 706c 6f74 5f74 7970 6520 3d3d 2022 6369  plot_type == "ci
-00014400: 223a 0a20 2020 2020 2020 2020 2020 2020  ":.             
-00014410: 2020 2020 2020 2020 2020 2073 6e73 2e62             sns.b
-00014420: 6172 706c 6f74 280a 2020 2020 2020 2020  arplot(.        
-00014430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014440: 2020 2020 6461 7461 3d64 662c 0a20 2020      data=df,.   
-00014450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014460: 2020 2020 2020 2020 2078 3d22 6573 7469           x="esti
-00014470: 6d61 746f 7222 2c0a 2020 2020 2020 2020  mator",.        
-00014480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014490: 2020 2020 793d 2270 6f6c 6963 795f 7661      y="policy_va
-000144a0: 6c75 6522 2c0a 2020 2020 2020 2020 2020  lue",.          
-000144b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000144c0: 2020 6875 653d 2262 6568 6176 696f 725f    hue="behavior_
-000144d0: 706f 6c69 6379 222c 0a20 2020 2020 2020  policy",.       
-000144e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000144f0: 2020 2020 2070 616c 6574 7465 3d70 616c       palette=pal
-00014500: 6574 7465 2c0a 2020 2020 2020 2020 2020  ette,.          
+000143d0: 2020 2020 2020 2020 2020 6461 7461 3d64            data=d
+000143e0: 662c 0a20 2020 2020 2020 2020 2020 2020  f,.             
+000143f0: 2020 2020 2020 2020 2020 2020 2020 2078                 x
+00014400: 3d22 6573 7469 6d61 746f 7222 2c0a 2020  ="estimator",.  
+00014410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014420: 2020 2020 2020 2020 2020 793d 2270 6f6c            y="pol
+00014430: 6963 795f 7661 6c75 6522 2c0a 2020 2020  icy_value",.    
+00014440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014450: 2020 2020 2020 2020 6875 653d 2262 6568          hue="beh
+00014460: 6176 696f 725f 706f 6c69 6379 222c 0a20  avior_policy",. 
+00014470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014480: 2020 2020 2020 2020 2020 2070 616c 6574             palet
+00014490: 7465 3d70 616c 6574 7465 2c0a 2020 2020  te=palette,.    
+000144a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000144b0: 2020 2020 2020 2020 6178 3d61 782c 0a20          ax=ax,. 
+000144c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000144d0: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+000144e0: 2020 2020 2020 2020 2020 2020 2020 656c                el
+000144f0: 6966 2070 6c6f 745f 7479 7065 203d 3d20  if plot_type == 
+00014500: 2276 696f 6c69 6e22 3a0a 2020 2020 2020  "violin":.      
 00014510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014520: 2020 6178 3d61 782c 0a20 2020 2020 2020    ax=ax,.       
-00014530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014540: 2029 0a0a 2020 2020 2020 2020 2020 2020   )..            
-00014550: 2020 2020 2020 2020 656c 6966 2070 6c6f          elif plo
-00014560: 745f 7479 7065 203d 3d20 2276 696f 6c69  t_type == "violi
-00014570: 6e22 3a0a 2020 2020 2020 2020 2020 2020  n":.            
-00014580: 2020 2020 2020 2020 2020 2020 736e 732e              sns.
-00014590: 7669 6f6c 696e 706c 6f74 280a 2020 2020  violinplot(.    
-000145a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000145b0: 2020 2020 2020 2020 6461 7461 3d64 662c          data=df,
-000145c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000145d0: 2020 2020 2020 2020 2020 2020 2078 3d22               x="
-000145e0: 6573 7469 6d61 746f 7222 2c0a 2020 2020  estimator",.    
-000145f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014600: 2020 2020 2020 2020 793d 2270 6f6c 6963          y="polic
-00014610: 795f 7661 6c75 6522 2c0a 2020 2020 2020  y_value",.      
-00014620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014630: 2020 2020 2020 6875 653d 2262 6568 6176        hue="behav
-00014640: 696f 725f 706f 6c69 6379 222c 0a20 2020  ior_policy",.   
-00014650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014660: 2020 2020 2020 2020 2073 6361 6c65 3d22           scale="
-00014670: 7769 6474 6822 2c0a 2020 2020 2020 2020  width",.        
-00014680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014690: 2020 2020 7769 6474 683d 302e 382c 0a20      width=0.8,. 
+00014520: 2020 736e 732e 7669 6f6c 696e 706c 6f74    sns.violinplot
+00014530: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00014540: 2020 2020 2020 2020 2020 2020 2020 6461                da
+00014550: 7461 3d64 662c 0a20 2020 2020 2020 2020  ta=df,.         
+00014560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014570: 2020 2078 3d22 6573 7469 6d61 746f 7222     x="estimator"
+00014580: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00014590: 2020 2020 2020 2020 2020 2020 2020 793d                y=
+000145a0: 2270 6f6c 6963 795f 7661 6c75 6522 2c0a  "policy_value",.
+000145b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000145c0: 2020 2020 2020 2020 2020 2020 6875 653d              hue=
+000145d0: 2262 6568 6176 696f 725f 706f 6c69 6379  "behavior_policy
+000145e0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+000145f0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00014600: 6361 6c65 3d22 7769 6474 6822 2c0a 2020  cale="width",.  
+00014610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014620: 2020 2020 2020 2020 2020 7769 6474 683d            width=
+00014630: 302e 382c 0a20 2020 2020 2020 2020 2020  0.8,.           
+00014640: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014650: 2070 616c 6574 7465 3d70 616c 6574 7465   palette=palette
+00014660: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00014670: 2020 2020 2020 2020 2020 2020 2020 6178                ax
+00014680: 3d61 782c 0a20 2020 2020 2020 2020 2020  =ax,.           
+00014690: 2020 2020 2020 2020 2020 2020 2029 0a0a               )..
 000146a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000146b0: 2020 2020 2020 2020 2020 2070 616c 6574             palet
-000146c0: 7465 3d70 616c 6574 7465 2c0a 2020 2020  te=palette,.    
-000146d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000146e0: 2020 2020 2020 2020 6178 3d61 782c 0a20          ax=ax,. 
-000146f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014700: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-00014710: 2020 2020 2020 2020 2020 2020 2020 656c                el
-00014720: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00014730: 2020 2020 2020 2020 2020 2020 7472 793a              try:
-00014740: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00014750: 2020 2020 2020 2020 2020 2020 2073 6e73               sns
-00014760: 2e73 7761 726d 706c 6f74 280a 2020 2020  .swarmplot(.    
-00014770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014780: 2020 2020 2020 2020 2020 2020 6461 7461              data
-00014790: 3d64 662c 0a20 2020 2020 2020 2020 2020  =df,.           
-000147a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000147b0: 2020 2020 2078 3d22 6573 7469 6d61 746f       x="estimato
-000147c0: 7222 2c0a 2020 2020 2020 2020 2020 2020  r",.            
+000146b0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+000146c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000146d0: 2020 7472 793a 0a20 2020 2020 2020 2020    try:.         
+000146e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000146f0: 2020 2073 6e73 2e73 7761 726d 706c 6f74     sns.swarmplot
+00014700: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00014710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014720: 2020 6461 7461 3d64 662c 0a20 2020 2020    data=df,.     
+00014730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014740: 2020 2020 2020 2020 2020 2078 3d22 6573             x="es
+00014750: 7469 6d61 746f 7222 2c0a 2020 2020 2020  timator",.      
+00014760: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014770: 2020 2020 2020 2020 2020 793d 2270 6f6c            y="pol
+00014780: 6963 795f 7661 6c75 6522 2c0a 2020 2020  icy_value",.    
+00014790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000147a0: 2020 2020 2020 2020 2020 2020 6875 653d              hue=
+000147b0: 2262 6568 6176 696f 725f 706f 6c69 6379  "behavior_policy
+000147c0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
 000147d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000147e0: 2020 2020 793d 2270 6f6c 6963 795f 7661      y="policy_va
-000147f0: 6c75 6522 2c0a 2020 2020 2020 2020 2020  lue",.          
+000147e0: 2020 2070 616c 6574 7465 3d70 616c 6574     palette=palet
+000147f0: 7465 2c0a 2020 2020 2020 2020 2020 2020  te,.            
 00014800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014810: 2020 2020 2020 6875 653d 2262 6568 6176        hue="behav
-00014820: 696f 725f 706f 6c69 6379 222c 0a20 2020  ior_policy",.   
-00014830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014840: 2020 2020 2020 2020 2020 2020 2070 616c               pal
-00014850: 6574 7465 3d70 616c 6574 7465 2c0a 2020  ette=palette,.  
+00014810: 2020 2020 6178 3d61 782c 0a20 2020 2020      ax=ax,.     
+00014820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014830: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00014840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014850: 2065 7863 6570 743a 0a20 2020 2020 2020   except:.       
 00014860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014870: 2020 2020 2020 2020 2020 2020 2020 6178                ax
-00014880: 3d61 782c 0a20 2020 2020 2020 2020 2020  =ax,.           
-00014890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000148a0: 2029 0a20 2020 2020 2020 2020 2020 2020   ).             
-000148b0: 2020 2020 2020 2020 2020 2065 7863 6570             excep
-000148c0: 743a 0a20 2020 2020 2020 2020 2020 2020  t:.             
-000148d0: 2020 2020 2020 2020 2020 2020 2020 2077                 w
-000148e0: 6172 6e28 2245 6e63 6f75 6e74 6572 6564  arn("Encountered
-000148f0: 204e 614e 2076 616c 7565 7320 6475 7269   NaN values duri
-00014900: 6e67 2070 6c6f 742e 2229 0a0a 2020 2020  ng plot.")..    
-00014910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014920: 6f6e 5f70 6f6c 6963 7920 3d20 706f 6c69  on_policy = poli
-00014930: 6379 5f76 616c 7565 5f64 6963 745b 6265  cy_value_dict[be
-00014940: 6861 7669 6f72 5f70 6f6c 6963 795d 5b65  havior_policy][e
-00014950: 7661 6c5f 706f 6c69 6379 5d5b 0a20 2020  val_policy][.   
+00014870: 2020 2020 2077 6172 6e28 2245 6e63 6f75       warn("Encou
+00014880: 6e74 6572 6564 204e 614e 2076 616c 7565  ntered NaN value
+00014890: 7320 6475 7269 6e67 2070 6c6f 742e 2229  s during plot.")
+000148a0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000148b0: 2020 2020 2020 6f6e 5f70 6f6c 6963 7920        on_policy 
+000148c0: 3d20 706f 6c69 6379 5f76 616c 7565 5f64  = policy_value_d
+000148d0: 6963 745b 6265 6861 7669 6f72 5f70 6f6c  ict[behavior_pol
+000148e0: 6963 795d 5b65 7661 6c5f 706f 6c69 6379  icy][eval_policy
+000148f0: 5d5b 0a20 2020 2020 2020 2020 2020 2020  ][.             
+00014900: 2020 2020 2020 2020 2020 2022 6f6e 5f70             "on_p
+00014910: 6f6c 6963 7922 0a20 2020 2020 2020 2020  olicy".         
+00014920: 2020 2020 2020 2020 2020 205d 0a20 2020             ].   
+00014930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014940: 2069 6620 6f6e 5f70 6f6c 6963 7920 6973   if on_policy is
+00014950: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
 00014960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014970: 2020 2020 2022 6f6e 5f70 6f6c 6963 7922       "on_policy"
-00014980: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00014990: 2020 2020 205d 0a20 2020 2020 2020 2020       ].         
-000149a0: 2020 2020 2020 2020 2020 2069 6620 6f6e             if on
-000149b0: 5f70 6f6c 6963 7920 6973 206e 6f74 204e  _policy is not N
-000149c0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-000149d0: 2020 2020 2020 2020 2020 2020 2061 782e               ax.
-000149e0: 7363 6174 7465 7228 0a20 2020 2020 2020  scatter(.       
-000149f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014a00: 2020 2020 206e 702e 6172 616e 6765 286e       np.arange(n
-00014a10: 5f65 7374 696d 6174 6f72 7329 2c0a 2020  _estimators),.  
+00014970: 2020 2061 782e 7363 6174 7465 7228 0a20     ax.scatter(. 
+00014980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014990: 2020 2020 2020 2020 2020 206e 702e 6172             np.ar
+000149a0: 616e 6765 286e 5f65 7374 696d 6174 6f72  ange(n_estimator
+000149b0: 7329 2c0a 2020 2020 2020 2020 2020 2020  s),.            
+000149c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000149d0: 6e70 2e66 756c 6c28 286e 5f65 7374 696d  np.full((n_estim
+000149e0: 6174 6f72 7329 2c20 6f6e 5f70 6f6c 6963  ators), on_polic
+000149f0: 7929 2c0a 2020 2020 2020 2020 2020 2020  y),.            
+00014a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014a10: 636f 6c6f 723d 2262 6c61 636b 222c 0a20  color="black",. 
 00014a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014a30: 2020 2020 2020 2020 2020 6e70 2e66 756c            np.ful
-00014a40: 6c28 286e 5f65 7374 696d 6174 6f72 7329  l((n_estimators)
-00014a50: 2c20 6f6e 5f70 6f6c 6963 7929 2c0a 2020  , on_policy),.  
-00014a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014a70: 2020 2020 2020 2020 2020 636f 6c6f 723d            color=
-00014a80: 2262 6c61 636b 222c 0a20 2020 2020 2020  "black",.       
-00014a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014aa0: 2020 2020 206d 6172 6b65 723d 222a 222c       marker="*",
-00014ab0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00014ac0: 2020 2020 2020 2020 2020 2020 2073 3d31               s=1
-00014ad0: 3530 2c0a 2020 2020 2020 2020 2020 2020  50,.            
-00014ae0: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-00014af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014b00: 2020 2069 6620 6c65 6765 6e64 3a0a 2020     if legend:.  
-00014b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014b20: 2020 2020 2020 6178 2e6c 6567 656e 6428        ax.legend(
-00014b30: 6c6f 633d 226c 6f77 6572 2072 6967 6874  loc="lower right
-00014b40: 2229 0a20 2020 2020 2020 2020 2020 2020  ").             
-00014b50: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00014a30: 2020 2020 2020 2020 2020 206d 6172 6b65             marke
+00014a40: 723d 222a 222c 0a20 2020 2020 2020 2020  r="*",.         
+00014a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014a60: 2020 2073 3d31 3530 2c0a 2020 2020 2020     s=150,.      
+00014a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014a80: 2020 290a 0a20 2020 2020 2020 2020 2020    )..           
+00014a90: 2020 2020 2020 2020 2069 6620 6c65 6765           if lege
+00014aa0: 6e64 3a0a 2020 2020 2020 2020 2020 2020  nd:.            
+00014ab0: 2020 2020 2020 2020 2020 2020 6178 2e6c              ax.l
+00014ac0: 6567 656e 6428 6c6f 633d 226c 6f77 6572  egend(loc="lower
+00014ad0: 2072 6967 6874 2229 0a20 2020 2020 2020   right").       
+00014ae0: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+00014af0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00014b00: 2020 2020 2020 2020 2020 2061 782e 6765             ax.ge
+00014b10: 745f 6c65 6765 6e64 2829 2e72 656d 6f76  t_legend().remov
+00014b20: 6528 290a 0a20 2020 2020 2020 2020 2020  e()..           
+00014b30: 2020 2020 2020 2020 2061 782e 7365 745f           ax.set_
+00014b40: 7469 746c 6528 6576 616c 5f70 6f6c 6963  title(eval_polic
+00014b50: 792c 2066 6f6e 7473 697a 653d 3136 290a  y, fontsize=16).
 00014b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014b70: 2020 2020 2061 782e 6765 745f 6c65 6765       ax.get_lege
-00014b80: 6e64 2829 2e72 656d 6f76 6528 290a 0a20  nd().remove().. 
-00014b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014ba0: 2020 2061 782e 7365 745f 7469 746c 6528     ax.set_title(
-00014bb0: 6576 616c 5f70 6f6c 6963 792c 2066 6f6e  eval_policy, fon
-00014bc0: 7473 697a 653d 3136 290a 2020 2020 2020  tsize=16).      
-00014bd0: 2020 2020 2020 2020 2020 2020 2020 6178                ax
-00014be0: 2e73 6574 5f78 6c61 6265 6c28 2222 290a  .set_xlabel("").
-00014bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014c00: 2020 2020 6178 2e73 6574 5f79 6c61 6265      ax.set_ylabe
-00014c10: 6c28 0a20 2020 2020 2020 2020 2020 2020  l(.             
-00014c20: 2020 2020 2020 2020 2020 2066 2245 7374             f"Est
-00014c30: 696d 6174 6564 2050 6f6c 6963 7920 5661  imated Policy Va
-00014c40: 6c75 6522 2c0a 2020 2020 2020 2020 2020  lue",.          
-00014c50: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-00014c60: 6e74 7369 7a65 3d31 322c 0a20 2020 2020  ntsize=12,.     
-00014c70: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-00014c80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00014c90: 2020 2020 2061 782e 7365 745f 7874 6963       ax.set_xtic
-00014ca0: 6b73 286e 702e 6172 616e 6765 286e 5f65  ks(np.arange(n_e
-00014cb0: 7374 696d 6174 6f72 7329 2c20 636f 6d70  stimators), comp
-00014cc0: 6172 6564 5f65 7374 696d 6174 6f72 7329  ared_estimators)
-00014cd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00014ce0: 2020 2020 2070 6c74 2e79 7469 636b 7328       plt.yticks(
-00014cf0: 666f 6e74 7369 7a65 3d31 3229 0a20 2020  fontsize=12).   
-00014d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014d10: 2070 6c74 2e78 7469 636b 7328 666f 6e74   plt.xticks(font
-00014d20: 7369 7a65 3d31 3229 0a0a 2020 2020 2020  size=12)..      
-00014d30: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-00014d40: 2020 2020 2020 2020 2020 2020 7669 7375              visu
-00014d50: 616c 697a 655f 6f6e 5f70 6f6c 6963 7920  alize_on_policy 
-00014d60: 3d20 5472 7565 0a20 2020 2020 2020 2020  = True.         
-00014d70: 2020 2020 2020 2066 6f72 2065 7661 6c5f         for eval_
-00014d80: 706f 6c69 6379 2069 6e20 696e 7075 745f  policy in input_
-00014d90: 6469 6374 5f30 2e6b 6579 7328 293a 0a20  dict_0.keys():. 
-00014da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014db0: 2020 2069 6620 696e 7075 745f 6469 6374     if input_dict
-00014dc0: 5f30 5b65 7661 6c5f 706f 6c69 6379 5d5b  _0[eval_policy][
-00014dd0: 226f 6e5f 706f 6c69 6379 5f70 6f6c 6963  "on_policy_polic
-00014de0: 795f 7661 6c75 6522 5d20 6973 204e 6f6e  y_value"] is Non
-00014df0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00014e00: 2020 2020 2020 2020 2020 2076 6973 7561             visua
-00014e10: 6c69 7a65 5f6f 6e5f 706f 6c69 6379 203d  lize_on_policy =
-00014e20: 2046 616c 7365 0a0a 2020 2020 2020 2020   False..        
-00014e30: 2020 2020 2020 2020 2020 2020 6f6e 5f70              on_p
-00014e40: 6f6c 6963 7920 3d20 6e70 2e7a 6572 6f73  olicy = np.zeros
-00014e50: 286e 5f65 7661 6c5f 706f 6c69 6369 6573  (n_eval_policies
-00014e60: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00014e70: 2020 2020 2020 666f 7220 6a2c 2065 7661        for j, eva
-00014e80: 6c5f 706f 6c69 6379 2069 6e20 656e 756d  l_policy in enum
-00014e90: 6572 6174 6528 696e 7075 745f 6469 6374  erate(input_dict
-00014ea0: 5f30 2e6b 6579 7328 2929 3a0a 2020 2020  _0.keys()):.    
-00014eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014ec0: 2020 2020 6f6e 5f70 6f6c 6963 795b 6a5d      on_policy[j]
-00014ed0: 203d 2070 6f6c 6963 795f 7661 6c75 655f   = policy_value_
-00014ee0: 6469 6374 5b62 6568 6176 696f 725f 706f  dict[behavior_po
-00014ef0: 6c69 6379 5f6e 616d 6573 5b30 5d5d 5b0a  licy_names[0]][.
-00014f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014f10: 2020 2020 2020 2020 2020 2020 6576 616c              eval
-00014f20: 5f70 6f6c 6963 790a 2020 2020 2020 2020  _policy.        
-00014f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014f40: 5d5b 226f 6e5f 706f 6c69 6379 225d 0a0a  ]["on_policy"]..
-00014f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014f60: 6669 6720 3d20 706c 742e 6669 6775 7265  fig = plt.figure
-00014f70: 2866 6967 7369 7a65 3d28 3220 2a20 6e5f  (figsize=(2 * n_
-00014f80: 6576 616c 5f70 6f6c 6963 6965 732c 2034  eval_policies, 4
-00014f90: 202a 206e 5f65 7374 696d 6174 6f72 7329   * n_estimators)
-00014fa0: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
-00014fb0: 2020 2066 6f72 2069 2c20 6573 7469 6d61     for i, estima
-00014fc0: 746f 7220 696e 2065 6e75 6d65 7261 7465  tor in enumerate
-00014fd0: 2863 6f6d 7061 7265 645f 6573 7469 6d61  (compared_estima
-00014fe0: 746f 7273 293a 0a20 2020 2020 2020 2020  tors):.         
-00014ff0: 2020 2020 2020 2020 2020 2069 6620 6920             if i 
-00015000: 3d3d 2030 3a0a 2020 2020 2020 2020 2020  == 0:.          
-00015010: 2020 2020 2020 2020 2020 2020 2020 6178                ax
-00015020: 203d 2061 7830 203d 2066 6967 2e61 6464   = ax0 = fig.add
-00015030: 5f73 7562 706c 6f74 286e 5f65 7374 696d  _subplot(n_estim
-00015040: 6174 6f72 732c 2031 2c20 6920 2b20 3129  ators, 1, i + 1)
-00015050: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00015060: 2020 2020 2065 6c69 6620 7368 6172 6579       elif sharey
-00015070: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00015080: 2020 2020 2020 2020 2020 6178 203d 2066            ax = f
-00015090: 6967 2e61 6464 5f73 7562 706c 6f74 286e  ig.add_subplot(n
-000150a0: 5f65 7374 696d 6174 6f72 732c 2031 2c20  _estimators, 1, 
-000150b0: 6920 2b20 312c 2073 6861 7265 793d 6178  i + 1, sharey=ax
-000150c0: 3029 0a20 2020 2020 2020 2020 2020 2020  0).             
-000150d0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-000150e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000150f0: 2020 2020 2061 7820 3d20 6669 672e 6164       ax = fig.ad
-00015100: 645f 7375 6270 6c6f 7428 6e5f 6573 7469  d_subplot(n_esti
-00015110: 6d61 746f 7273 2c20 312c 2069 202b 2031  mators, 1, i + 1
-00015120: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
-00015130: 2020 2020 2020 2064 6620 3d20 5b5d 0a20         df = []. 
-00015140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015150: 2020 2066 6f72 2062 6568 6176 696f 725f     for behavior_
-00015160: 706f 6c69 6379 2069 6e20 6265 6861 7669  policy in behavi
-00015170: 6f72 5f70 6f6c 6963 795f 6e61 6d65 733a  or_policy_names:
-00015180: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00015190: 2020 2020 2020 2020 206e 5f64 6174 6173           n_datas
-000151a0: 6574 7320 3d20 696e 7075 745f 6469 6374  ets = input_dict
-000151b0: 2e6e 5f64 6174 6173 6574 735b 6265 6861  .n_datasets[beha
-000151c0: 7669 6f72 5f70 6f6c 6963 795d 0a0a 2020  vior_policy]..  
-000151d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000151e0: 2020 2020 2020 6466 5f20 3d20 4461 7461        df_ = Data
-000151f0: 4672 616d 6528 290a 2020 2020 2020 2020  Frame().        
-00015200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015210: 666f 7220 6a2c 2065 7661 6c5f 706f 6c69  for j, eval_poli
-00015220: 6379 2069 6e20 656e 756d 6572 6174 6528  cy in enumerate(
-00015230: 696e 7075 745f 6469 6374 5f30 2e6b 6579  input_dict_0.key
-00015240: 7328 2929 3a0a 2020 2020 2020 2020 2020  s()):.          
-00015250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015260: 2020 6466 5f5b 6576 616c 5f70 6f6c 6963    df_[eval_polic
-00015270: 795d 203d 2070 6f6c 6963 795f 7661 6c75  y] = policy_valu
-00015280: 655f 6469 6374 5b62 6568 6176 696f 725f  e_dict[behavior_
-00015290: 706f 6c69 6379 5d5b 0a20 2020 2020 2020  policy][.       
-000152a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000152b0: 2020 2020 2020 2020 2065 7661 6c5f 706f           eval_po
-000152c0: 6c69 6379 0a20 2020 2020 2020 2020 2020  licy.           
-000152d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000152e0: 205d 5b65 7374 696d 6174 6f72 5d0a 0a20   ][estimator].. 
+00014b70: 2020 2020 6178 2e73 6574 5f78 6c61 6265      ax.set_xlabe
+00014b80: 6c28 2222 290a 2020 2020 2020 2020 2020  l("").          
+00014b90: 2020 2020 2020 2020 2020 6178 2e73 6574            ax.set
+00014ba0: 5f79 6c61 6265 6c28 0a20 2020 2020 2020  _ylabel(.       
+00014bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014bc0: 2066 2245 7374 696d 6174 6564 2050 6f6c   f"Estimated Pol
+00014bd0: 6963 7920 5661 6c75 6522 2c0a 2020 2020  icy Value",.    
+00014be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014bf0: 2020 2020 666f 6e74 7369 7a65 3d31 322c      fontsize=12,
+00014c00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00014c10: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+00014c20: 2020 2020 2020 2020 2020 2061 782e 7365             ax.se
+00014c30: 745f 7874 6963 6b73 286e 702e 6172 616e  t_xticks(np.aran
+00014c40: 6765 286e 5f65 7374 696d 6174 6f72 7329  ge(n_estimators)
+00014c50: 2c20 636f 6d70 6172 6564 5f65 7374 696d  , compared_estim
+00014c60: 6174 6f72 7329 0a20 2020 2020 2020 2020  ators).         
+00014c70: 2020 2020 2020 2020 2020 2070 6c74 2e79             plt.y
+00014c80: 7469 636b 7328 666f 6e74 7369 7a65 3d31  ticks(fontsize=1
+00014c90: 3229 0a20 2020 2020 2020 2020 2020 2020  2).             
+00014ca0: 2020 2020 2020 2070 6c74 2e78 7469 636b         plt.xtick
+00014cb0: 7328 666f 6e74 7369 7a65 3d31 3229 0a0a  s(fontsize=12)..
+00014cc0: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00014cd0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00014ce0: 2020 7669 7375 616c 697a 655f 6f6e 5f70    visualize_on_p
+00014cf0: 6f6c 6963 7920 3d20 5472 7565 0a20 2020  olicy = True.   
+00014d00: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+00014d10: 2065 7661 6c5f 706f 6c69 6379 2069 6e20   eval_policy in 
+00014d20: 696e 7075 745f 6469 6374 5f30 2e6b 6579  input_dict_0.key
+00014d30: 7328 293a 0a20 2020 2020 2020 2020 2020  s():.           
+00014d40: 2020 2020 2020 2020 2069 6620 696e 7075           if inpu
+00014d50: 745f 6469 6374 5f30 5b65 7661 6c5f 706f  t_dict_0[eval_po
+00014d60: 6c69 6379 5d5b 226f 6e5f 706f 6c69 6379  licy]["on_policy
+00014d70: 5f70 6f6c 6963 795f 7661 6c75 6522 5d20  _policy_value"] 
+00014d80: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
+00014d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014da0: 2076 6973 7561 6c69 7a65 5f6f 6e5f 706f   visualize_on_po
+00014db0: 6c69 6379 203d 2046 616c 7365 0a0a 2020  licy = False..  
+00014dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014dd0: 2020 6f6e 5f70 6f6c 6963 7920 3d20 6e70    on_policy = np
+00014de0: 2e7a 6572 6f73 286e 5f65 7661 6c5f 706f  .zeros(n_eval_po
+00014df0: 6c69 6369 6573 290a 2020 2020 2020 2020  licies).        
+00014e00: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00014e10: 6a2c 2065 7661 6c5f 706f 6c69 6379 2069  j, eval_policy i
+00014e20: 6e20 656e 756d 6572 6174 6528 696e 7075  n enumerate(inpu
+00014e30: 745f 6469 6374 5f30 2e6b 6579 7328 2929  t_dict_0.keys())
+00014e40: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00014e50: 2020 2020 2020 2020 2020 6f6e 5f70 6f6c            on_pol
+00014e60: 6963 795b 6a5d 203d 2070 6f6c 6963 795f  icy[j] = policy_
+00014e70: 7661 6c75 655f 6469 6374 5b62 6568 6176  value_dict[behav
+00014e80: 696f 725f 706f 6c69 6379 5f6e 616d 6573  ior_policy_names
+00014e90: 5b30 5d5d 5b0a 2020 2020 2020 2020 2020  [0]][.          
+00014ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014eb0: 2020 6576 616c 5f70 6f6c 6963 790a 2020    eval_policy.  
+00014ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014ed0: 2020 2020 2020 5d5b 226f 6e5f 706f 6c69        ]["on_poli
+00014ee0: 6379 225d 0a0a 2020 2020 2020 2020 2020  cy"]..          
+00014ef0: 2020 2020 2020 6669 6720 3d20 706c 742e        fig = plt.
+00014f00: 6669 6775 7265 2866 6967 7369 7a65 3d28  figure(figsize=(
+00014f10: 3220 2a20 6e5f 6576 616c 5f70 6f6c 6963  2 * n_eval_polic
+00014f20: 6965 732c 2034 202a 206e 5f65 7374 696d  ies, 4 * n_estim
+00014f30: 6174 6f72 7329 290a 0a20 2020 2020 2020  ators))..       
+00014f40: 2020 2020 2020 2020 2066 6f72 2069 2c20           for i, 
+00014f50: 6573 7469 6d61 746f 7220 696e 2065 6e75  estimator in enu
+00014f60: 6d65 7261 7465 2863 6f6d 7061 7265 645f  merate(compared_
+00014f70: 6573 7469 6d61 746f 7273 293a 0a20 2020  estimators):.   
+00014f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014f90: 2069 6620 6920 3d3d 2030 3a0a 2020 2020   if i == 0:.    
+00014fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014fb0: 2020 2020 6178 203d 2061 7830 203d 2066      ax = ax0 = f
+00014fc0: 6967 2e61 6464 5f73 7562 706c 6f74 286e  ig.add_subplot(n
+00014fd0: 5f65 7374 696d 6174 6f72 732c 2031 2c20  _estimators, 1, 
+00014fe0: 6920 2b20 3129 0a20 2020 2020 2020 2020  i + 1).         
+00014ff0: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
+00015000: 7368 6172 6579 3a0a 2020 2020 2020 2020  sharey:.        
+00015010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015020: 6178 203d 2066 6967 2e61 6464 5f73 7562  ax = fig.add_sub
+00015030: 706c 6f74 286e 5f65 7374 696d 6174 6f72  plot(n_estimator
+00015040: 732c 2031 2c20 6920 2b20 312c 2073 6861  s, 1, i + 1, sha
+00015050: 7265 793d 6178 3029 0a20 2020 2020 2020  rey=ax0).       
+00015060: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+00015070: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00015080: 2020 2020 2020 2020 2020 2061 7820 3d20             ax = 
+00015090: 6669 672e 6164 645f 7375 6270 6c6f 7428  fig.add_subplot(
+000150a0: 6e5f 6573 7469 6d61 746f 7273 2c20 312c  n_estimators, 1,
+000150b0: 2069 202b 2031 290a 0a20 2020 2020 2020   i + 1)..       
+000150c0: 2020 2020 2020 2020 2020 2020 2064 6620               df 
+000150d0: 3d20 5b5d 0a20 2020 2020 2020 2020 2020  = [].           
+000150e0: 2020 2020 2020 2020 2066 6f72 2062 6568           for beh
+000150f0: 6176 696f 725f 706f 6c69 6379 2069 6e20  avior_policy in 
+00015100: 6265 6861 7669 6f72 5f70 6f6c 6963 795f  behavior_policy_
+00015110: 6e61 6d65 733a 0a20 2020 2020 2020 2020  names:.         
+00015120: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+00015130: 5f64 6174 6173 6574 7320 3d20 696e 7075  _datasets = inpu
+00015140: 745f 6469 6374 2e6e 5f64 6174 6173 6574  t_dict.n_dataset
+00015150: 735b 6265 6861 7669 6f72 5f70 6f6c 6963  s[behavior_polic
+00015160: 795d 0a0a 2020 2020 2020 2020 2020 2020  y]..            
+00015170: 2020 2020 2020 2020 2020 2020 6466 5f20              df_ 
+00015180: 3d20 4461 7461 4672 616d 6528 290a 2020  = DataFrame().  
+00015190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000151a0: 2020 2020 2020 666f 7220 6a2c 2065 7661        for j, eva
+000151b0: 6c5f 706f 6c69 6379 2069 6e20 656e 756d  l_policy in enum
+000151c0: 6572 6174 6528 696e 7075 745f 6469 6374  erate(input_dict
+000151d0: 5f30 2e6b 6579 7328 2929 3a0a 2020 2020  _0.keys()):.    
+000151e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000151f0: 2020 2020 2020 2020 6466 5f5b 6576 616c          df_[eval
+00015200: 5f70 6f6c 6963 795d 203d 2070 6f6c 6963  _policy] = polic
+00015210: 795f 7661 6c75 655f 6469 6374 5b62 6568  y_value_dict[beh
+00015220: 6176 696f 725f 706f 6c69 6379 5d5b 0a20  avior_policy][. 
+00015230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015240: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00015250: 7661 6c5f 706f 6c69 6379 0a20 2020 2020  val_policy.     
+00015260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015270: 2020 2020 2020 205d 5b65 7374 696d 6174         ][estimat
+00015280: 6f72 5d0a 0a20 2020 2020 2020 2020 2020  or]..           
+00015290: 2020 2020 2020 2020 2020 2020 2064 665f               df_
+000152a0: 5b22 6461 7461 7365 745f 6964 225d 203d  ["dataset_id"] =
+000152b0: 206e 702e 6172 616e 6765 286e 5f64 6174   np.arange(n_dat
+000152c0: 6173 6574 7329 0a20 2020 2020 2020 2020  asets).         
+000152d0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+000152e0: 665f 203d 2070 642e 6d65 6c74 280a 2020  f_ = pd.melt(.  
 000152f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015300: 2020 2020 2020 2064 665f 5b22 6461 7461         df_["data
-00015310: 7365 745f 6964 225d 203d 206e 702e 6172  set_id"] = np.ar
-00015320: 616e 6765 286e 5f64 6174 6173 6574 7329  ange(n_datasets)
-00015330: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00015340: 2020 2020 2020 2020 2064 665f 203d 2070           df_ = p
-00015350: 642e 6d65 6c74 280a 2020 2020 2020 2020  d.melt(.        
-00015360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015370: 2020 2020 6466 5f2c 0a20 2020 2020 2020      df_,.       
+00015300: 2020 2020 2020 2020 2020 6466 5f2c 0a20            df_,. 
+00015310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015320: 2020 2020 2020 2020 2020 2069 645f 7661             id_va
+00015330: 7273 3d5b 2264 6174 6173 6574 5f69 6422  rs=["dataset_id"
+00015340: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+00015350: 2020 2020 2020 2020 2020 2020 2020 2076                 v
+00015360: 6172 5f6e 616d 653d 2265 7661 6c5f 706f  ar_name="eval_po
+00015370: 6c69 6379 222c 0a20 2020 2020 2020 2020  licy",.         
 00015380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015390: 2020 2020 2069 645f 7661 7273 3d5b 2264       id_vars=["d
-000153a0: 6174 6173 6574 5f69 6422 5d2c 0a20 2020  ataset_id"],.   
+00015390: 2020 2076 616c 7565 5f6e 616d 653d 2270     value_name="p
+000153a0: 6f6c 6963 795f 7661 6c75 6522 2c0a 2020  olicy_value",.  
 000153b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000153c0: 2020 2020 2020 2020 2076 6172 5f6e 616d           var_nam
-000153d0: 653d 2265 7661 6c5f 706f 6c69 6379 222c  e="eval_policy",
-000153e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000153f0: 2020 2020 2020 2020 2020 2020 2076 616c               val
-00015400: 7565 5f6e 616d 653d 2270 6f6c 6963 795f  ue_name="policy_
-00015410: 7661 6c75 6522 2c0a 2020 2020 2020 2020  value",.        
-00015420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015430: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00015440: 2020 2020 2020 2020 2020 6466 5f5b 2262            df_["b
-00015450: 6568 6176 696f 725f 706f 6c69 6379 225d  ehavior_policy"]
-00015460: 203d 2062 6568 6176 696f 725f 706f 6c69   = behavior_poli
-00015470: 6379 0a20 2020 2020 2020 2020 2020 2020  cy.             
-00015480: 2020 2020 2020 2020 2020 2064 662e 6170             df.ap
-00015490: 7065 6e64 2864 665f 290a 0a20 2020 2020  pend(df_)..     
-000154a0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-000154b0: 6620 3d20 7064 2e63 6f6e 6361 7428 6466  f = pd.concat(df
-000154c0: 2c20 6178 6973 3d30 290a 2020 2020 2020  , axis=0).      
-000154d0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-000154e0: 2028 6466 5b22 706f 6c69 6379 5f76 616c   (df["policy_val
-000154f0: 7565 225d 203e 2031 6531 3029 2e73 756d  ue"] > 1e10).sum
-00015500: 2829 202b 2028 0a20 2020 2020 2020 2020  () + (.         
-00015510: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-00015520: 665b 2270 6f6c 6963 795f 7661 6c75 6522  f["policy_value"
-00015530: 5d20 3c20 2d31 6531 300a 2020 2020 2020  ] < -1e10.      
-00015540: 2020 2020 2020 2020 2020 2020 2020 292e                ).
-00015550: 7375 6d28 2920 3e20 303a 0a20 2020 2020  sum() > 0:.     
-00015560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015570: 2020 2077 6172 6e28 0a20 2020 2020 2020     warn(.       
-00015580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015590: 2020 2020 2022 466f 756e 6420 6120 6c61       "Found a la
-000155a0: 7267 6520 6162 736f 6c75 7465 2076 616c  rge absolute val
-000155b0: 7565 2069 6e20 7468 6520 706f 6c69 6379  ue in the policy
-000155c0: 2076 616c 7565 2065 7374 696d 6174 652e   value estimate.
-000155d0: 2054 6865 2076 616c 7565 206d 6f72 6520   The value more 
-000155e0: 7468 616e 2031 6531 3020 616e 6420 6c65  than 1e10 and le
-000155f0: 7373 2074 6861 6e20 2d31 6531 3020 7769  ss than -1e10 wi
-00015600: 6c6c 2062 6520 7265 706c 6163 6564 2074  ll be replaced t
-00015610: 6f20 6e70 2e6e 616e 2e22 0a20 2020 2020  o np.nan.".     
-00015620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015630: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-00015640: 2020 2020 2020 2020 2020 2020 2064 665b               df[
-00015650: 2270 6f6c 6963 795f 7661 6c75 6522 5d20  "policy_value"] 
-00015660: 3d20 6466 5b22 706f 6c69 6379 5f76 616c  = df["policy_val
-00015670: 7565 225d 2e6d 6173 6b28 0a20 2020 2020  ue"].mask(.     
-00015680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015690: 2020 2020 2020 2064 665b 2270 6f6c 6963         df["polic
-000156a0: 795f 7661 6c75 6522 5d20 3e20 3165 2d31  y_value"] > 1e-1
-000156b0: 302c 206e 702e 6e61 6e0a 2020 2020 2020  0, np.nan.      
-000156c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000156d0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-000156e0: 2020 2020 2020 2020 2020 2020 6466 5b22              df["
-000156f0: 706f 6c69 6379 5f76 616c 7565 225d 203d  policy_value"] =
-00015700: 2064 665b 2270 6f6c 6963 795f 7661 6c75   df["policy_valu
-00015710: 6522 5d2e 6d61 736b 280a 2020 2020 2020  e"].mask(.      
-00015720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015730: 2020 2020 2020 6466 5b22 706f 6c69 6379        df["policy
-00015740: 5f76 616c 7565 225d 203c 202d 3165 2d31  _value"] < -1e-1
-00015750: 302c 206e 702e 6e61 6e0a 2020 2020 2020  0, np.nan.      
+000153c0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+000153d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000153e0: 6466 5f5b 2262 6568 6176 696f 725f 706f  df_["behavior_po
+000153f0: 6c69 6379 225d 203d 2062 6568 6176 696f  licy"] = behavio
+00015400: 725f 706f 6c69 6379 0a20 2020 2020 2020  r_policy.       
+00015410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015420: 2064 662e 6170 7065 6e64 2864 665f 290a   df.append(df_).
+00015430: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00015440: 2020 2020 2064 6620 3d20 7064 2e63 6f6e       df = pd.con
+00015450: 6361 7428 6466 2c20 6178 6973 3d30 290a  cat(df, axis=0).
+00015460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015470: 2020 2020 6966 2028 6466 5b22 706f 6c69      if (df["poli
+00015480: 6379 5f76 616c 7565 225d 203e 2031 6531  cy_value"] > 1e1
+00015490: 3029 2e73 756d 2829 202b 2028 0a20 2020  0).sum() + (.   
+000154a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000154b0: 2020 2020 2064 665b 2270 6f6c 6963 795f       df["policy_
+000154c0: 7661 6c75 6522 5d20 3c20 2d31 6531 300a  value"] < -1e10.
+000154d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000154e0: 2020 2020 292e 7375 6d28 2920 3e20 303a      ).sum() > 0:
+000154f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00015500: 2020 2020 2020 2020 2077 6172 6e28 0a20           warn(. 
+00015510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015520: 2020 2020 2020 2020 2020 2022 466f 756e             "Foun
+00015530: 6420 6120 6c61 7267 6520 6162 736f 6c75  d a large absolu
+00015540: 7465 2076 616c 7565 2069 6e20 7468 6520  te value in the 
+00015550: 706f 6c69 6379 2076 616c 7565 2065 7374  policy value est
+00015560: 696d 6174 652e 2054 6865 2076 616c 7565  imate. The value
+00015570: 206d 6f72 6520 7468 616e 2031 6531 3020   more than 1e10 
+00015580: 616e 6420 6c65 7373 2074 6861 6e20 2d31  and less than -1
+00015590: 6531 3020 7769 6c6c 2062 6520 7265 706c  e10 will be repl
+000155a0: 6163 6564 2074 6f20 6e70 2e6e 616e 2e22  aced to np.nan."
+000155b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000155c0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+000155d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000155e0: 2020 2064 665b 2270 6f6c 6963 795f 7661     df["policy_va
+000155f0: 6c75 6522 5d20 3d20 6466 5b22 706f 6c69  lue"] = df["poli
+00015600: 6379 5f76 616c 7565 225d 2e6d 6173 6b28  cy_value"].mask(
+00015610: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00015620: 2020 2020 2020 2020 2020 2020 2064 665b               df[
+00015630: 2270 6f6c 6963 795f 7661 6c75 6522 5d20  "policy_value"] 
+00015640: 3e20 3165 2d31 302c 206e 702e 6e61 6e0a  > 1e-10, np.nan.
+00015650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015660: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00015670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015680: 2020 6466 5b22 706f 6c69 6379 5f76 616c    df["policy_val
+00015690: 7565 225d 203d 2064 665b 2270 6f6c 6963  ue"] = df["polic
+000156a0: 795f 7661 6c75 6522 5d2e 6d61 736b 280a  y_value"].mask(.
+000156b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000156c0: 2020 2020 2020 2020 2020 2020 6466 5b22              df["
+000156d0: 706f 6c69 6379 5f76 616c 7565 225d 203c  policy_value"] <
+000156e0: 202d 3165 2d31 302c 206e 702e 6e61 6e0a   -1e-10, np.nan.
+000156f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015700: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+00015710: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00015720: 6620 706c 6f74 5f74 7970 6520 3d3d 2022  f plot_type == "
+00015730: 6369 223a 0a20 2020 2020 2020 2020 2020  ci":.           
+00015740: 2020 2020 2020 2020 2020 2020 2073 6e73               sns
+00015750: 2e62 6172 706c 6f74 280a 2020 2020 2020  .barplot(.      
 00015760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015770: 2020 290a 0a20 2020 2020 2020 2020 2020    )..           
-00015780: 2020 2020 2020 2020 2069 6620 706c 6f74           if plot
-00015790: 5f74 7970 6520 3d3d 2022 6369 223a 0a20  _type == "ci":. 
-000157a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000157b0: 2020 2020 2020 2073 6e73 2e62 6172 706c         sns.barpl
-000157c0: 6f74 280a 2020 2020 2020 2020 2020 2020  ot(.            
-000157d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000157e0: 6461 7461 3d64 662c 0a20 2020 2020 2020  data=df,.       
-000157f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015800: 2020 2020 2078 3d22 6576 616c 5f70 6f6c       x="eval_pol
-00015810: 6963 7922 2c0a 2020 2020 2020 2020 2020  icy",.          
-00015820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015830: 2020 793d 2270 6f6c 6963 795f 7661 6c75    y="policy_valu
-00015840: 6522 2c0a 2020 2020 2020 2020 2020 2020  e",.            
-00015850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015860: 6875 653d 2262 6568 6176 696f 725f 706f  hue="behavior_po
-00015870: 6c69 6379 222c 0a20 2020 2020 2020 2020  licy",.         
-00015880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015890: 2020 2070 616c 6574 7465 3d70 616c 6574     palette=palet
-000158a0: 7465 2c0a 2020 2020 2020 2020 2020 2020  te,.            
+00015770: 2020 2020 2020 6461 7461 3d64 662c 0a20        data=df,. 
+00015780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015790: 2020 2020 2020 2020 2020 2078 3d22 6576             x="ev
+000157a0: 616c 5f70 6f6c 6963 7922 2c0a 2020 2020  al_policy",.    
+000157b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000157c0: 2020 2020 2020 2020 793d 2270 6f6c 6963          y="polic
+000157d0: 795f 7661 6c75 6522 2c0a 2020 2020 2020  y_value",.      
+000157e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000157f0: 2020 2020 2020 6875 653d 2262 6568 6176        hue="behav
+00015800: 696f 725f 706f 6c69 6379 222c 0a20 2020  ior_policy",.   
+00015810: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015820: 2020 2020 2020 2020 2070 616c 6574 7465           palette
+00015830: 3d70 616c 6574 7465 2c0a 2020 2020 2020  =palette,.      
+00015840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015850: 2020 2020 2020 6178 3d61 782c 0a20 2020        ax=ax,.   
+00015860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015870: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+00015880: 2020 2020 2020 2020 2020 2020 656c 6966              elif
+00015890: 2070 6c6f 745f 7479 7065 203d 3d20 2276   plot_type == "v
+000158a0: 696f 6c69 6e22 3a0a 2020 2020 2020 2020  iolin":.        
 000158b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000158c0: 6178 3d61 782c 0a20 2020 2020 2020 2020  ax=ax,.         
-000158d0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-000158e0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000158f0: 2020 2020 2020 656c 6966 2070 6c6f 745f        elif plot_
-00015900: 7479 7065 203d 3d20 2276 696f 6c69 6e22  type == "violin"
-00015910: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00015920: 2020 2020 2020 2020 2020 736e 732e 7669            sns.vi
-00015930: 6f6c 696e 706c 6f74 280a 2020 2020 2020  olinplot(.      
-00015940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015950: 2020 2020 2020 6461 7461 3d64 662c 0a20        data=df,. 
-00015960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015970: 2020 2020 2020 2020 2020 2078 3d22 6576             x="ev
-00015980: 616c 5f70 6f6c 6963 7922 2c0a 2020 2020  al_policy",.    
-00015990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000159a0: 2020 2020 2020 2020 793d 2270 6f6c 6963          y="polic
-000159b0: 795f 7661 6c75 6522 2c0a 2020 2020 2020  y_value",.      
-000159c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000159d0: 2020 2020 2020 6875 653d 2262 6568 6176        hue="behav
-000159e0: 696f 725f 706f 6c69 6379 222c 0a20 2020  ior_policy",.   
-000159f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015a00: 2020 2020 2020 2020 2073 6361 6c65 3d22           scale="
-00015a10: 7769 6474 6822 2c0a 2020 2020 2020 2020  width",.        
-00015a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015a30: 2020 2020 7769 6474 683d 302e 382c 0a20      width=0.8,. 
+000158c0: 736e 732e 7669 6f6c 696e 706c 6f74 280a  sns.violinplot(.
+000158d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000158e0: 2020 2020 2020 2020 2020 2020 6461 7461              data
+000158f0: 3d64 662c 0a20 2020 2020 2020 2020 2020  =df,.           
+00015900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015910: 2078 3d22 6576 616c 5f70 6f6c 6963 7922   x="eval_policy"
+00015920: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00015930: 2020 2020 2020 2020 2020 2020 2020 793d                y=
+00015940: 2270 6f6c 6963 795f 7661 6c75 6522 2c0a  "policy_value",.
+00015950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015960: 2020 2020 2020 2020 2020 2020 6875 653d              hue=
+00015970: 2262 6568 6176 696f 725f 706f 6c69 6379  "behavior_policy
+00015980: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00015990: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+000159a0: 6361 6c65 3d22 7769 6474 6822 2c0a 2020  cale="width",.  
+000159b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000159c0: 2020 2020 2020 2020 2020 7769 6474 683d            width=
+000159d0: 302e 382c 0a20 2020 2020 2020 2020 2020  0.8,.           
+000159e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000159f0: 2070 616c 6574 7465 3d70 616c 6574 7465   palette=palette
+00015a00: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00015a10: 2020 2020 2020 2020 2020 2020 2020 6178                ax
+00015a20: 3d61 782c 0a20 2020 2020 2020 2020 2020  =ax,.           
+00015a30: 2020 2020 2020 2020 2020 2020 2029 0a0a               )..
 00015a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015a50: 2020 2020 2020 2020 2020 2070 616c 6574             palet
-00015a60: 7465 3d70 616c 6574 7465 2c0a 2020 2020  te=palette,.    
-00015a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015a80: 2020 2020 2020 2020 6178 3d61 782c 0a20          ax=ax,. 
-00015a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015aa0: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-00015ab0: 2020 2020 2020 2020 2020 2020 2020 656c                el
-00015ac0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00015ad0: 2020 2020 2020 2020 2020 2020 7472 793a              try:
-00015ae0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00015af0: 2020 2020 2020 2020 2020 2020 2073 6e73               sns
-00015b00: 2e73 7761 726d 706c 6f74 280a 2020 2020  .swarmplot(.    
-00015b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015b20: 2020 2020 2020 2020 2020 2020 6461 7461              data
-00015b30: 3d64 662c 0a20 2020 2020 2020 2020 2020  =df,.           
-00015b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015b50: 2020 2020 2078 3d22 6576 616c 5f70 6f6c       x="eval_pol
-00015b60: 6963 7922 2c0a 2020 2020 2020 2020 2020  icy",.          
+00015a50: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00015a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015a70: 2020 7472 793a 0a20 2020 2020 2020 2020    try:.         
+00015a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015a90: 2020 2073 6e73 2e73 7761 726d 706c 6f74     sns.swarmplot
+00015aa0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00015ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015ac0: 2020 6461 7461 3d64 662c 0a20 2020 2020    data=df,.     
+00015ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015ae0: 2020 2020 2020 2020 2020 2078 3d22 6576             x="ev
+00015af0: 616c 5f70 6f6c 6963 7922 2c0a 2020 2020  al_policy",.    
+00015b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015b10: 2020 2020 2020 2020 2020 2020 793d 2270              y="p
+00015b20: 6f6c 6963 795f 7661 6c75 6522 2c0a 2020  olicy_value",.  
+00015b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015b40: 2020 2020 2020 2020 2020 2020 2020 6875                hu
+00015b50: 653d 2262 6568 6176 696f 725f 706f 6c69  e="behavior_poli
+00015b60: 6379 222c 0a20 2020 2020 2020 2020 2020  cy",.           
 00015b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015b80: 2020 2020 2020 793d 2270 6f6c 6963 795f        y="policy_
-00015b90: 7661 6c75 6522 2c0a 2020 2020 2020 2020  value",.        
+00015b80: 2020 2020 2070 616c 6574 7465 3d70 616c       palette=pal
+00015b90: 6574 7465 2c0a 2020 2020 2020 2020 2020  ette,.          
 00015ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015bb0: 2020 2020 2020 2020 6875 653d 2262 6568          hue="beh
-00015bc0: 6176 696f 725f 706f 6c69 6379 222c 0a20  avior_policy",. 
-00015bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015be0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00015bf0: 616c 6574 7465 3d70 616c 6574 7465 2c0a  alette=palette,.
+00015bb0: 2020 2020 2020 6178 3d61 782c 0a20 2020        ax=ax,.   
+00015bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015bd0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00015be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015bf0: 2020 2065 7863 6570 743a 0a20 2020 2020     except:.     
 00015c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015c20: 6178 3d61 782c 0a20 2020 2020 2020 2020  ax=ax,.         
-00015c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015c40: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-00015c50: 2020 2020 2020 2020 2020 2020 2065 7863               exc
-00015c60: 6570 743a 0a20 2020 2020 2020 2020 2020  ept:.           
+00015c10: 2020 2020 2020 2077 6172 6e28 2245 6e63         warn("Enc
+00015c20: 6f75 6e74 6572 6564 204e 614e 2076 616c  ountered NaN val
+00015c30: 7565 7320 6475 7269 6e67 2070 6c6f 742e  ues during plot.
+00015c40: 2229 0a0a 2020 2020 2020 2020 2020 2020  ")..            
+00015c50: 2020 2020 2020 2020 6966 2076 6973 7561          if visua
+00015c60: 6c69 7a65 5f6f 6e5f 706f 6c69 6379 3a0a  lize_on_policy:.
 00015c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015c80: 2077 6172 6e28 2245 6e63 6f75 6e74 6572   warn("Encounter
-00015c90: 6564 204e 614e 2076 616c 7565 7320 6475  ed NaN values du
-00015ca0: 7269 6e67 2070 6c6f 742e 2229 0a0a 2020  ring plot.")..  
-00015cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015cc0: 2020 6966 2076 6973 7561 6c69 7a65 5f6f    if visualize_o
-00015cd0: 6e5f 706f 6c69 6379 3a0a 2020 2020 2020  n_policy:.      
-00015ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015cf0: 2020 6178 2e73 6361 7474 6572 280a 2020    ax.scatter(.  
-00015d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015d10: 2020 2020 2020 2020 2020 6e70 2e61 7261            np.ara
-00015d20: 6e67 6528 6e5f 6576 616c 5f70 6f6c 6963  nge(n_eval_polic
-00015d30: 6965 7329 2c0a 2020 2020 2020 2020 2020  ies),.          
-00015d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015d50: 2020 6f6e 5f70 6f6c 6963 792c 0a20 2020    on_policy,.   
-00015d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015d70: 2020 2020 2020 2020 2063 6f6c 6f72 3d22           color="
-00015d80: 626c 6163 6b22 2c0a 2020 2020 2020 2020  black",.        
-00015d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015da0: 2020 2020 6d61 726b 6572 3d22 2a22 2c0a      marker="*",.
-00015db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015dc0: 2020 2020 2020 2020 2020 2020 733d 3135              s=15
-00015dd0: 302c 0a20 2020 2020 2020 2020 2020 2020  0,.             
-00015de0: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
-00015df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015e00: 2020 6966 206c 6567 656e 643a 0a20 2020    if legend:.   
-00015e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015e20: 2020 2020 2061 782e 6c65 6765 6e64 286c       ax.legend(l
-00015e30: 6f63 3d22 6c6f 7765 7220 7269 6768 7422  oc="lower right"
-00015e40: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00015e50: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00015c80: 2020 2020 2020 2020 6178 2e73 6361 7474          ax.scatt
+00015c90: 6572 280a 2020 2020 2020 2020 2020 2020  er(.            
+00015ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015cb0: 6e70 2e61 7261 6e67 6528 6e5f 6576 616c  np.arange(n_eval
+00015cc0: 5f70 6f6c 6963 6965 7329 2c0a 2020 2020  _policies),.    
+00015cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015ce0: 2020 2020 2020 2020 6f6e 5f70 6f6c 6963          on_polic
+00015cf0: 792c 0a20 2020 2020 2020 2020 2020 2020  y,.             
+00015d00: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00015d10: 6f6c 6f72 3d22 626c 6163 6b22 2c0a 2020  olor="black",.  
+00015d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015d30: 2020 2020 2020 2020 2020 6d61 726b 6572            marker
+00015d40: 3d22 2a22 2c0a 2020 2020 2020 2020 2020  ="*",.          
+00015d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015d60: 2020 733d 3135 302c 0a20 2020 2020 2020    s=150,.       
+00015d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015d80: 2029 0a0a 2020 2020 2020 2020 2020 2020   )..            
+00015d90: 2020 2020 2020 2020 6966 206c 6567 656e          if legen
+00015da0: 643a 0a20 2020 2020 2020 2020 2020 2020  d:.             
+00015db0: 2020 2020 2020 2020 2020 2061 782e 6c65             ax.le
+00015dc0: 6765 6e64 286c 6f63 3d22 6c6f 7765 7220  gend(loc="lower 
+00015dd0: 7269 6768 7422 290a 2020 2020 2020 2020  right").        
+00015de0: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00015df0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00015e00: 2020 2020 2020 2020 2020 6178 2e67 6574            ax.get
+00015e10: 5f6c 6567 656e 6428 292e 7265 6d6f 7665  _legend().remove
+00015e20: 2829 0a0a 2020 2020 2020 2020 2020 2020  ()..            
+00015e30: 2020 2020 2020 2020 6178 2e73 6574 5f74          ax.set_t
+00015e40: 6974 6c65 2865 7374 696d 6174 6f72 2c20  itle(estimator, 
+00015e50: 666f 6e74 7369 7a65 3d31 3629 0a20 2020  fontsize=16).   
 00015e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015e70: 2020 2020 6178 2e67 6574 5f6c 6567 656e      ax.get_legen
-00015e80: 6428 292e 7265 6d6f 7665 2829 0a0a 2020  d().remove()..  
-00015e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015ea0: 2020 6178 2e73 6574 5f74 6974 6c65 2865    ax.set_title(e
-00015eb0: 7374 696d 6174 6f72 2c20 666f 6e74 7369  stimator, fontsi
-00015ec0: 7a65 3d31 3629 0a20 2020 2020 2020 2020  ze=16).         
-00015ed0: 2020 2020 2020 2020 2020 2061 782e 7365             ax.se
-00015ee0: 745f 786c 6162 656c 2822 2229 0a20 2020  t_xlabel("").   
-00015ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015f00: 2061 782e 7365 745f 796c 6162 656c 280a   ax.set_ylabel(.
-00015f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015f20: 2020 2020 2020 2020 6622 4573 7469 6d61          f"Estima
-00015f30: 7465 6420 506f 6c69 6379 2056 616c 7565  ted Policy Value
-00015f40: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-00015f50: 2020 2020 2020 2020 2020 2066 6f6e 7473             fonts
-00015f60: 697a 653d 3132 2c0a 2020 2020 2020 2020  ize=12,.        
-00015f70: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00015f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015f90: 2020 6178 2e73 6574 5f78 7469 636b 7328    ax.set_xticks(
-00015fa0: 6e70 2e61 7261 6e67 6528 6e5f 6576 616c  np.arange(n_eval
-00015fb0: 5f70 6f6c 6963 6965 7329 2c20 6c69 7374  _policies), list
-00015fc0: 2869 6e70 7574 5f64 6963 745f 302e 6b65  (input_dict_0.ke
-00015fd0: 7973 2829 2929 0a20 2020 2020 2020 2020  ys())).         
-00015fe0: 2020 2020 2020 2020 2020 2070 6c74 2e79             plt.y
-00015ff0: 7469 636b 7328 666f 6e74 7369 7a65 3d31  ticks(fontsize=1
-00016000: 3229 0a20 2020 2020 2020 2020 2020 2020  2).             
-00016010: 2020 2020 2020 2070 6c74 2e78 7469 636b         plt.xtick
-00016020: 7328 666f 6e74 7369 7a65 3d31 3229 0a0a  s(fontsize=12)..
-00016030: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00016040: 2020 2020 2020 2020 2020 6e5f 6461 7461            n_data
-00016050: 7365 7473 203d 2069 6e70 7574 5f64 6963  sets = input_dic
-00016060: 742e 6e5f 6461 7461 7365 7473 5b62 6568  t.n_datasets[beh
-00016070: 6176 696f 725f 706f 6c69 6379 5f6e 616d  avior_policy_nam
-00016080: 655d 0a0a 2020 2020 2020 2020 2020 2020  e]..            
-00016090: 6966 2068 7565 203d 3d20 2265 7374 696d  if hue == "estim
-000160a0: 6174 6f72 223a 0a20 2020 2020 2020 2020  ator":.         
-000160b0: 2020 2020 2020 2066 6967 203d 2070 6c74         fig = plt
-000160c0: 2e66 6967 7572 6528 6669 6773 697a 653d  .figure(figsize=
-000160d0: 2832 202a 206e 5f65 7374 696d 6174 6f72  (2 * n_estimator
-000160e0: 732c 2034 202a 206e 5f65 7661 6c5f 706f  s, 4 * n_eval_po
-000160f0: 6c69 6369 6573 2929 0a0a 2020 2020 2020  licies))..      
-00016100: 2020 2020 2020 2020 2020 7061 6c65 7474            palett
-00016110: 6520 3d20 7b7d 0a20 2020 2020 2020 2020  e = {}.         
-00016120: 2020 2020 2020 2066 6f72 206a 2c20 6573         for j, es
-00016130: 7469 6d61 746f 7220 696e 2065 6e75 6d65  timator in enume
-00016140: 7261 7465 2863 6f6d 7061 7265 645f 6573  rate(compared_es
-00016150: 7469 6d61 746f 7273 293a 0a20 2020 2020  timators):.     
-00016160: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00016170: 616c 6574 7465 5b65 7374 696d 6174 6f72  alette[estimator
-00016180: 5d20 3d20 636f 6c6f 725b 6a20 2520 6e5f  ] = color[j % n_
-00016190: 636f 6c6f 7273 5d0a 0a20 2020 2020 2020  colors]..       
-000161a0: 2020 2020 2020 2020 2066 6f72 2069 2c20           for i, 
-000161b0: 6576 616c 5f70 6f6c 6963 7920 696e 2065  eval_policy in e
-000161c0: 6e75 6d65 7261 7465 2869 6e70 7574 5f64  numerate(input_d
-000161d0: 6963 745f 302e 6b65 7973 2829 293a 0a20  ict_0.keys()):. 
-000161e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000161f0: 2020 2069 6620 6920 3d3d 2030 3a0a 2020     if i == 0:.  
-00016200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016210: 2020 2020 2020 6178 203d 2061 7830 203d        ax = ax0 =
-00016220: 2066 6967 2e61 6464 5f73 7562 706c 6f74   fig.add_subplot
-00016230: 286e 5f65 7661 6c5f 706f 6c69 6369 6573  (n_eval_policies
-00016240: 2c20 312c 2069 202b 2031 290a 2020 2020  , 1, i + 1).    
-00016250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016260: 656c 6966 2073 6861 7265 793a 0a20 2020  elif sharey:.   
-00016270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016280: 2020 2020 2061 7820 3d20 6669 672e 6164       ax = fig.ad
-00016290: 645f 7375 6270 6c6f 7428 6e5f 6576 616c  d_subplot(n_eval
-000162a0: 5f70 6f6c 6963 6965 732c 2031 2c20 6920  _policies, 1, i 
-000162b0: 2b20 312c 2073 6861 7265 793d 6178 3029  + 1, sharey=ax0)
-000162c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000162d0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00015e70: 2061 782e 7365 745f 786c 6162 656c 2822   ax.set_xlabel("
+00015e80: 2229 0a20 2020 2020 2020 2020 2020 2020  ").             
+00015e90: 2020 2020 2020 2061 782e 7365 745f 796c         ax.set_yl
+00015ea0: 6162 656c 280a 2020 2020 2020 2020 2020  abel(.          
+00015eb0: 2020 2020 2020 2020 2020 2020 2020 6622                f"
+00015ec0: 4573 7469 6d61 7465 6420 506f 6c69 6379  Estimated Policy
+00015ed0: 2056 616c 7565 222c 0a20 2020 2020 2020   Value",.       
+00015ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015ef0: 2066 6f6e 7473 697a 653d 3132 2c0a 2020   fontsize=12,.  
+00015f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015f10: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+00015f20: 2020 2020 2020 2020 6178 2e73 6574 5f78          ax.set_x
+00015f30: 7469 636b 7328 6e70 2e61 7261 6e67 6528  ticks(np.arange(
+00015f40: 6e5f 6576 616c 5f70 6f6c 6963 6965 7329  n_eval_policies)
+00015f50: 2c20 6c69 7374 2869 6e70 7574 5f64 6963  , list(input_dic
+00015f60: 745f 302e 6b65 7973 2829 2929 0a20 2020  t_0.keys())).   
+00015f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015f80: 2070 6c74 2e79 7469 636b 7328 666f 6e74   plt.yticks(font
+00015f90: 7369 7a65 3d31 3229 0a20 2020 2020 2020  size=12).       
+00015fa0: 2020 2020 2020 2020 2020 2020 2070 6c74               plt
+00015fb0: 2e78 7469 636b 7328 666f 6e74 7369 7a65  .xticks(fontsize
+00015fc0: 3d31 3229 0a0a 2020 2020 2020 2020 656c  =12)..        el
+00015fd0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00015fe0: 6e5f 6461 7461 7365 7473 203d 2069 6e70  n_datasets = inp
+00015ff0: 7574 5f64 6963 742e 6e5f 6461 7461 7365  ut_dict.n_datase
+00016000: 7473 5b62 6568 6176 696f 725f 706f 6c69  ts[behavior_poli
+00016010: 6379 5f6e 616d 655d 0a0a 2020 2020 2020  cy_name]..      
+00016020: 2020 2020 2020 6966 2068 7565 203d 3d20        if hue == 
+00016030: 2265 7374 696d 6174 6f72 223a 0a20 2020  "estimator":.   
+00016040: 2020 2020 2020 2020 2020 2020 2066 6967               fig
+00016050: 203d 2070 6c74 2e66 6967 7572 6528 6669   = plt.figure(fi
+00016060: 6773 697a 653d 2832 202a 206e 5f65 7374  gsize=(2 * n_est
+00016070: 696d 6174 6f72 732c 2034 202a 206e 5f65  imators, 4 * n_e
+00016080: 7661 6c5f 706f 6c69 6369 6573 2929 0a0a  val_policies))..
+00016090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000160a0: 7061 6c65 7474 6520 3d20 7b7d 0a20 2020  palette = {}.   
+000160b0: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+000160c0: 206a 2c20 6573 7469 6d61 746f 7220 696e   j, estimator in
+000160d0: 2065 6e75 6d65 7261 7465 2863 6f6d 7061   enumerate(compa
+000160e0: 7265 645f 6573 7469 6d61 746f 7273 293a  red_estimators):
+000160f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00016100: 2020 2020 2070 616c 6574 7465 5b65 7374       palette[est
+00016110: 696d 6174 6f72 5d20 3d20 636f 6c6f 725b  imator] = color[
+00016120: 6a20 2520 6e5f 636f 6c6f 7273 5d0a 0a20  j % n_colors].. 
+00016130: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00016140: 6f72 2069 2c20 6576 616c 5f70 6f6c 6963  or i, eval_polic
+00016150: 7920 696e 2065 6e75 6d65 7261 7465 2869  y in enumerate(i
+00016160: 6e70 7574 5f64 6963 745f 302e 6b65 7973  nput_dict_0.keys
+00016170: 2829 293a 0a20 2020 2020 2020 2020 2020  ()):.           
+00016180: 2020 2020 2020 2020 2069 6620 6920 3d3d           if i ==
+00016190: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
+000161a0: 2020 2020 2020 2020 2020 2020 6178 203d              ax =
+000161b0: 2061 7830 203d 2066 6967 2e61 6464 5f73   ax0 = fig.add_s
+000161c0: 7562 706c 6f74 286e 5f65 7661 6c5f 706f  ubplot(n_eval_po
+000161d0: 6c69 6369 6573 2c20 312c 2069 202b 2031  licies, 1, i + 1
+000161e0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+000161f0: 2020 2020 2020 656c 6966 2073 6861 7265        elif share
+00016200: 793a 0a20 2020 2020 2020 2020 2020 2020  y:.             
+00016210: 2020 2020 2020 2020 2020 2061 7820 3d20             ax = 
+00016220: 6669 672e 6164 645f 7375 6270 6c6f 7428  fig.add_subplot(
+00016230: 6e5f 6576 616c 5f70 6f6c 6963 6965 732c  n_eval_policies,
+00016240: 2031 2c20 6920 2b20 312c 2073 6861 7265   1, i + 1, share
+00016250: 793d 6178 3029 0a20 2020 2020 2020 2020  y=ax0).         
+00016260: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00016270: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00016280: 2020 2020 2020 2020 2061 7820 3d20 6669           ax = fi
+00016290: 672e 6164 645f 7375 6270 6c6f 7428 6e5f  g.add_subplot(n_
+000162a0: 6576 616c 5f70 6f6c 6963 6965 732c 2031  eval_policies, 1
+000162b0: 2c20 6920 2b20 3129 0a0a 2020 2020 2020  , i + 1)..      
+000162c0: 2020 2020 2020 2020 2020 2020 2020 6466                df
+000162d0: 203d 2044 6174 6146 7261 6d65 2829 0a20   = DataFrame(). 
 000162e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000162f0: 2020 2061 7820 3d20 6669 672e 6164 645f     ax = fig.add_
-00016300: 7375 6270 6c6f 7428 6e5f 6576 616c 5f70  subplot(n_eval_p
-00016310: 6f6c 6963 6965 732c 2031 2c20 6920 2b20  olicies, 1, i + 
-00016320: 3129 0a0a 2020 2020 2020 2020 2020 2020  1)..            
-00016330: 2020 2020 2020 2020 6466 203d 2044 6174          df = Dat
-00016340: 6146 7261 6d65 2829 0a20 2020 2020 2020  aFrame().       
-00016350: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-00016360: 206a 2c20 6573 7469 6d61 746f 7220 696e   j, estimator in
-00016370: 2065 6e75 6d65 7261 7465 2863 6f6d 7061   enumerate(compa
-00016380: 7265 645f 6573 7469 6d61 746f 7273 293a  red_estimators):
-00016390: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000163a0: 2020 2020 2020 2020 2064 665b 6573 7469           df[esti
-000163b0: 6d61 746f 725d 203d 2070 6f6c 6963 795f  mator] = policy_
-000163c0: 7661 6c75 655f 6469 6374 5b65 7661 6c5f  value_dict[eval_
-000163d0: 706f 6c69 6379 5d5b 6573 7469 6d61 746f  policy][estimato
-000163e0: 725d 0a0a 2020 2020 2020 2020 2020 2020  r]..            
-000163f0: 2020 2020 2020 2020 6466 5b22 6461 7461          df["data
-00016400: 7365 745f 6964 225d 203d 206e 702e 6172  set_id"] = np.ar
-00016410: 616e 6765 286e 5f64 6174 6173 6574 7329  ange(n_datasets)
-00016420: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00016430: 2020 2020 2064 6620 3d20 7064 2e6d 656c       df = pd.mel
-00016440: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
-00016450: 2020 2020 2020 2020 2020 2064 662c 0a20             df,. 
-00016460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016470: 2020 2020 2020 2069 645f 7661 7273 3d5b         id_vars=[
-00016480: 2264 6174 6173 6574 5f69 6422 5d2c 0a20  "dataset_id"],. 
-00016490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000164a0: 2020 2020 2020 2076 6172 5f6e 616d 653d         var_name=
-000164b0: 2265 7374 696d 6174 6f72 222c 0a20 2020  "estimator",.   
-000164c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000164d0: 2020 2020 2076 616c 7565 5f6e 616d 653d       value_name=
-000164e0: 2270 6f6c 6963 795f 7661 6c75 6522 2c0a  "policy_value",.
-000164f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016500: 2020 2020 290a 0a20 2020 2020 2020 2020      )..         
-00016510: 2020 2020 2020 2020 2020 2069 6620 2864             if (d
-00016520: 665b 2270 6f6c 6963 795f 7661 6c75 6522  f["policy_value"
-00016530: 5d20 3e20 3165 3130 292e 7375 6d28 2920  ] > 1e10).sum() 
-00016540: 2b20 280a 2020 2020 2020 2020 2020 2020  + (.            
-00016550: 2020 2020 2020 2020 2020 2020 6466 5b22              df["
-00016560: 706f 6c69 6379 5f76 616c 7565 225d 203c  policy_value"] <
-00016570: 202d 3165 3130 0a20 2020 2020 2020 2020   -1e10.         
-00016580: 2020 2020 2020 2020 2020 2029 2e73 756d             ).sum
-00016590: 2829 203e 2030 3a0a 2020 2020 2020 2020  () > 0:.        
-000165a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000165b0: 7761 726e 280a 2020 2020 2020 2020 2020  warn(.          
-000165c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000165d0: 2020 2246 6f75 6e64 2061 206c 6172 6765    "Found a large
-000165e0: 2061 6273 6f6c 7574 6520 7661 6c75 6520   absolute value 
-000165f0: 696e 2074 6865 2070 6f6c 6963 7920 7661  in the policy va
-00016600: 6c75 6520 6573 7469 6d61 7465 2e20 5468  lue estimate. Th
-00016610: 6520 7661 6c75 6520 6d6f 7265 2074 6861  e value more tha
-00016620: 6e20 3165 3130 2061 6e64 206c 6573 7320  n 1e10 and less 
-00016630: 7468 616e 202d 3165 3130 2077 696c 6c20  than -1e10 will 
-00016640: 6265 2072 6570 6c61 6365 6420 746f 206e  be replaced to n
-00016650: 702e 6e61 6e2e 220a 2020 2020 2020 2020  p.nan.".        
-00016660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016670: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00016680: 2020 2020 2020 2020 2020 6466 5b22 706f            df["po
-00016690: 6c69 6379 5f76 616c 7565 225d 203d 2064  licy_value"] = d
-000166a0: 665b 2270 6f6c 6963 795f 7661 6c75 6522  f["policy_value"
-000166b0: 5d2e 6d61 736b 280a 2020 2020 2020 2020  ].mask(.        
-000166c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000166d0: 2020 2020 6466 5b22 706f 6c69 6379 5f76      df["policy_v
-000166e0: 616c 7565 225d 203e 2031 652d 3130 2c20  alue"] > 1e-10, 
-000166f0: 6e70 2e6e 616e 0a20 2020 2020 2020 2020  np.nan.         
-00016700: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-00016710: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00016720: 2020 2020 2020 2020 2064 665b 2270 6f6c           df["pol
-00016730: 6963 795f 7661 6c75 6522 5d20 3d20 6466  icy_value"] = df
-00016740: 5b22 706f 6c69 6379 5f76 616c 7565 225d  ["policy_value"]
-00016750: 2e6d 6173 6b28 0a20 2020 2020 2020 2020  .mask(.         
-00016760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016770: 2020 2064 665b 2270 6f6c 6963 795f 7661     df["policy_va
-00016780: 6c75 6522 5d20 3c20 2d31 652d 3130 2c20  lue"] < -1e-10, 
-00016790: 6e70 2e6e 616e 0a20 2020 2020 2020 2020  np.nan.         
-000167a0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-000167b0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000167c0: 2020 2020 2020 6966 2070 6c6f 745f 7479        if plot_ty
-000167d0: 7065 203d 3d20 2263 6922 3a0a 2020 2020  pe == "ci":.    
-000167e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000167f0: 2020 2020 736e 732e 6261 7270 6c6f 7428      sns.barplot(
-00016800: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00016810: 2020 2020 2020 2020 2020 2020 2064 6174               dat
-00016820: 613d 6466 2c0a 2020 2020 2020 2020 2020  a=df,.          
-00016830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016840: 2020 783d 2265 7374 696d 6174 6f72 222c    x="estimator",
-00016850: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00016860: 2020 2020 2020 2020 2020 2020 2079 3d22               y="
-00016870: 706f 6c69 6379 5f76 616c 7565 222c 0a20  policy_value",. 
+000162f0: 2020 2066 6f72 206a 2c20 6573 7469 6d61     for j, estima
+00016300: 746f 7220 696e 2065 6e75 6d65 7261 7465  tor in enumerate
+00016310: 2863 6f6d 7061 7265 645f 6573 7469 6d61  (compared_estima
+00016320: 746f 7273 293a 0a20 2020 2020 2020 2020  tors):.         
+00016330: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+00016340: 665b 6573 7469 6d61 746f 725d 203d 2070  f[estimator] = p
+00016350: 6f6c 6963 795f 7661 6c75 655f 6469 6374  olicy_value_dict
+00016360: 5b65 7661 6c5f 706f 6c69 6379 5d5b 6573  [eval_policy][es
+00016370: 7469 6d61 746f 725d 0a0a 2020 2020 2020  timator]..      
+00016380: 2020 2020 2020 2020 2020 2020 2020 6466                df
+00016390: 5b22 6461 7461 7365 745f 6964 225d 203d  ["dataset_id"] =
+000163a0: 206e 702e 6172 616e 6765 286e 5f64 6174   np.arange(n_dat
+000163b0: 6173 6574 7329 0a20 2020 2020 2020 2020  asets).         
+000163c0: 2020 2020 2020 2020 2020 2064 6620 3d20             df = 
+000163d0: 7064 2e6d 656c 7428 0a20 2020 2020 2020  pd.melt(.       
+000163e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000163f0: 2064 662c 0a20 2020 2020 2020 2020 2020   df,.           
+00016400: 2020 2020 2020 2020 2020 2020 2069 645f               id_
+00016410: 7661 7273 3d5b 2264 6174 6173 6574 5f69  vars=["dataset_i
+00016420: 6422 5d2c 0a20 2020 2020 2020 2020 2020  d"],.           
+00016430: 2020 2020 2020 2020 2020 2020 2076 6172               var
+00016440: 5f6e 616d 653d 2265 7374 696d 6174 6f72  _name="estimator
+00016450: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00016460: 2020 2020 2020 2020 2020 2076 616c 7565             value
+00016470: 5f6e 616d 653d 2270 6f6c 6963 795f 7661  _name="policy_va
+00016480: 6c75 6522 2c0a 2020 2020 2020 2020 2020  lue",.          
+00016490: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+000164a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000164b0: 2069 6620 2864 665b 2270 6f6c 6963 795f   if (df["policy_
+000164c0: 7661 6c75 6522 5d20 3e20 3165 3130 292e  value"] > 1e10).
+000164d0: 7375 6d28 2920 2b20 280a 2020 2020 2020  sum() + (.      
+000164e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000164f0: 2020 6466 5b22 706f 6c69 6379 5f76 616c    df["policy_val
+00016500: 7565 225d 203c 202d 3165 3130 0a20 2020  ue"] < -1e10.   
+00016510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016520: 2029 2e73 756d 2829 203e 2030 3a0a 2020   ).sum() > 0:.  
+00016530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016540: 2020 2020 2020 7761 726e 280a 2020 2020        warn(.    
+00016550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016560: 2020 2020 2020 2020 2246 6f75 6e64 2061          "Found a
+00016570: 206c 6172 6765 2061 6273 6f6c 7574 6520   large absolute 
+00016580: 7661 6c75 6520 696e 2074 6865 2070 6f6c  value in the pol
+00016590: 6963 7920 7661 6c75 6520 6573 7469 6d61  icy value estima
+000165a0: 7465 2e20 5468 6520 7661 6c75 6520 6d6f  te. The value mo
+000165b0: 7265 2074 6861 6e20 3165 3130 2061 6e64  re than 1e10 and
+000165c0: 206c 6573 7320 7468 616e 202d 3165 3130   less than -1e10
+000165d0: 2077 696c 6c20 6265 2072 6570 6c61 6365   will be replace
+000165e0: 6420 746f 206e 702e 6e61 6e2e 220a 2020  d to np.nan.".  
+000165f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016600: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00016610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016620: 6466 5b22 706f 6c69 6379 5f76 616c 7565  df["policy_value
+00016630: 225d 203d 2064 665b 2270 6f6c 6963 795f  "] = df["policy_
+00016640: 7661 6c75 6522 5d2e 6d61 736b 280a 2020  value"].mask(.  
+00016650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016660: 2020 2020 2020 2020 2020 6466 5b22 706f            df["po
+00016670: 6c69 6379 5f76 616c 7565 225d 203e 2031  licy_value"] > 1
+00016680: 652d 3130 2c20 6e70 2e6e 616e 0a20 2020  e-10, np.nan.   
+00016690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000166a0: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+000166b0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+000166c0: 665b 2270 6f6c 6963 795f 7661 6c75 6522  f["policy_value"
+000166d0: 5d20 3d20 6466 5b22 706f 6c69 6379 5f76  ] = df["policy_v
+000166e0: 616c 7565 225d 2e6d 6173 6b28 0a20 2020  alue"].mask(.   
+000166f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016700: 2020 2020 2020 2020 2064 665b 2270 6f6c           df["pol
+00016710: 6963 795f 7661 6c75 6522 5d20 3c20 2d31  icy_value"] < -1
+00016720: 652d 3130 2c20 6e70 2e6e 616e 0a20 2020  e-10, np.nan.   
+00016730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016740: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+00016750: 2020 2020 2020 2020 2020 2020 6966 2070              if p
+00016760: 6c6f 745f 7479 7065 203d 3d20 2263 6922  lot_type == "ci"
+00016770: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00016780: 2020 2020 2020 2020 2020 736e 732e 6261            sns.ba
+00016790: 7270 6c6f 7428 0a20 2020 2020 2020 2020  rplot(.         
+000167a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000167b0: 2020 2064 6174 613d 6466 2c0a 2020 2020     data=df,.    
+000167c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000167d0: 2020 2020 2020 2020 783d 2265 7374 696d          x="estim
+000167e0: 6174 6f72 222c 0a20 2020 2020 2020 2020  ator",.         
+000167f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016800: 2020 2079 3d22 706f 6c69 6379 5f76 616c     y="policy_val
+00016810: 7565 222c 0a20 2020 2020 2020 2020 2020  ue",.           
+00016820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016830: 2070 616c 6574 7465 3d70 616c 6574 7465   palette=palette
+00016840: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00016850: 2020 2020 2020 2020 2020 2020 2020 6178                ax
+00016860: 3d61 782c 0a20 2020 2020 2020 2020 2020  =ax,.           
+00016870: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
 00016880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016890: 2020 2020 2020 2020 2020 2070 616c 6574             palet
-000168a0: 7465 3d70 616c 6574 7465 2c0a 2020 2020  te=palette,.    
+00016890: 2020 2065 6c69 6620 706c 6f74 5f74 7970     elif plot_typ
+000168a0: 6520 3d3d 2022 7669 6f6c 696e 223a 0a20  e == "violin":. 
 000168b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000168c0: 2020 2020 2020 2020 6178 3d61 782c 0a20          ax=ax,. 
-000168d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000168e0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-000168f0: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
-00016900: 6620 706c 6f74 5f74 7970 6520 3d3d 2022  f plot_type == "
-00016910: 7669 6f6c 696e 223a 0a20 2020 2020 2020  violin":.       
-00016920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016930: 2073 6e73 2e76 696f 6c69 6e70 6c6f 7428   sns.violinplot(
-00016940: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00016950: 2020 2020 2020 2020 2020 2020 2064 6174               dat
-00016960: 613d 6466 2c0a 2020 2020 2020 2020 2020  a=df,.          
-00016970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016980: 2020 783d 2265 7374 696d 6174 6f72 222c    x="estimator",
-00016990: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000169a0: 2020 2020 2020 2020 2020 2020 2079 3d22               y="
-000169b0: 706f 6c69 6379 5f76 616c 7565 222c 0a20  policy_value",. 
-000169c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000169d0: 2020 2020 2020 2020 2020 2073 6361 6c65             scale
-000169e0: 3d22 7769 6474 6822 2c0a 2020 2020 2020  ="width",.      
-000169f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016a00: 2020 2020 2020 7769 6474 683d 302e 352c        width=0.5,
+000168c0: 2020 2020 2020 2073 6e73 2e76 696f 6c69         sns.violi
+000168d0: 6e70 6c6f 7428 0a20 2020 2020 2020 2020  nplot(.         
+000168e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000168f0: 2020 2064 6174 613d 6466 2c0a 2020 2020     data=df,.    
+00016900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016910: 2020 2020 2020 2020 783d 2265 7374 696d          x="estim
+00016920: 6174 6f72 222c 0a20 2020 2020 2020 2020  ator",.         
+00016930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016940: 2020 2079 3d22 706f 6c69 6379 5f76 616c     y="policy_val
+00016950: 7565 222c 0a20 2020 2020 2020 2020 2020  ue",.           
+00016960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016970: 2073 6361 6c65 3d22 7769 6474 6822 2c0a   scale="width",.
+00016980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016990: 2020 2020 2020 2020 2020 2020 7769 6474              widt
+000169a0: 683d 302e 352c 0a20 2020 2020 2020 2020  h=0.5,.         
+000169b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000169c0: 2020 2070 616c 6574 7465 3d70 616c 6574     palette=palet
+000169d0: 7465 2c0a 2020 2020 2020 2020 2020 2020  te,.            
+000169e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000169f0: 6178 3d61 782c 0a20 2020 2020 2020 2020  ax=ax,.         
+00016a00: 2020 2020 2020 2020 2020 2020 2020 2029                 )
 00016a10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00016a20: 2020 2020 2020 2020 2020 2020 2070 616c               pal
-00016a30: 6574 7465 3d70 616c 6574 7465 2c0a 2020  ette=palette,.  
-00016a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016a50: 2020 2020 2020 2020 2020 6178 3d61 782c            ax=ax,
-00016a60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00016a70: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-00016a80: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00016a90: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00016aa0: 2020 2020 2020 2020 2020 2020 2074 7279               try
-00016ab0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00016ac0: 2020 2020 2020 2020 2020 2020 2020 736e                sn
-00016ad0: 732e 7377 6172 6d70 6c6f 7428 0a20 2020  s.swarmplot(.   
-00016ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016af0: 2020 2020 2020 2020 2020 2020 2064 6174               dat
-00016b00: 613d 6466 2c0a 2020 2020 2020 2020 2020  a=df,.          
-00016b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016b20: 2020 2020 2020 783d 2265 7374 696d 6174        x="estimat
-00016b30: 6f72 222c 0a20 2020 2020 2020 2020 2020  or",.           
-00016b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016b50: 2020 2020 2079 3d22 706f 6c69 6379 5f76       y="policy_v
-00016b60: 616c 7565 222c 0a20 2020 2020 2020 2020  alue",.         
-00016b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016b80: 2020 2020 2020 2070 616c 6574 7465 3d70         palette=p
-00016b90: 616c 6574 7465 2c0a 2020 2020 2020 2020  alette,.        
-00016ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016bb0: 2020 2020 2020 2020 6178 3d61 782c 0a20          ax=ax,. 
-00016bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016bd0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00016a20: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00016a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016a40: 2020 2074 7279 3a0a 2020 2020 2020 2020     try:.        
+00016a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016a60: 2020 2020 736e 732e 7377 6172 6d70 6c6f      sns.swarmplo
+00016a70: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
+00016a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016a90: 2020 2064 6174 613d 6466 2c0a 2020 2020     data=df,.    
+00016aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016ab0: 2020 2020 2020 2020 2020 2020 783d 2265              x="e
+00016ac0: 7374 696d 6174 6f72 222c 0a20 2020 2020  stimator",.     
+00016ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016ae0: 2020 2020 2020 2020 2020 2079 3d22 706f             y="po
+00016af0: 6c69 6379 5f76 616c 7565 222c 0a20 2020  licy_value",.   
+00016b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016b10: 2020 2020 2020 2020 2020 2020 2070 616c               pal
+00016b20: 6574 7465 3d70 616c 6574 7465 2c0a 2020  ette=palette,.  
+00016b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016b40: 2020 2020 2020 2020 2020 2020 2020 6178                ax
+00016b50: 3d61 782c 0a20 2020 2020 2020 2020 2020  =ax,.           
+00016b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016b70: 2029 0a20 2020 2020 2020 2020 2020 2020   ).             
+00016b80: 2020 2020 2020 2020 2020 2065 7863 6570             excep
+00016b90: 743a 0a20 2020 2020 2020 2020 2020 2020  t:.             
+00016ba0: 2020 2020 2020 2020 2020 2020 2020 2077                 w
+00016bb0: 6172 6e28 2245 6e63 6f75 6e74 6572 6564  arn("Encountered
+00016bc0: 204e 614e 2076 616c 7565 7320 6475 7269   NaN values duri
+00016bd0: 6e67 2070 6c6f 742e 2229 0a0a 2020 2020  ng plot.")..    
 00016be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016bf0: 2020 2020 2065 7863 6570 743a 0a20 2020       except:.   
-00016c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016c10: 2020 2020 2020 2020 2077 6172 6e28 2245           warn("E
-00016c20: 6e63 6f75 6e74 6572 6564 204e 614e 2076  ncountered NaN v
-00016c30: 616c 7565 7320 6475 7269 6e67 2070 6c6f  alues during plo
-00016c40: 742e 2229 0a0a 2020 2020 2020 2020 2020  t.")..          
-00016c50: 2020 2020 2020 2020 2020 6f6e 5f70 6f6c            on_pol
-00016c60: 6963 7920 3d20 706f 6c69 6379 5f76 616c  icy = policy_val
-00016c70: 7565 5f64 6963 745b 6576 616c 5f70 6f6c  ue_dict[eval_pol
-00016c80: 6963 795d 5b22 6f6e 5f70 6f6c 6963 7922  icy]["on_policy"
-00016c90: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-00016ca0: 2020 2020 2020 6966 206f 6e5f 706f 6c69        if on_poli
-00016cb0: 6379 2069 7320 6e6f 7420 4e6f 6e65 3a0a  cy is not None:.
-00016cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016cd0: 2020 2020 2020 2020 6178 2e73 6361 7474          ax.scatt
-00016ce0: 6572 280a 2020 2020 2020 2020 2020 2020  er(.            
+00016bf0: 6f6e 5f70 6f6c 6963 7920 3d20 706f 6c69  on_policy = poli
+00016c00: 6379 5f76 616c 7565 5f64 6963 745b 6576  cy_value_dict[ev
+00016c10: 616c 5f70 6f6c 6963 795d 5b22 6f6e 5f70  al_policy]["on_p
+00016c20: 6f6c 6963 7922 5d0a 2020 2020 2020 2020  olicy"].        
+00016c30: 2020 2020 2020 2020 2020 2020 6966 206f              if o
+00016c40: 6e5f 706f 6c69 6379 2069 7320 6e6f 7420  n_policy is not 
+00016c50: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+00016c60: 2020 2020 2020 2020 2020 2020 2020 6178                ax
+00016c70: 2e73 6361 7474 6572 280a 2020 2020 2020  .scatter(.      
+00016c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016c90: 2020 2020 2020 6e70 2e61 7261 6e67 6528        np.arange(
+00016ca0: 6e5f 6573 7469 6d61 746f 7273 292c 0a20  n_estimators),. 
+00016cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016cc0: 2020 2020 2020 2020 2020 206e 702e 6675             np.fu
+00016cd0: 6c6c 2828 6e5f 6573 7469 6d61 746f 7273  ll((n_estimators
+00016ce0: 292c 206f 6e5f 706f 6c69 6379 292c 0a20  ), on_policy),. 
 00016cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016d00: 6e70 2e61 7261 6e67 6528 6e5f 6573 7469  np.arange(n_esti
-00016d10: 6d61 746f 7273 292c 0a20 2020 2020 2020  mators),.       
+00016d00: 2020 2020 2020 2020 2020 2063 6f6c 6f72             color
+00016d10: 3d22 626c 6163 6b22 2c0a 2020 2020 2020  ="black",.      
 00016d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016d30: 2020 2020 206e 702e 6675 6c6c 2828 6e5f       np.full((n_
-00016d40: 6573 7469 6d61 746f 7273 292c 206f 6e5f  estimators), on_
-00016d50: 706f 6c69 6379 292c 0a20 2020 2020 2020  policy),.       
-00016d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016d70: 2020 2020 2063 6f6c 6f72 3d22 626c 6163       color="blac
-00016d80: 6b22 2c0a 2020 2020 2020 2020 2020 2020  k",.            
-00016d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016da0: 6d61 726b 6572 3d22 2a22 2c0a 2020 2020  marker="*",.    
-00016db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016dc0: 2020 2020 2020 2020 733d 3135 302c 0a20          s=150,. 
-00016dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016de0: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-00016df0: 2020 2020 2020 2020 2020 2020 2020 6178                ax
-00016e00: 2e73 6574 5f74 6974 6c65 2865 7661 6c5f  .set_title(eval_
-00016e10: 706f 6c69 6379 2c20 666f 6e74 7369 7a65  policy, fontsize
-00016e20: 3d31 3629 0a20 2020 2020 2020 2020 2020  =16).           
-00016e30: 2020 2020 2020 2020 2061 782e 7365 745f           ax.set_
-00016e40: 786c 6162 656c 2822 2229 0a20 2020 2020  xlabel("").     
-00016e50: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-00016e60: 782e 7365 745f 796c 6162 656c 280a 2020  x.set_ylabel(.  
-00016e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016e80: 2020 2020 2020 6622 4573 7469 6d61 7465        f"Estimate
-00016e90: 6420 506f 6c69 6379 2056 616c 7565 222c  d Policy Value",
-00016ea0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00016eb0: 2020 2020 2020 2020 2066 6f6e 7473 697a           fontsiz
-00016ec0: 653d 3132 2c0a 2020 2020 2020 2020 2020  e=12,.          
-00016ed0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00016ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016ef0: 6178 2e73 6574 5f78 7469 636b 7328 6e70  ax.set_xticks(np
-00016f00: 2e61 7261 6e67 6528 6e5f 6573 7469 6d61  .arange(n_estima
-00016f10: 746f 7273 292c 2063 6f6d 7061 7265 645f  tors), compared_
-00016f20: 6573 7469 6d61 746f 7273 290a 2020 2020  estimators).    
-00016f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016f40: 706c 742e 7974 6963 6b73 2866 6f6e 7473  plt.yticks(fonts
-00016f50: 697a 653d 3132 290a 2020 2020 2020 2020  ize=12).        
-00016f60: 2020 2020 2020 2020 2020 2020 706c 742e              plt.
-00016f70: 7874 6963 6b73 2866 6f6e 7473 697a 653d  xticks(fontsize=
-00016f80: 3132 290a 0a20 2020 2020 2020 2020 2020  12)..           
-00016f90: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00016fa0: 2020 2020 2020 2076 6973 7561 6c69 7a65         visualize
-00016fb0: 5f6f 6e5f 706f 6c69 6379 203d 2054 7275  _on_policy = Tru
-00016fc0: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
-00016fd0: 2020 666f 7220 6576 616c 5f70 6f6c 6963    for eval_polic
-00016fe0: 7920 696e 2069 6e70 7574 5f64 6963 745f  y in input_dict_
-00016ff0: 302e 6b65 7973 2829 3a0a 2020 2020 2020  0.keys():.      
-00017000: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00017010: 2069 6e70 7574 5f64 6963 745f 305b 6576   input_dict_0[ev
-00017020: 616c 5f70 6f6c 6963 795d 5b22 6f6e 5f70  al_policy]["on_p
-00017030: 6f6c 6963 795f 706f 6c69 6379 5f76 616c  olicy_policy_val
-00017040: 7565 225d 2069 7320 4e6f 6e65 3a0a 2020  ue"] is None:.  
-00017050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017060: 2020 2020 2020 7669 7375 616c 697a 655f        visualize_
-00017070: 6f6e 5f70 6f6c 6963 7920 3d20 4661 6c73  on_policy = Fals
-00017080: 650a 0a20 2020 2020 2020 2020 2020 2020  e..             
-00017090: 2020 2020 2020 206f 6e5f 706f 6c69 6379         on_policy
-000170a0: 203d 206e 702e 7a65 726f 7328 6e5f 6576   = np.zeros(n_ev
-000170b0: 616c 5f70 6f6c 6963 6965 7329 0a20 2020  al_policies).   
-000170c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000170d0: 2066 6f72 206a 2c20 6576 616c 5f70 6f6c   for j, eval_pol
-000170e0: 6963 7920 696e 2065 6e75 6d65 7261 7465  icy in enumerate
-000170f0: 2869 6e70 7574 5f64 6963 745f 302e 6b65  (input_dict_0.ke
-00017100: 7973 2829 293a 0a20 2020 2020 2020 2020  ys()):.         
-00017110: 2020 2020 2020 2020 2020 2020 2020 206f                 o
-00017120: 6e5f 706f 6c69 6379 5b6a 5d20 3d20 706f  n_policy[j] = po
-00017130: 6c69 6379 5f76 616c 7565 5f64 6963 745b  licy_value_dict[
-00017140: 6576 616c 5f70 6f6c 6963 795d 5b22 6f6e  eval_policy]["on
-00017150: 5f70 6f6c 6963 7922 5d0a 0a20 2020 2020  _policy"]..     
-00017160: 2020 2020 2020 2020 2020 2066 6967 203d             fig =
-00017170: 2070 6c74 2e66 6967 7572 6528 6669 6773   plt.figure(figs
-00017180: 697a 653d 2832 202a 206e 5f65 7661 6c5f  ize=(2 * n_eval_
-00017190: 706f 6c69 6369 6573 2c20 3420 2a20 6e5f  policies, 4 * n_
-000171a0: 6573 7469 6d61 746f 7273 2929 0a0a 2020  estimators))..  
-000171b0: 2020 2020 2020 2020 2020 2020 2020 7061                pa
-000171c0: 6c65 7474 6520 3d20 7b7d 0a20 2020 2020  lette = {}.     
-000171d0: 2020 2020 2020 2020 2020 2066 6f72 206a             for j
-000171e0: 2c20 6576 616c 5f70 6f6c 6963 7920 696e  , eval_policy in
-000171f0: 2065 6e75 6d65 7261 7465 2869 6e70 7574   enumerate(input
-00017200: 5f64 6963 745f 302e 6b65 7973 2829 293a  _dict_0.keys()):
-00017210: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00017220: 2020 2020 2070 616c 6574 7465 5b65 7661       palette[eva
-00017230: 6c5f 706f 6c69 6379 5d20 3d20 636f 6c6f  l_policy] = colo
-00017240: 725b 6a20 2520 6e5f 636f 6c6f 7273 5d0a  r[j % n_colors].
-00017250: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00017260: 2066 6f72 2069 2c20 6573 7469 6d61 746f   for i, estimato
-00017270: 7220 696e 2065 6e75 6d65 7261 7465 2863  r in enumerate(c
-00017280: 6f6d 7061 7265 645f 6573 7469 6d61 746f  ompared_estimato
-00017290: 7273 293a 0a20 2020 2020 2020 2020 2020  rs):.           
-000172a0: 2020 2020 2020 2020 2069 6620 6920 3d3d           if i ==
-000172b0: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
-000172c0: 2020 2020 2020 2020 2020 2020 6178 203d              ax =
-000172d0: 2061 7830 203d 2066 6967 2e61 6464 5f73   ax0 = fig.add_s
-000172e0: 7562 706c 6f74 286e 5f65 7374 696d 6174  ubplot(n_estimat
-000172f0: 6f72 732c 2031 2c20 6920 2b20 3129 0a20  ors, 1, i + 1). 
-00017300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017310: 2020 2065 6c69 6620 7368 6172 6579 3a0a     elif sharey:.
-00017320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017330: 2020 2020 2020 2020 6178 203d 2066 6967          ax = fig
-00017340: 2e61 6464 5f73 7562 706c 6f74 286e 5f65  .add_subplot(n_e
-00017350: 7374 696d 6174 6f72 732c 2031 2c20 6920  stimators, 1, i 
-00017360: 2b20 312c 2073 6861 7265 793d 6178 3029  + 1, sharey=ax0)
-00017370: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00017380: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00016d30: 2020 2020 2020 6d61 726b 6572 3d22 2a22        marker="*"
+00016d40: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00016d50: 2020 2020 2020 2020 2020 2020 2020 733d                s=
+00016d60: 3135 302c 0a20 2020 2020 2020 2020 2020  150,.           
+00016d70: 2020 2020 2020 2020 2020 2020 2029 0a0a               )..
+00016d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016d90: 2020 2020 6178 2e73 6574 5f74 6974 6c65      ax.set_title
+00016da0: 2865 7661 6c5f 706f 6c69 6379 2c20 666f  (eval_policy, fo
+00016db0: 6e74 7369 7a65 3d31 3629 0a20 2020 2020  ntsize=16).     
+00016dc0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+00016dd0: 782e 7365 745f 786c 6162 656c 2822 2229  x.set_xlabel("")
+00016de0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00016df0: 2020 2020 2061 782e 7365 745f 796c 6162       ax.set_ylab
+00016e00: 656c 280a 2020 2020 2020 2020 2020 2020  el(.            
+00016e10: 2020 2020 2020 2020 2020 2020 6622 4573              f"Es
+00016e20: 7469 6d61 7465 6420 506f 6c69 6379 2056  timated Policy V
+00016e30: 616c 7565 222c 0a20 2020 2020 2020 2020  alue",.         
+00016e40: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00016e50: 6f6e 7473 697a 653d 3132 2c0a 2020 2020  ontsize=12,.    
+00016e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016e70: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00016e80: 2020 2020 2020 6178 2e73 6574 5f78 7469        ax.set_xti
+00016e90: 636b 7328 6e70 2e61 7261 6e67 6528 6e5f  cks(np.arange(n_
+00016ea0: 6573 7469 6d61 746f 7273 292c 2063 6f6d  estimators), com
+00016eb0: 7061 7265 645f 6573 7469 6d61 746f 7273  pared_estimators
+00016ec0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00016ed0: 2020 2020 2020 706c 742e 7974 6963 6b73        plt.yticks
+00016ee0: 2866 6f6e 7473 697a 653d 3132 290a 2020  (fontsize=12).  
+00016ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016f00: 2020 706c 742e 7874 6963 6b73 2866 6f6e    plt.xticks(fon
+00016f10: 7473 697a 653d 3132 290a 0a20 2020 2020  tsize=12)..     
+00016f20: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00016f30: 2020 2020 2020 2020 2020 2020 2076 6973               vis
+00016f40: 7561 6c69 7a65 5f6f 6e5f 706f 6c69 6379  ualize_on_policy
+00016f50: 203d 2054 7275 650a 2020 2020 2020 2020   = True.        
+00016f60: 2020 2020 2020 2020 666f 7220 6576 616c          for eval
+00016f70: 5f70 6f6c 6963 7920 696e 2069 6e70 7574  _policy in input
+00016f80: 5f64 6963 745f 302e 6b65 7973 2829 3a0a  _dict_0.keys():.
+00016f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016fa0: 2020 2020 6966 2069 6e70 7574 5f64 6963      if input_dic
+00016fb0: 745f 305b 6576 616c 5f70 6f6c 6963 795d  t_0[eval_policy]
+00016fc0: 5b22 6f6e 5f70 6f6c 6963 795f 706f 6c69  ["on_policy_poli
+00016fd0: 6379 5f76 616c 7565 225d 2069 7320 4e6f  cy_value"] is No
+00016fe0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+00016ff0: 2020 2020 2020 2020 2020 2020 7669 7375              visu
+00017000: 616c 697a 655f 6f6e 5f70 6f6c 6963 7920  alize_on_policy 
+00017010: 3d20 4661 6c73 650a 0a20 2020 2020 2020  = False..       
+00017020: 2020 2020 2020 2020 2020 2020 206f 6e5f               on_
+00017030: 706f 6c69 6379 203d 206e 702e 7a65 726f  policy = np.zero
+00017040: 7328 6e5f 6576 616c 5f70 6f6c 6963 6965  s(n_eval_policie
+00017050: 7329 0a20 2020 2020 2020 2020 2020 2020  s).             
+00017060: 2020 2020 2020 2066 6f72 206a 2c20 6576         for j, ev
+00017070: 616c 5f70 6f6c 6963 7920 696e 2065 6e75  al_policy in enu
+00017080: 6d65 7261 7465 2869 6e70 7574 5f64 6963  merate(input_dic
+00017090: 745f 302e 6b65 7973 2829 293a 0a20 2020  t_0.keys()):.   
+000170a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000170b0: 2020 2020 206f 6e5f 706f 6c69 6379 5b6a       on_policy[j
+000170c0: 5d20 3d20 706f 6c69 6379 5f76 616c 7565  ] = policy_value
+000170d0: 5f64 6963 745b 6576 616c 5f70 6f6c 6963  _dict[eval_polic
+000170e0: 795d 5b22 6f6e 5f70 6f6c 6963 7922 5d0a  y]["on_policy"].
+000170f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00017100: 2066 6967 203d 2070 6c74 2e66 6967 7572   fig = plt.figur
+00017110: 6528 6669 6773 697a 653d 2832 202a 206e  e(figsize=(2 * n
+00017120: 5f65 7661 6c5f 706f 6c69 6369 6573 2c20  _eval_policies, 
+00017130: 3420 2a20 6e5f 6573 7469 6d61 746f 7273  4 * n_estimators
+00017140: 2929 0a0a 2020 2020 2020 2020 2020 2020  ))..            
+00017150: 2020 2020 7061 6c65 7474 6520 3d20 7b7d      palette = {}
+00017160: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00017170: 2066 6f72 206a 2c20 6576 616c 5f70 6f6c   for j, eval_pol
+00017180: 6963 7920 696e 2065 6e75 6d65 7261 7465  icy in enumerate
+00017190: 2869 6e70 7574 5f64 6963 745f 302e 6b65  (input_dict_0.ke
+000171a0: 7973 2829 293a 0a20 2020 2020 2020 2020  ys()):.         
+000171b0: 2020 2020 2020 2020 2020 2070 616c 6574             palet
+000171c0: 7465 5b65 7661 6c5f 706f 6c69 6379 5d20  te[eval_policy] 
+000171d0: 3d20 636f 6c6f 725b 6a20 2520 6e5f 636f  = color[j % n_co
+000171e0: 6c6f 7273 5d0a 0a20 2020 2020 2020 2020  lors]..         
+000171f0: 2020 2020 2020 2066 6f72 2069 2c20 6573         for i, es
+00017200: 7469 6d61 746f 7220 696e 2065 6e75 6d65  timator in enume
+00017210: 7261 7465 2863 6f6d 7061 7265 645f 6573  rate(compared_es
+00017220: 7469 6d61 746f 7273 293a 0a20 2020 2020  timators):.     
+00017230: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00017240: 6620 6920 3d3d 2030 3a0a 2020 2020 2020  f i == 0:.      
+00017250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017260: 2020 6178 203d 2061 7830 203d 2066 6967    ax = ax0 = fig
+00017270: 2e61 6464 5f73 7562 706c 6f74 286e 5f65  .add_subplot(n_e
+00017280: 7374 696d 6174 6f72 732c 2031 2c20 6920  stimators, 1, i 
+00017290: 2b20 3129 0a20 2020 2020 2020 2020 2020  + 1).           
+000172a0: 2020 2020 2020 2020 2065 6c69 6620 7368           elif sh
+000172b0: 6172 6579 3a0a 2020 2020 2020 2020 2020  arey:.          
+000172c0: 2020 2020 2020 2020 2020 2020 2020 6178                ax
+000172d0: 203d 2066 6967 2e61 6464 5f73 7562 706c   = fig.add_subpl
+000172e0: 6f74 286e 5f65 7374 696d 6174 6f72 732c  ot(n_estimators,
+000172f0: 2031 2c20 6920 2b20 312c 2073 6861 7265   1, i + 1, share
+00017300: 793d 6178 3029 0a20 2020 2020 2020 2020  y=ax0).         
+00017310: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00017320: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00017330: 2020 2020 2020 2020 2061 7820 3d20 6669           ax = fi
+00017340: 672e 6164 645f 7375 6270 6c6f 7428 6e5f  g.add_subplot(n_
+00017350: 6573 7469 6d61 746f 7273 2c20 312c 2069  estimators, 1, i
+00017360: 202b 2031 290a 0a20 2020 2020 2020 2020   + 1)..         
+00017370: 2020 2020 2020 2020 2020 2064 6620 3d20             df = 
+00017380: 4461 7461 4672 616d 6528 290a 2020 2020  DataFrame().    
 00017390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000173a0: 2020 2061 7820 3d20 6669 672e 6164 645f     ax = fig.add_
-000173b0: 7375 6270 6c6f 7428 6e5f 6573 7469 6d61  subplot(n_estima
-000173c0: 746f 7273 2c20 312c 2069 202b 2031 290a  tors, 1, i + 1).
-000173d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000173e0: 2020 2020 2064 6620 3d20 4461 7461 4672       df = DataFr
-000173f0: 616d 6528 290a 2020 2020 2020 2020 2020  ame().          
-00017400: 2020 2020 2020 2020 2020 666f 7220 6a2c            for j,
-00017410: 2065 7661 6c5f 706f 6c69 6379 2069 6e20   eval_policy in 
-00017420: 656e 756d 6572 6174 6528 696e 7075 745f  enumerate(input_
-00017430: 6469 6374 5f30 2e6b 6579 7328 2929 3a0a  dict_0.keys()):.
-00017440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017450: 2020 2020 2020 2020 6466 5b65 7661 6c5f          df[eval_
-00017460: 706f 6c69 6379 5d20 3d20 706f 6c69 6379  policy] = policy
-00017470: 5f76 616c 7565 5f64 6963 745b 6576 616c  _value_dict[eval
-00017480: 5f70 6f6c 6963 795d 5b65 7374 696d 6174  _policy][estimat
-00017490: 6f72 5d0a 0a20 2020 2020 2020 2020 2020  or]..           
-000174a0: 2020 2020 2020 2020 2064 665b 2264 6174           df["dat
-000174b0: 6173 6574 5f69 6422 5d20 3d20 6e70 2e61  aset_id"] = np.a
-000174c0: 7261 6e67 6528 6e5f 6461 7461 7365 7473  range(n_datasets
-000174d0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-000174e0: 2020 2020 2020 6466 203d 2070 642e 6d65        df = pd.me
-000174f0: 6c74 280a 2020 2020 2020 2020 2020 2020  lt(.            
-00017500: 2020 2020 2020 2020 2020 2020 6466 2c0a              df,.
-00017510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017520: 2020 2020 2020 2020 6964 5f76 6172 733d          id_vars=
-00017530: 5b22 6461 7461 7365 745f 6964 225d 2c0a  ["dataset_id"],.
-00017540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017550: 2020 2020 2020 2020 7661 725f 6e61 6d65          var_name
-00017560: 3d22 6576 616c 5f70 6f6c 6963 7922 2c0a  ="eval_policy",.
-00017570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017580: 2020 2020 2020 2020 7661 6c75 655f 6e61          value_na
-00017590: 6d65 3d22 706f 6c69 6379 5f76 616c 7565  me="policy_value
-000175a0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-000175b0: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-000175c0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-000175d0: 2070 6c6f 745f 7479 7065 203d 3d20 2263   plot_type == "c
-000175e0: 6922 3a0a 2020 2020 2020 2020 2020 2020  i":.            
-000175f0: 2020 2020 2020 2020 2020 2020 736e 732e              sns.
-00017600: 6261 7270 6c6f 7428 0a20 2020 2020 2020  barplot(.       
-00017610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017620: 2020 2020 2064 6174 613d 6466 2c0a 2020       data=df,.  
-00017630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017640: 2020 2020 2020 2020 2020 783d 2265 7661            x="eva
-00017650: 6c5f 706f 6c69 6379 222c 0a20 2020 2020  l_policy",.     
-00017660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017670: 2020 2020 2020 2079 3d22 706f 6c69 6379         y="policy
-00017680: 5f76 616c 7565 222c 0a20 2020 2020 2020  _value",.       
-00017690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000176a0: 2020 2020 2070 616c 6574 7465 3d70 616c       palette=pal
-000176b0: 6574 7465 2c0a 2020 2020 2020 2020 2020  ette,.          
+000173a0: 666f 7220 6a2c 2065 7661 6c5f 706f 6c69  for j, eval_poli
+000173b0: 6379 2069 6e20 656e 756d 6572 6174 6528  cy in enumerate(
+000173c0: 696e 7075 745f 6469 6374 5f30 2e6b 6579  input_dict_0.key
+000173d0: 7328 2929 3a0a 2020 2020 2020 2020 2020  s()):.          
+000173e0: 2020 2020 2020 2020 2020 2020 2020 6466                df
+000173f0: 5b65 7661 6c5f 706f 6c69 6379 5d20 3d20  [eval_policy] = 
+00017400: 706f 6c69 6379 5f76 616c 7565 5f64 6963  policy_value_dic
+00017410: 745b 6576 616c 5f70 6f6c 6963 795d 5b65  t[eval_policy][e
+00017420: 7374 696d 6174 6f72 5d0a 0a20 2020 2020  stimator]..     
+00017430: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+00017440: 665b 2264 6174 6173 6574 5f69 6422 5d20  f["dataset_id"] 
+00017450: 3d20 6e70 2e61 7261 6e67 6528 6e5f 6461  = np.arange(n_da
+00017460: 7461 7365 7473 290a 2020 2020 2020 2020  tasets).        
+00017470: 2020 2020 2020 2020 2020 2020 6466 203d              df =
+00017480: 2070 642e 6d65 6c74 280a 2020 2020 2020   pd.melt(.      
+00017490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000174a0: 2020 6466 2c0a 2020 2020 2020 2020 2020    df,.          
+000174b0: 2020 2020 2020 2020 2020 2020 2020 6964                id
+000174c0: 5f76 6172 733d 5b22 6461 7461 7365 745f  _vars=["dataset_
+000174d0: 6964 225d 2c0a 2020 2020 2020 2020 2020  id"],.          
+000174e0: 2020 2020 2020 2020 2020 2020 2020 7661                va
+000174f0: 725f 6e61 6d65 3d22 6576 616c 5f70 6f6c  r_name="eval_pol
+00017500: 6963 7922 2c0a 2020 2020 2020 2020 2020  icy",.          
+00017510: 2020 2020 2020 2020 2020 2020 2020 7661                va
+00017520: 6c75 655f 6e61 6d65 3d22 706f 6c69 6379  lue_name="policy
+00017530: 5f76 616c 7565 222c 0a20 2020 2020 2020  _value",.       
+00017540: 2020 2020 2020 2020 2020 2020 2029 0a0a               )..
+00017550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017560: 2020 2020 6966 2070 6c6f 745f 7479 7065      if plot_type
+00017570: 203d 3d20 2263 6922 3a0a 2020 2020 2020   == "ci":.      
+00017580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017590: 2020 736e 732e 6261 7270 6c6f 7428 0a20    sns.barplot(. 
+000175a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000175b0: 2020 2020 2020 2020 2020 2064 6174 613d             data=
+000175c0: 6466 2c0a 2020 2020 2020 2020 2020 2020  df,.            
+000175d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000175e0: 783d 2265 7661 6c5f 706f 6c69 6379 222c  x="eval_policy",
+000175f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00017600: 2020 2020 2020 2020 2020 2020 2079 3d22               y="
+00017610: 706f 6c69 6379 5f76 616c 7565 222c 0a20  policy_value",. 
+00017620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017630: 2020 2020 2020 2020 2020 2070 616c 6574             palet
+00017640: 7465 3d70 616c 6574 7465 2c0a 2020 2020  te=palette,.    
+00017650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017660: 2020 2020 2020 2020 6178 3d61 782c 0a20          ax=ax,. 
+00017670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017680: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+00017690: 2020 2020 2020 2020 2020 2020 2020 656c                el
+000176a0: 6966 2070 6c6f 745f 7479 7065 203d 3d20  if plot_type == 
+000176b0: 2276 696f 6c69 6e22 3a0a 2020 2020 2020  "violin":.      
 000176c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000176d0: 2020 6178 3d61 782c 0a20 2020 2020 2020    ax=ax,.       
-000176e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000176f0: 2029 0a0a 2020 2020 2020 2020 2020 2020   )..            
-00017700: 2020 2020 2020 2020 656c 6966 2070 6c6f          elif plo
-00017710: 745f 7479 7065 203d 3d20 2276 696f 6c69  t_type == "violi
-00017720: 6e22 3a0a 2020 2020 2020 2020 2020 2020  n":.            
-00017730: 2020 2020 2020 2020 2020 2020 736e 732e              sns.
-00017740: 7669 6f6c 696e 706c 6f74 280a 2020 2020  violinplot(.    
-00017750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017760: 2020 2020 2020 2020 6461 7461 3d64 662c          data=df,
-00017770: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00017780: 2020 2020 2020 2020 2020 2020 2078 3d22               x="
-00017790: 6576 616c 5f70 6f6c 6963 7922 2c0a 2020  eval_policy",.  
-000177a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000177b0: 2020 2020 2020 2020 2020 793d 2270 6f6c            y="pol
-000177c0: 6963 795f 7661 6c75 6522 2c0a 2020 2020  icy_value",.    
-000177d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000177e0: 2020 2020 2020 2020 7363 616c 653d 2277          scale="w
-000177f0: 6964 7468 222c 0a20 2020 2020 2020 2020  idth",.         
-00017800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017810: 2020 2077 6964 7468 3d30 2e35 2c0a 2020     width=0.5,.  
+000176d0: 2020 736e 732e 7669 6f6c 696e 706c 6f74    sns.violinplot
+000176e0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+000176f0: 2020 2020 2020 2020 2020 2020 2020 6461                da
+00017700: 7461 3d64 662c 0a20 2020 2020 2020 2020  ta=df,.         
+00017710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017720: 2020 2078 3d22 6576 616c 5f70 6f6c 6963     x="eval_polic
+00017730: 7922 2c0a 2020 2020 2020 2020 2020 2020  y",.            
+00017740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017750: 793d 2270 6f6c 6963 795f 7661 6c75 6522  y="policy_value"
+00017760: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00017770: 2020 2020 2020 2020 2020 2020 2020 7363                sc
+00017780: 616c 653d 2277 6964 7468 222c 0a20 2020  ale="width",.   
+00017790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000177a0: 2020 2020 2020 2020 2077 6964 7468 3d30           width=0
+000177b0: 2e35 2c0a 2020 2020 2020 2020 2020 2020  .5,.            
+000177c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000177d0: 7061 6c65 7474 653d 7061 6c65 7474 652c  palette=palette,
+000177e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000177f0: 2020 2020 2020 2020 2020 2020 2061 783d               ax=
+00017800: 6178 2c0a 2020 2020 2020 2020 2020 2020  ax,.            
+00017810: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
 00017820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017830: 2020 2020 2020 2020 2020 7061 6c65 7474            palett
-00017840: 653d 7061 6c65 7474 652c 0a20 2020 2020  e=palette,.     
-00017850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017860: 2020 2020 2020 2061 783d 6178 2c0a 2020         ax=ax,.  
-00017870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017880: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-00017890: 2020 2020 2020 2020 2020 2020 2065 6c73               els
-000178a0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-000178b0: 2020 2020 2020 2020 2020 2074 7279 3a0a             try:.
-000178c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000178d0: 2020 2020 2020 2020 2020 2020 736e 732e              sns.
-000178e0: 7377 6172 6d70 6c6f 7428 0a20 2020 2020  swarmplot(.     
-000178f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017900: 2020 2020 2020 2020 2020 2064 6174 613d             data=
-00017910: 6466 2c0a 2020 2020 2020 2020 2020 2020  df,.            
-00017920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017930: 2020 2020 783d 2265 7661 6c5f 706f 6c69      x="eval_poli
-00017940: 6379 222c 0a20 2020 2020 2020 2020 2020  cy",.           
-00017950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017960: 2020 2020 2079 3d22 706f 6c69 6379 5f76       y="policy_v
-00017970: 616c 7565 222c 0a20 2020 2020 2020 2020  alue",.         
-00017980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017990: 2020 2020 2020 2070 616c 6574 7465 3d70         palette=p
-000179a0: 616c 6574 7465 2c0a 2020 2020 2020 2020  alette,.        
-000179b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000179c0: 2020 2020 2020 2020 6178 3d61 782c 0a20          ax=ax,. 
-000179d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000179e0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00017830: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00017840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017850: 2074 7279 3a0a 2020 2020 2020 2020 2020   try:.          
+00017860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017870: 2020 736e 732e 7377 6172 6d70 6c6f 7428    sns.swarmplot(
+00017880: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00017890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000178a0: 2064 6174 613d 6466 2c0a 2020 2020 2020   data=df,.      
+000178b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000178c0: 2020 2020 2020 2020 2020 783d 2265 7661            x="eva
+000178d0: 6c5f 706f 6c69 6379 222c 0a20 2020 2020  l_policy",.     
+000178e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000178f0: 2020 2020 2020 2020 2020 2079 3d22 706f             y="po
+00017900: 6c69 6379 5f76 616c 7565 222c 0a20 2020  licy_value",.   
+00017910: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017920: 2020 2020 2020 2020 2020 2020 2070 616c               pal
+00017930: 6574 7465 3d70 616c 6574 7465 2c0a 2020  ette=palette,.  
+00017940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017950: 2020 2020 2020 2020 2020 2020 2020 6178                ax
+00017960: 3d61 782c 0a20 2020 2020 2020 2020 2020  =ax,.           
+00017970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017980: 2029 0a20 2020 2020 2020 2020 2020 2020   ).             
+00017990: 2020 2020 2020 2020 2020 2065 7863 6570             excep
+000179a0: 743a 0a20 2020 2020 2020 2020 2020 2020  t:.             
+000179b0: 2020 2020 2020 2020 2020 2020 2020 2077                 w
+000179c0: 6172 6e28 2245 6e63 6f75 6e74 6572 6564  arn("Encountered
+000179d0: 204e 614e 2076 616c 7565 7320 6475 7269   NaN values duri
+000179e0: 6e67 2070 6c6f 742e 2229 0a0a 2020 2020  ng plot.")..    
 000179f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017a00: 2020 2020 2065 7863 6570 743a 0a20 2020       except:.   
-00017a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017a20: 2020 2020 2020 2020 2077 6172 6e28 2245           warn("E
-00017a30: 6e63 6f75 6e74 6572 6564 204e 614e 2076  ncountered NaN v
-00017a40: 616c 7565 7320 6475 7269 6e67 2070 6c6f  alues during plo
-00017a50: 742e 2229 0a0a 2020 2020 2020 2020 2020  t.")..          
-00017a60: 2020 2020 2020 2020 2020 6966 2076 6973            if vis
-00017a70: 7561 6c69 7a65 5f6f 6e5f 706f 6c69 6379  ualize_on_policy
-00017a80: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00017a90: 2020 2020 2020 2020 2020 6178 2e73 6361            ax.sca
-00017aa0: 7474 6572 280a 2020 2020 2020 2020 2020  tter(.          
-00017ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017ac0: 2020 6e70 2e61 7261 6e67 6528 6e5f 6576    np.arange(n_ev
-00017ad0: 616c 5f70 6f6c 6963 6965 7329 2c0a 2020  al_policies),.  
-00017ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017af0: 2020 2020 2020 2020 2020 6f6e 5f70 6f6c            on_pol
-00017b00: 6963 792c 0a20 2020 2020 2020 2020 2020  icy,.           
-00017b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017b20: 2063 6f6c 6f72 3d22 626c 6163 6b22 2c0a   color="black",.
+00017a00: 6966 2076 6973 7561 6c69 7a65 5f6f 6e5f  if visualize_on_
+00017a10: 706f 6c69 6379 3a0a 2020 2020 2020 2020  policy:.        
+00017a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017a30: 6178 2e73 6361 7474 6572 280a 2020 2020  ax.scatter(.    
+00017a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017a50: 2020 2020 2020 2020 6e70 2e61 7261 6e67          np.arang
+00017a60: 6528 6e5f 6576 616c 5f70 6f6c 6963 6965  e(n_eval_policie
+00017a70: 7329 2c0a 2020 2020 2020 2020 2020 2020  s),.            
+00017a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017a90: 6f6e 5f70 6f6c 6963 792c 0a20 2020 2020  on_policy,.     
+00017aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017ab0: 2020 2020 2020 2063 6f6c 6f72 3d22 626c         color="bl
+00017ac0: 6163 6b22 2c0a 2020 2020 2020 2020 2020  ack",.          
+00017ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017ae0: 2020 6d61 726b 6572 3d22 2a22 2c0a 2020    marker="*",.  
+00017af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017b00: 2020 2020 2020 2020 2020 733d 3135 302c            s=150,
+00017b10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00017b20: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
 00017b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017b40: 2020 2020 2020 2020 2020 2020 6d61 726b              mark
-00017b50: 6572 3d22 2a22 2c0a 2020 2020 2020 2020  er="*",.        
-00017b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017b70: 2020 2020 733d 3135 302c 0a20 2020 2020      s=150,.     
-00017b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017b90: 2020 2029 0a0a 2020 2020 2020 2020 2020     )..          
-00017ba0: 2020 2020 2020 2020 2020 6178 2e73 6574            ax.set
-00017bb0: 5f74 6974 6c65 2865 7374 696d 6174 6f72  _title(estimator
-00017bc0: 2c20 666f 6e74 7369 7a65 3d31 3629 0a20  , fontsize=16). 
-00017bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017be0: 2020 2061 782e 7365 745f 786c 6162 656c     ax.set_xlabel
-00017bf0: 2822 2229 0a20 2020 2020 2020 2020 2020  ("").           
-00017c00: 2020 2020 2020 2020 2061 782e 7365 745f           ax.set_
-00017c10: 796c 6162 656c 280a 2020 2020 2020 2020  ylabel(.        
+00017b40: 6178 2e73 6574 5f74 6974 6c65 2865 7374  ax.set_title(est
+00017b50: 696d 6174 6f72 2c20 666f 6e74 7369 7a65  imator, fontsize
+00017b60: 3d31 3629 0a20 2020 2020 2020 2020 2020  =16).           
+00017b70: 2020 2020 2020 2020 2061 782e 7365 745f           ax.set_
+00017b80: 786c 6162 656c 2822 2229 0a20 2020 2020  xlabel("").     
+00017b90: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+00017ba0: 782e 7365 745f 796c 6162 656c 280a 2020  x.set_ylabel(.  
+00017bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017bc0: 2020 2020 2020 6622 4573 7469 6d61 7465        f"Estimate
+00017bd0: 6420 506f 6c69 6379 2056 616c 7565 222c  d Policy Value",
+00017be0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00017bf0: 2020 2020 2020 2020 2066 6f6e 7473 697a           fontsiz
+00017c00: 653d 3132 2c0a 2020 2020 2020 2020 2020  e=12,.          
+00017c10: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
 00017c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017c30: 6622 4573 7469 6d61 7465 6420 506f 6c69  f"Estimated Poli
-00017c40: 6379 2056 616c 7565 222c 0a20 2020 2020  cy Value",.     
-00017c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017c60: 2020 2066 6f6e 7473 697a 653d 3132 2c0a     fontsize=12,.
-00017c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017c80: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-00017c90: 2020 2020 2020 2020 2020 6178 2e73 6574            ax.set
-00017ca0: 5f78 7469 636b 7328 6e70 2e61 7261 6e67  _xticks(np.arang
-00017cb0: 6528 6e5f 6576 616c 5f70 6f6c 6963 6965  e(n_eval_policie
-00017cc0: 7329 2c20 6c69 7374 2869 6e70 7574 5f64  s), list(input_d
-00017cd0: 6963 745f 302e 6b65 7973 2829 2929 0a20  ict_0.keys())). 
-00017ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017cf0: 2020 2070 6c74 2e79 7469 636b 7328 666f     plt.yticks(fo
-00017d00: 6e74 7369 7a65 3d31 3229 0a20 2020 2020  ntsize=12).     
-00017d10: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00017d20: 6c74 2e78 7469 636b 7328 666f 6e74 7369  lt.xticks(fontsi
-00017d30: 7a65 3d31 3229 0a0a 2020 2020 2020 2020  ze=12)..        
-00017d40: 6669 672e 7375 6270 6c6f 7473 5f61 646a  fig.subplots_adj
-00017d50: 7573 7428 746f 703d 312e 3029 0a20 2020  ust(top=1.0).   
-00017d60: 2020 2020 2070 6c74 2e73 686f 7728 290a       plt.show().
-00017d70: 0a20 2020 2020 2020 2069 6620 6669 675f  .        if fig_
-00017d80: 6469 723a 0a20 2020 2020 2020 2020 2020  dir:.           
-00017d90: 2066 6967 2e73 6176 6566 6967 2873 7472   fig.savefig(str
-00017da0: 2866 6967 5f64 6972 202f 2066 6967 5f6e  (fig_dir / fig_n
-00017db0: 616d 6529 2c20 6470 693d 3330 302c 2062  ame), dpi=300, b
-00017dc0: 626f 785f 696e 6368 6573 3d22 7469 6768  box_inches="tigh
-00017dd0: 7422 290a 0a20 2020 2040 7072 6f70 6572  t")..    @proper
-00017de0: 7479 0a20 2020 2064 6566 2065 7374 696d  ty.    def estim
-00017df0: 6174 6f72 735f 6e61 6d65 2873 656c 6629  ators_name(self)
-00017e00: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-00017e10: 206c 6973 7428 7365 6c66 2e6f 7065 5f65   list(self.ope_e
-00017e20: 7374 696d 6174 6f72 735f 2e6b 6579 7328  stimators_.keys(
-00017e30: 2929 0a0a 0a40 6461 7461 636c 6173 730a  ))...@dataclass.
-00017e40: 636c 6173 7320 4375 6d75 6c61 7469 7665  class Cumulative
-00017e50: 4469 7374 7269 6275 7469 6f6e 4f50 453a  DistributionOPE:
-00017e60: 0a20 2020 2022 2222 436c 6173 7320 746f  .    """Class to
-00017e70: 2063 6f6e 6475 6374 2063 756d 756c 6174   conduct cumulat
-00017e80: 6976 6520 6469 7374 7269 6275 7469 6f6e  ive distribution
-00017e90: 204f 5045 2062 7920 6d75 6c74 6970 6c65   OPE by multiple
-00017ea0: 2065 7374 696d 6174 6f72 7320 7369 6d75   estimators simu
-00017eb0: 6c74 616e 656f 7573 6c79 2028 6170 706c  ltaneously (appl
-00017ec0: 6963 6162 6c65 2074 6f20 626f 7468 2064  icable to both d
-00017ed0: 6973 6372 6574 652f 636f 6e74 696e 756f  iscrete/continuo
-00017ee0: 7573 2061 6374 696f 6e20 6361 7365 7329  us action cases)
-00017ef0: 2e0a 0a20 2020 2049 6d70 6f72 7465 6420  ...    Imported 
-00017f00: 6173 3a20 3a63 6c61 7373 3a60 7363 6f70  as: :class:`scop
-00017f10: 655f 726c 2e6f 7065 2e43 756d 7574 6976  e_rl.ope.Cumutiv
-00017f20: 6544 6973 7472 6962 7574 696f 6e4f 5045  eDistributionOPE
-00017f30: 600a 0a20 2020 204e 6f74 650a 2020 2020  `..    Note.    
-00017f40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
-00017f50: 4375 6d75 6c61 7469 7665 2064 6973 7472  Cumulative distr
-00017f60: 6962 7574 696f 6e20 4f50 4520 6669 7273  ibution OPE firs
-00017f70: 7420 6573 7469 6d61 7465 7320 7468 6520  t estimates the 
-00017f80: 666f 6c6c 6f77 696e 6720 6375 6d75 6c61  following cumula
-00017f90: 7469 7665 2064 6973 7472 6962 7574 696f  tive distributio
-00017fa0: 6e20 6675 6e63 7469 6f6e 2c20 616e 6420  n function, and 
-00017fb0: 7468 656e 2065 7374 696d 6174 6573 2073  then estimates s
-00017fc0: 6f6d 6520 7374 6174 6973 7469 6373 2e0a  ome statistics..
-00017fd0: 0a20 2020 202e 2e20 6d61 7468 3a3a 0a0a  .    .. math::..
-00017fe0: 2020 2020 2020 2020 4628 6d2c 205c 5c70          F(m, \\p
-00017ff0: 6929 203a 3d20 5c5c 6d61 7468 6262 7b45  i) := \\mathbb{E
-00018000: 7d20 5c5c 6c65 6674 5b20 5c5c 6d61 7468  } \\left[ \\math
-00018010: 6262 7b49 7d20 5c5c 6c65 6674 205c 5c7b  bb{I} \\left \\{
-00018020: 205c 5c73 756d 5f7b 743d 307d 5e7b 542d   \\sum_{t=0}^{T-
-00018030: 317d 205c 5c67 616d 6d61 5e74 2072 5f74  1} \\gamma^t r_t
-00018040: 205c 5c6c 6571 206d 205c 5c72 6967 6874   \\leq m \\right
-00018050: 205c 5c7d 205c 5c6d 6964 205c 5c70 6920   \\} \\mid \\pi 
-00018060: 5c5c 7269 6768 745d 0a0a 2020 2020 7768  \\right]..    wh
-00018070: 6572 6520 3a6d 6174 683a 605c 5c70 6960  ere :math:`\\pi`
-00018080: 2069 7320 7468 6520 6576 616c 7561 7469   is the evaluati
-00018090: 6f6e 2070 6f6c 6963 792c 203a 6d61 7468  on policy, :math
-000180a0: 3a60 725f 7460 2069 7320 7468 6520 7265  :`r_t` is the re
-000180b0: 7761 7264 206f 6273 6572 7665 6420 6174  ward observed at
-000180c0: 2065 6163 6820 7469 6d65 7374 6570 203a   each timestep :
-000180d0: 6d61 7468 3a60 7460 2c0a 2020 2020 3a6d  math:`t`,.    :m
-000180e0: 6174 683a 6054 6020 6973 2074 6865 2074  ath:`T` is the t
-000180f0: 6f74 616c 206e 756d 6265 7220 6f66 2074  otal number of t
-00018100: 696d 6573 7465 7073 2069 6e20 616e 2065  imesteps in an e
-00018110: 7069 736f 6465 2c20 616e 6420 3a6d 6174  pisode, and :mat
-00018120: 683a 605c 5c67 616d 6d61 6020 6973 2074  h:`\\gamma` is t
-00018130: 6865 2064 6973 636f 756e 7420 6661 6374  he discount fact
-00018140: 6f72 2e0a 0a20 2020 2043 4446 2069 7320  or...    CDF is 
-00018150: 6974 7365 6c66 2069 6e66 6f72 6d61 7469  itself informati
-00018160: 7665 2c20 6275 7420 6974 2061 6c73 6f20  ve, but it also 
-00018170: 656e 6162 6c65 7320 7573 2074 6f20 6361  enables us to ca
-00018180: 6c63 756c 6174 6520 7468 6520 666f 6c6c  lculate the foll
-00018190: 6f77 696e 6720 7269 736b 2066 756e 6374  owing risk funct
-000181a0: 696f 6e73 2e0a 0a20 2020 202a 204d 6561  ions...    * Mea
-000181b0: 6e3a 203a 6d61 7468 3a60 5c5c 6d75 2846  n: :math:`\\mu(F
-000181c0: 2920 3a3d 205c 5c69 6e74 5f7b 477d 2047  ) := \\int_{G} G
-000181d0: 205c 5c2c 205c 5c6d 6174 6872 6d7b 647d   \\, \\mathrm{d}
-000181e0: 4628 4729 600a 2020 2020 2a20 5661 7269  F(G)`.    * Vari
-000181f0: 616e 6365 3a20 3a6d 6174 683a 605c 5c73  ance: :math:`\\s
-00018200: 6967 6d61 5e32 2846 2920 3a3d 205c 5c69  igma^2(F) := \\i
-00018210: 6e74 5f7b 477d 2028 4720 2d20 5c5c 6d75  nt_{G} (G - \\mu
-00018220: 2846 2929 5e32 205c 5c2c 205c 5c6d 6174  (F))^2 \\, \\mat
-00018230: 6872 6d7b 647d 4628 4729 600a 2020 2020  hrm{d}F(G)`.    
-00018240: 2a20 3a6d 6174 683a 605c 5c61 6c70 6861  * :math:`\\alpha
-00018250: 602d 7175 6172 7469 6c65 3a20 3a6d 6174  `-quartile: :mat
-00018260: 683a 6051 5e7b 5c5c 616c 7068 617d 2846  h:`Q^{\\alpha}(F
-00018270: 2920 3a3d 205c 5c6d 696e 205c 5c7b 2047  ) := \\min \\{ G
-00018280: 205c 5c6d 6964 2046 2847 2920 5c5c 6c65   \\mid F(G) \\le
-00018290: 7120 5c5c 616c 7068 6120 5c5c 7d60 0a20  q \\alpha \\}`. 
-000182a0: 2020 202a 2043 6f6e 6469 7469 6f6e 616c     * Conditional
-000182b0: 2056 616c 7565 2061 7420 5269 736b 2028   Value at Risk (
-000182c0: 4356 6152 293a 203a 6d61 7468 3a60 5c5c  CVaR): :math:`\\
-000182d0: 696e 745f 7b47 7d20 4720 5c5c 2c20 5c6d  int_{G} G \\, \m
-000182e0: 6174 6862 627b 497d 5c5c 7b20 4720 5c5c  athbb{I}\\{ G \\
-000182f0: 6c65 7120 515e 7b5c 5c61 6c70 6861 7d28  leq Q^{\\alpha}(
-00018300: 4629 205c 5c7d 205c 5c2c 205c 5c6d 6174  F) \\} \\, \\mat
-00018310: 6872 6d7b 647d 4628 4729 600a 0a20 2020  hrm{d}F(G)`..   
-00018320: 2077 6865 7265 2077 6520 7573 6520 3a6d   where we use :m
-00018330: 6174 683a 6047 203a 3d20 5c5c 7375 6d5f  ath:`G := \\sum_
-00018340: 7b74 3d30 7d5e 7b54 2d31 7d20 5c5c 6761  {t=0}^{T-1} \\ga
-00018350: 6d6d 615e 7420 725f 7460 616e 6420 3a6d  mma^t r_t`and :m
-00018360: 6174 683a 6064 4628 4729 203a 3d20 5c5c  ath:`dF(G) := \\
-00018370: 6d61 7468 726d 7b6c 696d 7d5f 7b5c 5c44  mathrm{lim}_{\\D
-00018380: 656c 7461 205c 5c72 6967 6874 6172 726f  elta \\rightarro
-00018390: 7720 307d 2046 2847 2920 2d20 4628 472d  w 0} F(G) - F(G-
-000183a0: 205c 5c44 656c 7461 2960 2e0a 0a20 2020   \\Delta)`...   
-000183b0: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
-000183c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020  -----------.    
-000183d0: 6c6f 6767 6564 5f64 6174 6173 6574 3a20  logged_dataset: 
-000183e0: 4c6f 6767 6564 4461 7461 7365 7420 6f72  LoggedDataset or
-000183f0: 204d 756c 7469 706c 654c 6f67 6765 6444   MultipleLoggedD
-00018400: 6174 6173 6574 0a20 2020 2020 2020 204c  ataset.        L
-00018410: 6f67 6765 6420 6461 7461 7365 7420 7573  ogged dataset us
-00018420: 6564 2074 6f20 636f 6e64 7563 7420 4f50  ed to conduct OP
-00018430: 452e 0a0a 2020 2020 2020 2020 2e2e 2063  E...        .. c
-00018440: 6f64 652d 626c 6f63 6b3a 3a20 7079 7468  ode-block:: pyth
-00018450: 6f6e 0a0a 2020 2020 2020 2020 2020 2020  on..            
-00018460: 6b65 793a 205b 0a20 2020 2020 2020 2020  key: [.         
-00018470: 2020 2020 2020 2073 697a 652c 0a20 2020         size,.   
-00018480: 2020 2020 2020 2020 2020 2020 206e 5f74               n_t
-00018490: 7261 6a65 6374 6f72 6965 732c 0a20 2020  rajectories,.   
-000184a0: 2020 2020 2020 2020 2020 2020 2073 7465               ste
-000184b0: 705f 7065 725f 7472 616a 6563 746f 7279  p_per_trajectory
-000184c0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000184d0: 2020 6163 7469 6f6e 5f74 7970 652c 0a20    action_type,. 
-000184e0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-000184f0: 5f61 6374 696f 6e73 2c0a 2020 2020 2020  _actions,.      
-00018500: 2020 2020 2020 2020 2020 6163 7469 6f6e            action
-00018510: 5f64 696d 2c0a 2020 2020 2020 2020 2020  _dim,.          
-00018520: 2020 2020 2020 6163 7469 6f6e 5f6b 6579        action_key
-00018530: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
-00018540: 2020 2061 6374 696f 6e5f 6d65 616e 696e     action_meanin
-00018550: 672c 0a20 2020 2020 2020 2020 2020 2020  g,.             
-00018560: 2020 2073 7461 7465 5f64 696d 2c0a 2020     state_dim,.  
-00018570: 2020 2020 2020 2020 2020 2020 2020 7374                st
-00018580: 6174 655f 6b65 7973 2c0a 2020 2020 2020  ate_keys,.      
-00018590: 2020 2020 2020 2020 2020 7374 6174 652c            state,
-000185a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000185b0: 2061 6374 696f 6e2c 0a20 2020 2020 2020   action,.       
-000185c0: 2020 2020 2020 2020 2072 6577 6172 642c           reward,
-000185d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000185e0: 2064 6f6e 652c 0a20 2020 2020 2020 2020   done,.         
-000185f0: 2020 2020 2020 2074 6572 6d69 6e61 6c2c         terminal,
-00018600: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00018610: 2069 6e66 6f2c 0a20 2020 2020 2020 2020   info,.         
-00018620: 2020 2020 2020 2070 7363 6f72 652c 0a20         pscore,. 
-00018630: 2020 2020 2020 2020 2020 2020 2020 2062                 b
-00018640: 6568 6176 696f 725f 706f 6c69 6379 2c0a  ehavior_policy,.
-00018650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018660: 6461 7461 7365 745f 6964 2c0a 2020 2020  dataset_id,.    
-00018670: 2020 2020 2020 2020 5d0a 0a20 2020 2020          ]..     
-00018680: 2020 202e 2e20 7365 6561 6c73 6f3a 3a0a     .. seealso::.
-00018690: 0a20 2020 2020 2020 2020 2020 203a 636c  .            :cl
-000186a0: 6173 733a 6073 636f 7065 5f72 6c2e 6461  ass:`scope_rl.da
-000186b0: 7461 7365 742e 5379 6e74 6865 7469 6344  taset.SyntheticD
-000186c0: 6174 6173 6574 6020 6465 7363 7269 6265  ataset` describe
-000186d0: 7320 7468 6520 636f 6d70 6f6e 656e 7473  s the components
-000186e0: 206f 6620 3a63 6c61 7373 3a60 6c6f 6767   of :class:`logg
-000186f0: 6564 5f64 6174 6173 6574 602e 0a0a 2020  ed_dataset`...  
-00018700: 2020 6f70 655f 6573 7469 6d61 746f 7273    ope_estimators
-00018710: 3a20 6c69 7374 206f 6620 4261 7365 4f66  : list of BaseOf
-00018720: 6650 6f6c 6963 7945 7374 696d 6174 6f72  fPolicyEstimator
-00018730: 0a20 2020 2020 2020 204c 6973 7420 6f66  .        List of
-00018740: 204f 5045 2065 7374 696d 6174 6f72 7320   OPE estimators 
-00018750: 7573 6564 2074 6f20 6576 616c 7561 7465  used to evaluate
-00018760: 2074 6865 2070 6f6c 6963 7920 7661 6c75   the policy valu
-00018770: 6520 6f66 2074 6865 2065 7661 6c75 6174  e of the evaluat
-00018780: 696f 6e20 706f 6c69 6369 6573 2e0a 2020  ion policies..  
-00018790: 2020 2020 2020 4573 7469 6d61 746f 7273        Estimators
-000187a0: 206d 7573 7420 666f 6c6c 6f77 2074 6865   must follow the
-000187b0: 2069 6e74 6572 6661 6365 206f 6620 6073   interface of `s
-000187c0: 636f 7065 5f72 6c2e 6f70 652e 4261 7365  cope_rl.ope.Base
-000187d0: 4375 6d75 6c61 7469 7665 4469 7374 7269  CumulativeDistri
-000187e0: 6275 7469 6f6e 4f50 4545 7374 696d 6174  butionOPEEstimat
-000187f0: 6f72 602e 0a0a 2020 2020 7573 655f 6375  or`...    use_cu
-00018800: 7374 6f6d 5f72 6577 6172 645f 7363 616c  stom_reward_scal
-00018810: 653a 2062 6f6f 6c2c 2064 6566 6175 6c74  e: bool, default
-00018820: 3d46 616c 7365 0a20 2020 2020 2020 2057  =False.        W
-00018830: 6865 7468 6572 2074 6f20 7573 6520 6120  hether to use a 
-00018840: 6375 7374 6f6d 697a 6564 2072 6577 6172  customized rewar
-00018850: 6420 7363 616c 6520 6f72 2074 6865 2072  d scale or the r
-00018860: 6577 6172 6420 6f62 7365 7276 6564 2075  eward observed u
-00018870: 6e64 6572 2074 6865 2062 6568 6176 696f  nder the behavio
-00018880: 7220 706f 6c69 6379 2e0a 0a20 2020 2020  r policy...     
-00018890: 2020 2049 6620 6054 7275 6560 2c20 7468     If `True`, th
-000188a0: 6520 7265 7761 7264 2073 6361 6c65 2069  e reward scale i
-000188b0: 7320 756e 6966 6f72 6d2c 2066 6f6c 6c6f  s uniform, follo
-000188c0: 7769 6e67 2048 7561 6e67 2065 7420 616c  wing Huang et al
-000188d0: 2e20 2832 3032 3129 2e0a 0a20 2020 2020  . (2021)...     
-000188e0: 2020 2049 6620 6046 616c 7365 602c 2074     If `False`, t
-000188f0: 6865 2072 6577 6172 6420 7363 616c 6520  he reward scale 
-00018900: 666f 6c6c 6f77 7320 7468 6520 6f6e 6520  follows the one 
-00018910: 6465 6669 6e65 6420 696e 2043 6875 6e64  defined in Chund
-00018920: 616b 2065 7420 616c 2e20 2832 3032 3129  ak et al. (2021)
-00018930: 2e0a 0a20 2020 2073 6361 6c65 5f6d 696e  ...    scale_min
-00018940: 3a20 666c 6f61 742c 2064 6566 6175 6c74  : float, default
-00018950: 3d4e 6f6e 650a 2020 2020 2020 2020 4d69  =None.        Mi
-00018960: 6e69 6d75 6d20 7661 6c75 6520 6f66 2074  nimum value of t
-00018970: 6865 2072 6577 6172 6420 7363 616c 6520  he reward scale 
-00018980: 696e 2074 6865 2043 4446 2e0a 2020 2020  in the CDF..    
-00018990: 2020 2020 4966 2075 7365 5f63 7573 746f      If use_custo
-000189a0: 6d5f 7265 7761 7264 5f73 6361 6c65 2069  m_reward_scale i
-000189b0: 7320 6054 7275 6560 2c20 6120 7661 6c75  s `True`, a valu
-000189c0: 6520 6d75 7374 2062 6520 6769 7665 6e2e  e must be given.
-000189d0: 0a0a 2020 2020 7363 616c 655f 6d61 783a  ..    scale_max:
-000189e0: 2066 6c6f 6174 2c20 6465 6661 756c 743d   float, default=
-000189f0: 4e6f 6e65 0a20 2020 2020 2020 204d 6178  None.        Max
-00018a00: 696d 756d 2076 616c 7565 206f 6620 7468  imum value of th
-00018a10: 6520 7265 7761 7264 2073 6361 6c65 2069  e reward scale i
-00018a20: 6e20 7468 6520 4344 462e 0a20 2020 2020  n the CDF..     
-00018a30: 2020 2049 6620 7573 655f 6375 7374 6f6d     If use_custom
-00018a40: 5f72 6577 6172 645f 7363 616c 6520 6973  _reward_scale is
-00018a50: 2060 5472 7565 602c 2061 2076 616c 7565   `True`, a value
-00018a60: 206d 7573 7420 6265 2067 6976 656e 2e0a   must be given..
-00018a70: 0a20 2020 206e 5f70 6172 7469 7469 6f6e  .    n_partition
-00018a80: 3a20 696e 742c 2064 6566 6175 6c74 3d4e  : int, default=N
-00018a90: 6f6e 650a 2020 2020 2020 2020 4e75 6d62  one.        Numb
-00018aa0: 6572 206f 6620 7061 7274 6974 696f 6e73  er of partitions
-00018ab0: 2069 6e20 7468 6520 7265 7761 7264 2073   in the reward s
-00018ac0: 6361 6c65 2028 782d 6178 6973 206f 6620  cale (x-axis of 
-00018ad0: 7468 6520 4344 4629 2e0a 2020 2020 2020  the CDF)..      
-00018ae0: 2020 4966 2075 7365 5f63 7573 746f 6d5f    If use_custom_
-00018af0: 7265 7761 7264 5f73 6361 6c65 2069 7320  reward_scale is 
-00018b00: 6054 7275 6560 2c20 6120 7661 6c75 6520  `True`, a value 
-00018b10: 6d75 7374 2062 6520 6769 7665 6e2e 0a0a  must be given...
-00018b20: 2020 2020 6261 6e64 7769 6474 683a 2066      bandwidth: f
-00018b30: 6c6f 6174 2c20 6465 6661 756c 743d 312e  loat, default=1.
-00018b40: 3020 283e 2030 290a 2020 2020 2020 2020  0 (> 0).        
-00018b50: 4261 6e64 7769 6474 6820 6879 7065 7270  Bandwidth hyperp
-00018b60: 6172 616d 6574 6572 206f 6620 7468 6520  arameter of the 
-00018b70: 6b65 726e 656c 2075 7365 6420 696e 2063  kernel used in c
-00018b80: 6f6e 7469 6e75 6f75 7320 6163 7469 6f6e  ontinuous action
-00018b90: 2063 6173 652e 0a0a 2020 2020 6163 7469   case...    acti
-00018ba0: 6f6e 5f73 6361 6c65 723a 2064 3372 6c70  on_scaler: d3rlp
-00018bb0: 792e 7072 6570 726f 6365 7373 696e 672e  y.preprocessing.
-00018bc0: 4163 7469 6f6e 5363 616c 6572 2c20 6465  ActionScaler, de
-00018bd0: 6661 756c 743d 4e6f 6e65 0a20 2020 2020  fault=None.     
-00018be0: 2020 2053 6361 6c69 6e67 2066 6163 746f     Scaling facto
-00018bf0: 7220 6f66 2061 6374 696f 6e2e 0a0a 2020  r of action...  
-00018c00: 2020 6469 7361 626c 655f 7265 7761 7264    disable_reward
-00018c10: 5f61 6674 6572 5f64 6f6e 653a 2062 6f6f  _after_done: boo
-00018c20: 6c2c 2064 6566 6175 6c74 3d54 7275 650a  l, default=True.
-00018c30: 2020 2020 2020 2020 5768 6574 6865 7220          Whether 
-00018c40: 746f 2061 7070 6c79 203a 6d61 7468 3a60  to apply :math:`
-00018c50: 7220 3d20 3060 206f 6e63 6520 646f 6e65  r = 0` once done
-00018c60: 2069 7320 6f62 7365 7276 6564 2069 6e20   is observed in 
-00018c70: 616e 2065 7069 736f 6465 2e0a 0a20 2020  an episode...   
-00018c80: 2045 7861 6d70 6c65 730a 2020 2020 2d2d   Examples.    --
-00018c90: 2d2d 2d2d 2d2d 2d2d 0a0a 2020 2020 5072  --------..    Pr
-00018ca0: 6570 6172 6174 696f 6e3a 0a0a 2020 2020  eparation:..    
-00018cb0: 2e2e 2063 6f64 652d 626c 6f63 6b3a 3a20  .. code-block:: 
-00018cc0: 7079 7468 6f6e 0a0a 2020 2020 2020 2020  python..        
-00018cd0: 2320 696d 706f 7274 206e 6563 6573 7361  # import necessa
-00018ce0: 7279 206d 6f64 756c 6520 6672 6f6d 2053  ry module from S
-00018cf0: 434f 5045 2d52 4c0a 2020 2020 2020 2020  COPE-RL.        
-00018d00: 6672 6f6d 2073 636f 7065 5f72 6c2e 6461  from scope_rl.da
-00018d10: 7461 7365 7420 696d 706f 7274 2053 796e  taset import Syn
-00018d20: 7468 6574 6963 4461 7461 7365 740a 2020  theticDataset.  
-00018d30: 2020 2020 2020 6672 6f6d 2073 636f 7065        from scope
-00018d40: 5f72 6c2e 706f 6c69 6379 2069 6d70 6f72  _rl.policy impor
-00018d50: 7420 4570 7369 6c6f 6e47 7265 6564 7948  t EpsilonGreedyH
-00018d60: 6561 640a 2020 2020 2020 2020 6672 6f6d  ead.        from
-00018d70: 2073 636f 7065 5f72 6c2e 6f70 6520 696d   scope_rl.ope im
-00018d80: 706f 7274 2043 7265 6174 654f 5045 496e  port CreateOPEIn
-00018d90: 7075 740a 2020 2020 2020 2020 6672 6f6d  put.        from
-00018da0: 2073 636f 7065 5f72 6c2e 6f70 6520 696d   scope_rl.ope im
-00018db0: 706f 7274 2043 756d 756c 6174 6976 6544  port CumulativeD
-00018dc0: 6973 7472 6962 7574 696f 6e4f 5045 0a20  istributionOPE. 
-00018dd0: 2020 2020 2020 2066 726f 6d20 7363 6f70         from scop
-00018de0: 655f 726c 2e6f 7065 2e64 6973 6372 6574  e_rl.ope.discret
-00018df0: 6520 696d 706f 7274 2043 756d 756c 6174  e import Cumulat
-00018e00: 6976 6544 6973 7472 6962 7574 696f 6e54  iveDistributionT
-00018e10: 4953 2061 7320 4344 5f49 530a 2020 2020  IS as CD_IS.    
-00018e20: 2020 2020 6672 6f6d 2073 636f 7065 5f72      from scope_r
-00018e30: 6c2e 6f70 652e 6469 7363 7265 7465 2069  l.ope.discrete i
-00018e40: 6d70 6f72 7420 4375 6d75 6c61 7469 7665  mport Cumulative
-00018e50: 4469 7374 7269 6275 7469 6f6e 534e 5449  DistributionSNTI
-00018e60: 5320 6173 2043 445f 534e 4953 0a0a 2020  S as CD_SNIS..  
-00018e70: 2020 2020 2020 2320 696d 706f 7274 206e        # import n
-00018e80: 6563 6573 7361 7279 206d 6f64 756c 6520  ecessary module 
-00018e90: 6672 6f6d 206f 7468 6572 206c 6962 7261  from other libra
-00018ea0: 7269 6573 0a20 2020 2020 2020 2069 6d70  ries.        imp
-00018eb0: 6f72 7420 6779 6d0a 2020 2020 2020 2020  ort gym.        
-00018ec0: 696d 706f 7274 2072 7462 6779 6d0a 2020  import rtbgym.  
-00018ed0: 2020 2020 2020 6672 6f6d 2064 3372 6c70        from d3rlp
-00018ee0: 792e 616c 676f 7320 696d 706f 7274 2044  y.algos import D
-00018ef0: 6f75 626c 6544 514e 0a20 2020 2020 2020  oubleDQN.       
-00018f00: 2066 726f 6d20 6433 726c 7079 2e6f 6e6c   from d3rlpy.onl
-00018f10: 696e 652e 6275 6666 6572 7320 696d 706f  ine.buffers impo
-00018f20: 7274 2052 6570 6c61 7942 7566 6665 720a  rt ReplayBuffer.
-00018f30: 2020 2020 2020 2020 6672 6f6d 2064 3372          from d3r
-00018f40: 6c70 792e 6f6e 6c69 6e65 2e65 7870 6c6f  lpy.online.explo
-00018f50: 7265 7273 2069 6d70 6f72 7420 436f 6e73  rers import Cons
-00018f60: 7461 6e74 4570 7369 6c6f 6e47 7265 6564  tantEpsilonGreed
-00018f70: 790a 0a20 2020 2020 2020 2023 2069 6e69  y..        # ini
-00018f80: 7469 616c 697a 6520 656e 7669 726f 6e6d  tialize environm
-00018f90: 656e 740a 2020 2020 2020 2020 656e 7620  ent.        env 
-00018fa0: 3d20 6779 6d2e 6d61 6b65 2822 5254 4245  = gym.make("RTBE
-00018fb0: 6e76 2d64 6973 6372 6574 652d 7630 2229  nv-discrete-v0")
-00018fc0: 0a0a 2020 2020 2020 2020 2320 666f 7220  ..        # for 
-00018fd0: 6170 6920 636f 6d70 6174 6962 696c 6974  api compatibilit
-00018fe0: 7920 746f 2064 3372 6c70 790a 2020 2020  y to d3rlpy.    
-00018ff0: 2020 2020 6672 6f6d 2073 636f 7065 5f72      from scope_r
-00019000: 6c2e 7574 696c 7320 696d 706f 7274 204f  l.utils import O
-00019010: 6c64 4779 6d41 5049 5772 6170 7065 720a  ldGymAPIWrapper.
-00019020: 2020 2020 2020 2020 656e 765f 203d 204f          env_ = O
-00019030: 6c64 4779 6d41 5049 5772 6170 7065 7228  ldGymAPIWrapper(
-00019040: 656e 7629 0a0a 2020 2020 2020 2020 2320  env)..        # 
-00019050: 6465 6669 6e65 2028 524c 2920 6167 656e  define (RL) agen
-00019060: 7420 2869 2e65 2e2c 2070 6f6c 6963 7929  t (i.e., policy)
-00019070: 2061 6e64 2074 7261 696e 206f 6e20 7468   and train on th
-00019080: 6520 656e 7669 726f 6e6d 656e 740a 2020  e environment.  
-00019090: 2020 2020 2020 6464 716e 203d 2044 6f75        ddqn = Dou
-000190a0: 626c 6544 514e 2829 0a20 2020 2020 2020  bleDQN().       
-000190b0: 2062 7566 6665 7220 3d20 5265 706c 6179   buffer = Replay
-000190c0: 4275 6666 6572 280a 2020 2020 2020 2020  Buffer(.        
-000190d0: 2020 2020 6d61 786c 656e 3d31 3030 3030      maxlen=10000
-000190e0: 2c0a 2020 2020 2020 2020 2020 2020 656e  ,.            en
-000190f0: 763d 656e 765f 2c0a 2020 2020 2020 2020  v=env_,.        
-00019100: 290a 2020 2020 2020 2020 6578 706c 6f72  ).        explor
-00019110: 6572 203d 2043 6f6e 7374 616e 7445 7073  er = ConstantEps
-00019120: 696c 6f6e 4772 6565 6479 280a 2020 2020  ilonGreedy(.    
-00019130: 2020 2020 2020 2020 6570 7369 6c6f 6e3d          epsilon=
-00019140: 302e 332c 0a20 2020 2020 2020 2029 0a20  0.3,.        ). 
-00019150: 2020 2020 2020 2064 6471 6e2e 6669 745f         ddqn.fit_
-00019160: 6f6e 6c69 6e65 280a 2020 2020 2020 2020  online(.        
-00019170: 2020 2020 656e 763d 656e 765f 2c0a 2020      env=env_,.  
-00019180: 2020 2020 2020 2020 2020 6275 6666 6572            buffer
-00019190: 3d62 7566 6665 722c 0a20 2020 2020 2020  =buffer,.       
-000191a0: 2020 2020 2065 7870 6c6f 7265 723d 6578       explorer=ex
-000191b0: 706c 6f72 6572 2c0a 2020 2020 2020 2020  plorer,.        
-000191c0: 2020 2020 6e5f 7374 6570 733d 3130 3030      n_steps=1000
-000191d0: 302c 0a20 2020 2020 2020 2020 2020 206e  0,.            n
-000191e0: 5f73 7465 7073 5f70 6572 5f65 706f 6368  _steps_per_epoch
-000191f0: 3d31 3030 302c 0a20 2020 2020 2020 2029  =1000,.        )
-00019200: 0a0a 2020 2020 2020 2020 2320 636f 6e76  ..        # conv
-00019210: 6572 7420 6464 716e 2070 6f6c 6963 7920  ert ddqn policy 
-00019220: 746f 2073 746f 6368 6173 7469 6320 6461  to stochastic da
-00019230: 7461 2063 6f6c 6c65 6374 696f 6e20 706f  ta collection po
-00019240: 6c69 6379 0a20 2020 2020 2020 2062 6568  licy.        beh
-00019250: 6176 696f 725f 706f 6c69 6379 203d 2045  avior_policy = E
-00019260: 7073 696c 6f6e 4772 6565 6479 4865 6164  psilonGreedyHead
-00019270: 280a 2020 2020 2020 2020 2020 2020 6464  (.            dd
-00019280: 716e 2c0a 2020 2020 2020 2020 2020 2020  qn,.            
-00019290: 6e5f 6163 7469 6f6e 733d 656e 762e 6163  n_actions=env.ac
-000192a0: 7469 6f6e 5f73 7061 6365 2e6e 2c0a 2020  tion_space.n,.  
-000192b0: 2020 2020 2020 2020 2020 6570 7369 6c6f            epsilo
-000192c0: 6e3d 302e 332c 0a20 2020 2020 2020 2020  n=0.3,.         
-000192d0: 2020 206e 616d 653d 2264 6471 6e5f 6570     name="ddqn_ep
-000192e0: 7369 6c6f 6e5f 302e 3322 2c0a 2020 2020  silon_0.3",.    
-000192f0: 2020 2020 2020 2020 7261 6e64 6f6d 5f73          random_s
-00019300: 7461 7465 3d31 3233 3435 2c0a 2020 2020  tate=12345,.    
-00019310: 2020 2020 290a 0a20 2020 2020 2020 2023      )..        #
-00019320: 2069 6e69 7469 616c 697a 6520 6461 7461   initialize data
-00019330: 7365 7420 636c 6173 730a 2020 2020 2020  set class.      
-00019340: 2020 6461 7461 7365 7420 3d20 5379 6e74    dataset = Synt
-00019350: 6865 7469 6344 6174 6173 6574 280a 2020  heticDataset(.  
-00019360: 2020 2020 2020 2020 2020 656e 763d 656e            env=en
-00019370: 762c 0a20 2020 2020 2020 2020 2020 206d  v,.            m
-00019380: 6178 5f65 7069 736f 6465 5f73 7465 7073  ax_episode_steps
-00019390: 3d65 6e76 2e73 7465 705f 7065 725f 6570  =env.step_per_ep
-000193a0: 6973 6f64 652c 0a20 2020 2020 2020 2029  isode,.        )
-000193b0: 0a0a 2020 2020 2020 2020 2320 6461 7461  ..        # data
-000193c0: 2063 6f6c 6c65 6374 696f 6e0a 2020 2020   collection.    
-000193d0: 2020 2020 6c6f 6767 6564 5f64 6174 6173      logged_datas
-000193e0: 6574 203d 2064 6174 6173 6574 2e6f 6274  et = dataset.obt
-000193f0: 6169 6e5f 6570 6973 6f64 6573 280a 2020  ain_episodes(.  
-00019400: 2020 2020 2020 2020 2020 6265 6861 7669            behavi
-00019410: 6f72 5f70 6f6c 6963 6965 733d 6265 6861  or_policies=beha
-00019420: 7669 6f72 5f70 6f6c 6963 792c 0a20 2020  vior_policy,.   
-00019430: 2020 2020 2020 2020 206e 5f74 7261 6a65           n_traje
-00019440: 6374 6f72 6965 733d 3130 302c 0a20 2020  ctories=100,.   
-00019450: 2020 2020 2020 2020 2072 616e 646f 6d5f           random_
-00019460: 7374 6174 653d 3132 3334 352c 0a20 2020  state=12345,.   
-00019470: 2020 2020 2029 0a0a 2020 2020 4372 6561       )..    Crea
-00019480: 7465 2049 6e70 7574 2066 6f72 204f 5045  te Input for OPE
-00019490: 3a0a 0a20 2020 202e 2e20 636f 6465 2d62  :..    .. code-b
-000194a0: 6c6f 636b 3a3a 2070 7974 686f 6e0a 0a20  lock:: python.. 
-000194b0: 2020 2020 2020 2023 2065 7661 6c75 6174         # evaluat
-000194c0: 696f 6e20 706f 6c69 6379 0a20 2020 2020  ion policy.     
-000194d0: 2020 2064 6471 6e5f 203d 2045 7073 696c     ddqn_ = Epsil
-000194e0: 6f6e 4772 6565 6479 4865 6164 280a 2020  onGreedyHead(.  
-000194f0: 2020 2020 2020 2020 2020 6261 7365 5f70            base_p
-00019500: 6f6c 6963 793d 6464 716e 2c0a 2020 2020  olicy=ddqn,.    
-00019510: 2020 2020 2020 2020 6e5f 6163 7469 6f6e          n_action
-00019520: 733d 656e 762e 6163 7469 6f6e 5f73 7061  s=env.action_spa
-00019530: 6365 2e6e 2c0a 2020 2020 2020 2020 2020  ce.n,.          
-00019540: 2020 6e61 6d65 3d22 6464 716e 222c 0a20    name="ddqn",. 
-00019550: 2020 2020 2020 2020 2020 2065 7073 696c             epsil
-00019560: 6f6e 3d30 2e30 2c0a 2020 2020 2020 2020  on=0.0,.        
-00019570: 2020 2020 7261 6e64 6f6d 5f73 7461 7465      random_state
-00019580: 3d31 3233 3435 0a20 2020 2020 2020 2029  =12345.        )
-00019590: 0a20 2020 2020 2020 2072 616e 646f 6d5f  .        random_
-000195a0: 203d 2045 7073 696c 6f6e 4772 6565 6479   = EpsilonGreedy
-000195b0: 4865 6164 280a 2020 2020 2020 2020 2020  Head(.          
-000195c0: 2020 6261 7365 5f70 6f6c 6963 793d 6464    base_policy=dd
-000195d0: 716e 2c0a 2020 2020 2020 2020 2020 2020  qn,.            
-000195e0: 6e5f 6163 7469 6f6e 733d 656e 762e 6163  n_actions=env.ac
-000195f0: 7469 6f6e 5f73 7061 6365 2e6e 2c0a 2020  tion_space.n,.  
-00019600: 2020 2020 2020 2020 2020 6e61 6d65 3d22            name="
-00019610: 7261 6e64 6f6d 222c 0a20 2020 2020 2020  random",.       
-00019620: 2020 2020 2065 7073 696c 6f6e 3d31 2e30       epsilon=1.0
-00019630: 2c0a 2020 2020 2020 2020 2020 2020 7261  ,.            ra
-00019640: 6e64 6f6d 5f73 7461 7465 3d31 3233 3435  ndom_state=12345
-00019650: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-00019660: 2020 2020 2320 6372 6561 7465 2069 6e70      # create inp
-00019670: 7574 2066 6f72 206f 6666 2d70 6f6c 6963  ut for off-polic
-00019680: 7920 6576 616c 7561 7469 6f6e 2028 4f50  y evaluation (OP
-00019690: 4529 0a20 2020 2020 2020 2070 7265 7020  E).        prep 
-000196a0: 3d20 4372 6561 7465 4f50 4549 6e70 7574  = CreateOPEInput
-000196b0: 280a 2020 2020 2020 2020 2020 2020 656e  (.            en
-000196c0: 763d 656e 762c 0a20 2020 2020 2020 2029  v=env,.        )
-000196d0: 0a20 2020 2020 2020 2069 6e70 7574 5f64  .        input_d
-000196e0: 6963 7420 3d20 7072 6570 2e6f 6274 6169  ict = prep.obtai
-000196f0: 6e5f 7768 6f6c 655f 696e 7075 7473 280a  n_whole_inputs(.
-00019700: 2020 2020 2020 2020 2020 2020 6c6f 6767              logg
-00019710: 6564 5f64 6174 6173 6574 3d6c 6f67 6765  ed_dataset=logge
-00019720: 645f 6461 7461 7365 742c 0a20 2020 2020  d_dataset,.     
-00019730: 2020 2020 2020 2065 7661 6c75 6174 696f         evaluatio
-00019740: 6e5f 706f 6c69 6369 6573 3d5b 6464 716e  n_policies=[ddqn
-00019750: 5f2c 2072 616e 646f 6d5f 5d2c 0a20 2020  _, random_],.   
-00019760: 2020 2020 2020 2020 206e 5f74 7261 6a65           n_traje
-00019770: 6374 6f72 6965 735f 6f6e 5f70 6f6c 6963  ctories_on_polic
-00019780: 795f 6576 616c 7561 7469 6f6e 3d31 3030  y_evaluation=100
-00019790: 2c0a 2020 2020 2020 2020 2020 2020 7261  ,.            ra
-000197a0: 6e64 6f6d 5f73 7461 7465 3d31 3233 3435  ndom_state=12345
-000197b0: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
-000197c0: 202a 2a43 756d 756c 6174 6976 6520 4469   **Cumulative Di
-000197d0: 7374 7269 6275 7469 6f6e 204f 5045 2a2a  stribution OPE**
-000197e0: 3a0a 0a20 2020 202e 2e20 636f 6465 2d62  :..    .. code-b
-000197f0: 6c6f 636b 3a3a 2070 7974 686f 6e0a 0a20  lock:: python.. 
-00019800: 2020 2020 2020 2023 204f 5045 0a20 2020         # OPE.   
-00019810: 2020 2020 2063 645f 6f70 6520 3d20 4375       cd_ope = Cu
-00019820: 6d75 6c61 7469 7665 4469 7374 7269 6275  mulativeDistribu
-00019830: 7469 6f6e 4f50 4528 0a20 2020 2020 2020  tionOPE(.       
-00019840: 2020 2020 206c 6f67 6765 645f 6461 7461       logged_data
-00019850: 7365 743d 6c6f 6767 6564 5f64 6174 6173  set=logged_datas
-00019860: 6574 2c0a 2020 2020 2020 2020 2020 2020  et,.            
-00019870: 6f70 655f 6573 7469 6d61 746f 7273 3d5b  ope_estimators=[
-00019880: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00019890: 2043 445f 4953 2865 7374 696d 6174 6f72   CD_IS(estimator
-000198a0: 5f6e 616d 653d 2263 645f 6973 2229 2c0a  _name="cd_is"),.
-000198b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000198c0: 4344 5f53 4e49 5328 6573 7469 6d61 746f  CD_SNIS(estimato
-000198d0: 725f 6e61 6d65 3d22 6364 5f73 6e69 7322  r_name="cd_snis"
-000198e0: 292c 0a20 2020 2020 2020 2020 2020 205d  ),.            ]
-000198f0: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
-00019900: 2020 2020 7661 7269 616e 6365 5f64 6963      variance_dic
-00019910: 7420 3d20 6364 5f6f 7065 2e65 7374 696d  t = cd_ope.estim
-00019920: 6174 655f 7661 7269 616e 6365 280a 2020  ate_variance(.  
-00019930: 2020 2020 2020 2020 2020 696e 7075 745f            input_
-00019940: 6469 6374 3d69 6e70 7574 5f64 6963 742c  dict=input_dict,
-00019950: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-00019960: 2a2a 4f75 7470 7574 2a2a 3a0a 0a20 2020  **Output**:..   
-00019970: 202e 2e20 636f 6465 2d62 6c6f 636b 3a3a   .. code-block::
-00019980: 2070 7974 686f 6e0a 0a20 2020 2020 2020   python..       
-00019990: 203e 3e3e 2076 6172 6961 6e63 655f 6469   >>> variance_di
-000199a0: 6374 0a0a 2020 2020 2020 2020 7b27 6464  ct..        {'dd
-000199b0: 716e 273a 207b 276f 6e5f 706f 6c69 6379  qn': {'on_policy
-000199c0: 273a 2031 382e 3632 3136 2c20 2763 6466  ': 18.6216, 'cdf
-000199d0: 5f69 7327 3a20 3139 2e32 3031 3933 3438  _is': 19.2019348
-000199e0: 3038 3334 3032 3635 2c20 2763 6466 5f73  08340265, 'cdf_s
-000199f0: 6e69 7327 3a20 3235 2e33 3135 3535 3535  nis': 25.3155555
-00019a00: 3535 3535 3535 3535 7d2c 0a20 2020 2020  55555555},.     
-00019a10: 2020 2027 7261 6e64 6f6d 273a 207b 276f     'random': {'o
-00019a20: 6e5f 706f 6c69 6379 273a 2032 312e 3531  n_policy': 21.51
-00019a30: 3238 3036 3838 3730 3233 3036 342c 2027  2806887023064, '
-00019a40: 6364 665f 6973 273a 2031 332e 3539 3138  cdf_is': 13.5918
-00019a50: 3534 3930 3236 3338 3237 332c 2027 6364  54902638273, 'cd
-00019a60: 665f 736e 6973 273a 2037 2e31 3538 3534  f_snis': 7.15854
-00019a70: 3535 3330 3335 3639 3134 7d7d 0a0a 2020  5530356914}}..  
-00019a80: 2020 2e2e 2073 6565 616c 736f 3a3a 0a0a    .. seealso::..
-00019a90: 2020 2020 2020 2020 2a20 3a64 6f63 3a60          * :doc:`
-00019aa0: 5175 6963 6b73 7461 7274 203c 2f64 6f63  Quickstart </doc
-00019ab0: 756d 656e 7461 7469 6f6e 2f71 7569 636b  umentation/quick
-00019ac0: 7374 6172 743e 600a 2020 2020 2020 2020  start>`.        
-00019ad0: 2a20 3a64 6f63 3a60 5265 6c61 7465 6420  * :doc:`Related 
-00019ae0: 7475 746f 7269 616c 7320 3c2f 646f 6375  tutorials </docu
-00019af0: 6d65 6e74 6174 696f 6e2f 6578 616d 706c  mentation/exampl
-00019b00: 6573 2f63 756d 756c 6174 6976 655f 6469  es/cumulative_di
-00019b10: 7374 5f6f 7065 3e60 0a0a 2020 2020 5265  st_ope>`..    Re
-00019b20: 6665 7265 6e63 6573 0a20 2020 202d 2d2d  ferences.    ---
-00019b30: 2d2d 2d2d 0a20 2020 2041 7564 7265 7920  ----.    Audrey 
-00019b40: 4875 616e 672c 204c 6975 204c 6571 692c  Huang, Liu Leqi,
-00019b50: 205a 6163 6861 7279 2043 2e20 4c69 7074   Zachary C. Lipt
-00019b60: 6f6e 2c20 616e 6420 4b61 6d79 6172 2041  on, and Kamyar A
-00019b70: 7a69 7a7a 6164 656e 6573 6865 6c69 2e0a  zizzadenesheli..
-00019b80: 2020 2020 224f 6666 2d50 6f6c 6963 7920      "Off-Policy 
-00019b90: 5269 736b 2041 7373 6573 736d 656e 7420  Risk Assessment 
-00019ba0: 666f 7220 4d61 726b 6f76 2044 6563 6973  for Markov Decis
-00019bb0: 696f 6e20 5072 6f63 6573 7365 732e 2220  ion Processes." 
-00019bc0: 3230 3232 2e0a 0a20 2020 2041 7564 7265  2022...    Audre
-00019bd0: 7920 4875 616e 672c 204c 6975 204c 6571  y Huang, Liu Leq
-00019be0: 692c 205a 6163 6861 7279 2043 2e20 4c69  i, Zachary C. Li
-00019bf0: 7074 6f6e 2c20 616e 6420 4b61 6d79 6172  pton, and Kamyar
-00019c00: 2041 7a69 7a7a 6164 656e 6573 6865 6c69   Azizzadenesheli
-00019c10: 2e0a 2020 2020 224f 6666 2d50 6f6c 6963  ..    "Off-Polic
-00019c20: 7920 5269 736b 2041 7373 6573 736d 656e  y Risk Assessmen
-00019c30: 7420 696e 2043 6f6e 7465 7874 7561 6c20  t in Contextual 
-00019c40: 4261 6e64 6974 732e 2220 3230 3231 2e0a  Bandits." 2021..
-00019c50: 0a20 2020 2059 6173 6820 4368 616e 6461  .    Yash Chanda
-00019c60: 6b2c 2053 636f 7474 204e 6965 6b75 6d2c  k, Scott Niekum,
-00019c70: 2042 7275 6e6f 2043 6173 7472 6f20 6461   Bruno Castro da
-00019c80: 2053 696c 7661 2c20 4572 696b 204c 6561   Silva, Erik Lea
-00019c90: 726e 6564 2d4d 696c 6c65 722c 2045 6d6d  rned-Miller, Emm
-00019ca0: 6120 4272 756e 736b 696c 6c2c 2061 6e64  a Brunskill, and
-00019cb0: 2050 6869 6c69 7020 532e 2054 686f 6d61   Philip S. Thoma
-00019cc0: 732e 0a20 2020 2022 556e 6976 6572 7361  s..    "Universa
-00019cd0: 6c20 4f66 662d 506f 6c69 6379 2045 7661  l Off-Policy Eva
-00019ce0: 6c75 6174 696f 6e2e 2220 3230 3231 2e0a  luation." 2021..
-00019cf0: 0a20 2020 2022 2222 0a0a 2020 2020 6c6f  .    """..    lo
-00019d00: 6767 6564 5f64 6174 6173 6574 3a20 556e  gged_dataset: Un
-00019d10: 696f 6e5b 4c6f 6767 6564 4461 7461 7365  ion[LoggedDatase
-00019d20: 742c 204d 756c 7469 706c 654c 6f67 6765  t, MultipleLogge
-00019d30: 6444 6174 6173 6574 5d0a 2020 2020 6f70  dDataset].    op
-00019d40: 655f 6573 7469 6d61 746f 7273 3a20 4c69  e_estimators: Li
-00019d50: 7374 5b42 6173 654f 6666 506f 6c69 6379  st[BaseOffPolicy
-00019d60: 4573 7469 6d61 746f 725d 0a20 2020 2075  Estimator].    u
-00019d70: 7365 5f63 7573 746f 6d5f 7265 7761 7264  se_custom_reward
-00019d80: 5f73 6361 6c65 3a20 626f 6f6c 203d 2046  _scale: bool = F
-00019d90: 616c 7365 0a20 2020 2073 6361 6c65 5f6d  alse.    scale_m
-00019da0: 696e 3a20 4f70 7469 6f6e 616c 5b66 6c6f  in: Optional[flo
-00019db0: 6174 5d20 3d20 4e6f 6e65 0a20 2020 2073  at] = None.    s
-00019dc0: 6361 6c65 5f6d 6178 3a20 4f70 7469 6f6e  cale_max: Option
-00019dd0: 616c 5b66 6c6f 6174 5d20 3d20 4e6f 6e65  al[float] = None
-00019de0: 0a20 2020 206e 5f70 6172 7469 7469 6f6e  .    n_partition
-00019df0: 3a20 4f70 7469 6f6e 616c 5b69 6e74 5d20  : Optional[int] 
-00019e00: 3d20 4e6f 6e65 0a20 2020 2062 616e 6477  = None.    bandw
-00019e10: 6964 7468 3a20 666c 6f61 7420 3d20 312e  idth: float = 1.
-00019e20: 300a 2020 2020 6163 7469 6f6e 5f73 6361  0.    action_sca
-00019e30: 6c65 723a 204f 7074 696f 6e61 6c5b 4163  ler: Optional[Ac
-00019e40: 7469 6f6e 5363 616c 6572 5d20 3d20 4e6f  tionScaler] = No
-00019e50: 6e65 0a20 2020 2064 6973 6162 6c65 5f72  ne.    disable_r
-00019e60: 6577 6172 645f 6166 7465 725f 646f 6e65  eward_after_done
-00019e70: 3a20 626f 6f6c 203d 2054 7275 650a 0a20  : bool = True.. 
-00019e80: 2020 2064 6566 205f 5f70 6f73 745f 696e     def __post_in
-00019e90: 6974 5f5f 2873 656c 6629 202d 3e20 4e6f  it__(self) -> No
-00019ea0: 6e65 3a0a 2020 2020 2020 2020 2249 6e69  ne:.        "Ini
-00019eb0: 7469 616c 697a 6520 636c 6173 732e 220a  tialize class.".
-00019ec0: 2020 2020 2020 2020 7365 6c66 2e75 7365          self.use
-00019ed0: 5f6d 756c 7469 706c 655f 6c6f 6767 6564  _multiple_logged
-00019ee0: 5f64 6174 6173 6574 203d 2046 616c 7365  _dataset = False
-00019ef0: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
-00019f00: 7374 616e 6365 2873 656c 662e 6c6f 6767  stance(self.logg
-00019f10: 6564 5f64 6174 6173 6574 2c20 4d75 6c74  ed_dataset, Mult
-00019f20: 6970 6c65 4c6f 6767 6564 4461 7461 7365  ipleLoggedDatase
-00019f30: 7429 3a0a 2020 2020 2020 2020 2020 2020  t):.            
-00019f40: 7365 6c66 2e6d 756c 7469 706c 655f 6c6f  self.multiple_lo
-00019f50: 6767 6564 5f64 6174 6173 6574 203d 2073  gged_dataset = s
-00019f60: 656c 662e 6c6f 6767 6564 5f64 6174 6173  elf.logged_datas
-00019f70: 6574 0a20 2020 2020 2020 2020 2020 2073  et.            s
-00019f80: 656c 662e 6c6f 6767 6564 5f64 6174 6173  elf.logged_datas
-00019f90: 6574 203d 2073 656c 662e 6d75 6c74 6970  et = self.multip
-00019fa0: 6c65 5f6c 6f67 6765 645f 6461 7461 7365  le_logged_datase
-00019fb0: 742e 6765 7428 0a20 2020 2020 2020 2020  t.get(.         
-00019fc0: 2020 2020 2020 2062 6568 6176 696f 725f         behavior_
-00019fd0: 706f 6c69 6379 5f6e 616d 653d 7365 6c66  policy_name=self
-00019fe0: 2e6d 756c 7469 706c 655f 6c6f 6767 6564  .multiple_logged
-00019ff0: 5f64 6174 6173 6574 2e62 6568 6176 696f  _dataset.behavio
-0001a000: 725f 706f 6c69 6379 5f6e 616d 6573 5b0a  r_policy_names[.
-0001a010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a020: 2020 2020 300a 2020 2020 2020 2020 2020      0.          
-0001a030: 2020 2020 2020 5d2c 0a20 2020 2020 2020        ],.       
-0001a040: 2020 2020 2020 2020 2064 6174 6173 6574           dataset
-0001a050: 5f69 643d 302c 0a20 2020 2020 2020 2020  _id=0,.         
-0001a060: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-0001a070: 2073 656c 662e 7573 655f 6d75 6c74 6970   self.use_multip
-0001a080: 6c65 5f6c 6f67 6765 645f 6461 7461 7365  le_logged_datase
-0001a090: 7420 3d20 5472 7565 0a0a 2020 2020 2020  t = True..      
-0001a0a0: 2020 6368 6563 6b5f 6c6f 6767 6564 5f64    check_logged_d
-0001a0b0: 6174 6173 6574 2873 656c 662e 6c6f 6767  ataset(self.logg
-0001a0c0: 6564 5f64 6174 6173 6574 290a 2020 2020  ed_dataset).    
-0001a0d0: 2020 2020 7365 6c66 2e73 7465 705f 7065      self.step_pe
-0001a0e0: 725f 7472 616a 6563 746f 7279 203d 2073  r_trajectory = s
-0001a0f0: 656c 662e 6c6f 6767 6564 5f64 6174 6173  elf.logged_datas
-0001a100: 6574 5b22 7374 6570 5f70 6572 5f74 7261  et["step_per_tra
-0001a110: 6a65 6374 6f72 7922 5d0a 2020 2020 2020  jectory"].      
-0001a120: 2020 7365 6c66 2e61 6374 696f 6e5f 7479    self.action_ty
-0001a130: 7065 203d 2073 656c 662e 6c6f 6767 6564  pe = self.logged
-0001a140: 5f64 6174 6173 6574 5b22 6163 7469 6f6e  _dataset["action
-0001a150: 5f74 7970 6522 5d0a 0a20 2020 2020 2020  _type"]..       
-0001a160: 2069 6620 6e6f 7420 7365 6c66 2e75 7365   if not self.use
-0001a170: 5f6d 756c 7469 706c 655f 6c6f 6767 6564  _multiple_logged
-0001a180: 5f64 6174 6173 6574 3a0a 2020 2020 2020  _dataset:.      
-0001a190: 2020 2020 2020 7365 6c66 2e5f 7265 6769        self._regi
-0001a1a0: 7374 6572 5f6c 6f67 6765 645f 6461 7461  ster_logged_data
-0001a1b0: 7365 7428 290a 0a20 2020 2020 2020 2073  set()..        s
-0001a1c0: 656c 662e 6f70 655f 6573 7469 6d61 746f  elf.ope_estimato
-0001a1d0: 7273 5f20 3d20 6469 6374 2829 0a20 2020  rs_ = dict().   
-0001a1e0: 2020 2020 2066 6f72 2065 7374 696d 6174       for estimat
-0001a1f0: 6f72 2069 6e20 7365 6c66 2e6f 7065 5f65  or in self.ope_e
-0001a200: 7374 696d 6174 6f72 733a 0a20 2020 2020  stimators:.     
-0001a210: 2020 2020 2020 2073 656c 662e 6f70 655f         self.ope_
-0001a220: 6573 7469 6d61 746f 7273 5f5b 6573 7469  estimators_[esti
-0001a230: 6d61 746f 722e 6573 7469 6d61 746f 725f  mator.estimator_
-0001a240: 6e61 6d65 5d20 3d20 6573 7469 6d61 746f  name] = estimato
-0001a250: 720a 0a20 2020 2020 2020 2020 2020 2069  r..            i
-0001a260: 6620 6573 7469 6d61 746f 722e 6163 7469  f estimator.acti
-0001a270: 6f6e 5f74 7970 6520 213d 2073 656c 662e  on_type != self.
-0001a280: 6163 7469 6f6e 5f74 7970 653a 0a20 2020  action_type:.   
-0001a290: 2020 2020 2020 2020 2020 2020 2072 6169               rai
-0001a2a0: 7365 2052 756e 7469 6d65 4572 726f 7228  se RuntimeError(
-0001a2b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001a2c0: 2020 2020 2066 224f 6e65 206f 6620 7468       f"One of th
-0001a2d0: 6520 6f70 655f 6573 7469 6d61 746f 7273  e ope_estimators
-0001a2e0: 2c20 7b65 7374 696d 6174 6f72 2e65 7374  , {estimator.est
-0001a2f0: 696d 6174 6f72 5f6e 616d 657d 2064 6f65  imator_name} doe
-0001a300: 7320 6e6f 7420 6d61 7463 6820 7468 6520  s not match the 
-0001a310: 6163 7469 6f6e 5f74 7970 6520 6f66 206c  action_type of l
-0001a320: 6f67 6765 645f 6461 7461 7365 7420 2860  ogged_dataset (`
-0001a330: 7b73 656c 662e 6163 7469 6f6e 5f74 7970  {self.action_typ
-0001a340: 657d 6029 220a 2020 2020 2020 2020 2020  e}`)".          
-0001a350: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-0001a360: 2020 2020 2069 6620 6e6f 7420 6973 696e       if not isin
-0001a370: 7374 616e 6365 2865 7374 696d 6174 6f72  stance(estimator
-0001a380: 2c20 4261 7365 4375 6d75 6c61 7469 7665  , BaseCumulative
-0001a390: 4469 7374 7269 6275 7469 6f6e 4f50 4545  DistributionOPEE
-0001a3a0: 7374 696d 6174 6f72 293a 0a20 2020 2020  stimator):.     
-0001a3b0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-0001a3c0: 2052 756e 7469 6d65 4572 726f 7228 0a20   RuntimeError(. 
-0001a3d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a3e0: 2020 2066 226f 7065 5f65 7374 696d 6174     f"ope_estimat
-0001a3f0: 6f72 7320 6d75 7374 2062 6520 6368 696c  ors must be chil
-0001a400: 6420 636c 6173 7365 7320 6f66 2042 6173  d classes of Bas
-0001a410: 6543 756d 756c 6174 6976 6544 6973 7472  eCumulativeDistr
-0001a420: 6962 7574 696f 6e4f 5045 4573 7469 6d61  ibutionOPEEstima
-0001a430: 746f 722c 2062 7574 206f 6e65 206f 6620  tor, but one of 
-0001a440: 7468 656d 2c20 7b65 7374 696d 6174 6f72  them, {estimator
-0001a450: 2e65 7374 696d 6174 6f72 5f6e 616d 657d  .estimator_name}
-0001a460: 2069 7320 6e6f 7422 0a20 2020 2020 2020   is not".       
-0001a470: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-0001a480: 2020 2020 6966 2073 656c 662e 7573 655f      if self.use_
-0001a490: 6375 7374 6f6d 5f72 6577 6172 645f 7363  custom_reward_sc
-0001a4a0: 616c 653a 0a20 2020 2020 2020 2020 2020  ale:.           
-0001a4b0: 2069 6620 7365 6c66 2e73 6361 6c65 5f6d   if self.scale_m
-0001a4c0: 696e 2069 7320 4e6f 6e65 3a0a 2020 2020  in is None:.    
-0001a4d0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-0001a4e0: 6520 5661 6c75 6545 7272 6f72 280a 2020  e ValueError(.  
-0001a4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a500: 2020 2273 6361 6c65 5f6d 696e 206d 7573    "scale_min mus
-0001a510: 7420 6265 2067 6976 656e 2077 6865 6e20  t be given when 
-0001a520: 6075 7365 5f63 7573 746f 6d5f 7265 7761  `use_custom_rewa
-0001a530: 7264 5f73 6361 6c65 203d 3d20 5472 7565  rd_scale == True
-0001a540: 6022 0a20 2020 2020 2020 2020 2020 2020  `".             
-0001a550: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-0001a560: 2069 6620 7365 6c66 2e73 6361 6c65 5f6d   if self.scale_m
-0001a570: 6178 2069 7320 4e6f 6e65 3a0a 2020 2020  ax is None:.    
-0001a580: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-0001a590: 6520 5661 6c75 6545 7272 6f72 280a 2020  e ValueError(.  
-0001a5a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a5b0: 2020 2273 6361 6c65 5f6d 6178 206d 7573    "scale_max mus
-0001a5c0: 7420 6265 2067 6976 656e 2077 6865 6e20  t be given when 
-0001a5d0: 6075 7365 5f63 7573 746f 6d5f 7265 7761  `use_custom_rewa
-0001a5e0: 7264 5f73 6361 6c65 203d 3d20 5472 7565  rd_scale == True
-0001a5f0: 6022 0a20 2020 2020 2020 2020 2020 2020  `".             
-0001a600: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-0001a610: 2069 6620 7365 6c66 2e6e 5f70 6172 7469   if self.n_parti
-0001a620: 7469 6f6e 2069 7320 4e6f 6e65 3a0a 2020  tion is None:.  
-0001a630: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-0001a640: 6973 6520 5661 6c75 6545 7272 6f72 280a  ise ValueError(.
-0001a650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a660: 2020 2020 226e 5f70 6172 7469 7469 6f6e      "n_partition
-0001a670: 206d 7573 7420 6265 2067 6976 656e 2077   must be given w
-0001a680: 6865 6e20 6075 7365 5f63 7573 746f 6d5f  hen `use_custom_
-0001a690: 7265 7761 7264 5f73 6361 6c65 203d 3d20  reward_scale == 
-0001a6a0: 5472 7565 6022 0a20 2020 2020 2020 2020  True`".         
-0001a6b0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0001a6c0: 2020 2020 2063 6865 636b 5f73 6361 6c61       check_scala
-0001a6d0: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
-0001a6e0: 2020 2073 656c 662e 7363 616c 655f 6d69     self.scale_mi
-0001a6f0: 6e2c 0a20 2020 2020 2020 2020 2020 2020  n,.             
-0001a700: 2020 206e 616d 653d 2273 6361 6c65 5f6d     name="scale_m
-0001a710: 696e 222c 0a20 2020 2020 2020 2020 2020  in",.           
-0001a720: 2020 2020 2074 6172 6765 745f 7479 7065       target_type
-0001a730: 3d66 6c6f 6174 2c0a 2020 2020 2020 2020  =float,.        
-0001a740: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-0001a750: 2020 6368 6563 6b5f 7363 616c 6172 280a    check_scalar(.
-0001a760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a770: 7365 6c66 2e73 6361 6c65 5f6d 6178 2c0a  self.scale_max,.
+00017c30: 6178 2e73 6574 5f78 7469 636b 7328 6e70  ax.set_xticks(np
+00017c40: 2e61 7261 6e67 6528 6e5f 6576 616c 5f70  .arange(n_eval_p
+00017c50: 6f6c 6963 6965 7329 2c20 6c69 7374 2869  olicies), list(i
+00017c60: 6e70 7574 5f64 6963 745f 302e 6b65 7973  nput_dict_0.keys
+00017c70: 2829 2929 0a20 2020 2020 2020 2020 2020  ())).           
+00017c80: 2020 2020 2020 2020 2070 6c74 2e79 7469           plt.yti
+00017c90: 636b 7328 666f 6e74 7369 7a65 3d31 3229  cks(fontsize=12)
+00017ca0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00017cb0: 2020 2020 2070 6c74 2e78 7469 636b 7328       plt.xticks(
+00017cc0: 666f 6e74 7369 7a65 3d31 3229 0a0a 2020  fontsize=12)..  
+00017cd0: 2020 2020 2020 6669 672e 7375 6270 6c6f        fig.subplo
+00017ce0: 7473 5f61 646a 7573 7428 746f 703d 312e  ts_adjust(top=1.
+00017cf0: 3029 0a20 2020 2020 2020 2070 6c74 2e73  0).        plt.s
+00017d00: 686f 7728 290a 0a20 2020 2020 2020 2069  how()..        i
+00017d10: 6620 6669 675f 6469 723a 0a20 2020 2020  f fig_dir:.     
+00017d20: 2020 2020 2020 2066 6967 2e73 6176 6566         fig.savef
+00017d30: 6967 2873 7472 2866 6967 5f64 6972 202f  ig(str(fig_dir /
+00017d40: 2066 6967 5f6e 616d 6529 2c20 6470 693d   fig_name), dpi=
+00017d50: 3330 302c 2062 626f 785f 696e 6368 6573  300, bbox_inches
+00017d60: 3d22 7469 6768 7422 290a 0a20 2020 2040  ="tight")..    @
+00017d70: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
+00017d80: 2065 7374 696d 6174 6f72 735f 6e61 6d65   estimators_name
+00017d90: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00017da0: 7265 7475 726e 206c 6973 7428 7365 6c66  return list(self
+00017db0: 2e6f 7065 5f65 7374 696d 6174 6f72 735f  .ope_estimators_
+00017dc0: 2e6b 6579 7328 2929 0a0a 0a40 6461 7461  .keys())...@data
+00017dd0: 636c 6173 730a 636c 6173 7320 4375 6d75  class.class Cumu
+00017de0: 6c61 7469 7665 4469 7374 7269 6275 7469  lativeDistributi
+00017df0: 6f6e 4f50 453a 0a20 2020 2022 2222 436c  onOPE:.    """Cl
+00017e00: 6173 7320 746f 2063 6f6e 6475 6374 2063  ass to conduct c
+00017e10: 756d 756c 6174 6976 6520 6469 7374 7269  umulative distri
+00017e20: 6275 7469 6f6e 204f 5045 2062 7920 6d75  bution OPE by mu
+00017e30: 6c74 6970 6c65 2065 7374 696d 6174 6f72  ltiple estimator
+00017e40: 7320 7369 6d75 6c74 616e 656f 7573 6c79  s simultaneously
+00017e50: 2028 6170 706c 6963 6162 6c65 2074 6f20   (applicable to 
+00017e60: 626f 7468 2064 6973 6372 6574 652f 636f  both discrete/co
+00017e70: 6e74 696e 756f 7573 2061 6374 696f 6e20  ntinuous action 
+00017e80: 6361 7365 7329 2e0a 0a20 2020 2049 6d70  cases)...    Imp
+00017e90: 6f72 7465 6420 6173 3a20 3a63 6c61 7373  orted as: :class
+00017ea0: 3a60 7363 6f70 655f 726c 2e6f 7065 2e43  :`scope_rl.ope.C
+00017eb0: 756d 7574 6976 6544 6973 7472 6962 7574  umutiveDistribut
+00017ec0: 696f 6e4f 5045 600a 0a20 2020 204e 6f74  ionOPE`..    Not
+00017ed0: 650a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  e.    ----------
+00017ee0: 2d0a 2020 2020 4375 6d75 6c61 7469 7665  -.    Cumulative
+00017ef0: 2064 6973 7472 6962 7574 696f 6e20 4f50   distribution OP
+00017f00: 4520 6669 7273 7420 6573 7469 6d61 7465  E first estimate
+00017f10: 7320 7468 6520 666f 6c6c 6f77 696e 6720  s the following 
+00017f20: 6375 6d75 6c61 7469 7665 2064 6973 7472  cumulative distr
+00017f30: 6962 7574 696f 6e20 6675 6e63 7469 6f6e  ibution function
+00017f40: 2c20 616e 6420 7468 656e 2065 7374 696d  , and then estim
+00017f50: 6174 6573 2073 6f6d 6520 7374 6174 6973  ates some statis
+00017f60: 7469 6373 2e0a 0a20 2020 202e 2e20 6d61  tics...    .. ma
+00017f70: 7468 3a3a 0a0a 2020 2020 2020 2020 4628  th::..        F(
+00017f80: 6d2c 205c 5c70 6929 203a 3d20 5c5c 6d61  m, \\pi) := \\ma
+00017f90: 7468 6262 7b45 7d20 5c5c 6c65 6674 5b20  thbb{E} \\left[ 
+00017fa0: 5c5c 6d61 7468 6262 7b49 7d20 5c5c 6c65  \\mathbb{I} \\le
+00017fb0: 6674 205c 5c7b 205c 5c73 756d 5f7b 743d  ft \\{ \\sum_{t=
+00017fc0: 307d 5e7b 542d 317d 205c 5c67 616d 6d61  0}^{T-1} \\gamma
+00017fd0: 5e74 2072 5f74 205c 5c6c 6571 206d 205c  ^t r_t \\leq m \
+00017fe0: 5c72 6967 6874 205c 5c7d 205c 5c6d 6964  \right \\} \\mid
+00017ff0: 205c 5c70 6920 5c5c 7269 6768 745d 0a0a   \\pi \\right]..
+00018000: 2020 2020 7768 6572 6520 3a6d 6174 683a      where :math:
+00018010: 605c 5c70 6960 2069 7320 7468 6520 6576  `\\pi` is the ev
+00018020: 616c 7561 7469 6f6e 2070 6f6c 6963 792c  aluation policy,
+00018030: 203a 6d61 7468 3a60 725f 7460 2069 7320   :math:`r_t` is 
+00018040: 7468 6520 7265 7761 7264 206f 6273 6572  the reward obser
+00018050: 7665 6420 6174 2065 6163 6820 7469 6d65  ved at each time
+00018060: 7374 6570 203a 6d61 7468 3a60 7460 2c0a  step :math:`t`,.
+00018070: 2020 2020 3a6d 6174 683a 6054 6020 6973      :math:`T` is
+00018080: 2074 6865 2074 6f74 616c 206e 756d 6265   the total numbe
+00018090: 7220 6f66 2074 696d 6573 7465 7073 2069  r of timesteps i
+000180a0: 6e20 616e 2065 7069 736f 6465 2c20 616e  n an episode, an
+000180b0: 6420 3a6d 6174 683a 605c 5c67 616d 6d61  d :math:`\\gamma
+000180c0: 6020 6973 2074 6865 2064 6973 636f 756e  ` is the discoun
+000180d0: 7420 6661 6374 6f72 2e0a 0a20 2020 2043  t factor...    C
+000180e0: 4446 2069 7320 6974 7365 6c66 2069 6e66  DF is itself inf
+000180f0: 6f72 6d61 7469 7665 2c20 6275 7420 6974  ormative, but it
+00018100: 2061 6c73 6f20 656e 6162 6c65 7320 7573   also enables us
+00018110: 2074 6f20 6361 6c63 756c 6174 6520 7468   to calculate th
+00018120: 6520 666f 6c6c 6f77 696e 6720 7269 736b  e following risk
+00018130: 2066 756e 6374 696f 6e73 2e0a 0a20 2020   functions...   
+00018140: 202a 204d 6561 6e3a 203a 6d61 7468 3a60   * Mean: :math:`
+00018150: 5c5c 6d75 2846 2920 3a3d 205c 5c69 6e74  \\mu(F) := \\int
+00018160: 5f7b 477d 2047 205c 5c2c 205c 5c6d 6174  _{G} G \\, \\mat
+00018170: 6872 6d7b 647d 4628 4729 600a 2020 2020  hrm{d}F(G)`.    
+00018180: 2a20 5661 7269 616e 6365 3a20 3a6d 6174  * Variance: :mat
+00018190: 683a 605c 5c73 6967 6d61 5e32 2846 2920  h:`\\sigma^2(F) 
+000181a0: 3a3d 205c 5c69 6e74 5f7b 477d 2028 4720  := \\int_{G} (G 
+000181b0: 2d20 5c5c 6d75 2846 2929 5e32 205c 5c2c  - \\mu(F))^2 \\,
+000181c0: 205c 5c6d 6174 6872 6d7b 647d 4628 4729   \\mathrm{d}F(G)
+000181d0: 600a 2020 2020 2a20 3a6d 6174 683a 605c  `.    * :math:`\
+000181e0: 5c61 6c70 6861 602d 7175 6172 7469 6c65  \alpha`-quartile
+000181f0: 3a20 3a6d 6174 683a 6051 5e7b 5c5c 616c  : :math:`Q^{\\al
+00018200: 7068 617d 2846 2920 3a3d 205c 5c6d 696e  pha}(F) := \\min
+00018210: 205c 5c7b 2047 205c 5c6d 6964 2046 2847   \\{ G \\mid F(G
+00018220: 2920 5c5c 6c65 7120 5c5c 616c 7068 6120  ) \\leq \\alpha 
+00018230: 5c5c 7d60 0a20 2020 202a 2043 6f6e 6469  \\}`.    * Condi
+00018240: 7469 6f6e 616c 2056 616c 7565 2061 7420  tional Value at 
+00018250: 5269 736b 2028 4356 6152 293a 203a 6d61  Risk (CVaR): :ma
+00018260: 7468 3a60 5c5c 696e 745f 7b47 7d20 4720  th:`\\int_{G} G 
+00018270: 5c5c 2c20 5c6d 6174 6862 627b 497d 5c5c  \\, \mathbb{I}\\
+00018280: 7b20 4720 5c5c 6c65 7120 515e 7b5c 5c61  { G \\leq Q^{\\a
+00018290: 6c70 6861 7d28 4629 205c 5c7d 205c 5c2c  lpha}(F) \\} \\,
+000182a0: 205c 5c6d 6174 6872 6d7b 647d 4628 4729   \\mathrm{d}F(G)
+000182b0: 600a 0a20 2020 2077 6865 7265 2077 6520  `..    where we 
+000182c0: 7573 6520 3a6d 6174 683a 6047 203a 3d20  use :math:`G := 
+000182d0: 5c5c 7375 6d5f 7b74 3d30 7d5e 7b54 2d31  \\sum_{t=0}^{T-1
+000182e0: 7d20 5c5c 6761 6d6d 615e 7420 725f 7460  } \\gamma^t r_t`
+000182f0: 616e 6420 3a6d 6174 683a 6064 4628 4729  and :math:`dF(G)
+00018300: 203a 3d20 5c5c 6d61 7468 726d 7b6c 696d   := \\mathrm{lim
+00018310: 7d5f 7b5c 5c44 656c 7461 205c 5c72 6967  }_{\\Delta \\rig
+00018320: 6874 6172 726f 7720 307d 2046 2847 2920  htarrow 0} F(G) 
+00018330: 2d20 4628 472d 205c 5c44 656c 7461 2960  - F(G- \\Delta)`
+00018340: 2e0a 0a20 2020 2050 6172 616d 6574 6572  ...    Parameter
+00018350: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  s.    ----------
+00018360: 2d0a 2020 2020 6c6f 6767 6564 5f64 6174  -.    logged_dat
+00018370: 6173 6574 3a20 4c6f 6767 6564 4461 7461  aset: LoggedData
+00018380: 7365 7420 6f72 204d 756c 7469 706c 654c  set or MultipleL
+00018390: 6f67 6765 6444 6174 6173 6574 0a20 2020  oggedDataset.   
+000183a0: 2020 2020 204c 6f67 6765 6420 6461 7461       Logged data
+000183b0: 7365 7420 7573 6564 2074 6f20 636f 6e64  set used to cond
+000183c0: 7563 7420 4f50 452e 0a0a 2020 2020 2020  uct OPE...      
+000183d0: 2020 2e2e 2063 6f64 652d 626c 6f63 6b3a    .. code-block:
+000183e0: 3a20 7079 7468 6f6e 0a0a 2020 2020 2020  : python..      
+000183f0: 2020 2020 2020 6b65 793a 205b 0a20 2020        key: [.   
+00018400: 2020 2020 2020 2020 2020 2020 2073 697a               siz
+00018410: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+00018420: 2020 206e 5f74 7261 6a65 6374 6f72 6965     n_trajectorie
+00018430: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
+00018440: 2020 2073 7465 705f 7065 725f 7472 616a     step_per_traj
+00018450: 6563 746f 7279 2c0a 2020 2020 2020 2020  ectory,.        
+00018460: 2020 2020 2020 2020 6163 7469 6f6e 5f74          action_t
+00018470: 7970 652c 0a20 2020 2020 2020 2020 2020  ype,.           
+00018480: 2020 2020 206e 5f61 6374 696f 6e73 2c0a       n_actions,.
+00018490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000184a0: 6163 7469 6f6e 5f64 696d 2c0a 2020 2020  action_dim,.    
+000184b0: 2020 2020 2020 2020 2020 2020 6163 7469              acti
+000184c0: 6f6e 5f6b 6579 732c 0a20 2020 2020 2020  on_keys,.       
+000184d0: 2020 2020 2020 2020 2061 6374 696f 6e5f           action_
+000184e0: 6d65 616e 696e 672c 0a20 2020 2020 2020  meaning,.       
+000184f0: 2020 2020 2020 2020 2073 7461 7465 5f64           state_d
+00018500: 696d 2c0a 2020 2020 2020 2020 2020 2020  im,.            
+00018510: 2020 2020 7374 6174 655f 6b65 7973 2c0a      state_keys,.
+00018520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018530: 7374 6174 652c 0a20 2020 2020 2020 2020  state,.         
+00018540: 2020 2020 2020 2061 6374 696f 6e2c 0a20         action,. 
+00018550: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00018560: 6577 6172 642c 0a20 2020 2020 2020 2020  eward,.         
+00018570: 2020 2020 2020 2064 6f6e 652c 0a20 2020         done,.   
+00018580: 2020 2020 2020 2020 2020 2020 2074 6572               ter
+00018590: 6d69 6e61 6c2c 0a20 2020 2020 2020 2020  minal,.         
+000185a0: 2020 2020 2020 2069 6e66 6f2c 0a20 2020         info,.   
+000185b0: 2020 2020 2020 2020 2020 2020 2070 7363               psc
+000185c0: 6f72 652c 0a20 2020 2020 2020 2020 2020  ore,.           
+000185d0: 2020 2020 2062 6568 6176 696f 725f 706f       behavior_po
+000185e0: 6c69 6379 2c0a 2020 2020 2020 2020 2020  licy,.          
+000185f0: 2020 2020 2020 6461 7461 7365 745f 6964        dataset_id
+00018600: 2c0a 2020 2020 2020 2020 2020 2020 5d0a  ,.            ].
+00018610: 0a20 2020 2020 2020 202e 2e20 7365 6561  .        .. seea
+00018620: 6c73 6f3a 3a0a 0a20 2020 2020 2020 2020  lso::..         
+00018630: 2020 203a 636c 6173 733a 6073 636f 7065     :class:`scope
+00018640: 5f72 6c2e 6461 7461 7365 742e 5379 6e74  _rl.dataset.Synt
+00018650: 6865 7469 6344 6174 6173 6574 6020 6465  heticDataset` de
+00018660: 7363 7269 6265 7320 7468 6520 636f 6d70  scribes the comp
+00018670: 6f6e 656e 7473 206f 6620 3a63 6c61 7373  onents of :class
+00018680: 3a60 6c6f 6767 6564 5f64 6174 6173 6574  :`logged_dataset
+00018690: 602e 0a0a 2020 2020 6f70 655f 6573 7469  `...    ope_esti
+000186a0: 6d61 746f 7273 3a20 6c69 7374 206f 6620  mators: list of 
+000186b0: 4261 7365 4f66 6650 6f6c 6963 7945 7374  BaseOffPolicyEst
+000186c0: 696d 6174 6f72 0a20 2020 2020 2020 204c  imator.        L
+000186d0: 6973 7420 6f66 204f 5045 2065 7374 696d  ist of OPE estim
+000186e0: 6174 6f72 7320 7573 6564 2074 6f20 6576  ators used to ev
+000186f0: 616c 7561 7465 2074 6865 2070 6f6c 6963  aluate the polic
+00018700: 7920 7661 6c75 6520 6f66 2074 6865 2065  y value of the e
+00018710: 7661 6c75 6174 696f 6e20 706f 6c69 6369  valuation polici
+00018720: 6573 2e0a 2020 2020 2020 2020 4573 7469  es..        Esti
+00018730: 6d61 746f 7273 206d 7573 7420 666f 6c6c  mators must foll
+00018740: 6f77 2074 6865 2069 6e74 6572 6661 6365  ow the interface
+00018750: 206f 6620 6073 636f 7065 5f72 6c2e 6f70   of `scope_rl.op
+00018760: 652e 4261 7365 4375 6d75 6c61 7469 7665  e.BaseCumulative
+00018770: 4469 7374 7269 6275 7469 6f6e 4f50 4545  DistributionOPEE
+00018780: 7374 696d 6174 6f72 602e 0a0a 2020 2020  stimator`...    
+00018790: 7573 655f 6375 7374 6f6d 5f72 6577 6172  use_custom_rewar
+000187a0: 645f 7363 616c 653a 2062 6f6f 6c2c 2064  d_scale: bool, d
+000187b0: 6566 6175 6c74 3d46 616c 7365 0a20 2020  efault=False.   
+000187c0: 2020 2020 2057 6865 7468 6572 2074 6f20       Whether to 
+000187d0: 7573 6520 6120 6375 7374 6f6d 697a 6564  use a customized
+000187e0: 2072 6577 6172 6420 7363 616c 6520 6f72   reward scale or
+000187f0: 2074 6865 2072 6577 6172 6420 6f62 7365   the reward obse
+00018800: 7276 6564 2075 6e64 6572 2074 6865 2062  rved under the b
+00018810: 6568 6176 696f 7220 706f 6c69 6379 2e0a  ehavior policy..
+00018820: 0a20 2020 2020 2020 2049 6620 6054 7275  .        If `Tru
+00018830: 6560 2c20 7468 6520 7265 7761 7264 2073  e`, the reward s
+00018840: 6361 6c65 2069 7320 756e 6966 6f72 6d2c  cale is uniform,
+00018850: 2066 6f6c 6c6f 7769 6e67 2048 7561 6e67   following Huang
+00018860: 2065 7420 616c 2e20 2832 3032 3129 2e0a   et al. (2021)..
+00018870: 0a20 2020 2020 2020 2049 6620 6046 616c  .        If `Fal
+00018880: 7365 602c 2074 6865 2072 6577 6172 6420  se`, the reward 
+00018890: 7363 616c 6520 666f 6c6c 6f77 7320 7468  scale follows th
+000188a0: 6520 6f6e 6520 6465 6669 6e65 6420 696e  e one defined in
+000188b0: 2043 6875 6e64 616b 2065 7420 616c 2e20   Chundak et al. 
+000188c0: 2832 3032 3129 2e0a 0a20 2020 2073 6361  (2021)...    sca
+000188d0: 6c65 5f6d 696e 3a20 666c 6f61 742c 2064  le_min: float, d
+000188e0: 6566 6175 6c74 3d4e 6f6e 650a 2020 2020  efault=None.    
+000188f0: 2020 2020 4d69 6e69 6d75 6d20 7661 6c75      Minimum valu
+00018900: 6520 6f66 2074 6865 2072 6577 6172 6420  e of the reward 
+00018910: 7363 616c 6520 696e 2074 6865 2043 4446  scale in the CDF
+00018920: 2e0a 2020 2020 2020 2020 4966 2075 7365  ..        If use
+00018930: 5f63 7573 746f 6d5f 7265 7761 7264 5f73  _custom_reward_s
+00018940: 6361 6c65 2069 7320 6054 7275 6560 2c20  cale is `True`, 
+00018950: 6120 7661 6c75 6520 6d75 7374 2062 6520  a value must be 
+00018960: 6769 7665 6e2e 0a0a 2020 2020 7363 616c  given...    scal
+00018970: 655f 6d61 783a 2066 6c6f 6174 2c20 6465  e_max: float, de
+00018980: 6661 756c 743d 4e6f 6e65 0a20 2020 2020  fault=None.     
+00018990: 2020 204d 6178 696d 756d 2076 616c 7565     Maximum value
+000189a0: 206f 6620 7468 6520 7265 7761 7264 2073   of the reward s
+000189b0: 6361 6c65 2069 6e20 7468 6520 4344 462e  cale in the CDF.
+000189c0: 0a20 2020 2020 2020 2049 6620 7573 655f  .        If use_
+000189d0: 6375 7374 6f6d 5f72 6577 6172 645f 7363  custom_reward_sc
+000189e0: 616c 6520 6973 2060 5472 7565 602c 2061  ale is `True`, a
+000189f0: 2076 616c 7565 206d 7573 7420 6265 2067   value must be g
+00018a00: 6976 656e 2e0a 0a20 2020 206e 5f70 6172  iven...    n_par
+00018a10: 7469 7469 6f6e 3a20 696e 742c 2064 6566  tition: int, def
+00018a20: 6175 6c74 3d4e 6f6e 650a 2020 2020 2020  ault=None.      
+00018a30: 2020 4e75 6d62 6572 206f 6620 7061 7274    Number of part
+00018a40: 6974 696f 6e73 2069 6e20 7468 6520 7265  itions in the re
+00018a50: 7761 7264 2073 6361 6c65 2028 782d 6178  ward scale (x-ax
+00018a60: 6973 206f 6620 7468 6520 4344 4629 2e0a  is of the CDF)..
+00018a70: 2020 2020 2020 2020 4966 2075 7365 5f63          If use_c
+00018a80: 7573 746f 6d5f 7265 7761 7264 5f73 6361  ustom_reward_sca
+00018a90: 6c65 2069 7320 6054 7275 6560 2c20 6120  le is `True`, a 
+00018aa0: 7661 6c75 6520 6d75 7374 2062 6520 6769  value must be gi
+00018ab0: 7665 6e2e 0a0a 2020 2020 6261 6e64 7769  ven...    bandwi
+00018ac0: 6474 683a 2066 6c6f 6174 2c20 6465 6661  dth: float, defa
+00018ad0: 756c 743d 312e 3020 283e 2030 290a 2020  ult=1.0 (> 0).  
+00018ae0: 2020 2020 2020 4261 6e64 7769 6474 6820        Bandwidth 
+00018af0: 6879 7065 7270 6172 616d 6574 6572 206f  hyperparameter o
+00018b00: 6620 7468 6520 6b65 726e 656c 2075 7365  f the kernel use
+00018b10: 6420 696e 2063 6f6e 7469 6e75 6f75 7320  d in continuous 
+00018b20: 6163 7469 6f6e 2063 6173 652e 0a0a 2020  action case...  
+00018b30: 2020 6163 7469 6f6e 5f73 6361 6c65 723a    action_scaler:
+00018b40: 2064 3372 6c70 792e 7072 6570 726f 6365   d3rlpy.preproce
+00018b50: 7373 696e 672e 4163 7469 6f6e 5363 616c  ssing.ActionScal
+00018b60: 6572 2c20 6465 6661 756c 743d 4e6f 6e65  er, default=None
+00018b70: 0a20 2020 2020 2020 2053 6361 6c69 6e67  .        Scaling
+00018b80: 2066 6163 746f 7220 6f66 2061 6374 696f   factor of actio
+00018b90: 6e2e 0a0a 2020 2020 6469 7361 626c 655f  n...    disable_
+00018ba0: 7265 7761 7264 5f61 6674 6572 5f64 6f6e  reward_after_don
+00018bb0: 653a 2062 6f6f 6c2c 2064 6566 6175 6c74  e: bool, default
+00018bc0: 3d54 7275 650a 2020 2020 2020 2020 5768  =True.        Wh
+00018bd0: 6574 6865 7220 746f 2061 7070 6c79 203a  ether to apply :
+00018be0: 6d61 7468 3a60 7220 3d20 3060 206f 6e63  math:`r = 0` onc
+00018bf0: 6520 646f 6e65 2069 7320 6f62 7365 7276  e done is observ
+00018c00: 6564 2069 6e20 616e 2065 7069 736f 6465  ed in an episode
+00018c10: 2e0a 0a20 2020 2045 7861 6d70 6c65 730a  ...    Examples.
+00018c20: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a0a      ----------..
+00018c30: 2020 2020 5072 6570 6172 6174 696f 6e3a      Preparation:
+00018c40: 0a0a 2020 2020 2e2e 2063 6f64 652d 626c  ..    .. code-bl
+00018c50: 6f63 6b3a 3a20 7079 7468 6f6e 0a0a 2020  ock:: python..  
+00018c60: 2020 2020 2020 2320 696d 706f 7274 206e        # import n
+00018c70: 6563 6573 7361 7279 206d 6f64 756c 6520  ecessary module 
+00018c80: 6672 6f6d 2053 434f 5045 2d52 4c0a 2020  from SCOPE-RL.  
+00018c90: 2020 2020 2020 6672 6f6d 2073 636f 7065        from scope
+00018ca0: 5f72 6c2e 6461 7461 7365 7420 696d 706f  _rl.dataset impo
+00018cb0: 7274 2053 796e 7468 6574 6963 4461 7461  rt SyntheticData
+00018cc0: 7365 740a 2020 2020 2020 2020 6672 6f6d  set.        from
+00018cd0: 2073 636f 7065 5f72 6c2e 706f 6c69 6379   scope_rl.policy
+00018ce0: 2069 6d70 6f72 7420 4570 7369 6c6f 6e47   import EpsilonG
+00018cf0: 7265 6564 7948 6561 640a 2020 2020 2020  reedyHead.      
+00018d00: 2020 6672 6f6d 2073 636f 7065 5f72 6c2e    from scope_rl.
+00018d10: 6f70 6520 696d 706f 7274 2043 7265 6174  ope import Creat
+00018d20: 654f 5045 496e 7075 740a 2020 2020 2020  eOPEInput.      
+00018d30: 2020 6672 6f6d 2073 636f 7065 5f72 6c2e    from scope_rl.
+00018d40: 6f70 6520 696d 706f 7274 2043 756d 756c  ope import Cumul
+00018d50: 6174 6976 6544 6973 7472 6962 7574 696f  ativeDistributio
+00018d60: 6e4f 5045 0a20 2020 2020 2020 2066 726f  nOPE.        fro
+00018d70: 6d20 7363 6f70 655f 726c 2e6f 7065 2e64  m scope_rl.ope.d
+00018d80: 6973 6372 6574 6520 696d 706f 7274 2043  iscrete import C
+00018d90: 756d 756c 6174 6976 6544 6973 7472 6962  umulativeDistrib
+00018da0: 7574 696f 6e54 4953 2061 7320 4344 5f49  utionTIS as CD_I
+00018db0: 530a 2020 2020 2020 2020 6672 6f6d 2073  S.        from s
+00018dc0: 636f 7065 5f72 6c2e 6f70 652e 6469 7363  cope_rl.ope.disc
+00018dd0: 7265 7465 2069 6d70 6f72 7420 4375 6d75  rete import Cumu
+00018de0: 6c61 7469 7665 4469 7374 7269 6275 7469  lativeDistributi
+00018df0: 6f6e 534e 5449 5320 6173 2043 445f 534e  onSNTIS as CD_SN
+00018e00: 4953 0a0a 2020 2020 2020 2020 2320 696d  IS..        # im
+00018e10: 706f 7274 206e 6563 6573 7361 7279 206d  port necessary m
+00018e20: 6f64 756c 6520 6672 6f6d 206f 7468 6572  odule from other
+00018e30: 206c 6962 7261 7269 6573 0a20 2020 2020   libraries.     
+00018e40: 2020 2069 6d70 6f72 7420 6779 6d0a 2020     import gym.  
+00018e50: 2020 2020 2020 696d 706f 7274 2072 7462        import rtb
+00018e60: 6779 6d0a 2020 2020 2020 2020 6672 6f6d  gym.        from
+00018e70: 2064 3372 6c70 792e 616c 676f 7320 696d   d3rlpy.algos im
+00018e80: 706f 7274 2044 6f75 626c 6544 514e 436f  port DoubleDQNCo
+00018e90: 6e66 6967 0a20 2020 2020 2020 2066 726f  nfig.        fro
+00018ea0: 6d20 6433 726c 7079 2e64 6174 6173 6574  m d3rlpy.dataset
+00018eb0: 2069 6d70 6f72 7420 6372 6561 7465 5f66   import create_f
+00018ec0: 6966 6f5f 7265 706c 6179 5f62 7566 6665  ifo_replay_buffe
+00018ed0: 720a 2020 2020 2020 2020 6672 6f6d 2064  r.        from d
+00018ee0: 3372 6c70 792e 616c 676f 7320 696d 706f  3rlpy.algos impo
+00018ef0: 7274 2043 6f6e 7374 616e 7445 7073 696c  rt ConstantEpsil
+00018f00: 6f6e 4772 6565 6479 0a0a 2020 2020 2020  onGreedy..      
+00018f10: 2020 2320 696e 6974 6961 6c69 7a65 2065    # initialize e
+00018f20: 6e76 6972 6f6e 6d65 6e74 0a20 2020 2020  nvironment.     
+00018f30: 2020 2065 6e76 203d 2067 796d 2e6d 616b     env = gym.mak
+00018f40: 6528 2252 5442 456e 762d 6469 7363 7265  e("RTBEnv-discre
+00018f50: 7465 2d76 3022 290a 0a20 2020 2020 2020  te-v0")..       
+00018f60: 2023 2064 6566 696e 6520 2852 4c29 2061   # define (RL) a
+00018f70: 6765 6e74 2028 692e 652e 2c20 706f 6c69  gent (i.e., poli
+00018f80: 6379 2920 616e 6420 7472 6169 6e20 6f6e  cy) and train on
+00018f90: 2074 6865 2065 6e76 6972 6f6e 6d65 6e74   the environment
+00018fa0: 0a20 2020 2020 2020 2064 6471 6e20 3d20  .        ddqn = 
+00018fb0: 446f 7562 6c65 4451 4e43 6f6e 6669 6728  DoubleDQNConfig(
+00018fc0: 292e 6372 6561 7465 2829 0a20 2020 2020  ).create().     
+00018fd0: 2020 2062 7566 6665 7220 3d20 6372 6561     buffer = crea
+00018fe0: 7465 5f66 6966 6f5f 7265 706c 6179 5f62  te_fifo_replay_b
+00018ff0: 7566 6665 7228 0a20 2020 2020 2020 2020  uffer(.         
+00019000: 2020 206c 696d 6974 3d31 3030 3030 2c0a     limit=10000,.
+00019010: 2020 2020 2020 2020 2020 2020 656e 763d              env=
+00019020: 656e 762c 0a20 2020 2020 2020 2029 0a20  env,.        ). 
+00019030: 2020 2020 2020 2065 7870 6c6f 7265 7220         explorer 
+00019040: 3d20 436f 6e73 7461 6e74 4570 7369 6c6f  = ConstantEpsilo
+00019050: 6e47 7265 6564 7928 0a20 2020 2020 2020  nGreedy(.       
+00019060: 2020 2020 2065 7073 696c 6f6e 3d30 2e33       epsilon=0.3
+00019070: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
+00019080: 2020 2020 6464 716e 2e66 6974 5f6f 6e6c      ddqn.fit_onl
+00019090: 696e 6528 0a20 2020 2020 2020 2020 2020  ine(.           
+000190a0: 2065 6e76 3d65 6e76 2c0a 2020 2020 2020   env=env,.      
+000190b0: 2020 2020 2020 6275 6666 6572 3d62 7566        buffer=buf
+000190c0: 6665 722c 0a20 2020 2020 2020 2020 2020  fer,.           
+000190d0: 2065 7870 6c6f 7265 723d 6578 706c 6f72   explorer=explor
+000190e0: 6572 2c0a 2020 2020 2020 2020 2020 2020  er,.            
+000190f0: 6e5f 7374 6570 733d 3130 3030 302c 0a20  n_steps=10000,. 
+00019100: 2020 2020 2020 2020 2020 206e 5f73 7465             n_ste
+00019110: 7073 5f70 6572 5f65 706f 6368 3d31 3030  ps_per_epoch=100
+00019120: 302c 0a20 2020 2020 2020 2029 0a0a 2020  0,.        )..  
+00019130: 2020 2020 2020 2320 636f 6e76 6572 7420        # convert 
+00019140: 6464 716e 2070 6f6c 6963 7920 746f 2073  ddqn policy to s
+00019150: 746f 6368 6173 7469 6320 6461 7461 2063  tochastic data c
+00019160: 6f6c 6c65 6374 696f 6e20 706f 6c69 6379  ollection policy
+00019170: 0a20 2020 2020 2020 2062 6568 6176 696f  .        behavio
+00019180: 725f 706f 6c69 6379 203d 2045 7073 696c  r_policy = Epsil
+00019190: 6f6e 4772 6565 6479 4865 6164 280a 2020  onGreedyHead(.  
+000191a0: 2020 2020 2020 2020 2020 6464 716e 2c0a            ddqn,.
+000191b0: 2020 2020 2020 2020 2020 2020 6e5f 6163              n_ac
+000191c0: 7469 6f6e 733d 656e 762e 6163 7469 6f6e  tions=env.action
+000191d0: 5f73 7061 6365 2e6e 2c0a 2020 2020 2020  _space.n,.      
+000191e0: 2020 2020 2020 6570 7369 6c6f 6e3d 302e        epsilon=0.
+000191f0: 332c 0a20 2020 2020 2020 2020 2020 206e  3,.            n
+00019200: 616d 653d 2264 6471 6e5f 6570 7369 6c6f  ame="ddqn_epsilo
+00019210: 6e5f 302e 3322 2c0a 2020 2020 2020 2020  n_0.3",.        
+00019220: 2020 2020 7261 6e64 6f6d 5f73 7461 7465      random_state
+00019230: 3d31 3233 3435 2c0a 2020 2020 2020 2020  =12345,.        
+00019240: 290a 0a20 2020 2020 2020 2023 2069 6e69  )..        # ini
+00019250: 7469 616c 697a 6520 6461 7461 7365 7420  tialize dataset 
+00019260: 636c 6173 730a 2020 2020 2020 2020 6461  class.        da
+00019270: 7461 7365 7420 3d20 5379 6e74 6865 7469  taset = Syntheti
+00019280: 6344 6174 6173 6574 280a 2020 2020 2020  cDataset(.      
+00019290: 2020 2020 2020 656e 763d 656e 762c 0a20        env=env,. 
+000192a0: 2020 2020 2020 2020 2020 206d 6178 5f65             max_e
+000192b0: 7069 736f 6465 5f73 7465 7073 3d65 6e76  pisode_steps=env
+000192c0: 2e73 7465 705f 7065 725f 6570 6973 6f64  .step_per_episod
+000192d0: 652c 0a20 2020 2020 2020 2029 0a0a 2020  e,.        )..  
+000192e0: 2020 2020 2020 2320 6461 7461 2063 6f6c        # data col
+000192f0: 6c65 6374 696f 6e0a 2020 2020 2020 2020  lection.        
+00019300: 6c6f 6767 6564 5f64 6174 6173 6574 203d  logged_dataset =
+00019310: 2064 6174 6173 6574 2e6f 6274 6169 6e5f   dataset.obtain_
+00019320: 6570 6973 6f64 6573 280a 2020 2020 2020  episodes(.      
+00019330: 2020 2020 2020 6265 6861 7669 6f72 5f70        behavior_p
+00019340: 6f6c 6963 6965 733d 6265 6861 7669 6f72  olicies=behavior
+00019350: 5f70 6f6c 6963 792c 0a20 2020 2020 2020  _policy,.       
+00019360: 2020 2020 206e 5f74 7261 6a65 6374 6f72       n_trajector
+00019370: 6965 733d 3130 302c 0a20 2020 2020 2020  ies=100,.       
+00019380: 2020 2020 2072 616e 646f 6d5f 7374 6174       random_stat
+00019390: 653d 3132 3334 352c 0a20 2020 2020 2020  e=12345,.       
+000193a0: 2029 0a0a 2020 2020 4372 6561 7465 2049   )..    Create I
+000193b0: 6e70 7574 2066 6f72 204f 5045 3a0a 0a20  nput for OPE:.. 
+000193c0: 2020 202e 2e20 636f 6465 2d62 6c6f 636b     .. code-block
+000193d0: 3a3a 2070 7974 686f 6e0a 0a20 2020 2020  :: python..     
+000193e0: 2020 2023 2065 7661 6c75 6174 696f 6e20     # evaluation 
+000193f0: 706f 6c69 6379 0a20 2020 2020 2020 2064  policy.        d
+00019400: 6471 6e5f 203d 2045 7073 696c 6f6e 4772  dqn_ = EpsilonGr
+00019410: 6565 6479 4865 6164 280a 2020 2020 2020  eedyHead(.      
+00019420: 2020 2020 2020 6261 7365 5f70 6f6c 6963        base_polic
+00019430: 793d 6464 716e 2c0a 2020 2020 2020 2020  y=ddqn,.        
+00019440: 2020 2020 6e5f 6163 7469 6f6e 733d 656e      n_actions=en
+00019450: 762e 6163 7469 6f6e 5f73 7061 6365 2e6e  v.action_space.n
+00019460: 2c0a 2020 2020 2020 2020 2020 2020 6e61  ,.            na
+00019470: 6d65 3d22 6464 716e 222c 0a20 2020 2020  me="ddqn",.     
+00019480: 2020 2020 2020 2065 7073 696c 6f6e 3d30         epsilon=0
+00019490: 2e30 2c0a 2020 2020 2020 2020 2020 2020  .0,.            
+000194a0: 7261 6e64 6f6d 5f73 7461 7465 3d31 3233  random_state=123
+000194b0: 3435 0a20 2020 2020 2020 2029 0a20 2020  45.        ).   
+000194c0: 2020 2020 2072 616e 646f 6d5f 203d 2045       random_ = E
+000194d0: 7073 696c 6f6e 4772 6565 6479 4865 6164  psilonGreedyHead
+000194e0: 280a 2020 2020 2020 2020 2020 2020 6261  (.            ba
+000194f0: 7365 5f70 6f6c 6963 793d 6464 716e 2c0a  se_policy=ddqn,.
+00019500: 2020 2020 2020 2020 2020 2020 6e5f 6163              n_ac
+00019510: 7469 6f6e 733d 656e 762e 6163 7469 6f6e  tions=env.action
+00019520: 5f73 7061 6365 2e6e 2c0a 2020 2020 2020  _space.n,.      
+00019530: 2020 2020 2020 6e61 6d65 3d22 7261 6e64        name="rand
+00019540: 6f6d 222c 0a20 2020 2020 2020 2020 2020  om",.           
+00019550: 2065 7073 696c 6f6e 3d31 2e30 2c0a 2020   epsilon=1.0,.  
+00019560: 2020 2020 2020 2020 2020 7261 6e64 6f6d            random
+00019570: 5f73 7461 7465 3d31 3233 3435 0a20 2020  _state=12345.   
+00019580: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+00019590: 2320 6372 6561 7465 2069 6e70 7574 2066  # create input f
+000195a0: 6f72 206f 6666 2d70 6f6c 6963 7920 6576  or off-policy ev
+000195b0: 616c 7561 7469 6f6e 2028 4f50 4529 0a20  aluation (OPE). 
+000195c0: 2020 2020 2020 2070 7265 7020 3d20 4372         prep = Cr
+000195d0: 6561 7465 4f50 4549 6e70 7574 280a 2020  eateOPEInput(.  
+000195e0: 2020 2020 2020 2020 2020 656e 763d 656e            env=en
+000195f0: 762c 0a20 2020 2020 2020 2029 0a20 2020  v,.        ).   
+00019600: 2020 2020 2069 6e70 7574 5f64 6963 7420       input_dict 
+00019610: 3d20 7072 6570 2e6f 6274 6169 6e5f 7768  = prep.obtain_wh
+00019620: 6f6c 655f 696e 7075 7473 280a 2020 2020  ole_inputs(.    
+00019630: 2020 2020 2020 2020 6c6f 6767 6564 5f64          logged_d
+00019640: 6174 6173 6574 3d6c 6f67 6765 645f 6461  ataset=logged_da
+00019650: 7461 7365 742c 0a20 2020 2020 2020 2020  taset,.         
+00019660: 2020 2065 7661 6c75 6174 696f 6e5f 706f     evaluation_po
+00019670: 6c69 6369 6573 3d5b 6464 716e 5f2c 2072  licies=[ddqn_, r
+00019680: 616e 646f 6d5f 5d2c 0a20 2020 2020 2020  andom_],.       
+00019690: 2020 2020 206e 5f74 7261 6a65 6374 6f72       n_trajector
+000196a0: 6965 735f 6f6e 5f70 6f6c 6963 795f 6576  ies_on_policy_ev
+000196b0: 616c 7561 7469 6f6e 3d31 3030 2c0a 2020  aluation=100,.  
+000196c0: 2020 2020 2020 2020 2020 7261 6e64 6f6d            random
+000196d0: 5f73 7461 7465 3d31 3233 3435 2c0a 2020  _state=12345,.  
+000196e0: 2020 2020 2020 290a 0a20 2020 202a 2a43        )..    **C
+000196f0: 756d 756c 6174 6976 6520 4469 7374 7269  umulative Distri
+00019700: 6275 7469 6f6e 204f 5045 2a2a 3a0a 0a20  bution OPE**:.. 
+00019710: 2020 202e 2e20 636f 6465 2d62 6c6f 636b     .. code-block
+00019720: 3a3a 2070 7974 686f 6e0a 0a20 2020 2020  :: python..     
+00019730: 2020 2023 204f 5045 0a20 2020 2020 2020     # OPE.       
+00019740: 2063 645f 6f70 6520 3d20 4375 6d75 6c61   cd_ope = Cumula
+00019750: 7469 7665 4469 7374 7269 6275 7469 6f6e  tiveDistribution
+00019760: 4f50 4528 0a20 2020 2020 2020 2020 2020  OPE(.           
+00019770: 206c 6f67 6765 645f 6461 7461 7365 743d   logged_dataset=
+00019780: 6c6f 6767 6564 5f64 6174 6173 6574 2c0a  logged_dataset,.
+00019790: 2020 2020 2020 2020 2020 2020 6f70 655f              ope_
+000197a0: 6573 7469 6d61 746f 7273 3d5b 0a20 2020  estimators=[.   
+000197b0: 2020 2020 2020 2020 2020 2020 2043 445f               CD_
+000197c0: 4953 2865 7374 696d 6174 6f72 5f6e 616d  IS(estimator_nam
+000197d0: 653d 2263 645f 6973 2229 2c0a 2020 2020  e="cd_is"),.    
+000197e0: 2020 2020 2020 2020 2020 2020 4344 5f53              CD_S
+000197f0: 4e49 5328 6573 7469 6d61 746f 725f 6e61  NIS(estimator_na
+00019800: 6d65 3d22 6364 5f73 6e69 7322 292c 0a20  me="cd_snis"),. 
+00019810: 2020 2020 2020 2020 2020 205d 2c0a 2020             ],.  
+00019820: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00019830: 7661 7269 616e 6365 5f64 6963 7420 3d20  variance_dict = 
+00019840: 6364 5f6f 7065 2e65 7374 696d 6174 655f  cd_ope.estimate_
+00019850: 7661 7269 616e 6365 280a 2020 2020 2020  variance(.      
+00019860: 2020 2020 2020 696e 7075 745f 6469 6374        input_dict
+00019870: 3d69 6e70 7574 5f64 6963 742c 0a20 2020  =input_dict,.   
+00019880: 2020 2020 2029 0a0a 2020 2020 2a2a 4f75       )..    **Ou
+00019890: 7470 7574 2a2a 3a0a 0a20 2020 202e 2e20  tput**:..    .. 
+000198a0: 636f 6465 2d62 6c6f 636b 3a3a 2070 7974  code-block:: pyt
+000198b0: 686f 6e0a 0a20 2020 2020 2020 203e 3e3e  hon..        >>>
+000198c0: 2076 6172 6961 6e63 655f 6469 6374 0a0a   variance_dict..
+000198d0: 2020 2020 2020 2020 7b27 6464 716e 273a          {'ddqn':
+000198e0: 207b 276f 6e5f 706f 6c69 6379 273a 2031   {'on_policy': 1
+000198f0: 382e 3632 3136 2c20 2763 6466 5f69 7327  8.6216, 'cdf_is'
+00019900: 3a20 3139 2e32 3031 3933 3438 3038 3334  : 19.20193480834
+00019910: 3032 3635 2c20 2763 6466 5f73 6e69 7327  0265, 'cdf_snis'
+00019920: 3a20 3235 2e33 3135 3535 3535 3535 3535  : 25.31555555555
+00019930: 3535 3535 7d2c 0a20 2020 2020 2020 2027  5555},.        '
+00019940: 7261 6e64 6f6d 273a 207b 276f 6e5f 706f  random': {'on_po
+00019950: 6c69 6379 273a 2032 312e 3531 3238 3036  licy': 21.512806
+00019960: 3838 3730 3233 3036 342c 2027 6364 665f  887023064, 'cdf_
+00019970: 6973 273a 2031 332e 3539 3138 3534 3930  is': 13.59185490
+00019980: 3236 3338 3237 332c 2027 6364 665f 736e  2638273, 'cdf_sn
+00019990: 6973 273a 2037 2e31 3538 3534 3535 3330  is': 7.158545530
+000199a0: 3335 3639 3134 7d7d 0a0a 2020 2020 2e2e  356914}}..    ..
+000199b0: 2073 6565 616c 736f 3a3a 0a0a 2020 2020   seealso::..    
+000199c0: 2020 2020 2a20 3a64 6f63 3a60 5175 6963      * :doc:`Quic
+000199d0: 6b73 7461 7274 203c 2f64 6f63 756d 656e  kstart </documen
+000199e0: 7461 7469 6f6e 2f71 7569 636b 7374 6172  tation/quickstar
+000199f0: 743e 600a 2020 2020 2020 2020 2a20 3a64  t>`.        * :d
+00019a00: 6f63 3a60 5265 6c61 7465 6420 7475 746f  oc:`Related tuto
+00019a10: 7269 616c 7320 3c2f 646f 6375 6d65 6e74  rials </document
+00019a20: 6174 696f 6e2f 6578 616d 706c 6573 2f63  ation/examples/c
+00019a30: 756d 756c 6174 6976 655f 6469 7374 5f6f  umulative_dist_o
+00019a40: 7065 3e60 0a0a 2020 2020 5265 6665 7265  pe>`..    Refere
+00019a50: 6e63 6573 0a20 2020 202d 2d2d 2d2d 2d2d  nces.    -------
+00019a60: 0a20 2020 2041 7564 7265 7920 4875 616e  .    Audrey Huan
+00019a70: 672c 204c 6975 204c 6571 692c 205a 6163  g, Liu Leqi, Zac
+00019a80: 6861 7279 2043 2e20 4c69 7074 6f6e 2c20  hary C. Lipton, 
+00019a90: 616e 6420 4b61 6d79 6172 2041 7a69 7a7a  and Kamyar Azizz
+00019aa0: 6164 656e 6573 6865 6c69 2e0a 2020 2020  adenesheli..    
+00019ab0: 224f 6666 2d50 6f6c 6963 7920 5269 736b  "Off-Policy Risk
+00019ac0: 2041 7373 6573 736d 656e 7420 666f 7220   Assessment for 
+00019ad0: 4d61 726b 6f76 2044 6563 6973 696f 6e20  Markov Decision 
+00019ae0: 5072 6f63 6573 7365 732e 2220 3230 3232  Processes." 2022
+00019af0: 2e0a 0a20 2020 2041 7564 7265 7920 4875  ...    Audrey Hu
+00019b00: 616e 672c 204c 6975 204c 6571 692c 205a  ang, Liu Leqi, Z
+00019b10: 6163 6861 7279 2043 2e20 4c69 7074 6f6e  achary C. Lipton
+00019b20: 2c20 616e 6420 4b61 6d79 6172 2041 7a69  , and Kamyar Azi
+00019b30: 7a7a 6164 656e 6573 6865 6c69 2e0a 2020  zzadenesheli..  
+00019b40: 2020 224f 6666 2d50 6f6c 6963 7920 5269    "Off-Policy Ri
+00019b50: 736b 2041 7373 6573 736d 656e 7420 696e  sk Assessment in
+00019b60: 2043 6f6e 7465 7874 7561 6c20 4261 6e64   Contextual Band
+00019b70: 6974 732e 2220 3230 3231 2e0a 0a20 2020  its." 2021...   
+00019b80: 2059 6173 6820 4368 616e 6461 6b2c 2053   Yash Chandak, S
+00019b90: 636f 7474 204e 6965 6b75 6d2c 2042 7275  cott Niekum, Bru
+00019ba0: 6e6f 2043 6173 7472 6f20 6461 2053 696c  no Castro da Sil
+00019bb0: 7661 2c20 4572 696b 204c 6561 726e 6564  va, Erik Learned
+00019bc0: 2d4d 696c 6c65 722c 2045 6d6d 6120 4272  -Miller, Emma Br
+00019bd0: 756e 736b 696c 6c2c 2061 6e64 2050 6869  unskill, and Phi
+00019be0: 6c69 7020 532e 2054 686f 6d61 732e 0a20  lip S. Thomas.. 
+00019bf0: 2020 2022 556e 6976 6572 7361 6c20 4f66     "Universal Of
+00019c00: 662d 506f 6c69 6379 2045 7661 6c75 6174  f-Policy Evaluat
+00019c10: 696f 6e2e 2220 3230 3231 2e0a 0a20 2020  ion." 2021...   
+00019c20: 2022 2222 0a0a 2020 2020 6c6f 6767 6564   """..    logged
+00019c30: 5f64 6174 6173 6574 3a20 556e 696f 6e5b  _dataset: Union[
+00019c40: 4c6f 6767 6564 4461 7461 7365 742c 204d  LoggedDataset, M
+00019c50: 756c 7469 706c 654c 6f67 6765 6444 6174  ultipleLoggedDat
+00019c60: 6173 6574 5d0a 2020 2020 6f70 655f 6573  aset].    ope_es
+00019c70: 7469 6d61 746f 7273 3a20 4c69 7374 5b42  timators: List[B
+00019c80: 6173 654f 6666 506f 6c69 6379 4573 7469  aseOffPolicyEsti
+00019c90: 6d61 746f 725d 0a20 2020 2075 7365 5f63  mator].    use_c
+00019ca0: 7573 746f 6d5f 7265 7761 7264 5f73 6361  ustom_reward_sca
+00019cb0: 6c65 3a20 626f 6f6c 203d 2046 616c 7365  le: bool = False
+00019cc0: 0a20 2020 2073 6361 6c65 5f6d 696e 3a20  .    scale_min: 
+00019cd0: 4f70 7469 6f6e 616c 5b66 6c6f 6174 5d20  Optional[float] 
+00019ce0: 3d20 4e6f 6e65 0a20 2020 2073 6361 6c65  = None.    scale
+00019cf0: 5f6d 6178 3a20 4f70 7469 6f6e 616c 5b66  _max: Optional[f
+00019d00: 6c6f 6174 5d20 3d20 4e6f 6e65 0a20 2020  loat] = None.   
+00019d10: 206e 5f70 6172 7469 7469 6f6e 3a20 4f70   n_partition: Op
+00019d20: 7469 6f6e 616c 5b69 6e74 5d20 3d20 4e6f  tional[int] = No
+00019d30: 6e65 0a20 2020 2062 616e 6477 6964 7468  ne.    bandwidth
+00019d40: 3a20 666c 6f61 7420 3d20 312e 300a 2020  : float = 1.0.  
+00019d50: 2020 6163 7469 6f6e 5f73 6361 6c65 723a    action_scaler:
+00019d60: 204f 7074 696f 6e61 6c5b 4163 7469 6f6e   Optional[Action
+00019d70: 5363 616c 6572 5d20 3d20 4e6f 6e65 0a20  Scaler] = None. 
+00019d80: 2020 2064 6973 6162 6c65 5f72 6577 6172     disable_rewar
+00019d90: 645f 6166 7465 725f 646f 6e65 3a20 626f  d_after_done: bo
+00019da0: 6f6c 203d 2054 7275 650a 0a20 2020 2064  ol = True..    d
+00019db0: 6566 205f 5f70 6f73 745f 696e 6974 5f5f  ef __post_init__
+00019dc0: 2873 656c 6629 202d 3e20 4e6f 6e65 3a0a  (self) -> None:.
+00019dd0: 2020 2020 2020 2020 2249 6e69 7469 616c          "Initial
+00019de0: 697a 6520 636c 6173 732e 220a 2020 2020  ize class.".    
+00019df0: 2020 2020 7365 6c66 2e75 7365 5f6d 756c      self.use_mul
+00019e00: 7469 706c 655f 6c6f 6767 6564 5f64 6174  tiple_logged_dat
+00019e10: 6173 6574 203d 2046 616c 7365 0a20 2020  aset = False.   
+00019e20: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
+00019e30: 6365 2873 656c 662e 6c6f 6767 6564 5f64  ce(self.logged_d
+00019e40: 6174 6173 6574 2c20 4d75 6c74 6970 6c65  ataset, Multiple
+00019e50: 4c6f 6767 6564 4461 7461 7365 7429 3a0a  LoggedDataset):.
+00019e60: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00019e70: 2e6d 756c 7469 706c 655f 6c6f 6767 6564  .multiple_logged
+00019e80: 5f64 6174 6173 6574 203d 2073 656c 662e  _dataset = self.
+00019e90: 6c6f 6767 6564 5f64 6174 6173 6574 0a20  logged_dataset. 
+00019ea0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00019eb0: 6c6f 6767 6564 5f64 6174 6173 6574 203d  logged_dataset =
+00019ec0: 2073 656c 662e 6d75 6c74 6970 6c65 5f6c   self.multiple_l
+00019ed0: 6f67 6765 645f 6461 7461 7365 742e 6765  ogged_dataset.ge
+00019ee0: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
+00019ef0: 2020 2062 6568 6176 696f 725f 706f 6c69     behavior_poli
+00019f00: 6379 5f6e 616d 653d 7365 6c66 2e6d 756c  cy_name=self.mul
+00019f10: 7469 706c 655f 6c6f 6767 6564 5f64 6174  tiple_logged_dat
+00019f20: 6173 6574 2e62 6568 6176 696f 725f 706f  aset.behavior_po
+00019f30: 6c69 6379 5f6e 616d 6573 5b0a 2020 2020  licy_names[.    
+00019f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019f50: 300a 2020 2020 2020 2020 2020 2020 2020  0.              
+00019f60: 2020 5d2c 0a20 2020 2020 2020 2020 2020    ],.           
+00019f70: 2020 2020 2064 6174 6173 6574 5f69 643d       dataset_id=
+00019f80: 302c 0a20 2020 2020 2020 2020 2020 2029  0,.            )
+00019f90: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00019fa0: 662e 7573 655f 6d75 6c74 6970 6c65 5f6c  f.use_multiple_l
+00019fb0: 6f67 6765 645f 6461 7461 7365 7420 3d20  ogged_dataset = 
+00019fc0: 5472 7565 0a0a 2020 2020 2020 2020 6368  True..        ch
+00019fd0: 6563 6b5f 6c6f 6767 6564 5f64 6174 6173  eck_logged_datas
+00019fe0: 6574 2873 656c 662e 6c6f 6767 6564 5f64  et(self.logged_d
+00019ff0: 6174 6173 6574 290a 2020 2020 2020 2020  ataset).        
+0001a000: 7365 6c66 2e73 7465 705f 7065 725f 7472  self.step_per_tr
+0001a010: 616a 6563 746f 7279 203d 2073 656c 662e  ajectory = self.
+0001a020: 6c6f 6767 6564 5f64 6174 6173 6574 5b22  logged_dataset["
+0001a030: 7374 6570 5f70 6572 5f74 7261 6a65 6374  step_per_traject
+0001a040: 6f72 7922 5d0a 2020 2020 2020 2020 7365  ory"].        se
+0001a050: 6c66 2e61 6374 696f 6e5f 7479 7065 203d  lf.action_type =
+0001a060: 2073 656c 662e 6c6f 6767 6564 5f64 6174   self.logged_dat
+0001a070: 6173 6574 5b22 6163 7469 6f6e 5f74 7970  aset["action_typ
+0001a080: 6522 5d0a 0a20 2020 2020 2020 2069 6620  e"]..        if 
+0001a090: 6e6f 7420 7365 6c66 2e75 7365 5f6d 756c  not self.use_mul
+0001a0a0: 7469 706c 655f 6c6f 6767 6564 5f64 6174  tiple_logged_dat
+0001a0b0: 6173 6574 3a0a 2020 2020 2020 2020 2020  aset:.          
+0001a0c0: 2020 7365 6c66 2e5f 7265 6769 7374 6572    self._register
+0001a0d0: 5f6c 6f67 6765 645f 6461 7461 7365 7428  _logged_dataset(
+0001a0e0: 290a 0a20 2020 2020 2020 2073 656c 662e  )..        self.
+0001a0f0: 6f70 655f 6573 7469 6d61 746f 7273 5f20  ope_estimators_ 
+0001a100: 3d20 6469 6374 2829 0a20 2020 2020 2020  = dict().       
+0001a110: 2066 6f72 2065 7374 696d 6174 6f72 2069   for estimator i
+0001a120: 6e20 7365 6c66 2e6f 7065 5f65 7374 696d  n self.ope_estim
+0001a130: 6174 6f72 733a 0a20 2020 2020 2020 2020  ators:.         
+0001a140: 2020 2073 656c 662e 6f70 655f 6573 7469     self.ope_esti
+0001a150: 6d61 746f 7273 5f5b 6573 7469 6d61 746f  mators_[estimato
+0001a160: 722e 6573 7469 6d61 746f 725f 6e61 6d65  r.estimator_name
+0001a170: 5d20 3d20 6573 7469 6d61 746f 720a 0a20  ] = estimator.. 
+0001a180: 2020 2020 2020 2020 2020 2069 6620 6573             if es
+0001a190: 7469 6d61 746f 722e 6163 7469 6f6e 5f74  timator.action_t
+0001a1a0: 7970 6520 213d 2073 656c 662e 6163 7469  ype != self.acti
+0001a1b0: 6f6e 5f74 7970 653a 0a20 2020 2020 2020  on_type:.       
+0001a1c0: 2020 2020 2020 2020 2072 6169 7365 2052           raise R
+0001a1d0: 756e 7469 6d65 4572 726f 7228 0a20 2020  untimeError(.   
+0001a1e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a1f0: 2066 224f 6e65 206f 6620 7468 6520 6f70   f"One of the op
+0001a200: 655f 6573 7469 6d61 746f 7273 2c20 7b65  e_estimators, {e
+0001a210: 7374 696d 6174 6f72 2e65 7374 696d 6174  stimator.estimat
+0001a220: 6f72 5f6e 616d 657d 2064 6f65 7320 6e6f  or_name} does no
+0001a230: 7420 6d61 7463 6820 7468 6520 6163 7469  t match the acti
+0001a240: 6f6e 5f74 7970 6520 6f66 206c 6f67 6765  on_type of logge
+0001a250: 645f 6461 7461 7365 7420 2860 7b73 656c  d_dataset (`{sel
+0001a260: 662e 6163 7469 6f6e 5f74 7970 657d 6029  f.action_type}`)
+0001a270: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+0001a280: 2020 290a 0a20 2020 2020 2020 2020 2020    )..           
+0001a290: 2069 6620 6e6f 7420 6973 696e 7374 616e   if not isinstan
+0001a2a0: 6365 2865 7374 696d 6174 6f72 2c20 4261  ce(estimator, Ba
+0001a2b0: 7365 4375 6d75 6c61 7469 7665 4469 7374  seCumulativeDist
+0001a2c0: 7269 6275 7469 6f6e 4f50 4545 7374 696d  ributionOPEEstim
+0001a2d0: 6174 6f72 293a 0a20 2020 2020 2020 2020  ator):.         
+0001a2e0: 2020 2020 2020 2072 6169 7365 2052 756e         raise Run
+0001a2f0: 7469 6d65 4572 726f 7228 0a20 2020 2020  timeError(.     
+0001a300: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0001a310: 226f 7065 5f65 7374 696d 6174 6f72 7320  "ope_estimators 
+0001a320: 6d75 7374 2062 6520 6368 696c 6420 636c  must be child cl
+0001a330: 6173 7365 7320 6f66 2042 6173 6543 756d  asses of BaseCum
+0001a340: 756c 6174 6976 6544 6973 7472 6962 7574  ulativeDistribut
+0001a350: 696f 6e4f 5045 4573 7469 6d61 746f 722c  ionOPEEstimator,
+0001a360: 2062 7574 206f 6e65 206f 6620 7468 656d   but one of them
+0001a370: 2c20 7b65 7374 696d 6174 6f72 2e65 7374  , {estimator.est
+0001a380: 696d 6174 6f72 5f6e 616d 657d 2069 7320  imator_name} is 
+0001a390: 6e6f 7422 0a20 2020 2020 2020 2020 2020  not".           
+0001a3a0: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+0001a3b0: 6966 2073 656c 662e 7573 655f 6375 7374  if self.use_cust
+0001a3c0: 6f6d 5f72 6577 6172 645f 7363 616c 653a  om_reward_scale:
+0001a3d0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0001a3e0: 7365 6c66 2e73 6361 6c65 5f6d 696e 2069  self.scale_min i
+0001a3f0: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
+0001a400: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+0001a410: 6c75 6545 7272 6f72 280a 2020 2020 2020  lueError(.      
+0001a420: 2020 2020 2020 2020 2020 2020 2020 2273                "s
+0001a430: 6361 6c65 5f6d 696e 206d 7573 7420 6265  cale_min must be
+0001a440: 2067 6976 656e 2077 6865 6e20 6075 7365   given when `use
+0001a450: 5f63 7573 746f 6d5f 7265 7761 7264 5f73  _custom_reward_s
+0001a460: 6361 6c65 203d 3d20 5472 7565 6022 0a20  cale == True`". 
+0001a470: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+0001a480: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0001a490: 7365 6c66 2e73 6361 6c65 5f6d 6178 2069  self.scale_max i
+0001a4a0: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
+0001a4b0: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+0001a4c0: 6c75 6545 7272 6f72 280a 2020 2020 2020  lueError(.      
+0001a4d0: 2020 2020 2020 2020 2020 2020 2020 2273                "s
+0001a4e0: 6361 6c65 5f6d 6178 206d 7573 7420 6265  cale_max must be
+0001a4f0: 2067 6976 656e 2077 6865 6e20 6075 7365   given when `use
+0001a500: 5f63 7573 746f 6d5f 7265 7761 7264 5f73  _custom_reward_s
+0001a510: 6361 6c65 203d 3d20 5472 7565 6022 0a20  cale == True`". 
+0001a520: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+0001a530: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0001a540: 7365 6c66 2e6e 5f70 6172 7469 7469 6f6e  self.n_partition
+0001a550: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
+0001a560: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+0001a570: 5661 6c75 6545 7272 6f72 280a 2020 2020  ValueError(.    
+0001a580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a590: 226e 5f70 6172 7469 7469 6f6e 206d 7573  "n_partition mus
+0001a5a0: 7420 6265 2067 6976 656e 2077 6865 6e20  t be given when 
+0001a5b0: 6075 7365 5f63 7573 746f 6d5f 7265 7761  `use_custom_rewa
+0001a5c0: 7264 5f73 6361 6c65 203d 3d20 5472 7565  rd_scale == True
+0001a5d0: 6022 0a20 2020 2020 2020 2020 2020 2020  `".             
+0001a5e0: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+0001a5f0: 2063 6865 636b 5f73 6361 6c61 7228 0a20   check_scalar(. 
+0001a600: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0001a610: 656c 662e 7363 616c 655f 6d69 6e2c 0a20  elf.scale_min,. 
+0001a620: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+0001a630: 616d 653d 2273 6361 6c65 5f6d 696e 222c  ame="scale_min",
+0001a640: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001a650: 2074 6172 6765 745f 7479 7065 3d66 6c6f   target_type=flo
+0001a660: 6174 2c0a 2020 2020 2020 2020 2020 2020  at,.            
+0001a670: 290a 2020 2020 2020 2020 2020 2020 6368  ).            ch
+0001a680: 6563 6b5f 7363 616c 6172 280a 2020 2020  eck_scalar(.    
+0001a690: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0001a6a0: 2e73 6361 6c65 5f6d 6178 2c0a 2020 2020  .scale_max,.    
+0001a6b0: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
+0001a6c0: 3d22 7363 616c 655f 6d61 7822 2c0a 2020  ="scale_max",.  
+0001a6d0: 2020 2020 2020 2020 2020 2020 2020 7461                ta
+0001a6e0: 7267 6574 5f74 7970 653d 666c 6f61 742c  rget_type=float,
+0001a6f0: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+0001a700: 2020 2020 2020 2020 2020 2063 6865 636b             check
+0001a710: 5f73 6361 6c61 7228 0a20 2020 2020 2020  _scalar(.       
+0001a720: 2020 2020 2020 2020 2073 656c 662e 6e5f           self.n_
+0001a730: 7061 7274 6974 696f 6e2c 0a20 2020 2020  partition,.     
+0001a740: 2020 2020 2020 2020 2020 206e 616d 653d             name=
+0001a750: 226e 5f70 6172 7469 7469 6f6e 222c 0a20  "n_partition",. 
+0001a760: 2020 2020 2020 2020 2020 2020 2020 2074                 t
+0001a770: 6172 6765 745f 7479 7065 3d69 6e74 2c0a  arget_type=int,.
 0001a780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a790: 6e61 6d65 3d22 7363 616c 655f 6d61 7822  name="scale_max"
-0001a7a0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001a7b0: 2020 7461 7267 6574 5f74 7970 653d 666c    target_type=fl
-0001a7c0: 6f61 742c 0a20 2020 2020 2020 2020 2020  oat,.           
-0001a7d0: 2029 0a20 2020 2020 2020 2020 2020 2063   ).            c
-0001a7e0: 6865 636b 5f73 6361 6c61 7228 0a20 2020  heck_scalar(.   
-0001a7f0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0001a800: 662e 6e5f 7061 7274 6974 696f 6e2c 0a20  f.n_partition,. 
-0001a810: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-0001a820: 616d 653d 226e 5f70 6172 7469 7469 6f6e  ame="n_partition
-0001a830: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-0001a840: 2020 2074 6172 6765 745f 7479 7065 3d69     target_type=i
-0001a850: 6e74 2c0a 2020 2020 2020 2020 2020 2020  nt,.            
-0001a860: 2020 2020 6d69 6e5f 7661 6c3d 312c 0a20      min_val=1,. 
-0001a870: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
-0001a880: 2020 2020 2020 6966 2073 656c 662e 6163        if self.ac
-0001a890: 7469 6f6e 5f74 7970 6520 3d3d 2022 636f  tion_type == "co
-0001a8a0: 6e74 696e 756f 7573 223a 0a20 2020 2020  ntinuous":.     
-0001a8b0: 2020 2020 2020 2069 6620 7365 6c66 2e61         if self.a
-0001a8c0: 6374 696f 6e5f 7363 616c 6572 2069 7320  ction_scaler is 
-0001a8d0: 6e6f 7420 4e6f 6e65 2061 6e64 206e 6f74  not None and not
-0001a8e0: 2069 7369 6e73 7461 6e63 6528 0a20 2020   isinstance(.   
-0001a8f0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0001a900: 662e 6163 7469 6f6e 5f73 6361 6c65 722c  f.action_scaler,
-0001a910: 2041 6374 696f 6e53 6361 6c65 720a 2020   ActionScaler.  
-0001a920: 2020 2020 2020 2020 2020 293a 0a20 2020            ):.   
-0001a930: 2020 2020 2020 2020 2020 2020 2072 6169               rai
-0001a940: 7365 2056 616c 7565 4572 726f 7228 0a20  se ValueError(. 
-0001a950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a960: 2020 2022 6163 7469 6f6e 5f73 6361 6c65     "action_scale
-0001a970: 7220 6d75 7374 2062 6520 616e 2069 6e73  r must be an ins
-0001a980: 7461 6e63 6520 6f66 2064 3372 6c70 792e  tance of d3rlpy.
-0001a990: 7072 6570 726f 6365 7373 696e 672e 4163  preprocessing.Ac
-0001a9a0: 7469 6f6e 5363 616c 6572 2c20 6275 7420  tionScaler, but 
-0001a9b0: 666f 756e 6420 4661 6c73 6522 0a20 2020  found False".   
-0001a9c0: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
-0001a9d0: 2020 2020 2020 2020 2020 2063 6865 636b             check
-0001a9e0: 5f73 6361 6c61 7228 0a20 2020 2020 2020  _scalar(.       
-0001a9f0: 2020 2020 2020 2020 2073 656c 662e 6261           self.ba
-0001aa00: 6e64 7769 6474 682c 206e 616d 653d 2262  ndwidth, name="b
-0001aa10: 616e 6477 6964 7468 222c 2074 6172 6765  andwidth", targe
-0001aa20: 745f 7479 7065 3d66 6c6f 6174 2c20 6d69  t_type=float, mi
-0001aa30: 6e5f 7661 6c3d 302e 300a 2020 2020 2020  n_val=0.0.      
-0001aa40: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-0001aa50: 2073 656c 662e 5f65 7374 696d 6174 655f   self._estimate_
-0001aa60: 636f 6e66 6964 656e 6365 5f69 6e74 6572  confidence_inter
-0001aa70: 7661 6c20 3d20 7b0a 2020 2020 2020 2020  val = {.        
-0001aa80: 2020 2020 2262 6f6f 7473 7472 6170 223a      "bootstrap":
-0001aa90: 2065 7374 696d 6174 655f 636f 6e66 6964   estimate_confid
-0001aaa0: 656e 6365 5f69 6e74 6572 7661 6c5f 6279  ence_interval_by
-0001aab0: 5f62 6f6f 7473 7472 6170 2c0a 2020 2020  _bootstrap,.    
-0001aac0: 2020 2020 2020 2020 2268 6f65 6666 6469          "hoeffdi
-0001aad0: 6e67 223a 2065 7374 696d 6174 655f 636f  ng": estimate_co
-0001aae0: 6e66 6964 656e 6365 5f69 6e74 6572 7661  nfidence_interva
-0001aaf0: 6c5f 6279 5f68 6f65 6666 6469 6e67 2c0a  l_by_hoeffding,.
-0001ab00: 2020 2020 2020 2020 2020 2020 2262 6572              "ber
-0001ab10: 6e73 7465 696e 223a 2065 7374 696d 6174  nstein": estimat
-0001ab20: 655f 636f 6e66 6964 656e 6365 5f69 6e74  e_confidence_int
-0001ab30: 6572 7661 6c5f 6279 5f65 6d70 6972 6963  erval_by_empiric
-0001ab40: 616c 5f62 6572 6e73 7465 696e 2c0a 2020  al_bernstein,.  
-0001ab50: 2020 2020 2020 2020 2020 2274 7465 7374            "ttest
-0001ab60: 223a 2065 7374 696d 6174 655f 636f 6e66  ": estimate_conf
-0001ab70: 6964 656e 6365 5f69 6e74 6572 7661 6c5f  idence_interval_
-0001ab80: 6279 5f74 5f74 6573 742c 0a20 2020 2020  by_t_test,.     
-0001ab90: 2020 207d 0a0a 2020 2020 6465 6620 5f63     }..    def _c
-0001aba0: 6865 636b 5f63 6f6d 7061 7265 645f 6573  heck_compared_es
-0001abb0: 7469 6d61 746f 7273 280a 2020 2020 2020  timators(.      
-0001abc0: 2020 7365 6c66 2c20 636f 6d70 6172 6564    self, compared
-0001abd0: 5f65 7374 696d 6174 6f72 733a 204f 7074  _estimators: Opt
-0001abe0: 696f 6e61 6c5b 4c69 7374 5b73 7472 5d5d  ional[List[str]]
-0001abf0: 203d 204e 6f6e 650a 2020 2020 293a 0a20   = None.    ):. 
-0001ac00: 2020 2020 2020 2069 6620 636f 6d70 6172         if compar
-0001ac10: 6564 5f65 7374 696d 6174 6f72 7320 6973  ed_estimators is
-0001ac20: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-0001ac30: 2020 2063 6f6d 7061 7265 645f 6573 7469     compared_esti
-0001ac40: 6d61 746f 7273 203d 2073 656c 662e 6573  mators = self.es
-0001ac50: 7469 6d61 746f 7273 5f6e 616d 650a 2020  timators_name.  
-0001ac60: 2020 2020 2020 656c 6966 206e 6f74 2073        elif not s
-0001ac70: 6574 2863 6f6d 7061 7265 645f 6573 7469  et(compared_esti
-0001ac80: 6d61 746f 7273 292e 6973 7375 6273 6574  mators).issubset
-0001ac90: 2873 656c 662e 6573 7469 6d61 746f 7273  (self.estimators
-0001aca0: 5f6e 616d 6529 3a0a 2020 2020 2020 2020  _name):.        
-0001acb0: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-0001acc0: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
-0001acd0: 2020 2020 2020 2263 6f6d 7061 7265 645f        "compared_
-0001ace0: 6573 7469 6d61 746f 7273 206d 7573 7420  estimators must 
-0001acf0: 6265 2061 2073 7562 7365 7420 6f66 2073  be a subset of s
-0001ad00: 656c 662e 6573 7469 6d61 746f 7273 5f6e  elf.estimators_n
-0001ad10: 616d 652c 2062 7574 2066 6f75 6e64 2046  ame, but found F
-0001ad20: 616c 7365 2e22 0a20 2020 2020 2020 2020  alse.".         
-0001ad30: 2020 2029 0a20 2020 2020 2020 2072 6574     ).        ret
-0001ad40: 7572 6e20 636f 6d70 6172 6564 5f65 7374  urn compared_est
-0001ad50: 696d 6174 6f72 730a 0a20 2020 2064 6566  imators..    def
-0001ad60: 205f 6375 7374 6f6d 5f72 6577 6172 645f   _custom_reward_
-0001ad70: 7363 616c 6528 0a20 2020 2020 2020 2073  scale(.        s
-0001ad80: 656c 662c 0a20 2020 2020 2020 2073 6361  elf,.        sca
-0001ad90: 6c65 5f6d 696e 3a20 4f70 7469 6f6e 616c  le_min: Optional
-0001ada0: 5b66 6c6f 6174 5d20 3d20 4e6f 6e65 2c0a  [float] = None,.
-0001adb0: 2020 2020 2020 2020 7363 616c 655f 6d61          scale_ma
-0001adc0: 783a 204f 7074 696f 6e61 6c5b 666c 6f61  x: Optional[floa
-0001add0: 745d 203d 204e 6f6e 652c 0a20 2020 2020  t] = None,.     
-0001ade0: 2020 206e 5f70 6172 7469 7469 6f6e 3a20     n_partition: 
-0001adf0: 4f70 7469 6f6e 616c 5b69 6e74 5d20 3d20  Optional[int] = 
-0001ae00: 4e6f 6e65 2c0a 2020 2020 293a 0a20 2020  None,.    ):.   
-0001ae10: 2020 2020 2069 6620 7363 616c 655f 6d69       if scale_mi
-0001ae20: 6e20 6973 204e 6f6e 653a 0a20 2020 2020  n is None:.     
-0001ae30: 2020 2020 2020 2069 6620 7365 6c66 2e73         if self.s
-0001ae40: 6361 6c65 5f6d 696e 2069 7320 4e6f 6e65  cale_min is None
-0001ae50: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0001ae60: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-0001ae70: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
-0001ae80: 2020 2020 2020 2020 2273 6361 6c65 5f6d          "scale_m
-0001ae90: 696e 206d 7573 7420 6265 2073 7065 6369  in must be speci
-0001aea0: 6669 6564 2077 6865 6e20 7365 6c66 2e73  fied when self.s
-0001aeb0: 6361 6c65 5f6d 696e 2069 7320 4e6f 6e65  cale_min is None
-0001aec0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-0001aed0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-0001aee0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-0001aef0: 2020 2020 2020 7363 616c 655f 6d69 6e20        scale_min 
-0001af00: 3d20 7365 6c66 2e73 6361 6c65 5f6d 696e  = self.scale_min
-0001af10: 0a20 2020 2020 2020 2069 6620 7363 616c  .        if scal
-0001af20: 655f 6d61 7820 6973 204e 6f6e 653a 0a20  e_max is None:. 
-0001af30: 2020 2020 2020 2020 2020 2069 6620 7365             if se
-0001af40: 6c66 2e73 6361 6c65 5f6d 6178 2069 7320  lf.scale_max is 
-0001af50: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-0001af60: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-0001af70: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
-0001af80: 2020 2020 2020 2020 2020 2020 2273 6361              "sca
-0001af90: 6c65 5f6d 6178 206d 7573 7420 6265 2073  le_max must be s
-0001afa0: 7065 6369 6669 6564 2077 6865 6e20 7365  pecified when se
-0001afb0: 6c66 2e73 6361 6c65 5f6d 6178 2069 7320  lf.scale_max is 
-0001afc0: 4e6f 6e65 220a 2020 2020 2020 2020 2020  None".          
-0001afd0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-0001afe0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-0001aff0: 2020 2020 2020 2020 2020 7363 616c 655f            scale_
-0001b000: 6d61 7820 3d20 7365 6c66 2e73 6361 6c65  max = self.scale
-0001b010: 5f6d 6178 0a20 2020 2020 2020 2069 6620  _max.        if 
-0001b020: 6e5f 7061 7274 6974 696f 6e20 6973 204e  n_partition is N
-0001b030: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-0001b040: 2069 6620 7365 6c66 2e6e 5f70 6172 7469   if self.n_parti
-0001b050: 7469 6f6e 2069 7320 4e6f 6e65 3a0a 2020  tion is None:.  
-0001b060: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-0001b070: 6973 6520 5661 6c75 6545 7272 6f72 280a  ise ValueError(.
-0001b080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b090: 2020 2020 226e 5f70 6172 7469 7469 6f6e      "n_partition
-0001b0a0: 206d 7573 7420 6265 2073 7065 6369 6669   must be specifi
-0001b0b0: 6564 2077 6865 6e20 7365 6c66 2e6e 5f70  ed when self.n_p
-0001b0c0: 6172 7469 7469 6f6e 2069 7320 4e6f 6e65  artition is None
-0001b0d0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-0001b0e0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-0001b0f0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-0001b100: 2020 2020 2020 6e5f 7061 7274 6974 696f        n_partitio
-0001b110: 6e20 3d20 7365 6c66 2e6e 5f70 6172 7469  n = self.n_parti
-0001b120: 7469 6f6e 0a0a 2020 2020 2020 2020 6368  tion..        ch
-0001b130: 6563 6b5f 7363 616c 6172 2873 6361 6c65  eck_scalar(scale
-0001b140: 5f6d 696e 2c20 6e61 6d65 3d22 7363 616c  _min, name="scal
-0001b150: 655f 6d69 6e22 2c20 7461 7267 6574 5f74  e_min", target_t
-0001b160: 7970 653d 666c 6f61 7429 0a20 2020 2020  ype=float).     
-0001b170: 2020 2063 6865 636b 5f73 6361 6c61 7228     check_scalar(
-0001b180: 7363 616c 655f 6d61 782c 206e 616d 653d  scale_max, name=
-0001b190: 2273 6361 6c65 5f6d 6178 222c 2074 6172  "scale_max", tar
-0001b1a0: 6765 745f 7479 7065 3d66 6c6f 6174 290a  get_type=float).
-0001b1b0: 2020 2020 2020 2020 6368 6563 6b5f 7363          check_sc
-0001b1c0: 616c 6172 286e 5f70 6172 7469 7469 6f6e  alar(n_partition
-0001b1d0: 2c20 6e61 6d65 3d22 6e5f 7061 7274 6974  , name="n_partit
-0001b1e0: 696f 6e22 2c20 7461 7267 6574 5f74 7970  ion", target_typ
-0001b1f0: 653d 696e 742c 206d 696e 5f76 616c 3d31  e=int, min_val=1
-0001b200: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-0001b210: 206e 702e 6c69 6e73 7061 6365 2873 6361   np.linspace(sca
-0001b220: 6c65 5f6d 696e 2c20 7363 616c 655f 6d61  le_min, scale_ma
-0001b230: 782c 206e 756d 3d6e 5f70 6172 7469 7469  x, num=n_partiti
-0001b240: 6f6e 290a 0a20 2020 2064 6566 205f 6368  on)..    def _ch
-0001b250: 6563 6b5f 7265 7761 7264 5f73 6361 6c65  eck_reward_scale
-0001b260: 2873 656c 662c 2072 6577 6172 645f 7363  (self, reward_sc
-0001b270: 616c 653a 204f 7074 696f 6e61 6c5b 6e70  ale: Optional[np
-0001b280: 2e6e 6461 7272 6179 5d20 3d20 4e6f 6e65  .ndarray] = None
-0001b290: 293a 0a20 2020 2020 2020 2069 6620 7265  ):.        if re
-0001b2a0: 7761 7264 5f73 6361 6c65 2069 7320 6e6f  ward_scale is no
-0001b2b0: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-0001b2c0: 2020 2020 6368 6563 6b5f 6172 7261 7928      check_array(
-0001b2d0: 7265 7761 7264 5f73 6361 6c65 2c20 6e61  reward_scale, na
-0001b2e0: 6d65 3d22 7265 7761 7264 5f73 6361 6c65  me="reward_scale
-0001b2f0: 222c 2065 7870 6563 7465 645f 6469 6d3d  ", expected_dim=
-0001b300: 3129 0a20 2020 2020 2020 2020 2020 2072  1).            r
-0001b310: 6577 6172 645f 7363 616c 6520 3d20 6e70  eward_scale = np
-0001b320: 2e73 6f72 7428 7265 7761 7264 5f73 6361  .sort(reward_sca
-0001b330: 6c65 290a 2020 2020 2020 2020 7265 7475  le).        retu
-0001b340: 726e 2072 6577 6172 645f 7363 616c 650a  rn reward_scale.
-0001b350: 0a20 2020 2064 6566 205f 6368 6563 6b5f  .    def _check_
-0001b360: 6376 6172 5f61 6c70 6861 7328 7365 6c66  cvar_alphas(self
-0001b370: 2c20 616c 7068 6173 3a20 4f70 7469 6f6e  , alphas: Option
-0001b380: 616c 5b55 6e69 6f6e 5b66 6c6f 6174 2c20  al[Union[float, 
-0001b390: 6e70 2e6e 6461 7272 6179 5d5d 203d 204e  np.ndarray]] = N
-0001b3a0: 6f6e 6529 3a0a 2020 2020 2020 2020 6966  one):.        if
-0001b3b0: 2061 6c70 6861 7320 6973 204e 6f6e 653a   alphas is None:
-0001b3c0: 0a20 2020 2020 2020 2020 2020 2061 6c70  .            alp
-0001b3d0: 6861 7320 3d20 6e70 2e6c 696e 7370 6163  has = np.linspac
-0001b3e0: 6528 302c 2031 2c20 3231 290a 2020 2020  e(0, 1, 21).    
-0001b3f0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-0001b400: 6528 616c 7068 6173 2c20 666c 6f61 7429  e(alphas, float)
-0001b410: 3a0a 2020 2020 2020 2020 2020 2020 6368  :.            ch
-0001b420: 6563 6b5f 7363 616c 6172 280a 2020 2020  eck_scalar(.    
-0001b430: 2020 2020 2020 2020 2020 2020 616c 7068              alph
-0001b440: 6173 2c20 6e61 6d65 3d22 616c 7068 6173  as, name="alphas
-0001b450: 222c 2074 6172 6765 745f 7479 7065 3d66  ", target_type=f
-0001b460: 6c6f 6174 2c20 6d69 6e5f 7661 6c3d 302e  loat, min_val=0.
-0001b470: 302c 206d 6178 5f76 616c 3d31 2e30 0a20  0, max_val=1.0. 
-0001b480: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-0001b490: 2020 2020 2020 2020 2061 6c70 6861 7320           alphas 
-0001b4a0: 3d20 6e70 2e61 7272 6179 285b 616c 7068  = np.array([alph
-0001b4b0: 6173 5d2c 2064 7479 7065 3d66 6c6f 6174  as], dtype=float
-0001b4c0: 290a 2020 2020 2020 2020 656c 6966 2069  ).        elif i
-0001b4d0: 7369 6e73 7461 6e63 6528 616c 7068 6173  sinstance(alphas
-0001b4e0: 2c20 6e70 2e6e 6461 7272 6179 293a 0a20  , np.ndarray):. 
-0001b4f0: 2020 2020 2020 2020 2020 2063 6865 636b             check
-0001b500: 5f61 7272 6179 2861 6c70 6861 732c 206e  _array(alphas, n
-0001b510: 616d 653d 2261 6c70 6861 7322 2c20 6578  ame="alphas", ex
-0001b520: 7065 6374 6564 5f64 696d 3d31 2c20 6d69  pected_dim=1, mi
-0001b530: 6e5f 7661 6c3d 302e 302c 206d 6178 5f76  n_val=0.0, max_v
-0001b540: 616c 3d31 2e30 290a 2020 2020 2020 2020  al=1.0).        
-0001b550: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-0001b560: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-0001b570: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
-0001b580: 2020 2020 6622 616c 7068 6173 206d 7573      f"alphas mus
-0001b590: 7420 6265 2066 6c6f 6174 206f 7220 6e70  t be float or np
-0001b5a0: 2e6e 6461 7272 6179 2c20 6275 7420 7b74  .ndarray, but {t
-0001b5b0: 7970 6528 616c 7068 6173 297d 2069 7320  ype(alphas)} is 
-0001b5c0: 6769 7665 6e22 0a20 2020 2020 2020 2020  given".         
-0001b5d0: 2020 2029 0a20 2020 2020 2020 2072 6574     ).        ret
-0001b5e0: 7572 6e20 6e70 2e73 6f72 7428 616c 7068  urn np.sort(alph
-0001b5f0: 6173 290a 0a20 2020 2064 6566 205f 6368  as)..    def _ch
-0001b600: 6563 6b5f 6261 7369 635f 7669 7375 616c  eck_basic_visual
-0001b610: 697a 6174 696f 6e5f 696e 7075 7473 280a  ization_inputs(.
-0001b620: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-0001b630: 2020 2020 2020 6875 653a 2073 7472 2c0a        hue: str,.
-0001b640: 2020 2020 2020 2020 6e5f 636f 6c73 3a20          n_cols: 
-0001b650: 4f70 7469 6f6e 616c 5b69 6e74 5d20 3d20  Optional[int] = 
-0001b660: 4e6f 6e65 2c0a 2020 2020 2020 2020 6669  None,.        fi
-0001b670: 675f 6469 723a 204f 7074 696f 6e61 6c5b  g_dir: Optional[
-0001b680: 5061 7468 5d20 3d20 4e6f 6e65 2c0a 2020  Path] = None,.  
-0001b690: 2020 2020 2020 6669 675f 6e61 6d65 3a20        fig_name: 
-0001b6a0: 4f70 7469 6f6e 616c 5b73 7472 5d20 3d20  Optional[str] = 
-0001b6b0: 4e6f 6e65 2c0a 2020 2020 293a 0a20 2020  None,.    ):.   
-0001b6c0: 2020 2020 2069 6620 6875 6520 6e6f 7420       if hue not 
-0001b6d0: 696e 205b 2265 7374 696d 6174 6f72 222c  in ["estimator",
-0001b6e0: 2022 706f 6c69 6379 225d 3a0a 2020 2020   "policy"]:.    
-0001b6f0: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-0001b700: 6c75 6545 7272 6f72 280a 2020 2020 2020  lueError(.      
-0001b710: 2020 2020 2020 2020 2020 6622 6875 6520            f"hue 
-0001b720: 6d75 7374 2062 6520 6569 7468 6572 2060  must be either `
-0001b730: 6573 7469 6d61 746f 7260 206f 7220 6070  estimator` or `p
-0001b740: 6f6c 6963 7960 2c20 6275 7420 7b68 7565  olicy`, but {hue
-0001b750: 7d20 6973 2067 6976 656e 220a 2020 2020  } is given".    
-0001b760: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0001b770: 2020 6966 206e 5f63 6f6c 7320 6973 206e    if n_cols is n
-0001b780: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
-0001b790: 2020 2020 2063 6865 636b 5f73 6361 6c61       check_scala
-0001b7a0: 7228 6e5f 636f 6c73 2c20 6e61 6d65 3d22  r(n_cols, name="
-0001b7b0: 6e5f 636f 6c73 222c 2074 6172 6765 745f  n_cols", target_
-0001b7c0: 7479 7065 3d69 6e74 2c20 6d69 6e5f 7661  type=int, min_va
-0001b7d0: 6c3d 3129 0a20 2020 2020 2020 2069 6620  l=1).        if 
-0001b7e0: 6669 675f 6469 7220 6973 206e 6f74 204e  fig_dir is not N
-0001b7f0: 6f6e 6520 616e 6420 6e6f 7420 6973 696e  one and not isin
-0001b800: 7374 616e 6365 2866 6967 5f64 6972 2c20  stance(fig_dir, 
-0001b810: 5061 7468 293a 0a20 2020 2020 2020 2020  Path):.         
-0001b820: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-0001b830: 726f 7228 6622 6669 675f 6469 7220 6d75  ror(f"fig_dir mu
-0001b840: 7374 2062 6520 6120 5061 7468 2c20 6275  st be a Path, bu
-0001b850: 7420 7b74 7970 6528 6669 675f 6469 7229  t {type(fig_dir)
-0001b860: 7d20 6973 2067 6976 656e 2229 0a20 2020  } is given").   
-0001b870: 2020 2020 2069 6620 6669 675f 6e61 6d65       if fig_name
-0001b880: 2069 7320 6e6f 7420 4e6f 6e65 2061 6e64   is not None and
-0001b890: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
-0001b8a0: 6669 675f 6e61 6d65 2c20 7374 7229 3a0a  fig_name, str):.
-0001b8b0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-0001b8c0: 6520 5661 6c75 6545 7272 6f72 2866 2266  e ValueError(f"f
-0001b8d0: 6967 5f64 6972 206d 7573 7420 6265 2061  ig_dir must be a
-0001b8e0: 2073 7472 696e 672c 2062 7574 207b 7479   string, but {ty
-0001b8f0: 7065 2866 6967 5f64 6972 297d 2069 7320  pe(fig_dir)} is 
-0001b900: 6769 7665 6e22 290a 0a20 2020 2064 6566  given")..    def
-0001b910: 205f 6368 6563 6b5f 696e 7075 745f 6469   _check_input_di
-0001b920: 6374 5f66 6f72 5f76 6973 7561 6c69 7a65  ct_for_visualize
-0001b930: 5f6d 756c 7469 706c 655f 6573 7469 6d61  _multiple_estima
-0001b940: 7465 7328 0a20 2020 2020 2020 2073 656c  tes(.        sel
-0001b950: 662c 0a20 2020 2020 2020 2069 6e70 7574  f,.        input
-0001b960: 5f64 6963 743a 204d 756c 7469 706c 6549  _dict: MultipleI
-0001b970: 6e70 7574 4469 6374 2c0a 2020 2020 293a  nputDict,.    ):
-0001b980: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
-0001b990: 6973 696e 7374 616e 6365 2869 6e70 7574  isinstance(input
-0001b9a0: 5f64 6963 742c 204d 756c 7469 706c 6549  _dict, MultipleI
-0001b9b0: 6e70 7574 4469 6374 293a 0a20 2020 2020  nputDict):.     
-0001b9c0: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
-0001b9d0: 7565 4572 726f 7228 2269 6e70 7574 5f64  ueError("input_d
-0001b9e0: 6963 7420 6d75 7374 2062 6520 616e 2069  ict must be an i
-0001b9f0: 6e73 7461 6e63 6520 6f66 204d 756c 7469  nstance of Multi
-0001ba00: 706c 6549 6e70 7574 4469 6374 2e22 290a  pleInputDict.").
-0001ba10: 2020 2020 2020 2020 2320 6966 2028 0a20          # if (. 
-0001ba20: 2020 2020 2020 2023 2020 2020 206e 6f74         #     not
-0001ba30: 2073 656c 662e 7573 655f 6d75 6c74 6970   self.use_multip
-0001ba40: 6c65 5f6c 6f67 6765 645f 6461 7461 7365  le_logged_datase
-0001ba50: 740a 2020 2020 2020 2020 2320 2020 2020  t.        #     
-0001ba60: 6f72 206e 6f74 2069 6e70 7574 5f64 6963  or not input_dic
-0001ba70: 742e 7573 655f 7361 6d65 5f65 7661 6c5f  t.use_same_eval_
-0001ba80: 706f 6c69 6379 5f61 6372 6f73 735f 6461  policy_across_da
-0001ba90: 7461 7365 740a 2020 2020 2020 2020 2320  taset.        # 
-0001baa0: 293a 0a20 2020 2020 2020 2023 2020 2020  ):.        #    
-0001bab0: 2072 6169 7365 2052 756e 7469 6d65 4572   raise RuntimeEr
-0001bac0: 726f 7228 0a20 2020 2020 2020 2023 2020  ror(.        #  
-0001bad0: 2020 2020 2020 2022 5468 6973 2066 756e         "This fun
-0001bae0: 6374 696f 6e20 6973 2061 7070 6c69 6361  ction is applica
-0001baf0: 626c 6520 6f6e 6c79 2077 6865 6e20 4d75  ble only when Mu
-0001bb00: 6c74 6970 6c65 4c6f 6767 6564 4461 7461  ltipleLoggedData
-0001bb10: 7365 7420 6973 2075 7365 6420 220a 2020  set is used ".  
-0001bb20: 2020 2020 2020 2320 2020 2020 2020 2020        #         
-0001bb30: 2261 6e64 204d 756c 7469 706c 6549 6e70  "and MultipleInp
-0001bb40: 7574 4469 6374 2069 7320 636f 6c6c 6563  utDict is collec
-0001bb50: 7465 6420 6279 2074 6865 2073 616d 6520  ted by the same 
-0001bb60: 6576 616c 7561 7469 6f6e 2070 6f6c 6963  evaluation polic
-0001bb70: 7920 6163 726f 7373 206c 6f67 6765 6420  y across logged 
-0001bb80: 6461 7461 7365 7473 2c20 220a 2020 2020  datasets, ".    
-0001bb90: 2020 2020 2320 2020 2020 2020 2020 2262      #         "b
-0001bba0: 7574 2066 6f75 6e64 2046 616c 7365 2e22  ut found False."
-0001bbb0: 0a20 2020 2020 2020 2023 2020 2020 2029  .        #     )
-0001bbc0: 0a20 2020 2020 2020 2023 2069 6620 6c65  .        # if le
-0001bbd0: 6e28 7365 6c66 2e6d 756c 7469 706c 655f  n(self.multiple_
-0001bbe0: 6c6f 6767 6564 5f64 6174 6173 6574 2920  logged_dataset) 
-0001bbf0: 213d 206c 656e 2869 6e70 7574 5f64 6963  != len(input_dic
-0001bc00: 7429 3a0a 2020 2020 2020 2020 2320 2020  t):.        #   
-0001bc10: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-0001bc20: 6f72 280a 2020 2020 2020 2020 2320 2020  or(.        #   
-0001bc30: 2020 2020 2020 2245 7870 6563 7465 6420        "Expected 
-0001bc40: 606c 656e 2869 6e70 7574 5f64 6963 7429  `len(input_dict)
-0001bc50: 203d 3d20 6c65 6e28 7365 6c66 2e6d 756c   == len(self.mul
-0001bc60: 7469 706c 655f 6c6f 6767 6564 5f64 6174  tiple_logged_dat
-0001bc70: 6173 6574 2960 2c20 6275 7420 666f 756e  aset)`, but foun
-0001bc80: 6420 4661 6c73 652e 220a 2020 2020 2020  d False.".      
-0001bc90: 2020 2320 2020 2020 290a 0a20 2020 2064    #     )..    d
-0001bca0: 6566 205f 7265 6769 7374 6572 5f6c 6f67  ef _register_log
-0001bcb0: 6765 645f 6461 7461 7365 7428 0a20 2020  ged_dataset(.   
-0001bcc0: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-0001bcd0: 2020 2062 6568 6176 696f 725f 706f 6c69     behavior_poli
-0001bce0: 6379 5f6e 616d 653a 204f 7074 696f 6e61  cy_name: Optiona
-0001bcf0: 6c5b 7374 725d 203d 204e 6f6e 652c 0a20  l[str] = None,. 
-0001bd00: 2020 2020 2020 2064 6174 6173 6574 5f69         dataset_i
-0001bd10: 643a 204f 7074 696f 6e61 6c5b 696e 745d  d: Optional[int]
-0001bd20: 203d 204e 6f6e 652c 0a20 2020 2029 3a0a   = None,.    ):.
-0001bd30: 2020 2020 2020 2020 6966 2062 6568 6176          if behav
-0001bd40: 696f 725f 706f 6c69 6379 5f6e 616d 6520  ior_policy_name 
-0001bd50: 6973 206e 6f74 204e 6f6e 6520 616e 6420  is not None and 
-0001bd60: 6461 7461 7365 745f 6964 2069 7320 6e6f  dataset_id is no
-0001bd70: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-0001bd80: 2020 2020 7365 6c66 2e6c 6f67 6765 645f      self.logged_
-0001bd90: 6461 7461 7365 7420 3d20 7365 6c66 2e6d  dataset = self.m
-0001bda0: 756c 7469 706c 655f 6c6f 6767 6564 5f64  ultiple_logged_d
-0001bdb0: 6174 6173 6574 2e67 6574 280a 2020 2020  ataset.get(.    
-0001bdc0: 2020 2020 2020 2020 2020 2020 6265 6861              beha
-0001bdd0: 7669 6f72 5f70 6f6c 6963 795f 6e61 6d65  vior_policy_name
-0001bde0: 3d62 6568 6176 696f 725f 706f 6c69 6379  =behavior_policy
-0001bdf0: 5f6e 616d 652c 2064 6174 6173 6574 5f69  _name, dataset_i
-0001be00: 643d 6461 7461 7365 745f 6964 0a20 2020  d=dataset_id.   
-0001be10: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-0001be20: 2020 2020 7365 6c66 2e62 6568 6176 696f      self.behavio
-0001be30: 725f 706f 6c69 6379 5f72 6577 6172 6420  r_policy_reward 
-0001be40: 3d20 7365 6c66 2e6c 6f67 6765 645f 6461  = self.logged_da
-0001be50: 7461 7365 745b 2272 6577 6172 6422 5d2e  taset["reward"].
-0001be60: 7265 7368 6170 6528 0a20 2020 2020 2020  reshape(.       
-0001be70: 2020 2020 2028 2d31 2c20 7365 6c66 2e73       (-1, self.s
-0001be80: 7465 705f 7065 725f 7472 616a 6563 746f  tep_per_trajecto
-0001be90: 7279 290a 2020 2020 2020 2020 290a 0a20  ry).        ).. 
-0001bea0: 2020 2020 2020 2069 6620 7365 6c66 2e64         if self.d
-0001beb0: 6973 6162 6c65 5f72 6577 6172 645f 6166  isable_reward_af
-0001bec0: 7465 725f 646f 6e65 3a0a 2020 2020 2020  ter_done:.      
-0001bed0: 2020 2020 2020 646f 6e65 203d 2073 656c        done = sel
-0001bee0: 662e 6c6f 6767 6564 5f64 6174 6173 6574  f.logged_dataset
-0001bef0: 5b22 646f 6e65 225d 2e72 6573 6861 7065  ["done"].reshape
-0001bf00: 2828 2d31 2c20 7365 6c66 2e73 7465 705f  ((-1, self.step_
-0001bf10: 7065 725f 7472 616a 6563 746f 7279 2929  per_trajectory))
-0001bf20: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0001bf30: 662e 6265 6861 7669 6f72 5f70 6f6c 6963  f.behavior_polic
-0001bf40: 795f 7265 7761 7264 203d 2073 656c 662e  y_reward = self.
-0001bf50: 6265 6861 7669 6f72 5f70 6f6c 6963 795f  behavior_policy_
-0001bf60: 7265 7761 7264 202a 2028 0a20 2020 2020  reward * (.     
-0001bf70: 2020 2020 2020 2020 2020 2031 202d 2064             1 - d
-0001bf80: 6f6e 650a 2020 2020 2020 2020 2020 2020  one.            
-0001bf90: 292e 6375 6d70 726f 6428 6178 6973 3d31  ).cumprod(axis=1
-0001bfa0: 290a 0a20 2020 2020 2020 2069 6620 7365  )..        if se
-0001bfb0: 6c66 2e61 6374 696f 6e5f 7479 7065 203d  lf.action_type =
-0001bfc0: 3d20 2264 6973 6372 6574 6522 3a0a 2020  = "discrete":.  
-0001bfd0: 2020 2020 2020 2020 2020 7365 6c66 2e69            self.i
-0001bfe0: 6e70 7574 5f64 6963 745f 203d 207b 0a20  nput_dict_ = {. 
-0001bff0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0001c000: 7374 6570 5f70 6572 5f74 7261 6a65 6374  step_per_traject
-0001c010: 6f72 7922 3a20 7365 6c66 2e73 7465 705f  ory": self.step_
-0001c020: 7065 725f 7472 616a 6563 746f 7279 2c0a  per_trajectory,.
-0001c030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c040: 2261 6374 696f 6e22 3a20 7365 6c66 2e6c  "action": self.l
-0001c050: 6f67 6765 645f 6461 7461 7365 745b 2261  ogged_dataset["a
-0001c060: 6374 696f 6e22 5d2e 6173 7479 7065 2869  ction"].astype(i
-0001c070: 6e74 292c 0a20 2020 2020 2020 2020 2020  nt),.           
-0001c080: 2020 2020 2022 7265 7761 7264 223a 2073       "reward": s
-0001c090: 656c 662e 6265 6861 7669 6f72 5f70 6f6c  elf.behavior_pol
-0001c0a0: 6963 795f 7265 7761 7264 2e66 6c61 7474  icy_reward.flatt
-0001c0b0: 656e 2829 2c0a 2020 2020 2020 2020 2020  en(),.          
-0001c0c0: 2020 2020 2020 2264 6f6e 6522 3a20 7365        "done": se
-0001c0d0: 6c66 2e6c 6f67 6765 645f 6461 7461 7365  lf.logged_datase
-0001c0e0: 745b 2264 6f6e 6522 5d2c 0a20 2020 2020  t["done"],.     
-0001c0f0: 2020 2020 2020 2020 2020 2022 7073 636f             "psco
-0001c100: 7265 223a 2073 656c 662e 6c6f 6767 6564  re": self.logged
-0001c110: 5f64 6174 6173 6574 5b22 7073 636f 7265  _dataset["pscore
-0001c120: 225d 2c0a 2020 2020 2020 2020 2020 2020  "],.            
-0001c130: 7d0a 2020 2020 2020 2020 656c 7365 3a0a  }.        else:.
-0001c140: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0001c150: 2e69 6e70 7574 5f64 6963 745f 203d 207b  .input_dict_ = {
-0001c160: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001c170: 2022 7374 6570 5f70 6572 5f74 7261 6a65   "step_per_traje
-0001c180: 6374 6f72 7922 3a20 7365 6c66 2e73 7465  ctory": self.ste
-0001c190: 705f 7065 725f 7472 616a 6563 746f 7279  p_per_trajectory
-0001c1a0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001c1b0: 2020 2261 6374 696f 6e22 3a20 7365 6c66    "action": self
-0001c1c0: 2e6c 6f67 6765 645f 6461 7461 7365 745b  .logged_dataset[
-0001c1d0: 2261 6374 696f 6e22 5d2e 6173 7479 7065  "action"].astype
-0001c1e0: 2869 6e74 292c 0a20 2020 2020 2020 2020  (int),.         
-0001c1f0: 2020 2020 2020 2022 7265 7761 7264 223a         "reward":
-0001c200: 2073 656c 662e 6265 6861 7669 6f72 5f70   self.behavior_p
-0001c210: 6f6c 6963 795f 7265 7761 7264 2e66 6c61  olicy_reward.fla
-0001c220: 7474 656e 2829 2c0a 2020 2020 2020 2020  tten(),.        
-0001c230: 2020 2020 2020 2020 2264 6f6e 6522 3a20          "done": 
-0001c240: 7365 6c66 2e6c 6f67 6765 645f 6461 7461  self.logged_data
-0001c250: 7365 745b 2264 6f6e 6522 5d2c 0a20 2020  set["done"],.   
-0001c260: 2020 2020 2020 2020 2020 2020 2022 7073               "ps
-0001c270: 636f 7265 223a 2073 656c 662e 6c6f 6767  core": self.logg
-0001c280: 6564 5f64 6174 6173 6574 5b22 7073 636f  ed_dataset["psco
-0001c290: 7265 225d 2c0a 2020 2020 2020 2020 2020  re"],.          
-0001c2a0: 2020 2020 2020 2261 6374 696f 6e5f 7363        "action_sc
-0001c2b0: 616c 6572 223a 2073 656c 662e 6163 7469  aler": self.acti
-0001c2c0: 6f6e 5f73 6361 6c65 722c 0a20 2020 2020  on_scaler,.     
-0001c2d0: 2020 2020 2020 2020 2020 2022 6261 6e64             "band
-0001c2e0: 7769 6474 6822 3a20 7365 6c66 2e62 616e  width": self.ban
-0001c2f0: 6477 6964 7468 2c0a 2020 2020 2020 2020  dwidth,.        
-0001c300: 2020 2020 7d0a 0a20 2020 2064 6566 205f      }..    def _
-0001c310: 7461 7267 6574 5f76 616c 7565 5f67 6976  target_value_giv
-0001c320: 656e 5f69 6478 2873 656c 662c 2069 6478  en_idx(self, idx
-0001c330: 5f3a 2069 6e74 2c20 7265 7761 7264 5f73  _: int, reward_s
-0001c340: 6361 6c65 3a20 6e70 2e6e 6461 7272 6179  cale: np.ndarray
-0001c350: 293a 0a20 2020 2020 2020 2022 2222 4f62  ):.        """Ob
-0001c360: 7461 696e 2074 6865 2072 6577 6172 6420  tain the reward 
-0001c370: 7661 6c75 6520 636f 7272 6573 706f 6e64  value correspond
-0001c380: 696e 6720 746f 2074 6865 2067 6976 656e  ing to the given
-0001c390: 2069 6478 2077 6865 6e20 6573 7469 6d61   idx when estima
-0001c3a0: 7469 6e67 2074 6865 2043 4446 2e0a 0a20  ting the CDF... 
-0001c3b0: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
-0001c3c0: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
-0001c3d0: 2d0a 2020 2020 2020 2020 6964 785f 3a20  -.        idx_: 
-0001c3e0: 6c69 7374 206f 6620 696e 7420 6f72 2069  list of int or i
-0001c3f0: 6e74 0a20 2020 2020 2020 2020 2020 2049  nt.            I
-0001c400: 6e64 6963 6174 696e 6720 696e 6465 782e  ndicating index.
-0001c410: 2049 6620 6120 6c69 7374 2069 7320 6769   If a list is gi
-0001c420: 7665 6e2c 2074 6865 2061 7665 7261 6765  ven, the average
-0001c430: 206f 6620 7468 6520 7477 6f20 7769 6c6c   of the two will
-0001c440: 2062 6520 7265 7475 726e 6564 2e0a 0a20   be returned... 
-0001c450: 2020 2020 2020 2072 6577 6172 645f 7363         reward_sc
-0001c460: 616c 653a 2061 7272 6179 2d6c 696b 6520  ale: array-like 
-0001c470: 6f66 2073 6861 7065 2028 6e5f 7061 7274  of shape (n_part
-0001c480: 6974 696f 6e2c 2029 0a20 2020 2020 2020  ition, ).       
-0001c490: 2020 2020 2053 6361 6c65 206f 6620 7468       Scale of th
-0001c4a0: 6520 7472 616a 6563 746f 7279 2d77 6973  e trajectory-wis
-0001c4b0: 6520 7265 7761 7264 2075 7365 6420 666f  e reward used fo
-0001c4c0: 7220 782d 6178 6973 206f 6620 7468 6520  r x-axis of the 
-0001c4d0: 4344 4620 706c 6f74 2e0a 0a20 2020 2020  CDF plot...     
-0001c4e0: 2020 2052 6574 7572 6e0a 2020 2020 2020     Return.      
-0001c4f0: 2020 2d2d 2d2d 2d2d 2d0a 2020 2020 2020    -------.      
-0001c500: 2020 7461 7267 6574 5f76 616c 7565 3a20    target_value: 
-0001c510: 666c 6f61 740a 2020 2020 2020 2020 2020  float.          
-0001c520: 2020 5661 6c75 6520 6f66 2074 6865 2067    Value of the g
-0001c530: 6976 656e 2069 6e64 6578 2e0a 0a20 2020  iven index...   
-0001c540: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0001c550: 2069 6620 6c65 6e28 6964 785f 2920 3d3d   if len(idx_) ==
-0001c560: 2030 206f 7220 6964 785f 5b30 5d20 3d3d   0 or idx_[0] ==
-0001c570: 206c 656e 2872 6577 6172 645f 7363 616c   len(reward_scal
-0001c580: 6529 202d 2031 3a0a 2020 2020 2020 2020  e) - 1:.        
-0001c590: 2020 2020 7461 7267 6574 5f76 616c 7565      target_value
-0001c5a0: 203d 2072 6577 6172 645f 7363 616c 655b   = reward_scale[
-0001c5b0: 2d31 5d0a 2020 2020 2020 2020 656c 7365  -1].        else
-0001c5c0: 3a0a 2020 2020 2020 2020 2020 2020 7461  :.            ta
-0001c5d0: 7267 6574 5f69 6478 203d 2069 6478 5f5b  rget_idx = idx_[
-0001c5e0: 305d 0a20 2020 2020 2020 2020 2020 2074  0].            t
-0001c5f0: 6172 6765 745f 7661 6c75 6520 3d20 2872  arget_value = (r
-0001c600: 6577 6172 645f 7363 616c 655b 7461 7267  eward_scale[targ
-0001c610: 6574 5f69 6478 5d20 2b20 7265 7761 7264  et_idx] + reward
-0001c620: 5f73 6361 6c65 5b74 6172 6765 745f 6964  _scale[target_id
-0001c630: 7820 2b20 315d 2920 2f20 320a 2020 2020  x + 1]) / 2.    
-0001c640: 2020 2020 7265 7475 726e 2074 6172 6765      return targe
-0001c650: 745f 7661 6c75 650a 0a20 2020 2064 6566  t_value..    def
-0001c660: 206f 6274 6169 6e5f 7265 7761 7264 5f73   obtain_reward_s
-0001c670: 6361 6c65 280a 2020 2020 2020 2020 7365  cale(.        se
-0001c680: 6c66 2c0a 2020 2020 293a 0a20 2020 2020  lf,.    ):.     
-0001c690: 2020 2022 2222 4f62 7461 696e 2074 6865     """Obtain the
-0001c6a0: 2072 6577 6172 6420 7363 616c 6520 2878   reward scale (x
-0001c6b0: 2d61 7869 7329 2066 6f72 2074 6865 2063  -axis) for the c
-0001c6c0: 756d 756c 6174 6976 6520 6469 7374 7269  umulative distri
-0001c6d0: 6275 7469 6f6e 2066 756e 6374 696f 6e2e  bution function.
-0001c6e0: 0a0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
-0001c6f0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0001c700: 0a20 2020 2020 2020 2072 6577 6172 645f  .        reward_
-0001c710: 7363 616c 653a 206e 6461 7272 6179 206f  scale: ndarray o
-0001c720: 6620 7368 6170 6520 286e 5f75 6e69 7175  f shape (n_uniqu
-0001c730: 655f 7265 7761 7264 2c20 2920 6f72 2028  e_reward, ) or (
-0001c740: 6e5f 7061 7274 6974 696f 6e2c 2029 0a20  n_partition, ). 
-0001c750: 2020 2020 2020 2020 2020 2052 6577 6172             Rewar
-0001c760: 6420 5363 616c 6520 2878 2d61 7869 7320  d Scale (x-axis 
-0001c770: 6f66 2074 6865 2063 756d 756c 6174 6976  of the cumulativ
-0001c780: 6520 6469 7374 7269 6275 7469 6f6e 2066  e distribution f
-0001c790: 756e 6374 696f 6e29 2e0a 0a20 2020 2020  unction)...     
-0001c7a0: 2020 2022 2222 0a20 2020 2020 2020 2069     """.        i
-0001c7b0: 6620 7365 6c66 2e75 7365 5f63 7573 746f  f self.use_custo
-0001c7c0: 6d5f 7265 7761 7264 5f73 6361 6c65 3a0a  m_reward_scale:.
-0001c7d0: 2020 2020 2020 2020 2020 2020 7265 7761              rewa
-0001c7e0: 7264 5f73 6361 6c65 203d 206e 702e 6c69  rd_scale = np.li
-0001c7f0: 6e73 7061 6365 280a 2020 2020 2020 2020  nspace(.        
-0001c800: 2020 2020 2020 2020 7365 6c66 2e73 6361          self.sca
-0001c810: 6c65 5f6d 696e 2c20 7365 6c66 2e73 6361  le_min, self.sca
-0001c820: 6c65 5f6d 6178 2c20 6e75 6d3d 7365 6c66  le_max, num=self
-0001c830: 2e6e 5f70 6172 7469 7469 6f6e 0a20 2020  .n_partition.   
-0001c840: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-0001c850: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-0001c860: 2020 2020 2020 7265 7761 7264 203d 2073        reward = s
-0001c870: 656c 662e 6265 6861 7669 6f72 5f70 6f6c  elf.behavior_pol
-0001c880: 6963 795f 7265 7761 7264 2e73 756d 2861  icy_reward.sum(a
-0001c890: 7869 733d 3129 0a20 2020 2020 2020 2020  xis=1).         
-0001c8a0: 2020 2072 6577 6172 645f 7363 616c 6520     reward_scale 
-0001c8b0: 3d20 6e70 2e73 6f72 7428 6e70 2e75 6e69  = np.sort(np.uni
-0001c8c0: 7175 6528 7265 7761 7264 2929 0a0a 2020  que(reward))..  
-0001c8d0: 2020 2020 2020 7265 7475 726e 2072 6577        return rew
-0001c8e0: 6172 645f 7363 616c 650a 0a20 2020 2064  ard_scale..    d
-0001c8f0: 6566 205f 6573 7469 6d61 7465 5f63 756d  ef _estimate_cum
-0001c900: 756c 6174 6976 655f 6469 7374 7269 6275  ulative_distribu
-0001c910: 7469 6f6e 5f66 756e 6374 696f 6e28 0a20  tion_function(. 
-0001c920: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-0001c930: 2020 2020 2069 6e70 7574 5f64 6963 743a       input_dict:
-0001c940: 204f 5045 496e 7075 7444 6963 742c 0a20   OPEInputDict,. 
-0001c950: 2020 2020 2020 2063 6f6d 7061 7265 645f         compared_
-0001c960: 6573 7469 6d61 746f 7273 3a20 4f70 7469  estimators: Opti
-0001c970: 6f6e 616c 5b4c 6973 745b 7374 725d 5d20  onal[List[str]] 
-0001c980: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-0001c990: 7265 7761 7264 5f73 6361 6c65 3a20 4f70  reward_scale: Op
-0001c9a0: 7469 6f6e 616c 5b6e 702e 6e64 6172 7261  tional[np.ndarra
-0001c9b0: 795d 203d 204e 6f6e 652c 0a20 2020 2029  y] = None,.    )
-0001c9c0: 3a0a 2020 2020 2020 2020 2222 2245 7374  :.        """Est
-0001c9d0: 696d 6174 6520 7468 6520 6375 6d75 6c61  imate the cumula
-0001c9e0: 7469 7665 2064 6973 7472 6962 7574 696f  tive distributio
-0001c9f0: 6e20 6f66 2074 6865 2074 7261 6a65 6374  n of the traject
-0001ca00: 6f72 792d 7769 7365 2072 6577 6172 6420  ory-wise reward 
-0001ca10: 756e 6465 7220 7468 6520 6769 7665 6e20  under the given 
-0001ca20: 6576 616c 7561 7469 6f6e 2070 6f6c 6963  evaluation polic
-0001ca30: 6965 732e 0a0a 2020 2020 2020 2020 5061  ies...        Pa
-0001ca40: 7261 6d65 7465 7273 0a20 2020 2020 2020  rameters.       
-0001ca50: 202d 2d2d 2d2d 2d2d 0a20 2020 2020 2020   -------.       
-0001ca60: 2069 6e70 7574 5f64 6963 743a 204f 5045   input_dict: OPE
-0001ca70: 496e 7075 7444 6963 740a 2020 2020 2020  InputDict.      
-0001ca80: 2020 2020 2020 4469 6374 696f 6e61 7279        Dictionary
-0001ca90: 206f 6620 7468 6520 4f50 4520 696e 7075   of the OPE inpu
-0001caa0: 7473 2066 6f72 2065 6163 6820 6576 616c  ts for each eval
-0001cab0: 7561 7469 6f6e 2070 6f6c 6963 792e 0a0a  uation policy...
-0001cac0: 2020 2020 2020 2020 2020 2020 2e2e 2063              .. c
-0001cad0: 6f64 652d 626c 6f63 6b3a 3a20 7079 7468  ode-block:: pyth
-0001cae0: 6f6e 0a0a 2020 2020 2020 2020 2020 2020  on..            
-0001caf0: 2020 2020 6b65 793a 205b 6576 616c 7561      key: [evalua
-0001cb00: 7469 6f6e 5f70 6f6c 6963 795d 5b0a 2020  tion_policy][.  
-0001cb10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cb20: 2020 6576 616c 7561 7469 6f6e 5f70 6f6c    evaluation_pol
-0001cb30: 6963 795f 6163 7469 6f6e 2c0a 2020 2020  icy_action,.    
+0001a790: 6d69 6e5f 7661 6c3d 312c 0a20 2020 2020  min_val=1,.     
+0001a7a0: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+0001a7b0: 2020 6966 2073 656c 662e 6163 7469 6f6e    if self.action
+0001a7c0: 5f74 7970 6520 3d3d 2022 636f 6e74 696e  _type == "contin
+0001a7d0: 756f 7573 223a 0a20 2020 2020 2020 2020  uous":.         
+0001a7e0: 2020 2069 6620 7365 6c66 2e61 6374 696f     if self.actio
+0001a7f0: 6e5f 7363 616c 6572 2069 7320 6e6f 7420  n_scaler is not 
+0001a800: 4e6f 6e65 2061 6e64 206e 6f74 2069 7369  None and not isi
+0001a810: 6e73 7461 6e63 6528 0a20 2020 2020 2020  nstance(.       
+0001a820: 2020 2020 2020 2020 2073 656c 662e 6163           self.ac
+0001a830: 7469 6f6e 5f73 6361 6c65 722c 2041 6374  tion_scaler, Act
+0001a840: 696f 6e53 6361 6c65 720a 2020 2020 2020  ionScaler.      
+0001a850: 2020 2020 2020 293a 0a20 2020 2020 2020        ):.       
+0001a860: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+0001a870: 616c 7565 4572 726f 7228 0a20 2020 2020  alueError(.     
+0001a880: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0001a890: 6163 7469 6f6e 5f73 6361 6c65 7220 6d75  action_scaler mu
+0001a8a0: 7374 2062 6520 616e 2069 6e73 7461 6e63  st be an instanc
+0001a8b0: 6520 6f66 2064 3372 6c70 792e 7072 6570  e of d3rlpy.prep
+0001a8c0: 726f 6365 7373 696e 672e 4163 7469 6f6e  rocessing.Action
+0001a8d0: 5363 616c 6572 2c20 6275 7420 666f 756e  Scaler, but foun
+0001a8e0: 6420 4661 6c73 6522 0a20 2020 2020 2020  d False".       
+0001a8f0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+0001a900: 2020 2020 2020 2063 6865 636b 5f73 6361         check_sca
+0001a910: 6c61 7228 0a20 2020 2020 2020 2020 2020  lar(.           
+0001a920: 2020 2020 2073 656c 662e 6261 6e64 7769       self.bandwi
+0001a930: 6474 682c 206e 616d 653d 2262 616e 6477  dth, name="bandw
+0001a940: 6964 7468 222c 2074 6172 6765 745f 7479  idth", target_ty
+0001a950: 7065 3d66 6c6f 6174 2c20 6d69 6e5f 7661  pe=float, min_va
+0001a960: 6c3d 302e 300a 2020 2020 2020 2020 2020  l=0.0.          
+0001a970: 2020 290a 0a20 2020 2020 2020 2073 656c    )..        sel
+0001a980: 662e 5f65 7374 696d 6174 655f 636f 6e66  f._estimate_conf
+0001a990: 6964 656e 6365 5f69 6e74 6572 7661 6c20  idence_interval 
+0001a9a0: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
+0001a9b0: 2262 6f6f 7473 7472 6170 223a 2065 7374  "bootstrap": est
+0001a9c0: 696d 6174 655f 636f 6e66 6964 656e 6365  imate_confidence
+0001a9d0: 5f69 6e74 6572 7661 6c5f 6279 5f62 6f6f  _interval_by_boo
+0001a9e0: 7473 7472 6170 2c0a 2020 2020 2020 2020  tstrap,.        
+0001a9f0: 2020 2020 2268 6f65 6666 6469 6e67 223a      "hoeffding":
+0001aa00: 2065 7374 696d 6174 655f 636f 6e66 6964   estimate_confid
+0001aa10: 656e 6365 5f69 6e74 6572 7661 6c5f 6279  ence_interval_by
+0001aa20: 5f68 6f65 6666 6469 6e67 2c0a 2020 2020  _hoeffding,.    
+0001aa30: 2020 2020 2020 2020 2262 6572 6e73 7465          "bernste
+0001aa40: 696e 223a 2065 7374 696d 6174 655f 636f  in": estimate_co
+0001aa50: 6e66 6964 656e 6365 5f69 6e74 6572 7661  nfidence_interva
+0001aa60: 6c5f 6279 5f65 6d70 6972 6963 616c 5f62  l_by_empirical_b
+0001aa70: 6572 6e73 7465 696e 2c0a 2020 2020 2020  ernstein,.      
+0001aa80: 2020 2020 2020 2274 7465 7374 223a 2065        "ttest": e
+0001aa90: 7374 696d 6174 655f 636f 6e66 6964 656e  stimate_confiden
+0001aaa0: 6365 5f69 6e74 6572 7661 6c5f 6279 5f74  ce_interval_by_t
+0001aab0: 5f74 6573 742c 0a20 2020 2020 2020 207d  _test,.        }
+0001aac0: 0a0a 2020 2020 6465 6620 5f63 6865 636b  ..    def _check
+0001aad0: 5f63 6f6d 7061 7265 645f 6573 7469 6d61  _compared_estima
+0001aae0: 746f 7273 280a 2020 2020 2020 2020 7365  tors(.        se
+0001aaf0: 6c66 2c20 636f 6d70 6172 6564 5f65 7374  lf, compared_est
+0001ab00: 696d 6174 6f72 733a 204f 7074 696f 6e61  imators: Optiona
+0001ab10: 6c5b 4c69 7374 5b73 7472 5d5d 203d 204e  l[List[str]] = N
+0001ab20: 6f6e 650a 2020 2020 293a 0a20 2020 2020  one.    ):.     
+0001ab30: 2020 2069 6620 636f 6d70 6172 6564 5f65     if compared_e
+0001ab40: 7374 696d 6174 6f72 7320 6973 204e 6f6e  stimators is Non
+0001ab50: 653a 0a20 2020 2020 2020 2020 2020 2063  e:.            c
+0001ab60: 6f6d 7061 7265 645f 6573 7469 6d61 746f  ompared_estimato
+0001ab70: 7273 203d 2073 656c 662e 6573 7469 6d61  rs = self.estima
+0001ab80: 746f 7273 5f6e 616d 650a 2020 2020 2020  tors_name.      
+0001ab90: 2020 656c 6966 206e 6f74 2073 6574 2863    elif not set(c
+0001aba0: 6f6d 7061 7265 645f 6573 7469 6d61 746f  ompared_estimato
+0001abb0: 7273 292e 6973 7375 6273 6574 2873 656c  rs).issubset(sel
+0001abc0: 662e 6573 7469 6d61 746f 7273 5f6e 616d  f.estimators_nam
+0001abd0: 6529 3a0a 2020 2020 2020 2020 2020 2020  e):.            
+0001abe0: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+0001abf0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0001ac00: 2020 2263 6f6d 7061 7265 645f 6573 7469    "compared_esti
+0001ac10: 6d61 746f 7273 206d 7573 7420 6265 2061  mators must be a
+0001ac20: 2073 7562 7365 7420 6f66 2073 656c 662e   subset of self.
+0001ac30: 6573 7469 6d61 746f 7273 5f6e 616d 652c  estimators_name,
+0001ac40: 2062 7574 2066 6f75 6e64 2046 616c 7365   but found False
+0001ac50: 2e22 0a20 2020 2020 2020 2020 2020 2029  .".            )
+0001ac60: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0001ac70: 636f 6d70 6172 6564 5f65 7374 696d 6174  compared_estimat
+0001ac80: 6f72 730a 0a20 2020 2064 6566 205f 6375  ors..    def _cu
+0001ac90: 7374 6f6d 5f72 6577 6172 645f 7363 616c  stom_reward_scal
+0001aca0: 6528 0a20 2020 2020 2020 2073 656c 662c  e(.        self,
+0001acb0: 0a20 2020 2020 2020 2073 6361 6c65 5f6d  .        scale_m
+0001acc0: 696e 3a20 4f70 7469 6f6e 616c 5b66 6c6f  in: Optional[flo
+0001acd0: 6174 5d20 3d20 4e6f 6e65 2c0a 2020 2020  at] = None,.    
+0001ace0: 2020 2020 7363 616c 655f 6d61 783a 204f      scale_max: O
+0001acf0: 7074 696f 6e61 6c5b 666c 6f61 745d 203d  ptional[float] =
+0001ad00: 204e 6f6e 652c 0a20 2020 2020 2020 206e   None,.        n
+0001ad10: 5f70 6172 7469 7469 6f6e 3a20 4f70 7469  _partition: Opti
+0001ad20: 6f6e 616c 5b69 6e74 5d20 3d20 4e6f 6e65  onal[int] = None
+0001ad30: 2c0a 2020 2020 293a 0a20 2020 2020 2020  ,.    ):.       
+0001ad40: 2069 6620 7363 616c 655f 6d69 6e20 6973   if scale_min is
+0001ad50: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+0001ad60: 2020 2069 6620 7365 6c66 2e73 6361 6c65     if self.scale
+0001ad70: 5f6d 696e 2069 7320 4e6f 6e65 3a0a 2020  _min is None:.  
+0001ad80: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+0001ad90: 6973 6520 5661 6c75 6545 7272 6f72 280a  ise ValueError(.
+0001ada0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001adb0: 2020 2020 2273 6361 6c65 5f6d 696e 206d      "scale_min m
+0001adc0: 7573 7420 6265 2073 7065 6369 6669 6564  ust be specified
+0001add0: 2077 6865 6e20 7365 6c66 2e73 6361 6c65   when self.scale
+0001ade0: 5f6d 696e 2069 7320 4e6f 6e65 220a 2020  _min is None".  
+0001adf0: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+0001ae00: 2020 2020 2020 2020 2020 2020 656c 7365              else
+0001ae10: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0001ae20: 2020 7363 616c 655f 6d69 6e20 3d20 7365    scale_min = se
+0001ae30: 6c66 2e73 6361 6c65 5f6d 696e 0a20 2020  lf.scale_min.   
+0001ae40: 2020 2020 2069 6620 7363 616c 655f 6d61       if scale_ma
+0001ae50: 7820 6973 204e 6f6e 653a 0a20 2020 2020  x is None:.     
+0001ae60: 2020 2020 2020 2069 6620 7365 6c66 2e73         if self.s
+0001ae70: 6361 6c65 5f6d 6178 2069 7320 4e6f 6e65  cale_max is None
+0001ae80: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0001ae90: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+0001aea0: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
+0001aeb0: 2020 2020 2020 2020 2273 6361 6c65 5f6d          "scale_m
+0001aec0: 6178 206d 7573 7420 6265 2073 7065 6369  ax must be speci
+0001aed0: 6669 6564 2077 6865 6e20 7365 6c66 2e73  fied when self.s
+0001aee0: 6361 6c65 5f6d 6178 2069 7320 4e6f 6e65  cale_max is None
+0001aef0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+0001af00: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+0001af10: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0001af20: 2020 2020 2020 7363 616c 655f 6d61 7820        scale_max 
+0001af30: 3d20 7365 6c66 2e73 6361 6c65 5f6d 6178  = self.scale_max
+0001af40: 0a20 2020 2020 2020 2069 6620 6e5f 7061  .        if n_pa
+0001af50: 7274 6974 696f 6e20 6973 204e 6f6e 653a  rtition is None:
+0001af60: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0001af70: 7365 6c66 2e6e 5f70 6172 7469 7469 6f6e  self.n_partition
+0001af80: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
+0001af90: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+0001afa0: 5661 6c75 6545 7272 6f72 280a 2020 2020  ValueError(.    
+0001afb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001afc0: 226e 5f70 6172 7469 7469 6f6e 206d 7573  "n_partition mus
+0001afd0: 7420 6265 2073 7065 6369 6669 6564 2077  t be specified w
+0001afe0: 6865 6e20 7365 6c66 2e6e 5f70 6172 7469  hen self.n_parti
+0001aff0: 7469 6f6e 2069 7320 4e6f 6e65 220a 2020  tion is None".  
+0001b000: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+0001b010: 2020 2020 2020 2020 2020 2020 656c 7365              else
+0001b020: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0001b030: 2020 6e5f 7061 7274 6974 696f 6e20 3d20    n_partition = 
+0001b040: 7365 6c66 2e6e 5f70 6172 7469 7469 6f6e  self.n_partition
+0001b050: 0a0a 2020 2020 2020 2020 6368 6563 6b5f  ..        check_
+0001b060: 7363 616c 6172 2873 6361 6c65 5f6d 696e  scalar(scale_min
+0001b070: 2c20 6e61 6d65 3d22 7363 616c 655f 6d69  , name="scale_mi
+0001b080: 6e22 2c20 7461 7267 6574 5f74 7970 653d  n", target_type=
+0001b090: 666c 6f61 7429 0a20 2020 2020 2020 2063  float).        c
+0001b0a0: 6865 636b 5f73 6361 6c61 7228 7363 616c  heck_scalar(scal
+0001b0b0: 655f 6d61 782c 206e 616d 653d 2273 6361  e_max, name="sca
+0001b0c0: 6c65 5f6d 6178 222c 2074 6172 6765 745f  le_max", target_
+0001b0d0: 7479 7065 3d66 6c6f 6174 290a 2020 2020  type=float).    
+0001b0e0: 2020 2020 6368 6563 6b5f 7363 616c 6172      check_scalar
+0001b0f0: 286e 5f70 6172 7469 7469 6f6e 2c20 6e61  (n_partition, na
+0001b100: 6d65 3d22 6e5f 7061 7274 6974 696f 6e22  me="n_partition"
+0001b110: 2c20 7461 7267 6574 5f74 7970 653d 696e  , target_type=in
+0001b120: 742c 206d 696e 5f76 616c 3d31 290a 2020  t, min_val=1).  
+0001b130: 2020 2020 2020 7265 7475 726e 206e 702e        return np.
+0001b140: 6c69 6e73 7061 6365 2873 6361 6c65 5f6d  linspace(scale_m
+0001b150: 696e 2c20 7363 616c 655f 6d61 782c 206e  in, scale_max, n
+0001b160: 756d 3d6e 5f70 6172 7469 7469 6f6e 290a  um=n_partition).
+0001b170: 0a20 2020 2064 6566 205f 6368 6563 6b5f  .    def _check_
+0001b180: 7265 7761 7264 5f73 6361 6c65 2873 656c  reward_scale(sel
+0001b190: 662c 2072 6577 6172 645f 7363 616c 653a  f, reward_scale:
+0001b1a0: 204f 7074 696f 6e61 6c5b 6e70 2e6e 6461   Optional[np.nda
+0001b1b0: 7272 6179 5d20 3d20 4e6f 6e65 293a 0a20  rray] = None):. 
+0001b1c0: 2020 2020 2020 2069 6620 7265 7761 7264         if reward
+0001b1d0: 5f73 6361 6c65 2069 7320 6e6f 7420 4e6f  _scale is not No
+0001b1e0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+0001b1f0: 6368 6563 6b5f 6172 7261 7928 7265 7761  check_array(rewa
+0001b200: 7264 5f73 6361 6c65 2c20 6e61 6d65 3d22  rd_scale, name="
+0001b210: 7265 7761 7264 5f73 6361 6c65 222c 2065  reward_scale", e
+0001b220: 7870 6563 7465 645f 6469 6d3d 3129 0a20  xpected_dim=1). 
+0001b230: 2020 2020 2020 2020 2020 2072 6577 6172             rewar
+0001b240: 645f 7363 616c 6520 3d20 6e70 2e73 6f72  d_scale = np.sor
+0001b250: 7428 7265 7761 7264 5f73 6361 6c65 290a  t(reward_scale).
+0001b260: 2020 2020 2020 2020 7265 7475 726e 2072          return r
+0001b270: 6577 6172 645f 7363 616c 650a 0a20 2020  eward_scale..   
+0001b280: 2064 6566 205f 6368 6563 6b5f 6376 6172   def _check_cvar
+0001b290: 5f61 6c70 6861 7328 7365 6c66 2c20 616c  _alphas(self, al
+0001b2a0: 7068 6173 3a20 4f70 7469 6f6e 616c 5b55  phas: Optional[U
+0001b2b0: 6e69 6f6e 5b66 6c6f 6174 2c20 6e70 2e6e  nion[float, np.n
+0001b2c0: 6461 7272 6179 5d5d 203d 204e 6f6e 6529  darray]] = None)
+0001b2d0: 3a0a 2020 2020 2020 2020 6966 2061 6c70  :.        if alp
+0001b2e0: 6861 7320 6973 204e 6f6e 653a 0a20 2020  has is None:.   
+0001b2f0: 2020 2020 2020 2020 2061 6c70 6861 7320           alphas 
+0001b300: 3d20 6e70 2e6c 696e 7370 6163 6528 302c  = np.linspace(0,
+0001b310: 2031 2c20 3231 290a 2020 2020 2020 2020   1, 21).        
+0001b320: 6966 2069 7369 6e73 7461 6e63 6528 616c  if isinstance(al
+0001b330: 7068 6173 2c20 666c 6f61 7429 3a0a 2020  phas, float):.  
+0001b340: 2020 2020 2020 2020 2020 6368 6563 6b5f            check_
+0001b350: 7363 616c 6172 280a 2020 2020 2020 2020  scalar(.        
+0001b360: 2020 2020 2020 2020 616c 7068 6173 2c20          alphas, 
+0001b370: 6e61 6d65 3d22 616c 7068 6173 222c 2074  name="alphas", t
+0001b380: 6172 6765 745f 7479 7065 3d66 6c6f 6174  arget_type=float
+0001b390: 2c20 6d69 6e5f 7661 6c3d 302e 302c 206d  , min_val=0.0, m
+0001b3a0: 6178 5f76 616c 3d31 2e30 0a20 2020 2020  ax_val=1.0.     
+0001b3b0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0001b3c0: 2020 2020 2061 6c70 6861 7320 3d20 6e70       alphas = np
+0001b3d0: 2e61 7272 6179 285b 616c 7068 6173 5d2c  .array([alphas],
+0001b3e0: 2064 7479 7065 3d66 6c6f 6174 290a 2020   dtype=float).  
+0001b3f0: 2020 2020 2020 656c 6966 2069 7369 6e73        elif isins
+0001b400: 7461 6e63 6528 616c 7068 6173 2c20 6e70  tance(alphas, np
+0001b410: 2e6e 6461 7272 6179 293a 0a20 2020 2020  .ndarray):.     
+0001b420: 2020 2020 2020 2063 6865 636b 5f61 7272         check_arr
+0001b430: 6179 2861 6c70 6861 732c 206e 616d 653d  ay(alphas, name=
+0001b440: 2261 6c70 6861 7322 2c20 6578 7065 6374  "alphas", expect
+0001b450: 6564 5f64 696d 3d31 2c20 6d69 6e5f 7661  ed_dim=1, min_va
+0001b460: 6c3d 302e 302c 206d 6178 5f76 616c 3d31  l=0.0, max_val=1
+0001b470: 2e30 290a 2020 2020 2020 2020 656c 7365  .0).        else
+0001b480: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+0001b490: 6973 6520 5661 6c75 6545 7272 6f72 280a  ise ValueError(.
+0001b4a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b4b0: 6622 616c 7068 6173 206d 7573 7420 6265  f"alphas must be
+0001b4c0: 2066 6c6f 6174 206f 7220 6e70 2e6e 6461   float or np.nda
+0001b4d0: 7272 6179 2c20 6275 7420 7b74 7970 6528  rray, but {type(
+0001b4e0: 616c 7068 6173 297d 2069 7320 6769 7665  alphas)} is give
+0001b4f0: 6e22 0a20 2020 2020 2020 2020 2020 2029  n".            )
+0001b500: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0001b510: 6e70 2e73 6f72 7428 616c 7068 6173 290a  np.sort(alphas).
+0001b520: 0a20 2020 2064 6566 205f 6368 6563 6b5f  .    def _check_
+0001b530: 6261 7369 635f 7669 7375 616c 697a 6174  basic_visualizat
+0001b540: 696f 6e5f 696e 7075 7473 280a 2020 2020  ion_inputs(.    
+0001b550: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
+0001b560: 2020 6875 653a 2073 7472 2c0a 2020 2020    hue: str,.    
+0001b570: 2020 2020 6e5f 636f 6c73 3a20 4f70 7469      n_cols: Opti
+0001b580: 6f6e 616c 5b69 6e74 5d20 3d20 4e6f 6e65  onal[int] = None
+0001b590: 2c0a 2020 2020 2020 2020 6669 675f 6469  ,.        fig_di
+0001b5a0: 723a 204f 7074 696f 6e61 6c5b 5061 7468  r: Optional[Path
+0001b5b0: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
+0001b5c0: 2020 6669 675f 6e61 6d65 3a20 4f70 7469    fig_name: Opti
+0001b5d0: 6f6e 616c 5b73 7472 5d20 3d20 4e6f 6e65  onal[str] = None
+0001b5e0: 2c0a 2020 2020 293a 0a20 2020 2020 2020  ,.    ):.       
+0001b5f0: 2069 6620 6875 6520 6e6f 7420 696e 205b   if hue not in [
+0001b600: 2265 7374 696d 6174 6f72 222c 2022 706f  "estimator", "po
+0001b610: 6c69 6379 225d 3a0a 2020 2020 2020 2020  licy"]:.        
+0001b620: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+0001b630: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
+0001b640: 2020 2020 2020 6622 6875 6520 6d75 7374        f"hue must
+0001b650: 2062 6520 6569 7468 6572 2060 6573 7469   be either `esti
+0001b660: 6d61 746f 7260 206f 7220 6070 6f6c 6963  mator` or `polic
+0001b670: 7960 2c20 6275 7420 7b68 7565 7d20 6973  y`, but {hue} is
+0001b680: 2067 6976 656e 220a 2020 2020 2020 2020   given".        
+0001b690: 2020 2020 290a 2020 2020 2020 2020 6966      ).        if
+0001b6a0: 206e 5f63 6f6c 7320 6973 206e 6f74 204e   n_cols is not N
+0001b6b0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+0001b6c0: 2063 6865 636b 5f73 6361 6c61 7228 6e5f   check_scalar(n_
+0001b6d0: 636f 6c73 2c20 6e61 6d65 3d22 6e5f 636f  cols, name="n_co
+0001b6e0: 6c73 222c 2074 6172 6765 745f 7479 7065  ls", target_type
+0001b6f0: 3d69 6e74 2c20 6d69 6e5f 7661 6c3d 3129  =int, min_val=1)
+0001b700: 0a20 2020 2020 2020 2069 6620 6669 675f  .        if fig_
+0001b710: 6469 7220 6973 206e 6f74 204e 6f6e 6520  dir is not None 
+0001b720: 616e 6420 6e6f 7420 6973 696e 7374 616e  and not isinstan
+0001b730: 6365 2866 6967 5f64 6972 2c20 5061 7468  ce(fig_dir, Path
+0001b740: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
+0001b750: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+0001b760: 6622 6669 675f 6469 7220 6d75 7374 2062  f"fig_dir must b
+0001b770: 6520 6120 5061 7468 2c20 6275 7420 7b74  e a Path, but {t
+0001b780: 7970 6528 6669 675f 6469 7229 7d20 6973  ype(fig_dir)} is
+0001b790: 2067 6976 656e 2229 0a20 2020 2020 2020   given").       
+0001b7a0: 2069 6620 6669 675f 6e61 6d65 2069 7320   if fig_name is 
+0001b7b0: 6e6f 7420 4e6f 6e65 2061 6e64 206e 6f74  not None and not
+0001b7c0: 2069 7369 6e73 7461 6e63 6528 6669 675f   isinstance(fig_
+0001b7d0: 6e61 6d65 2c20 7374 7229 3a0a 2020 2020  name, str):.    
+0001b7e0: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+0001b7f0: 6c75 6545 7272 6f72 2866 2266 6967 5f64  lueError(f"fig_d
+0001b800: 6972 206d 7573 7420 6265 2061 2073 7472  ir must be a str
+0001b810: 696e 672c 2062 7574 207b 7479 7065 2866  ing, but {type(f
+0001b820: 6967 5f64 6972 297d 2069 7320 6769 7665  ig_dir)} is give
+0001b830: 6e22 290a 0a20 2020 2064 6566 205f 6368  n")..    def _ch
+0001b840: 6563 6b5f 696e 7075 745f 6469 6374 5f66  eck_input_dict_f
+0001b850: 6f72 5f76 6973 7561 6c69 7a65 5f6d 756c  or_visualize_mul
+0001b860: 7469 706c 655f 6573 7469 6d61 7465 7328  tiple_estimates(
+0001b870: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+0001b880: 2020 2020 2020 2069 6e70 7574 5f64 6963         input_dic
+0001b890: 743a 204d 756c 7469 706c 6549 6e70 7574  t: MultipleInput
+0001b8a0: 4469 6374 2c0a 2020 2020 293a 0a20 2020  Dict,.    ):.   
+0001b8b0: 2020 2020 2069 6620 6e6f 7420 6973 696e       if not isin
+0001b8c0: 7374 616e 6365 2869 6e70 7574 5f64 6963  stance(input_dic
+0001b8d0: 742c 204d 756c 7469 706c 6549 6e70 7574  t, MultipleInput
+0001b8e0: 4469 6374 293a 0a20 2020 2020 2020 2020  Dict):.         
+0001b8f0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+0001b900: 726f 7228 2269 6e70 7574 5f64 6963 7420  ror("input_dict 
+0001b910: 6d75 7374 2062 6520 616e 2069 6e73 7461  must be an insta
+0001b920: 6e63 6520 6f66 204d 756c 7469 706c 6549  nce of MultipleI
+0001b930: 6e70 7574 4469 6374 2e22 290a 2020 2020  nputDict.").    
+0001b940: 2020 2020 2320 6966 2028 0a20 2020 2020      # if (.     
+0001b950: 2020 2023 2020 2020 206e 6f74 2073 656c     #     not sel
+0001b960: 662e 7573 655f 6d75 6c74 6970 6c65 5f6c  f.use_multiple_l
+0001b970: 6f67 6765 645f 6461 7461 7365 740a 2020  ogged_dataset.  
+0001b980: 2020 2020 2020 2320 2020 2020 6f72 206e        #     or n
+0001b990: 6f74 2069 6e70 7574 5f64 6963 742e 7573  ot input_dict.us
+0001b9a0: 655f 7361 6d65 5f65 7661 6c5f 706f 6c69  e_same_eval_poli
+0001b9b0: 6379 5f61 6372 6f73 735f 6461 7461 7365  cy_across_datase
+0001b9c0: 740a 2020 2020 2020 2020 2320 293a 0a20  t.        # ):. 
+0001b9d0: 2020 2020 2020 2023 2020 2020 2072 6169         #     rai
+0001b9e0: 7365 2052 756e 7469 6d65 4572 726f 7228  se RuntimeError(
+0001b9f0: 0a20 2020 2020 2020 2023 2020 2020 2020  .        #      
+0001ba00: 2020 2022 5468 6973 2066 756e 6374 696f     "This functio
+0001ba10: 6e20 6973 2061 7070 6c69 6361 626c 6520  n is applicable 
+0001ba20: 6f6e 6c79 2077 6865 6e20 4d75 6c74 6970  only when Multip
+0001ba30: 6c65 4c6f 6767 6564 4461 7461 7365 7420  leLoggedDataset 
+0001ba40: 6973 2075 7365 6420 220a 2020 2020 2020  is used ".      
+0001ba50: 2020 2320 2020 2020 2020 2020 2261 6e64    #         "and
+0001ba60: 204d 756c 7469 706c 6549 6e70 7574 4469   MultipleInputDi
+0001ba70: 6374 2069 7320 636f 6c6c 6563 7465 6420  ct is collected 
+0001ba80: 6279 2074 6865 2073 616d 6520 6576 616c  by the same eval
+0001ba90: 7561 7469 6f6e 2070 6f6c 6963 7920 6163  uation policy ac
+0001baa0: 726f 7373 206c 6f67 6765 6420 6461 7461  ross logged data
+0001bab0: 7365 7473 2c20 220a 2020 2020 2020 2020  sets, ".        
+0001bac0: 2320 2020 2020 2020 2020 2262 7574 2066  #         "but f
+0001bad0: 6f75 6e64 2046 616c 7365 2e22 0a20 2020  ound False.".   
+0001bae0: 2020 2020 2023 2020 2020 2029 0a20 2020       #     ).   
+0001baf0: 2020 2020 2023 2069 6620 6c65 6e28 7365       # if len(se
+0001bb00: 6c66 2e6d 756c 7469 706c 655f 6c6f 6767  lf.multiple_logg
+0001bb10: 6564 5f64 6174 6173 6574 2920 213d 206c  ed_dataset) != l
+0001bb20: 656e 2869 6e70 7574 5f64 6963 7429 3a0a  en(input_dict):.
+0001bb30: 2020 2020 2020 2020 2320 2020 2020 7261          #     ra
+0001bb40: 6973 6520 5661 6c75 6545 7272 6f72 280a  ise ValueError(.
+0001bb50: 2020 2020 2020 2020 2320 2020 2020 2020          #       
+0001bb60: 2020 2245 7870 6563 7465 6420 606c 656e    "Expected `len
+0001bb70: 2869 6e70 7574 5f64 6963 7429 203d 3d20  (input_dict) == 
+0001bb80: 6c65 6e28 7365 6c66 2e6d 756c 7469 706c  len(self.multipl
+0001bb90: 655f 6c6f 6767 6564 5f64 6174 6173 6574  e_logged_dataset
+0001bba0: 2960 2c20 6275 7420 666f 756e 6420 4661  )`, but found Fa
+0001bbb0: 6c73 652e 220a 2020 2020 2020 2020 2320  lse.".        # 
+0001bbc0: 2020 2020 290a 0a20 2020 2064 6566 205f      )..    def _
+0001bbd0: 7265 6769 7374 6572 5f6c 6f67 6765 645f  register_logged_
+0001bbe0: 6461 7461 7365 7428 0a20 2020 2020 2020  dataset(.       
+0001bbf0: 2073 656c 662c 0a20 2020 2020 2020 2062   self,.        b
+0001bc00: 6568 6176 696f 725f 706f 6c69 6379 5f6e  ehavior_policy_n
+0001bc10: 616d 653a 204f 7074 696f 6e61 6c5b 7374  ame: Optional[st
+0001bc20: 725d 203d 204e 6f6e 652c 0a20 2020 2020  r] = None,.     
+0001bc30: 2020 2064 6174 6173 6574 5f69 643a 204f     dataset_id: O
+0001bc40: 7074 696f 6e61 6c5b 696e 745d 203d 204e  ptional[int] = N
+0001bc50: 6f6e 652c 0a20 2020 2029 3a0a 2020 2020  one,.    ):.    
+0001bc60: 2020 2020 6966 2062 6568 6176 696f 725f      if behavior_
+0001bc70: 706f 6c69 6379 5f6e 616d 6520 6973 206e  policy_name is n
+0001bc80: 6f74 204e 6f6e 6520 616e 6420 6461 7461  ot None and data
+0001bc90: 7365 745f 6964 2069 7320 6e6f 7420 4e6f  set_id is not No
+0001bca0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+0001bcb0: 7365 6c66 2e6c 6f67 6765 645f 6461 7461  self.logged_data
+0001bcc0: 7365 7420 3d20 7365 6c66 2e6d 756c 7469  set = self.multi
+0001bcd0: 706c 655f 6c6f 6767 6564 5f64 6174 6173  ple_logged_datas
+0001bce0: 6574 2e67 6574 280a 2020 2020 2020 2020  et.get(.        
+0001bcf0: 2020 2020 2020 2020 6265 6861 7669 6f72          behavior
+0001bd00: 5f70 6f6c 6963 795f 6e61 6d65 3d62 6568  _policy_name=beh
+0001bd10: 6176 696f 725f 706f 6c69 6379 5f6e 616d  avior_policy_nam
+0001bd20: 652c 2064 6174 6173 6574 5f69 643d 6461  e, dataset_id=da
+0001bd30: 7461 7365 745f 6964 0a20 2020 2020 2020  taset_id.       
+0001bd40: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+0001bd50: 7365 6c66 2e62 6568 6176 696f 725f 706f  self.behavior_po
+0001bd60: 6c69 6379 5f72 6577 6172 6420 3d20 7365  licy_reward = se
+0001bd70: 6c66 2e6c 6f67 6765 645f 6461 7461 7365  lf.logged_datase
+0001bd80: 745b 2272 6577 6172 6422 5d2e 7265 7368  t["reward"].resh
+0001bd90: 6170 6528 0a20 2020 2020 2020 2020 2020  ape(.           
+0001bda0: 2028 2d31 2c20 7365 6c66 2e73 7465 705f   (-1, self.step_
+0001bdb0: 7065 725f 7472 616a 6563 746f 7279 290a  per_trajectory).
+0001bdc0: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+0001bdd0: 2020 2069 6620 7365 6c66 2e64 6973 6162     if self.disab
+0001bde0: 6c65 5f72 6577 6172 645f 6166 7465 725f  le_reward_after_
+0001bdf0: 646f 6e65 3a0a 2020 2020 2020 2020 2020  done:.          
+0001be00: 2020 646f 6e65 203d 2073 656c 662e 6c6f    done = self.lo
+0001be10: 6767 6564 5f64 6174 6173 6574 5b22 646f  gged_dataset["do
+0001be20: 6e65 225d 2e72 6573 6861 7065 2828 2d31  ne"].reshape((-1
+0001be30: 2c20 7365 6c66 2e73 7465 705f 7065 725f  , self.step_per_
+0001be40: 7472 616a 6563 746f 7279 2929 0a20 2020  trajectory)).   
+0001be50: 2020 2020 2020 2020 2073 656c 662e 6265           self.be
+0001be60: 6861 7669 6f72 5f70 6f6c 6963 795f 7265  havior_policy_re
+0001be70: 7761 7264 203d 2073 656c 662e 6265 6861  ward = self.beha
+0001be80: 7669 6f72 5f70 6f6c 6963 795f 7265 7761  vior_policy_rewa
+0001be90: 7264 202a 2028 0a20 2020 2020 2020 2020  rd * (.         
+0001bea0: 2020 2020 2020 2031 202d 2064 6f6e 650a         1 - done.
+0001beb0: 2020 2020 2020 2020 2020 2020 292e 6375              ).cu
+0001bec0: 6d70 726f 6428 6178 6973 3d31 290a 0a20  mprod(axis=1).. 
+0001bed0: 2020 2020 2020 2069 6620 7365 6c66 2e61         if self.a
+0001bee0: 6374 696f 6e5f 7479 7065 203d 3d20 2264  ction_type == "d
+0001bef0: 6973 6372 6574 6522 3a0a 2020 2020 2020  iscrete":.      
+0001bf00: 2020 2020 2020 7365 6c66 2e69 6e70 7574        self.input
+0001bf10: 5f64 6963 745f 203d 207b 0a20 2020 2020  _dict_ = {.     
+0001bf20: 2020 2020 2020 2020 2020 2022 7374 6570             "step
+0001bf30: 5f70 6572 5f74 7261 6a65 6374 6f72 7922  _per_trajectory"
+0001bf40: 3a20 7365 6c66 2e73 7465 705f 7065 725f  : self.step_per_
+0001bf50: 7472 616a 6563 746f 7279 2c0a 2020 2020  trajectory,.    
+0001bf60: 2020 2020 2020 2020 2020 2020 2261 6374              "act
+0001bf70: 696f 6e22 3a20 7365 6c66 2e6c 6f67 6765  ion": self.logge
+0001bf80: 645f 6461 7461 7365 745b 2261 6374 696f  d_dataset["actio
+0001bf90: 6e22 5d2e 6173 7479 7065 2869 6e74 292c  n"].astype(int),
+0001bfa0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001bfb0: 2022 7265 7761 7264 223a 2073 656c 662e   "reward": self.
+0001bfc0: 6265 6861 7669 6f72 5f70 6f6c 6963 795f  behavior_policy_
+0001bfd0: 7265 7761 7264 2e66 6c61 7474 656e 2829  reward.flatten()
+0001bfe0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001bff0: 2020 2264 6f6e 6522 3a20 7365 6c66 2e6c    "done": self.l
+0001c000: 6f67 6765 645f 6461 7461 7365 745b 2264  ogged_dataset["d
+0001c010: 6f6e 6522 5d2c 0a20 2020 2020 2020 2020  one"],.         
+0001c020: 2020 2020 2020 2022 7073 636f 7265 223a         "pscore":
+0001c030: 2073 656c 662e 6c6f 6767 6564 5f64 6174   self.logged_dat
+0001c040: 6173 6574 5b22 7073 636f 7265 225d 2c0a  aset["pscore"],.
+0001c050: 2020 2020 2020 2020 2020 2020 7d0a 2020              }.  
+0001c060: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0001c070: 2020 2020 2020 2020 7365 6c66 2e69 6e70          self.inp
+0001c080: 7574 5f64 6963 745f 203d 207b 0a20 2020  ut_dict_ = {.   
+0001c090: 2020 2020 2020 2020 2020 2020 2022 7374               "st
+0001c0a0: 6570 5f70 6572 5f74 7261 6a65 6374 6f72  ep_per_trajector
+0001c0b0: 7922 3a20 7365 6c66 2e73 7465 705f 7065  y": self.step_pe
+0001c0c0: 725f 7472 616a 6563 746f 7279 2c0a 2020  r_trajectory,.  
+0001c0d0: 2020 2020 2020 2020 2020 2020 2020 2261                "a
+0001c0e0: 6374 696f 6e22 3a20 7365 6c66 2e6c 6f67  ction": self.log
+0001c0f0: 6765 645f 6461 7461 7365 745b 2261 6374  ged_dataset["act
+0001c100: 696f 6e22 5d2e 6173 7479 7065 2869 6e74  ion"].astype(int
+0001c110: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+0001c120: 2020 2022 7265 7761 7264 223a 2073 656c     "reward": sel
+0001c130: 662e 6265 6861 7669 6f72 5f70 6f6c 6963  f.behavior_polic
+0001c140: 795f 7265 7761 7264 2e66 6c61 7474 656e  y_reward.flatten
+0001c150: 2829 2c0a 2020 2020 2020 2020 2020 2020  (),.            
+0001c160: 2020 2020 2264 6f6e 6522 3a20 7365 6c66      "done": self
+0001c170: 2e6c 6f67 6765 645f 6461 7461 7365 745b  .logged_dataset[
+0001c180: 2264 6f6e 6522 5d2c 0a20 2020 2020 2020  "done"],.       
+0001c190: 2020 2020 2020 2020 2022 7073 636f 7265           "pscore
+0001c1a0: 223a 2073 656c 662e 6c6f 6767 6564 5f64  ": self.logged_d
+0001c1b0: 6174 6173 6574 5b22 7073 636f 7265 225d  ataset["pscore"]
+0001c1c0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001c1d0: 2020 2261 6374 696f 6e5f 7363 616c 6572    "action_scaler
+0001c1e0: 223a 2073 656c 662e 6163 7469 6f6e 5f73  ": self.action_s
+0001c1f0: 6361 6c65 722c 0a20 2020 2020 2020 2020  caler,.         
+0001c200: 2020 2020 2020 2022 6261 6e64 7769 6474         "bandwidt
+0001c210: 6822 3a20 7365 6c66 2e62 616e 6477 6964  h": self.bandwid
+0001c220: 7468 2c0a 2020 2020 2020 2020 2020 2020  th,.            
+0001c230: 7d0a 0a20 2020 2064 6566 205f 7461 7267  }..    def _targ
+0001c240: 6574 5f76 616c 7565 5f67 6976 656e 5f69  et_value_given_i
+0001c250: 6478 2873 656c 662c 2069 6478 5f3a 2069  dx(self, idx_: i
+0001c260: 6e74 2c20 7265 7761 7264 5f73 6361 6c65  nt, reward_scale
+0001c270: 3a20 6e70 2e6e 6461 7272 6179 293a 0a20  : np.ndarray):. 
+0001c280: 2020 2020 2020 2022 2222 4f62 7461 696e         """Obtain
+0001c290: 2074 6865 2072 6577 6172 6420 7661 6c75   the reward valu
+0001c2a0: 6520 636f 7272 6573 706f 6e64 696e 6720  e corresponding 
+0001c2b0: 746f 2074 6865 2067 6976 656e 2069 6478  to the given idx
+0001c2c0: 2077 6865 6e20 6573 7469 6d61 7469 6e67   when estimating
+0001c2d0: 2074 6865 2043 4446 2e0a 0a20 2020 2020   the CDF...     
+0001c2e0: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
+0001c2f0: 2020 2020 2020 2d2d 2d2d 2d2d 2d0a 2020        -------.  
+0001c300: 2020 2020 2020 6964 785f 3a20 6c69 7374        idx_: list
+0001c310: 206f 6620 696e 7420 6f72 2069 6e74 0a20   of int or int. 
+0001c320: 2020 2020 2020 2020 2020 2049 6e64 6963             Indic
+0001c330: 6174 696e 6720 696e 6465 782e 2049 6620  ating index. If 
+0001c340: 6120 6c69 7374 2069 7320 6769 7665 6e2c  a list is given,
+0001c350: 2074 6865 2061 7665 7261 6765 206f 6620   the average of 
+0001c360: 7468 6520 7477 6f20 7769 6c6c 2062 6520  the two will be 
+0001c370: 7265 7475 726e 6564 2e0a 0a20 2020 2020  returned...     
+0001c380: 2020 2072 6577 6172 645f 7363 616c 653a     reward_scale:
+0001c390: 2061 7272 6179 2d6c 696b 6520 6f66 2073   array-like of s
+0001c3a0: 6861 7065 2028 6e5f 7061 7274 6974 696f  hape (n_partitio
+0001c3b0: 6e2c 2029 0a20 2020 2020 2020 2020 2020  n, ).           
+0001c3c0: 2053 6361 6c65 206f 6620 7468 6520 7472   Scale of the tr
+0001c3d0: 616a 6563 746f 7279 2d77 6973 6520 7265  ajectory-wise re
+0001c3e0: 7761 7264 2075 7365 6420 666f 7220 782d  ward used for x-
+0001c3f0: 6178 6973 206f 6620 7468 6520 4344 4620  axis of the CDF 
+0001c400: 706c 6f74 2e0a 0a20 2020 2020 2020 2052  plot...        R
+0001c410: 6574 7572 6e0a 2020 2020 2020 2020 2d2d  eturn.        --
+0001c420: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7461  -----.        ta
+0001c430: 7267 6574 5f76 616c 7565 3a20 666c 6f61  rget_value: floa
+0001c440: 740a 2020 2020 2020 2020 2020 2020 5661  t.            Va
+0001c450: 6c75 6520 6f66 2074 6865 2067 6976 656e  lue of the given
+0001c460: 2069 6e64 6578 2e0a 0a20 2020 2020 2020   index...       
+0001c470: 2022 2222 0a20 2020 2020 2020 2069 6620   """.        if 
+0001c480: 6c65 6e28 6964 785f 2920 3d3d 2030 206f  len(idx_) == 0 o
+0001c490: 7220 6964 785f 5b30 5d20 3d3d 206c 656e  r idx_[0] == len
+0001c4a0: 2872 6577 6172 645f 7363 616c 6529 202d  (reward_scale) -
+0001c4b0: 2031 3a0a 2020 2020 2020 2020 2020 2020   1:.            
+0001c4c0: 7461 7267 6574 5f76 616c 7565 203d 2072  target_value = r
+0001c4d0: 6577 6172 645f 7363 616c 655b 2d31 5d0a  eward_scale[-1].
+0001c4e0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+0001c4f0: 2020 2020 2020 2020 2020 7461 7267 6574            target
+0001c500: 5f69 6478 203d 2069 6478 5f5b 305d 0a20  _idx = idx_[0]. 
+0001c510: 2020 2020 2020 2020 2020 2074 6172 6765             targe
+0001c520: 745f 7661 6c75 6520 3d20 2872 6577 6172  t_value = (rewar
+0001c530: 645f 7363 616c 655b 7461 7267 6574 5f69  d_scale[target_i
+0001c540: 6478 5d20 2b20 7265 7761 7264 5f73 6361  dx] + reward_sca
+0001c550: 6c65 5b74 6172 6765 745f 6964 7820 2b20  le[target_idx + 
+0001c560: 315d 2920 2f20 320a 2020 2020 2020 2020  1]) / 2.        
+0001c570: 7265 7475 726e 2074 6172 6765 745f 7661  return target_va
+0001c580: 6c75 650a 0a20 2020 2064 6566 206f 6274  lue..    def obt
+0001c590: 6169 6e5f 7265 7761 7264 5f73 6361 6c65  ain_reward_scale
+0001c5a0: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+0001c5b0: 2020 2020 293a 0a20 2020 2020 2020 2022      ):.        "
+0001c5c0: 2222 4f62 7461 696e 2074 6865 2072 6577  ""Obtain the rew
+0001c5d0: 6172 6420 7363 616c 6520 2878 2d61 7869  ard scale (x-axi
+0001c5e0: 7329 2066 6f72 2074 6865 2063 756d 756c  s) for the cumul
+0001c5f0: 6174 6976 6520 6469 7374 7269 6275 7469  ative distributi
+0001c600: 6f6e 2066 756e 6374 696f 6e2e 0a0a 2020  on function...  
+0001c610: 2020 2020 2020 5265 7475 726e 0a20 2020        Return.   
+0001c620: 2020 2020 202d 2d2d 2d2d 2d2d 0a20 2020       -------.   
+0001c630: 2020 2020 2072 6577 6172 645f 7363 616c       reward_scal
+0001c640: 653a 206e 6461 7272 6179 206f 6620 7368  e: ndarray of sh
+0001c650: 6170 6520 286e 5f75 6e69 7175 655f 7265  ape (n_unique_re
+0001c660: 7761 7264 2c20 2920 6f72 2028 6e5f 7061  ward, ) or (n_pa
+0001c670: 7274 6974 696f 6e2c 2029 0a20 2020 2020  rtition, ).     
+0001c680: 2020 2020 2020 2052 6577 6172 6420 5363         Reward Sc
+0001c690: 616c 6520 2878 2d61 7869 7320 6f66 2074  ale (x-axis of t
+0001c6a0: 6865 2063 756d 756c 6174 6976 6520 6469  he cumulative di
+0001c6b0: 7374 7269 6275 7469 6f6e 2066 756e 6374  stribution funct
+0001c6c0: 696f 6e29 2e0a 0a20 2020 2020 2020 2022  ion)...        "
+0001c6d0: 2222 0a20 2020 2020 2020 2069 6620 7365  "".        if se
+0001c6e0: 6c66 2e75 7365 5f63 7573 746f 6d5f 7265  lf.use_custom_re
+0001c6f0: 7761 7264 5f73 6361 6c65 3a0a 2020 2020  ward_scale:.    
+0001c700: 2020 2020 2020 2020 7265 7761 7264 5f73          reward_s
+0001c710: 6361 6c65 203d 206e 702e 6c69 6e73 7061  cale = np.linspa
+0001c720: 6365 280a 2020 2020 2020 2020 2020 2020  ce(.            
+0001c730: 2020 2020 7365 6c66 2e73 6361 6c65 5f6d      self.scale_m
+0001c740: 696e 2c20 7365 6c66 2e73 6361 6c65 5f6d  in, self.scale_m
+0001c750: 6178 2c20 6e75 6d3d 7365 6c66 2e6e 5f70  ax, num=self.n_p
+0001c760: 6172 7469 7469 6f6e 0a20 2020 2020 2020  artition.       
+0001c770: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+0001c780: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0001c790: 2020 7265 7761 7264 203d 2073 656c 662e    reward = self.
+0001c7a0: 6265 6861 7669 6f72 5f70 6f6c 6963 795f  behavior_policy_
+0001c7b0: 7265 7761 7264 2e73 756d 2861 7869 733d  reward.sum(axis=
+0001c7c0: 3129 0a20 2020 2020 2020 2020 2020 2072  1).            r
+0001c7d0: 6577 6172 645f 7363 616c 6520 3d20 6e70  eward_scale = np
+0001c7e0: 2e73 6f72 7428 6e70 2e75 6e69 7175 6528  .sort(np.unique(
+0001c7f0: 7265 7761 7264 2929 0a0a 2020 2020 2020  reward))..      
+0001c800: 2020 7265 7475 726e 2072 6577 6172 645f    return reward_
+0001c810: 7363 616c 650a 0a20 2020 2064 6566 205f  scale..    def _
+0001c820: 6573 7469 6d61 7465 5f63 756d 756c 6174  estimate_cumulat
+0001c830: 6976 655f 6469 7374 7269 6275 7469 6f6e  ive_distribution
+0001c840: 5f66 756e 6374 696f 6e28 0a20 2020 2020  _function(.     
+0001c850: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+0001c860: 2069 6e70 7574 5f64 6963 743a 204f 5045   input_dict: OPE
+0001c870: 496e 7075 7444 6963 742c 0a20 2020 2020  InputDict,.     
+0001c880: 2020 2063 6f6d 7061 7265 645f 6573 7469     compared_esti
+0001c890: 6d61 746f 7273 3a20 4f70 7469 6f6e 616c  mators: Optional
+0001c8a0: 5b4c 6973 745b 7374 725d 5d20 3d20 4e6f  [List[str]] = No
+0001c8b0: 6e65 2c0a 2020 2020 2020 2020 7265 7761  ne,.        rewa
+0001c8c0: 7264 5f73 6361 6c65 3a20 4f70 7469 6f6e  rd_scale: Option
+0001c8d0: 616c 5b6e 702e 6e64 6172 7261 795d 203d  al[np.ndarray] =
+0001c8e0: 204e 6f6e 652c 0a20 2020 2029 3a0a 2020   None,.    ):.  
+0001c8f0: 2020 2020 2020 2222 2245 7374 696d 6174        """Estimat
+0001c900: 6520 7468 6520 6375 6d75 6c61 7469 7665  e the cumulative
+0001c910: 2064 6973 7472 6962 7574 696f 6e20 6f66   distribution of
+0001c920: 2074 6865 2074 7261 6a65 6374 6f72 792d   the trajectory-
+0001c930: 7769 7365 2072 6577 6172 6420 756e 6465  wise reward unde
+0001c940: 7220 7468 6520 6769 7665 6e20 6576 616c  r the given eval
+0001c950: 7561 7469 6f6e 2070 6f6c 6963 6965 732e  uation policies.
+0001c960: 0a0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
+0001c970: 7465 7273 0a20 2020 2020 2020 202d 2d2d  ters.        ---
+0001c980: 2d2d 2d2d 0a20 2020 2020 2020 2069 6e70  ----.        inp
+0001c990: 7574 5f64 6963 743a 204f 5045 496e 7075  ut_dict: OPEInpu
+0001c9a0: 7444 6963 740a 2020 2020 2020 2020 2020  tDict.          
+0001c9b0: 2020 4469 6374 696f 6e61 7279 206f 6620    Dictionary of 
+0001c9c0: 7468 6520 4f50 4520 696e 7075 7473 2066  the OPE inputs f
+0001c9d0: 6f72 2065 6163 6820 6576 616c 7561 7469  or each evaluati
+0001c9e0: 6f6e 2070 6f6c 6963 792e 0a0a 2020 2020  on policy...    
+0001c9f0: 2020 2020 2020 2020 2e2e 2063 6f64 652d          .. code-
+0001ca00: 626c 6f63 6b3a 3a20 7079 7468 6f6e 0a0a  block:: python..
+0001ca10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ca20: 6b65 793a 205b 6576 616c 7561 7469 6f6e  key: [evaluation
+0001ca30: 5f70 6f6c 6963 795d 5b0a 2020 2020 2020  _policy][.      
+0001ca40: 2020 2020 2020 2020 2020 2020 2020 6576                ev
+0001ca50: 616c 7561 7469 6f6e 5f70 6f6c 6963 795f  aluation_policy_
+0001ca60: 6163 7469 6f6e 2c0a 2020 2020 2020 2020  action,.        
+0001ca70: 2020 2020 2020 2020 2020 2020 6576 616c              eval
+0001ca80: 7561 7469 6f6e 5f70 6f6c 6963 795f 6163  uation_policy_ac
+0001ca90: 7469 6f6e 5f64 6973 742c 0a20 2020 2020  tion_dist,.     
+0001caa0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0001cab0: 7461 7465 5f61 6374 696f 6e5f 7661 6c75  tate_action_valu
+0001cac0: 655f 7072 6564 6963 7469 6f6e 2c0a 2020  e_prediction,.  
+0001cad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cae0: 2020 696e 6974 6961 6c5f 7374 6174 655f    initial_state_
+0001caf0: 7661 6c75 655f 7072 6564 6963 7469 6f6e  value_prediction
+0001cb00: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001cb10: 2020 2020 2020 7374 6174 655f 6163 7469        state_acti
+0001cb20: 6f6e 5f6d 6172 6769 6e61 6c5f 696d 706f  on_marginal_impo
+0001cb30: 7274 616e 6365 5f77 6569 6768 742c 0a20  rtance_weight,. 
 0001cb40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cb50: 6576 616c 7561 7469 6f6e 5f70 6f6c 6963  evaluation_polic
-0001cb60: 795f 6163 7469 6f6e 5f64 6973 742c 0a20  y_action_dist,. 
-0001cb70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cb80: 2020 2073 7461 7465 5f61 6374 696f 6e5f     state_action_
-0001cb90: 7661 6c75 655f 7072 6564 6963 7469 6f6e  value_prediction
-0001cba0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001cbb0: 2020 2020 2020 696e 6974 6961 6c5f 7374        initial_st
-0001cbc0: 6174 655f 7661 6c75 655f 7072 6564 6963  ate_value_predic
-0001cbd0: 7469 6f6e 2c0a 2020 2020 2020 2020 2020  tion,.          
-0001cbe0: 2020 2020 2020 2020 2020 7374 6174 655f            state_
-0001cbf0: 6163 7469 6f6e 5f6d 6172 6769 6e61 6c5f  action_marginal_
-0001cc00: 696d 706f 7274 616e 6365 5f77 6569 6768  importance_weigh
-0001cc10: 742c 0a20 2020 2020 2020 2020 2020 2020  t,.             
-0001cc20: 2020 2020 2020 2073 7461 7465 5f6d 6172         state_mar
-0001cc30: 6769 6e61 6c5f 696d 706f 7274 616e 6365  ginal_importance
-0001cc40: 5f77 6569 6768 742c 0a20 2020 2020 2020  _weight,.       
-0001cc50: 2020 2020 2020 2020 2020 2020 206f 6e5f               on_
-0001cc60: 706f 6c69 6379 5f70 6f6c 6963 795f 7661  policy_policy_va
-0001cc70: 6c75 652c 0a20 2020 2020 2020 2020 2020  lue,.           
-0001cc80: 2020 2020 2020 2020 2067 616d 6d61 2c0a           gamma,.
-0001cc90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cca0: 2020 2020 6265 6861 7669 6f72 5f70 6f6c      behavior_pol
-0001ccb0: 6963 792c 0a20 2020 2020 2020 2020 2020  icy,.           
-0001ccc0: 2020 2020 2020 2020 2065 7661 6c75 6174           evaluat
-0001ccd0: 696f 6e5f 706f 6c69 6379 2c0a 2020 2020  ion_policy,.    
-0001cce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ccf0: 6461 7461 7365 745f 6964 2c0a 2020 2020  dataset_id,.    
-0001cd00: 2020 2020 2020 2020 2020 2020 5d0a 0a20              ].. 
-0001cd10: 2020 2020 2020 2020 2020 202e 2e20 7365             .. se
-0001cd20: 6561 6c73 6f3a 3a0a 0a20 2020 2020 2020  ealso::..       
-0001cd30: 2020 2020 2020 2020 203a 636c 6173 733a           :class:
-0001cd40: 6073 636f 7065 5f72 6c2e 6f70 652e 696e  `scope_rl.ope.in
-0001cd50: 7075 742e 4372 6561 7465 4f50 4549 6e70  put.CreateOPEInp
-0001cd60: 7574 6020 6465 7363 7269 6265 7320 7468  ut` describes th
-0001cd70: 6520 636f 6d70 6f6e 656e 7473 206f 6620  e components of 
-0001cd80: 3a63 6c61 7373 3a60 696e 7075 745f 6469  :class:`input_di
-0001cd90: 6374 602e 0a0a 2020 2020 2020 2020 636f  ct`...        co
-0001cda0: 6d70 6172 6564 5f65 7374 696d 6174 6f72  mpared_estimator
-0001cdb0: 733a 206c 6973 7420 6f66 2073 7472 2c20  s: list of str, 
-0001cdc0: 6465 6661 756c 743d 4e6f 6e65 0a20 2020  default=None.   
-0001cdd0: 2020 2020 2020 2020 204e 616d 6520 6f66           Name of
-0001cde0: 2063 6f6d 7061 7265 6420 6573 7469 6d61   compared estima
-0001cdf0: 746f 7273 2e0a 2020 2020 2020 2020 2020  tors..          
-0001ce00: 2020 4966 2060 4e6f 6e65 6020 6973 2067    If `None` is g
-0001ce10: 6976 656e 2c20 616c 6c20 7468 6520 6573  iven, all the es
-0001ce20: 7469 6d61 746f 7273 2061 7265 2063 6f6d  timators are com
-0001ce30: 7061 7265 642e 0a0a 2020 2020 2020 2020  pared...        
-0001ce40: 7265 7761 7264 5f73 6361 6c65 3a20 6172  reward_scale: ar
-0001ce50: 7261 792d 6c69 6b65 206f 6620 7368 6170  ray-like of shap
-0001ce60: 6520 286e 5f70 6172 7469 7469 6f6e 2c20  e (n_partition, 
-0001ce70: 292c 2064 6566 6175 6c74 3d4e 6f6e 650a  ), default=None.
-0001ce80: 2020 2020 2020 2020 2020 2020 5363 616c              Scal
-0001ce90: 6520 6f66 2074 6865 2074 7261 6a65 6374  e of the traject
-0001cea0: 6f72 792d 7769 7365 2072 6577 6172 6420  ory-wise reward 
-0001ceb0: 7573 6564 2066 6f72 2078 2d61 7869 7320  used for x-axis 
-0001cec0: 6f66 2074 6865 2043 4446 2070 6c6f 742e  of the CDF plot.
-0001ced0: 0a0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
-0001cee0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0001cef0: 0a20 2020 2020 2020 2063 756d 756c 6174  .        cumulat
-0001cf00: 6976 655f 6469 7374 7269 6275 7469 6f6e  ive_distribution
-0001cf10: 5f64 6963 743a 2064 6963 740a 2020 2020  _dict: dict.    
-0001cf20: 2020 2020 2020 2020 4469 6374 696f 6e61          Dictiona
-0001cf30: 7279 2063 6f6e 7461 696e 696e 6720 7468  ry containing th
-0001cf40: 6520 6375 6d75 6c61 7469 7665 2064 6973  e cumulative dis
-0001cf50: 7472 6962 7574 696f 6e20 6f66 2065 6163  tribution of eac
-0001cf60: 6820 6576 616c 7561 7469 6f6e 2070 6f6c  h evaluation pol
-0001cf70: 6963 7920 6573 7469 6d61 7465 6420 6279  icy estimated by
-0001cf80: 204f 5045 2065 7374 696d 6174 6f72 732e   OPE estimators.
-0001cf90: 0a20 2020 2020 2020 2020 2020 206b 6579  .            key
-0001cfa0: 3a20 3a63 6c61 7373 3a60 5b65 7661 6c75  : :class:`[evalu
-0001cfb0: 6174 696f 6e5f 706f 6c69 6379 5d5b 4f50  ation_policy][OP
-0001cfc0: 455f 6573 7469 6d61 746f 725f 6e61 6d65  E_estimator_name
-0001cfd0: 5d60 0a0a 2020 2020 2020 2020 2222 220a  ]`..        """.
-0001cfe0: 2020 2020 2020 2020 6368 6563 6b5f 696e          check_in
-0001cff0: 7075 745f 6469 6374 2869 6e70 7574 5f64  put_dict(input_d
-0001d000: 6963 7429 0a0a 2020 2020 2020 2020 6375  ict)..        cu
-0001d010: 6d75 6c61 7469 7665 5f64 6973 7472 6962  mulative_distrib
-0001d020: 7574 696f 6e5f 6469 6374 203d 2064 6566  ution_dict = def
-0001d030: 6175 6c74 6469 6374 2864 6963 7429 0a20  aultdict(dict). 
-0001d040: 2020 2020 2020 2072 6577 6172 645f 7363         reward_sc
-0001d050: 616c 6520 3d20 280a 2020 2020 2020 2020  ale = (.        
-0001d060: 2020 2020 7365 6c66 2e6f 6274 6169 6e5f      self.obtain_
-0001d070: 7265 7761 7264 5f73 6361 6c65 2829 2069  reward_scale() i
-0001d080: 6620 7265 7761 7264 5f73 6361 6c65 2069  f reward_scale i
-0001d090: 7320 4e6f 6e65 2065 6c73 6520 7265 7761  s None else rewa
-0001d0a0: 7264 5f73 6361 6c65 0a20 2020 2020 2020  rd_scale.       
-0001d0b0: 2029 0a0a 2020 2020 2020 2020 666f 7220   )..        for 
-0001d0c0: 6576 616c 5f70 6f6c 6963 7920 696e 2069  eval_policy in i
-0001d0d0: 6e70 7574 5f64 6963 742e 6b65 7973 2829  nput_dict.keys()
-0001d0e0: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
-0001d0f0: 2069 6e70 7574 5f64 6963 745b 6576 616c   input_dict[eval
-0001d100: 5f70 6f6c 6963 795d 5b22 6f6e 5f70 6f6c  _policy]["on_pol
-0001d110: 6963 795f 706f 6c69 6379 5f76 616c 7565  icy_policy_value
-0001d120: 225d 2069 7320 6e6f 7420 4e6f 6e65 3a0a  "] is not None:.
-0001d130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d140: 6465 6e73 6974 7920 3d20 6e70 2e68 6973  density = np.his
-0001d150: 746f 6772 616d 280a 2020 2020 2020 2020  togram(.        
-0001d160: 2020 2020 2020 2020 2020 2020 696e 7075              inpu
-0001d170: 745f 6469 6374 5b65 7661 6c5f 706f 6c69  t_dict[eval_poli
-0001d180: 6379 5d5b 226f 6e5f 706f 6c69 6379 5f70  cy]["on_policy_p
-0001d190: 6f6c 6963 795f 7661 6c75 6522 5d2c 0a20  olicy_value"],. 
-0001d1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d1b0: 2020 2062 696e 733d 7265 7761 7264 5f73     bins=reward_s
-0001d1c0: 6361 6c65 2c0a 2020 2020 2020 2020 2020  cale,.          
-0001d1d0: 2020 2020 2020 2020 2020 6465 6e73 6974            densit
-0001d1e0: 793d 5472 7565 2c0a 2020 2020 2020 2020  y=True,.        
-0001d1f0: 2020 2020 2020 2020 295b 305d 0a20 2020          )[0].   
-0001d200: 2020 2020 2020 2020 2020 2020 2070 726f               pro
-0001d210: 6261 6269 6c69 7479 5f64 656e 7369 7479  bability_density
-0001d220: 5f66 756e 6374 696f 6e20 3d20 6465 6e73  _function = dens
-0001d230: 6974 7920 2a20 6e70 2e64 6966 6628 7265  ity * np.diff(re
-0001d240: 7761 7264 5f73 6361 6c65 290a 2020 2020  ward_scale).    
-0001d250: 2020 2020 2020 2020 2020 2020 6375 6d75              cumu
-0001d260: 6c61 7469 7665 5f64 6973 7472 6962 7574  lative_distribut
-0001d270: 696f 6e5f 6469 6374 5b65 7661 6c5f 706f  ion_dict[eval_po
-0001d280: 6c69 6379 5d5b 226f 6e5f 706f 6c69 6379  licy]["on_policy
-0001d290: 225d 203d 206e 702e 696e 7365 7274 280a  "] = np.insert(.
-0001d2a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d2b0: 2020 2020 7072 6f62 6162 696c 6974 795f      probability_
-0001d2c0: 6465 6e73 6974 795f 6675 6e63 7469 6f6e  density_function
-0001d2d0: 2c20 302c 2030 0a20 2020 2020 2020 2020  , 0, 0.         
-0001d2e0: 2020 2020 2020 2029 2e63 756d 7375 6d28         ).cumsum(
-0001d2f0: 290a 2020 2020 2020 2020 2020 2020 656c  ).            el
-0001d300: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-0001d310: 2020 2020 6375 6d75 6c61 7469 7665 5f64      cumulative_d
-0001d320: 6973 7472 6962 7574 696f 6e5f 6469 6374  istribution_dict
-0001d330: 5b65 7661 6c5f 706f 6c69 6379 5d5b 226f  [eval_policy]["o
-0001d340: 6e5f 706f 6c69 6379 225d 203d 204e 6f6e  n_policy"] = Non
-0001d350: 650a 0a20 2020 2020 2020 2020 2020 2066  e..            f
-0001d360: 6f72 2065 7374 696d 6174 6f72 5f6e 616d  or estimator_nam
-0001d370: 6520 696e 2063 6f6d 7061 7265 645f 6573  e in compared_es
-0001d380: 7469 6d61 746f 7273 3a0a 2020 2020 2020  timators:.      
-0001d390: 2020 2020 2020 2020 2020 6573 7469 6d61            estima
-0001d3a0: 746f 7220 3d20 7365 6c66 2e6f 7065 5f65  tor = self.ope_e
-0001d3b0: 7374 696d 6174 6f72 735f 5b65 7374 696d  stimators_[estim
-0001d3c0: 6174 6f72 5f6e 616d 655d 0a20 2020 2020  ator_name].     
-0001d3d0: 2020 2020 2020 2020 2020 2063 756d 756c             cumul
-0001d3e0: 6174 6976 655f 6469 7374 7269 6275 7469  ative_distributi
-0001d3f0: 6f6e 5f64 6963 745b 6576 616c 5f70 6f6c  on_dict[eval_pol
-0001d400: 6963 795d 5b0a 2020 2020 2020 2020 2020  icy][.          
-0001d410: 2020 2020 2020 2020 2020 6573 7469 6d61            estima
-0001d420: 746f 725f 6e61 6d65 0a20 2020 2020 2020  tor_name.       
-0001d430: 2020 2020 2020 2020 205d 203d 2065 7374           ] = est
-0001d440: 696d 6174 6f72 2e65 7374 696d 6174 655f  imator.estimate_
-0001d450: 6375 6d75 6c61 7469 7665 5f64 6973 7472  cumulative_distr
-0001d460: 6962 7574 696f 6e5f 6675 6e63 7469 6f6e  ibution_function
-0001d470: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0001d480: 2020 2020 2020 2a2a 696e 7075 745f 6469        **input_di
-0001d490: 6374 5b65 7661 6c5f 706f 6c69 6379 5d2c  ct[eval_policy],
-0001d4a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001d4b0: 2020 2020 202a 2a73 656c 662e 696e 7075       **self.inpu
-0001d4c0: 745f 6469 6374 5f2c 0a20 2020 2020 2020  t_dict_,.       
-0001d4d0: 2020 2020 2020 2020 2020 2020 2072 6577               rew
-0001d4e0: 6172 645f 7363 616c 653d 7265 7761 7264  ard_scale=reward
-0001d4f0: 5f73 6361 6c65 2c0a 2020 2020 2020 2020  _scale,.        
-0001d500: 2020 2020 2020 2020 2020 2020 6469 7361              disa
-0001d510: 626c 655f 7265 7761 7264 5f61 6674 6572  ble_reward_after
-0001d520: 5f64 6f6e 653d 7365 6c66 2e64 6973 6162  _done=self.disab
-0001d530: 6c65 5f72 6577 6172 645f 6166 7465 725f  le_reward_after_
-0001d540: 646f 6e65 2c0a 2020 2020 2020 2020 2020  done,.          
-0001d550: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-0001d560: 2072 6574 7572 6e20 6465 6661 756c 7464   return defaultd
-0001d570: 6963 745f 746f 5f64 6963 7428 6375 6d75  ict_to_dict(cumu
-0001d580: 6c61 7469 7665 5f64 6973 7472 6962 7574  lative_distribut
-0001d590: 696f 6e5f 6469 6374 290a 0a20 2020 2064  ion_dict)..    d
-0001d5a0: 6566 205f 6573 7469 6d61 7465 5f6d 6561  ef _estimate_mea
-0001d5b0: 6e28 0a20 2020 2020 2020 2073 656c 662c  n(.        self,
-0001d5c0: 0a20 2020 2020 2020 2069 6e70 7574 5f64  .        input_d
-0001d5d0: 6963 743a 204f 5045 496e 7075 7444 6963  ict: OPEInputDic
-0001d5e0: 742c 0a20 2020 2020 2020 2063 6f6d 7061  t,.        compa
-0001d5f0: 7265 645f 6573 7469 6d61 746f 7273 3a20  red_estimators: 
-0001d600: 4f70 7469 6f6e 616c 5b4c 6973 745b 7374  Optional[List[st
-0001d610: 725d 5d20 3d20 4e6f 6e65 2c0a 2020 2020  r]] = None,.    
-0001d620: 293a 0a20 2020 2020 2020 2022 2222 4573  ):.        """Es
-0001d630: 7469 6d61 7465 2074 6865 2065 7870 6563  timate the expec
-0001d640: 7465 6420 7472 616a 6563 746f 7279 2d77  ted trajectory-w
-0001d650: 6973 6520 7265 7761 7264 2028 692e 652e  ise reward (i.e.
-0001d660: 2c20 706f 6c69 6379 2076 616c 7565 2920  , policy value) 
-0001d670: 6f66 2074 6865 2065 7661 6c75 6174 696f  of the evaluatio
-0001d680: 6e20 706f 6c69 6369 6573 2e0a 0a20 2020  n policies...   
-0001d690: 2020 2020 2050 6172 616d 6574 6572 730a       Parameters.
-0001d6a0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0a          -------.
-0001d6b0: 2020 2020 2020 2020 696e 7075 745f 6469          input_di
-0001d6c0: 6374 3a20 4f50 4549 6e70 7574 4469 6374  ct: OPEInputDict
-0001d6d0: 0a20 2020 2020 2020 2020 2020 2044 6963  .            Dic
-0001d6e0: 7469 6f6e 6172 7920 6f66 2074 6865 204f  tionary of the O
-0001d6f0: 5045 2069 6e70 7574 7320 666f 7220 6561  PE inputs for ea
-0001d700: 6368 2065 7661 6c75 6174 696f 6e20 706f  ch evaluation po
-0001d710: 6c69 6379 2e0a 0a20 2020 2020 2020 2020  licy...         
-0001d720: 2020 202e 2e20 636f 6465 2d62 6c6f 636b     .. code-block
-0001d730: 3a3a 2070 7974 686f 6e0a 0a20 2020 2020  :: python..     
-0001d740: 2020 2020 2020 2020 2020 206b 6579 3a20             key: 
-0001d750: 5b65 7661 6c75 6174 696f 6e5f 706f 6c69  [evaluation_poli
-0001d760: 6379 5d5b 0a20 2020 2020 2020 2020 2020  cy][.           
-0001d770: 2020 2020 2020 2020 2065 7661 6c75 6174           evaluat
-0001d780: 696f 6e5f 706f 6c69 6379 5f61 6374 696f  ion_policy_actio
-0001d790: 6e2c 0a20 2020 2020 2020 2020 2020 2020  n,.             
-0001d7a0: 2020 2020 2020 2065 7661 6c75 6174 696f         evaluatio
-0001d7b0: 6e5f 706f 6c69 6379 5f61 6374 696f 6e5f  n_policy_action_
-0001d7c0: 6469 7374 2c0a 2020 2020 2020 2020 2020  dist,.          
-0001d7d0: 2020 2020 2020 2020 2020 7374 6174 655f            state_
-0001d7e0: 6163 7469 6f6e 5f76 616c 7565 5f70 7265  action_value_pre
-0001d7f0: 6469 6374 696f 6e2c 0a20 2020 2020 2020  diction,.       
-0001d800: 2020 2020 2020 2020 2020 2020 2069 6e69               ini
-0001d810: 7469 616c 5f73 7461 7465 5f76 616c 7565  tial_state_value
-0001d820: 5f70 7265 6469 6374 696f 6e2c 0a20 2020  _prediction,.   
-0001d830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d840: 2073 7461 7465 5f61 6374 696f 6e5f 6d61   state_action_ma
-0001d850: 7267 696e 616c 5f69 6d70 6f72 7461 6e63  rginal_importanc
-0001d860: 655f 7765 6967 6874 2c0a 2020 2020 2020  e_weight,.      
-0001d870: 2020 2020 2020 2020 2020 2020 2020 7374                st
-0001d880: 6174 655f 6d61 7267 696e 616c 5f69 6d70  ate_marginal_imp
-0001d890: 6f72 7461 6e63 655f 7765 6967 6874 2c0a  ortance_weight,.
-0001d8a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d8b0: 2020 2020 6f6e 5f70 6f6c 6963 795f 706f      on_policy_po
-0001d8c0: 6c69 6379 5f76 616c 7565 2c0a 2020 2020  licy_value,.    
-0001d8d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d8e0: 6761 6d6d 612c 0a20 2020 2020 2020 2020  gamma,.         
-0001d8f0: 2020 2020 2020 2020 2020 2062 6568 6176             behav
-0001d900: 696f 725f 706f 6c69 6379 2c0a 2020 2020  ior_policy,.    
-0001d910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d920: 6576 616c 7561 7469 6f6e 5f70 6f6c 6963  evaluation_polic
-0001d930: 792c 0a20 2020 2020 2020 2020 2020 2020  y,.             
-0001d940: 2020 2020 2020 2064 6174 6173 6574 5f69         dataset_i
-0001d950: 642c 0a20 2020 2020 2020 2020 2020 2020  d,.             
-0001d960: 2020 205d 0a0a 2020 2020 2020 2020 2020     ]..          
-0001d970: 2020 2e2e 2073 6565 616c 736f 3a3a 0a0a    .. seealso::..
-0001d980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d990: 3a63 6c61 7373 3a60 7363 6f70 655f 726c  :class:`scope_rl
-0001d9a0: 2e6f 7065 2e69 6e70 7574 2e43 7265 6174  .ope.input.Creat
-0001d9b0: 654f 5045 496e 7075 7460 2064 6573 6372  eOPEInput` descr
-0001d9c0: 6962 6573 2074 6865 2063 6f6d 706f 6e65  ibes the compone
-0001d9d0: 6e74 7320 6f66 203a 636c 6173 733a 6069  nts of :class:`i
-0001d9e0: 6e70 7574 5f64 6963 7460 2e0a 0a20 2020  nput_dict`...   
-0001d9f0: 2020 2020 2063 6f6d 7061 7265 645f 6573       compared_es
-0001da00: 7469 6d61 746f 7273 3a20 6c69 7374 206f  timators: list o
-0001da10: 6620 7374 722c 2064 6566 6175 6c74 3d4e  f str, default=N
-0001da20: 6f6e 650a 2020 2020 2020 2020 2020 2020  one.            
-0001da30: 4e61 6d65 206f 6620 636f 6d70 6172 6564  Name of compared
-0001da40: 2065 7374 696d 6174 6f72 732e 0a20 2020   estimators..   
-0001da50: 2020 2020 2020 2020 2049 6620 604e 6f6e           If `Non
-0001da60: 6560 2069 7320 6769 7665 6e2c 2061 6c6c  e` is given, all
-0001da70: 2074 6865 2065 7374 696d 6174 6f72 7320   the estimators 
-0001da80: 6172 6520 636f 6d70 6172 6564 2e0a 0a20  are compared... 
-0001da90: 2020 2020 2020 2052 6574 7572 6e0a 2020         Return.  
-0001daa0: 2020 2020 2020 2d2d 2d2d 2d2d 2d0a 2020        -------.  
-0001dab0: 2020 2020 2020 6d65 616e 5f64 6963 743a        mean_dict:
-0001dac0: 2064 6963 740a 2020 2020 2020 2020 2020   dict.          
-0001dad0: 2020 4469 6374 696f 6e61 7279 2063 6f6e    Dictionary con
-0001dae0: 7461 696e 696e 6720 7468 6520 6d65 616e  taining the mean
-0001daf0: 2074 7261 6a65 6374 6f72 792d 7769 7365   trajectory-wise
-0001db00: 2072 6577 6172 6420 6f66 2065 6163 6820   reward of each 
-0001db10: 6576 616c 7561 7469 6f6e 2070 6f6c 6963  evaluation polic
-0001db20: 7920 6573 7469 6d61 7465 6420 6279 204f  y estimated by O
-0001db30: 5045 2065 7374 696d 6174 6f72 732e 0a20  PE estimators.. 
-0001db40: 2020 2020 2020 2020 2020 206b 6579 3a20             key: 
-0001db50: 3a63 6c61 7373 3a60 5b65 7661 6c75 6174  :class:`[evaluat
-0001db60: 696f 6e5f 706f 6c69 6379 5d5b 4f50 455f  ion_policy][OPE_
-0001db70: 6573 7469 6d61 746f 725f 6e61 6d65 5d60  estimator_name]`
-0001db80: 0a0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-0001db90: 2020 2020 2020 6368 6563 6b5f 696e 7075        check_inpu
-0001dba0: 745f 6469 6374 2869 6e70 7574 5f64 6963  t_dict(input_dic
-0001dbb0: 7429 0a0a 2020 2020 2020 2020 6d65 616e  t)..        mean
-0001dbc0: 5f64 6963 7420 3d20 6465 6661 756c 7464  _dict = defaultd
-0001dbd0: 6963 7428 6469 6374 290a 2020 2020 2020  ict(dict).      
-0001dbe0: 2020 7265 7761 7264 5f73 6361 6c65 203d    reward_scale =
-0001dbf0: 2073 656c 662e 6f62 7461 696e 5f72 6577   self.obtain_rew
-0001dc00: 6172 645f 7363 616c 6528 290a 0a20 2020  ard_scale()..   
-0001dc10: 2020 2020 2066 6f72 2065 7661 6c5f 706f       for eval_po
-0001dc20: 6c69 6379 2069 6e20 696e 7075 745f 6469  licy in input_di
-0001dc30: 6374 2e6b 6579 7328 293a 0a20 2020 2020  ct.keys():.     
-0001dc40: 2020 2020 2020 2069 6620 696e 7075 745f         if input_
-0001dc50: 6469 6374 5b65 7661 6c5f 706f 6c69 6379  dict[eval_policy
-0001dc60: 5d5b 226f 6e5f 706f 6c69 6379 5f70 6f6c  ]["on_policy_pol
-0001dc70: 6963 795f 7661 6c75 6522 5d20 6973 206e  icy_value"] is n
-0001dc80: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
-0001dc90: 2020 2020 2020 2020 2064 656e 7369 7479           density
-0001dca0: 203d 206e 702e 6869 7374 6f67 7261 6d28   = np.histogram(
-0001dcb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001dcc0: 2020 2020 2069 6e70 7574 5f64 6963 745b       input_dict[
-0001dcd0: 6576 616c 5f70 6f6c 6963 795d 5b22 6f6e  eval_policy]["on
-0001dce0: 5f70 6f6c 6963 795f 706f 6c69 6379 5f76  _policy_policy_v
-0001dcf0: 616c 7565 225d 2c0a 2020 2020 2020 2020  alue"],.        
-0001dd00: 2020 2020 2020 2020 2020 2020 6269 6e73              bins
-0001dd10: 3d72 6577 6172 645f 7363 616c 652c 0a20  =reward_scale,. 
-0001dd20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001dd30: 2020 2064 656e 7369 7479 3d54 7275 652c     density=True,
-0001dd40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001dd50: 2029 5b30 5d0a 2020 2020 2020 2020 2020   )[0].          
-0001dd60: 2020 2020 2020 7072 6f62 6162 696c 6974        probabilit
-0001dd70: 795f 6465 6e73 6974 795f 6675 6e63 7469  y_density_functi
-0001dd80: 6f6e 203d 2064 656e 7369 7479 202a 206e  on = density * n
-0001dd90: 702e 6469 6666 2872 6577 6172 645f 7363  p.diff(reward_sc
-0001dda0: 616c 6529 0a20 2020 2020 2020 2020 2020  ale).           
-0001ddb0: 2020 2020 206d 6561 6e5f 6469 6374 5b65       mean_dict[e
-0001ddc0: 7661 6c5f 706f 6c69 6379 5d5b 226f 6e5f  val_policy]["on_
-0001ddd0: 706f 6c69 6379 225d 203d 2028 0a20 2020  policy"] = (.   
-0001dde0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ddf0: 2070 726f 6261 6269 6c69 7479 5f64 656e   probability_den
-0001de00: 7369 7479 5f66 756e 6374 696f 6e20 2a20  sity_function * 
-0001de10: 7265 7761 7264 5f73 6361 6c65 5b31 3a5d  reward_scale[1:]
-0001de20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001de30: 2029 2e73 756d 2829 0a20 2020 2020 2020   ).sum().       
-0001de40: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-0001de50: 2020 2020 2020 2020 2020 206d 6561 6e5f             mean_
-0001de60: 6469 6374 5b65 7661 6c5f 706f 6c69 6379  dict[eval_policy
-0001de70: 5d5b 226f 6e5f 706f 6c69 6379 225d 203d  ]["on_policy"] =
-0001de80: 204e 6f6e 650a 0a20 2020 2020 2020 2020   None..         
-0001de90: 2020 2066 6f72 2065 7374 696d 6174 6f72     for estimator
-0001dea0: 5f6e 616d 6520 696e 2063 6f6d 7061 7265  _name in compare
-0001deb0: 645f 6573 7469 6d61 746f 7273 3a0a 2020  d_estimators:.  
-0001dec0: 2020 2020 2020 2020 2020 2020 2020 6573                es
-0001ded0: 7469 6d61 746f 7220 3d20 7365 6c66 2e6f  timator = self.o
-0001dee0: 7065 5f65 7374 696d 6174 6f72 735f 5b65  pe_estimators_[e
-0001def0: 7374 696d 6174 6f72 5f6e 616d 655d 0a20  stimator_name]. 
-0001df00: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-0001df10: 6561 6e5f 6469 6374 5b65 7661 6c5f 706f  ean_dict[eval_po
-0001df20: 6c69 6379 5d5b 6573 7469 6d61 746f 725f  licy][estimator_
-0001df30: 6e61 6d65 5d20 3d20 6573 7469 6d61 746f  name] = estimato
-0001df40: 722e 6573 7469 6d61 7465 5f6d 6561 6e28  r.estimate_mean(
+0001cb50: 2020 2073 7461 7465 5f6d 6172 6769 6e61     state_margina
+0001cb60: 6c5f 696d 706f 7274 616e 6365 5f77 6569  l_importance_wei
+0001cb70: 6768 742c 0a20 2020 2020 2020 2020 2020  ght,.           
+0001cb80: 2020 2020 2020 2020 206f 6e5f 706f 6c69           on_poli
+0001cb90: 6379 5f70 6f6c 6963 795f 7661 6c75 652c  cy_policy_value,
+0001cba0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001cbb0: 2020 2020 2067 616d 6d61 2c0a 2020 2020       gamma,.    
+0001cbc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cbd0: 6265 6861 7669 6f72 5f70 6f6c 6963 792c  behavior_policy,
+0001cbe0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001cbf0: 2020 2020 2065 7661 6c75 6174 696f 6e5f       evaluation_
+0001cc00: 706f 6c69 6379 2c0a 2020 2020 2020 2020  policy,.        
+0001cc10: 2020 2020 2020 2020 2020 2020 6461 7461              data
+0001cc20: 7365 745f 6964 2c0a 2020 2020 2020 2020  set_id,.        
+0001cc30: 2020 2020 2020 2020 5d0a 0a20 2020 2020          ]..     
+0001cc40: 2020 2020 2020 202e 2e20 7365 6561 6c73         .. seeals
+0001cc50: 6f3a 3a0a 0a20 2020 2020 2020 2020 2020  o::..           
+0001cc60: 2020 2020 203a 636c 6173 733a 6073 636f       :class:`sco
+0001cc70: 7065 5f72 6c2e 6f70 652e 696e 7075 742e  pe_rl.ope.input.
+0001cc80: 4372 6561 7465 4f50 4549 6e70 7574 6020  CreateOPEInput` 
+0001cc90: 6465 7363 7269 6265 7320 7468 6520 636f  describes the co
+0001cca0: 6d70 6f6e 656e 7473 206f 6620 3a63 6c61  mponents of :cla
+0001ccb0: 7373 3a60 696e 7075 745f 6469 6374 602e  ss:`input_dict`.
+0001ccc0: 0a0a 2020 2020 2020 2020 636f 6d70 6172  ..        compar
+0001ccd0: 6564 5f65 7374 696d 6174 6f72 733a 206c  ed_estimators: l
+0001cce0: 6973 7420 6f66 2073 7472 2c20 6465 6661  ist of str, defa
+0001ccf0: 756c 743d 4e6f 6e65 0a20 2020 2020 2020  ult=None.       
+0001cd00: 2020 2020 204e 616d 6520 6f66 2063 6f6d       Name of com
+0001cd10: 7061 7265 6420 6573 7469 6d61 746f 7273  pared estimators
+0001cd20: 2e0a 2020 2020 2020 2020 2020 2020 4966  ..            If
+0001cd30: 2060 4e6f 6e65 6020 6973 2067 6976 656e   `None` is given
+0001cd40: 2c20 616c 6c20 7468 6520 6573 7469 6d61  , all the estima
+0001cd50: 746f 7273 2061 7265 2063 6f6d 7061 7265  tors are compare
+0001cd60: 642e 0a0a 2020 2020 2020 2020 7265 7761  d...        rewa
+0001cd70: 7264 5f73 6361 6c65 3a20 6172 7261 792d  rd_scale: array-
+0001cd80: 6c69 6b65 206f 6620 7368 6170 6520 286e  like of shape (n
+0001cd90: 5f70 6172 7469 7469 6f6e 2c20 292c 2064  _partition, ), d
+0001cda0: 6566 6175 6c74 3d4e 6f6e 650a 2020 2020  efault=None.    
+0001cdb0: 2020 2020 2020 2020 5363 616c 6520 6f66          Scale of
+0001cdc0: 2074 6865 2074 7261 6a65 6374 6f72 792d   the trajectory-
+0001cdd0: 7769 7365 2072 6577 6172 6420 7573 6564  wise reward used
+0001cde0: 2066 6f72 2078 2d61 7869 7320 6f66 2074   for x-axis of t
+0001cdf0: 6865 2043 4446 2070 6c6f 742e 0a0a 2020  he CDF plot...  
+0001ce00: 2020 2020 2020 5265 7475 726e 0a20 2020        Return.   
+0001ce10: 2020 2020 202d 2d2d 2d2d 2d2d 0a20 2020       -------.   
+0001ce20: 2020 2020 2063 756d 756c 6174 6976 655f       cumulative_
+0001ce30: 6469 7374 7269 6275 7469 6f6e 5f64 6963  distribution_dic
+0001ce40: 743a 2064 6963 740a 2020 2020 2020 2020  t: dict.        
+0001ce50: 2020 2020 4469 6374 696f 6e61 7279 2063      Dictionary c
+0001ce60: 6f6e 7461 696e 696e 6720 7468 6520 6375  ontaining the cu
+0001ce70: 6d75 6c61 7469 7665 2064 6973 7472 6962  mulative distrib
+0001ce80: 7574 696f 6e20 6f66 2065 6163 6820 6576  ution of each ev
+0001ce90: 616c 7561 7469 6f6e 2070 6f6c 6963 7920  aluation policy 
+0001cea0: 6573 7469 6d61 7465 6420 6279 204f 5045  estimated by OPE
+0001ceb0: 2065 7374 696d 6174 6f72 732e 0a20 2020   estimators..   
+0001cec0: 2020 2020 2020 2020 206b 6579 3a20 3a63           key: :c
+0001ced0: 6c61 7373 3a60 5b65 7661 6c75 6174 696f  lass:`[evaluatio
+0001cee0: 6e5f 706f 6c69 6379 5d5b 4f50 455f 6573  n_policy][OPE_es
+0001cef0: 7469 6d61 746f 725f 6e61 6d65 5d60 0a0a  timator_name]`..
+0001cf00: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0001cf10: 2020 2020 6368 6563 6b5f 696e 7075 745f      check_input_
+0001cf20: 6469 6374 2869 6e70 7574 5f64 6963 7429  dict(input_dict)
+0001cf30: 0a0a 2020 2020 2020 2020 6375 6d75 6c61  ..        cumula
+0001cf40: 7469 7665 5f64 6973 7472 6962 7574 696f  tive_distributio
+0001cf50: 6e5f 6469 6374 203d 2064 6566 6175 6c74  n_dict = default
+0001cf60: 6469 6374 2864 6963 7429 0a20 2020 2020  dict(dict).     
+0001cf70: 2020 2072 6577 6172 645f 7363 616c 6520     reward_scale 
+0001cf80: 3d20 280a 2020 2020 2020 2020 2020 2020  = (.            
+0001cf90: 7365 6c66 2e6f 6274 6169 6e5f 7265 7761  self.obtain_rewa
+0001cfa0: 7264 5f73 6361 6c65 2829 2069 6620 7265  rd_scale() if re
+0001cfb0: 7761 7264 5f73 6361 6c65 2069 7320 4e6f  ward_scale is No
+0001cfc0: 6e65 2065 6c73 6520 7265 7761 7264 5f73  ne else reward_s
+0001cfd0: 6361 6c65 0a20 2020 2020 2020 2029 0a0a  cale.        )..
+0001cfe0: 2020 2020 2020 2020 666f 7220 6576 616c          for eval
+0001cff0: 5f70 6f6c 6963 7920 696e 2069 6e70 7574  _policy in input
+0001d000: 5f64 6963 742e 6b65 7973 2829 3a0a 2020  _dict.keys():.  
+0001d010: 2020 2020 2020 2020 2020 6966 2069 6e70            if inp
+0001d020: 7574 5f64 6963 745b 6576 616c 5f70 6f6c  ut_dict[eval_pol
+0001d030: 6963 795d 5b22 6f6e 5f70 6f6c 6963 795f  icy]["on_policy_
+0001d040: 706f 6c69 6379 5f76 616c 7565 225d 2069  policy_value"] i
+0001d050: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
+0001d060: 2020 2020 2020 2020 2020 2020 6465 6e73              dens
+0001d070: 6974 7920 3d20 6e70 2e68 6973 746f 6772  ity = np.histogr
+0001d080: 616d 280a 2020 2020 2020 2020 2020 2020  am(.            
+0001d090: 2020 2020 2020 2020 696e 7075 745f 6469          input_di
+0001d0a0: 6374 5b65 7661 6c5f 706f 6c69 6379 5d5b  ct[eval_policy][
+0001d0b0: 226f 6e5f 706f 6c69 6379 5f70 6f6c 6963  "on_policy_polic
+0001d0c0: 795f 7661 6c75 6522 5d2c 0a20 2020 2020  y_value"],.     
+0001d0d0: 2020 2020 2020 2020 2020 2020 2020 2062                 b
+0001d0e0: 696e 733d 7265 7761 7264 5f73 6361 6c65  ins=reward_scale
+0001d0f0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001d100: 2020 2020 2020 6465 6e73 6974 793d 5472        density=Tr
+0001d110: 7565 2c0a 2020 2020 2020 2020 2020 2020  ue,.            
+0001d120: 2020 2020 295b 305d 0a20 2020 2020 2020      )[0].       
+0001d130: 2020 2020 2020 2020 2070 726f 6261 6269           probabi
+0001d140: 6c69 7479 5f64 656e 7369 7479 5f66 756e  lity_density_fun
+0001d150: 6374 696f 6e20 3d20 6465 6e73 6974 7920  ction = density 
+0001d160: 2a20 6e70 2e64 6966 6628 7265 7761 7264  * np.diff(reward
+0001d170: 5f73 6361 6c65 290a 2020 2020 2020 2020  _scale).        
+0001d180: 2020 2020 2020 2020 6375 6d75 6c61 7469          cumulati
+0001d190: 7665 5f64 6973 7472 6962 7574 696f 6e5f  ve_distribution_
+0001d1a0: 6469 6374 5b65 7661 6c5f 706f 6c69 6379  dict[eval_policy
+0001d1b0: 5d5b 226f 6e5f 706f 6c69 6379 225d 203d  ]["on_policy"] =
+0001d1c0: 206e 702e 696e 7365 7274 280a 2020 2020   np.insert(.    
+0001d1d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d1e0: 7072 6f62 6162 696c 6974 795f 6465 6e73  probability_dens
+0001d1f0: 6974 795f 6675 6e63 7469 6f6e 2c20 302c  ity_function, 0,
+0001d200: 2030 0a20 2020 2020 2020 2020 2020 2020   0.             
+0001d210: 2020 2029 2e63 756d 7375 6d28 290a 2020     ).cumsum().  
+0001d220: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+0001d230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d240: 6375 6d75 6c61 7469 7665 5f64 6973 7472  cumulative_distr
+0001d250: 6962 7574 696f 6e5f 6469 6374 5b65 7661  ibution_dict[eva
+0001d260: 6c5f 706f 6c69 6379 5d5b 226f 6e5f 706f  l_policy]["on_po
+0001d270: 6c69 6379 225d 203d 204e 6f6e 650a 0a20  licy"] = None.. 
+0001d280: 2020 2020 2020 2020 2020 2066 6f72 2065             for e
+0001d290: 7374 696d 6174 6f72 5f6e 616d 6520 696e  stimator_name in
+0001d2a0: 2063 6f6d 7061 7265 645f 6573 7469 6d61   compared_estima
+0001d2b0: 746f 7273 3a0a 2020 2020 2020 2020 2020  tors:.          
+0001d2c0: 2020 2020 2020 6573 7469 6d61 746f 7220        estimator 
+0001d2d0: 3d20 7365 6c66 2e6f 7065 5f65 7374 696d  = self.ope_estim
+0001d2e0: 6174 6f72 735f 5b65 7374 696d 6174 6f72  ators_[estimator
+0001d2f0: 5f6e 616d 655d 0a20 2020 2020 2020 2020  _name].         
+0001d300: 2020 2020 2020 2063 756d 756c 6174 6976         cumulativ
+0001d310: 655f 6469 7374 7269 6275 7469 6f6e 5f64  e_distribution_d
+0001d320: 6963 745b 6576 616c 5f70 6f6c 6963 795d  ict[eval_policy]
+0001d330: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
+0001d340: 2020 2020 2020 6573 7469 6d61 746f 725f        estimator_
+0001d350: 6e61 6d65 0a20 2020 2020 2020 2020 2020  name.           
+0001d360: 2020 2020 205d 203d 2065 7374 696d 6174       ] = estimat
+0001d370: 6f72 2e65 7374 696d 6174 655f 6375 6d75  or.estimate_cumu
+0001d380: 6c61 7469 7665 5f64 6973 7472 6962 7574  lative_distribut
+0001d390: 696f 6e5f 6675 6e63 7469 6f6e 280a 2020  ion_function(.  
+0001d3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d3b0: 2020 2a2a 696e 7075 745f 6469 6374 5b65    **input_dict[e
+0001d3c0: 7661 6c5f 706f 6c69 6379 5d2c 0a20 2020  val_policy],.   
+0001d3d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d3e0: 202a 2a73 656c 662e 696e 7075 745f 6469   **self.input_di
+0001d3f0: 6374 5f2c 0a20 2020 2020 2020 2020 2020  ct_,.           
+0001d400: 2020 2020 2020 2020 2072 6577 6172 645f           reward_
+0001d410: 7363 616c 653d 7265 7761 7264 5f73 6361  scale=reward_sca
+0001d420: 6c65 2c0a 2020 2020 2020 2020 2020 2020  le,.            
+0001d430: 2020 2020 2020 2020 6469 7361 626c 655f          disable_
+0001d440: 7265 7761 7264 5f61 6674 6572 5f64 6f6e  reward_after_don
+0001d450: 653d 7365 6c66 2e64 6973 6162 6c65 5f72  e=self.disable_r
+0001d460: 6577 6172 645f 6166 7465 725f 646f 6e65  eward_after_done
+0001d470: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001d480: 2020 290a 0a20 2020 2020 2020 2072 6574    )..        ret
+0001d490: 7572 6e20 6465 6661 756c 7464 6963 745f  urn defaultdict_
+0001d4a0: 746f 5f64 6963 7428 6375 6d75 6c61 7469  to_dict(cumulati
+0001d4b0: 7665 5f64 6973 7472 6962 7574 696f 6e5f  ve_distribution_
+0001d4c0: 6469 6374 290a 0a20 2020 2064 6566 205f  dict)..    def _
+0001d4d0: 6573 7469 6d61 7465 5f6d 6561 6e28 0a20  estimate_mean(. 
+0001d4e0: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+0001d4f0: 2020 2020 2069 6e70 7574 5f64 6963 743a       input_dict:
+0001d500: 204f 5045 496e 7075 7444 6963 742c 0a20   OPEInputDict,. 
+0001d510: 2020 2020 2020 2063 6f6d 7061 7265 645f         compared_
+0001d520: 6573 7469 6d61 746f 7273 3a20 4f70 7469  estimators: Opti
+0001d530: 6f6e 616c 5b4c 6973 745b 7374 725d 5d20  onal[List[str]] 
+0001d540: 3d20 4e6f 6e65 2c0a 2020 2020 293a 0a20  = None,.    ):. 
+0001d550: 2020 2020 2020 2022 2222 4573 7469 6d61         """Estima
+0001d560: 7465 2074 6865 2065 7870 6563 7465 6420  te the expected 
+0001d570: 7472 616a 6563 746f 7279 2d77 6973 6520  trajectory-wise 
+0001d580: 7265 7761 7264 2028 692e 652e 2c20 706f  reward (i.e., po
+0001d590: 6c69 6379 2076 616c 7565 2920 6f66 2074  licy value) of t
+0001d5a0: 6865 2065 7661 6c75 6174 696f 6e20 706f  he evaluation po
+0001d5b0: 6c69 6369 6573 2e0a 0a20 2020 2020 2020  licies...       
+0001d5c0: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
+0001d5d0: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
+0001d5e0: 2020 2020 696e 7075 745f 6469 6374 3a20      input_dict: 
+0001d5f0: 4f50 4549 6e70 7574 4469 6374 0a20 2020  OPEInputDict.   
+0001d600: 2020 2020 2020 2020 2044 6963 7469 6f6e           Diction
+0001d610: 6172 7920 6f66 2074 6865 204f 5045 2069  ary of the OPE i
+0001d620: 6e70 7574 7320 666f 7220 6561 6368 2065  nputs for each e
+0001d630: 7661 6c75 6174 696f 6e20 706f 6c69 6379  valuation policy
+0001d640: 2e0a 0a20 2020 2020 2020 2020 2020 202e  ...            .
+0001d650: 2e20 636f 6465 2d62 6c6f 636b 3a3a 2070  . code-block:: p
+0001d660: 7974 686f 6e0a 0a20 2020 2020 2020 2020  ython..         
+0001d670: 2020 2020 2020 206b 6579 3a20 5b65 7661         key: [eva
+0001d680: 6c75 6174 696f 6e5f 706f 6c69 6379 5d5b  luation_policy][
+0001d690: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001d6a0: 2020 2020 2065 7661 6c75 6174 696f 6e5f       evaluation_
+0001d6b0: 706f 6c69 6379 5f61 6374 696f 6e2c 0a20  policy_action,. 
+0001d6c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d6d0: 2020 2065 7661 6c75 6174 696f 6e5f 706f     evaluation_po
+0001d6e0: 6c69 6379 5f61 6374 696f 6e5f 6469 7374  licy_action_dist
+0001d6f0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0001d700: 2020 2020 2020 7374 6174 655f 6163 7469        state_acti
+0001d710: 6f6e 5f76 616c 7565 5f70 7265 6469 6374  on_value_predict
+0001d720: 696f 6e2c 0a20 2020 2020 2020 2020 2020  ion,.           
+0001d730: 2020 2020 2020 2020 2069 6e69 7469 616c           initial
+0001d740: 5f73 7461 7465 5f76 616c 7565 5f70 7265  _state_value_pre
+0001d750: 6469 6374 696f 6e2c 0a20 2020 2020 2020  diction,.       
+0001d760: 2020 2020 2020 2020 2020 2020 2073 7461               sta
+0001d770: 7465 5f61 6374 696f 6e5f 6d61 7267 696e  te_action_margin
+0001d780: 616c 5f69 6d70 6f72 7461 6e63 655f 7765  al_importance_we
+0001d790: 6967 6874 2c0a 2020 2020 2020 2020 2020  ight,.          
+0001d7a0: 2020 2020 2020 2020 2020 7374 6174 655f            state_
+0001d7b0: 6d61 7267 696e 616c 5f69 6d70 6f72 7461  marginal_importa
+0001d7c0: 6e63 655f 7765 6967 6874 2c0a 2020 2020  nce_weight,.    
+0001d7d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d7e0: 6f6e 5f70 6f6c 6963 795f 706f 6c69 6379  on_policy_policy
+0001d7f0: 5f76 616c 7565 2c0a 2020 2020 2020 2020  _value,.        
+0001d800: 2020 2020 2020 2020 2020 2020 6761 6d6d              gamm
+0001d810: 612c 0a20 2020 2020 2020 2020 2020 2020  a,.             
+0001d820: 2020 2020 2020 2062 6568 6176 696f 725f         behavior_
+0001d830: 706f 6c69 6379 2c0a 2020 2020 2020 2020  policy,.        
+0001d840: 2020 2020 2020 2020 2020 2020 6576 616c              eval
+0001d850: 7561 7469 6f6e 5f70 6f6c 6963 792c 0a20  uation_policy,. 
+0001d860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d870: 2020 2064 6174 6173 6574 5f69 642c 0a20     dataset_id,. 
+0001d880: 2020 2020 2020 2020 2020 2020 2020 205d                 ]
+0001d890: 0a0a 2020 2020 2020 2020 2020 2020 2e2e  ..            ..
+0001d8a0: 2073 6565 616c 736f 3a3a 0a0a 2020 2020   seealso::..    
+0001d8b0: 2020 2020 2020 2020 2020 2020 3a63 6c61              :cla
+0001d8c0: 7373 3a60 7363 6f70 655f 726c 2e6f 7065  ss:`scope_rl.ope
+0001d8d0: 2e69 6e70 7574 2e43 7265 6174 654f 5045  .input.CreateOPE
+0001d8e0: 496e 7075 7460 2064 6573 6372 6962 6573  Input` describes
+0001d8f0: 2074 6865 2063 6f6d 706f 6e65 6e74 7320   the components 
+0001d900: 6f66 203a 636c 6173 733a 6069 6e70 7574  of :class:`input
+0001d910: 5f64 6963 7460 2e0a 0a20 2020 2020 2020  _dict`...       
+0001d920: 2063 6f6d 7061 7265 645f 6573 7469 6d61   compared_estima
+0001d930: 746f 7273 3a20 6c69 7374 206f 6620 7374  tors: list of st
+0001d940: 722c 2064 6566 6175 6c74 3d4e 6f6e 650a  r, default=None.
+0001d950: 2020 2020 2020 2020 2020 2020 4e61 6d65              Name
+0001d960: 206f 6620 636f 6d70 6172 6564 2065 7374   of compared est
+0001d970: 696d 6174 6f72 732e 0a20 2020 2020 2020  imators..       
+0001d980: 2020 2020 2049 6620 604e 6f6e 6560 2069       If `None` i
+0001d990: 7320 6769 7665 6e2c 2061 6c6c 2074 6865  s given, all the
+0001d9a0: 2065 7374 696d 6174 6f72 7320 6172 6520   estimators are 
+0001d9b0: 636f 6d70 6172 6564 2e0a 0a20 2020 2020  compared...     
+0001d9c0: 2020 2052 6574 7572 6e0a 2020 2020 2020     Return.      
+0001d9d0: 2020 2d2d 2d2d 2d2d 2d0a 2020 2020 2020    -------.      
+0001d9e0: 2020 6d65 616e 5f64 6963 743a 2064 6963    mean_dict: dic
+0001d9f0: 740a 2020 2020 2020 2020 2020 2020 4469  t.            Di
+0001da00: 6374 696f 6e61 7279 2063 6f6e 7461 696e  ctionary contain
+0001da10: 696e 6720 7468 6520 6d65 616e 2074 7261  ing the mean tra
+0001da20: 6a65 6374 6f72 792d 7769 7365 2072 6577  jectory-wise rew
+0001da30: 6172 6420 6f66 2065 6163 6820 6576 616c  ard of each eval
+0001da40: 7561 7469 6f6e 2070 6f6c 6963 7920 6573  uation policy es
+0001da50: 7469 6d61 7465 6420 6279 204f 5045 2065  timated by OPE e
+0001da60: 7374 696d 6174 6f72 732e 0a20 2020 2020  stimators..     
+0001da70: 2020 2020 2020 206b 6579 3a20 3a63 6c61         key: :cla
+0001da80: 7373 3a60 5b65 7661 6c75 6174 696f 6e5f  ss:`[evaluation_
+0001da90: 706f 6c69 6379 5d5b 4f50 455f 6573 7469  policy][OPE_esti
+0001daa0: 6d61 746f 725f 6e61 6d65 5d60 0a0a 2020  mator_name]`..  
+0001dab0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0001dac0: 2020 6368 6563 6b5f 696e 7075 745f 6469    check_input_di
+0001dad0: 6374 2869 6e70 7574 5f64 6963 7429 0a0a  ct(input_dict)..
+0001dae0: 2020 2020 2020 2020 6d65 616e 5f64 6963          mean_dic
+0001daf0: 7420 3d20 6465 6661 756c 7464 6963 7428  t = defaultdict(
+0001db00: 6469 6374 290a 2020 2020 2020 2020 7265  dict).        re
+0001db10: 7761 7264 5f73 6361 6c65 203d 2073 656c  ward_scale = sel
+0001db20: 662e 6f62 7461 696e 5f72 6577 6172 645f  f.obtain_reward_
+0001db30: 7363 616c 6528 290a 0a20 2020 2020 2020  scale()..       
+0001db40: 2066 6f72 2065 7661 6c5f 706f 6c69 6379   for eval_policy
+0001db50: 2069 6e20 696e 7075 745f 6469 6374 2e6b   in input_dict.k
+0001db60: 6579 7328 293a 0a20 2020 2020 2020 2020  eys():.         
+0001db70: 2020 2069 6620 696e 7075 745f 6469 6374     if input_dict
+0001db80: 5b65 7661 6c5f 706f 6c69 6379 5d5b 226f  [eval_policy]["o
+0001db90: 6e5f 706f 6c69 6379 5f70 6f6c 6963 795f  n_policy_policy_
+0001dba0: 7661 6c75 6522 5d20 6973 206e 6f74 204e  value"] is not N
+0001dbb0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+0001dbc0: 2020 2020 2064 656e 7369 7479 203d 206e       density = n
+0001dbd0: 702e 6869 7374 6f67 7261 6d28 0a20 2020  p.histogram(.   
+0001dbe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001dbf0: 2069 6e70 7574 5f64 6963 745b 6576 616c   input_dict[eval
+0001dc00: 5f70 6f6c 6963 795d 5b22 6f6e 5f70 6f6c  _policy]["on_pol
+0001dc10: 6963 795f 706f 6c69 6379 5f76 616c 7565  icy_policy_value
+0001dc20: 225d 2c0a 2020 2020 2020 2020 2020 2020  "],.            
+0001dc30: 2020 2020 2020 2020 6269 6e73 3d72 6577          bins=rew
+0001dc40: 6172 645f 7363 616c 652c 0a20 2020 2020  ard_scale,.     
+0001dc50: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+0001dc60: 656e 7369 7479 3d54 7275 652c 0a20 2020  ensity=True,.   
+0001dc70: 2020 2020 2020 2020 2020 2020 2029 5b30               )[0
+0001dc80: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+0001dc90: 2020 7072 6f62 6162 696c 6974 795f 6465    probability_de
+0001dca0: 6e73 6974 795f 6675 6e63 7469 6f6e 203d  nsity_function =
+0001dcb0: 2064 656e 7369 7479 202a 206e 702e 6469   density * np.di
+0001dcc0: 6666 2872 6577 6172 645f 7363 616c 6529  ff(reward_scale)
+0001dcd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001dce0: 206d 6561 6e5f 6469 6374 5b65 7661 6c5f   mean_dict[eval_
+0001dcf0: 706f 6c69 6379 5d5b 226f 6e5f 706f 6c69  policy]["on_poli
+0001dd00: 6379 225d 203d 2028 0a20 2020 2020 2020  cy"] = (.       
+0001dd10: 2020 2020 2020 2020 2020 2020 2070 726f               pro
+0001dd20: 6261 6269 6c69 7479 5f64 656e 7369 7479  bability_density
+0001dd30: 5f66 756e 6374 696f 6e20 2a20 7265 7761  _function * rewa
+0001dd40: 7264 5f73 6361 6c65 5b31 3a5d 0a20 2020  rd_scale[1:].   
+0001dd50: 2020 2020 2020 2020 2020 2020 2029 2e73               ).s
+0001dd60: 756d 2829 0a20 2020 2020 2020 2020 2020  um().           
+0001dd70: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+0001dd80: 2020 2020 2020 206d 6561 6e5f 6469 6374         mean_dict
+0001dd90: 5b65 7661 6c5f 706f 6c69 6379 5d5b 226f  [eval_policy]["o
+0001dda0: 6e5f 706f 6c69 6379 225d 203d 204e 6f6e  n_policy"] = Non
+0001ddb0: 650a 0a20 2020 2020 2020 2020 2020 2066  e..            f
+0001ddc0: 6f72 2065 7374 696d 6174 6f72 5f6e 616d  or estimator_nam
+0001ddd0: 6520 696e 2063 6f6d 7061 7265 645f 6573  e in compared_es
+0001dde0: 7469 6d61 746f 7273 3a0a 2020 2020 2020  timators:.      
+0001ddf0: 2020 2020 2020 2020 2020 6573 7469 6d61            estima
+0001de00: 746f 7220 3d20 7365 6c66 2e6f 7065 5f65  tor = self.ope_e
+0001de10: 7374 696d 6174 6f72 735f 5b65 7374 696d  stimators_[estim
+0001de20: 6174 6f72 5f6e 616d 655d 0a20 2020 2020  ator_name].     
+0001de30: 2020 2020 2020 2020 2020 206d 6561 6e5f             mean_
+0001de40: 6469 6374 5b65 7661 6c5f 706f 6c69 6379  dict[eval_policy
+0001de50: 5d5b 6573 7469 6d61 746f 725f 6e61 6d65  ][estimator_name
+0001de60: 5d20 3d20 6573 7469 6d61 746f 722e 6573  ] = estimator.es
+0001de70: 7469 6d61 7465 5f6d 6561 6e28 0a20 2020  timate_mean(.   
+0001de80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001de90: 202a 2a69 6e70 7574 5f64 6963 745b 6576   **input_dict[ev
+0001dea0: 616c 5f70 6f6c 6963 795d 2c0a 2020 2020  al_policy],.    
+0001deb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001dec0: 2a2a 7365 6c66 2e69 6e70 7574 5f64 6963  **self.input_dic
+0001ded0: 745f 2c0a 2020 2020 2020 2020 2020 2020  t_,.            
+0001dee0: 2020 2020 2020 2020 7265 7761 7264 5f73          reward_s
+0001def0: 6361 6c65 3d72 6577 6172 645f 7363 616c  cale=reward_scal
+0001df00: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+0001df10: 2020 2020 2020 2064 6973 6162 6c65 5f72         disable_r
+0001df20: 6577 6172 645f 6166 7465 725f 646f 6e65  eward_after_done
+0001df30: 3d73 656c 662e 6469 7361 626c 655f 7265  =self.disable_re
+0001df40: 7761 7264 5f61 6674 6572 5f64 6f6e 652c  ward_after_done,
 0001df50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001df60: 2020 2020 202a 2a69 6e70 7574 5f64 6963       **input_dic
-0001df70: 745b 6576 616c 5f70 6f6c 6963 795d 2c0a  t[eval_policy],.
-0001df80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001df90: 2020 2020 2a2a 7365 6c66 2e69 6e70 7574      **self.input
-0001dfa0: 5f64 6963 745f 2c0a 2020 2020 2020 2020  _dict_,.        
-0001dfb0: 2020 2020 2020 2020 2020 2020 7265 7761              rewa
-0001dfc0: 7264 5f73 6361 6c65 3d72 6577 6172 645f  rd_scale=reward_
-0001dfd0: 7363 616c 652c 0a20 2020 2020 2020 2020  scale,.         
-0001dfe0: 2020 2020 2020 2020 2020 2064 6973 6162             disab
-0001dff0: 6c65 5f72 6577 6172 645f 6166 7465 725f  le_reward_after_
-0001e000: 646f 6e65 3d73 656c 662e 6469 7361 626c  done=self.disabl
-0001e010: 655f 7265 7761 7264 5f61 6674 6572 5f64  e_reward_after_d
-0001e020: 6f6e 652c 0a20 2020 2020 2020 2020 2020  one,.           
-0001e030: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
-0001e040: 7265 7475 726e 2064 6566 6175 6c74 6469  return defaultdi
-0001e050: 6374 5f74 6f5f 6469 6374 286d 6561 6e5f  ct_to_dict(mean_
-0001e060: 6469 6374 290a 0a20 2020 2064 6566 205f  dict)..    def _
-0001e070: 6573 7469 6d61 7465 5f76 6172 6961 6e63  estimate_varianc
-0001e080: 6528 0a20 2020 2020 2020 2073 656c 662c  e(.        self,
-0001e090: 0a20 2020 2020 2020 2069 6e70 7574 5f64  .        input_d
-0001e0a0: 6963 743a 204f 5045 496e 7075 7444 6963  ict: OPEInputDic
-0001e0b0: 742c 0a20 2020 2020 2020 2063 6f6d 7061  t,.        compa
-0001e0c0: 7265 645f 6573 7469 6d61 746f 7273 3a20  red_estimators: 
-0001e0d0: 4f70 7469 6f6e 616c 5b4c 6973 745b 7374  Optional[List[st
-0001e0e0: 725d 5d20 3d20 4e6f 6e65 2c0a 2020 2020  r]] = None,.    
-0001e0f0: 293a 0a20 2020 2020 2020 2022 2222 4573  ):.        """Es
-0001e100: 7469 6d61 7465 2074 6865 2076 6172 6961  timate the varia
-0001e110: 6e63 6520 6f66 2074 6865 2074 7261 6a65  nce of the traje
-0001e120: 6374 6f72 792d 7769 7365 2072 6577 6172  ctory-wise rewar
-0001e130: 6420 756e 6465 7220 7468 6520 6769 7665  d under the give
-0001e140: 6e20 6576 616c 7561 7469 6f6e 2070 6f6c  n evaluation pol
-0001e150: 6963 6965 732e 0a0a 2020 2020 2020 2020  icies...        
-0001e160: 5061 7261 6d65 7465 7273 0a20 2020 2020  Parameters.     
-0001e170: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 2020     -------.     
-0001e180: 2020 2069 6e70 7574 5f64 6963 743a 204f     input_dict: O
-0001e190: 5045 496e 7075 7444 6963 740a 2020 2020  PEInputDict.    
-0001e1a0: 2020 2020 2020 2020 4469 6374 696f 6e61          Dictiona
-0001e1b0: 7279 206f 6620 7468 6520 4f50 4520 696e  ry of the OPE in
-0001e1c0: 7075 7473 2066 6f72 2065 6163 6820 6576  puts for each ev
-0001e1d0: 616c 7561 7469 6f6e 2070 6f6c 6963 792e  aluation policy.
-0001e1e0: 0a0a 2020 2020 2020 2020 2020 2020 2e2e  ..            ..
-0001e1f0: 2063 6f64 652d 626c 6f63 6b3a 3a20 7079   code-block:: py
-0001e200: 7468 6f6e 0a0a 2020 2020 2020 2020 2020  thon..          
-0001e210: 2020 2020 2020 6b65 793a 205b 6576 616c        key: [eval
-0001e220: 7561 7469 6f6e 5f70 6f6c 6963 795d 5b0a  uation_policy][.
-0001e230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e240: 2020 2020 6576 616c 7561 7469 6f6e 5f70      evaluation_p
-0001e250: 6f6c 6963 795f 6163 7469 6f6e 2c0a 2020  olicy_action,.  
-0001e260: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e270: 2020 6576 616c 7561 7469 6f6e 5f70 6f6c    evaluation_pol
-0001e280: 6963 795f 6163 7469 6f6e 5f64 6973 742c  icy_action_dist,
-0001e290: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001e2a0: 2020 2020 2073 7461 7465 5f61 6374 696f       state_actio
-0001e2b0: 6e5f 7661 6c75 655f 7072 6564 6963 7469  n_value_predicti
-0001e2c0: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
-0001e2d0: 2020 2020 2020 2020 696e 6974 6961 6c5f          initial_
-0001e2e0: 7374 6174 655f 7661 6c75 655f 7072 6564  state_value_pred
-0001e2f0: 6963 7469 6f6e 2c0a 2020 2020 2020 2020  iction,.        
-0001e300: 2020 2020 2020 2020 2020 2020 7374 6174              stat
-0001e310: 655f 6163 7469 6f6e 5f6d 6172 6769 6e61  e_action_margina
-0001e320: 6c5f 696d 706f 7274 616e 6365 5f77 6569  l_importance_wei
-0001e330: 6768 742c 0a20 2020 2020 2020 2020 2020  ght,.           
-0001e340: 2020 2020 2020 2020 2073 7461 7465 5f6d           state_m
-0001e350: 6172 6769 6e61 6c5f 696d 706f 7274 616e  arginal_importan
-0001e360: 6365 5f77 6569 6768 742c 0a20 2020 2020  ce_weight,.     
-0001e370: 2020 2020 2020 2020 2020 2020 2020 206f                 o
-0001e380: 6e5f 706f 6c69 6379 5f70 6f6c 6963 795f  n_policy_policy_
-0001e390: 7661 6c75 652c 0a20 2020 2020 2020 2020  value,.         
-0001e3a0: 2020 2020 2020 2020 2020 2067 616d 6d61             gamma
-0001e3b0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001e3c0: 2020 2020 2020 6265 6861 7669 6f72 5f70        behavior_p
-0001e3d0: 6f6c 6963 792c 0a20 2020 2020 2020 2020  olicy,.         
-0001e3e0: 2020 2020 2020 2020 2020 2065 7661 6c75             evalu
-0001e3f0: 6174 696f 6e5f 706f 6c69 6379 2c0a 2020  ation_policy,.  
-0001e400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e410: 2020 6461 7461 7365 745f 6964 2c0a 2020    dataset_id,.  
-0001e420: 2020 2020 2020 2020 2020 2020 2020 5d0a                ].
-0001e430: 0a20 2020 2020 2020 2020 2020 202e 2e20  .            .. 
-0001e440: 7365 6561 6c73 6f3a 3a0a 0a20 2020 2020  seealso::..     
-0001e450: 2020 2020 2020 2020 2020 203a 636c 6173             :clas
-0001e460: 733a 6073 636f 7065 5f72 6c2e 6f70 652e  s:`scope_rl.ope.
-0001e470: 696e 7075 742e 4372 6561 7465 4f50 4549  input.CreateOPEI
-0001e480: 6e70 7574 6020 6465 7363 7269 6265 7320  nput` describes 
-0001e490: 7468 6520 636f 6d70 6f6e 656e 7473 206f  the components o
-0001e4a0: 6620 3a63 6c61 7373 3a60 696e 7075 745f  f :class:`input_
-0001e4b0: 6469 6374 602e 0a0a 2020 2020 2020 2020  dict`...        
-0001e4c0: 636f 6d70 6172 6564 5f65 7374 696d 6174  compared_estimat
-0001e4d0: 6f72 733a 206c 6973 7420 6f66 2073 7472  ors: list of str
-0001e4e0: 2c20 6465 6661 756c 743d 4e6f 6e65 0a20  , default=None. 
-0001e4f0: 2020 2020 2020 2020 2020 204e 616d 6520             Name 
-0001e500: 6f66 2063 6f6d 7061 7265 6420 6573 7469  of compared esti
-0001e510: 6d61 746f 7273 2e0a 2020 2020 2020 2020  mators..        
-0001e520: 2020 2020 4966 2060 4e6f 6e65 6020 6973      If `None` is
-0001e530: 2067 6976 656e 2c20 616c 6c20 7468 6520   given, all the 
-0001e540: 6573 7469 6d61 746f 7273 2061 7265 2063  estimators are c
-0001e550: 6f6d 7061 7265 642e 0a0a 2020 2020 2020  ompared...      
-0001e560: 2020 5265 7475 726e 0a20 2020 2020 2020    Return.       
-0001e570: 202d 2d2d 2d2d 2d2d 0a20 2020 2020 2020   -------.       
-0001e580: 2076 6172 6961 6e63 655f 6469 6374 3a20   variance_dict: 
-0001e590: 6469 6374 0a20 2020 2020 2020 2020 2020  dict.           
-0001e5a0: 2044 6963 7469 6f6e 6172 7920 636f 6e74   Dictionary cont
-0001e5b0: 6169 6e69 6e67 2074 6865 2076 6172 6961  aining the varia
-0001e5c0: 6e63 6520 6f66 2074 7261 6a65 6374 6f72  nce of trajector
-0001e5d0: 792d 7769 7365 2072 6577 6172 6420 6f66  y-wise reward of
-0001e5e0: 2065 6163 6820 6576 616c 7561 7469 6f6e   each evaluation
-0001e5f0: 2070 6f6c 6963 7920 6573 7469 6d61 7465   policy estimate
-0001e600: 6420 6279 204f 5045 2065 7374 696d 6174  d by OPE estimat
-0001e610: 6f72 732e 0a20 2020 2020 2020 2020 2020  ors..           
-0001e620: 206b 6579 3a20 3a63 6c61 7373 3a60 5b65   key: :class:`[e
-0001e630: 7661 6c75 6174 696f 6e5f 706f 6c69 6379  valuation_policy
-0001e640: 5d5b 4f50 455f 6573 7469 6d61 746f 725f  ][OPE_estimator_
-0001e650: 6e61 6d65 5d60 0a0a 2020 2020 2020 2020  name]`..        
-0001e660: 2222 220a 2020 2020 2020 2020 6368 6563  """.        chec
-0001e670: 6b5f 696e 7075 745f 6469 6374 2869 6e70  k_input_dict(inp
-0001e680: 7574 5f64 6963 7429 0a0a 2020 2020 2020  ut_dict)..      
-0001e690: 2020 7661 7269 616e 6365 5f64 6963 7420    variance_dict 
-0001e6a0: 3d20 6465 6661 756c 7464 6963 7428 6469  = defaultdict(di
-0001e6b0: 6374 290a 2020 2020 2020 2020 7265 7761  ct).        rewa
-0001e6c0: 7264 5f73 6361 6c65 203d 2073 656c 662e  rd_scale = self.
-0001e6d0: 6f62 7461 696e 5f72 6577 6172 645f 7363  obtain_reward_sc
-0001e6e0: 616c 6528 290a 0a20 2020 2020 2020 2066  ale()..        f
-0001e6f0: 6f72 2065 7661 6c5f 706f 6c69 6379 2069  or eval_policy i
-0001e700: 6e20 696e 7075 745f 6469 6374 2e6b 6579  n input_dict.key
-0001e710: 7328 293a 0a20 2020 2020 2020 2020 2020  s():.           
-0001e720: 2069 6620 696e 7075 745f 6469 6374 5b65   if input_dict[e
-0001e730: 7661 6c5f 706f 6c69 6379 5d5b 226f 6e5f  val_policy]["on_
-0001e740: 706f 6c69 6379 5f70 6f6c 6963 795f 7661  policy_policy_va
-0001e750: 6c75 6522 5d20 6973 206e 6f74 204e 6f6e  lue"] is not Non
-0001e760: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-0001e770: 2020 2064 656e 7369 7479 203d 206e 702e     density = np.
-0001e780: 6869 7374 6f67 7261 6d28 0a20 2020 2020  histogram(.     
-0001e790: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0001e7a0: 6e70 7574 5f64 6963 745b 6576 616c 5f70  nput_dict[eval_p
-0001e7b0: 6f6c 6963 795d 5b22 6f6e 5f70 6f6c 6963  olicy]["on_polic
-0001e7c0: 795f 706f 6c69 6379 5f76 616c 7565 225d  y_policy_value"]
-0001e7d0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001e7e0: 2020 2020 2020 6269 6e73 3d72 6577 6172        bins=rewar
-0001e7f0: 645f 7363 616c 652c 0a20 2020 2020 2020  d_scale,.       
-0001e800: 2020 2020 2020 2020 2020 2020 2064 656e               den
-0001e810: 7369 7479 3d54 7275 652c 0a20 2020 2020  sity=True,.     
-0001e820: 2020 2020 2020 2020 2020 2029 5b30 5d0a             )[0].
-0001e830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001e840: 7072 6f62 6162 696c 6974 795f 6465 6e73  probability_dens
-0001e850: 6974 795f 6675 6e63 7469 6f6e 203d 2064  ity_function = d
-0001e860: 656e 7369 7479 202a 206e 702e 6469 6666  ensity * np.diff
-0001e870: 2872 6577 6172 645f 7363 616c 6529 0a20  (reward_scale). 
-0001e880: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-0001e890: 6561 6e20 3d20 2870 726f 6261 6269 6c69  ean = (probabili
-0001e8a0: 7479 5f64 656e 7369 7479 5f66 756e 6374  ty_density_funct
-0001e8b0: 696f 6e20 2a20 7265 7761 7264 5f73 6361  ion * reward_sca
-0001e8c0: 6c65 5b31 3a5d 292e 7375 6d28 290a 2020  le[1:]).sum().  
-0001e8d0: 2020 2020 2020 2020 2020 2020 2020 7661                va
-0001e8e0: 7269 616e 6365 5f64 6963 745b 6576 616c  riance_dict[eval
-0001e8f0: 5f70 6f6c 6963 795d 5b22 6f6e 5f70 6f6c  _policy]["on_pol
-0001e900: 6963 7922 5d20 3d20 280a 2020 2020 2020  icy"] = (.      
-0001e910: 2020 2020 2020 2020 2020 2020 2020 7072                pr
-0001e920: 6f62 6162 696c 6974 795f 6465 6e73 6974  obability_densit
-0001e930: 795f 6675 6e63 7469 6f6e 202a 2028 7265  y_function * (re
-0001e940: 7761 7264 5f73 6361 6c65 5b31 3a5d 202d  ward_scale[1:] -
-0001e950: 206d 6561 6e29 202a 2a20 320a 2020 2020   mean) ** 2.    
-0001e960: 2020 2020 2020 2020 2020 2020 292e 7375              ).su
-0001e970: 6d28 290a 2020 2020 2020 2020 2020 2020  m().            
-0001e980: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-0001e990: 2020 2020 2020 7661 7269 616e 6365 5f64        variance_d
-0001e9a0: 6963 745b 6576 616c 5f70 6f6c 6963 795d  ict[eval_policy]
-0001e9b0: 5b22 6f6e 5f70 6f6c 6963 7922 5d20 3d20  ["on_policy"] = 
-0001e9c0: 4e6f 6e65 0a0a 2020 2020 2020 2020 2020  None..          
-0001e9d0: 2020 666f 7220 6573 7469 6d61 746f 725f    for estimator_
-0001e9e0: 6e61 6d65 2069 6e20 636f 6d70 6172 6564  name in compared
-0001e9f0: 5f65 7374 696d 6174 6f72 733a 0a20 2020  _estimators:.   
-0001ea00: 2020 2020 2020 2020 2020 2020 2065 7374               est
-0001ea10: 696d 6174 6f72 203d 2073 656c 662e 6f70  imator = self.op
-0001ea20: 655f 6573 7469 6d61 746f 7273 5f5b 6573  e_estimators_[es
-0001ea30: 7469 6d61 746f 725f 6e61 6d65 5d0a 2020  timator_name].  
-0001ea40: 2020 2020 2020 2020 2020 2020 2020 7661                va
-0001ea50: 7269 616e 6365 5f64 6963 745b 6576 616c  riance_dict[eval
-0001ea60: 5f70 6f6c 6963 795d 5b0a 2020 2020 2020  _policy][.      
-0001ea70: 2020 2020 2020 2020 2020 2020 2020 6573                es
-0001ea80: 7469 6d61 746f 725f 6e61 6d65 0a20 2020  timator_name.   
-0001ea90: 2020 2020 2020 2020 2020 2020 205d 203d               ] =
-0001eaa0: 2065 7374 696d 6174 6f72 2e65 7374 696d   estimator.estim
-0001eab0: 6174 655f 7661 7269 616e 6365 280a 2020  ate_variance(.  
-0001eac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ead0: 2020 2a2a 696e 7075 745f 6469 6374 5b65    **input_dict[e
-0001eae0: 7661 6c5f 706f 6c69 6379 5d2c 0a20 2020  val_policy],.   
-0001eaf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001eb00: 202a 2a73 656c 662e 696e 7075 745f 6469   **self.input_di
-0001eb10: 6374 5f2c 0a20 2020 2020 2020 2020 2020  ct_,.           
-0001eb20: 2020 2020 2020 2020 2072 6577 6172 645f           reward_
-0001eb30: 7363 616c 653d 7265 7761 7264 5f73 6361  scale=reward_sca
-0001eb40: 6c65 2c0a 2020 2020 2020 2020 2020 2020  le,.            
-0001eb50: 2020 2020 290a 0a20 2020 2020 2020 2072      )..        r
-0001eb60: 6574 7572 6e20 6465 6661 756c 7464 6963  eturn defaultdic
-0001eb70: 745f 746f 5f64 6963 7428 7661 7269 616e  t_to_dict(varian
-0001eb80: 6365 5f64 6963 7429 0a0a 2020 2020 6465  ce_dict)..    de
-0001eb90: 6620 5f65 7374 696d 6174 655f 636f 6e64  f _estimate_cond
-0001eba0: 6974 696f 6e61 6c5f 7661 6c75 655f 6174  itional_value_at
-0001ebb0: 5f72 6973 6b28 0a20 2020 2020 2020 2073  _risk(.        s
-0001ebc0: 656c 662c 0a20 2020 2020 2020 2069 6e70  elf,.        inp
-0001ebd0: 7574 5f64 6963 743a 204f 5045 496e 7075  ut_dict: OPEInpu
-0001ebe0: 7444 6963 742c 0a20 2020 2020 2020 2063  tDict,.        c
-0001ebf0: 6f6d 7061 7265 645f 6573 7469 6d61 746f  ompared_estimato
-0001ec00: 7273 3a20 4f70 7469 6f6e 616c 5b4c 6973  rs: Optional[Lis
-0001ec10: 745b 7374 725d 5d20 3d20 4e6f 6e65 2c0a  t[str]] = None,.
-0001ec20: 2020 2020 2020 2020 616c 7068 6173 3a20          alphas: 
-0001ec30: 4f70 7469 6f6e 616c 5b55 6e69 6f6e 5b6e  Optional[Union[n
-0001ec40: 702e 6e64 6172 7261 792c 2066 6c6f 6174  p.ndarray, float
-0001ec50: 5d5d 203d 204e 6f6e 652c 0a20 2020 2029  ]] = None,.    )
-0001ec60: 3a0a 2020 2020 2020 2020 2222 2245 7374  :.        """Est
-0001ec70: 696d 6174 6520 7468 6520 636f 6e64 6974  imate the condit
-0001ec80: 696f 6e61 6c20 7661 6c75 6520 6174 2072  ional value at r
-0001ec90: 6973 6b20 6f66 2074 6865 2074 7261 6a65  isk of the traje
-0001eca0: 6374 6f72 792d 7769 7365 2072 6577 6172  ctory-wise rewar
-0001ecb0: 6420 756e 6465 7220 7468 6520 6769 7665  d under the give
-0001ecc0: 6e20 6576 616c 7561 7469 6f6e 2070 6f6c  n evaluation pol
-0001ecd0: 6963 6965 732e 0a0a 2020 2020 2020 2020  icies...        
-0001ece0: 5061 7261 6d65 7465 7273 0a20 2020 2020  Parameters.     
-0001ecf0: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 2020     -------.     
-0001ed00: 2020 2069 6e70 7574 5f64 6963 743a 204f     input_dict: O
-0001ed10: 5045 496e 7075 7444 6963 740a 2020 2020  PEInputDict.    
-0001ed20: 2020 2020 2020 2020 4469 6374 696f 6e61          Dictiona
-0001ed30: 7279 206f 6620 7468 6520 4f50 4520 696e  ry of the OPE in
-0001ed40: 7075 7473 2066 6f72 2065 6163 6820 6576  puts for each ev
-0001ed50: 616c 7561 7469 6f6e 2070 6f6c 6963 792e  aluation policy.
-0001ed60: 0a0a 2020 2020 2020 2020 2020 2020 2e2e  ..            ..
-0001ed70: 2063 6f64 652d 626c 6f63 6b3a 3a20 7079   code-block:: py
-0001ed80: 7468 6f6e 0a0a 2020 2020 2020 2020 2020  thon..          
-0001ed90: 2020 2020 2020 6b65 793a 205b 6576 616c        key: [eval
-0001eda0: 7561 7469 6f6e 5f70 6f6c 6963 795d 5b0a  uation_policy][.
-0001edb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001edc0: 2020 2020 6576 616c 7561 7469 6f6e 5f70      evaluation_p
-0001edd0: 6f6c 6963 795f 6163 7469 6f6e 2c0a 2020  olicy_action,.  
-0001ede0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001edf0: 2020 6576 616c 7561 7469 6f6e 5f70 6f6c    evaluation_pol
-0001ee00: 6963 795f 6163 7469 6f6e 5f64 6973 742c  icy_action_dist,
-0001ee10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001ee20: 2020 2020 2073 7461 7465 5f61 6374 696f       state_actio
-0001ee30: 6e5f 7661 6c75 655f 7072 6564 6963 7469  n_value_predicti
-0001ee40: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
-0001ee50: 2020 2020 2020 2020 696e 6974 6961 6c5f          initial_
-0001ee60: 7374 6174 655f 7661 6c75 655f 7072 6564  state_value_pred
-0001ee70: 6963 7469 6f6e 2c0a 2020 2020 2020 2020  iction,.        
-0001ee80: 2020 2020 2020 2020 2020 2020 7374 6174              stat
-0001ee90: 655f 6163 7469 6f6e 5f6d 6172 6769 6e61  e_action_margina
-0001eea0: 6c5f 696d 706f 7274 616e 6365 5f77 6569  l_importance_wei
-0001eeb0: 6768 742c 0a20 2020 2020 2020 2020 2020  ght,.           
-0001eec0: 2020 2020 2020 2020 2073 7461 7465 5f6d           state_m
-0001eed0: 6172 6769 6e61 6c5f 696d 706f 7274 616e  arginal_importan
-0001eee0: 6365 5f77 6569 6768 742c 0a20 2020 2020  ce_weight,.     
-0001eef0: 2020 2020 2020 2020 2020 2020 2020 206f                 o
-0001ef00: 6e5f 706f 6c69 6379 5f70 6f6c 6963 795f  n_policy_policy_
-0001ef10: 7661 6c75 652c 0a20 2020 2020 2020 2020  value,.         
-0001ef20: 2020 2020 2020 2020 2020 2067 616d 6d61             gamma
-0001ef30: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001ef40: 2020 2020 2020 6265 6861 7669 6f72 5f70        behavior_p
-0001ef50: 6f6c 6963 792c 0a20 2020 2020 2020 2020  olicy,.         
-0001ef60: 2020 2020 2020 2020 2020 2065 7661 6c75             evalu
-0001ef70: 6174 696f 6e5f 706f 6c69 6379 2c0a 2020  ation_policy,.  
-0001ef80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ef90: 2020 6461 7461 7365 745f 6964 2c0a 2020    dataset_id,.  
-0001efa0: 2020 2020 2020 2020 2020 2020 2020 5d0a                ].
-0001efb0: 0a20 2020 2020 2020 2020 2020 202e 2e20  .            .. 
-0001efc0: 7365 6561 6c73 6f3a 3a0a 0a20 2020 2020  seealso::..     
-0001efd0: 2020 2020 2020 2020 2020 203a 636c 6173             :clas
-0001efe0: 733a 6073 636f 7065 5f72 6c2e 6f70 652e  s:`scope_rl.ope.
-0001eff0: 696e 7075 742e 4372 6561 7465 4f50 4549  input.CreateOPEI
-0001f000: 6e70 7574 6020 6465 7363 7269 6265 7320  nput` describes 
-0001f010: 7468 6520 636f 6d70 6f6e 656e 7473 206f  the components o
-0001f020: 6620 3a63 6c61 7373 3a60 696e 7075 745f  f :class:`input_
-0001f030: 6469 6374 602e 0a0a 2020 2020 2020 2020  dict`...        
-0001f040: 636f 6d70 6172 6564 5f65 7374 696d 6174  compared_estimat
-0001f050: 6f72 733a 206c 6973 7420 6f66 2073 7472  ors: list of str
-0001f060: 2c20 6465 6661 756c 743d 4e6f 6e65 0a20  , default=None. 
-0001f070: 2020 2020 2020 2020 2020 204e 616d 6520             Name 
-0001f080: 6f66 2063 6f6d 7061 7265 6420 6573 7469  of compared esti
-0001f090: 6d61 746f 7273 2e0a 2020 2020 2020 2020  mators..        
-0001f0a0: 2020 2020 4966 2060 4e6f 6e65 6020 6973      If `None` is
-0001f0b0: 2067 6976 656e 2c20 616c 6c20 7468 6520   given, all the 
-0001f0c0: 6573 7469 6d61 746f 7273 2061 7265 2063  estimators are c
-0001f0d0: 6f6d 7061 7265 642e 0a0a 2020 2020 2020  ompared...      
-0001f0e0: 2020 616c 7068 6173 3a20 7b66 6c6f 6174    alphas: {float
-0001f0f0: 2c20 6172 7261 792d 6c69 6b65 206f 6620  , array-like of 
-0001f100: 7368 6170 6520 286e 5f61 6c70 6861 2c20  shape (n_alpha, 
-0001f110: 297d 2c20 6465 6661 756c 743d 4e6f 6e65  )}, default=None
-0001f120: 0a20 2020 2020 2020 2020 2020 2053 6574  .            Set
-0001f130: 206f 6620 7072 6f70 6f72 7469 6f6e 7320   of proportions 
-0001f140: 6f66 2074 6865 2073 6861 6465 6420 7265  of the shaded re
-0001f150: 6769 6f6e 2e20 5468 6520 7661 6c75 6528  gion. The value(
-0001f160: 7329 2073 686f 756c 6420 6265 2077 6974  s) should be wit
-0001f170: 6869 6e20 605b 302c 2031 2960 2e0a 2020  hin `[0, 1)`..  
-0001f180: 2020 2020 2020 2020 2020 4966 2060 4e6f            If `No
-0001f190: 6e65 6020 6973 2067 6976 656e 2c20 3a63  ne` is given, :c
-0001f1a0: 6c61 7373 3a60 6e70 2e6c 696e 7370 6163  lass:`np.linspac
-0001f1b0: 6528 302c 2031 2c20 3231 2960 2077 696c  e(0, 1, 21)` wil
-0001f1c0: 6c20 6265 2075 7365 642e 0a0a 2020 2020  l be used...    
-0001f1d0: 2020 2020 5265 7475 726e 0a20 2020 2020      Return.     
-0001f1e0: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 2020     -------.     
-0001f1f0: 2020 2063 6f6e 6469 7469 6f6e 616c 5f76     conditional_v
-0001f200: 616c 7565 5f61 745f 7269 736b 5f64 6963  alue_at_risk_dic
-0001f210: 743a 2064 6963 740a 2020 2020 2020 2020  t: dict.        
-0001f220: 2020 2020 4469 6374 696f 6e61 7279 2063      Dictionary c
-0001f230: 6f6e 7461 696e 696e 6720 7468 6520 636f  ontaining the co
-0001f240: 6e64 6974 696f 6e61 6c20 7661 6c75 6520  nditional value 
-0001f250: 6174 2072 6973 6b20 6f66 2074 7261 6a65  at risk of traje
-0001f260: 6374 6f72 792d 7769 7365 2072 6577 6172  ctory-wise rewar
-0001f270: 6420 6f66 2065 6163 6820 6576 616c 7561  d of each evalua
-0001f280: 7469 6f6e 2070 6f6c 6963 7920 6573 7469  tion policy esti
-0001f290: 6d61 7465 6420 6279 204f 5045 2065 7374  mated by OPE est
-0001f2a0: 696d 6174 6f72 732e 0a20 2020 2020 2020  imators..       
-0001f2b0: 2020 2020 206b 6579 3a20 3a63 6c61 7373       key: :class
-0001f2c0: 3a60 5b65 7661 6c75 6174 696f 6e5f 706f  :`[evaluation_po
-0001f2d0: 6c69 6379 5d5b 4f50 455f 6573 7469 6d61  licy][OPE_estima
-0001f2e0: 746f 725f 6e61 6d65 5d60 0a0a 2020 2020  tor_name]`..    
-0001f2f0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0001f300: 6368 6563 6b5f 696e 7075 745f 6469 6374  check_input_dict
-0001f310: 2869 6e70 7574 5f64 6963 7429 0a0a 2020  (input_dict)..  
-0001f320: 2020 2020 2020 636f 6e64 6974 696f 6e61        conditiona
-0001f330: 6c5f 7661 6c75 655f 6174 5f72 6973 6b5f  l_value_at_risk_
-0001f340: 6469 6374 203d 2064 6566 6175 6c74 6469  dict = defaultdi
-0001f350: 6374 2864 6963 7429 0a20 2020 2020 2020  ct(dict).       
-0001f360: 2072 6577 6172 645f 7363 616c 6520 3d20   reward_scale = 
-0001f370: 7365 6c66 2e6f 6274 6169 6e5f 7265 7761  self.obtain_rewa
-0001f380: 7264 5f73 6361 6c65 2829 0a0a 2020 2020  rd_scale()..    
-0001f390: 2020 2020 666f 7220 6576 616c 5f70 6f6c      for eval_pol
-0001f3a0: 6963 7920 696e 2069 6e70 7574 5f64 6963  icy in input_dic
-0001f3b0: 742e 6b65 7973 2829 3a0a 2020 2020 2020  t.keys():.      
-0001f3c0: 2020 2020 2020 6966 2069 6e70 7574 5f64        if input_d
-0001f3d0: 6963 745b 6576 616c 5f70 6f6c 6963 795d  ict[eval_policy]
-0001f3e0: 5b22 6f6e 5f70 6f6c 6963 795f 706f 6c69  ["on_policy_poli
-0001f3f0: 6379 5f76 616c 7565 225d 2069 7320 6e6f  cy_value"] is no
-0001f400: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-0001f410: 2020 2020 2020 2020 6465 6e73 6974 7920          density 
-0001f420: 3d20 6e70 2e68 6973 746f 6772 616d 280a  = np.histogram(.
-0001f430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f440: 2020 2020 696e 7075 745f 6469 6374 5b65      input_dict[e
-0001f450: 7661 6c5f 706f 6c69 6379 5d5b 226f 6e5f  val_policy]["on_
-0001f460: 706f 6c69 6379 5f70 6f6c 6963 795f 7661  policy_policy_va
-0001f470: 6c75 6522 5d2c 0a20 2020 2020 2020 2020  lue"],.         
-0001f480: 2020 2020 2020 2020 2020 2062 696e 733d             bins=
-0001f490: 7265 7761 7264 5f73 6361 6c65 2c0a 2020  reward_scale,.  
-0001f4a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f4b0: 2020 6465 6e73 6974 793d 5472 7565 2c0a    density=True,.
-0001f4c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f4d0: 295b 305d 0a20 2020 2020 2020 2020 2020  )[0].           
-0001f4e0: 2020 2020 2070 726f 6261 6269 6c69 7479       probability
-0001f4f0: 5f64 656e 7369 7479 5f66 756e 6374 696f  _density_functio
-0001f500: 6e20 3d20 6465 6e73 6974 7920 2a20 6e70  n = density * np
-0001f510: 2e64 6966 6628 7265 7761 7264 5f73 6361  .diff(reward_sca
-0001f520: 6c65 290a 2020 2020 2020 2020 2020 2020  le).            
-0001f530: 2020 2020 6375 6d75 6c61 7469 7665 5f64      cumulative_d
-0001f540: 6973 7472 6962 7574 696f 6e5f 6675 6e63  istribution_func
-0001f550: 7469 6f6e 203d 206e 702e 696e 7365 7274  tion = np.insert
-0001f560: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0001f570: 2020 2020 2020 7072 6f62 6162 696c 6974        probabilit
-0001f580: 795f 6465 6e73 6974 795f 6675 6e63 7469  y_density_functi
-0001f590: 6f6e 2c20 302c 2030 0a20 2020 2020 2020  on, 0, 0.       
-0001f5a0: 2020 2020 2020 2020 2029 2e63 756d 7375           ).cumsu
-0001f5b0: 6d28 290a 0a20 2020 2020 2020 2020 2020  m()..           
-0001f5c0: 2020 2020 2063 7661 7220 3d20 6e70 2e7a       cvar = np.z
-0001f5d0: 6572 6f73 5f6c 696b 6528 616c 7068 6173  eros_like(alphas
-0001f5e0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0001f5f0: 2020 666f 7220 692c 2061 6c70 6861 2069    for i, alpha i
-0001f600: 6e20 656e 756d 6572 6174 6528 616c 7068  n enumerate(alph
-0001f610: 6173 293a 0a20 2020 2020 2020 2020 2020  as):.           
-0001f620: 2020 2020 2020 2020 2069 6478 5f20 3d20           idx_ = 
-0001f630: 6e70 2e6e 6f6e 7a65 726f 2863 756d 756c  np.nonzero(cumul
-0001f640: 6174 6976 655f 6469 7374 7269 6275 7469  ative_distributi
-0001f650: 6f6e 5f66 756e 6374 696f 6e5b 313a 5d20  on_function[1:] 
-0001f660: 3e20 616c 7068 6129 5b30 5d0a 2020 2020  > alpha)[0].    
-0001f670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f680: 6966 206c 656e 2869 6478 5f29 203d 3d20  if len(idx_) == 
-0001f690: 303a 0a20 2020 2020 2020 2020 2020 2020  0:.             
-0001f6a0: 2020 2020 2020 2020 2020 2063 7661 725b             cvar[
-0001f6b0: 695d 203d 2028 0a20 2020 2020 2020 2020  i] = (.         
-0001f6c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f6d0: 2020 206e 702e 6469 6666 2863 756d 756c     np.diff(cumul
-0001f6e0: 6174 6976 655f 6469 7374 7269 6275 7469  ative_distributi
-0001f6f0: 6f6e 5f66 756e 6374 696f 6e29 202a 2072  on_function) * r
-0001f700: 6577 6172 645f 7363 616c 655b 313a 5d0a  eward_scale[1:].
-0001f710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f720: 2020 2020 2020 2020 292e 7375 6d28 2920          ).sum() 
-0001f730: 2f20 6375 6d75 6c61 7469 7665 5f64 6973  / cumulative_dis
-0001f740: 7472 6962 7574 696f 6e5f 6675 6e63 7469  tribution_functi
-0001f750: 6f6e 5b2d 315d 0a20 2020 2020 2020 2020  on[-1].         
-0001f760: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
-0001f770: 6964 785f 5b30 5d20 3d3d 2030 3a0a 2020  idx_[0] == 0:.  
-0001f780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f790: 2020 2020 2020 6376 6172 5b69 5d20 3d20        cvar[i] = 
-0001f7a0: 7265 7761 7264 5f73 6361 6c65 5b31 5d0a  reward_scale[1].
-0001f7b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f7c0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-0001f7d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f7e0: 2020 6c6f 7765 725f 6964 785f 203d 2069    lower_idx_ = i
-0001f7f0: 6478 5f5b 305d 0a20 2020 2020 2020 2020  dx_[0].         
-0001f800: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0001f810: 656c 6174 6976 655f 7072 6f62 6162 696c  elative_probabil
-0001f820: 6974 795f 6465 6e73 6974 7920 3d20 280a  ity_density = (.
-0001f830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f840: 2020 2020 2020 2020 2020 2020 6e70 2e64              np.d
-0001f850: 6966 6628 6375 6d75 6c61 7469 7665 5f64  iff(cumulative_d
-0001f860: 6973 7472 6962 7574 696f 6e5f 6675 6e63  istribution_func
-0001f870: 7469 6f6e 295b 3a20 6c6f 7765 725f 6964  tion)[: lower_id
-0001f880: 785f 202b 2031 5d0a 2020 2020 2020 2020  x_ + 1].        
-0001f890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f8a0: 2020 2020 2f20 6375 6d75 6c61 7469 7665      / cumulative
-0001f8b0: 5f64 6973 7472 6962 7574 696f 6e5f 6675  _distribution_fu
-0001f8c0: 6e63 7469 6f6e 5b6c 6f77 6572 5f69 6478  nction[lower_idx
-0001f8d0: 5f20 2b20 315d 0a20 2020 2020 2020 2020  _ + 1].         
-0001f8e0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-0001f8f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001f900: 2020 2020 2020 2020 2063 7661 725b 695d           cvar[i]
-0001f910: 203d 2028 0a20 2020 2020 2020 2020 2020   = (.           
-0001f920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f930: 2072 656c 6174 6976 655f 7072 6f62 6162   relative_probab
-0001f940: 696c 6974 795f 6465 6e73 6974 790a 2020  ility_density.  
-0001f950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f960: 2020 2020 2020 2020 2020 2a20 7265 7761            * rewa
-0001f970: 7264 5f73 6361 6c65 5b31 203a 206c 6f77  rd_scale[1 : low
-0001f980: 6572 5f69 6478 5f20 2b20 325d 0a20 2020  er_idx_ + 2].   
-0001f990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f9a0: 2020 2020 2029 2e73 756d 2829 0a0a 2020       ).sum()..  
-0001f9b0: 2020 2020 2020 2020 2020 2020 2020 636f                co
-0001f9c0: 6e64 6974 696f 6e61 6c5f 7661 6c75 655f  nditional_value_
-0001f9d0: 6174 5f72 6973 6b5f 6469 6374 5b65 7661  at_risk_dict[eva
-0001f9e0: 6c5f 706f 6c69 6379 5d5b 226f 6e5f 706f  l_policy]["on_po
-0001f9f0: 6c69 6379 225d 203d 2063 7661 720a 0a20  licy"] = cvar.. 
-0001fa00: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-0001fa10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001fa20: 2063 6f6e 6469 7469 6f6e 616c 5f76 616c   conditional_val
-0001fa30: 7565 5f61 745f 7269 736b 5f64 6963 745b  ue_at_risk_dict[
-0001fa40: 6576 616c 5f70 6f6c 6963 795d 5b22 6f6e  eval_policy]["on
-0001fa50: 5f70 6f6c 6963 7922 5d20 3d20 4e6f 6e65  _policy"] = None
-0001fa60: 0a0a 2020 2020 2020 2020 2020 2020 666f  ..            fo
-0001fa70: 7220 6573 7469 6d61 746f 725f 6e61 6d65  r estimator_name
-0001fa80: 2069 6e20 636f 6d70 6172 6564 5f65 7374   in compared_est
-0001fa90: 696d 6174 6f72 733a 0a20 2020 2020 2020  imators:.       
-0001faa0: 2020 2020 2020 2020 2065 7374 696d 6174           estimat
-0001fab0: 6f72 203d 2073 656c 662e 6f70 655f 6573  or = self.ope_es
-0001fac0: 7469 6d61 746f 7273 5f5b 6573 7469 6d61  timators_[estima
-0001fad0: 746f 725f 6e61 6d65 5d0a 2020 2020 2020  tor_name].      
-0001fae0: 2020 2020 2020 2020 2020 636f 6e64 6974            condit
-0001faf0: 696f 6e61 6c5f 7661 6c75 655f 6174 5f72  ional_value_at_r
-0001fb00: 6973 6b5f 6469 6374 5b65 7661 6c5f 706f  isk_dict[eval_po
-0001fb10: 6c69 6379 5d5b 0a20 2020 2020 2020 2020  licy][.         
-0001fb20: 2020 2020 2020 2020 2020 2065 7374 696d             estim
-0001fb30: 6174 6f72 5f6e 616d 650a 2020 2020 2020  ator_name.      
-0001fb40: 2020 2020 2020 2020 2020 5d20 3d20 6573            ] = es
-0001fb50: 7469 6d61 746f 722e 6573 7469 6d61 7465  timator.estimate
-0001fb60: 5f63 6f6e 6469 7469 6f6e 616c 5f76 616c  _conditional_val
-0001fb70: 7565 5f61 745f 7269 736b 280a 2020 2020  ue_at_risk(.    
-0001fb80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fb90: 2a2a 696e 7075 745f 6469 6374 5b65 7661  **input_dict[eva
-0001fba0: 6c5f 706f 6c69 6379 5d2c 0a20 2020 2020  l_policy],.     
-0001fbb0: 2020 2020 2020 2020 2020 2020 2020 202a                 *
-0001fbc0: 2a73 656c 662e 696e 7075 745f 6469 6374  *self.input_dict
-0001fbd0: 5f2c 0a20 2020 2020 2020 2020 2020 2020  _,.             
-0001fbe0: 2020 2020 2020 2072 6577 6172 645f 7363         reward_sc
-0001fbf0: 616c 653d 7265 7761 7264 5f73 6361 6c65  ale=reward_scale
-0001fc00: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0001fc10: 2020 2020 2020 616c 7068 6173 3d61 6c70        alphas=alp
-0001fc20: 6861 732c 0a20 2020 2020 2020 2020 2020  has,.           
-0001fc30: 2020 2020 2020 2020 2064 6973 6162 6c65           disable
-0001fc40: 5f72 6577 6172 645f 6166 7465 725f 646f  _reward_after_do
-0001fc50: 6e65 3d73 656c 662e 6469 7361 626c 655f  ne=self.disable_
-0001fc60: 7265 7761 7264 5f61 6674 6572 5f64 6f6e  reward_after_don
-0001fc70: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
-0001fc80: 2020 2029 0a0a 2020 2020 2020 2020 7265     )..        re
-0001fc90: 7475 726e 2064 6566 6175 6c74 6469 6374  turn defaultdict
-0001fca0: 5f74 6f5f 6469 6374 2863 6f6e 6469 7469  _to_dict(conditi
-0001fcb0: 6f6e 616c 5f76 616c 7565 5f61 745f 7269  onal_value_at_ri
-0001fcc0: 736b 5f64 6963 7429 0a0a 2020 2020 6465  sk_dict)..    de
-0001fcd0: 6620 5f65 7374 696d 6174 655f 696e 7465  f _estimate_inte
-0001fce0: 7271 7561 7274 696c 655f 7261 6e67 6528  rquartile_range(
-0001fcf0: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
-0001fd00: 2020 2020 2020 2069 6e70 7574 5f64 6963         input_dic
-0001fd10: 743a 204f 5045 496e 7075 7444 6963 742c  t: OPEInputDict,
-0001fd20: 0a20 2020 2020 2020 2063 6f6d 7061 7265  .        compare
-0001fd30: 645f 6573 7469 6d61 746f 7273 3a20 4f70  d_estimators: Op
-0001fd40: 7469 6f6e 616c 5b4c 6973 745b 7374 725d  tional[List[str]
-0001fd50: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
-0001fd60: 2020 616c 7068 613a 2066 6c6f 6174 203d    alpha: float =
-0001fd70: 2030 2e30 352c 0a20 2020 2029 3a0a 2020   0.05,.    ):.  
-0001fd80: 2020 2020 2020 2222 2245 7374 696d 6174        """Estimat
-0001fd90: 6520 7468 6520 696e 7465 7271 7561 7274  e the interquart
-0001fda0: 696c 6520 7261 6e67 6520 6f66 2074 6865  ile range of the
-0001fdb0: 2074 7261 6a65 6374 6f72 792d 7769 7365   trajectory-wise
-0001fdc0: 2072 6577 6172 6420 756e 6465 7220 7468   reward under th
-0001fdd0: 6520 6769 7665 6e20 6576 616c 7561 7469  e given evaluati
-0001fde0: 6f6e 2070 6f6c 6963 6965 732e 0a0a 2020  on policies...  
-0001fdf0: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
-0001fe00: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0001fe10: 0a20 2020 2020 2020 2069 6e70 7574 5f64  .        input_d
-0001fe20: 6963 743a 204f 5045 496e 7075 7444 6963  ict: OPEInputDic
-0001fe30: 740a 2020 2020 2020 2020 2020 2020 4469  t.            Di
-0001fe40: 6374 696f 6e61 7279 206f 6620 7468 6520  ctionary of the 
-0001fe50: 4f50 4520 696e 7075 7473 2066 6f72 2065  OPE inputs for e
-0001fe60: 6163 6820 6576 616c 7561 7469 6f6e 2070  ach evaluation p
-0001fe70: 6f6c 6963 792e 0a0a 2020 2020 2020 2020  olicy...        
-0001fe80: 2020 2020 2e2e 2063 6f64 652d 626c 6f63      .. code-bloc
-0001fe90: 6b3a 3a20 7079 7468 6f6e 0a0a 2020 2020  k:: python..    
-0001fea0: 2020 2020 2020 2020 2020 2020 6b65 793a              key:
-0001feb0: 205b 6576 616c 7561 7469 6f6e 5f70 6f6c   [evaluation_pol
-0001fec0: 6963 795d 5b0a 2020 2020 2020 2020 2020  icy][.          
-0001fed0: 2020 2020 2020 2020 2020 6576 616c 7561            evalua
-0001fee0: 7469 6f6e 5f70 6f6c 6963 795f 6163 7469  tion_policy_acti
-0001fef0: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
-0001ff00: 2020 2020 2020 2020 6576 616c 7561 7469          evaluati
-0001ff10: 6f6e 5f70 6f6c 6963 795f 6163 7469 6f6e  on_policy_action
-0001ff20: 5f64 6973 742c 0a20 2020 2020 2020 2020  _dist,.         
-0001ff30: 2020 2020 2020 2020 2020 2073 7461 7465             state
-0001ff40: 5f61 6374 696f 6e5f 7661 6c75 655f 7072  _action_value_pr
-0001ff50: 6564 6963 7469 6f6e 2c0a 2020 2020 2020  ediction,.      
-0001ff60: 2020 2020 2020 2020 2020 2020 2020 696e                in
-0001ff70: 6974 6961 6c5f 7374 6174 655f 7661 6c75  itial_state_valu
-0001ff80: 655f 7072 6564 6963 7469 6f6e 2c0a 2020  e_prediction,.  
-0001ff90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ffa0: 2020 7374 6174 655f 6163 7469 6f6e 5f6d    state_action_m
-0001ffb0: 6172 6769 6e61 6c5f 696d 706f 7274 616e  arginal_importan
-0001ffc0: 6365 5f77 6569 6768 742c 0a20 2020 2020  ce_weight,.     
-0001ffd0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0001ffe0: 7461 7465 5f6d 6172 6769 6e61 6c5f 696d  tate_marginal_im
-0001fff0: 706f 7274 616e 6365 5f77 6569 6768 742c  portance_weight,
-00020000: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00020010: 2020 2020 206f 6e5f 706f 6c69 6379 5f70       on_policy_p
-00020020: 6f6c 6963 795f 7661 6c75 652c 0a20 2020  olicy_value,.   
-00020030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020040: 2067 616d 6d61 2c0a 2020 2020 2020 2020   gamma,.        
-00020050: 2020 2020 2020 2020 2020 2020 6265 6861              beha
-00020060: 7669 6f72 5f70 6f6c 6963 792c 0a20 2020  vior_policy,.   
-00020070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020080: 2065 7661 6c75 6174 696f 6e5f 706f 6c69   evaluation_poli
-00020090: 6379 2c0a 2020 2020 2020 2020 2020 2020  cy,.            
-000200a0: 2020 2020 2020 2020 6461 7461 7365 745f          dataset_
-000200b0: 6964 2c0a 2020 2020 2020 2020 2020 2020  id,.            
-000200c0: 2020 2020 5d0a 0a20 2020 2020 2020 2020      ]..         
-000200d0: 2020 202e 2e20 7365 6561 6c73 6f3a 3a0a     .. seealso::.
-000200e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000200f0: 203a 636c 6173 733a 6073 636f 7065 5f72   :class:`scope_r
-00020100: 6c2e 6f70 652e 696e 7075 742e 4372 6561  l.ope.input.Crea
-00020110: 7465 4f50 4549 6e70 7574 6020 6465 7363  teOPEInput` desc
-00020120: 7269 6265 7320 7468 6520 636f 6d70 6f6e  ribes the compon
-00020130: 656e 7473 206f 6620 3a63 6c61 7373 3a60  ents of :class:`
-00020140: 696e 7075 745f 6469 6374 602e 0a0a 2020  input_dict`...  
-00020150: 2020 2020 2020 636f 6d70 6172 6564 5f65        compared_e
-00020160: 7374 696d 6174 6f72 733a 206c 6973 7420  stimators: list 
-00020170: 6f66 2073 7472 2c20 6465 6661 756c 743d  of str, default=
-00020180: 4e6f 6e65 0a20 2020 2020 2020 2020 2020  None.           
-00020190: 204e 616d 6520 6f66 2063 6f6d 7061 7265   Name of compare
-000201a0: 6420 6573 7469 6d61 746f 7273 2e0a 2020  d estimators..  
-000201b0: 2020 2020 2020 2020 2020 4966 2060 4e6f            If `No
-000201c0: 6e65 6020 6973 2067 6976 656e 2c20 616c  ne` is given, al
-000201d0: 6c20 7468 6520 6573 7469 6d61 746f 7273  l the estimators
-000201e0: 2061 7265 2063 6f6d 7061 7265 642e 0a0a   are compared...
-000201f0: 2020 2020 2020 2020 616c 7068 613a 2066          alpha: f
-00020200: 6c6f 6174 2c20 6465 6661 756c 743d 302e  loat, default=0.
-00020210: 3035 0a20 2020 2020 2020 2020 2020 2050  05.            P
-00020220: 726f 706f 7274 696f 6e20 6f66 2074 6865  roportion of the
-00020230: 2073 6861 6465 6420 7265 6769 6f6e 2e20   shaded region. 
-00020240: 5468 6520 7661 6c75 6520 7368 6f75 6c64  The value should
-00020250: 2062 6520 7769 7468 696e 2028 302c 2031   be within (0, 1
-00020260: 5d2e 0a0a 2020 2020 2020 2020 5265 7475  ]...        Retu
-00020270: 726e 0a20 2020 2020 2020 202d 2d2d 2d2d  rn.        -----
-00020280: 2d2d 0a20 2020 2020 2020 2069 6e74 6572  --.        inter
-00020290: 7175 6172 7469 6c65 5f72 616e 6765 5f64  quartile_range_d
-000202a0: 6963 743a 2064 6963 740a 2020 2020 2020  ict: dict.      
-000202b0: 2020 2020 2020 4469 6374 696f 6e61 7279        Dictionary
-000202c0: 2063 6f6e 7461 696e 696e 6720 7468 6520   containing the 
-000202d0: 696e 7465 7271 7561 7274 696c 6520 7261  interquartile ra
-000202e0: 6e67 6520 6f66 2074 7261 6a65 6374 6f72  nge of trajector
-000202f0: 792d 7769 7365 2072 6577 6172 6420 6f66  y-wise reward of
-00020300: 2065 6163 6820 6576 616c 7561 7469 6f6e   each evaluation
-00020310: 2070 6f6c 6963 7920 6573 7469 6d61 7465   policy estimate
-00020320: 6420 6279 204f 5045 2065 7374 696d 6174  d by OPE estimat
-00020330: 6f72 732e 0a20 2020 2020 2020 2020 2020  ors..           
-00020340: 206b 6579 3a20 3a63 6c61 7373 3a60 5b65   key: :class:`[e
-00020350: 7661 6c75 6174 696f 6e5f 706f 6c69 6379  valuation_policy
-00020360: 5d5b 4f50 455f 6573 7469 6d61 746f 725f  ][OPE_estimator_
-00020370: 6e61 6d65 5d5b 7175 6172 7469 6c65 5f6e  name][quartile_n
-00020380: 616d 655d 600a 0a20 2020 2020 2020 2022  ame]`..        "
-00020390: 2222 0a20 2020 2020 2020 2063 6865 636b  "".        check
-000203a0: 5f69 6e70 7574 5f64 6963 7428 696e 7075  _input_dict(inpu
-000203b0: 745f 6469 6374 290a 0a20 2020 2020 2020  t_dict)..       
-000203c0: 2069 6e74 6572 7175 6172 7469 6c65 5f72   interquartile_r
-000203d0: 616e 6765 5f64 6963 7420 3d20 6465 6661  ange_dict = defa
-000203e0: 756c 7464 6963 7428 6469 6374 290a 2020  ultdict(dict).  
-000203f0: 2020 2020 2020 7265 7761 7264 5f73 6361        reward_sca
-00020400: 6c65 203d 2073 656c 662e 6f62 7461 696e  le = self.obtain
-00020410: 5f72 6577 6172 645f 7363 616c 6528 290a  _reward_scale().
-00020420: 0a20 2020 2020 2020 2066 6f72 2065 7661  .        for eva
-00020430: 6c5f 706f 6c69 6379 2069 6e20 696e 7075  l_policy in inpu
-00020440: 745f 6469 6374 2e6b 6579 7328 293a 0a20  t_dict.keys():. 
-00020450: 2020 2020 2020 2020 2020 2069 6620 696e             if in
-00020460: 7075 745f 6469 6374 5b65 7661 6c5f 706f  put_dict[eval_po
-00020470: 6c69 6379 5d5b 226f 6e5f 706f 6c69 6379  licy]["on_policy
-00020480: 5f70 6f6c 6963 795f 7661 6c75 6522 5d20  _policy_value"] 
-00020490: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
-000204a0: 2020 2020 2020 2020 2020 2020 2064 656e               den
-000204b0: 7369 7479 203d 206e 702e 6869 7374 6f67  sity = np.histog
-000204c0: 7261 6d28 0a20 2020 2020 2020 2020 2020  ram(.           
-000204d0: 2020 2020 2020 2020 2069 6e70 7574 5f64           input_d
-000204e0: 6963 745b 6576 616c 5f70 6f6c 6963 795d  ict[eval_policy]
-000204f0: 5b22 6f6e 5f70 6f6c 6963 795f 706f 6c69  ["on_policy_poli
-00020500: 6379 5f76 616c 7565 225d 2c0a 2020 2020  cy_value"],.    
-00020510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020520: 6269 6e73 3d72 6577 6172 645f 7363 616c  bins=reward_scal
-00020530: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
-00020540: 2020 2020 2020 2064 656e 7369 7479 3d54         density=T
-00020550: 7275 652c 0a20 2020 2020 2020 2020 2020  rue,.           
-00020560: 2020 2020 2029 5b30 5d0a 2020 2020 2020       )[0].      
-00020570: 2020 2020 2020 2020 2020 7072 6f62 6162            probab
-00020580: 696c 6974 795f 6465 6e73 6974 795f 6675  ility_density_fu
-00020590: 6e63 7469 6f6e 203d 2064 656e 7369 7479  nction = density
-000205a0: 202a 206e 702e 6469 6666 2872 6577 6172   * np.diff(rewar
-000205b0: 645f 7363 616c 6529 0a0a 2020 2020 2020  d_scale)..      
-000205c0: 2020 2020 2020 2020 2020 6c6f 7765 725f            lower_
-000205d0: 6964 785f 203d 206e 702e 6e6f 6e7a 6572  idx_ = np.nonzer
-000205e0: 6f28 7072 6f62 6162 696c 6974 795f 6465  o(probability_de
-000205f0: 6e73 6974 795f 6675 6e63 7469 6f6e 2e63  nsity_function.c
-00020600: 756d 7375 6d28 2920 3e20 616c 7068 6129  umsum() > alpha)
-00020610: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
-00020620: 2020 2020 2020 300a 2020 2020 2020 2020        0.        
-00020630: 2020 2020 2020 2020 5d0a 2020 2020 2020          ].      
-00020640: 2020 2020 2020 2020 2020 6d65 6469 616e            median
-00020650: 5f69 6478 5f20 3d20 6e70 2e6e 6f6e 7a65  _idx_ = np.nonze
-00020660: 726f 2870 726f 6261 6269 6c69 7479 5f64  ro(probability_d
-00020670: 656e 7369 7479 5f66 756e 6374 696f 6e2e  ensity_function.
-00020680: 6375 6d73 756d 2829 203e 2030 2e35 295b  cumsum() > 0.5)[
-00020690: 305d 0a20 2020 2020 2020 2020 2020 2020  0].             
-000206a0: 2020 2075 7070 6572 5f69 6478 5f20 3d20     upper_idx_ = 
-000206b0: 6e70 2e6e 6f6e 7a65 726f 280a 2020 2020  np.nonzero(.    
-000206c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000206d0: 7072 6f62 6162 696c 6974 795f 6465 6e73  probability_dens
-000206e0: 6974 795f 6675 6e63 7469 6f6e 2e63 756d  ity_function.cum
-000206f0: 7375 6d28 2920 3e20 3120 2d20 616c 7068  sum() > 1 - alph
-00020700: 610a 2020 2020 2020 2020 2020 2020 2020  a.              
-00020710: 2020 295b 305d 0a0a 2020 2020 2020 2020    )[0]..        
-00020720: 2020 2020 2020 2020 696e 7465 7271 7561          interqua
-00020730: 7274 696c 655f 7261 6e67 655f 6469 6374  rtile_range_dict
-00020740: 5b65 7661 6c5f 706f 6c69 6379 5d5b 226f  [eval_policy]["o
-00020750: 6e5f 706f 6c69 6379 225d 203d 207b 0a20  n_policy"] = {. 
-00020760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020770: 2020 2022 6d65 6469 616e 223a 2073 656c     "median": sel
-00020780: 662e 5f74 6172 6765 745f 7661 6c75 655f  f._target_value_
-00020790: 6769 7665 6e5f 6964 7828 0a20 2020 2020  given_idx(.     
+0001df60: 2029 0a0a 2020 2020 2020 2020 7265 7475   )..        retu
+0001df70: 726e 2064 6566 6175 6c74 6469 6374 5f74  rn defaultdict_t
+0001df80: 6f5f 6469 6374 286d 6561 6e5f 6469 6374  o_dict(mean_dict
+0001df90: 290a 0a20 2020 2064 6566 205f 6573 7469  )..    def _esti
+0001dfa0: 6d61 7465 5f76 6172 6961 6e63 6528 0a20  mate_variance(. 
+0001dfb0: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+0001dfc0: 2020 2020 2069 6e70 7574 5f64 6963 743a       input_dict:
+0001dfd0: 204f 5045 496e 7075 7444 6963 742c 0a20   OPEInputDict,. 
+0001dfe0: 2020 2020 2020 2063 6f6d 7061 7265 645f         compared_
+0001dff0: 6573 7469 6d61 746f 7273 3a20 4f70 7469  estimators: Opti
+0001e000: 6f6e 616c 5b4c 6973 745b 7374 725d 5d20  onal[List[str]] 
+0001e010: 3d20 4e6f 6e65 2c0a 2020 2020 293a 0a20  = None,.    ):. 
+0001e020: 2020 2020 2020 2022 2222 4573 7469 6d61         """Estima
+0001e030: 7465 2074 6865 2076 6172 6961 6e63 6520  te the variance 
+0001e040: 6f66 2074 6865 2074 7261 6a65 6374 6f72  of the trajector
+0001e050: 792d 7769 7365 2072 6577 6172 6420 756e  y-wise reward un
+0001e060: 6465 7220 7468 6520 6769 7665 6e20 6576  der the given ev
+0001e070: 616c 7561 7469 6f6e 2070 6f6c 6963 6965  aluation policie
+0001e080: 732e 0a0a 2020 2020 2020 2020 5061 7261  s...        Para
+0001e090: 6d65 7465 7273 0a20 2020 2020 2020 202d  meters.        -
+0001e0a0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2069  ------.        i
+0001e0b0: 6e70 7574 5f64 6963 743a 204f 5045 496e  nput_dict: OPEIn
+0001e0c0: 7075 7444 6963 740a 2020 2020 2020 2020  putDict.        
+0001e0d0: 2020 2020 4469 6374 696f 6e61 7279 206f      Dictionary o
+0001e0e0: 6620 7468 6520 4f50 4520 696e 7075 7473  f the OPE inputs
+0001e0f0: 2066 6f72 2065 6163 6820 6576 616c 7561   for each evalua
+0001e100: 7469 6f6e 2070 6f6c 6963 792e 0a0a 2020  tion policy...  
+0001e110: 2020 2020 2020 2020 2020 2e2e 2063 6f64            .. cod
+0001e120: 652d 626c 6f63 6b3a 3a20 7079 7468 6f6e  e-block:: python
+0001e130: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001e140: 2020 6b65 793a 205b 6576 616c 7561 7469    key: [evaluati
+0001e150: 6f6e 5f70 6f6c 6963 795d 5b0a 2020 2020  on_policy][.    
+0001e160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e170: 6576 616c 7561 7469 6f6e 5f70 6f6c 6963  evaluation_polic
+0001e180: 795f 6163 7469 6f6e 2c0a 2020 2020 2020  y_action,.      
+0001e190: 2020 2020 2020 2020 2020 2020 2020 6576                ev
+0001e1a0: 616c 7561 7469 6f6e 5f70 6f6c 6963 795f  aluation_policy_
+0001e1b0: 6163 7469 6f6e 5f64 6973 742c 0a20 2020  action_dist,.   
+0001e1c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e1d0: 2073 7461 7465 5f61 6374 696f 6e5f 7661   state_action_va
+0001e1e0: 6c75 655f 7072 6564 6963 7469 6f6e 2c0a  lue_prediction,.
+0001e1f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e200: 2020 2020 696e 6974 6961 6c5f 7374 6174      initial_stat
+0001e210: 655f 7661 6c75 655f 7072 6564 6963 7469  e_value_predicti
+0001e220: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
+0001e230: 2020 2020 2020 2020 7374 6174 655f 6163          state_ac
+0001e240: 7469 6f6e 5f6d 6172 6769 6e61 6c5f 696d  tion_marginal_im
+0001e250: 706f 7274 616e 6365 5f77 6569 6768 742c  portance_weight,
+0001e260: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001e270: 2020 2020 2073 7461 7465 5f6d 6172 6769       state_margi
+0001e280: 6e61 6c5f 696d 706f 7274 616e 6365 5f77  nal_importance_w
+0001e290: 6569 6768 742c 0a20 2020 2020 2020 2020  eight,.         
+0001e2a0: 2020 2020 2020 2020 2020 206f 6e5f 706f             on_po
+0001e2b0: 6c69 6379 5f70 6f6c 6963 795f 7661 6c75  licy_policy_valu
+0001e2c0: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+0001e2d0: 2020 2020 2020 2067 616d 6d61 2c0a 2020         gamma,.  
+0001e2e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e2f0: 2020 6265 6861 7669 6f72 5f70 6f6c 6963    behavior_polic
+0001e300: 792c 0a20 2020 2020 2020 2020 2020 2020  y,.             
+0001e310: 2020 2020 2020 2065 7661 6c75 6174 696f         evaluatio
+0001e320: 6e5f 706f 6c69 6379 2c0a 2020 2020 2020  n_policy,.      
+0001e330: 2020 2020 2020 2020 2020 2020 2020 6461                da
+0001e340: 7461 7365 745f 6964 2c0a 2020 2020 2020  taset_id,.      
+0001e350: 2020 2020 2020 2020 2020 5d0a 0a20 2020            ]..   
+0001e360: 2020 2020 2020 2020 202e 2e20 7365 6561           .. seea
+0001e370: 6c73 6f3a 3a0a 0a20 2020 2020 2020 2020  lso::..         
+0001e380: 2020 2020 2020 203a 636c 6173 733a 6073         :class:`s
+0001e390: 636f 7065 5f72 6c2e 6f70 652e 696e 7075  cope_rl.ope.inpu
+0001e3a0: 742e 4372 6561 7465 4f50 4549 6e70 7574  t.CreateOPEInput
+0001e3b0: 6020 6465 7363 7269 6265 7320 7468 6520  ` describes the 
+0001e3c0: 636f 6d70 6f6e 656e 7473 206f 6620 3a63  components of :c
+0001e3d0: 6c61 7373 3a60 696e 7075 745f 6469 6374  lass:`input_dict
+0001e3e0: 602e 0a0a 2020 2020 2020 2020 636f 6d70  `...        comp
+0001e3f0: 6172 6564 5f65 7374 696d 6174 6f72 733a  ared_estimators:
+0001e400: 206c 6973 7420 6f66 2073 7472 2c20 6465   list of str, de
+0001e410: 6661 756c 743d 4e6f 6e65 0a20 2020 2020  fault=None.     
+0001e420: 2020 2020 2020 204e 616d 6520 6f66 2063         Name of c
+0001e430: 6f6d 7061 7265 6420 6573 7469 6d61 746f  ompared estimato
+0001e440: 7273 2e0a 2020 2020 2020 2020 2020 2020  rs..            
+0001e450: 4966 2060 4e6f 6e65 6020 6973 2067 6976  If `None` is giv
+0001e460: 656e 2c20 616c 6c20 7468 6520 6573 7469  en, all the esti
+0001e470: 6d61 746f 7273 2061 7265 2063 6f6d 7061  mators are compa
+0001e480: 7265 642e 0a0a 2020 2020 2020 2020 5265  red...        Re
+0001e490: 7475 726e 0a20 2020 2020 2020 202d 2d2d  turn.        ---
+0001e4a0: 2d2d 2d2d 0a20 2020 2020 2020 2076 6172  ----.        var
+0001e4b0: 6961 6e63 655f 6469 6374 3a20 6469 6374  iance_dict: dict
+0001e4c0: 0a20 2020 2020 2020 2020 2020 2044 6963  .            Dic
+0001e4d0: 7469 6f6e 6172 7920 636f 6e74 6169 6e69  tionary containi
+0001e4e0: 6e67 2074 6865 2076 6172 6961 6e63 6520  ng the variance 
+0001e4f0: 6f66 2074 7261 6a65 6374 6f72 792d 7769  of trajectory-wi
+0001e500: 7365 2072 6577 6172 6420 6f66 2065 6163  se reward of eac
+0001e510: 6820 6576 616c 7561 7469 6f6e 2070 6f6c  h evaluation pol
+0001e520: 6963 7920 6573 7469 6d61 7465 6420 6279  icy estimated by
+0001e530: 204f 5045 2065 7374 696d 6174 6f72 732e   OPE estimators.
+0001e540: 0a20 2020 2020 2020 2020 2020 206b 6579  .            key
+0001e550: 3a20 3a63 6c61 7373 3a60 5b65 7661 6c75  : :class:`[evalu
+0001e560: 6174 696f 6e5f 706f 6c69 6379 5d5b 4f50  ation_policy][OP
+0001e570: 455f 6573 7469 6d61 746f 725f 6e61 6d65  E_estimator_name
+0001e580: 5d60 0a0a 2020 2020 2020 2020 2222 220a  ]`..        """.
+0001e590: 2020 2020 2020 2020 6368 6563 6b5f 696e          check_in
+0001e5a0: 7075 745f 6469 6374 2869 6e70 7574 5f64  put_dict(input_d
+0001e5b0: 6963 7429 0a0a 2020 2020 2020 2020 7661  ict)..        va
+0001e5c0: 7269 616e 6365 5f64 6963 7420 3d20 6465  riance_dict = de
+0001e5d0: 6661 756c 7464 6963 7428 6469 6374 290a  faultdict(dict).
+0001e5e0: 2020 2020 2020 2020 7265 7761 7264 5f73          reward_s
+0001e5f0: 6361 6c65 203d 2073 656c 662e 6f62 7461  cale = self.obta
+0001e600: 696e 5f72 6577 6172 645f 7363 616c 6528  in_reward_scale(
+0001e610: 290a 0a20 2020 2020 2020 2066 6f72 2065  )..        for e
+0001e620: 7661 6c5f 706f 6c69 6379 2069 6e20 696e  val_policy in in
+0001e630: 7075 745f 6469 6374 2e6b 6579 7328 293a  put_dict.keys():
+0001e640: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0001e650: 696e 7075 745f 6469 6374 5b65 7661 6c5f  input_dict[eval_
+0001e660: 706f 6c69 6379 5d5b 226f 6e5f 706f 6c69  policy]["on_poli
+0001e670: 6379 5f70 6f6c 6963 795f 7661 6c75 6522  cy_policy_value"
+0001e680: 5d20 6973 206e 6f74 204e 6f6e 653a 0a20  ] is not None:. 
+0001e690: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+0001e6a0: 656e 7369 7479 203d 206e 702e 6869 7374  ensity = np.hist
+0001e6b0: 6f67 7261 6d28 0a20 2020 2020 2020 2020  ogram(.         
+0001e6c0: 2020 2020 2020 2020 2020 2069 6e70 7574             input
+0001e6d0: 5f64 6963 745b 6576 616c 5f70 6f6c 6963  _dict[eval_polic
+0001e6e0: 795d 5b22 6f6e 5f70 6f6c 6963 795f 706f  y]["on_policy_po
+0001e6f0: 6c69 6379 5f76 616c 7565 225d 2c0a 2020  licy_value"],.  
+0001e700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e710: 2020 6269 6e73 3d72 6577 6172 645f 7363    bins=reward_sc
+0001e720: 616c 652c 0a20 2020 2020 2020 2020 2020  ale,.           
+0001e730: 2020 2020 2020 2020 2064 656e 7369 7479           density
+0001e740: 3d54 7275 652c 0a20 2020 2020 2020 2020  =True,.         
+0001e750: 2020 2020 2020 2029 5b30 5d0a 2020 2020         )[0].    
+0001e760: 2020 2020 2020 2020 2020 2020 7072 6f62              prob
+0001e770: 6162 696c 6974 795f 6465 6e73 6974 795f  ability_density_
+0001e780: 6675 6e63 7469 6f6e 203d 2064 656e 7369  function = densi
+0001e790: 7479 202a 206e 702e 6469 6666 2872 6577  ty * np.diff(rew
+0001e7a0: 6172 645f 7363 616c 6529 0a20 2020 2020  ard_scale).     
+0001e7b0: 2020 2020 2020 2020 2020 206d 6561 6e20             mean 
+0001e7c0: 3d20 2870 726f 6261 6269 6c69 7479 5f64  = (probability_d
+0001e7d0: 656e 7369 7479 5f66 756e 6374 696f 6e20  ensity_function 
+0001e7e0: 2a20 7265 7761 7264 5f73 6361 6c65 5b31  * reward_scale[1
+0001e7f0: 3a5d 292e 7375 6d28 290a 2020 2020 2020  :]).sum().      
+0001e800: 2020 2020 2020 2020 2020 7661 7269 616e            varian
+0001e810: 6365 5f64 6963 745b 6576 616c 5f70 6f6c  ce_dict[eval_pol
+0001e820: 6963 795d 5b22 6f6e 5f70 6f6c 6963 7922  icy]["on_policy"
+0001e830: 5d20 3d20 280a 2020 2020 2020 2020 2020  ] = (.          
+0001e840: 2020 2020 2020 2020 2020 7072 6f62 6162            probab
+0001e850: 696c 6974 795f 6465 6e73 6974 795f 6675  ility_density_fu
+0001e860: 6e63 7469 6f6e 202a 2028 7265 7761 7264  nction * (reward
+0001e870: 5f73 6361 6c65 5b31 3a5d 202d 206d 6561  _scale[1:] - mea
+0001e880: 6e29 202a 2a20 320a 2020 2020 2020 2020  n) ** 2.        
+0001e890: 2020 2020 2020 2020 292e 7375 6d28 290a          ).sum().
+0001e8a0: 2020 2020 2020 2020 2020 2020 656c 7365              else
+0001e8b0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0001e8c0: 2020 7661 7269 616e 6365 5f64 6963 745b    variance_dict[
+0001e8d0: 6576 616c 5f70 6f6c 6963 795d 5b22 6f6e  eval_policy]["on
+0001e8e0: 5f70 6f6c 6963 7922 5d20 3d20 4e6f 6e65  _policy"] = None
+0001e8f0: 0a0a 2020 2020 2020 2020 2020 2020 666f  ..            fo
+0001e900: 7220 6573 7469 6d61 746f 725f 6e61 6d65  r estimator_name
+0001e910: 2069 6e20 636f 6d70 6172 6564 5f65 7374   in compared_est
+0001e920: 696d 6174 6f72 733a 0a20 2020 2020 2020  imators:.       
+0001e930: 2020 2020 2020 2020 2065 7374 696d 6174           estimat
+0001e940: 6f72 203d 2073 656c 662e 6f70 655f 6573  or = self.ope_es
+0001e950: 7469 6d61 746f 7273 5f5b 6573 7469 6d61  timators_[estima
+0001e960: 746f 725f 6e61 6d65 5d0a 2020 2020 2020  tor_name].      
+0001e970: 2020 2020 2020 2020 2020 7661 7269 616e            varian
+0001e980: 6365 5f64 6963 745b 6576 616c 5f70 6f6c  ce_dict[eval_pol
+0001e990: 6963 795d 5b0a 2020 2020 2020 2020 2020  icy][.          
+0001e9a0: 2020 2020 2020 2020 2020 6573 7469 6d61            estima
+0001e9b0: 746f 725f 6e61 6d65 0a20 2020 2020 2020  tor_name.       
+0001e9c0: 2020 2020 2020 2020 205d 203d 2065 7374           ] = est
+0001e9d0: 696d 6174 6f72 2e65 7374 696d 6174 655f  imator.estimate_
+0001e9e0: 7661 7269 616e 6365 280a 2020 2020 2020  variance(.      
+0001e9f0: 2020 2020 2020 2020 2020 2020 2020 2a2a                **
+0001ea00: 696e 7075 745f 6469 6374 5b65 7661 6c5f  input_dict[eval_
+0001ea10: 706f 6c69 6379 5d2c 0a20 2020 2020 2020  policy],.       
+0001ea20: 2020 2020 2020 2020 2020 2020 202a 2a73               **s
+0001ea30: 656c 662e 696e 7075 745f 6469 6374 5f2c  elf.input_dict_,
+0001ea40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001ea50: 2020 2020 2072 6577 6172 645f 7363 616c       reward_scal
+0001ea60: 653d 7265 7761 7264 5f73 6361 6c65 2c0a  e=reward_scale,.
+0001ea70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ea80: 290a 0a20 2020 2020 2020 2072 6574 7572  )..        retur
+0001ea90: 6e20 6465 6661 756c 7464 6963 745f 746f  n defaultdict_to
+0001eaa0: 5f64 6963 7428 7661 7269 616e 6365 5f64  _dict(variance_d
+0001eab0: 6963 7429 0a0a 2020 2020 6465 6620 5f65  ict)..    def _e
+0001eac0: 7374 696d 6174 655f 636f 6e64 6974 696f  stimate_conditio
+0001ead0: 6e61 6c5f 7661 6c75 655f 6174 5f72 6973  nal_value_at_ris
+0001eae0: 6b28 0a20 2020 2020 2020 2073 656c 662c  k(.        self,
+0001eaf0: 0a20 2020 2020 2020 2069 6e70 7574 5f64  .        input_d
+0001eb00: 6963 743a 204f 5045 496e 7075 7444 6963  ict: OPEInputDic
+0001eb10: 742c 0a20 2020 2020 2020 2063 6f6d 7061  t,.        compa
+0001eb20: 7265 645f 6573 7469 6d61 746f 7273 3a20  red_estimators: 
+0001eb30: 4f70 7469 6f6e 616c 5b4c 6973 745b 7374  Optional[List[st
+0001eb40: 725d 5d20 3d20 4e6f 6e65 2c0a 2020 2020  r]] = None,.    
+0001eb50: 2020 2020 616c 7068 6173 3a20 4f70 7469      alphas: Opti
+0001eb60: 6f6e 616c 5b55 6e69 6f6e 5b6e 702e 6e64  onal[Union[np.nd
+0001eb70: 6172 7261 792c 2066 6c6f 6174 5d5d 203d  array, float]] =
+0001eb80: 204e 6f6e 652c 0a20 2020 2029 3a0a 2020   None,.    ):.  
+0001eb90: 2020 2020 2020 2222 2245 7374 696d 6174        """Estimat
+0001eba0: 6520 7468 6520 636f 6e64 6974 696f 6e61  e the conditiona
+0001ebb0: 6c20 7661 6c75 6520 6174 2072 6973 6b20  l value at risk 
+0001ebc0: 6f66 2074 6865 2074 7261 6a65 6374 6f72  of the trajector
+0001ebd0: 792d 7769 7365 2072 6577 6172 6420 756e  y-wise reward un
+0001ebe0: 6465 7220 7468 6520 6769 7665 6e20 6576  der the given ev
+0001ebf0: 616c 7561 7469 6f6e 2070 6f6c 6963 6965  aluation policie
+0001ec00: 732e 0a0a 2020 2020 2020 2020 5061 7261  s...        Para
+0001ec10: 6d65 7465 7273 0a20 2020 2020 2020 202d  meters.        -
+0001ec20: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2069  ------.        i
+0001ec30: 6e70 7574 5f64 6963 743a 204f 5045 496e  nput_dict: OPEIn
+0001ec40: 7075 7444 6963 740a 2020 2020 2020 2020  putDict.        
+0001ec50: 2020 2020 4469 6374 696f 6e61 7279 206f      Dictionary o
+0001ec60: 6620 7468 6520 4f50 4520 696e 7075 7473  f the OPE inputs
+0001ec70: 2066 6f72 2065 6163 6820 6576 616c 7561   for each evalua
+0001ec80: 7469 6f6e 2070 6f6c 6963 792e 0a0a 2020  tion policy...  
+0001ec90: 2020 2020 2020 2020 2020 2e2e 2063 6f64            .. cod
+0001eca0: 652d 626c 6f63 6b3a 3a20 7079 7468 6f6e  e-block:: python
+0001ecb0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001ecc0: 2020 6b65 793a 205b 6576 616c 7561 7469    key: [evaluati
+0001ecd0: 6f6e 5f70 6f6c 6963 795d 5b0a 2020 2020  on_policy][.    
+0001ece0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ecf0: 6576 616c 7561 7469 6f6e 5f70 6f6c 6963  evaluation_polic
+0001ed00: 795f 6163 7469 6f6e 2c0a 2020 2020 2020  y_action,.      
+0001ed10: 2020 2020 2020 2020 2020 2020 2020 6576                ev
+0001ed20: 616c 7561 7469 6f6e 5f70 6f6c 6963 795f  aluation_policy_
+0001ed30: 6163 7469 6f6e 5f64 6973 742c 0a20 2020  action_dist,.   
+0001ed40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ed50: 2073 7461 7465 5f61 6374 696f 6e5f 7661   state_action_va
+0001ed60: 6c75 655f 7072 6564 6963 7469 6f6e 2c0a  lue_prediction,.
+0001ed70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ed80: 2020 2020 696e 6974 6961 6c5f 7374 6174      initial_stat
+0001ed90: 655f 7661 6c75 655f 7072 6564 6963 7469  e_value_predicti
+0001eda0: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
+0001edb0: 2020 2020 2020 2020 7374 6174 655f 6163          state_ac
+0001edc0: 7469 6f6e 5f6d 6172 6769 6e61 6c5f 696d  tion_marginal_im
+0001edd0: 706f 7274 616e 6365 5f77 6569 6768 742c  portance_weight,
+0001ede0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001edf0: 2020 2020 2073 7461 7465 5f6d 6172 6769       state_margi
+0001ee00: 6e61 6c5f 696d 706f 7274 616e 6365 5f77  nal_importance_w
+0001ee10: 6569 6768 742c 0a20 2020 2020 2020 2020  eight,.         
+0001ee20: 2020 2020 2020 2020 2020 206f 6e5f 706f             on_po
+0001ee30: 6c69 6379 5f70 6f6c 6963 795f 7661 6c75  licy_policy_valu
+0001ee40: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+0001ee50: 2020 2020 2020 2067 616d 6d61 2c0a 2020         gamma,.  
+0001ee60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ee70: 2020 6265 6861 7669 6f72 5f70 6f6c 6963    behavior_polic
+0001ee80: 792c 0a20 2020 2020 2020 2020 2020 2020  y,.             
+0001ee90: 2020 2020 2020 2065 7661 6c75 6174 696f         evaluatio
+0001eea0: 6e5f 706f 6c69 6379 2c0a 2020 2020 2020  n_policy,.      
+0001eeb0: 2020 2020 2020 2020 2020 2020 2020 6461                da
+0001eec0: 7461 7365 745f 6964 2c0a 2020 2020 2020  taset_id,.      
+0001eed0: 2020 2020 2020 2020 2020 5d0a 0a20 2020            ]..   
+0001eee0: 2020 2020 2020 2020 202e 2e20 7365 6561           .. seea
+0001eef0: 6c73 6f3a 3a0a 0a20 2020 2020 2020 2020  lso::..         
+0001ef00: 2020 2020 2020 203a 636c 6173 733a 6073         :class:`s
+0001ef10: 636f 7065 5f72 6c2e 6f70 652e 696e 7075  cope_rl.ope.inpu
+0001ef20: 742e 4372 6561 7465 4f50 4549 6e70 7574  t.CreateOPEInput
+0001ef30: 6020 6465 7363 7269 6265 7320 7468 6520  ` describes the 
+0001ef40: 636f 6d70 6f6e 656e 7473 206f 6620 3a63  components of :c
+0001ef50: 6c61 7373 3a60 696e 7075 745f 6469 6374  lass:`input_dict
+0001ef60: 602e 0a0a 2020 2020 2020 2020 636f 6d70  `...        comp
+0001ef70: 6172 6564 5f65 7374 696d 6174 6f72 733a  ared_estimators:
+0001ef80: 206c 6973 7420 6f66 2073 7472 2c20 6465   list of str, de
+0001ef90: 6661 756c 743d 4e6f 6e65 0a20 2020 2020  fault=None.     
+0001efa0: 2020 2020 2020 204e 616d 6520 6f66 2063         Name of c
+0001efb0: 6f6d 7061 7265 6420 6573 7469 6d61 746f  ompared estimato
+0001efc0: 7273 2e0a 2020 2020 2020 2020 2020 2020  rs..            
+0001efd0: 4966 2060 4e6f 6e65 6020 6973 2067 6976  If `None` is giv
+0001efe0: 656e 2c20 616c 6c20 7468 6520 6573 7469  en, all the esti
+0001eff0: 6d61 746f 7273 2061 7265 2063 6f6d 7061  mators are compa
+0001f000: 7265 642e 0a0a 2020 2020 2020 2020 616c  red...        al
+0001f010: 7068 6173 3a20 7b66 6c6f 6174 2c20 6172  phas: {float, ar
+0001f020: 7261 792d 6c69 6b65 206f 6620 7368 6170  ray-like of shap
+0001f030: 6520 286e 5f61 6c70 6861 2c20 297d 2c20  e (n_alpha, )}, 
+0001f040: 6465 6661 756c 743d 4e6f 6e65 0a20 2020  default=None.   
+0001f050: 2020 2020 2020 2020 2053 6574 206f 6620           Set of 
+0001f060: 7072 6f70 6f72 7469 6f6e 7320 6f66 2074  proportions of t
+0001f070: 6865 2073 6861 6465 6420 7265 6769 6f6e  he shaded region
+0001f080: 2e20 5468 6520 7661 6c75 6528 7329 2073  . The value(s) s
+0001f090: 686f 756c 6420 6265 2077 6974 6869 6e20  hould be within 
+0001f0a0: 605b 302c 2031 2960 2e0a 2020 2020 2020  `[0, 1)`..      
+0001f0b0: 2020 2020 2020 4966 2060 4e6f 6e65 6020        If `None` 
+0001f0c0: 6973 2067 6976 656e 2c20 3a63 6c61 7373  is given, :class
+0001f0d0: 3a60 6e70 2e6c 696e 7370 6163 6528 302c  :`np.linspace(0,
+0001f0e0: 2031 2c20 3231 2960 2077 696c 6c20 6265   1, 21)` will be
+0001f0f0: 2075 7365 642e 0a0a 2020 2020 2020 2020   used...        
+0001f100: 5265 7475 726e 0a20 2020 2020 2020 202d  Return.        -
+0001f110: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2063  ------.        c
+0001f120: 6f6e 6469 7469 6f6e 616c 5f76 616c 7565  onditional_value
+0001f130: 5f61 745f 7269 736b 5f64 6963 743a 2064  _at_risk_dict: d
+0001f140: 6963 740a 2020 2020 2020 2020 2020 2020  ict.            
+0001f150: 4469 6374 696f 6e61 7279 2063 6f6e 7461  Dictionary conta
+0001f160: 696e 696e 6720 7468 6520 636f 6e64 6974  ining the condit
+0001f170: 696f 6e61 6c20 7661 6c75 6520 6174 2072  ional value at r
+0001f180: 6973 6b20 6f66 2074 7261 6a65 6374 6f72  isk of trajector
+0001f190: 792d 7769 7365 2072 6577 6172 6420 6f66  y-wise reward of
+0001f1a0: 2065 6163 6820 6576 616c 7561 7469 6f6e   each evaluation
+0001f1b0: 2070 6f6c 6963 7920 6573 7469 6d61 7465   policy estimate
+0001f1c0: 6420 6279 204f 5045 2065 7374 696d 6174  d by OPE estimat
+0001f1d0: 6f72 732e 0a20 2020 2020 2020 2020 2020  ors..           
+0001f1e0: 206b 6579 3a20 3a63 6c61 7373 3a60 5b65   key: :class:`[e
+0001f1f0: 7661 6c75 6174 696f 6e5f 706f 6c69 6379  valuation_policy
+0001f200: 5d5b 4f50 455f 6573 7469 6d61 746f 725f  ][OPE_estimator_
+0001f210: 6e61 6d65 5d60 0a0a 2020 2020 2020 2020  name]`..        
+0001f220: 2222 220a 2020 2020 2020 2020 6368 6563  """.        chec
+0001f230: 6b5f 696e 7075 745f 6469 6374 2869 6e70  k_input_dict(inp
+0001f240: 7574 5f64 6963 7429 0a0a 2020 2020 2020  ut_dict)..      
+0001f250: 2020 636f 6e64 6974 696f 6e61 6c5f 7661    conditional_va
+0001f260: 6c75 655f 6174 5f72 6973 6b5f 6469 6374  lue_at_risk_dict
+0001f270: 203d 2064 6566 6175 6c74 6469 6374 2864   = defaultdict(d
+0001f280: 6963 7429 0a20 2020 2020 2020 2072 6577  ict).        rew
+0001f290: 6172 645f 7363 616c 6520 3d20 7365 6c66  ard_scale = self
+0001f2a0: 2e6f 6274 6169 6e5f 7265 7761 7264 5f73  .obtain_reward_s
+0001f2b0: 6361 6c65 2829 0a0a 2020 2020 2020 2020  cale()..        
+0001f2c0: 666f 7220 6576 616c 5f70 6f6c 6963 7920  for eval_policy 
+0001f2d0: 696e 2069 6e70 7574 5f64 6963 742e 6b65  in input_dict.ke
+0001f2e0: 7973 2829 3a0a 2020 2020 2020 2020 2020  ys():.          
+0001f2f0: 2020 6966 2069 6e70 7574 5f64 6963 745b    if input_dict[
+0001f300: 6576 616c 5f70 6f6c 6963 795d 5b22 6f6e  eval_policy]["on
+0001f310: 5f70 6f6c 6963 795f 706f 6c69 6379 5f76  _policy_policy_v
+0001f320: 616c 7565 225d 2069 7320 6e6f 7420 4e6f  alue"] is not No
+0001f330: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+0001f340: 2020 2020 6465 6e73 6974 7920 3d20 6e70      density = np
+0001f350: 2e68 6973 746f 6772 616d 280a 2020 2020  .histogram(.    
+0001f360: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f370: 696e 7075 745f 6469 6374 5b65 7661 6c5f  input_dict[eval_
+0001f380: 706f 6c69 6379 5d5b 226f 6e5f 706f 6c69  policy]["on_poli
+0001f390: 6379 5f70 6f6c 6963 795f 7661 6c75 6522  cy_policy_value"
+0001f3a0: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+0001f3b0: 2020 2020 2020 2062 696e 733d 7265 7761         bins=rewa
+0001f3c0: 7264 5f73 6361 6c65 2c0a 2020 2020 2020  rd_scale,.      
+0001f3d0: 2020 2020 2020 2020 2020 2020 2020 6465                de
+0001f3e0: 6e73 6974 793d 5472 7565 2c0a 2020 2020  nsity=True,.    
+0001f3f0: 2020 2020 2020 2020 2020 2020 295b 305d              )[0]
+0001f400: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001f410: 2070 726f 6261 6269 6c69 7479 5f64 656e   probability_den
+0001f420: 7369 7479 5f66 756e 6374 696f 6e20 3d20  sity_function = 
+0001f430: 6465 6e73 6974 7920 2a20 6e70 2e64 6966  density * np.dif
+0001f440: 6628 7265 7761 7264 5f73 6361 6c65 290a  f(reward_scale).
+0001f450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f460: 6375 6d75 6c61 7469 7665 5f64 6973 7472  cumulative_distr
+0001f470: 6962 7574 696f 6e5f 6675 6e63 7469 6f6e  ibution_function
+0001f480: 203d 206e 702e 696e 7365 7274 280a 2020   = np.insert(.  
+0001f490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f4a0: 2020 7072 6f62 6162 696c 6974 795f 6465    probability_de
+0001f4b0: 6e73 6974 795f 6675 6e63 7469 6f6e 2c20  nsity_function, 
+0001f4c0: 302c 2030 0a20 2020 2020 2020 2020 2020  0, 0.           
+0001f4d0: 2020 2020 2029 2e63 756d 7375 6d28 290a       ).cumsum().
+0001f4e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001f4f0: 2063 7661 7220 3d20 6e70 2e7a 6572 6f73   cvar = np.zeros
+0001f500: 5f6c 696b 6528 616c 7068 6173 290a 2020  _like(alphas).  
+0001f510: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+0001f520: 7220 692c 2061 6c70 6861 2069 6e20 656e  r i, alpha in en
+0001f530: 756d 6572 6174 6528 616c 7068 6173 293a  umerate(alphas):
+0001f540: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001f550: 2020 2020 2069 6478 5f20 3d20 6e70 2e6e       idx_ = np.n
+0001f560: 6f6e 7a65 726f 2863 756d 756c 6174 6976  onzero(cumulativ
+0001f570: 655f 6469 7374 7269 6275 7469 6f6e 5f66  e_distribution_f
+0001f580: 756e 6374 696f 6e5b 313a 5d20 3e20 616c  unction[1:] > al
+0001f590: 7068 6129 5b30 5d0a 2020 2020 2020 2020  pha)[0].        
+0001f5a0: 2020 2020 2020 2020 2020 2020 6966 206c              if l
+0001f5b0: 656e 2869 6478 5f29 203d 3d20 303a 0a20  en(idx_) == 0:. 
+0001f5c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f5d0: 2020 2020 2020 2063 7661 725b 695d 203d         cvar[i] =
+0001f5e0: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
+0001f5f0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+0001f600: 702e 6469 6666 2863 756d 756c 6174 6976  p.diff(cumulativ
+0001f610: 655f 6469 7374 7269 6275 7469 6f6e 5f66  e_distribution_f
+0001f620: 756e 6374 696f 6e29 202a 2072 6577 6172  unction) * rewar
+0001f630: 645f 7363 616c 655b 313a 5d0a 2020 2020  d_scale[1:].    
+0001f640: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f650: 2020 2020 292e 7375 6d28 2920 2f20 6375      ).sum() / cu
+0001f660: 6d75 6c61 7469 7665 5f64 6973 7472 6962  mulative_distrib
+0001f670: 7574 696f 6e5f 6675 6e63 7469 6f6e 5b2d  ution_function[-
+0001f680: 315d 0a20 2020 2020 2020 2020 2020 2020  1].             
+0001f690: 2020 2020 2020 2065 6c69 6620 6964 785f         elif idx_
+0001f6a0: 5b30 5d20 3d3d 2030 3a0a 2020 2020 2020  [0] == 0:.      
+0001f6b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f6c0: 2020 6376 6172 5b69 5d20 3d20 7265 7761    cvar[i] = rewa
+0001f6d0: 7264 5f73 6361 6c65 5b31 5d0a 2020 2020  rd_scale[1].    
+0001f6e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f6f0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0001f700: 2020 2020 2020 2020 2020 2020 2020 6c6f                lo
+0001f710: 7765 725f 6964 785f 203d 2069 6478 5f5b  wer_idx_ = idx_[
+0001f720: 305d 0a20 2020 2020 2020 2020 2020 2020  0].             
+0001f730: 2020 2020 2020 2020 2020 2072 656c 6174             relat
+0001f740: 6976 655f 7072 6f62 6162 696c 6974 795f  ive_probability_
+0001f750: 6465 6e73 6974 7920 3d20 280a 2020 2020  density = (.    
+0001f760: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f770: 2020 2020 2020 2020 6e70 2e64 6966 6628          np.diff(
+0001f780: 6375 6d75 6c61 7469 7665 5f64 6973 7472  cumulative_distr
+0001f790: 6962 7574 696f 6e5f 6675 6e63 7469 6f6e  ibution_function
+0001f7a0: 295b 3a20 6c6f 7765 725f 6964 785f 202b  )[: lower_idx_ +
+0001f7b0: 2031 5d0a 2020 2020 2020 2020 2020 2020   1].            
+0001f7c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f7d0: 2f20 6375 6d75 6c61 7469 7665 5f64 6973  / cumulative_dis
+0001f7e0: 7472 6962 7574 696f 6e5f 6675 6e63 7469  tribution_functi
+0001f7f0: 6f6e 5b6c 6f77 6572 5f69 6478 5f20 2b20  on[lower_idx_ + 
+0001f800: 315d 0a20 2020 2020 2020 2020 2020 2020  1].             
+0001f810: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+0001f820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f830: 2020 2020 2063 7661 725b 695d 203d 2028       cvar[i] = (
+0001f840: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001f850: 2020 2020 2020 2020 2020 2020 2072 656c               rel
+0001f860: 6174 6976 655f 7072 6f62 6162 696c 6974  ative_probabilit
+0001f870: 795f 6465 6e73 6974 790a 2020 2020 2020  y_density.      
+0001f880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f890: 2020 2020 2020 2a20 7265 7761 7264 5f73        * reward_s
+0001f8a0: 6361 6c65 5b31 203a 206c 6f77 6572 5f69  cale[1 : lower_i
+0001f8b0: 6478 5f20 2b20 325d 0a20 2020 2020 2020  dx_ + 2].       
+0001f8c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f8d0: 2029 2e73 756d 2829 0a0a 2020 2020 2020   ).sum()..      
+0001f8e0: 2020 2020 2020 2020 2020 636f 6e64 6974            condit
+0001f8f0: 696f 6e61 6c5f 7661 6c75 655f 6174 5f72  ional_value_at_r
+0001f900: 6973 6b5f 6469 6374 5b65 7661 6c5f 706f  isk_dict[eval_po
+0001f910: 6c69 6379 5d5b 226f 6e5f 706f 6c69 6379  licy]["on_policy
+0001f920: 225d 203d 2063 7661 720a 0a20 2020 2020  "] = cvar..     
+0001f930: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+0001f940: 2020 2020 2020 2020 2020 2020 2063 6f6e               con
+0001f950: 6469 7469 6f6e 616c 5f76 616c 7565 5f61  ditional_value_a
+0001f960: 745f 7269 736b 5f64 6963 745b 6576 616c  t_risk_dict[eval
+0001f970: 5f70 6f6c 6963 795d 5b22 6f6e 5f70 6f6c  _policy]["on_pol
+0001f980: 6963 7922 5d20 3d20 4e6f 6e65 0a0a 2020  icy"] = None..  
+0001f990: 2020 2020 2020 2020 2020 666f 7220 6573            for es
+0001f9a0: 7469 6d61 746f 725f 6e61 6d65 2069 6e20  timator_name in 
+0001f9b0: 636f 6d70 6172 6564 5f65 7374 696d 6174  compared_estimat
+0001f9c0: 6f72 733a 0a20 2020 2020 2020 2020 2020  ors:.           
+0001f9d0: 2020 2020 2065 7374 696d 6174 6f72 203d       estimator =
+0001f9e0: 2073 656c 662e 6f70 655f 6573 7469 6d61   self.ope_estima
+0001f9f0: 746f 7273 5f5b 6573 7469 6d61 746f 725f  tors_[estimator_
+0001fa00: 6e61 6d65 5d0a 2020 2020 2020 2020 2020  name].          
+0001fa10: 2020 2020 2020 636f 6e64 6974 696f 6e61        conditiona
+0001fa20: 6c5f 7661 6c75 655f 6174 5f72 6973 6b5f  l_value_at_risk_
+0001fa30: 6469 6374 5b65 7661 6c5f 706f 6c69 6379  dict[eval_policy
+0001fa40: 5d5b 0a20 2020 2020 2020 2020 2020 2020  ][.             
+0001fa50: 2020 2020 2020 2065 7374 696d 6174 6f72         estimator
+0001fa60: 5f6e 616d 650a 2020 2020 2020 2020 2020  _name.          
+0001fa70: 2020 2020 2020 5d20 3d20 6573 7469 6d61        ] = estima
+0001fa80: 746f 722e 6573 7469 6d61 7465 5f63 6f6e  tor.estimate_con
+0001fa90: 6469 7469 6f6e 616c 5f76 616c 7565 5f61  ditional_value_a
+0001faa0: 745f 7269 736b 280a 2020 2020 2020 2020  t_risk(.        
+0001fab0: 2020 2020 2020 2020 2020 2020 2a2a 696e              **in
+0001fac0: 7075 745f 6469 6374 5b65 7661 6c5f 706f  put_dict[eval_po
+0001fad0: 6c69 6379 5d2c 0a20 2020 2020 2020 2020  licy],.         
+0001fae0: 2020 2020 2020 2020 2020 202a 2a73 656c             **sel
+0001faf0: 662e 696e 7075 745f 6469 6374 5f2c 0a20  f.input_dict_,. 
+0001fb00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fb10: 2020 2072 6577 6172 645f 7363 616c 653d     reward_scale=
+0001fb20: 7265 7761 7264 5f73 6361 6c65 2c0a 2020  reward_scale,.  
+0001fb30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fb40: 2020 616c 7068 6173 3d61 6c70 6861 732c    alphas=alphas,
+0001fb50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001fb60: 2020 2020 2064 6973 6162 6c65 5f72 6577       disable_rew
+0001fb70: 6172 645f 6166 7465 725f 646f 6e65 3d73  ard_after_done=s
+0001fb80: 656c 662e 6469 7361 626c 655f 7265 7761  elf.disable_rewa
+0001fb90: 7264 5f61 6674 6572 5f64 6f6e 652c 0a20  rd_after_done,. 
+0001fba0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+0001fbb0: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+0001fbc0: 2064 6566 6175 6c74 6469 6374 5f74 6f5f   defaultdict_to_
+0001fbd0: 6469 6374 2863 6f6e 6469 7469 6f6e 616c  dict(conditional
+0001fbe0: 5f76 616c 7565 5f61 745f 7269 736b 5f64  _value_at_risk_d
+0001fbf0: 6963 7429 0a0a 2020 2020 6465 6620 5f65  ict)..    def _e
+0001fc00: 7374 696d 6174 655f 696e 7465 7271 7561  stimate_interqua
+0001fc10: 7274 696c 655f 7261 6e67 6528 0a20 2020  rtile_range(.   
+0001fc20: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+0001fc30: 2020 2069 6e70 7574 5f64 6963 743a 204f     input_dict: O
+0001fc40: 5045 496e 7075 7444 6963 742c 0a20 2020  PEInputDict,.   
+0001fc50: 2020 2020 2063 6f6d 7061 7265 645f 6573       compared_es
+0001fc60: 7469 6d61 746f 7273 3a20 4f70 7469 6f6e  timators: Option
+0001fc70: 616c 5b4c 6973 745b 7374 725d 5d20 3d20  al[List[str]] = 
+0001fc80: 4e6f 6e65 2c0a 2020 2020 2020 2020 616c  None,.        al
+0001fc90: 7068 613a 2066 6c6f 6174 203d 2030 2e30  pha: float = 0.0
+0001fca0: 352c 0a20 2020 2029 3a0a 2020 2020 2020  5,.    ):.      
+0001fcb0: 2020 2222 2245 7374 696d 6174 6520 7468    """Estimate th
+0001fcc0: 6520 696e 7465 7271 7561 7274 696c 6520  e interquartile 
+0001fcd0: 7261 6e67 6520 6f66 2074 6865 2074 7261  range of the tra
+0001fce0: 6a65 6374 6f72 792d 7769 7365 2072 6577  jectory-wise rew
+0001fcf0: 6172 6420 756e 6465 7220 7468 6520 6769  ard under the gi
+0001fd00: 7665 6e20 6576 616c 7561 7469 6f6e 2070  ven evaluation p
+0001fd10: 6f6c 6963 6965 732e 0a0a 2020 2020 2020  olicies...      
+0001fd20: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
+0001fd30: 2020 2020 202d 2d2d 2d2d 2d2d 0a20 2020       -------.   
+0001fd40: 2020 2020 2069 6e70 7574 5f64 6963 743a       input_dict:
+0001fd50: 204f 5045 496e 7075 7444 6963 740a 2020   OPEInputDict.  
+0001fd60: 2020 2020 2020 2020 2020 4469 6374 696f            Dictio
+0001fd70: 6e61 7279 206f 6620 7468 6520 4f50 4520  nary of the OPE 
+0001fd80: 696e 7075 7473 2066 6f72 2065 6163 6820  inputs for each 
+0001fd90: 6576 616c 7561 7469 6f6e 2070 6f6c 6963  evaluation polic
+0001fda0: 792e 0a0a 2020 2020 2020 2020 2020 2020  y...            
+0001fdb0: 2e2e 2063 6f64 652d 626c 6f63 6b3a 3a20  .. code-block:: 
+0001fdc0: 7079 7468 6f6e 0a0a 2020 2020 2020 2020  python..        
+0001fdd0: 2020 2020 2020 2020 6b65 793a 205b 6576          key: [ev
+0001fde0: 616c 7561 7469 6f6e 5f70 6f6c 6963 795d  aluation_policy]
+0001fdf0: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
+0001fe00: 2020 2020 2020 6576 616c 7561 7469 6f6e        evaluation
+0001fe10: 5f70 6f6c 6963 795f 6163 7469 6f6e 2c0a  _policy_action,.
+0001fe20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fe30: 2020 2020 6576 616c 7561 7469 6f6e 5f70      evaluation_p
+0001fe40: 6f6c 6963 795f 6163 7469 6f6e 5f64 6973  olicy_action_dis
+0001fe50: 742c 0a20 2020 2020 2020 2020 2020 2020  t,.             
+0001fe60: 2020 2020 2020 2073 7461 7465 5f61 6374         state_act
+0001fe70: 696f 6e5f 7661 6c75 655f 7072 6564 6963  ion_value_predic
+0001fe80: 7469 6f6e 2c0a 2020 2020 2020 2020 2020  tion,.          
+0001fe90: 2020 2020 2020 2020 2020 696e 6974 6961            initia
+0001fea0: 6c5f 7374 6174 655f 7661 6c75 655f 7072  l_state_value_pr
+0001feb0: 6564 6963 7469 6f6e 2c0a 2020 2020 2020  ediction,.      
+0001fec0: 2020 2020 2020 2020 2020 2020 2020 7374                st
+0001fed0: 6174 655f 6163 7469 6f6e 5f6d 6172 6769  ate_action_margi
+0001fee0: 6e61 6c5f 696d 706f 7274 616e 6365 5f77  nal_importance_w
+0001fef0: 6569 6768 742c 0a20 2020 2020 2020 2020  eight,.         
+0001ff00: 2020 2020 2020 2020 2020 2073 7461 7465             state
+0001ff10: 5f6d 6172 6769 6e61 6c5f 696d 706f 7274  _marginal_import
+0001ff20: 616e 6365 5f77 6569 6768 742c 0a20 2020  ance_weight,.   
+0001ff30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ff40: 206f 6e5f 706f 6c69 6379 5f70 6f6c 6963   on_policy_polic
+0001ff50: 795f 7661 6c75 652c 0a20 2020 2020 2020  y_value,.       
+0001ff60: 2020 2020 2020 2020 2020 2020 2067 616d               gam
+0001ff70: 6d61 2c0a 2020 2020 2020 2020 2020 2020  ma,.            
+0001ff80: 2020 2020 2020 2020 6265 6861 7669 6f72          behavior
+0001ff90: 5f70 6f6c 6963 792c 0a20 2020 2020 2020  _policy,.       
+0001ffa0: 2020 2020 2020 2020 2020 2020 2065 7661               eva
+0001ffb0: 6c75 6174 696f 6e5f 706f 6c69 6379 2c0a  luation_policy,.
+0001ffc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ffd0: 2020 2020 6461 7461 7365 745f 6964 2c0a      dataset_id,.
+0001ffe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fff0: 5d0a 0a20 2020 2020 2020 2020 2020 202e  ]..            .
+00020000: 2e20 7365 6561 6c73 6f3a 3a0a 0a20 2020  . seealso::..   
+00020010: 2020 2020 2020 2020 2020 2020 203a 636c               :cl
+00020020: 6173 733a 6073 636f 7065 5f72 6c2e 6f70  ass:`scope_rl.op
+00020030: 652e 696e 7075 742e 4372 6561 7465 4f50  e.input.CreateOP
+00020040: 4549 6e70 7574 6020 6465 7363 7269 6265  EInput` describe
+00020050: 7320 7468 6520 636f 6d70 6f6e 656e 7473  s the components
+00020060: 206f 6620 3a63 6c61 7373 3a60 696e 7075   of :class:`inpu
+00020070: 745f 6469 6374 602e 0a0a 2020 2020 2020  t_dict`...      
+00020080: 2020 636f 6d70 6172 6564 5f65 7374 696d    compared_estim
+00020090: 6174 6f72 733a 206c 6973 7420 6f66 2073  ators: list of s
+000200a0: 7472 2c20 6465 6661 756c 743d 4e6f 6e65  tr, default=None
+000200b0: 0a20 2020 2020 2020 2020 2020 204e 616d  .            Nam
+000200c0: 6520 6f66 2063 6f6d 7061 7265 6420 6573  e of compared es
+000200d0: 7469 6d61 746f 7273 2e0a 2020 2020 2020  timators..      
+000200e0: 2020 2020 2020 4966 2060 4e6f 6e65 6020        If `None` 
+000200f0: 6973 2067 6976 656e 2c20 616c 6c20 7468  is given, all th
+00020100: 6520 6573 7469 6d61 746f 7273 2061 7265  e estimators are
+00020110: 2063 6f6d 7061 7265 642e 0a0a 2020 2020   compared...    
+00020120: 2020 2020 616c 7068 613a 2066 6c6f 6174      alpha: float
+00020130: 2c20 6465 6661 756c 743d 302e 3035 0a20  , default=0.05. 
+00020140: 2020 2020 2020 2020 2020 2050 726f 706f             Propo
+00020150: 7274 696f 6e20 6f66 2074 6865 2073 6861  rtion of the sha
+00020160: 6465 6420 7265 6769 6f6e 2e20 5468 6520  ded region. The 
+00020170: 7661 6c75 6520 7368 6f75 6c64 2062 6520  value should be 
+00020180: 7769 7468 696e 2028 302c 2031 5d2e 0a0a  within (0, 1]...
+00020190: 2020 2020 2020 2020 5265 7475 726e 0a20          Return. 
+000201a0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0a20         -------. 
+000201b0: 2020 2020 2020 2069 6e74 6572 7175 6172         interquar
+000201c0: 7469 6c65 5f72 616e 6765 5f64 6963 743a  tile_range_dict:
+000201d0: 2064 6963 740a 2020 2020 2020 2020 2020   dict.          
+000201e0: 2020 4469 6374 696f 6e61 7279 2063 6f6e    Dictionary con
+000201f0: 7461 696e 696e 6720 7468 6520 696e 7465  taining the inte
+00020200: 7271 7561 7274 696c 6520 7261 6e67 6520  rquartile range 
+00020210: 6f66 2074 7261 6a65 6374 6f72 792d 7769  of trajectory-wi
+00020220: 7365 2072 6577 6172 6420 6f66 2065 6163  se reward of eac
+00020230: 6820 6576 616c 7561 7469 6f6e 2070 6f6c  h evaluation pol
+00020240: 6963 7920 6573 7469 6d61 7465 6420 6279  icy estimated by
+00020250: 204f 5045 2065 7374 696d 6174 6f72 732e   OPE estimators.
+00020260: 0a20 2020 2020 2020 2020 2020 206b 6579  .            key
+00020270: 3a20 3a63 6c61 7373 3a60 5b65 7661 6c75  : :class:`[evalu
+00020280: 6174 696f 6e5f 706f 6c69 6379 5d5b 4f50  ation_policy][OP
+00020290: 455f 6573 7469 6d61 746f 725f 6e61 6d65  E_estimator_name
+000202a0: 5d5b 7175 6172 7469 6c65 5f6e 616d 655d  ][quartile_name]
+000202b0: 600a 0a20 2020 2020 2020 2022 2222 0a20  `..        """. 
+000202c0: 2020 2020 2020 2063 6865 636b 5f69 6e70         check_inp
+000202d0: 7574 5f64 6963 7428 696e 7075 745f 6469  ut_dict(input_di
+000202e0: 6374 290a 0a20 2020 2020 2020 2069 6e74  ct)..        int
+000202f0: 6572 7175 6172 7469 6c65 5f72 616e 6765  erquartile_range
+00020300: 5f64 6963 7420 3d20 6465 6661 756c 7464  _dict = defaultd
+00020310: 6963 7428 6469 6374 290a 2020 2020 2020  ict(dict).      
+00020320: 2020 7265 7761 7264 5f73 6361 6c65 203d    reward_scale =
+00020330: 2073 656c 662e 6f62 7461 696e 5f72 6577   self.obtain_rew
+00020340: 6172 645f 7363 616c 6528 290a 0a20 2020  ard_scale()..   
+00020350: 2020 2020 2066 6f72 2065 7661 6c5f 706f       for eval_po
+00020360: 6c69 6379 2069 6e20 696e 7075 745f 6469  licy in input_di
+00020370: 6374 2e6b 6579 7328 293a 0a20 2020 2020  ct.keys():.     
+00020380: 2020 2020 2020 2069 6620 696e 7075 745f         if input_
+00020390: 6469 6374 5b65 7661 6c5f 706f 6c69 6379  dict[eval_policy
+000203a0: 5d5b 226f 6e5f 706f 6c69 6379 5f70 6f6c  ]["on_policy_pol
+000203b0: 6963 795f 7661 6c75 6522 5d20 6973 206e  icy_value"] is n
+000203c0: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
+000203d0: 2020 2020 2020 2020 2064 656e 7369 7479           density
+000203e0: 203d 206e 702e 6869 7374 6f67 7261 6d28   = np.histogram(
+000203f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00020400: 2020 2020 2069 6e70 7574 5f64 6963 745b       input_dict[
+00020410: 6576 616c 5f70 6f6c 6963 795d 5b22 6f6e  eval_policy]["on
+00020420: 5f70 6f6c 6963 795f 706f 6c69 6379 5f76  _policy_policy_v
+00020430: 616c 7565 225d 2c0a 2020 2020 2020 2020  alue"],.        
+00020440: 2020 2020 2020 2020 2020 2020 6269 6e73              bins
+00020450: 3d72 6577 6172 645f 7363 616c 652c 0a20  =reward_scale,. 
+00020460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020470: 2020 2064 656e 7369 7479 3d54 7275 652c     density=True,
+00020480: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00020490: 2029 5b30 5d0a 2020 2020 2020 2020 2020   )[0].          
+000204a0: 2020 2020 2020 7072 6f62 6162 696c 6974        probabilit
+000204b0: 795f 6465 6e73 6974 795f 6675 6e63 7469  y_density_functi
+000204c0: 6f6e 203d 2064 656e 7369 7479 202a 206e  on = density * n
+000204d0: 702e 6469 6666 2872 6577 6172 645f 7363  p.diff(reward_sc
+000204e0: 616c 6529 0a0a 2020 2020 2020 2020 2020  ale)..          
+000204f0: 2020 2020 2020 6c6f 7765 725f 6964 785f        lower_idx_
+00020500: 203d 206e 702e 6e6f 6e7a 6572 6f28 7072   = np.nonzero(pr
+00020510: 6f62 6162 696c 6974 795f 6465 6e73 6974  obability_densit
+00020520: 795f 6675 6e63 7469 6f6e 2e63 756d 7375  y_function.cumsu
+00020530: 6d28 2920 3e20 616c 7068 6129 5b0a 2020  m() > alpha)[.  
+00020540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020550: 2020 300a 2020 2020 2020 2020 2020 2020    0.            
+00020560: 2020 2020 5d0a 2020 2020 2020 2020 2020      ].          
+00020570: 2020 2020 2020 6d65 6469 616e 5f69 6478        median_idx
+00020580: 5f20 3d20 6e70 2e6e 6f6e 7a65 726f 2870  _ = np.nonzero(p
+00020590: 726f 6261 6269 6c69 7479 5f64 656e 7369  robability_densi
+000205a0: 7479 5f66 756e 6374 696f 6e2e 6375 6d73  ty_function.cums
+000205b0: 756d 2829 203e 2030 2e35 295b 305d 0a20  um() > 0.5)[0]. 
+000205c0: 2020 2020 2020 2020 2020 2020 2020 2075                 u
+000205d0: 7070 6572 5f69 6478 5f20 3d20 6e70 2e6e  pper_idx_ = np.n
+000205e0: 6f6e 7a65 726f 280a 2020 2020 2020 2020  onzero(.        
+000205f0: 2020 2020 2020 2020 2020 2020 7072 6f62              prob
+00020600: 6162 696c 6974 795f 6465 6e73 6974 795f  ability_density_
+00020610: 6675 6e63 7469 6f6e 2e63 756d 7375 6d28  function.cumsum(
+00020620: 2920 3e20 3120 2d20 616c 7068 610a 2020  ) > 1 - alpha.  
+00020630: 2020 2020 2020 2020 2020 2020 2020 295b                )[
+00020640: 305d 0a0a 2020 2020 2020 2020 2020 2020  0]..            
+00020650: 2020 2020 696e 7465 7271 7561 7274 696c      interquartil
+00020660: 655f 7261 6e67 655f 6469 6374 5b65 7661  e_range_dict[eva
+00020670: 6c5f 706f 6c69 6379 5d5b 226f 6e5f 706f  l_policy]["on_po
+00020680: 6c69 6379 225d 203d 207b 0a20 2020 2020  licy"] = {.     
+00020690: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+000206a0: 6d65 6469 616e 223a 2073 656c 662e 5f74  median": self._t
+000206b0: 6172 6765 745f 7661 6c75 655f 6769 7665  arget_value_give
+000206c0: 6e5f 6964 7828 0a20 2020 2020 2020 2020  n_idx(.         
+000206d0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+000206e0: 6564 6961 6e5f 6964 785f 2c20 7265 7761  edian_idx_, rewa
+000206f0: 7264 5f73 6361 6c65 3d72 6577 6172 645f  rd_scale=reward_
+00020700: 7363 616c 650a 2020 2020 2020 2020 2020  scale.          
+00020710: 2020 2020 2020 2020 2020 292c 0a20 2020            ),.   
+00020720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020730: 2066 227b 3130 3020 2a20 2831 2e20 2d20   f"{100 * (1. - 
+00020740: 616c 7068 6129 7d25 2071 7561 7274 696c  alpha)}% quartil
+00020750: 6520 286c 6f77 6572 2922 3a20 7365 6c66  e (lower)": self
+00020760: 2e5f 7461 7267 6574 5f76 616c 7565 5f67  ._target_value_g
+00020770: 6976 656e 5f69 6478 280a 2020 2020 2020  iven_idx(.      
+00020780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020790: 2020 6c6f 7765 725f 6964 785f 2c0a 2020    lower_idx_,.  
 000207a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000207b0: 2020 206d 6564 6961 6e5f 6964 785f 2c20     median_idx_, 
-000207c0: 7265 7761 7264 5f73 6361 6c65 3d72 6577  reward_scale=rew
-000207d0: 6172 645f 7363 616c 650a 2020 2020 2020  ard_scale.      
-000207e0: 2020 2020 2020 2020 2020 2020 2020 292c                ),
-000207f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00020800: 2020 2020 2066 227b 3130 3020 2a20 2831       f"{100 * (1
-00020810: 2e20 2d20 616c 7068 6129 7d25 2071 7561  . - alpha)}% qua
-00020820: 7274 696c 6520 286c 6f77 6572 2922 3a20  rtile (lower)": 
-00020830: 7365 6c66 2e5f 7461 7267 6574 5f76 616c  self._target_val
-00020840: 7565 5f67 6976 656e 5f69 6478 280a 2020  ue_given_idx(.  
-00020850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020860: 2020 2020 2020 6c6f 7765 725f 6964 785f        lower_idx_
-00020870: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00020880: 2020 2020 2020 2020 2020 7265 7761 7264            reward
-00020890: 5f73 6361 6c65 3d72 6577 6172 645f 7363  _scale=reward_sc
-000208a0: 616c 652c 0a20 2020 2020 2020 2020 2020  ale,.           
-000208b0: 2020 2020 2020 2020 2029 2c0a 2020 2020           ),.    
-000208c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000208d0: 6622 7b31 3030 202a 2028 312e 202d 2061  f"{100 * (1. - a
-000208e0: 6c70 6861 297d 2520 7175 6172 7469 6c65  lpha)}% quartile
-000208f0: 2028 7570 7065 7229 223a 2073 656c 662e   (upper)": self.
-00020900: 5f74 6172 6765 745f 7661 6c75 655f 6769  _target_value_gi
-00020910: 7665 6e5f 6964 7828 0a20 2020 2020 2020  ven_idx(.       
-00020920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020930: 2075 7070 6572 5f69 6478 5f2c 0a20 2020   upper_idx_,.   
-00020940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020950: 2020 2020 2072 6577 6172 645f 7363 616c       reward_scal
-00020960: 653d 7265 7761 7264 5f73 6361 6c65 2c0a  e=reward_scale,.
-00020970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020980: 2020 2020 292c 0a20 2020 2020 2020 2020      ),.         
-00020990: 2020 2020 2020 207d 0a0a 2020 2020 2020         }..      
-000209a0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-000209b0: 2020 2020 2020 2020 2020 2020 696e 7465              inte
-000209c0: 7271 7561 7274 696c 655f 7261 6e67 655f  rquartile_range_
-000209d0: 6469 6374 5b65 7661 6c5f 706f 6c69 6379  dict[eval_policy
-000209e0: 5d5b 226f 6e5f 706f 6c69 6379 225d 203d  ]["on_policy"] =
-000209f0: 204e 6f6e 650a 0a20 2020 2020 2020 2020   None..         
-00020a00: 2020 2066 6f72 2065 7374 696d 6174 6f72     for estimator
-00020a10: 5f6e 616d 6520 696e 2063 6f6d 7061 7265  _name in compare
-00020a20: 645f 6573 7469 6d61 746f 7273 3a0a 2020  d_estimators:.  
-00020a30: 2020 2020 2020 2020 2020 2020 2020 6573                es
-00020a40: 7469 6d61 746f 7220 3d20 7365 6c66 2e6f  timator = self.o
-00020a50: 7065 5f65 7374 696d 6174 6f72 735f 5b65  pe_estimators_[e
-00020a60: 7374 696d 6174 6f72 5f6e 616d 655d 0a20  stimator_name]. 
-00020a70: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00020a80: 6e74 6572 7175 6172 7469 6c65 5f72 616e  nterquartile_ran
-00020a90: 6765 5f64 6963 745b 6576 616c 5f70 6f6c  ge_dict[eval_pol
-00020aa0: 6963 795d 5b0a 2020 2020 2020 2020 2020  icy][.          
-00020ab0: 2020 2020 2020 2020 2020 6573 7469 6d61            estima
-00020ac0: 746f 725f 6e61 6d65 0a20 2020 2020 2020  tor_name.       
-00020ad0: 2020 2020 2020 2020 205d 203d 2065 7374           ] = est
-00020ae0: 696d 6174 6f72 2e65 7374 696d 6174 655f  imator.estimate_
-00020af0: 696e 7465 7271 7561 7274 696c 655f 7261  interquartile_ra
-00020b00: 6e67 6528 0a20 2020 2020 2020 2020 2020  nge(.           
-00020b10: 2020 2020 2020 2020 202a 2a69 6e70 7574           **input
-00020b20: 5f64 6963 745b 6576 616c 5f70 6f6c 6963  _dict[eval_polic
-00020b30: 795d 2c0a 2020 2020 2020 2020 2020 2020  y],.            
-00020b40: 2020 2020 2020 2020 2a2a 7365 6c66 2e69          **self.i
-00020b50: 6e70 7574 5f64 6963 745f 2c0a 2020 2020  nput_dict_,.    
-00020b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020b70: 7265 7761 7264 5f73 6361 6c65 3d72 6577  reward_scale=rew
-00020b80: 6172 645f 7363 616c 652c 0a20 2020 2020  ard_scale,.     
-00020b90: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-00020ba0: 6c70 6861 3d61 6c70 6861 2c0a 2020 2020  lpha=alpha,.    
-00020bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020bc0: 6469 7361 626c 655f 7265 7761 7264 5f61  disable_reward_a
-00020bd0: 6674 6572 5f64 6f6e 653d 7365 6c66 2e64  fter_done=self.d
-00020be0: 6973 6162 6c65 5f72 6577 6172 645f 6166  isable_reward_af
-00020bf0: 7465 725f 646f 6e65 2c0a 2020 2020 2020  ter_done,.      
-00020c00: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
-00020c10: 2020 2020 2072 6574 7572 6e20 6465 6661       return defa
-00020c20: 756c 7464 6963 745f 746f 5f64 6963 7428  ultdict_to_dict(
-00020c30: 696e 7465 7271 7561 7274 696c 655f 7261  interquartile_ra
-00020c40: 6e67 655f 6469 6374 290a 0a20 2020 2064  nge_dict)..    d
-00020c50: 6566 2065 7374 696d 6174 655f 6375 6d75  ef estimate_cumu
-00020c60: 6c61 7469 7665 5f64 6973 7472 6962 7574  lative_distribut
-00020c70: 696f 6e5f 6675 6e63 7469 6f6e 280a 2020  ion_function(.  
-00020c80: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
-00020c90: 2020 2020 696e 7075 745f 6469 6374 3a20      input_dict: 
-00020ca0: 556e 696f 6e5b 4f50 4549 6e70 7574 4469  Union[OPEInputDi
-00020cb0: 6374 2c20 4d75 6c74 6970 6c65 496e 7075  ct, MultipleInpu
-00020cc0: 7444 6963 745d 2c0a 2020 2020 2020 2020  tDict],.        
-00020cd0: 636f 6d70 6172 6564 5f65 7374 696d 6174  compared_estimat
-00020ce0: 6f72 733a 204f 7074 696f 6e61 6c5b 4c69  ors: Optional[Li
-00020cf0: 7374 5b73 7472 5d5d 203d 204e 6f6e 652c  st[str]] = None,
-00020d00: 0a20 2020 2020 2020 2062 6568 6176 696f  .        behavio
-00020d10: 725f 706f 6c69 6379 5f6e 616d 653a 204f  r_policy_name: O
-00020d20: 7074 696f 6e61 6c5b 7374 725d 203d 204e  ptional[str] = N
-00020d30: 6f6e 652c 0a20 2020 2020 2020 2064 6174  one,.        dat
-00020d40: 6173 6574 5f69 643a 204f 7074 696f 6e61  aset_id: Optiona
-00020d50: 6c5b 696e 745d 203d 204e 6f6e 652c 0a20  l[int] = None,. 
-00020d60: 2020 2020 2020 2072 6577 6172 645f 7363         reward_sc
-00020d70: 616c 653a 204f 7074 696f 6e61 6c5b 6e70  ale: Optional[np
-00020d80: 2e6e 6461 7272 6179 5d20 3d20 4e6f 6e65  .ndarray] = None
-00020d90: 2c0a 2020 2020 293a 0a20 2020 2020 2020  ,.    ):.       
-00020da0: 2022 2222 4573 7469 6d61 7465 2074 6865   """Estimate the
-00020db0: 2063 756d 756c 6174 6976 6520 6469 7374   cumulative dist
-00020dc0: 7269 6275 7469 6f6e 206f 6620 7468 6520  ribution of the 
-00020dd0: 7472 616a 6563 746f 7279 2d77 6973 6520  trajectory-wise 
-00020de0: 7265 7761 7264 2075 6e64 6572 2074 6865  reward under the
-00020df0: 2067 6976 656e 2065 7661 6c75 6174 696f   given evaluatio
-00020e00: 6e20 706f 6c69 6369 6573 2e0a 0a20 2020  n policies...   
-00020e10: 2020 2020 2050 6172 616d 6574 6572 730a       Parameters.
-00020e20: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0a          -------.
-00020e30: 2020 2020 2020 2020 696e 7075 745f 6469          input_di
-00020e40: 6374 3a20 4f50 4549 6e70 7574 4469 6374  ct: OPEInputDict
-00020e50: 206f 7220 4d75 6c74 6970 6c65 496e 7075   or MultipleInpu
-00020e60: 7444 6963 740a 2020 2020 2020 2020 2020  tDict.          
-00020e70: 2020 4469 6374 696f 6e61 7279 206f 6620    Dictionary of 
-00020e80: 7468 6520 4f50 4520 696e 7075 7473 2066  the OPE inputs f
-00020e90: 6f72 2065 6163 6820 6576 616c 7561 7469  or each evaluati
-00020ea0: 6f6e 2070 6f6c 6963 792e 0a0a 2020 2020  on policy...    
-00020eb0: 2020 2020 2020 2020 2e2e 2063 6f64 652d          .. code-
-00020ec0: 626c 6f63 6b3a 3a20 7079 7468 6f6e 0a0a  block:: python..
-00020ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020ee0: 6b65 793a 205b 6576 616c 7561 7469 6f6e  key: [evaluation
-00020ef0: 5f70 6f6c 6963 795d 5b0a 2020 2020 2020  _policy][.      
-00020f00: 2020 2020 2020 2020 2020 2020 2020 6576                ev
-00020f10: 616c 7561 7469 6f6e 5f70 6f6c 6963 795f  aluation_policy_
-00020f20: 6163 7469 6f6e 2c0a 2020 2020 2020 2020  action,.        
-00020f30: 2020 2020 2020 2020 2020 2020 6576 616c              eval
-00020f40: 7561 7469 6f6e 5f70 6f6c 6963 795f 6163  uation_policy_ac
-00020f50: 7469 6f6e 5f64 6973 742c 0a20 2020 2020  tion_dist,.     
-00020f60: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00020f70: 7461 7465 5f61 6374 696f 6e5f 7661 6c75  tate_action_valu
-00020f80: 655f 7072 6564 6963 7469 6f6e 2c0a 2020  e_prediction,.  
+000207b0: 2020 2020 2020 7265 7761 7264 5f73 6361        reward_sca
+000207c0: 6c65 3d72 6577 6172 645f 7363 616c 652c  le=reward_scale,
+000207d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000207e0: 2020 2020 2029 2c0a 2020 2020 2020 2020       ),.        
+000207f0: 2020 2020 2020 2020 2020 2020 6622 7b31              f"{1
+00020800: 3030 202a 2028 312e 202d 2061 6c70 6861  00 * (1. - alpha
+00020810: 297d 2520 7175 6172 7469 6c65 2028 7570  )}% quartile (up
+00020820: 7065 7229 223a 2073 656c 662e 5f74 6172  per)": self._tar
+00020830: 6765 745f 7661 6c75 655f 6769 7665 6e5f  get_value_given_
+00020840: 6964 7828 0a20 2020 2020 2020 2020 2020  idx(.           
+00020850: 2020 2020 2020 2020 2020 2020 2075 7070               upp
+00020860: 6572 5f69 6478 5f2c 0a20 2020 2020 2020  er_idx_,.       
+00020870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020880: 2072 6577 6172 645f 7363 616c 653d 7265   reward_scale=re
+00020890: 7761 7264 5f73 6361 6c65 2c0a 2020 2020  ward_scale,.    
+000208a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000208b0: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+000208c0: 2020 207d 0a0a 2020 2020 2020 2020 2020     }..          
+000208d0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+000208e0: 2020 2020 2020 2020 696e 7465 7271 7561          interqua
+000208f0: 7274 696c 655f 7261 6e67 655f 6469 6374  rtile_range_dict
+00020900: 5b65 7661 6c5f 706f 6c69 6379 5d5b 226f  [eval_policy]["o
+00020910: 6e5f 706f 6c69 6379 225d 203d 204e 6f6e  n_policy"] = Non
+00020920: 650a 0a20 2020 2020 2020 2020 2020 2066  e..            f
+00020930: 6f72 2065 7374 696d 6174 6f72 5f6e 616d  or estimator_nam
+00020940: 6520 696e 2063 6f6d 7061 7265 645f 6573  e in compared_es
+00020950: 7469 6d61 746f 7273 3a0a 2020 2020 2020  timators:.      
+00020960: 2020 2020 2020 2020 2020 6573 7469 6d61            estima
+00020970: 746f 7220 3d20 7365 6c66 2e6f 7065 5f65  tor = self.ope_e
+00020980: 7374 696d 6174 6f72 735f 5b65 7374 696d  stimators_[estim
+00020990: 6174 6f72 5f6e 616d 655d 0a20 2020 2020  ator_name].     
+000209a0: 2020 2020 2020 2020 2020 2069 6e74 6572             inter
+000209b0: 7175 6172 7469 6c65 5f72 616e 6765 5f64  quartile_range_d
+000209c0: 6963 745b 6576 616c 5f70 6f6c 6963 795d  ict[eval_policy]
+000209d0: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
+000209e0: 2020 2020 2020 6573 7469 6d61 746f 725f        estimator_
+000209f0: 6e61 6d65 0a20 2020 2020 2020 2020 2020  name.           
+00020a00: 2020 2020 205d 203d 2065 7374 696d 6174       ] = estimat
+00020a10: 6f72 2e65 7374 696d 6174 655f 696e 7465  or.estimate_inte
+00020a20: 7271 7561 7274 696c 655f 7261 6e67 6528  rquartile_range(
+00020a30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00020a40: 2020 2020 202a 2a69 6e70 7574 5f64 6963       **input_dic
+00020a50: 745b 6576 616c 5f70 6f6c 6963 795d 2c0a  t[eval_policy],.
+00020a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020a70: 2020 2020 2a2a 7365 6c66 2e69 6e70 7574      **self.input
+00020a80: 5f64 6963 745f 2c0a 2020 2020 2020 2020  _dict_,.        
+00020a90: 2020 2020 2020 2020 2020 2020 7265 7761              rewa
+00020aa0: 7264 5f73 6361 6c65 3d72 6577 6172 645f  rd_scale=reward_
+00020ab0: 7363 616c 652c 0a20 2020 2020 2020 2020  scale,.         
+00020ac0: 2020 2020 2020 2020 2020 2061 6c70 6861             alpha
+00020ad0: 3d61 6c70 6861 2c0a 2020 2020 2020 2020  =alpha,.        
+00020ae0: 2020 2020 2020 2020 2020 2020 6469 7361              disa
+00020af0: 626c 655f 7265 7761 7264 5f61 6674 6572  ble_reward_after
+00020b00: 5f64 6f6e 653d 7365 6c66 2e64 6973 6162  _done=self.disab
+00020b10: 6c65 5f72 6577 6172 645f 6166 7465 725f  le_reward_after_
+00020b20: 646f 6e65 2c0a 2020 2020 2020 2020 2020  done,.          
+00020b30: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+00020b40: 2072 6574 7572 6e20 6465 6661 756c 7464   return defaultd
+00020b50: 6963 745f 746f 5f64 6963 7428 696e 7465  ict_to_dict(inte
+00020b60: 7271 7561 7274 696c 655f 7261 6e67 655f  rquartile_range_
+00020b70: 6469 6374 290a 0a20 2020 2064 6566 2065  dict)..    def e
+00020b80: 7374 696d 6174 655f 6375 6d75 6c61 7469  stimate_cumulati
+00020b90: 7665 5f64 6973 7472 6962 7574 696f 6e5f  ve_distribution_
+00020ba0: 6675 6e63 7469 6f6e 280a 2020 2020 2020  function(.      
+00020bb0: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
+00020bc0: 696e 7075 745f 6469 6374 3a20 556e 696f  input_dict: Unio
+00020bd0: 6e5b 4f50 4549 6e70 7574 4469 6374 2c20  n[OPEInputDict, 
+00020be0: 4d75 6c74 6970 6c65 496e 7075 7444 6963  MultipleInputDic
+00020bf0: 745d 2c0a 2020 2020 2020 2020 636f 6d70  t],.        comp
+00020c00: 6172 6564 5f65 7374 696d 6174 6f72 733a  ared_estimators:
+00020c10: 204f 7074 696f 6e61 6c5b 4c69 7374 5b73   Optional[List[s
+00020c20: 7472 5d5d 203d 204e 6f6e 652c 0a20 2020  tr]] = None,.   
+00020c30: 2020 2020 2062 6568 6176 696f 725f 706f       behavior_po
+00020c40: 6c69 6379 5f6e 616d 653a 204f 7074 696f  licy_name: Optio
+00020c50: 6e61 6c5b 7374 725d 203d 204e 6f6e 652c  nal[str] = None,
+00020c60: 0a20 2020 2020 2020 2064 6174 6173 6574  .        dataset
+00020c70: 5f69 643a 204f 7074 696f 6e61 6c5b 696e  _id: Optional[in
+00020c80: 745d 203d 204e 6f6e 652c 0a20 2020 2020  t] = None,.     
+00020c90: 2020 2072 6577 6172 645f 7363 616c 653a     reward_scale:
+00020ca0: 204f 7074 696f 6e61 6c5b 6e70 2e6e 6461   Optional[np.nda
+00020cb0: 7272 6179 5d20 3d20 4e6f 6e65 2c0a 2020  rray] = None,.  
+00020cc0: 2020 293a 0a20 2020 2020 2020 2022 2222    ):.        """
+00020cd0: 4573 7469 6d61 7465 2074 6865 2063 756d  Estimate the cum
+00020ce0: 756c 6174 6976 6520 6469 7374 7269 6275  ulative distribu
+00020cf0: 7469 6f6e 206f 6620 7468 6520 7472 616a  tion of the traj
+00020d00: 6563 746f 7279 2d77 6973 6520 7265 7761  ectory-wise rewa
+00020d10: 7264 2075 6e64 6572 2074 6865 2067 6976  rd under the giv
+00020d20: 656e 2065 7661 6c75 6174 696f 6e20 706f  en evaluation po
+00020d30: 6c69 6369 6573 2e0a 0a20 2020 2020 2020  licies...       
+00020d40: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
+00020d50: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
+00020d60: 2020 2020 696e 7075 745f 6469 6374 3a20      input_dict: 
+00020d70: 4f50 4549 6e70 7574 4469 6374 206f 7220  OPEInputDict or 
+00020d80: 4d75 6c74 6970 6c65 496e 7075 7444 6963  MultipleInputDic
+00020d90: 740a 2020 2020 2020 2020 2020 2020 4469  t.            Di
+00020da0: 6374 696f 6e61 7279 206f 6620 7468 6520  ctionary of the 
+00020db0: 4f50 4520 696e 7075 7473 2066 6f72 2065  OPE inputs for e
+00020dc0: 6163 6820 6576 616c 7561 7469 6f6e 2070  ach evaluation p
+00020dd0: 6f6c 6963 792e 0a0a 2020 2020 2020 2020  olicy...        
+00020de0: 2020 2020 2e2e 2063 6f64 652d 626c 6f63      .. code-bloc
+00020df0: 6b3a 3a20 7079 7468 6f6e 0a0a 2020 2020  k:: python..    
+00020e00: 2020 2020 2020 2020 2020 2020 6b65 793a              key:
+00020e10: 205b 6576 616c 7561 7469 6f6e 5f70 6f6c   [evaluation_pol
+00020e20: 6963 795d 5b0a 2020 2020 2020 2020 2020  icy][.          
+00020e30: 2020 2020 2020 2020 2020 6576 616c 7561            evalua
+00020e40: 7469 6f6e 5f70 6f6c 6963 795f 6163 7469  tion_policy_acti
+00020e50: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
+00020e60: 2020 2020 2020 2020 6576 616c 7561 7469          evaluati
+00020e70: 6f6e 5f70 6f6c 6963 795f 6163 7469 6f6e  on_policy_action
+00020e80: 5f64 6973 742c 0a20 2020 2020 2020 2020  _dist,.         
+00020e90: 2020 2020 2020 2020 2020 2073 7461 7465             state
+00020ea0: 5f61 6374 696f 6e5f 7661 6c75 655f 7072  _action_value_pr
+00020eb0: 6564 6963 7469 6f6e 2c0a 2020 2020 2020  ediction,.      
+00020ec0: 2020 2020 2020 2020 2020 2020 2020 696e                in
+00020ed0: 6974 6961 6c5f 7374 6174 655f 7661 6c75  itial_state_valu
+00020ee0: 655f 7072 6564 6963 7469 6f6e 2c0a 2020  e_prediction,.  
+00020ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020f00: 2020 7374 6174 655f 6163 7469 6f6e 5f6d    state_action_m
+00020f10: 6172 6769 6e61 6c5f 696d 706f 7274 616e  arginal_importan
+00020f20: 6365 5f77 6569 6768 742c 0a20 2020 2020  ce_weight,.     
+00020f30: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00020f40: 7461 7465 5f6d 6172 6769 6e61 6c5f 696d  tate_marginal_im
+00020f50: 706f 7274 616e 6365 5f77 6569 6768 742c  portance_weight,
+00020f60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00020f70: 2020 2020 206f 6e5f 706f 6c69 6379 5f70       on_policy_p
+00020f80: 6f6c 6963 795f 7661 6c75 652c 0a20 2020  olicy_value,.   
 00020f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020fa0: 2020 696e 6974 6961 6c5f 7374 6174 655f    initial_state_
-00020fb0: 7661 6c75 655f 7072 6564 6963 7469 6f6e  value_prediction
-00020fc0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00020fd0: 2020 2020 2020 7374 6174 655f 6163 7469        state_acti
-00020fe0: 6f6e 5f6d 6172 6769 6e61 6c5f 696d 706f  on_marginal_impo
-00020ff0: 7274 616e 6365 5f77 6569 6768 742c 0a20  rtance_weight,. 
-00021000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021010: 2020 2073 7461 7465 5f6d 6172 6769 6e61     state_margina
-00021020: 6c5f 696d 706f 7274 616e 6365 5f77 6569  l_importance_wei
-00021030: 6768 742c 0a20 2020 2020 2020 2020 2020  ght,.           
-00021040: 2020 2020 2020 2020 206f 6e5f 706f 6c69           on_poli
-00021050: 6379 5f70 6f6c 6963 795f 7661 6c75 652c  cy_policy_value,
-00021060: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00021070: 2020 2020 2067 616d 6d61 2c0a 2020 2020       gamma,.    
-00021080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021090: 6265 6861 7669 6f72 5f70 6f6c 6963 792c  behavior_policy,
-000210a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000210b0: 2020 2020 2065 7661 6c75 6174 696f 6e5f       evaluation_
-000210c0: 706f 6c69 6379 2c0a 2020 2020 2020 2020  policy,.        
-000210d0: 2020 2020 2020 2020 2020 2020 6461 7461              data
-000210e0: 7365 745f 6964 2c0a 2020 2020 2020 2020  set_id,.        
-000210f0: 2020 2020 2020 2020 5d0a 0a20 2020 2020          ]..     
-00021100: 2020 2020 2020 202e 2e20 7365 6561 6c73         .. seeals
-00021110: 6f3a 3a0a 0a20 2020 2020 2020 2020 2020  o::..           
-00021120: 2020 2020 203a 636c 6173 733a 6073 636f       :class:`sco
-00021130: 7065 5f72 6c2e 6f70 652e 696e 7075 742e  pe_rl.ope.input.
-00021140: 4372 6561 7465 4f50 4549 6e70 7574 6020  CreateOPEInput` 
-00021150: 6465 7363 7269 6265 7320 7468 6520 636f  describes the co
-00021160: 6d70 6f6e 656e 7473 206f 6620 3a63 6c61  mponents of :cla
-00021170: 7373 3a60 696e 7075 745f 6469 6374 602e  ss:`input_dict`.
-00021180: 0a0a 2020 2020 2020 2020 636f 6d70 6172  ..        compar
-00021190: 6564 5f65 7374 696d 6174 6f72 733a 206c  ed_estimators: l
-000211a0: 6973 7420 6f66 2073 7472 2c20 6465 6661  ist of str, defa
-000211b0: 756c 743d 4e6f 6e65 0a20 2020 2020 2020  ult=None.       
-000211c0: 2020 2020 204e 616d 6520 6f66 2063 6f6d       Name of com
-000211d0: 7061 7265 6420 6573 7469 6d61 746f 7273  pared estimators
-000211e0: 2e0a 2020 2020 2020 2020 2020 2020 4966  ..            If
-000211f0: 2060 4e6f 6e65 6020 6973 2067 6976 656e   `None` is given
-00021200: 2c20 616c 6c20 7468 6520 6573 7469 6d61  , all the estima
-00021210: 746f 7273 2061 7265 2063 6f6d 7061 7265  tors are compare
-00021220: 642e 0a0a 2020 2020 2020 2020 6265 6861  d...        beha
-00021230: 7669 6f72 5f70 6f6c 6963 795f 6e61 6d65  vior_policy_name
-00021240: 3a20 7374 722c 2064 6566 6175 6c74 3d4e  : str, default=N
-00021250: 6f6e 650a 2020 2020 2020 2020 2020 2020  one.            
-00021260: 4e61 6d65 206f 6620 7468 6520 6265 6861  Name of the beha
-00021270: 7669 6f72 2070 6f6c 6963 792e 0a0a 2020  vior policy...  
-00021280: 2020 2020 2020 6461 7461 7365 745f 6964        dataset_id
-00021290: 3a20 696e 742c 2064 6566 6175 6c74 3d4e  : int, default=N
-000212a0: 6f6e 650a 2020 2020 2020 2020 2020 2020  one.            
-000212b0: 4964 206f 6620 7468 6520 6c6f 6767 6564  Id of the logged
-000212c0: 2064 6174 6173 6574 2e0a 0a20 2020 2020   dataset...     
-000212d0: 2020 2072 6577 6172 645f 7363 616c 653a     reward_scale:
-000212e0: 2061 7272 6179 2d6c 696b 6520 6f66 2073   array-like of s
-000212f0: 6861 7065 2028 6e5f 7061 7274 6974 696f  hape (n_partitio
-00021300: 6e2c 2029 2c20 6465 6661 756c 743d 4e6f  n, ), default=No
-00021310: 6e65 0a20 2020 2020 2020 2020 2020 2053  ne.            S
-00021320: 6361 6c65 206f 6620 7468 6520 7472 616a  cale of the traj
-00021330: 6563 746f 7279 2d77 6973 6520 7265 7761  ectory-wise rewa
-00021340: 7264 2075 7365 6420 666f 7220 782d 6178  rd used for x-ax
-00021350: 6973 206f 6620 7468 6520 4344 4620 706c  is of the CDF pl
-00021360: 6f74 2e0a 0a20 2020 2020 2020 2052 6574  ot...        Ret
-00021370: 7572 6e0a 2020 2020 2020 2020 2d2d 2d2d  urn.        ----
-00021380: 2d2d 2d0a 2020 2020 2020 2020 6375 6d75  ---.        cumu
-00021390: 6c61 7469 7665 5f64 6973 7472 6962 7574  lative_distribut
-000213a0: 696f 6e5f 6469 6374 3a20 6469 6374 2028  ion_dict: dict (
-000213b0: 2c20 6c69 7374 206f 6620 6469 6374 290a  , list of dict).
-000213c0: 2020 2020 2020 2020 2020 2020 4469 6374              Dict
-000213d0: 696f 6e61 7279 2063 6f6e 7461 696e 696e  ionary containin
-000213e0: 6720 7468 6520 6375 6d75 6c61 7469 7665  g the cumulative
-000213f0: 2064 6973 7472 6962 7574 696f 6e20 6f66   distribution of
-00021400: 2065 6163 6820 6576 616c 7561 7469 6f6e   each evaluation
-00021410: 2070 6f6c 6963 7920 6573 7469 6d61 7465   policy estimate
-00021420: 6420 6279 204f 5045 2065 7374 696d 6174  d by OPE estimat
-00021430: 6f72 732e 0a20 2020 2020 2020 2020 2020  ors..           
-00021440: 206b 6579 3a20 3a63 6c61 7373 3a60 5b65   key: :class:`[e
-00021450: 7661 6c75 6174 696f 6e5f 706f 6c69 6379  valuation_policy
-00021460: 5d5b 4f50 455f 6573 7469 6d61 746f 725f  ][OPE_estimator_
-00021470: 6e61 6d65 5d60 0a0a 2020 2020 2020 2020  name]`..        
-00021480: 2020 2020 5768 656e 2062 6568 6176 696f      When behavio
-00021490: 725f 706f 6c69 6379 5f6e 616d 6520 6973  r_policy_name is
-000214a0: 2060 4e6f 6e65 6020 616e 6420 6461 7461   `None` and data
-000214b0: 7365 745f 6964 2069 7320 604e 6f6e 6560  set_id is `None`
-000214c0: 2c0a 2020 2020 2020 2020 2020 2020 6b65  ,.            ke
-000214d0: 793a 203a 636c 6173 733a 605b 6265 6861  y: :class:`[beha
-000214e0: 7669 6f72 5f70 6f6c 6963 795f 6e61 6d65  vior_policy_name
-000214f0: 5d5b 6461 7461 7365 745f 6964 5d5b 6576  ][dataset_id][ev
-00021500: 616c 7561 7469 6f6e 5f70 6f6c 6963 795d  aluation_policy]
-00021510: 5b4f 5045 5f65 7374 696d 6174 6f72 5f6e  [OPE_estimator_n
-00021520: 616d 655d 600a 0a20 2020 2020 2020 2020  ame]`..         
-00021530: 2020 2057 6865 6e20 6265 6861 7669 6f72     When behavior
-00021540: 5f70 6f6c 6963 795f 6e61 6d65 2069 7320  _policy_name is 
-00021550: 604e 6f6e 6560 2061 6e64 2064 6174 6173  `None` and datas
-00021560: 6574 5f69 6420 6973 2073 7065 6369 6669  et_id is specifi
-00021570: 6564 2c0a 2020 2020 2020 2020 2020 2020  ed,.            
-00021580: 6b65 793a 203a 636c 6173 733a 605b 6265  key: :class:`[be
-00021590: 6861 7669 6f72 5f70 6f6c 6963 795f 6e61  havior_policy_na
-000215a0: 6d65 5d5b 6576 616c 7561 7469 6f6e 5f70  me][evaluation_p
-000215b0: 6f6c 6963 795d 5b4f 5045 5f65 7374 696d  olicy][OPE_estim
-000215c0: 6174 6f72 5f6e 616d 655d 600a 0a20 2020  ator_name]`..   
-000215d0: 2020 2020 2020 2020 2057 6865 6e20 6265           When be
-000215e0: 6861 7669 6f72 5f70 6f6c 6963 795f 6e61  havior_policy_na
-000215f0: 6d65 2069 7320 7370 6563 6966 6965 6420  me is specified 
-00021600: 616e 6420 6461 7461 7365 745f 6964 2069  and dataset_id i
-00021610: 7320 604e 6f6e 6560 2c0a 2020 2020 2020  s `None`,.      
-00021620: 2020 2020 2020 6b65 793a 203a 636c 6173        key: :clas
-00021630: 733a 605b 6461 7461 7365 745f 6964 5d5b  s:`[dataset_id][
-00021640: 4f50 455f 6573 7469 6d61 746f 725f 6e61  OPE_estimator_na
-00021650: 6d65 5d60 0a0a 2020 2020 2020 2020 2222  me]`..        ""
-00021660: 220a 2020 2020 2020 2020 636f 6d70 6172  ".        compar
-00021670: 6564 5f65 7374 696d 6174 6f72 7320 3d20  ed_estimators = 
-00021680: 7365 6c66 2e5f 6368 6563 6b5f 636f 6d70  self._check_comp
-00021690: 6172 6564 5f65 7374 696d 6174 6f72 7328  ared_estimators(
-000216a0: 636f 6d70 6172 6564 5f65 7374 696d 6174  compared_estimat
-000216b0: 6f72 7329 0a20 2020 2020 2020 2072 6577  ors).        rew
-000216c0: 6172 645f 7363 616c 6520 3d20 7365 6c66  ard_scale = self
-000216d0: 2e5f 6368 6563 6b5f 7265 7761 7264 5f73  ._check_reward_s
-000216e0: 6361 6c65 2872 6577 6172 645f 7363 616c  cale(reward_scal
-000216f0: 6529 0a0a 2020 2020 2020 2020 6966 2073  e)..        if s
-00021700: 656c 662e 7573 655f 6d75 6c74 6970 6c65  elf.use_multiple
-00021710: 5f6c 6f67 6765 645f 6461 7461 7365 743a  _logged_dataset:
-00021720: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00021730: 6973 696e 7374 616e 6365 2869 6e70 7574  isinstance(input
-00021740: 5f64 6963 742c 204d 756c 7469 706c 6549  _dict, MultipleI
-00021750: 6e70 7574 4469 6374 293a 0a20 2020 2020  nputDict):.     
-00021760: 2020 2020 2020 2020 2020 2069 6620 6265             if be
-00021770: 6861 7669 6f72 5f70 6f6c 6963 795f 6e61  havior_policy_na
-00021780: 6d65 2069 7320 4e6f 6e65 2061 6e64 2064  me is None and d
-00021790: 6174 6173 6574 5f69 6420 6973 204e 6f6e  ataset_id is Non
-000217a0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-000217b0: 2020 2020 2020 2069 6620 7365 6c66 2e6d         if self.m
-000217c0: 756c 7469 706c 655f 6c6f 6767 6564 5f64  ultiple_logged_d
-000217d0: 6174 6173 6574 2e6e 5f64 6174 6173 6574  ataset.n_dataset
-000217e0: 7320 213d 2069 6e70 7574 5f64 6963 742e  s != input_dict.
-000217f0: 6e5f 6461 7461 7365 7473 3a0a 2020 2020  n_datasets:.    
-00021800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021810: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-00021820: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
-00021830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021840: 2020 2245 7870 6563 7465 6420 7468 6174    "Expected that
-00021850: 206c 6f67 6765 6420 6461 7461 7365 7473   logged datasets
-00021860: 2061 6e64 2069 6e70 7574 2064 6963 7473   and input dicts
-00021870: 2063 6f6e 7369 7374 7320 6f66 2074 6865   consists of the
-00021880: 2073 616d 6520 6265 6861 7669 6f72 2070   same behavior p
-00021890: 6f6c 6963 6965 7320 616e 6420 6461 7461  olicies and data
-000218a0: 7365 7420 6964 732c 2062 7574 2066 6f75  set ids, but fou
-000218b0: 6e64 2046 616c 7365 2e22 0a20 2020 2020  nd False.".     
-000218c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000218d0: 2020 2029 0a0a 2020 2020 2020 2020 2020     )..          
-000218e0: 2020 2020 2020 2020 2020 6375 6d75 6c61            cumula
-000218f0: 7469 7665 5f64 6973 7472 6962 7574 696f  tive_distributio
-00021900: 6e5f 6469 6374 203d 2064 6566 6175 6c74  n_dict = default
-00021910: 6469 6374 286c 6973 7429 0a20 2020 2020  dict(list).     
-00021920: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00021930: 6f72 2028 0a20 2020 2020 2020 2020 2020  or (.           
-00021940: 2020 2020 2020 2020 2020 2020 2062 6568               beh
-00021950: 6176 696f 725f 706f 6c69 6379 2c0a 2020  avior_policy,.  
+00020fa0: 2067 616d 6d61 2c0a 2020 2020 2020 2020   gamma,.        
+00020fb0: 2020 2020 2020 2020 2020 2020 6265 6861              beha
+00020fc0: 7669 6f72 5f70 6f6c 6963 792c 0a20 2020  vior_policy,.   
+00020fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020fe0: 2065 7661 6c75 6174 696f 6e5f 706f 6c69   evaluation_poli
+00020ff0: 6379 2c0a 2020 2020 2020 2020 2020 2020  cy,.            
+00021000: 2020 2020 2020 2020 6461 7461 7365 745f          dataset_
+00021010: 6964 2c0a 2020 2020 2020 2020 2020 2020  id,.            
+00021020: 2020 2020 5d0a 0a20 2020 2020 2020 2020      ]..         
+00021030: 2020 202e 2e20 7365 6561 6c73 6f3a 3a0a     .. seealso::.
+00021040: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00021050: 203a 636c 6173 733a 6073 636f 7065 5f72   :class:`scope_r
+00021060: 6c2e 6f70 652e 696e 7075 742e 4372 6561  l.ope.input.Crea
+00021070: 7465 4f50 4549 6e70 7574 6020 6465 7363  teOPEInput` desc
+00021080: 7269 6265 7320 7468 6520 636f 6d70 6f6e  ribes the compon
+00021090: 656e 7473 206f 6620 3a63 6c61 7373 3a60  ents of :class:`
+000210a0: 696e 7075 745f 6469 6374 602e 0a0a 2020  input_dict`...  
+000210b0: 2020 2020 2020 636f 6d70 6172 6564 5f65        compared_e
+000210c0: 7374 696d 6174 6f72 733a 206c 6973 7420  stimators: list 
+000210d0: 6f66 2073 7472 2c20 6465 6661 756c 743d  of str, default=
+000210e0: 4e6f 6e65 0a20 2020 2020 2020 2020 2020  None.           
+000210f0: 204e 616d 6520 6f66 2063 6f6d 7061 7265   Name of compare
+00021100: 6420 6573 7469 6d61 746f 7273 2e0a 2020  d estimators..  
+00021110: 2020 2020 2020 2020 2020 4966 2060 4e6f            If `No
+00021120: 6e65 6020 6973 2067 6976 656e 2c20 616c  ne` is given, al
+00021130: 6c20 7468 6520 6573 7469 6d61 746f 7273  l the estimators
+00021140: 2061 7265 2063 6f6d 7061 7265 642e 0a0a   are compared...
+00021150: 2020 2020 2020 2020 6265 6861 7669 6f72          behavior
+00021160: 5f70 6f6c 6963 795f 6e61 6d65 3a20 7374  _policy_name: st
+00021170: 722c 2064 6566 6175 6c74 3d4e 6f6e 650a  r, default=None.
+00021180: 2020 2020 2020 2020 2020 2020 4e61 6d65              Name
+00021190: 206f 6620 7468 6520 6265 6861 7669 6f72   of the behavior
+000211a0: 2070 6f6c 6963 792e 0a0a 2020 2020 2020   policy...      
+000211b0: 2020 6461 7461 7365 745f 6964 3a20 696e    dataset_id: in
+000211c0: 742c 2064 6566 6175 6c74 3d4e 6f6e 650a  t, default=None.
+000211d0: 2020 2020 2020 2020 2020 2020 4964 206f              Id o
+000211e0: 6620 7468 6520 6c6f 6767 6564 2064 6174  f the logged dat
+000211f0: 6173 6574 2e0a 0a20 2020 2020 2020 2072  aset...        r
+00021200: 6577 6172 645f 7363 616c 653a 2061 7272  eward_scale: arr
+00021210: 6179 2d6c 696b 6520 6f66 2073 6861 7065  ay-like of shape
+00021220: 2028 6e5f 7061 7274 6974 696f 6e2c 2029   (n_partition, )
+00021230: 2c20 6465 6661 756c 743d 4e6f 6e65 0a20  , default=None. 
+00021240: 2020 2020 2020 2020 2020 2053 6361 6c65             Scale
+00021250: 206f 6620 7468 6520 7472 616a 6563 746f   of the trajecto
+00021260: 7279 2d77 6973 6520 7265 7761 7264 2075  ry-wise reward u
+00021270: 7365 6420 666f 7220 782d 6178 6973 206f  sed for x-axis o
+00021280: 6620 7468 6520 4344 4620 706c 6f74 2e0a  f the CDF plot..
+00021290: 0a20 2020 2020 2020 2052 6574 7572 6e0a  .        Return.
+000212a0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0a          -------.
+000212b0: 2020 2020 2020 2020 6375 6d75 6c61 7469          cumulati
+000212c0: 7665 5f64 6973 7472 6962 7574 696f 6e5f  ve_distribution_
+000212d0: 6469 6374 3a20 6469 6374 2028 2c20 6c69  dict: dict (, li
+000212e0: 7374 206f 6620 6469 6374 290a 2020 2020  st of dict).    
+000212f0: 2020 2020 2020 2020 4469 6374 696f 6e61          Dictiona
+00021300: 7279 2063 6f6e 7461 696e 696e 6720 7468  ry containing th
+00021310: 6520 6375 6d75 6c61 7469 7665 2064 6973  e cumulative dis
+00021320: 7472 6962 7574 696f 6e20 6f66 2065 6163  tribution of eac
+00021330: 6820 6576 616c 7561 7469 6f6e 2070 6f6c  h evaluation pol
+00021340: 6963 7920 6573 7469 6d61 7465 6420 6279  icy estimated by
+00021350: 204f 5045 2065 7374 696d 6174 6f72 732e   OPE estimators.
+00021360: 0a20 2020 2020 2020 2020 2020 206b 6579  .            key
+00021370: 3a20 3a63 6c61 7373 3a60 5b65 7661 6c75  : :class:`[evalu
+00021380: 6174 696f 6e5f 706f 6c69 6379 5d5b 4f50  ation_policy][OP
+00021390: 455f 6573 7469 6d61 746f 725f 6e61 6d65  E_estimator_name
+000213a0: 5d60 0a0a 2020 2020 2020 2020 2020 2020  ]`..            
+000213b0: 5768 656e 2062 6568 6176 696f 725f 706f  When behavior_po
+000213c0: 6c69 6379 5f6e 616d 6520 6973 2060 4e6f  licy_name is `No
+000213d0: 6e65 6020 616e 6420 6461 7461 7365 745f  ne` and dataset_
+000213e0: 6964 2069 7320 604e 6f6e 6560 2c0a 2020  id is `None`,.  
+000213f0: 2020 2020 2020 2020 2020 6b65 793a 203a            key: :
+00021400: 636c 6173 733a 605b 6265 6861 7669 6f72  class:`[behavior
+00021410: 5f70 6f6c 6963 795f 6e61 6d65 5d5b 6461  _policy_name][da
+00021420: 7461 7365 745f 6964 5d5b 6576 616c 7561  taset_id][evalua
+00021430: 7469 6f6e 5f70 6f6c 6963 795d 5b4f 5045  tion_policy][OPE
+00021440: 5f65 7374 696d 6174 6f72 5f6e 616d 655d  _estimator_name]
+00021450: 600a 0a20 2020 2020 2020 2020 2020 2057  `..            W
+00021460: 6865 6e20 6265 6861 7669 6f72 5f70 6f6c  hen behavior_pol
+00021470: 6963 795f 6e61 6d65 2069 7320 604e 6f6e  icy_name is `Non
+00021480: 6560 2061 6e64 2064 6174 6173 6574 5f69  e` and dataset_i
+00021490: 6420 6973 2073 7065 6369 6669 6564 2c0a  d is specified,.
+000214a0: 2020 2020 2020 2020 2020 2020 6b65 793a              key:
+000214b0: 203a 636c 6173 733a 605b 6265 6861 7669   :class:`[behavi
+000214c0: 6f72 5f70 6f6c 6963 795f 6e61 6d65 5d5b  or_policy_name][
+000214d0: 6576 616c 7561 7469 6f6e 5f70 6f6c 6963  evaluation_polic
+000214e0: 795d 5b4f 5045 5f65 7374 696d 6174 6f72  y][OPE_estimator
+000214f0: 5f6e 616d 655d 600a 0a20 2020 2020 2020  _name]`..       
+00021500: 2020 2020 2057 6865 6e20 6265 6861 7669       When behavi
+00021510: 6f72 5f70 6f6c 6963 795f 6e61 6d65 2069  or_policy_name i
+00021520: 7320 7370 6563 6966 6965 6420 616e 6420  s specified and 
+00021530: 6461 7461 7365 745f 6964 2069 7320 604e  dataset_id is `N
+00021540: 6f6e 6560 2c0a 2020 2020 2020 2020 2020  one`,.          
+00021550: 2020 6b65 793a 203a 636c 6173 733a 605b    key: :class:`[
+00021560: 6461 7461 7365 745f 6964 5d5b 4f50 455f  dataset_id][OPE_
+00021570: 6573 7469 6d61 746f 725f 6e61 6d65 5d60  estimator_name]`
+00021580: 0a0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+00021590: 2020 2020 2020 636f 6d70 6172 6564 5f65        compared_e
+000215a0: 7374 696d 6174 6f72 7320 3d20 7365 6c66  stimators = self
+000215b0: 2e5f 6368 6563 6b5f 636f 6d70 6172 6564  ._check_compared
+000215c0: 5f65 7374 696d 6174 6f72 7328 636f 6d70  _estimators(comp
+000215d0: 6172 6564 5f65 7374 696d 6174 6f72 7329  ared_estimators)
+000215e0: 0a20 2020 2020 2020 2072 6577 6172 645f  .        reward_
+000215f0: 7363 616c 6520 3d20 7365 6c66 2e5f 6368  scale = self._ch
+00021600: 6563 6b5f 7265 7761 7264 5f73 6361 6c65  eck_reward_scale
+00021610: 2872 6577 6172 645f 7363 616c 6529 0a0a  (reward_scale)..
+00021620: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00021630: 7573 655f 6d75 6c74 6970 6c65 5f6c 6f67  use_multiple_log
+00021640: 6765 645f 6461 7461 7365 743a 0a20 2020  ged_dataset:.   
+00021650: 2020 2020 2020 2020 2069 6620 6973 696e           if isin
+00021660: 7374 616e 6365 2869 6e70 7574 5f64 6963  stance(input_dic
+00021670: 742c 204d 756c 7469 706c 6549 6e70 7574  t, MultipleInput
+00021680: 4469 6374 293a 0a20 2020 2020 2020 2020  Dict):.         
+00021690: 2020 2020 2020 2069 6620 6265 6861 7669         if behavi
+000216a0: 6f72 5f70 6f6c 6963 795f 6e61 6d65 2069  or_policy_name i
+000216b0: 7320 4e6f 6e65 2061 6e64 2064 6174 6173  s None and datas
+000216c0: 6574 5f69 6420 6973 204e 6f6e 653a 0a20  et_id is None:. 
+000216d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000216e0: 2020 2069 6620 7365 6c66 2e6d 756c 7469     if self.multi
+000216f0: 706c 655f 6c6f 6767 6564 5f64 6174 6173  ple_logged_datas
+00021700: 6574 2e6e 5f64 6174 6173 6574 7320 213d  et.n_datasets !=
+00021710: 2069 6e70 7574 5f64 6963 742e 6e5f 6461   input_dict.n_da
+00021720: 7461 7365 7473 3a0a 2020 2020 2020 2020  tasets:.        
+00021730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021740: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+00021750: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00021760: 2020 2020 2020 2020 2020 2020 2020 2245                "E
+00021770: 7870 6563 7465 6420 7468 6174 206c 6f67  xpected that log
+00021780: 6765 6420 6461 7461 7365 7473 2061 6e64  ged datasets and
+00021790: 2069 6e70 7574 2064 6963 7473 2063 6f6e   input dicts con
+000217a0: 7369 7374 7320 6f66 2074 6865 2073 616d  sists of the sam
+000217b0: 6520 6265 6861 7669 6f72 2070 6f6c 6963  e behavior polic
+000217c0: 6965 7320 616e 6420 6461 7461 7365 7420  ies and dataset 
+000217d0: 6964 732c 2062 7574 2066 6f75 6e64 2046  ids, but found F
+000217e0: 616c 7365 2e22 0a20 2020 2020 2020 2020  alse.".         
+000217f0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+00021800: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00021810: 2020 2020 2020 6375 6d75 6c61 7469 7665        cumulative
+00021820: 5f64 6973 7472 6962 7574 696f 6e5f 6469  _distribution_di
+00021830: 6374 203d 2064 6566 6175 6c74 6469 6374  ct = defaultdict
+00021840: 286c 6973 7429 0a20 2020 2020 2020 2020  (list).         
+00021850: 2020 2020 2020 2020 2020 2066 6f72 2028             for (
+00021860: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00021870: 2020 2020 2020 2020 2062 6568 6176 696f           behavio
+00021880: 725f 706f 6c69 6379 2c0a 2020 2020 2020  r_policy,.      
+00021890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000218a0: 2020 6e5f 6461 7461 7365 7473 2c0a 2020    n_datasets,.  
+000218b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000218c0: 2020 2920 696e 2069 6e70 7574 5f64 6963    ) in input_dic
+000218d0: 742e 6e5f 6461 7461 7365 7473 2e69 7465  t.n_datasets.ite
+000218e0: 6d73 2829 3a0a 2020 2020 2020 2020 2020  ms():.          
+000218f0: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+00021900: 7220 6461 7461 7365 745f 6964 5f20 696e  r dataset_id_ in
+00021910: 2072 616e 6765 286e 5f64 6174 6173 6574   range(n_dataset
+00021920: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
+00021930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021940: 7365 6c66 2e5f 7265 6769 7374 6572 5f6c  self._register_l
+00021950: 6f67 6765 645f 6461 7461 7365 7428 0a20  ogged_dataset(. 
 00021960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021970: 2020 2020 2020 6e5f 6461 7461 7365 7473        n_datasets
-00021980: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00021990: 2020 2020 2020 2920 696e 2069 6e70 7574        ) in input
-000219a0: 5f64 6963 742e 6e5f 6461 7461 7365 7473  _dict.n_datasets
-000219b0: 2e69 7465 6d73 2829 3a0a 2020 2020 2020  .items():.      
-000219c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000219d0: 2020 666f 7220 6461 7461 7365 745f 6964    for dataset_id
-000219e0: 5f20 696e 2072 616e 6765 286e 5f64 6174  _ in range(n_dat
-000219f0: 6173 6574 7329 3a0a 2020 2020 2020 2020  asets):.        
+00021970: 2020 2020 2020 2020 2020 2020 2020 2062                 b
+00021980: 6568 6176 696f 725f 706f 6c69 6379 5f6e  ehavior_policy_n
+00021990: 616d 653d 6265 6861 7669 6f72 5f70 6f6c  ame=behavior_pol
+000219a0: 6963 792c 0a20 2020 2020 2020 2020 2020  icy,.           
+000219b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000219c0: 2020 2020 2064 6174 6173 6574 5f69 643d       dataset_id=
+000219d0: 6461 7461 7365 745f 6964 5f2c 0a20 2020  dataset_id_,.   
+000219e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000219f0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
 00021a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021a10: 2020 2020 7365 6c66 2e5f 7265 6769 7374      self._regist
-00021a20: 6572 5f6c 6f67 6765 645f 6461 7461 7365  er_logged_datase
-00021a30: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
+00021a10: 2020 2020 2020 2069 6e70 7574 5f64 6963         input_dic
+00021a20: 745f 203d 2069 6e70 7574 5f64 6963 742e  t_ = input_dict.
+00021a30: 6765 7428 0a20 2020 2020 2020 2020 2020  get(.           
 00021a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021a50: 2020 2062 6568 6176 696f 725f 706f 6c69     behavior_poli
-00021a60: 6379 5f6e 616d 653d 6265 6861 7669 6f72  cy_name=behavior
-00021a70: 5f70 6f6c 6963 792c 0a20 2020 2020 2020  _policy,.       
+00021a50: 2020 2020 2062 6568 6176 696f 725f 706f       behavior_po
+00021a60: 6c69 6379 5f6e 616d 653d 6265 6861 7669  licy_name=behavi
+00021a70: 6f72 5f70 6f6c 6963 792c 0a20 2020 2020  or_policy,.     
 00021a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021a90: 2020 2020 2020 2020 2064 6174 6173 6574           dataset
-00021aa0: 5f69 643d 6461 7461 7365 745f 6964 5f2c  _id=dataset_id_,
-00021ab0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00021ac0: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
-00021ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021ae0: 2020 2020 2020 2020 2020 2069 6e70 7574             input
-00021af0: 5f64 6963 745f 203d 2069 6e70 7574 5f64  _dict_ = input_d
-00021b00: 6963 742e 6765 7428 0a20 2020 2020 2020  ict.get(.       
+00021a90: 2020 2020 2020 2020 2020 2064 6174 6173             datas
+00021aa0: 6574 5f69 643d 6461 7461 7365 745f 6964  et_id=dataset_id
+00021ab0: 5f2c 0a20 2020 2020 2020 2020 2020 2020  _,.             
+00021ac0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+00021ad0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00021ae0: 2020 2020 2020 2020 2020 2020 2020 6375                cu
+00021af0: 6d75 6c61 7469 7665 5f64 6973 7472 6962  mulative_distrib
+00021b00: 7574 696f 6e5f 6469 6374 5f20 3d20 280a  ution_dict_ = (.
 00021b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021b20: 2020 2020 2020 2020 2062 6568 6176 696f           behavio
-00021b30: 725f 706f 6c69 6379 5f6e 616d 653d 6265  r_policy_name=be
-00021b40: 6861 7669 6f72 5f70 6f6c 6963 792c 0a20  havior_policy,. 
-00021b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021b60: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-00021b70: 6174 6173 6574 5f69 643d 6461 7461 7365  ataset_id=datase
-00021b80: 745f 6964 5f2c 0a20 2020 2020 2020 2020  t_id_,.         
-00021b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021ba0: 2020 2029 0a0a 2020 2020 2020 2020 2020     )..          
-00021bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021bc0: 2020 6375 6d75 6c61 7469 7665 5f64 6973    cumulative_dis
-00021bd0: 7472 6962 7574 696f 6e5f 6469 6374 5f20  tribution_dict_ 
-00021be0: 3d20 280a 2020 2020 2020 2020 2020 2020  = (.            
+00021b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021b30: 7365 6c66 2e5f 6573 7469 6d61 7465 5f63  self._estimate_c
+00021b40: 756d 756c 6174 6976 655f 6469 7374 7269  umulative_distri
+00021b50: 6275 7469 6f6e 5f66 756e 6374 696f 6e28  bution_function(
+00021b60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00021b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021b80: 2020 2020 2069 6e70 7574 5f64 6963 745f       input_dict_
+00021b90: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00021ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021bb0: 2020 2020 2020 636f 6d70 6172 6564 5f65        compared_e
+00021bc0: 7374 696d 6174 6f72 733d 636f 6d70 6172  stimators=compar
+00021bd0: 6564 5f65 7374 696d 6174 6f72 732c 0a20  ed_estimators,. 
+00021be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00021bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021c00: 2020 2020 7365 6c66 2e5f 6573 7469 6d61      self._estima
-00021c10: 7465 5f63 756d 756c 6174 6976 655f 6469  te_cumulative_di
-00021c20: 7374 7269 6275 7469 6f6e 5f66 756e 6374  stribution_funct
-00021c30: 696f 6e28 0a20 2020 2020 2020 2020 2020  ion(.           
+00021c00: 2020 2072 6577 6172 645f 7363 616c 653d     reward_scale=
+00021c10: 7265 7761 7264 5f73 6361 6c65 2c0a 2020  reward_scale,.  
+00021c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021c30: 2020 2020 2020 2020 2020 2020 2020 290a                ).
 00021c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021c50: 2020 2020 2020 2020 2069 6e70 7574 5f64           input_d
-00021c60: 6963 745f 2c0a 2020 2020 2020 2020 2020  ict_,.          
-00021c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021c80: 2020 2020 2020 2020 2020 636f 6d70 6172            compar
-00021c90: 6564 5f65 7374 696d 6174 6f72 733d 636f  ed_estimators=co
-00021ca0: 6d70 6172 6564 5f65 7374 696d 6174 6f72  mpared_estimator
-00021cb0: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
+00021c50: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00021c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021c70: 2020 2020 2020 2020 2020 6375 6d75 6c61            cumula
+00021c80: 7469 7665 5f64 6973 7472 6962 7574 696f  tive_distributio
+00021c90: 6e5f 6469 6374 5b62 6568 6176 696f 725f  n_dict[behavior_
+00021ca0: 706f 6c69 6379 5d2e 6170 7065 6e64 280a  policy].append(.
+00021cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00021cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021cd0: 2020 2020 2020 2072 6577 6172 645f 7363         reward_sc
-00021ce0: 616c 653d 7265 7761 7264 5f73 6361 6c65  ale=reward_scale
-00021cf0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00021d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021d10: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-00021d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021d30: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00021d40: 2020 2020 2020 2020 2020 2020 2020 6375                cu
-00021d50: 6d75 6c61 7469 7665 5f64 6973 7472 6962  mulative_distrib
-00021d60: 7574 696f 6e5f 6469 6374 5b62 6568 6176  ution_dict[behav
-00021d70: 696f 725f 706f 6c69 6379 5d2e 6170 7065  ior_policy].appe
-00021d80: 6e64 280a 2020 2020 2020 2020 2020 2020  nd(.            
-00021d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021da0: 2020 2020 6375 6d75 6c61 7469 7665 5f64      cumulative_d
-00021db0: 6973 7472 6962 7574 696f 6e5f 6469 6374  istribution_dict
-00021dc0: 5f0a 2020 2020 2020 2020 2020 2020 2020  _.              
-00021dd0: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-00021de0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00021df0: 2020 2020 2063 756d 756c 6174 6976 655f       cumulative_
-00021e00: 6469 7374 7269 6275 7469 6f6e 5f64 6963  distribution_dic
-00021e10: 7420 3d20 6465 6661 756c 7464 6963 745f  t = defaultdict_
-00021e20: 746f 5f64 6963 7428 0a20 2020 2020 2020  to_dict(.       
-00021e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021e40: 2063 756d 756c 6174 6976 655f 6469 7374   cumulative_dist
-00021e50: 7269 6275 7469 6f6e 5f64 6963 740a 2020  ribution_dict.  
-00021e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021e70: 2020 290a 0a20 2020 2020 2020 2020 2020    )..           
-00021e80: 2020 2020 2065 6c69 6620 6265 6861 7669       elif behavi
-00021e90: 6f72 5f70 6f6c 6963 795f 6e61 6d65 2069  or_policy_name i
-00021ea0: 7320 4e6f 6e65 2061 6e64 2064 6174 6173  s None and datas
-00021eb0: 6574 5f69 6420 6973 206e 6f74 204e 6f6e  et_id is not Non
-00021ec0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00021ed0: 2020 2020 2020 2069 6620 280a 2020 2020         if (.    
-00021ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021ef0: 2020 2020 7365 6c66 2e6d 756c 7469 706c      self.multipl
-00021f00: 655f 6c6f 6767 6564 5f64 6174 6173 6574  e_logged_dataset
-00021f10: 2e62 6568 6176 696f 725f 706f 6c69 6379  .behavior_policy
-00021f20: 5f6e 616d 6573 0a20 2020 2020 2020 2020  _names.         
-00021f30: 2020 2020 2020 2020 2020 2020 2020 2021                 !
-00021f40: 3d20 696e 7075 745f 6469 6374 2e62 6568  = input_dict.beh
-00021f50: 6176 696f 725f 706f 6c69 6379 5f6e 616d  avior_policy_nam
-00021f60: 6573 0a20 2020 2020 2020 2020 2020 2020  es.             
-00021f70: 2020 2020 2020 2029 3a0a 2020 2020 2020         ):.      
-00021f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021f90: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-00021fa0: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
-00021fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021fc0: 2245 7870 6563 7465 6420 7468 6174 206c  "Expected that l
-00021fd0: 6f67 6765 6420 6461 7461 7365 7473 2061  ogged datasets a
-00021fe0: 6e64 2069 6e70 7574 2064 6963 7473 2063  nd input dicts c
-00021ff0: 6f6e 7369 7374 7320 6f66 2074 6865 2073  onsists of the s
-00022000: 616d 6520 6265 6861 7669 6f72 2070 6f6c  ame behavior pol
-00022010: 6963 6965 732c 2062 7574 2066 6f75 6e64  icies, but found
-00022020: 2046 616c 7365 2e22 0a20 2020 2020 2020   False.".       
+00021cd0: 6375 6d75 6c61 7469 7665 5f64 6973 7472  cumulative_distr
+00021ce0: 6962 7574 696f 6e5f 6469 6374 5f0a 2020  ibution_dict_.  
+00021cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021d00: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+00021d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021d20: 2063 756d 756c 6174 6976 655f 6469 7374   cumulative_dist
+00021d30: 7269 6275 7469 6f6e 5f64 6963 7420 3d20  ribution_dict = 
+00021d40: 6465 6661 756c 7464 6963 745f 746f 5f64  defaultdict_to_d
+00021d50: 6963 7428 0a20 2020 2020 2020 2020 2020  ict(.           
+00021d60: 2020 2020 2020 2020 2020 2020 2063 756d               cum
+00021d70: 756c 6174 6976 655f 6469 7374 7269 6275  ulative_distribu
+00021d80: 7469 6f6e 5f64 6963 740a 2020 2020 2020  tion_dict.      
+00021d90: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+00021da0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00021db0: 2065 6c69 6620 6265 6861 7669 6f72 5f70   elif behavior_p
+00021dc0: 6f6c 6963 795f 6e61 6d65 2069 7320 4e6f  olicy_name is No
+00021dd0: 6e65 2061 6e64 2064 6174 6173 6574 5f69  ne and dataset_i
+00021de0: 6420 6973 206e 6f74 204e 6f6e 653a 0a20  d is not None:. 
+00021df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021e00: 2020 2069 6620 280a 2020 2020 2020 2020     if (.        
+00021e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021e20: 7365 6c66 2e6d 756c 7469 706c 655f 6c6f  self.multiple_lo
+00021e30: 6767 6564 5f64 6174 6173 6574 2e62 6568  gged_dataset.beh
+00021e40: 6176 696f 725f 706f 6c69 6379 5f6e 616d  avior_policy_nam
+00021e50: 6573 0a20 2020 2020 2020 2020 2020 2020  es.             
+00021e60: 2020 2020 2020 2020 2020 2021 3d20 696e             != in
+00021e70: 7075 745f 6469 6374 2e62 6568 6176 696f  put_dict.behavio
+00021e80: 725f 706f 6c69 6379 5f6e 616d 6573 0a20  r_policy_names. 
+00021e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021ea0: 2020 2029 3a0a 2020 2020 2020 2020 2020     ):.          
+00021eb0: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+00021ec0: 6973 6520 5661 6c75 6545 7272 6f72 280a  ise ValueError(.
+00021ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021ee0: 2020 2020 2020 2020 2020 2020 2245 7870              "Exp
+00021ef0: 6563 7465 6420 7468 6174 206c 6f67 6765  ected that logge
+00021f00: 6420 6461 7461 7365 7473 2061 6e64 2069  d datasets and i
+00021f10: 6e70 7574 2064 6963 7473 2063 6f6e 7369  nput dicts consi
+00021f20: 7374 7320 6f66 2074 6865 2073 616d 6520  sts of the same 
+00021f30: 6265 6861 7669 6f72 2070 6f6c 6963 6965  behavior policie
+00021f40: 732c 2062 7574 2066 6f75 6e64 2046 616c  s, but found Fal
+00021f50: 7365 2e22 0a20 2020 2020 2020 2020 2020  se.".           
+00021f60: 2020 2020 2020 2020 2020 2020 2029 0a0a               )..
+00021f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021f80: 2020 2020 6375 6d75 6c61 7469 7665 5f64      cumulative_d
+00021f90: 6973 7472 6962 7574 696f 6e5f 6469 6374  istribution_dict
+00021fa0: 203d 207b 7d0a 2020 2020 2020 2020 2020   = {}.          
+00021fb0: 2020 2020 2020 2020 2020 666f 7220 6265            for be
+00021fc0: 6861 7669 6f72 5f70 6f6c 6963 7920 696e  havior_policy in
+00021fd0: 2069 6e70 7574 5f64 6963 742e 6265 6861   input_dict.beha
+00021fe0: 7669 6f72 5f70 6f6c 6963 795f 6e61 6d65  vior_policy_name
+00021ff0: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
+00022000: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00022010: 5f72 6567 6973 7465 725f 6c6f 6767 6564  _register_logged
+00022020: 5f64 6174 6173 6574 280a 2020 2020 2020  _dataset(.      
 00022030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022040: 2029 0a0a 2020 2020 2020 2020 2020 2020   )..            
-00022050: 2020 2020 2020 2020 6375 6d75 6c61 7469          cumulati
-00022060: 7665 5f64 6973 7472 6962 7574 696f 6e5f  ve_distribution_
-00022070: 6469 6374 203d 207b 7d0a 2020 2020 2020  dict = {}.      
-00022080: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-00022090: 7220 6265 6861 7669 6f72 5f70 6f6c 6963  r behavior_polic
-000220a0: 7920 696e 2069 6e70 7574 5f64 6963 742e  y in input_dict.
-000220b0: 6265 6861 7669 6f72 5f70 6f6c 6963 795f  behavior_policy_
-000220c0: 6e61 6d65 733a 0a20 2020 2020 2020 2020  names:.         
-000220d0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-000220e0: 656c 662e 5f72 6567 6973 7465 725f 6c6f  elf._register_lo
-000220f0: 6767 6564 5f64 6174 6173 6574 280a 2020  gged_dataset(.  
-00022100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022110: 2020 2020 2020 2020 2020 6265 6861 7669            behavi
-00022120: 6f72 5f70 6f6c 6963 795f 6e61 6d65 3d62  or_policy_name=b
-00022130: 6568 6176 696f 725f 706f 6c69 6379 2c20  ehavior_policy, 
-00022140: 6461 7461 7365 745f 6964 3d64 6174 6173  dataset_id=datas
-00022150: 6574 5f69 640a 2020 2020 2020 2020 2020  et_id.          
-00022160: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-00022170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022180: 2020 2020 2020 2020 696e 7075 745f 6469          input_di
-00022190: 6374 5f20 3d20 696e 7075 745f 6469 6374  ct_ = input_dict
-000221a0: 2e67 6574 280a 2020 2020 2020 2020 2020  .get(.          
-000221b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000221c0: 2020 6265 6861 7669 6f72 5f70 6f6c 6963    behavior_polic
-000221d0: 795f 6e61 6d65 3d62 6568 6176 696f 725f  y_name=behavior_
-000221e0: 706f 6c69 6379 2c0a 2020 2020 2020 2020  policy,.        
+00022040: 2020 2020 2020 6265 6861 7669 6f72 5f70        behavior_p
+00022050: 6f6c 6963 795f 6e61 6d65 3d62 6568 6176  olicy_name=behav
+00022060: 696f 725f 706f 6c69 6379 2c20 6461 7461  ior_policy, data
+00022070: 7365 745f 6964 3d64 6174 6173 6574 5f69  set_id=dataset_i
+00022080: 640a 2020 2020 2020 2020 2020 2020 2020  d.              
+00022090: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+000220a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000220b0: 2020 2020 696e 7075 745f 6469 6374 5f20      input_dict_ 
+000220c0: 3d20 696e 7075 745f 6469 6374 2e67 6574  = input_dict.get
+000220d0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+000220e0: 2020 2020 2020 2020 2020 2020 2020 6265                be
+000220f0: 6861 7669 6f72 5f70 6f6c 6963 795f 6e61  havior_policy_na
+00022100: 6d65 3d62 6568 6176 696f 725f 706f 6c69  me=behavior_poli
+00022110: 6379 2c0a 2020 2020 2020 2020 2020 2020  cy,.            
+00022120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022130: 6461 7461 7365 745f 6964 3d64 6174 6173  dataset_id=datas
+00022140: 6574 5f69 642c 0a20 2020 2020 2020 2020  et_id,.         
+00022150: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+00022160: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00022170: 2020 2020 2020 2020 2020 6375 6d75 6c61            cumula
+00022180: 7469 7665 5f64 6973 7472 6962 7574 696f  tive_distributio
+00022190: 6e5f 6469 6374 5f20 3d20 280a 2020 2020  n_dict_ = (.    
+000221a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000221b0: 2020 2020 2020 2020 7365 6c66 2e5f 6573          self._es
+000221c0: 7469 6d61 7465 5f63 756d 756c 6174 6976  timate_cumulativ
+000221d0: 655f 6469 7374 7269 6275 7469 6f6e 5f66  e_distribution_f
+000221e0: 756e 6374 696f 6e28 0a20 2020 2020 2020  unction(.       
 000221f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022200: 2020 2020 6461 7461 7365 745f 6964 3d64      dataset_id=d
-00022210: 6174 6173 6574 5f69 642c 0a20 2020 2020  ataset_id,.     
+00022200: 2020 2020 2020 2020 2069 6e70 7574 5f64           input_d
+00022210: 6963 745f 2c0a 2020 2020 2020 2020 2020  ict_,.          
 00022220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022230: 2020 2029 0a0a 2020 2020 2020 2020 2020     )..          
-00022240: 2020 2020 2020 2020 2020 2020 2020 6375                cu
-00022250: 6d75 6c61 7469 7665 5f64 6973 7472 6962  mulative_distrib
-00022260: 7574 696f 6e5f 6469 6374 5f20 3d20 280a  ution_dict_ = (.
-00022270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022280: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00022290: 2e5f 6573 7469 6d61 7465 5f63 756d 756c  ._estimate_cumul
-000222a0: 6174 6976 655f 6469 7374 7269 6275 7469  ative_distributi
-000222b0: 6f6e 5f66 756e 6374 696f 6e28 0a20 2020  on_function(.   
+00022230: 2020 2020 2020 636f 6d70 6172 6564 5f65        compared_e
+00022240: 7374 696d 6174 6f72 733d 636f 6d70 6172  stimators=compar
+00022250: 6564 5f65 7374 696d 6174 6f72 732c 0a20  ed_estimators,. 
+00022260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022270: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00022280: 6577 6172 645f 7363 616c 653d 7265 7761  eward_scale=rewa
+00022290: 7264 5f73 6361 6c65 2c0a 2020 2020 2020  rd_scale,.      
+000222a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000222b0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
 000222c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000222d0: 2020 2020 2020 2020 2020 2020 2069 6e70               inp
-000222e0: 7574 5f64 6963 745f 2c0a 2020 2020 2020  ut_dict_,.      
-000222f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022300: 2020 2020 2020 2020 2020 636f 6d70 6172            compar
-00022310: 6564 5f65 7374 696d 6174 6f72 733d 636f  ed_estimators=co
-00022320: 6d70 6172 6564 5f65 7374 696d 6174 6f72  mpared_estimator
-00022330: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
-00022340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022350: 2020 2072 6577 6172 645f 7363 616c 653d     reward_scale=
-00022360: 7265 7761 7264 5f73 6361 6c65 2c0a 2020  reward_scale,.  
-00022370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022380: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00022390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000223a0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-000223b0: 2020 2020 2020 2020 2020 2020 2020 6375                cu
-000223c0: 6d75 6c61 7469 7665 5f64 6973 7472 6962  mulative_distrib
-000223d0: 7574 696f 6e5f 6469 6374 5b0a 2020 2020  ution_dict[.    
-000223e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000223f0: 2020 2020 2020 2020 6265 6861 7669 6f72          behavior
-00022400: 5f70 6f6c 6963 790a 2020 2020 2020 2020  _policy.        
-00022410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022420: 5d20 3d20 6375 6d75 6c61 7469 7665 5f64  ] = cumulative_d
-00022430: 6973 7472 6962 7574 696f 6e5f 6469 6374  istribution_dict
-00022440: 5f0a 0a20 2020 2020 2020 2020 2020 2020  _..             
-00022450: 2020 2065 6c69 6620 6265 6861 7669 6f72     elif behavior
-00022460: 5f70 6f6c 6963 795f 6e61 6d65 2069 7320  _policy_name is 
-00022470: 6e6f 7420 4e6f 6e65 2061 6e64 2064 6174  not None and dat
-00022480: 6173 6574 5f69 6420 6973 204e 6f6e 653a  aset_id is None:
-00022490: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000224a0: 2020 2020 2069 6620 280a 2020 2020 2020       if (.      
-000224b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000224c0: 2020 7365 6c66 2e6d 756c 7469 706c 655f    self.multiple_
-000224d0: 6c6f 6767 6564 5f64 6174 6173 6574 2e6e  logged_dataset.n
-000224e0: 5f64 6174 6173 6574 735b 6265 6861 7669  _datasets[behavi
-000224f0: 6f72 5f70 6f6c 6963 795f 6e61 6d65 5d0a  or_policy_name].
-00022500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022510: 2020 2020 2020 2020 213d 2069 6e70 7574          != input
-00022520: 5f64 6963 742e 6e5f 6461 7461 7365 7473  _dict.n_datasets
-00022530: 5b62 6568 6176 696f 725f 706f 6c69 6379  [behavior_policy
-00022540: 5f6e 616d 655d 0a20 2020 2020 2020 2020  _name].         
-00022550: 2020 2020 2020 2020 2020 2029 3a0a 2020             ):.  
-00022560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022570: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-00022580: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
-00022590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000225a0: 2020 2020 2245 7870 6563 7465 6420 7468      "Expected th
-000225b0: 6174 206c 6f67 6765 6420 6461 7461 7365  at logged datase
-000225c0: 7473 2061 6e64 2069 6e70 7574 2064 6963  ts and input dic
-000225d0: 7473 2063 6f6e 7369 7374 7320 6f66 2074  ts consists of t
-000225e0: 6865 2073 616d 6520 6461 7461 7365 7420  he same dataset 
-000225f0: 6964 732c 2062 7574 2066 6f75 6e64 2046  ids, but found F
-00022600: 616c 7365 2e22 0a20 2020 2020 2020 2020  alse.".         
-00022610: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-00022620: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00022630: 2020 2020 2020 6375 6d75 6c61 7469 7665        cumulative
-00022640: 5f64 6973 7472 6962 7574 696f 6e5f 6469  _distribution_di
-00022650: 6374 203d 205b 5d0a 2020 2020 2020 2020  ct = [].        
-00022660: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00022670: 6461 7461 7365 745f 6964 5f20 696e 2072  dataset_id_ in r
-00022680: 616e 6765 280a 2020 2020 2020 2020 2020  ange(.          
-00022690: 2020 2020 2020 2020 2020 2020 2020 696e                in
-000226a0: 7075 745f 6469 6374 2e6e 5f64 6174 6173  put_dict.n_datas
-000226b0: 6574 735b 6265 6861 7669 6f72 5f70 6f6c  ets[behavior_pol
-000226c0: 6963 795f 6e61 6d65 5d0a 2020 2020 2020  icy_name].      
-000226d0: 2020 2020 2020 2020 2020 2020 2020 293a                ):
-000226e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000226f0: 2020 2020 2020 2020 2073 656c 662e 5f72           self._r
-00022700: 6567 6973 7465 725f 6c6f 6767 6564 5f64  egister_logged_d
-00022710: 6174 6173 6574 280a 2020 2020 2020 2020  ataset(.        
-00022720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022730: 2020 2020 6265 6861 7669 6f72 5f70 6f6c      behavior_pol
-00022740: 6963 795f 6e61 6d65 3d62 6568 6176 696f  icy_name=behavio
-00022750: 725f 706f 6c69 6379 5f6e 616d 652c 0a20  r_policy_name,. 
+000222d0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+000222e0: 2020 2020 2020 2020 2020 6375 6d75 6c61            cumula
+000222f0: 7469 7665 5f64 6973 7472 6962 7574 696f  tive_distributio
+00022300: 6e5f 6469 6374 5b0a 2020 2020 2020 2020  n_dict[.        
+00022310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022320: 2020 2020 6265 6861 7669 6f72 5f70 6f6c      behavior_pol
+00022330: 6963 790a 2020 2020 2020 2020 2020 2020  icy.            
+00022340: 2020 2020 2020 2020 2020 2020 5d20 3d20              ] = 
+00022350: 6375 6d75 6c61 7469 7665 5f64 6973 7472  cumulative_distr
+00022360: 6962 7574 696f 6e5f 6469 6374 5f0a 0a20  ibution_dict_.. 
+00022370: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00022380: 6c69 6620 6265 6861 7669 6f72 5f70 6f6c  lif behavior_pol
+00022390: 6963 795f 6e61 6d65 2069 7320 6e6f 7420  icy_name is not 
+000223a0: 4e6f 6e65 2061 6e64 2064 6174 6173 6574  None and dataset
+000223b0: 5f69 6420 6973 204e 6f6e 653a 0a20 2020  _id is None:.   
+000223c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000223d0: 2069 6620 280a 2020 2020 2020 2020 2020   if (.          
+000223e0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+000223f0: 6c66 2e6d 756c 7469 706c 655f 6c6f 6767  lf.multiple_logg
+00022400: 6564 5f64 6174 6173 6574 2e6e 5f64 6174  ed_dataset.n_dat
+00022410: 6173 6574 735b 6265 6861 7669 6f72 5f70  asets[behavior_p
+00022420: 6f6c 6963 795f 6e61 6d65 5d0a 2020 2020  olicy_name].    
+00022430: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022440: 2020 2020 213d 2069 6e70 7574 5f64 6963      != input_dic
+00022450: 742e 6e5f 6461 7461 7365 7473 5b62 6568  t.n_datasets[beh
+00022460: 6176 696f 725f 706f 6c69 6379 5f6e 616d  avior_policy_nam
+00022470: 655d 0a20 2020 2020 2020 2020 2020 2020  e].             
+00022480: 2020 2020 2020 2029 3a0a 2020 2020 2020         ):.      
+00022490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000224a0: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+000224b0: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
+000224c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000224d0: 2245 7870 6563 7465 6420 7468 6174 206c  "Expected that l
+000224e0: 6f67 6765 6420 6461 7461 7365 7473 2061  ogged datasets a
+000224f0: 6e64 2069 6e70 7574 2064 6963 7473 2063  nd input dicts c
+00022500: 6f6e 7369 7374 7320 6f66 2074 6865 2073  onsists of the s
+00022510: 616d 6520 6461 7461 7365 7420 6964 732c  ame dataset ids,
+00022520: 2062 7574 2066 6f75 6e64 2046 616c 7365   but found False
+00022530: 2e22 0a20 2020 2020 2020 2020 2020 2020  .".             
+00022540: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
+00022550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022560: 2020 6375 6d75 6c61 7469 7665 5f64 6973    cumulative_dis
+00022570: 7472 6962 7574 696f 6e5f 6469 6374 203d  tribution_dict =
+00022580: 205b 5d0a 2020 2020 2020 2020 2020 2020   [].            
+00022590: 2020 2020 2020 2020 666f 7220 6461 7461          for data
+000225a0: 7365 745f 6964 5f20 696e 2072 616e 6765  set_id_ in range
+000225b0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+000225c0: 2020 2020 2020 2020 2020 696e 7075 745f            input_
+000225d0: 6469 6374 2e6e 5f64 6174 6173 6574 735b  dict.n_datasets[
+000225e0: 6265 6861 7669 6f72 5f70 6f6c 6963 795f  behavior_policy_
+000225f0: 6e61 6d65 5d0a 2020 2020 2020 2020 2020  name].          
+00022600: 2020 2020 2020 2020 2020 293a 0a20 2020            ):.   
+00022610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022620: 2020 2020 2073 656c 662e 5f72 6567 6973       self._regis
+00022630: 7465 725f 6c6f 6767 6564 5f64 6174 6173  ter_logged_datas
+00022640: 6574 280a 2020 2020 2020 2020 2020 2020  et(.            
+00022650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022660: 6265 6861 7669 6f72 5f70 6f6c 6963 795f  behavior_policy_
+00022670: 6e61 6d65 3d62 6568 6176 696f 725f 706f  name=behavior_po
+00022680: 6c69 6379 5f6e 616d 652c 0a20 2020 2020  licy_name,.     
+00022690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000226a0: 2020 2020 2020 2064 6174 6173 6574 5f69         dataset_i
+000226b0: 643d 6461 7461 7365 745f 6964 5f2c 0a20  d=dataset_id_,. 
+000226c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000226d0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+000226e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000226f0: 2069 6e70 7574 5f64 6963 745f 203d 2069   input_dict_ = i
+00022700: 6e70 7574 5f64 6963 742e 6765 7428 0a20  nput_dict.get(. 
+00022710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022720: 2020 2020 2020 2020 2020 2062 6568 6176             behav
+00022730: 696f 725f 706f 6c69 6379 5f6e 616d 653d  ior_policy_name=
+00022740: 6265 6861 7669 6f72 5f70 6f6c 6963 795f  behavior_policy_
+00022750: 6e61 6d65 2c0a 2020 2020 2020 2020 2020  name,.          
 00022760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022770: 2020 2020 2020 2020 2020 2064 6174 6173             datas
-00022780: 6574 5f69 643d 6461 7461 7365 745f 6964  et_id=dataset_id
-00022790: 5f2c 0a20 2020 2020 2020 2020 2020 2020  _,.             
-000227a0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-000227b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000227c0: 2020 2020 2069 6e70 7574 5f64 6963 745f       input_dict_
-000227d0: 203d 2069 6e70 7574 5f64 6963 742e 6765   = input_dict.ge
-000227e0: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
-000227f0: 2020 2020 2020 2020 2020 2020 2020 2062                 b
-00022800: 6568 6176 696f 725f 706f 6c69 6379 5f6e  ehavior_policy_n
-00022810: 616d 653d 6265 6861 7669 6f72 5f70 6f6c  ame=behavior_pol
-00022820: 6963 795f 6e61 6d65 2c0a 2020 2020 2020  icy_name,.      
+00022770: 2020 6461 7461 7365 745f 6964 3d64 6174    dataset_id=dat
+00022780: 6173 6574 5f69 645f 2c0a 2020 2020 2020  aset_id_,.      
+00022790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000227a0: 2020 290a 0a20 2020 2020 2020 2020 2020    )..           
+000227b0: 2020 2020 2020 2020 2020 2020 2063 756d               cum
+000227c0: 756c 6174 6976 655f 6469 7374 7269 6275  ulative_distribu
+000227d0: 7469 6f6e 5f64 6963 745f 203d 2028 0a20  tion_dict_ = (. 
+000227e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000227f0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00022800: 5f65 7374 696d 6174 655f 6375 6d75 6c61  _estimate_cumula
+00022810: 7469 7665 5f64 6973 7472 6962 7574 696f  tive_distributio
+00022820: 6e5f 6675 6e63 7469 6f6e 280a 2020 2020  n_function(.    
 00022830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022840: 2020 2020 2020 6461 7461 7365 745f 6964        dataset_id
-00022850: 3d64 6174 6173 6574 5f69 645f 2c0a 2020  =dataset_id_,.  
+00022840: 2020 2020 2020 2020 2020 2020 696e 7075              inpu
+00022850: 745f 6469 6374 5f2c 0a20 2020 2020 2020  t_dict_,.       
 00022860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022870: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-00022880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022890: 2063 756d 756c 6174 6976 655f 6469 7374   cumulative_dist
-000228a0: 7269 6275 7469 6f6e 5f64 6963 745f 203d  ribution_dict_ =
-000228b0: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
-000228c0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-000228d0: 656c 662e 5f65 7374 696d 6174 655f 6375  elf._estimate_cu
-000228e0: 6d75 6c61 7469 7665 5f64 6973 7472 6962  mulative_distrib
-000228f0: 7574 696f 6e5f 6675 6e63 7469 6f6e 280a  ution_function(.
+00022870: 2020 2020 2020 2020 2063 6f6d 7061 7265           compare
+00022880: 645f 6573 7469 6d61 746f 7273 3d63 6f6d  d_estimators=com
+00022890: 7061 7265 645f 6573 7469 6d61 746f 7273  pared_estimators
+000228a0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000228b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000228c0: 2020 7265 7761 7264 5f73 6361 6c65 3d72    reward_scale=r
+000228d0: 6577 6172 645f 7363 616c 652c 0a20 2020  eward_scale,.   
+000228e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000228f0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
 00022900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022920: 696e 7075 745f 6469 6374 5f2c 0a20 2020  input_dict_,.   
-00022930: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022940: 2020 2020 2020 2020 2020 2020 2063 6f6d               com
-00022950: 7061 7265 645f 6573 7469 6d61 746f 7273  pared_estimators
-00022960: 3d63 6f6d 7061 7265 645f 6573 7469 6d61  =compared_estima
-00022970: 746f 7273 2c0a 2020 2020 2020 2020 2020  tors,.          
-00022980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022990: 2020 2020 2020 7265 7761 7264 5f73 6361        reward_sca
-000229a0: 6c65 3d72 6577 6172 645f 7363 616c 652c  le=reward_scale,
-000229b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000229c0: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
-000229d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000229e0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00022910: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+00022920: 2020 2020 2020 2020 2020 2020 2063 756d               cum
+00022930: 756c 6174 6976 655f 6469 7374 7269 6275  ulative_distribu
+00022940: 7469 6f6e 5f64 6963 742e 6170 7065 6e64  tion_dict.append
+00022950: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00022960: 2020 2020 2020 2020 2020 2020 2020 6375                cu
+00022970: 6d75 6c61 7469 7665 5f64 6973 7472 6962  mulative_distrib
+00022980: 7574 696f 6e5f 6469 6374 5f0a 2020 2020  ution_dict_.    
+00022990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000229a0: 2020 2020 290a 0a20 2020 2020 2020 2020      )..         
+000229b0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+000229c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000229d0: 2073 656c 662e 5f72 6567 6973 7465 725f   self._register_
+000229e0: 6c6f 6767 6564 5f64 6174 6173 6574 280a  logged_dataset(.
 000229f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022a00: 2063 756d 756c 6174 6976 655f 6469 7374   cumulative_dist
-00022a10: 7269 6275 7469 6f6e 5f64 6963 742e 6170  ribution_dict.ap
-00022a20: 7065 6e64 280a 2020 2020 2020 2020 2020  pend(.          
-00022a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022a40: 2020 6375 6d75 6c61 7469 7665 5f64 6973    cumulative_dis
-00022a50: 7472 6962 7574 696f 6e5f 6469 6374 5f0a  tribution_dict_.
+00022a00: 2020 2020 2020 2020 6265 6861 7669 6f72          behavior
+00022a10: 5f70 6f6c 6963 795f 6e61 6d65 3d62 6568  _policy_name=beh
+00022a20: 6176 696f 725f 706f 6c69 6379 5f6e 616d  avior_policy_nam
+00022a30: 652c 2064 6174 6173 6574 5f69 643d 6461  e, dataset_id=da
+00022a40: 7461 7365 745f 6964 0a20 2020 2020 2020  taset_id.       
+00022a50: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
 00022a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022a70: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
-00022a80: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00022a70: 2020 2069 6e70 7574 5f64 6963 745f 203d     input_dict_ =
+00022a80: 2069 6e70 7574 5f64 6963 742e 6765 7428   input_dict.get(
 00022a90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00022aa0: 2020 2020 2073 656c 662e 5f72 6567 6973       self._regis
-00022ab0: 7465 725f 6c6f 6767 6564 5f64 6174 6173  ter_logged_datas
-00022ac0: 6574 280a 2020 2020 2020 2020 2020 2020  et(.            
-00022ad0: 2020 2020 2020 2020 2020 2020 6265 6861              beha
-00022ae0: 7669 6f72 5f70 6f6c 6963 795f 6e61 6d65  vior_policy_name
-00022af0: 3d62 6568 6176 696f 725f 706f 6c69 6379  =behavior_policy
-00022b00: 5f6e 616d 652c 2064 6174 6173 6574 5f69  _name, dataset_i
-00022b10: 643d 6461 7461 7365 745f 6964 0a20 2020  d=dataset_id.   
-00022b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022b30: 2029 0a20 2020 2020 2020 2020 2020 2020   ).             
-00022b40: 2020 2020 2020 2069 6e70 7574 5f64 6963         input_dic
-00022b50: 745f 203d 2069 6e70 7574 5f64 6963 742e  t_ = input_dict.
-00022b60: 6765 7428 0a20 2020 2020 2020 2020 2020  get(.           
-00022b70: 2020 2020 2020 2020 2020 2020 2062 6568               beh
-00022b80: 6176 696f 725f 706f 6c69 6379 5f6e 616d  avior_policy_nam
-00022b90: 653d 6265 6861 7669 6f72 5f70 6f6c 6963  e=behavior_polic
-00022ba0: 795f 6e61 6d65 2c20 6461 7461 7365 745f  y_name, dataset_
-00022bb0: 6964 3d64 6174 6173 6574 5f69 640a 2020  id=dataset_id.  
-00022bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022bd0: 2020 290a 0a20 2020 2020 2020 2020 2020    )..           
-00022be0: 2020 2020 2020 2020 2063 756d 756c 6174           cumulat
-00022bf0: 6976 655f 6469 7374 7269 6275 7469 6f6e  ive_distribution
-00022c00: 5f64 6963 7420 3d20 280a 2020 2020 2020  _dict = (.      
-00022c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022c20: 2020 7365 6c66 2e5f 6573 7469 6d61 7465    self._estimate
-00022c30: 5f63 756d 756c 6174 6976 655f 6469 7374  _cumulative_dist
-00022c40: 7269 6275 7469 6f6e 5f66 756e 6374 696f  ribution_functio
-00022c50: 6e28 0a20 2020 2020 2020 2020 2020 2020  n(.             
-00022c60: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00022c70: 6e70 7574 5f64 6963 745f 2c0a 2020 2020  nput_dict_,.    
-00022c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022c90: 2020 2020 2020 2020 636f 6d70 6172 6564          compared
-00022ca0: 5f65 7374 696d 6174 6f72 733d 636f 6d70  _estimators=comp
-00022cb0: 6172 6564 5f65 7374 696d 6174 6f72 732c  ared_estimators,
-00022cc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00022cd0: 2020 2020 2020 2020 2020 2020 2072 6577               rew
-00022ce0: 6172 645f 7363 616c 653d 7265 7761 7264  ard_scale=reward
-00022cf0: 5f73 6361 6c65 2c0a 2020 2020 2020 2020  _scale,.        
-00022d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022d10: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00022d20: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-00022d30: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00022d40: 2020 2020 2020 2020 2020 2062 6568 6176             behav
-00022d50: 696f 725f 706f 6c69 6379 5f6e 616d 6520  ior_policy_name 
-00022d60: 3d20 6c69 7374 2869 6e70 7574 5f64 6963  = list(input_dic
-00022d70: 742e 7661 6c75 6573 2829 295b 305d 5b22  t.values())[0]["
-00022d80: 6265 6861 7669 6f72 5f70 6f6c 6963 7922  behavior_policy"
-00022d90: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-00022da0: 2020 6461 7461 7365 745f 6964 203d 206c    dataset_id = l
-00022db0: 6973 7428 696e 7075 745f 6469 6374 2e76  ist(input_dict.v
-00022dc0: 616c 7565 7328 2929 5b30 5d5b 2264 6174  alues())[0]["dat
-00022dd0: 6173 6574 5f69 6422 5d0a 0a20 2020 2020  aset_id"]..     
-00022de0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00022df0: 5f72 6567 6973 7465 725f 6c6f 6767 6564  _register_logged
-00022e00: 5f64 6174 6173 6574 280a 2020 2020 2020  _dataset(.      
-00022e10: 2020 2020 2020 2020 2020 2020 2020 6265                be
-00022e20: 6861 7669 6f72 5f70 6f6c 6963 795f 6e61  havior_policy_na
-00022e30: 6d65 3d62 6568 6176 696f 725f 706f 6c69  me=behavior_poli
-00022e40: 6379 5f6e 616d 652c 2064 6174 6173 6574  cy_name, dataset
-00022e50: 5f69 643d 6461 7461 7365 745f 6964 0a20  _id=dataset_id. 
-00022e60: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-00022e70: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00022e80: 2020 6375 6d75 6c61 7469 7665 5f64 6973    cumulative_dis
-00022e90: 7472 6962 7574 696f 6e5f 6469 6374 203d  tribution_dict =
-00022ea0: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
-00022eb0: 2020 2020 2020 2073 656c 662e 5f65 7374         self._est
-00022ec0: 696d 6174 655f 6375 6d75 6c61 7469 7665  imate_cumulative
-00022ed0: 5f64 6973 7472 6962 7574 696f 6e5f 6675  _distribution_fu
-00022ee0: 6e63 7469 6f6e 280a 2020 2020 2020 2020  nction(.        
-00022ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022f00: 696e 7075 745f 6469 6374 2c0a 2020 2020  input_dict,.    
-00022f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022f20: 2020 2020 636f 6d70 6172 6564 5f65 7374      compared_est
-00022f30: 696d 6174 6f72 733d 636f 6d70 6172 6564  imators=compared
-00022f40: 5f65 7374 696d 6174 6f72 732c 0a20 2020  _estimators,.   
-00022f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022f60: 2020 2020 2072 6577 6172 645f 7363 616c       reward_scal
-00022f70: 653d 7265 7761 7264 5f73 6361 6c65 2c0a  e=reward_scale,.
-00022f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022f90: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-00022fa0: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-00022fb0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00022fc0: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-00022fd0: 2869 6e70 7574 5f64 6963 742c 204d 756c  (input_dict, Mul
-00022fe0: 7469 706c 6549 6e70 7574 4469 6374 293a  tipleInputDict):
-00022ff0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00023000: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-00023010: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
-00023020: 2020 2020 2020 2022 7768 656e 2075 7369         "when usi
-00023030: 6e67 204c 6f67 6765 6444 6174 6173 6574  ng LoggedDataset
-00023040: 2c20 706c 6561 7365 2075 7365 2049 6e70  , please use Inp
-00023050: 7574 4469 6374 2069 6e73 7465 6164 206f  utDict instead o
-00023060: 6620 4d75 6c74 6970 6c65 496e 7075 7444  f MultipleInputD
-00023070: 6963 7422 0a20 2020 2020 2020 2020 2020  ict".           
-00023080: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
-00023090: 2020 2020 6375 6d75 6c61 7469 7665 5f64      cumulative_d
-000230a0: 6973 7472 6962 7574 696f 6e5f 6469 6374  istribution_dict
-000230b0: 203d 2028 0a20 2020 2020 2020 2020 2020   = (.           
-000230c0: 2020 2020 2073 656c 662e 5f65 7374 696d       self._estim
-000230d0: 6174 655f 6375 6d75 6c61 7469 7665 5f64  ate_cumulative_d
-000230e0: 6973 7472 6962 7574 696f 6e5f 6675 6e63  istribution_func
-000230f0: 7469 6f6e 280a 2020 2020 2020 2020 2020  tion(.          
-00023100: 2020 2020 2020 2020 2020 696e 7075 745f            input_
-00023110: 6469 6374 2c0a 2020 2020 2020 2020 2020  dict,.          
-00023120: 2020 2020 2020 2020 2020 636f 6d70 6172            compar
-00023130: 6564 5f65 7374 696d 6174 6f72 733d 636f  ed_estimators=co
-00023140: 6d70 6172 6564 5f65 7374 696d 6174 6f72  mpared_estimator
-00023150: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
-00023160: 2020 2020 2020 2072 6577 6172 645f 7363         reward_sc
-00023170: 616c 653d 7265 7761 7264 5f73 6361 6c65  ale=reward_scale
-00023180: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00023190: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-000231a0: 290a 0a20 2020 2020 2020 2072 6574 7572  )..        retur
-000231b0: 6e20 6375 6d75 6c61 7469 7665 5f64 6973  n cumulative_dis
-000231c0: 7472 6962 7574 696f 6e5f 6469 6374 0a0a  tribution_dict..
-000231d0: 2020 2020 6465 6620 6573 7469 6d61 7465      def estimate
-000231e0: 5f6d 6561 6e28 0a20 2020 2020 2020 2073  _mean(.        s
-000231f0: 656c 662c 0a20 2020 2020 2020 2069 6e70  elf,.        inp
-00023200: 7574 5f64 6963 743a 2055 6e69 6f6e 5b4f  ut_dict: Union[O
-00023210: 5045 496e 7075 7444 6963 742c 204d 756c  PEInputDict, Mul
-00023220: 7469 706c 6549 6e70 7574 4469 6374 5d2c  tipleInputDict],
-00023230: 0a20 2020 2020 2020 2063 6f6d 7061 7265  .        compare
-00023240: 645f 6573 7469 6d61 746f 7273 3a20 4f70  d_estimators: Op
-00023250: 7469 6f6e 616c 5b4c 6973 745b 7374 725d  tional[List[str]
-00023260: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
-00023270: 2020 6265 6861 7669 6f72 5f70 6f6c 6963    behavior_polic
-00023280: 795f 6e61 6d65 3a20 4f70 7469 6f6e 616c  y_name: Optional
-00023290: 5b73 7472 5d20 3d20 4e6f 6e65 2c0a 2020  [str] = None,.  
-000232a0: 2020 2020 2020 6461 7461 7365 745f 6964        dataset_id
-000232b0: 3a20 4f70 7469 6f6e 616c 5b69 6e74 5d20  : Optional[int] 
-000232c0: 3d20 4e6f 6e65 2c0a 2020 2020 293a 0a20  = None,.    ):. 
-000232d0: 2020 2020 2020 2022 2222 4573 7469 6d61         """Estima
-000232e0: 7465 2074 6865 2065 7870 6563 7465 6420  te the expected 
-000232f0: 7472 616a 6563 746f 7279 2d77 6973 6520  trajectory-wise 
-00023300: 7265 7761 7264 2028 692e 652e 2c20 706f  reward (i.e., po
-00023310: 6c69 6379 2076 616c 7565 2920 6f66 2074  licy value) of t
-00023320: 6865 2065 7661 6c75 6174 696f 6e20 706f  he evaluation po
-00023330: 6c69 6369 6573 2e0a 0a20 2020 2020 2020  licies...       
-00023340: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
-00023350: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
-00023360: 2020 2020 696e 7075 745f 6469 6374 3a20      input_dict: 
-00023370: 4f50 4549 6e70 7574 4469 6374 206f 7220  OPEInputDict or 
-00023380: 4d75 6c74 6970 6c65 496e 7075 7444 6963  MultipleInputDic
-00023390: 740a 2020 2020 2020 2020 2020 2020 4469  t.            Di
-000233a0: 6374 696f 6e61 7279 206f 6620 7468 6520  ctionary of the 
-000233b0: 4f50 4520 696e 7075 7473 2066 6f72 2065  OPE inputs for e
-000233c0: 6163 6820 6576 616c 7561 7469 6f6e 2070  ach evaluation p
-000233d0: 6f6c 6963 792e 0a0a 2020 2020 2020 2020  olicy...        
-000233e0: 2020 2020 2e2e 2063 6f64 652d 626c 6f63      .. code-bloc
-000233f0: 6b3a 3a20 7079 7468 6f6e 0a0a 2020 2020  k:: python..    
-00023400: 2020 2020 2020 2020 2020 2020 6b65 793a              key:
-00023410: 205b 6576 616c 7561 7469 6f6e 5f70 6f6c   [evaluation_pol
-00023420: 6963 795d 5b0a 2020 2020 2020 2020 2020  icy][.          
-00023430: 2020 2020 2020 2020 2020 6576 616c 7561            evalua
-00023440: 7469 6f6e 5f70 6f6c 6963 795f 6163 7469  tion_policy_acti
-00023450: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
-00023460: 2020 2020 2020 2020 6576 616c 7561 7469          evaluati
-00023470: 6f6e 5f70 6f6c 6963 795f 6163 7469 6f6e  on_policy_action
-00023480: 5f64 6973 742c 0a20 2020 2020 2020 2020  _dist,.         
-00023490: 2020 2020 2020 2020 2020 2073 7461 7465             state
-000234a0: 5f61 6374 696f 6e5f 7661 6c75 655f 7072  _action_value_pr
-000234b0: 6564 6963 7469 6f6e 2c0a 2020 2020 2020  ediction,.      
-000234c0: 2020 2020 2020 2020 2020 2020 2020 696e                in
-000234d0: 6974 6961 6c5f 7374 6174 655f 7661 6c75  itial_state_valu
-000234e0: 655f 7072 6564 6963 7469 6f6e 2c0a 2020  e_prediction,.  
-000234f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023500: 2020 7374 6174 655f 6163 7469 6f6e 5f6d    state_action_m
-00023510: 6172 6769 6e61 6c5f 696d 706f 7274 616e  arginal_importan
-00023520: 6365 5f77 6569 6768 742c 0a20 2020 2020  ce_weight,.     
-00023530: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00023540: 7461 7465 5f6d 6172 6769 6e61 6c5f 696d  tate_marginal_im
-00023550: 706f 7274 616e 6365 5f77 6569 6768 742c  portance_weight,
-00023560: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00023570: 2020 2020 206f 6e5f 706f 6c69 6379 5f70       on_policy_p
-00023580: 6f6c 6963 795f 7661 6c75 652c 0a20 2020  olicy_value,.   
-00023590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000235a0: 2067 616d 6d61 2c0a 2020 2020 2020 2020   gamma,.        
-000235b0: 2020 2020 2020 2020 2020 2020 6265 6861              beha
-000235c0: 7669 6f72 5f70 6f6c 6963 792c 0a20 2020  vior_policy,.   
-000235d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000235e0: 2065 7661 6c75 6174 696f 6e5f 706f 6c69   evaluation_poli
-000235f0: 6379 2c0a 2020 2020 2020 2020 2020 2020  cy,.            
-00023600: 2020 2020 2020 2020 6461 7461 7365 745f          dataset_
-00023610: 6964 2c0a 2020 2020 2020 2020 2020 2020  id,.            
-00023620: 2020 2020 5d0a 0a20 2020 2020 2020 2020      ]..         
-00023630: 2020 202e 2e20 7365 6561 6c73 6f3a 3a0a     .. seealso::.
-00023640: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00023650: 203a 636c 6173 733a 6073 636f 7065 5f72   :class:`scope_r
-00023660: 6c2e 6f70 652e 696e 7075 742e 4372 6561  l.ope.input.Crea
-00023670: 7465 4f50 4549 6e70 7574 6020 6465 7363  teOPEInput` desc
-00023680: 7269 6265 7320 7468 6520 636f 6d70 6f6e  ribes the compon
-00023690: 656e 7473 206f 6620 3a63 6c61 7373 3a60  ents of :class:`
-000236a0: 696e 7075 745f 6469 6374 602e 0a0a 2020  input_dict`...  
-000236b0: 2020 2020 2020 636f 6d70 6172 6564 5f65        compared_e
-000236c0: 7374 696d 6174 6f72 733a 206c 6973 7420  stimators: list 
-000236d0: 6f66 2073 7472 2c20 6465 6661 756c 743d  of str, default=
-000236e0: 4e6f 6e65 0a20 2020 2020 2020 2020 2020  None.           
-000236f0: 204e 616d 6520 6f66 2063 6f6d 7061 7265   Name of compare
-00023700: 6420 6573 7469 6d61 746f 7273 2e0a 2020  d estimators..  
-00023710: 2020 2020 2020 2020 2020 4966 2060 4e6f            If `No
-00023720: 6e65 6020 6973 2067 6976 656e 2c20 616c  ne` is given, al
-00023730: 6c20 7468 6520 6573 7469 6d61 746f 7273  l the estimators
-00023740: 2061 7265 2063 6f6d 7061 7265 642e 0a0a   are compared...
-00023750: 2020 2020 2020 2020 6265 6861 7669 6f72          behavior
-00023760: 5f70 6f6c 6963 795f 6e61 6d65 3a20 7374  _policy_name: st
-00023770: 722c 2064 6566 6175 6c74 3d4e 6f6e 650a  r, default=None.
-00023780: 2020 2020 2020 2020 2020 2020 4e61 6d65              Name
-00023790: 206f 6620 7468 6520 6265 6861 7669 6f72   of the behavior
-000237a0: 2070 6f6c 6963 792e 0a0a 2020 2020 2020   policy...      
-000237b0: 2020 6461 7461 7365 745f 6964 3a20 696e    dataset_id: in
-000237c0: 742c 2064 6566 6175 6c74 3d4e 6f6e 650a  t, default=None.
-000237d0: 2020 2020 2020 2020 2020 2020 4964 206f              Id o
-000237e0: 6620 7468 6520 6c6f 6767 6564 2064 6174  f the logged dat
-000237f0: 6173 6574 2e0a 0a20 2020 2020 2020 2052  aset...        R
-00023800: 6574 7572 6e0a 2020 2020 2020 2020 2d2d  eturn.        --
-00023810: 2d2d 2d2d 2d0a 2020 2020 2020 2020 6d65  -----.        me
-00023820: 616e 5f64 6963 743a 2064 6963 7420 282c  an_dict: dict (,
-00023830: 206c 6973 7420 6f66 2064 6963 7429 0a20   list of dict). 
-00023840: 2020 2020 2020 2020 2020 2044 6963 7469             Dicti
-00023850: 6f6e 6172 7920 636f 6e74 6169 6e69 6e67  onary containing
-00023860: 2074 6865 206d 6561 6e20 7472 616a 6563   the mean trajec
-00023870: 746f 7279 2d77 6973 6520 7265 7761 7264  tory-wise reward
-00023880: 206f 6620 6561 6368 2065 7661 6c75 6174   of each evaluat
-00023890: 696f 6e20 706f 6c69 6379 2065 7374 696d  ion policy estim
-000238a0: 6174 6564 2062 7920 4f50 4520 6573 7469  ated by OPE esti
-000238b0: 6d61 746f 7273 2e0a 2020 2020 2020 2020  mators..        
-000238c0: 2020 2020 6b65 793a 203a 636c 6173 733a      key: :class:
-000238d0: 605b 6576 616c 7561 7469 6f6e 5f70 6f6c  `[evaluation_pol
-000238e0: 6963 795d 5b4f 5045 5f65 7374 696d 6174  icy][OPE_estimat
-000238f0: 6f72 5f6e 616d 655d 600a 0a20 2020 2020  or_name]`..     
-00023900: 2020 2020 2020 2057 6865 6e20 6265 6861         When beha
-00023910: 7669 6f72 5f70 6f6c 6963 795f 6e61 6d65  vior_policy_name
-00023920: 2069 7320 604e 6f6e 6560 2061 6e64 2064   is `None` and d
-00023930: 6174 6173 6574 5f69 6420 6973 2060 4e6f  ataset_id is `No
-00023940: 6e65 602c 0a20 2020 2020 2020 2020 2020  ne`,.           
-00023950: 206b 6579 3a20 3a63 6c61 7373 3a60 5b62   key: :class:`[b
-00023960: 6568 6176 696f 725f 706f 6c69 6379 5f6e  ehavior_policy_n
-00023970: 616d 655d 5b64 6174 6173 6574 5f69 645d  ame][dataset_id]
-00023980: 5b65 7661 6c75 6174 696f 6e5f 706f 6c69  [evaluation_poli
-00023990: 6379 5d5b 4f50 455f 6573 7469 6d61 746f  cy][OPE_estimato
-000239a0: 725f 6e61 6d65 5d60 0a0a 2020 2020 2020  r_name]`..      
-000239b0: 2020 2020 2020 5768 656e 2062 6568 6176        When behav
-000239c0: 696f 725f 706f 6c69 6379 5f6e 616d 6520  ior_policy_name 
-000239d0: 6973 2060 4e6f 6e65 6020 616e 6420 6461  is `None` and da
-000239e0: 7461 7365 745f 6964 2069 7320 7370 6563  taset_id is spec
-000239f0: 6966 6965 642c 0a20 2020 2020 2020 2020  ified,.         
-00023a00: 2020 206b 6579 3a20 3a63 6c61 7373 3a60     key: :class:`
-00023a10: 5b62 6568 6176 696f 725f 706f 6c69 6379  [behavior_policy
-00023a20: 5f6e 616d 655d 5b65 7661 6c75 6174 696f  _name][evaluatio
-00023a30: 6e5f 706f 6c69 6379 5d5b 4f50 455f 6573  n_policy][OPE_es
-00023a40: 7469 6d61 746f 725f 6e61 6d65 5d60 0a0a  timator_name]`..
-00023a50: 2020 2020 2020 2020 2020 2020 5768 656e              When
-00023a60: 2062 6568 6176 696f 725f 706f 6c69 6379   behavior_policy
-00023a70: 5f6e 616d 6520 6973 2073 7065 6369 6669  _name is specifi
-00023a80: 6564 2061 6e64 2064 6174 6173 6574 5f69  ed and dataset_i
-00023a90: 6420 6973 2060 4e6f 6e65 602c 0a20 2020  d is `None`,.   
-00023aa0: 2020 2020 2020 2020 206b 6579 3a20 3a63           key: :c
-00023ab0: 6c61 7373 3a60 5b64 6174 6173 6574 5f69  lass:`[dataset_i
-00023ac0: 645d 5b4f 5045 5f65 7374 696d 6174 6f72  d][OPE_estimator
-00023ad0: 5f6e 616d 655d 600a 0a20 2020 2020 2020  _name]`..       
-00023ae0: 2022 2222 0a20 2020 2020 2020 2063 6f6d   """.        com
-00023af0: 7061 7265 645f 6573 7469 6d61 746f 7273  pared_estimators
-00023b00: 203d 2073 656c 662e 5f63 6865 636b 5f63   = self._check_c
-00023b10: 6f6d 7061 7265 645f 6573 7469 6d61 746f  ompared_estimato
-00023b20: 7273 2863 6f6d 7061 7265 645f 6573 7469  rs(compared_esti
-00023b30: 6d61 746f 7273 290a 0a20 2020 2020 2020  mators)..       
-00023b40: 2069 6620 7365 6c66 2e75 7365 5f6d 756c   if self.use_mul
-00023b50: 7469 706c 655f 6c6f 6767 6564 5f64 6174  tiple_logged_dat
-00023b60: 6173 6574 3a0a 2020 2020 2020 2020 2020  aset:.          
-00023b70: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-00023b80: 696e 7075 745f 6469 6374 2c20 4d75 6c74  input_dict, Mult
-00023b90: 6970 6c65 496e 7075 7444 6963 7429 3a0a  ipleInputDict):.
+00022aa0: 2020 2020 2020 2020 2062 6568 6176 696f           behavio
+00022ab0: 725f 706f 6c69 6379 5f6e 616d 653d 6265  r_policy_name=be
+00022ac0: 6861 7669 6f72 5f70 6f6c 6963 795f 6e61  havior_policy_na
+00022ad0: 6d65 2c20 6461 7461 7365 745f 6964 3d64  me, dataset_id=d
+00022ae0: 6174 6173 6574 5f69 640a 2020 2020 2020  ataset_id.      
+00022af0: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+00022b00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00022b10: 2020 2020 2063 756d 756c 6174 6976 655f       cumulative_
+00022b20: 6469 7374 7269 6275 7469 6f6e 5f64 6963  distribution_dic
+00022b30: 7420 3d20 280a 2020 2020 2020 2020 2020  t = (.          
+00022b40: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00022b50: 6c66 2e5f 6573 7469 6d61 7465 5f63 756d  lf._estimate_cum
+00022b60: 756c 6174 6976 655f 6469 7374 7269 6275  ulative_distribu
+00022b70: 7469 6f6e 5f66 756e 6374 696f 6e28 0a20  tion_function(. 
+00022b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022b90: 2020 2020 2020 2020 2020 2069 6e70 7574             input
+00022ba0: 5f64 6963 745f 2c0a 2020 2020 2020 2020  _dict_,.        
+00022bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022bc0: 2020 2020 636f 6d70 6172 6564 5f65 7374      compared_est
+00022bd0: 696d 6174 6f72 733d 636f 6d70 6172 6564  imators=compared
+00022be0: 5f65 7374 696d 6174 6f72 732c 0a20 2020  _estimators,.   
+00022bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022c00: 2020 2020 2020 2020 2072 6577 6172 645f           reward_
+00022c10: 7363 616c 653d 7265 7761 7264 5f73 6361  scale=reward_sca
+00022c20: 6c65 2c0a 2020 2020 2020 2020 2020 2020  le,.            
+00022c30: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00022c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022c50: 2020 290a 0a20 2020 2020 2020 2020 2020    )..           
+00022c60: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00022c70: 2020 2020 2020 2062 6568 6176 696f 725f         behavior_
+00022c80: 706f 6c69 6379 5f6e 616d 6520 3d20 6c69  policy_name = li
+00022c90: 7374 2869 6e70 7574 5f64 6963 742e 7661  st(input_dict.va
+00022ca0: 6c75 6573 2829 295b 305d 5b22 6265 6861  lues())[0]["beha
+00022cb0: 7669 6f72 5f70 6f6c 6963 7922 5d0a 2020  vior_policy"].  
+00022cc0: 2020 2020 2020 2020 2020 2020 2020 6461                da
+00022cd0: 7461 7365 745f 6964 203d 206c 6973 7428  taset_id = list(
+00022ce0: 696e 7075 745f 6469 6374 2e76 616c 7565  input_dict.value
+00022cf0: 7328 2929 5b30 5d5b 2264 6174 6173 6574  s())[0]["dataset
+00022d00: 5f69 6422 5d0a 0a20 2020 2020 2020 2020  _id"]..         
+00022d10: 2020 2020 2020 2073 656c 662e 5f72 6567         self._reg
+00022d20: 6973 7465 725f 6c6f 6767 6564 5f64 6174  ister_logged_dat
+00022d30: 6173 6574 280a 2020 2020 2020 2020 2020  aset(.          
+00022d40: 2020 2020 2020 2020 2020 6265 6861 7669            behavi
+00022d50: 6f72 5f70 6f6c 6963 795f 6e61 6d65 3d62  or_policy_name=b
+00022d60: 6568 6176 696f 725f 706f 6c69 6379 5f6e  ehavior_policy_n
+00022d70: 616d 652c 2064 6174 6173 6574 5f69 643d  ame, dataset_id=
+00022d80: 6461 7461 7365 745f 6964 0a20 2020 2020  dataset_id.     
+00022d90: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
+00022da0: 2020 2020 2020 2020 2020 2020 2020 6375                cu
+00022db0: 6d75 6c61 7469 7665 5f64 6973 7472 6962  mulative_distrib
+00022dc0: 7574 696f 6e5f 6469 6374 203d 2028 0a20  ution_dict = (. 
+00022dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022de0: 2020 2073 656c 662e 5f65 7374 696d 6174     self._estimat
+00022df0: 655f 6375 6d75 6c61 7469 7665 5f64 6973  e_cumulative_dis
+00022e00: 7472 6962 7574 696f 6e5f 6675 6e63 7469  tribution_functi
+00022e10: 6f6e 280a 2020 2020 2020 2020 2020 2020  on(.            
+00022e20: 2020 2020 2020 2020 2020 2020 696e 7075              inpu
+00022e30: 745f 6469 6374 2c0a 2020 2020 2020 2020  t_dict,.        
+00022e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022e50: 636f 6d70 6172 6564 5f65 7374 696d 6174  compared_estimat
+00022e60: 6f72 733d 636f 6d70 6172 6564 5f65 7374  ors=compared_est
+00022e70: 696d 6174 6f72 732c 0a20 2020 2020 2020  imators,.       
+00022e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022e90: 2072 6577 6172 645f 7363 616c 653d 7265   reward_scale=re
+00022ea0: 7761 7264 5f73 6361 6c65 2c0a 2020 2020  ward_scale,.    
+00022eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022ec0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00022ed0: 2020 290a 0a20 2020 2020 2020 2065 6c73    )..        els
+00022ee0: 653a 0a20 2020 2020 2020 2020 2020 2069  e:.            i
+00022ef0: 6620 6973 696e 7374 616e 6365 2869 6e70  f isinstance(inp
+00022f00: 7574 5f64 6963 742c 204d 756c 7469 706c  ut_dict, Multipl
+00022f10: 6549 6e70 7574 4469 6374 293a 0a20 2020  eInputDict):.   
+00022f20: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+00022f30: 7365 2056 616c 7565 4572 726f 7228 0a20  se ValueError(. 
+00022f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022f50: 2020 2022 7768 656e 2075 7369 6e67 204c     "when using L
+00022f60: 6f67 6765 6444 6174 6173 6574 2c20 706c  oggedDataset, pl
+00022f70: 6561 7365 2075 7365 2049 6e70 7574 4469  ease use InputDi
+00022f80: 6374 2069 6e73 7465 6164 206f 6620 4d75  ct instead of Mu
+00022f90: 6c74 6970 6c65 496e 7075 7444 6963 7422  ltipleInputDict"
+00022fa0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00022fb0: 2029 0a0a 2020 2020 2020 2020 2020 2020   )..            
+00022fc0: 6375 6d75 6c61 7469 7665 5f64 6973 7472  cumulative_distr
+00022fd0: 6962 7574 696f 6e5f 6469 6374 203d 2028  ibution_dict = (
+00022fe0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00022ff0: 2073 656c 662e 5f65 7374 696d 6174 655f   self._estimate_
+00023000: 6375 6d75 6c61 7469 7665 5f64 6973 7472  cumulative_distr
+00023010: 6962 7574 696f 6e5f 6675 6e63 7469 6f6e  ibution_function
+00023020: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00023030: 2020 2020 2020 696e 7075 745f 6469 6374        input_dict
+00023040: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00023050: 2020 2020 2020 636f 6d70 6172 6564 5f65        compared_e
+00023060: 7374 696d 6174 6f72 733d 636f 6d70 6172  stimators=compar
+00023070: 6564 5f65 7374 696d 6174 6f72 732c 0a20  ed_estimators,. 
+00023080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023090: 2020 2072 6577 6172 645f 7363 616c 653d     reward_scale=
+000230a0: 7265 7761 7264 5f73 6361 6c65 2c0a 2020  reward_scale,.  
+000230b0: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+000230c0: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+000230d0: 2020 2020 2020 2072 6574 7572 6e20 6375         return cu
+000230e0: 6d75 6c61 7469 7665 5f64 6973 7472 6962  mulative_distrib
+000230f0: 7574 696f 6e5f 6469 6374 0a0a 2020 2020  ution_dict..    
+00023100: 6465 6620 6573 7469 6d61 7465 5f6d 6561  def estimate_mea
+00023110: 6e28 0a20 2020 2020 2020 2073 656c 662c  n(.        self,
+00023120: 0a20 2020 2020 2020 2069 6e70 7574 5f64  .        input_d
+00023130: 6963 743a 2055 6e69 6f6e 5b4f 5045 496e  ict: Union[OPEIn
+00023140: 7075 7444 6963 742c 204d 756c 7469 706c  putDict, Multipl
+00023150: 6549 6e70 7574 4469 6374 5d2c 0a20 2020  eInputDict],.   
+00023160: 2020 2020 2063 6f6d 7061 7265 645f 6573       compared_es
+00023170: 7469 6d61 746f 7273 3a20 4f70 7469 6f6e  timators: Option
+00023180: 616c 5b4c 6973 745b 7374 725d 5d20 3d20  al[List[str]] = 
+00023190: 4e6f 6e65 2c0a 2020 2020 2020 2020 6265  None,.        be
+000231a0: 6861 7669 6f72 5f70 6f6c 6963 795f 6e61  havior_policy_na
+000231b0: 6d65 3a20 4f70 7469 6f6e 616c 5b73 7472  me: Optional[str
+000231c0: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
+000231d0: 2020 6461 7461 7365 745f 6964 3a20 4f70    dataset_id: Op
+000231e0: 7469 6f6e 616c 5b69 6e74 5d20 3d20 4e6f  tional[int] = No
+000231f0: 6e65 2c0a 2020 2020 293a 0a20 2020 2020  ne,.    ):.     
+00023200: 2020 2022 2222 4573 7469 6d61 7465 2074     """Estimate t
+00023210: 6865 2065 7870 6563 7465 6420 7472 616a  he expected traj
+00023220: 6563 746f 7279 2d77 6973 6520 7265 7761  ectory-wise rewa
+00023230: 7264 2028 692e 652e 2c20 706f 6c69 6379  rd (i.e., policy
+00023240: 2076 616c 7565 2920 6f66 2074 6865 2065   value) of the e
+00023250: 7661 6c75 6174 696f 6e20 706f 6c69 6369  valuation polici
+00023260: 6573 2e0a 0a20 2020 2020 2020 2050 6172  es...        Par
+00023270: 616d 6574 6572 730a 2020 2020 2020 2020  ameters.        
+00023280: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+00023290: 696e 7075 745f 6469 6374 3a20 4f50 4549  input_dict: OPEI
+000232a0: 6e70 7574 4469 6374 206f 7220 4d75 6c74  nputDict or Mult
+000232b0: 6970 6c65 496e 7075 7444 6963 740a 2020  ipleInputDict.  
+000232c0: 2020 2020 2020 2020 2020 4469 6374 696f            Dictio
+000232d0: 6e61 7279 206f 6620 7468 6520 4f50 4520  nary of the OPE 
+000232e0: 696e 7075 7473 2066 6f72 2065 6163 6820  inputs for each 
+000232f0: 6576 616c 7561 7469 6f6e 2070 6f6c 6963  evaluation polic
+00023300: 792e 0a0a 2020 2020 2020 2020 2020 2020  y...            
+00023310: 2e2e 2063 6f64 652d 626c 6f63 6b3a 3a20  .. code-block:: 
+00023320: 7079 7468 6f6e 0a0a 2020 2020 2020 2020  python..        
+00023330: 2020 2020 2020 2020 6b65 793a 205b 6576          key: [ev
+00023340: 616c 7561 7469 6f6e 5f70 6f6c 6963 795d  aluation_policy]
+00023350: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
+00023360: 2020 2020 2020 6576 616c 7561 7469 6f6e        evaluation
+00023370: 5f70 6f6c 6963 795f 6163 7469 6f6e 2c0a  _policy_action,.
+00023380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023390: 2020 2020 6576 616c 7561 7469 6f6e 5f70      evaluation_p
+000233a0: 6f6c 6963 795f 6163 7469 6f6e 5f64 6973  olicy_action_dis
+000233b0: 742c 0a20 2020 2020 2020 2020 2020 2020  t,.             
+000233c0: 2020 2020 2020 2073 7461 7465 5f61 6374         state_act
+000233d0: 696f 6e5f 7661 6c75 655f 7072 6564 6963  ion_value_predic
+000233e0: 7469 6f6e 2c0a 2020 2020 2020 2020 2020  tion,.          
+000233f0: 2020 2020 2020 2020 2020 696e 6974 6961            initia
+00023400: 6c5f 7374 6174 655f 7661 6c75 655f 7072  l_state_value_pr
+00023410: 6564 6963 7469 6f6e 2c0a 2020 2020 2020  ediction,.      
+00023420: 2020 2020 2020 2020 2020 2020 2020 7374                st
+00023430: 6174 655f 6163 7469 6f6e 5f6d 6172 6769  ate_action_margi
+00023440: 6e61 6c5f 696d 706f 7274 616e 6365 5f77  nal_importance_w
+00023450: 6569 6768 742c 0a20 2020 2020 2020 2020  eight,.         
+00023460: 2020 2020 2020 2020 2020 2073 7461 7465             state
+00023470: 5f6d 6172 6769 6e61 6c5f 696d 706f 7274  _marginal_import
+00023480: 616e 6365 5f77 6569 6768 742c 0a20 2020  ance_weight,.   
+00023490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000234a0: 206f 6e5f 706f 6c69 6379 5f70 6f6c 6963   on_policy_polic
+000234b0: 795f 7661 6c75 652c 0a20 2020 2020 2020  y_value,.       
+000234c0: 2020 2020 2020 2020 2020 2020 2067 616d               gam
+000234d0: 6d61 2c0a 2020 2020 2020 2020 2020 2020  ma,.            
+000234e0: 2020 2020 2020 2020 6265 6861 7669 6f72          behavior
+000234f0: 5f70 6f6c 6963 792c 0a20 2020 2020 2020  _policy,.       
+00023500: 2020 2020 2020 2020 2020 2020 2065 7661               eva
+00023510: 6c75 6174 696f 6e5f 706f 6c69 6379 2c0a  luation_policy,.
+00023520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023530: 2020 2020 6461 7461 7365 745f 6964 2c0a      dataset_id,.
+00023540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023550: 5d0a 0a20 2020 2020 2020 2020 2020 202e  ]..            .
+00023560: 2e20 7365 6561 6c73 6f3a 3a0a 0a20 2020  . seealso::..   
+00023570: 2020 2020 2020 2020 2020 2020 203a 636c               :cl
+00023580: 6173 733a 6073 636f 7065 5f72 6c2e 6f70  ass:`scope_rl.op
+00023590: 652e 696e 7075 742e 4372 6561 7465 4f50  e.input.CreateOP
+000235a0: 4549 6e70 7574 6020 6465 7363 7269 6265  EInput` describe
+000235b0: 7320 7468 6520 636f 6d70 6f6e 656e 7473  s the components
+000235c0: 206f 6620 3a63 6c61 7373 3a60 696e 7075   of :class:`inpu
+000235d0: 745f 6469 6374 602e 0a0a 2020 2020 2020  t_dict`...      
+000235e0: 2020 636f 6d70 6172 6564 5f65 7374 696d    compared_estim
+000235f0: 6174 6f72 733a 206c 6973 7420 6f66 2073  ators: list of s
+00023600: 7472 2c20 6465 6661 756c 743d 4e6f 6e65  tr, default=None
+00023610: 0a20 2020 2020 2020 2020 2020 204e 616d  .            Nam
+00023620: 6520 6f66 2063 6f6d 7061 7265 6420 6573  e of compared es
+00023630: 7469 6d61 746f 7273 2e0a 2020 2020 2020  timators..      
+00023640: 2020 2020 2020 4966 2060 4e6f 6e65 6020        If `None` 
+00023650: 6973 2067 6976 656e 2c20 616c 6c20 7468  is given, all th
+00023660: 6520 6573 7469 6d61 746f 7273 2061 7265  e estimators are
+00023670: 2063 6f6d 7061 7265 642e 0a0a 2020 2020   compared...    
+00023680: 2020 2020 6265 6861 7669 6f72 5f70 6f6c      behavior_pol
+00023690: 6963 795f 6e61 6d65 3a20 7374 722c 2064  icy_name: str, d
+000236a0: 6566 6175 6c74 3d4e 6f6e 650a 2020 2020  efault=None.    
+000236b0: 2020 2020 2020 2020 4e61 6d65 206f 6620          Name of 
+000236c0: 7468 6520 6265 6861 7669 6f72 2070 6f6c  the behavior pol
+000236d0: 6963 792e 0a0a 2020 2020 2020 2020 6461  icy...        da
+000236e0: 7461 7365 745f 6964 3a20 696e 742c 2064  taset_id: int, d
+000236f0: 6566 6175 6c74 3d4e 6f6e 650a 2020 2020  efault=None.    
+00023700: 2020 2020 2020 2020 4964 206f 6620 7468          Id of th
+00023710: 6520 6c6f 6767 6564 2064 6174 6173 6574  e logged dataset
+00023720: 2e0a 0a20 2020 2020 2020 2052 6574 7572  ...        Retur
+00023730: 6e0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  n.        ------
+00023740: 2d0a 2020 2020 2020 2020 6d65 616e 5f64  -.        mean_d
+00023750: 6963 743a 2064 6963 7420 282c 206c 6973  ict: dict (, lis
+00023760: 7420 6f66 2064 6963 7429 0a20 2020 2020  t of dict).     
+00023770: 2020 2020 2020 2044 6963 7469 6f6e 6172         Dictionar
+00023780: 7920 636f 6e74 6169 6e69 6e67 2074 6865  y containing the
+00023790: 206d 6561 6e20 7472 616a 6563 746f 7279   mean trajectory
+000237a0: 2d77 6973 6520 7265 7761 7264 206f 6620  -wise reward of 
+000237b0: 6561 6368 2065 7661 6c75 6174 696f 6e20  each evaluation 
+000237c0: 706f 6c69 6379 2065 7374 696d 6174 6564  policy estimated
+000237d0: 2062 7920 4f50 4520 6573 7469 6d61 746f   by OPE estimato
+000237e0: 7273 2e0a 2020 2020 2020 2020 2020 2020  rs..            
+000237f0: 6b65 793a 203a 636c 6173 733a 605b 6576  key: :class:`[ev
+00023800: 616c 7561 7469 6f6e 5f70 6f6c 6963 795d  aluation_policy]
+00023810: 5b4f 5045 5f65 7374 696d 6174 6f72 5f6e  [OPE_estimator_n
+00023820: 616d 655d 600a 0a20 2020 2020 2020 2020  ame]`..         
+00023830: 2020 2057 6865 6e20 6265 6861 7669 6f72     When behavior
+00023840: 5f70 6f6c 6963 795f 6e61 6d65 2069 7320  _policy_name is 
+00023850: 604e 6f6e 6560 2061 6e64 2064 6174 6173  `None` and datas
+00023860: 6574 5f69 6420 6973 2060 4e6f 6e65 602c  et_id is `None`,
+00023870: 0a20 2020 2020 2020 2020 2020 206b 6579  .            key
+00023880: 3a20 3a63 6c61 7373 3a60 5b62 6568 6176  : :class:`[behav
+00023890: 696f 725f 706f 6c69 6379 5f6e 616d 655d  ior_policy_name]
+000238a0: 5b64 6174 6173 6574 5f69 645d 5b65 7661  [dataset_id][eva
+000238b0: 6c75 6174 696f 6e5f 706f 6c69 6379 5d5b  luation_policy][
+000238c0: 4f50 455f 6573 7469 6d61 746f 725f 6e61  OPE_estimator_na
+000238d0: 6d65 5d60 0a0a 2020 2020 2020 2020 2020  me]`..          
+000238e0: 2020 5768 656e 2062 6568 6176 696f 725f    When behavior_
+000238f0: 706f 6c69 6379 5f6e 616d 6520 6973 2060  policy_name is `
+00023900: 4e6f 6e65 6020 616e 6420 6461 7461 7365  None` and datase
+00023910: 745f 6964 2069 7320 7370 6563 6966 6965  t_id is specifie
+00023920: 642c 0a20 2020 2020 2020 2020 2020 206b  d,.            k
+00023930: 6579 3a20 3a63 6c61 7373 3a60 5b62 6568  ey: :class:`[beh
+00023940: 6176 696f 725f 706f 6c69 6379 5f6e 616d  avior_policy_nam
+00023950: 655d 5b65 7661 6c75 6174 696f 6e5f 706f  e][evaluation_po
+00023960: 6c69 6379 5d5b 4f50 455f 6573 7469 6d61  licy][OPE_estima
+00023970: 746f 725f 6e61 6d65 5d60 0a0a 2020 2020  tor_name]`..    
+00023980: 2020 2020 2020 2020 5768 656e 2062 6568          When beh
+00023990: 6176 696f 725f 706f 6c69 6379 5f6e 616d  avior_policy_nam
+000239a0: 6520 6973 2073 7065 6369 6669 6564 2061  e is specified a
+000239b0: 6e64 2064 6174 6173 6574 5f69 6420 6973  nd dataset_id is
+000239c0: 2060 4e6f 6e65 602c 0a20 2020 2020 2020   `None`,.       
+000239d0: 2020 2020 206b 6579 3a20 3a63 6c61 7373       key: :class
+000239e0: 3a60 5b64 6174 6173 6574 5f69 645d 5b4f  :`[dataset_id][O
+000239f0: 5045 5f65 7374 696d 6174 6f72 5f6e 616d  PE_estimator_nam
+00023a00: 655d 600a 0a20 2020 2020 2020 2022 2222  e]`..        """
+00023a10: 0a20 2020 2020 2020 2063 6f6d 7061 7265  .        compare
+00023a20: 645f 6573 7469 6d61 746f 7273 203d 2073  d_estimators = s
+00023a30: 656c 662e 5f63 6865 636b 5f63 6f6d 7061  elf._check_compa
+00023a40: 7265 645f 6573 7469 6d61 746f 7273 2863  red_estimators(c
+00023a50: 6f6d 7061 7265 645f 6573 7469 6d61 746f  ompared_estimato
+00023a60: 7273 290a 0a20 2020 2020 2020 2069 6620  rs)..        if 
+00023a70: 7365 6c66 2e75 7365 5f6d 756c 7469 706c  self.use_multipl
+00023a80: 655f 6c6f 6767 6564 5f64 6174 6173 6574  e_logged_dataset
+00023a90: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+00023aa0: 2069 7369 6e73 7461 6e63 6528 696e 7075   isinstance(inpu
+00023ab0: 745f 6469 6374 2c20 4d75 6c74 6970 6c65  t_dict, Multiple
+00023ac0: 496e 7075 7444 6963 7429 3a0a 2020 2020  InputDict):.    
+00023ad0: 2020 2020 2020 2020 2020 2020 6966 2062              if b
+00023ae0: 6568 6176 696f 725f 706f 6c69 6379 5f6e  ehavior_policy_n
+00023af0: 616d 6520 6973 204e 6f6e 6520 616e 6420  ame is None and 
+00023b00: 6461 7461 7365 745f 6964 2069 7320 4e6f  dataset_id is No
+00023b10: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+00023b20: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00023b30: 6d75 6c74 6970 6c65 5f6c 6f67 6765 645f  multiple_logged_
+00023b40: 6461 7461 7365 742e 6e5f 6461 7461 7365  dataset.n_datase
+00023b50: 7473 2021 3d20 696e 7075 745f 6469 6374  ts != input_dict
+00023b60: 2e6e 5f64 6174 6173 6574 733a 0a20 2020  .n_datasets:.   
+00023b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023b80: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+00023b90: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
 00023ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023bb0: 6966 2062 6568 6176 696f 725f 706f 6c69  if behavior_poli
-00023bc0: 6379 5f6e 616d 6520 6973 204e 6f6e 6520  cy_name is None 
-00023bd0: 616e 6420 6461 7461 7365 745f 6964 2069  and dataset_id i
-00023be0: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
-00023bf0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-00023c00: 656c 662e 6d75 6c74 6970 6c65 5f6c 6f67  elf.multiple_log
-00023c10: 6765 645f 6461 7461 7365 742e 6e5f 6461  ged_dataset.n_da
-00023c20: 7461 7365 7473 2021 3d20 696e 7075 745f  tasets != input_
-00023c30: 6469 6374 2e6e 5f64 6174 6173 6574 733a  dict.n_datasets:
-00023c40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00023c50: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-00023c60: 616c 7565 4572 726f 7228 0a20 2020 2020  alueError(.     
-00023c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023c80: 2020 2020 2020 2022 4578 7065 6374 6564         "Expected
-00023c90: 2074 6861 7420 6c6f 6767 6564 2064 6174   that logged dat
-00023ca0: 6173 6574 7320 616e 6420 696e 7075 7420  asets and input 
-00023cb0: 6469 6374 7320 636f 6e73 6973 7473 206f  dicts consists o
-00023cc0: 6620 7468 6520 7361 6d65 2062 6568 6176  f the same behav
-00023cd0: 696f 7220 706f 6c69 6369 6573 2061 6e64  ior policies and
-00023ce0: 2064 6174 6173 6574 2069 6473 2c20 6275   dataset ids, bu
-00023cf0: 7420 666f 756e 6420 4661 6c73 652e 220a  t found False.".
-00023d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023d10: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
-00023d20: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-00023d30: 6561 6e5f 6469 6374 203d 2064 6566 6175  ean_dict = defau
-00023d40: 6c74 6469 6374 286c 6973 7429 0a20 2020  ltdict(list).   
-00023d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023d60: 2066 6f72 2028 0a20 2020 2020 2020 2020   for (.         
-00023d70: 2020 2020 2020 2020 2020 2020 2020 2062                 b
-00023d80: 6568 6176 696f 725f 706f 6c69 6379 2c0a  ehavior_policy,.
-00023d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023da0: 2020 2020 2020 2020 6e5f 6461 7461 7365          n_datase
-00023db0: 7473 2c0a 2020 2020 2020 2020 2020 2020  ts,.            
-00023dc0: 2020 2020 2020 2020 2920 696e 2069 6e70          ) in inp
-00023dd0: 7574 5f64 6963 742e 6e5f 6461 7461 7365  ut_dict.n_datase
-00023de0: 7473 2e69 7465 6d73 2829 3a0a 2020 2020  ts.items():.    
-00023df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023e00: 2020 2020 666f 7220 6461 7461 7365 745f      for dataset_
-00023e10: 6964 5f20 696e 2072 616e 6765 286e 5f64  id_ in range(n_d
-00023e20: 6174 6173 6574 7329 3a0a 2020 2020 2020  atasets):.      
+00023bb0: 2020 2022 4578 7065 6374 6564 2074 6861     "Expected tha
+00023bc0: 7420 6c6f 6767 6564 2064 6174 6173 6574  t logged dataset
+00023bd0: 7320 616e 6420 696e 7075 7420 6469 6374  s and input dict
+00023be0: 7320 636f 6e73 6973 7473 206f 6620 7468  s consists of th
+00023bf0: 6520 7361 6d65 2062 6568 6176 696f 7220  e same behavior 
+00023c00: 706f 6c69 6369 6573 2061 6e64 2064 6174  policies and dat
+00023c10: 6173 6574 2069 6473 2c20 6275 7420 666f  aset ids, but fo
+00023c20: 756e 6420 4661 6c73 652e 220a 2020 2020  und False.".    
+00023c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023c40: 2020 2020 290a 0a20 2020 2020 2020 2020      )..         
+00023c50: 2020 2020 2020 2020 2020 206d 6561 6e5f             mean_
+00023c60: 6469 6374 203d 2064 6566 6175 6c74 6469  dict = defaultdi
+00023c70: 6374 286c 6973 7429 0a20 2020 2020 2020  ct(list).       
+00023c80: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+00023c90: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
+00023ca0: 2020 2020 2020 2020 2020 2062 6568 6176             behav
+00023cb0: 696f 725f 706f 6c69 6379 2c0a 2020 2020  ior_policy,.    
+00023cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023cd0: 2020 2020 6e5f 6461 7461 7365 7473 2c0a      n_datasets,.
+00023ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023cf0: 2020 2020 2920 696e 2069 6e70 7574 5f64      ) in input_d
+00023d00: 6963 742e 6e5f 6461 7461 7365 7473 2e69  ict.n_datasets.i
+00023d10: 7465 6d73 2829 3a0a 2020 2020 2020 2020  tems():.        
+00023d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023d30: 666f 7220 6461 7461 7365 745f 6964 5f20  for dataset_id_ 
+00023d40: 696e 2072 616e 6765 286e 5f64 6174 6173  in range(n_datas
+00023d50: 6574 7329 3a0a 2020 2020 2020 2020 2020  ets):.          
+00023d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023d70: 2020 7365 6c66 2e5f 7265 6769 7374 6572    self._register
+00023d80: 5f6c 6f67 6765 645f 6461 7461 7365 7428  _logged_dataset(
+00023d90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00023da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023db0: 2062 6568 6176 696f 725f 706f 6c69 6379   behavior_policy
+00023dc0: 5f6e 616d 653d 6265 6861 7669 6f72 5f70  _name=behavior_p
+00023dd0: 6f6c 6963 792c 0a20 2020 2020 2020 2020  olicy,.         
+00023de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023df0: 2020 2020 2020 2064 6174 6173 6574 5f69         dataset_i
+00023e00: 643d 6461 7461 7365 745f 6964 5f2c 0a20  d=dataset_id_,. 
+00023e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023e20: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
 00023e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023e40: 2020 2020 2020 7365 6c66 2e5f 7265 6769        self._regi
-00023e50: 7374 6572 5f6c 6f67 6765 645f 6461 7461  ster_logged_data
-00023e60: 7365 7428 0a20 2020 2020 2020 2020 2020  set(.           
+00023e40: 2020 2020 2020 2020 2069 6e70 7574 5f64           input_d
+00023e50: 6963 745f 203d 2069 6e70 7574 5f64 6963  ict_ = input_dic
+00023e60: 742e 6765 7428 0a20 2020 2020 2020 2020  t.get(.         
 00023e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023e80: 2020 2020 2062 6568 6176 696f 725f 706f       behavior_po
-00023e90: 6c69 6379 5f6e 616d 653d 6265 6861 7669  licy_name=behavi
-00023ea0: 6f72 5f70 6f6c 6963 792c 0a20 2020 2020  or_policy,.     
+00023e80: 2020 2020 2020 2062 6568 6176 696f 725f         behavior_
+00023e90: 706f 6c69 6379 5f6e 616d 653d 6265 6861  policy_name=beha
+00023ea0: 7669 6f72 5f70 6f6c 6963 792c 0a20 2020  vior_policy,.   
 00023eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023ec0: 2020 2020 2020 2020 2020 2064 6174 6173             datas
-00023ed0: 6574 5f69 643d 6461 7461 7365 745f 6964  et_id=dataset_id
-00023ee0: 5f2c 0a20 2020 2020 2020 2020 2020 2020  _,.             
-00023ef0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-00023f00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00023f10: 2020 2020 2020 2020 2020 2020 2069 6e70               inp
-00023f20: 7574 5f64 6963 745f 203d 2069 6e70 7574  ut_dict_ = input
-00023f30: 5f64 6963 742e 6765 7428 0a20 2020 2020  _dict.get(.     
-00023f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023f50: 2020 2020 2020 2020 2020 2062 6568 6176             behav
-00023f60: 696f 725f 706f 6c69 6379 5f6e 616d 653d  ior_policy_name=
-00023f70: 6265 6861 7669 6f72 5f70 6f6c 6963 792c  behavior_policy,
-00023f80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00023f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023fa0: 2064 6174 6173 6574 5f69 643d 6461 7461   dataset_id=data
-00023fb0: 7365 745f 6964 5f2c 0a20 2020 2020 2020  set_id_,.       
+00023ec0: 2020 2020 2020 2020 2020 2020 2064 6174               dat
+00023ed0: 6173 6574 5f69 643d 6461 7461 7365 745f  aset_id=dataset_
+00023ee0: 6964 5f2c 0a20 2020 2020 2020 2020 2020  id_,.           
+00023ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023f00: 2029 0a0a 2020 2020 2020 2020 2020 2020   )..            
+00023f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023f20: 6d65 616e 5f64 6963 745f 203d 2073 656c  mean_dict_ = sel
+00023f30: 662e 5f65 7374 696d 6174 655f 6d65 616e  f._estimate_mean
+00023f40: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00023f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023f60: 2020 696e 7075 745f 6469 6374 5f2c 0a20    input_dict_,. 
+00023f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023f80: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00023f90: 6f6d 7061 7265 645f 6573 7469 6d61 746f  ompared_estimato
+00023fa0: 7273 3d63 6f6d 7061 7265 645f 6573 7469  rs=compared_esti
+00023fb0: 6d61 746f 7273 2c0a 2020 2020 2020 2020  mators,.        
 00023fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023fd0: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+00023fd0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
 00023fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00023ff0: 2020 2020 6d65 616e 5f64 6963 745f 203d      mean_dict_ =
-00024000: 2073 656c 662e 5f65 7374 696d 6174 655f   self._estimate_
-00024010: 6d65 616e 280a 2020 2020 2020 2020 2020  mean(.          
-00024020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024030: 2020 2020 2020 696e 7075 745f 6469 6374        input_dict
-00024040: 5f2c 0a20 2020 2020 2020 2020 2020 2020  _,.             
-00024050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024060: 2020 2063 6f6d 7061 7265 645f 6573 7469     compared_esti
-00024070: 6d61 746f 7273 3d63 6f6d 7061 7265 645f  mators=compared_
-00024080: 6573 7469 6d61 746f 7273 2c0a 2020 2020  estimators,.    
-00024090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000240a0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00023ff0: 2020 6d65 616e 5f64 6963 745b 6265 6861    mean_dict[beha
+00024000: 7669 6f72 5f70 6f6c 6963 795d 2e61 7070  vior_policy].app
+00024010: 656e 6428 6d65 616e 5f64 6963 745f 290a  end(mean_dict_).
+00024020: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00024030: 2020 2020 206d 6561 6e5f 6469 6374 203d       mean_dict =
+00024040: 2064 6566 6175 6c74 6469 6374 5f74 6f5f   defaultdict_to_
+00024050: 6469 6374 286d 6561 6e5f 6469 6374 290a  dict(mean_dict).
+00024060: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00024070: 2065 6c69 6620 6265 6861 7669 6f72 5f70   elif behavior_p
+00024080: 6f6c 6963 795f 6e61 6d65 2069 7320 4e6f  olicy_name is No
+00024090: 6e65 2061 6e64 2064 6174 6173 6574 5f69  ne and dataset_i
+000240a0: 6420 6973 206e 6f74 204e 6f6e 653a 0a20  d is not None:. 
 000240b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000240c0: 2020 2020 2020 6d65 616e 5f64 6963 745b        mean_dict[
-000240d0: 6265 6861 7669 6f72 5f70 6f6c 6963 795d  behavior_policy]
-000240e0: 2e61 7070 656e 6428 6d65 616e 5f64 6963  .append(mean_dic
-000240f0: 745f 290a 0a20 2020 2020 2020 2020 2020  t_)..           
-00024100: 2020 2020 2020 2020 206d 6561 6e5f 6469           mean_di
-00024110: 6374 203d 2064 6566 6175 6c74 6469 6374  ct = defaultdict
-00024120: 5f74 6f5f 6469 6374 286d 6561 6e5f 6469  _to_dict(mean_di
-00024130: 6374 290a 0a20 2020 2020 2020 2020 2020  ct)..           
-00024140: 2020 2020 2065 6c69 6620 6265 6861 7669       elif behavi
-00024150: 6f72 5f70 6f6c 6963 795f 6e61 6d65 2069  or_policy_name i
-00024160: 7320 4e6f 6e65 2061 6e64 2064 6174 6173  s None and datas
-00024170: 6574 5f69 6420 6973 206e 6f74 204e 6f6e  et_id is not Non
-00024180: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00024190: 2020 2020 2020 2069 6620 280a 2020 2020         if (.    
-000241a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000241b0: 2020 2020 7365 6c66 2e6d 756c 7469 706c      self.multipl
-000241c0: 655f 6c6f 6767 6564 5f64 6174 6173 6574  e_logged_dataset
-000241d0: 2e62 6568 6176 696f 725f 706f 6c69 6379  .behavior_policy
-000241e0: 5f6e 616d 6573 0a20 2020 2020 2020 2020  _names.         
-000241f0: 2020 2020 2020 2020 2020 2020 2020 2021                 !
-00024200: 3d20 696e 7075 745f 6469 6374 2e62 6568  = input_dict.beh
-00024210: 6176 696f 725f 706f 6c69 6379 5f6e 616d  avior_policy_nam
-00024220: 6573 0a20 2020 2020 2020 2020 2020 2020  es.             
-00024230: 2020 2020 2020 2029 3a0a 2020 2020 2020         ):.      
-00024240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024250: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-00024260: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
-00024270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024280: 2245 7870 6563 7465 6420 7468 6174 206c  "Expected that l
-00024290: 6f67 6765 6420 6461 7461 7365 7473 2061  ogged datasets a
-000242a0: 6e64 2069 6e70 7574 2064 6963 7473 2063  nd input dicts c
-000242b0: 6f6e 7369 7374 7320 6f66 2074 6865 2073  onsists of the s
-000242c0: 616d 6520 6265 6861 7669 6f72 2070 6f6c  ame behavior pol
-000242d0: 6963 6965 732c 2062 7574 2066 6f75 6e64  icies, but found
-000242e0: 2046 616c 7365 2e22 0a20 2020 2020 2020   False.".       
-000242f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024300: 2029 0a0a 2020 2020 2020 2020 2020 2020   )..            
-00024310: 2020 2020 2020 2020 6d65 616e 5f64 6963          mean_dic
-00024320: 7420 3d20 7b7d 0a20 2020 2020 2020 2020  t = {}.         
-00024330: 2020 2020 2020 2020 2020 2066 6f72 2062             for b
-00024340: 6568 6176 696f 725f 706f 6c69 6379 2069  ehavior_policy i
-00024350: 6e20 696e 7075 745f 6469 6374 2e62 6568  n input_dict.beh
-00024360: 6176 696f 725f 706f 6c69 6379 5f6e 616d  avior_policy_nam
-00024370: 6573 3a0a 2020 2020 2020 2020 2020 2020  es:.            
-00024380: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00024390: 2e5f 7265 6769 7374 6572 5f6c 6f67 6765  ._register_logge
-000243a0: 645f 6461 7461 7365 7428 0a20 2020 2020  d_dataset(.     
-000243b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000243c0: 2020 2020 2020 2062 6568 6176 696f 725f         behavior_
-000243d0: 706f 6c69 6379 5f6e 616d 653d 6265 6861  policy_name=beha
-000243e0: 7669 6f72 5f70 6f6c 6963 792c 2064 6174  vior_policy, dat
-000243f0: 6173 6574 5f69 643d 6461 7461 7365 745f  aset_id=dataset_
-00024400: 6964 0a20 2020 2020 2020 2020 2020 2020  id.             
-00024410: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00024420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024430: 2020 2020 2069 6e70 7574 5f64 6963 745f       input_dict_
-00024440: 203d 2069 6e70 7574 5f64 6963 742e 6765   = input_dict.ge
-00024450: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
-00024460: 2020 2020 2020 2020 2020 2020 2020 2062                 b
-00024470: 6568 6176 696f 725f 706f 6c69 6379 5f6e  ehavior_policy_n
-00024480: 616d 653d 6265 6861 7669 6f72 5f70 6f6c  ame=behavior_pol
-00024490: 6963 792c 0a20 2020 2020 2020 2020 2020  icy,.           
-000244a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000244b0: 2064 6174 6173 6574 5f69 643d 6461 7461   dataset_id=data
-000244c0: 7365 745f 6964 2c0a 2020 2020 2020 2020  set_id,.        
-000244d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000244e0: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
-000244f0: 2020 2020 2020 2020 2020 206d 6561 6e5f             mean_
-00024500: 6469 6374 5f20 3d20 7365 6c66 2e5f 6573  dict_ = self._es
-00024510: 7469 6d61 7465 5f6d 6561 6e28 0a20 2020  timate_mean(.   
-00024520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024530: 2020 2020 2020 2020 2069 6e70 7574 5f64           input_d
-00024540: 6963 745f 2c0a 2020 2020 2020 2020 2020  ict_,.          
-00024550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024560: 2020 636f 6d70 6172 6564 5f65 7374 696d    compared_estim
-00024570: 6174 6f72 733d 636f 6d70 6172 6564 5f65  ators=compared_e
-00024580: 7374 696d 6174 6f72 732c 0a20 2020 2020  stimators,.     
-00024590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000245a0: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-000245b0: 2020 2020 2020 2020 2020 2020 206d 6561               mea
-000245c0: 6e5f 6469 6374 5b62 6568 6176 696f 725f  n_dict[behavior_
-000245d0: 706f 6c69 6379 5d20 3d20 6d65 616e 5f64  policy] = mean_d
-000245e0: 6963 745f 0a0a 2020 2020 2020 2020 2020  ict_..          
-000245f0: 2020 2020 2020 656c 6966 2062 6568 6176        elif behav
-00024600: 696f 725f 706f 6c69 6379 5f6e 616d 6520  ior_policy_name 
-00024610: 6973 206e 6f74 204e 6f6e 6520 616e 6420  is not None and 
-00024620: 6461 7461 7365 745f 6964 2069 7320 4e6f  dataset_id is No
-00024630: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-00024640: 2020 2020 2020 2020 6966 2028 0a20 2020          if (.   
-00024650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024660: 2020 2020 2073 656c 662e 6d75 6c74 6970       self.multip
-00024670: 6c65 5f6c 6f67 6765 645f 6461 7461 7365  le_logged_datase
-00024680: 742e 6e5f 6461 7461 7365 7473 5b62 6568  t.n_datasets[beh
-00024690: 6176 696f 725f 706f 6c69 6379 5f6e 616d  avior_policy_nam
-000246a0: 655d 0a20 2020 2020 2020 2020 2020 2020  e].             
-000246b0: 2020 2020 2020 2020 2020 2021 3d20 696e             != in
-000246c0: 7075 745f 6469 6374 2e6e 5f64 6174 6173  put_dict.n_datas
-000246d0: 6574 735b 6265 6861 7669 6f72 5f70 6f6c  ets[behavior_pol
-000246e0: 6963 795f 6e61 6d65 5d0a 2020 2020 2020  icy_name].      
-000246f0: 2020 2020 2020 2020 2020 2020 2020 293a                ):
-00024700: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00024710: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-00024720: 616c 7565 4572 726f 7228 0a20 2020 2020  alueError(.     
-00024730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024740: 2020 2020 2020 2022 4578 7065 6374 6564         "Expected
-00024750: 2074 6861 7420 6c6f 6767 6564 2064 6174   that logged dat
-00024760: 6173 6574 7320 616e 6420 696e 7075 7420  asets and input 
-00024770: 6469 6374 7320 636f 6e73 6973 7473 206f  dicts consists o
-00024780: 6620 7468 6520 7361 6d65 2064 6174 6173  f the same datas
-00024790: 6574 2069 6473 2c20 6275 7420 666f 756e  et ids, but foun
-000247a0: 6420 4661 6c73 652e 220a 2020 2020 2020  d False.".      
-000247b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000247c0: 2020 290a 0a20 2020 2020 2020 2020 2020    )..           
-000247d0: 2020 2020 2020 2020 206d 6561 6e5f 6469           mean_di
-000247e0: 6374 203d 205b 5d0a 2020 2020 2020 2020  ct = [].        
-000247f0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00024800: 6461 7461 7365 745f 6964 5f20 696e 2072  dataset_id_ in r
-00024810: 616e 6765 280a 2020 2020 2020 2020 2020  ange(.          
-00024820: 2020 2020 2020 2020 2020 2020 2020 696e                in
-00024830: 7075 745f 6469 6374 2e6e 5f64 6174 6173  put_dict.n_datas
-00024840: 6574 735b 6265 6861 7669 6f72 5f70 6f6c  ets[behavior_pol
-00024850: 6963 795f 6e61 6d65 5d0a 2020 2020 2020  icy_name].      
-00024860: 2020 2020 2020 2020 2020 2020 2020 293a                ):
-00024870: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00024880: 2020 2020 2020 2020 2073 656c 662e 5f72           self._r
-00024890: 6567 6973 7465 725f 6c6f 6767 6564 5f64  egister_logged_d
-000248a0: 6174 6173 6574 280a 2020 2020 2020 2020  ataset(.        
-000248b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000248c0: 2020 2020 6265 6861 7669 6f72 5f70 6f6c      behavior_pol
-000248d0: 6963 795f 6e61 6d65 3d62 6568 6176 696f  icy_name=behavio
-000248e0: 725f 706f 6c69 6379 5f6e 616d 652c 0a20  r_policy_name,. 
+000240c0: 2020 2069 6620 280a 2020 2020 2020 2020     if (.        
+000240d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000240e0: 7365 6c66 2e6d 756c 7469 706c 655f 6c6f  self.multiple_lo
+000240f0: 6767 6564 5f64 6174 6173 6574 2e62 6568  gged_dataset.beh
+00024100: 6176 696f 725f 706f 6c69 6379 5f6e 616d  avior_policy_nam
+00024110: 6573 0a20 2020 2020 2020 2020 2020 2020  es.             
+00024120: 2020 2020 2020 2020 2020 2021 3d20 696e             != in
+00024130: 7075 745f 6469 6374 2e62 6568 6176 696f  put_dict.behavio
+00024140: 725f 706f 6c69 6379 5f6e 616d 6573 0a20  r_policy_names. 
+00024150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024160: 2020 2029 3a0a 2020 2020 2020 2020 2020     ):.          
+00024170: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+00024180: 6973 6520 5661 6c75 6545 7272 6f72 280a  ise ValueError(.
+00024190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000241a0: 2020 2020 2020 2020 2020 2020 2245 7870              "Exp
+000241b0: 6563 7465 6420 7468 6174 206c 6f67 6765  ected that logge
+000241c0: 6420 6461 7461 7365 7473 2061 6e64 2069  d datasets and i
+000241d0: 6e70 7574 2064 6963 7473 2063 6f6e 7369  nput dicts consi
+000241e0: 7374 7320 6f66 2074 6865 2073 616d 6520  sts of the same 
+000241f0: 6265 6861 7669 6f72 2070 6f6c 6963 6965  behavior policie
+00024200: 732c 2062 7574 2066 6f75 6e64 2046 616c  s, but found Fal
+00024210: 7365 2e22 0a20 2020 2020 2020 2020 2020  se.".           
+00024220: 2020 2020 2020 2020 2020 2020 2029 0a0a               )..
+00024230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024240: 2020 2020 6d65 616e 5f64 6963 7420 3d20      mean_dict = 
+00024250: 7b7d 0a20 2020 2020 2020 2020 2020 2020  {}.             
+00024260: 2020 2020 2020 2066 6f72 2062 6568 6176         for behav
+00024270: 696f 725f 706f 6c69 6379 2069 6e20 696e  ior_policy in in
+00024280: 7075 745f 6469 6374 2e62 6568 6176 696f  put_dict.behavio
+00024290: 725f 706f 6c69 6379 5f6e 616d 6573 3a0a  r_policy_names:.
+000242a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000242b0: 2020 2020 2020 2020 7365 6c66 2e5f 7265          self._re
+000242c0: 6769 7374 6572 5f6c 6f67 6765 645f 6461  gister_logged_da
+000242d0: 7461 7365 7428 0a20 2020 2020 2020 2020  taset(.         
+000242e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000242f0: 2020 2062 6568 6176 696f 725f 706f 6c69     behavior_poli
+00024300: 6379 5f6e 616d 653d 6265 6861 7669 6f72  cy_name=behavior
+00024310: 5f70 6f6c 6963 792c 2064 6174 6173 6574  _policy, dataset
+00024320: 5f69 643d 6461 7461 7365 745f 6964 0a20  _id=dataset_id. 
+00024330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024340: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00024350: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024360: 2069 6e70 7574 5f64 6963 745f 203d 2069   input_dict_ = i
+00024370: 6e70 7574 5f64 6963 742e 6765 7428 0a20  nput_dict.get(. 
+00024380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024390: 2020 2020 2020 2020 2020 2062 6568 6176             behav
+000243a0: 696f 725f 706f 6c69 6379 5f6e 616d 653d  ior_policy_name=
+000243b0: 6265 6861 7669 6f72 5f70 6f6c 6963 792c  behavior_policy,
+000243c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000243d0: 2020 2020 2020 2020 2020 2020 2064 6174               dat
+000243e0: 6173 6574 5f69 643d 6461 7461 7365 745f  aset_id=dataset_
+000243f0: 6964 2c0a 2020 2020 2020 2020 2020 2020  id,.            
+00024400: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+00024410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024420: 2020 2020 2020 206d 6561 6e5f 6469 6374         mean_dict
+00024430: 5f20 3d20 7365 6c66 2e5f 6573 7469 6d61  _ = self._estima
+00024440: 7465 5f6d 6561 6e28 0a20 2020 2020 2020  te_mean(.       
+00024450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024460: 2020 2020 2069 6e70 7574 5f64 6963 745f       input_dict_
+00024470: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00024480: 2020 2020 2020 2020 2020 2020 2020 636f                co
+00024490: 6d70 6172 6564 5f65 7374 696d 6174 6f72  mpared_estimator
+000244a0: 733d 636f 6d70 6172 6564 5f65 7374 696d  s=compared_estim
+000244b0: 6174 6f72 732c 0a20 2020 2020 2020 2020  ators,.         
+000244c0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+000244d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000244e0: 2020 2020 2020 2020 206d 6561 6e5f 6469           mean_di
+000244f0: 6374 5b62 6568 6176 696f 725f 706f 6c69  ct[behavior_poli
+00024500: 6379 5d20 3d20 6d65 616e 5f64 6963 745f  cy] = mean_dict_
+00024510: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00024520: 2020 656c 6966 2062 6568 6176 696f 725f    elif behavior_
+00024530: 706f 6c69 6379 5f6e 616d 6520 6973 206e  policy_name is n
+00024540: 6f74 204e 6f6e 6520 616e 6420 6461 7461  ot None and data
+00024550: 7365 745f 6964 2069 7320 4e6f 6e65 3a0a  set_id is None:.
+00024560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024570: 2020 2020 6966 2028 0a20 2020 2020 2020      if (.       
+00024580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024590: 2073 656c 662e 6d75 6c74 6970 6c65 5f6c   self.multiple_l
+000245a0: 6f67 6765 645f 6461 7461 7365 742e 6e5f  ogged_dataset.n_
+000245b0: 6461 7461 7365 7473 5b62 6568 6176 696f  datasets[behavio
+000245c0: 725f 706f 6c69 6379 5f6e 616d 655d 0a20  r_policy_name]. 
+000245d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000245e0: 2020 2020 2020 2021 3d20 696e 7075 745f         != input_
+000245f0: 6469 6374 2e6e 5f64 6174 6173 6574 735b  dict.n_datasets[
+00024600: 6265 6861 7669 6f72 5f70 6f6c 6963 795f  behavior_policy_
+00024610: 6e61 6d65 5d0a 2020 2020 2020 2020 2020  name].          
+00024620: 2020 2020 2020 2020 2020 293a 0a20 2020            ):.   
+00024630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024640: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+00024650: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
+00024660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024670: 2020 2022 4578 7065 6374 6564 2074 6861     "Expected tha
+00024680: 7420 6c6f 6767 6564 2064 6174 6173 6574  t logged dataset
+00024690: 7320 616e 6420 696e 7075 7420 6469 6374  s and input dict
+000246a0: 7320 636f 6e73 6973 7473 206f 6620 7468  s consists of th
+000246b0: 6520 7361 6d65 2064 6174 6173 6574 2069  e same dataset i
+000246c0: 6473 2c20 6275 7420 666f 756e 6420 4661  ds, but found Fa
+000246d0: 6c73 652e 220a 2020 2020 2020 2020 2020  lse.".          
+000246e0: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+000246f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00024700: 2020 2020 206d 6561 6e5f 6469 6374 203d       mean_dict =
+00024710: 205b 5d0a 2020 2020 2020 2020 2020 2020   [].            
+00024720: 2020 2020 2020 2020 666f 7220 6461 7461          for data
+00024730: 7365 745f 6964 5f20 696e 2072 616e 6765  set_id_ in range
+00024740: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00024750: 2020 2020 2020 2020 2020 696e 7075 745f            input_
+00024760: 6469 6374 2e6e 5f64 6174 6173 6574 735b  dict.n_datasets[
+00024770: 6265 6861 7669 6f72 5f70 6f6c 6963 795f  behavior_policy_
+00024780: 6e61 6d65 5d0a 2020 2020 2020 2020 2020  name].          
+00024790: 2020 2020 2020 2020 2020 293a 0a20 2020            ):.   
+000247a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000247b0: 2020 2020 2073 656c 662e 5f72 6567 6973       self._regis
+000247c0: 7465 725f 6c6f 6767 6564 5f64 6174 6173  ter_logged_datas
+000247d0: 6574 280a 2020 2020 2020 2020 2020 2020  et(.            
+000247e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000247f0: 6265 6861 7669 6f72 5f70 6f6c 6963 795f  behavior_policy_
+00024800: 6e61 6d65 3d62 6568 6176 696f 725f 706f  name=behavior_po
+00024810: 6c69 6379 5f6e 616d 652c 0a20 2020 2020  licy_name,.     
+00024820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024830: 2020 2020 2020 2064 6174 6173 6574 5f69         dataset_i
+00024840: 643d 6461 7461 7365 745f 6964 5f2c 0a20  d=dataset_id_,. 
+00024850: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024860: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00024870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024880: 2069 6e70 7574 5f64 6963 745f 203d 2069   input_dict_ = i
+00024890: 6e70 7574 5f64 6963 742e 6765 7428 0a20  nput_dict.get(. 
+000248a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000248b0: 2020 2020 2020 2020 2020 2062 6568 6176             behav
+000248c0: 696f 725f 706f 6c69 6379 5f6e 616d 653d  ior_policy_name=
+000248d0: 6265 6861 7669 6f72 5f70 6f6c 6963 795f  behavior_policy_
+000248e0: 6e61 6d65 2c0a 2020 2020 2020 2020 2020  name,.          
 000248f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024900: 2020 2020 2020 2020 2020 2064 6174 6173             datas
-00024910: 6574 5f69 643d 6461 7461 7365 745f 6964  et_id=dataset_id
-00024920: 5f2c 0a20 2020 2020 2020 2020 2020 2020  _,.             
-00024930: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00024940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024950: 2020 2020 2069 6e70 7574 5f64 6963 745f       input_dict_
-00024960: 203d 2069 6e70 7574 5f64 6963 742e 6765   = input_dict.ge
-00024970: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
-00024980: 2020 2020 2020 2020 2020 2020 2020 2062                 b
-00024990: 6568 6176 696f 725f 706f 6c69 6379 5f6e  ehavior_policy_n
-000249a0: 616d 653d 6265 6861 7669 6f72 5f70 6f6c  ame=behavior_pol
-000249b0: 6963 795f 6e61 6d65 2c0a 2020 2020 2020  icy_name,.      
-000249c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000249d0: 2020 2020 2020 6461 7461 7365 745f 6964        dataset_id
-000249e0: 3d64 6174 6173 6574 5f69 645f 2c0a 2020  =dataset_id_,.  
-000249f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024a00: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-00024a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024a20: 206d 6561 6e5f 6469 6374 5f20 3d20 7365   mean_dict_ = se
-00024a30: 6c66 2e5f 6573 7469 6d61 7465 5f6d 6561  lf._estimate_mea
-00024a40: 6e28 0a20 2020 2020 2020 2020 2020 2020  n(.             
-00024a50: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00024a60: 6e70 7574 5f64 6963 745f 2c0a 2020 2020  nput_dict_,.    
-00024a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024a80: 2020 2020 2020 2020 636f 6d70 6172 6564          compared
-00024a90: 5f65 7374 696d 6174 6f72 733d 636f 6d70  _estimators=comp
-00024aa0: 6172 6564 5f65 7374 696d 6174 6f72 732c  ared_estimators,
-00024ab0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00024ac0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00024900: 2020 6461 7461 7365 745f 6964 3d64 6174    dataset_id=dat
+00024910: 6173 6574 5f69 645f 2c0a 2020 2020 2020  aset_id_,.      
+00024920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024930: 2020 290a 0a20 2020 2020 2020 2020 2020    )..           
+00024940: 2020 2020 2020 2020 2020 2020 206d 6561               mea
+00024950: 6e5f 6469 6374 5f20 3d20 7365 6c66 2e5f  n_dict_ = self._
+00024960: 6573 7469 6d61 7465 5f6d 6561 6e28 0a20  estimate_mean(. 
+00024970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024980: 2020 2020 2020 2020 2020 2069 6e70 7574             input
+00024990: 5f64 6963 745f 2c0a 2020 2020 2020 2020  _dict_,.        
+000249a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000249b0: 2020 2020 636f 6d70 6172 6564 5f65 7374      compared_est
+000249c0: 696d 6174 6f72 733d 636f 6d70 6172 6564  imators=compared
+000249d0: 5f65 7374 696d 6174 6f72 732c 0a20 2020  _estimators,.   
+000249e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000249f0: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+00024a00: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+00024a10: 6561 6e5f 6469 6374 2e61 7070 656e 6428  ean_dict.append(
+00024a20: 6d65 616e 5f64 6963 745f 290a 0a20 2020  mean_dict_)..   
+00024a30: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+00024a40: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00024a50: 2020 2020 2020 2073 656c 662e 5f72 6567         self._reg
+00024a60: 6973 7465 725f 6c6f 6767 6564 5f64 6174  ister_logged_dat
+00024a70: 6173 6574 280a 2020 2020 2020 2020 2020  aset(.          
+00024a80: 2020 2020 2020 2020 2020 2020 2020 6265                be
+00024a90: 6861 7669 6f72 5f70 6f6c 6963 795f 6e61  havior_policy_na
+00024aa0: 6d65 3d62 6568 6176 696f 725f 706f 6c69  me=behavior_poli
+00024ab0: 6379 5f6e 616d 652c 2064 6174 6173 6574  cy_name, dataset
+00024ac0: 5f69 643d 6461 7461 7365 745f 6964 0a20  _id=dataset_id. 
 00024ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024ae0: 2020 206d 6561 6e5f 6469 6374 2e61 7070     mean_dict.app
-00024af0: 656e 6428 6d65 616e 5f64 6963 745f 290a  end(mean_dict_).
-00024b00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00024b10: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00024b20: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00024b30: 5f72 6567 6973 7465 725f 6c6f 6767 6564  _register_logged
-00024b40: 5f64 6174 6173 6574 280a 2020 2020 2020  _dataset(.      
-00024b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024b60: 2020 6265 6861 7669 6f72 5f70 6f6c 6963    behavior_polic
-00024b70: 795f 6e61 6d65 3d62 6568 6176 696f 725f  y_name=behavior_
-00024b80: 706f 6c69 6379 5f6e 616d 652c 2064 6174  policy_name, dat
-00024b90: 6173 6574 5f69 643d 6461 7461 7365 745f  aset_id=dataset_
-00024ba0: 6964 0a20 2020 2020 2020 2020 2020 2020  id.             
-00024bb0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00024bc0: 2020 2020 2020 2020 2020 2020 2069 6e70               inp
-00024bd0: 7574 5f64 6963 745f 203d 2069 6e70 7574  ut_dict_ = input
-00024be0: 5f64 6963 742e 6765 7428 0a20 2020 2020  _dict.get(.     
-00024bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024c00: 2020 2062 6568 6176 696f 725f 706f 6c69     behavior_poli
-00024c10: 6379 5f6e 616d 653d 6265 6861 7669 6f72  cy_name=behavior
-00024c20: 5f70 6f6c 6963 795f 6e61 6d65 2c20 6461  _policy_name, da
-00024c30: 7461 7365 745f 6964 3d64 6174 6173 6574  taset_id=dataset
-00024c40: 5f69 640a 2020 2020 2020 2020 2020 2020  _id.            
-00024c50: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
-00024c60: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-00024c70: 6561 6e5f 6469 6374 203d 2073 656c 662e  ean_dict = self.
-00024c80: 5f65 7374 696d 6174 655f 6d65 616e 280a  _estimate_mean(.
-00024c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024ca0: 2020 2020 2020 2020 696e 7075 745f 6469          input_di
-00024cb0: 6374 5f2c 0a20 2020 2020 2020 2020 2020  ct_,.           
-00024cc0: 2020 2020 2020 2020 2020 2020 2063 6f6d               com
-00024cd0: 7061 7265 645f 6573 7469 6d61 746f 7273  pared_estimators
-00024ce0: 3d63 6f6d 7061 7265 645f 6573 7469 6d61  =compared_estima
-00024cf0: 746f 7273 2c0a 2020 2020 2020 2020 2020  tors,.          
-00024d00: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
-00024d10: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-00024d20: 2020 2020 2020 2020 2020 2020 2020 2062                 b
-00024d30: 6568 6176 696f 725f 706f 6c69 6379 5f6e  ehavior_policy_n
-00024d40: 616d 6520 3d20 6c69 7374 2869 6e70 7574  ame = list(input
-00024d50: 5f64 6963 742e 7661 6c75 6573 2829 295b  _dict.values())[
-00024d60: 305d 5b22 6265 6861 7669 6f72 5f70 6f6c  0]["behavior_pol
-00024d70: 6963 7922 5d0a 2020 2020 2020 2020 2020  icy"].          
-00024d80: 2020 2020 2020 6461 7461 7365 745f 6964        dataset_id
-00024d90: 203d 206c 6973 7428 696e 7075 745f 6469   = list(input_di
-00024da0: 6374 2e76 616c 7565 7328 2929 5b30 5d5b  ct.values())[0][
-00024db0: 2264 6174 6173 6574 5f69 6422 5d0a 0a20  "dataset_id"].. 
-00024dc0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00024dd0: 656c 662e 5f72 6567 6973 7465 725f 6c6f  elf._register_lo
-00024de0: 6767 6564 5f64 6174 6173 6574 280a 2020  gged_dataset(.  
-00024df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024e00: 2020 6265 6861 7669 6f72 5f70 6f6c 6963    behavior_polic
-00024e10: 795f 6e61 6d65 3d62 6568 6176 696f 725f  y_name=behavior_
-00024e20: 706f 6c69 6379 5f6e 616d 652c 2064 6174  policy_name, dat
-00024e30: 6173 6574 5f69 643d 6461 7461 7365 745f  aset_id=dataset_
-00024e40: 6964 0a20 2020 2020 2020 2020 2020 2020  id.             
-00024e50: 2020 2029 0a0a 2020 2020 2020 2020 2020     )..          
-00024e60: 2020 2020 2020 6d65 616e 5f64 6963 7420        mean_dict 
-00024e70: 3d20 7365 6c66 2e5f 6573 7469 6d61 7465  = self._estimate
-00024e80: 5f6d 6561 6e28 0a20 2020 2020 2020 2020  _mean(.         
-00024e90: 2020 2020 2020 2020 2020 2069 6e70 7574             input
-00024ea0: 5f64 6963 742c 0a20 2020 2020 2020 2020  _dict,.         
-00024eb0: 2020 2020 2020 2020 2020 2063 6f6d 7061             compa
-00024ec0: 7265 645f 6573 7469 6d61 746f 7273 3d63  red_estimators=c
-00024ed0: 6f6d 7061 7265 645f 6573 7469 6d61 746f  ompared_estimato
-00024ee0: 7273 2c0a 2020 2020 2020 2020 2020 2020  rs,.            
-00024ef0: 2020 2020 290a 0a20 2020 2020 2020 2065      )..        e
-00024f00: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00024f10: 2069 6620 6973 696e 7374 616e 6365 2869   if isinstance(i
-00024f20: 6e70 7574 5f64 6963 742c 204d 756c 7469  nput_dict, Multi
-00024f30: 706c 6549 6e70 7574 4469 6374 293a 0a20  pleInputDict):. 
-00024f40: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00024f50: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-00024f60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00024f70: 2020 2020 2022 7768 656e 2075 7369 6e67       "when using
-00024f80: 204c 6f67 6765 6444 6174 6173 6574 2c20   LoggedDataset, 
-00024f90: 706c 6561 7365 2075 7365 2049 6e70 7574  please use Input
-00024fa0: 4469 6374 2069 6e73 7465 6164 206f 6620  Dict instead of 
-00024fb0: 4d75 6c74 6970 6c65 496e 7075 7444 6963  MultipleInputDic
-00024fc0: 7422 0a20 2020 2020 2020 2020 2020 2020  t".             
-00024fd0: 2020 2029 0a0a 2020 2020 2020 2020 2020     )..          
-00024fe0: 2020 6d65 616e 5f64 6963 7420 3d20 7365    mean_dict = se
-00024ff0: 6c66 2e5f 6573 7469 6d61 7465 5f6d 6561  lf._estimate_mea
-00025000: 6e28 0a20 2020 2020 2020 2020 2020 2020  n(.             
-00025010: 2020 2069 6e70 7574 5f64 6963 742c 0a20     input_dict,. 
-00025020: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00025030: 6f6d 7061 7265 645f 6573 7469 6d61 746f  ompared_estimato
-00025040: 7273 3d63 6f6d 7061 7265 645f 6573 7469  rs=compared_esti
-00025050: 6d61 746f 7273 2c0a 2020 2020 2020 2020  mators,.        
-00025060: 2020 2020 290a 0a20 2020 2020 2020 2072      )..        r
-00025070: 6574 7572 6e20 6d65 616e 5f64 6963 740a  eturn mean_dict.
-00025080: 0a20 2020 2064 6566 2065 7374 696d 6174  .    def estimat
-00025090: 655f 7661 7269 616e 6365 280a 2020 2020  e_variance(.    
-000250a0: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-000250b0: 2020 696e 7075 745f 6469 6374 3a20 556e    input_dict: Un
-000250c0: 696f 6e5b 4f50 4549 6e70 7574 4469 6374  ion[OPEInputDict
-000250d0: 2c20 4d75 6c74 6970 6c65 496e 7075 7444  , MultipleInputD
-000250e0: 6963 745d 2c0a 2020 2020 2020 2020 636f  ict],.        co
-000250f0: 6d70 6172 6564 5f65 7374 696d 6174 6f72  mpared_estimator
-00025100: 733a 204f 7074 696f 6e61 6c5b 4c69 7374  s: Optional[List
-00025110: 5b73 7472 5d5d 203d 204e 6f6e 652c 0a20  [str]] = None,. 
-00025120: 2020 2020 2020 2062 6568 6176 696f 725f         behavior_
-00025130: 706f 6c69 6379 5f6e 616d 653a 204f 7074  policy_name: Opt
-00025140: 696f 6e61 6c5b 7374 725d 203d 204e 6f6e  ional[str] = Non
-00025150: 652c 0a20 2020 2020 2020 2064 6174 6173  e,.        datas
-00025160: 6574 5f69 643a 204f 7074 696f 6e61 6c5b  et_id: Optional[
-00025170: 696e 745d 203d 204e 6f6e 652c 0a20 2020  int] = None,.   
-00025180: 2029 3a0a 2020 2020 2020 2020 2222 2245   ):.        """E
-00025190: 7374 696d 6174 6520 7468 6520 7661 7269  stimate the vari
-000251a0: 616e 6365 206f 6620 7468 6520 7472 616a  ance of the traj
-000251b0: 6563 746f 7279 2d77 6973 6520 7265 7761  ectory-wise rewa
-000251c0: 7264 2075 6e64 6572 2074 6865 2067 6976  rd under the giv
-000251d0: 656e 2065 7661 6c75 6174 696f 6e20 706f  en evaluation po
-000251e0: 6c69 6369 6573 2e0a 0a20 2020 2020 2020  licies...       
-000251f0: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
-00025200: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
-00025210: 2020 2020 696e 7075 745f 6469 6374 3a20      input_dict: 
-00025220: 4f50 4549 6e70 7574 4469 6374 206f 7220  OPEInputDict or 
-00025230: 4d75 6c74 6970 6c65 496e 7075 7444 6963  MultipleInputDic
-00025240: 740a 2020 2020 2020 2020 2020 2020 4469  t.            Di
-00025250: 6374 696f 6e61 7279 206f 6620 7468 6520  ctionary of the 
-00025260: 4f50 4520 696e 7075 7473 2066 6f72 2065  OPE inputs for e
-00025270: 6163 6820 6576 616c 7561 7469 6f6e 2070  ach evaluation p
-00025280: 6f6c 6963 792e 0a0a 2020 2020 2020 2020  olicy...        
-00025290: 2020 2020 2e2e 2063 6f64 652d 626c 6f63      .. code-bloc
-000252a0: 6b3a 3a20 7079 7468 6f6e 0a0a 2020 2020  k:: python..    
-000252b0: 2020 2020 2020 2020 2020 2020 6b65 793a              key:
-000252c0: 205b 6576 616c 7561 7469 6f6e 5f70 6f6c   [evaluation_pol
-000252d0: 6963 795d 5b0a 2020 2020 2020 2020 2020  icy][.          
-000252e0: 2020 2020 2020 2020 2020 6576 616c 7561            evalua
-000252f0: 7469 6f6e 5f70 6f6c 6963 795f 6163 7469  tion_policy_acti
-00025300: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
-00025310: 2020 2020 2020 2020 6576 616c 7561 7469          evaluati
-00025320: 6f6e 5f70 6f6c 6963 795f 6163 7469 6f6e  on_policy_action
-00025330: 5f64 6973 742c 0a20 2020 2020 2020 2020  _dist,.         
-00025340: 2020 2020 2020 2020 2020 2073 7461 7465             state
-00025350: 5f61 6374 696f 6e5f 7661 6c75 655f 7072  _action_value_pr
-00025360: 6564 6963 7469 6f6e 2c0a 2020 2020 2020  ediction,.      
-00025370: 2020 2020 2020 2020 2020 2020 2020 696e                in
-00025380: 6974 6961 6c5f 7374 6174 655f 7661 6c75  itial_state_valu
-00025390: 655f 7072 6564 6963 7469 6f6e 2c0a 2020  e_prediction,.  
-000253a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000253b0: 2020 7374 6174 655f 6163 7469 6f6e 5f6d    state_action_m
-000253c0: 6172 6769 6e61 6c5f 696d 706f 7274 616e  arginal_importan
-000253d0: 6365 5f77 6569 6768 742c 0a20 2020 2020  ce_weight,.     
-000253e0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-000253f0: 7461 7465 5f6d 6172 6769 6e61 6c5f 696d  tate_marginal_im
-00025400: 706f 7274 616e 6365 5f77 6569 6768 742c  portance_weight,
-00025410: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00025420: 2020 2020 206f 6e5f 706f 6c69 6379 5f70       on_policy_p
-00025430: 6f6c 6963 795f 7661 6c75 652c 0a20 2020  olicy_value,.   
-00025440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025450: 2067 616d 6d61 2c0a 2020 2020 2020 2020   gamma,.        
-00025460: 2020 2020 2020 2020 2020 2020 6265 6861              beha
-00025470: 7669 6f72 5f70 6f6c 6963 792c 0a20 2020  vior_policy,.   
-00025480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025490: 2065 7661 6c75 6174 696f 6e5f 706f 6c69   evaluation_poli
-000254a0: 6379 2c0a 2020 2020 2020 2020 2020 2020  cy,.            
-000254b0: 2020 2020 2020 2020 6461 7461 7365 745f          dataset_
-000254c0: 6964 2c0a 2020 2020 2020 2020 2020 2020  id,.            
-000254d0: 2020 2020 5d0a 0a20 2020 2020 2020 2020      ]..         
-000254e0: 2020 202e 2e20 7365 6561 6c73 6f3a 3a0a     .. seealso::.
-000254f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00025500: 203a 636c 6173 733a 6073 636f 7065 5f72   :class:`scope_r
-00025510: 6c2e 6f70 652e 696e 7075 742e 4372 6561  l.ope.input.Crea
-00025520: 7465 4f50 4549 6e70 7574 6020 6465 7363  teOPEInput` desc
-00025530: 7269 6265 7320 7468 6520 636f 6d70 6f6e  ribes the compon
-00025540: 656e 7473 206f 6620 3a63 6c61 7373 3a60  ents of :class:`
-00025550: 696e 7075 745f 6469 6374 602e 0a0a 2020  input_dict`...  
-00025560: 2020 2020 2020 636f 6d70 6172 6564 5f65        compared_e
-00025570: 7374 696d 6174 6f72 733a 206c 6973 7420  stimators: list 
-00025580: 6f66 2073 7472 2c20 6465 6661 756c 743d  of str, default=
-00025590: 4e6f 6e65 0a20 2020 2020 2020 2020 2020  None.           
-000255a0: 204e 616d 6520 6f66 2063 6f6d 7061 7265   Name of compare
-000255b0: 6420 6573 7469 6d61 746f 7273 2e0a 2020  d estimators..  
-000255c0: 2020 2020 2020 2020 2020 4966 2060 4e6f            If `No
-000255d0: 6e65 6020 6973 2067 6976 656e 2c20 616c  ne` is given, al
-000255e0: 6c20 7468 6520 6573 7469 6d61 746f 7273  l the estimators
-000255f0: 2061 7265 2063 6f6d 7061 7265 642e 0a0a   are compared...
-00025600: 2020 2020 2020 2020 6265 6861 7669 6f72          behavior
-00025610: 5f70 6f6c 6963 795f 6e61 6d65 3a20 7374  _policy_name: st
-00025620: 722c 2064 6566 6175 6c74 3d4e 6f6e 650a  r, default=None.
-00025630: 2020 2020 2020 2020 2020 2020 4e61 6d65              Name
-00025640: 206f 6620 7468 6520 6265 6861 7669 6f72   of the behavior
-00025650: 2070 6f6c 6963 792e 0a0a 2020 2020 2020   policy...      
-00025660: 2020 6461 7461 7365 745f 6964 3a20 696e    dataset_id: in
-00025670: 742c 2064 6566 6175 6c74 3d4e 6f6e 650a  t, default=None.
-00025680: 2020 2020 2020 2020 2020 2020 4964 206f              Id o
-00025690: 6620 7468 6520 6c6f 6767 6564 2064 6174  f the logged dat
-000256a0: 6173 6574 2e0a 0a20 2020 2020 2020 2052  aset...        R
-000256b0: 6574 7572 6e0a 2020 2020 2020 2020 2d2d  eturn.        --
-000256c0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7661  -----.        va
-000256d0: 7269 616e 6365 5f64 6963 743a 2064 6963  riance_dict: dic
-000256e0: 7420 282c 206c 6973 7420 6f66 2064 6963  t (, list of dic
-000256f0: 7429 0a20 2020 2020 2020 2020 2020 2044  t).            D
-00025700: 6963 7469 6f6e 6172 7920 636f 6e74 6169  ictionary contai
-00025710: 6e69 6e67 2074 6865 2076 6172 6961 6e63  ning the varianc
-00025720: 6520 6f66 2074 7261 6a65 6374 6f72 792d  e of trajectory-
-00025730: 7769 7365 2072 6577 6172 6420 6f66 2065  wise reward of e
-00025740: 6163 6820 6576 616c 7561 7469 6f6e 2070  ach evaluation p
-00025750: 6f6c 6963 7920 6573 7469 6d61 7465 6420  olicy estimated 
-00025760: 6279 204f 5045 2065 7374 696d 6174 6f72  by OPE estimator
-00025770: 732e 0a20 2020 2020 2020 2020 2020 206b  s..            k
-00025780: 6579 3a20 3a63 6c61 7373 3a60 5b65 7661  ey: :class:`[eva
-00025790: 6c75 6174 696f 6e5f 706f 6c69 6379 5d5b  luation_policy][
-000257a0: 4f50 455f 6573 7469 6d61 746f 725f 6e61  OPE_estimator_na
-000257b0: 6d65 5d60 0a0a 2020 2020 2020 2020 2020  me]`..          
-000257c0: 2020 5768 656e 2062 6568 6176 696f 725f    When behavior_
-000257d0: 706f 6c69 6379 5f6e 616d 6520 6973 2060  policy_name is `
-000257e0: 4e6f 6e65 6020 616e 6420 6461 7461 7365  None` and datase
-000257f0: 745f 6964 2069 7320 604e 6f6e 6560 2c0a  t_id is `None`,.
-00025800: 2020 2020 2020 2020 2020 2020 6b65 793a              key:
-00025810: 203a 636c 6173 733a 605b 6265 6861 7669   :class:`[behavi
-00025820: 6f72 5f70 6f6c 6963 795f 6e61 6d65 5d5b  or_policy_name][
-00025830: 6461 7461 7365 745f 6964 5d5b 6576 616c  dataset_id][eval
-00025840: 7561 7469 6f6e 5f70 6f6c 6963 795d 5b4f  uation_policy][O
-00025850: 5045 5f65 7374 696d 6174 6f72 5f6e 616d  PE_estimator_nam
-00025860: 655d 600a 0a20 2020 2020 2020 2020 2020  e]`..           
-00025870: 2057 6865 6e20 6265 6861 7669 6f72 5f70   When behavior_p
-00025880: 6f6c 6963 795f 6e61 6d65 2069 7320 604e  olicy_name is `N
-00025890: 6f6e 6560 2061 6e64 2064 6174 6173 6574  one` and dataset
-000258a0: 5f69 6420 6973 2073 7065 6369 6669 6564  _id is specified
-000258b0: 2c0a 2020 2020 2020 2020 2020 2020 6b65  ,.            ke
-000258c0: 793a 203a 636c 6173 733a 605b 6265 6861  y: :class:`[beha
-000258d0: 7669 6f72 5f70 6f6c 6963 795f 6e61 6d65  vior_policy_name
-000258e0: 5d5b 6576 616c 7561 7469 6f6e 5f70 6f6c  ][evaluation_pol
-000258f0: 6963 795d 5b4f 5045 5f65 7374 696d 6174  icy][OPE_estimat
-00025900: 6f72 5f6e 616d 655d 600a 0a20 2020 2020  or_name]`..     
-00025910: 2020 2020 2020 2057 6865 6e20 6265 6861         When beha
-00025920: 7669 6f72 5f70 6f6c 6963 795f 6e61 6d65  vior_policy_name
-00025930: 2069 7320 7370 6563 6966 6965 6420 616e   is specified an
-00025940: 6420 6461 7461 7365 745f 6964 2069 7320  d dataset_id is 
-00025950: 604e 6f6e 6560 2c0a 2020 2020 2020 2020  `None`,.        
-00025960: 2020 2020 6b65 793a 203a 636c 6173 733a      key: :class:
-00025970: 605b 6461 7461 7365 745f 6964 5d5b 4f50  `[dataset_id][OP
-00025980: 455f 6573 7469 6d61 746f 725f 6e61 6d65  E_estimator_name
-00025990: 5d60 0a0a 2020 2020 2020 2020 2222 220a  ]`..        """.
-000259a0: 2020 2020 2020 2020 636f 6d70 6172 6564          compared
-000259b0: 5f65 7374 696d 6174 6f72 7320 3d20 7365  _estimators = se
-000259c0: 6c66 2e5f 6368 6563 6b5f 636f 6d70 6172  lf._check_compar
-000259d0: 6564 5f65 7374 696d 6174 6f72 7328 636f  ed_estimators(co
-000259e0: 6d70 6172 6564 5f65 7374 696d 6174 6f72  mpared_estimator
-000259f0: 7329 0a0a 2020 2020 2020 2020 6966 2073  s)..        if s
-00025a00: 656c 662e 7573 655f 6d75 6c74 6970 6c65  elf.use_multiple
-00025a10: 5f6c 6f67 6765 645f 6461 7461 7365 743a  _logged_dataset:
-00025a20: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00025a30: 6973 696e 7374 616e 6365 2869 6e70 7574  isinstance(input
-00025a40: 5f64 6963 742c 204d 756c 7469 706c 6549  _dict, MultipleI
-00025a50: 6e70 7574 4469 6374 293a 0a20 2020 2020  nputDict):.     
-00025a60: 2020 2020 2020 2020 2020 2069 6620 6265             if be
-00025a70: 6861 7669 6f72 5f70 6f6c 6963 795f 6e61  havior_policy_na
-00025a80: 6d65 2069 7320 4e6f 6e65 2061 6e64 2064  me is None and d
-00025a90: 6174 6173 6574 5f69 6420 6973 204e 6f6e  ataset_id is Non
-00025aa0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00025ab0: 2020 2020 2020 2069 6620 7365 6c66 2e6d         if self.m
-00025ac0: 756c 7469 706c 655f 6c6f 6767 6564 5f64  ultiple_logged_d
-00025ad0: 6174 6173 6574 2e6e 5f64 6174 6173 6574  ataset.n_dataset
-00025ae0: 7320 213d 2069 6e70 7574 5f64 6963 742e  s != input_dict.
-00025af0: 6e5f 6461 7461 7365 7473 3a0a 2020 2020  n_datasets:.    
-00025b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025b10: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-00025b20: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
-00025b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025b40: 2020 2245 7870 6563 7465 6420 7468 6174    "Expected that
-00025b50: 206c 6f67 6765 6420 6461 7461 7365 7473   logged datasets
-00025b60: 2061 6e64 2069 6e70 7574 2064 6963 7473   and input dicts
-00025b70: 2063 6f6e 7369 7374 7320 6f66 2074 6865   consists of the
-00025b80: 2073 616d 6520 6265 6861 7669 6f72 2070   same behavior p
-00025b90: 6f6c 6963 6965 7320 616e 6420 6461 7461  olicies and data
-00025ba0: 7365 7420 6964 732c 2062 7574 2066 6f75  set ids, but fou
-00025bb0: 6e64 2046 616c 7365 2e22 0a20 2020 2020  nd False.".     
-00025bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025bd0: 2020 2029 0a0a 2020 2020 2020 2020 2020     )..          
-00025be0: 2020 2020 2020 2020 2020 7661 7269 616e            varian
-00025bf0: 6365 5f64 6963 7420 3d20 6465 6661 756c  ce_dict = defaul
-00025c00: 7464 6963 7428 6c69 7374 290a 2020 2020  tdict(list).    
-00025c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025c20: 666f 7220 280a 2020 2020 2020 2020 2020  for (.          
-00025c30: 2020 2020 2020 2020 2020 2020 2020 6265                be
-00025c40: 6861 7669 6f72 5f70 6f6c 6963 792c 0a20  havior_policy,. 
+00024ae0: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+00024af0: 2020 2020 2020 2020 2069 6e70 7574 5f64           input_d
+00024b00: 6963 745f 203d 2069 6e70 7574 5f64 6963  ict_ = input_dic
+00024b10: 742e 6765 7428 0a20 2020 2020 2020 2020  t.get(.         
+00024b20: 2020 2020 2020 2020 2020 2020 2020 2062                 b
+00024b30: 6568 6176 696f 725f 706f 6c69 6379 5f6e  ehavior_policy_n
+00024b40: 616d 653d 6265 6861 7669 6f72 5f70 6f6c  ame=behavior_pol
+00024b50: 6963 795f 6e61 6d65 2c20 6461 7461 7365  icy_name, datase
+00024b60: 745f 6964 3d64 6174 6173 6574 5f69 640a  t_id=dataset_id.
+00024b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024b80: 2020 2020 290a 0a20 2020 2020 2020 2020      )..         
+00024b90: 2020 2020 2020 2020 2020 206d 6561 6e5f             mean_
+00024ba0: 6469 6374 203d 2073 656c 662e 5f65 7374  dict = self._est
+00024bb0: 696d 6174 655f 6d65 616e 280a 2020 2020  imate_mean(.    
+00024bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024bd0: 2020 2020 696e 7075 745f 6469 6374 5f2c      input_dict_,
+00024be0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00024bf0: 2020 2020 2020 2020 2063 6f6d 7061 7265           compare
+00024c00: 645f 6573 7469 6d61 746f 7273 3d63 6f6d  d_estimators=com
+00024c10: 7061 7265 645f 6573 7469 6d61 746f 7273  pared_estimators
+00024c20: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00024c30: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+00024c40: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00024c50: 2020 2020 2020 2020 2020 2062 6568 6176             behav
+00024c60: 696f 725f 706f 6c69 6379 5f6e 616d 6520  ior_policy_name 
+00024c70: 3d20 6c69 7374 2869 6e70 7574 5f64 6963  = list(input_dic
+00024c80: 742e 7661 6c75 6573 2829 295b 305d 5b22  t.values())[0]["
+00024c90: 6265 6861 7669 6f72 5f70 6f6c 6963 7922  behavior_policy"
+00024ca0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+00024cb0: 2020 6461 7461 7365 745f 6964 203d 206c    dataset_id = l
+00024cc0: 6973 7428 696e 7075 745f 6469 6374 2e76  ist(input_dict.v
+00024cd0: 616c 7565 7328 2929 5b30 5d5b 2264 6174  alues())[0]["dat
+00024ce0: 6173 6574 5f69 6422 5d0a 0a20 2020 2020  aset_id"]..     
+00024cf0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00024d00: 5f72 6567 6973 7465 725f 6c6f 6767 6564  _register_logged
+00024d10: 5f64 6174 6173 6574 280a 2020 2020 2020  _dataset(.      
+00024d20: 2020 2020 2020 2020 2020 2020 2020 6265                be
+00024d30: 6861 7669 6f72 5f70 6f6c 6963 795f 6e61  havior_policy_na
+00024d40: 6d65 3d62 6568 6176 696f 725f 706f 6c69  me=behavior_poli
+00024d50: 6379 5f6e 616d 652c 2064 6174 6173 6574  cy_name, dataset
+00024d60: 5f69 643d 6461 7461 7365 745f 6964 0a20  _id=dataset_id. 
+00024d70: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+00024d80: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00024d90: 2020 6d65 616e 5f64 6963 7420 3d20 7365    mean_dict = se
+00024da0: 6c66 2e5f 6573 7469 6d61 7465 5f6d 6561  lf._estimate_mea
+00024db0: 6e28 0a20 2020 2020 2020 2020 2020 2020  n(.             
+00024dc0: 2020 2020 2020 2069 6e70 7574 5f64 6963         input_dic
+00024dd0: 742c 0a20 2020 2020 2020 2020 2020 2020  t,.             
+00024de0: 2020 2020 2020 2063 6f6d 7061 7265 645f         compared_
+00024df0: 6573 7469 6d61 746f 7273 3d63 6f6d 7061  estimators=compa
+00024e00: 7265 645f 6573 7469 6d61 746f 7273 2c0a  red_estimators,.
+00024e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024e20: 290a 0a20 2020 2020 2020 2065 6c73 653a  )..        else:
+00024e30: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00024e40: 6973 696e 7374 616e 6365 2869 6e70 7574  isinstance(input
+00024e50: 5f64 6963 742c 204d 756c 7469 706c 6549  _dict, MultipleI
+00024e60: 6e70 7574 4469 6374 293a 0a20 2020 2020  nputDict):.     
+00024e70: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00024e80: 2056 616c 7565 4572 726f 7228 0a20 2020   ValueError(.   
+00024e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00024ea0: 2022 7768 656e 2075 7369 6e67 204c 6f67   "when using Log
+00024eb0: 6765 6444 6174 6173 6574 2c20 706c 6561  gedDataset, plea
+00024ec0: 7365 2075 7365 2049 6e70 7574 4469 6374  se use InputDict
+00024ed0: 2069 6e73 7465 6164 206f 6620 4d75 6c74   instead of Mult
+00024ee0: 6970 6c65 496e 7075 7444 6963 7422 0a20  ipleInputDict". 
+00024ef0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+00024f00: 0a0a 2020 2020 2020 2020 2020 2020 6d65  ..            me
+00024f10: 616e 5f64 6963 7420 3d20 7365 6c66 2e5f  an_dict = self._
+00024f20: 6573 7469 6d61 7465 5f6d 6561 6e28 0a20  estimate_mean(. 
+00024f30: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00024f40: 6e70 7574 5f64 6963 742c 0a20 2020 2020  nput_dict,.     
+00024f50: 2020 2020 2020 2020 2020 2063 6f6d 7061             compa
+00024f60: 7265 645f 6573 7469 6d61 746f 7273 3d63  red_estimators=c
+00024f70: 6f6d 7061 7265 645f 6573 7469 6d61 746f  ompared_estimato
+00024f80: 7273 2c0a 2020 2020 2020 2020 2020 2020  rs,.            
+00024f90: 290a 0a20 2020 2020 2020 2072 6574 7572  )..        retur
+00024fa0: 6e20 6d65 616e 5f64 6963 740a 0a20 2020  n mean_dict..   
+00024fb0: 2064 6566 2065 7374 696d 6174 655f 7661   def estimate_va
+00024fc0: 7269 616e 6365 280a 2020 2020 2020 2020  riance(.        
+00024fd0: 7365 6c66 2c0a 2020 2020 2020 2020 696e  self,.        in
+00024fe0: 7075 745f 6469 6374 3a20 556e 696f 6e5b  put_dict: Union[
+00024ff0: 4f50 4549 6e70 7574 4469 6374 2c20 4d75  OPEInputDict, Mu
+00025000: 6c74 6970 6c65 496e 7075 7444 6963 745d  ltipleInputDict]
+00025010: 2c0a 2020 2020 2020 2020 636f 6d70 6172  ,.        compar
+00025020: 6564 5f65 7374 696d 6174 6f72 733a 204f  ed_estimators: O
+00025030: 7074 696f 6e61 6c5b 4c69 7374 5b73 7472  ptional[List[str
+00025040: 5d5d 203d 204e 6f6e 652c 0a20 2020 2020  ]] = None,.     
+00025050: 2020 2062 6568 6176 696f 725f 706f 6c69     behavior_poli
+00025060: 6379 5f6e 616d 653a 204f 7074 696f 6e61  cy_name: Optiona
+00025070: 6c5b 7374 725d 203d 204e 6f6e 652c 0a20  l[str] = None,. 
+00025080: 2020 2020 2020 2064 6174 6173 6574 5f69         dataset_i
+00025090: 643a 204f 7074 696f 6e61 6c5b 696e 745d  d: Optional[int]
+000250a0: 203d 204e 6f6e 652c 0a20 2020 2029 3a0a   = None,.    ):.
+000250b0: 2020 2020 2020 2020 2222 2245 7374 696d          """Estim
+000250c0: 6174 6520 7468 6520 7661 7269 616e 6365  ate the variance
+000250d0: 206f 6620 7468 6520 7472 616a 6563 746f   of the trajecto
+000250e0: 7279 2d77 6973 6520 7265 7761 7264 2075  ry-wise reward u
+000250f0: 6e64 6572 2074 6865 2067 6976 656e 2065  nder the given e
+00025100: 7661 6c75 6174 696f 6e20 706f 6c69 6369  valuation polici
+00025110: 6573 2e0a 0a20 2020 2020 2020 2050 6172  es...        Par
+00025120: 616d 6574 6572 730a 2020 2020 2020 2020  ameters.        
+00025130: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+00025140: 696e 7075 745f 6469 6374 3a20 4f50 4549  input_dict: OPEI
+00025150: 6e70 7574 4469 6374 206f 7220 4d75 6c74  nputDict or Mult
+00025160: 6970 6c65 496e 7075 7444 6963 740a 2020  ipleInputDict.  
+00025170: 2020 2020 2020 2020 2020 4469 6374 696f            Dictio
+00025180: 6e61 7279 206f 6620 7468 6520 4f50 4520  nary of the OPE 
+00025190: 696e 7075 7473 2066 6f72 2065 6163 6820  inputs for each 
+000251a0: 6576 616c 7561 7469 6f6e 2070 6f6c 6963  evaluation polic
+000251b0: 792e 0a0a 2020 2020 2020 2020 2020 2020  y...            
+000251c0: 2e2e 2063 6f64 652d 626c 6f63 6b3a 3a20  .. code-block:: 
+000251d0: 7079 7468 6f6e 0a0a 2020 2020 2020 2020  python..        
+000251e0: 2020 2020 2020 2020 6b65 793a 205b 6576          key: [ev
+000251f0: 616c 7561 7469 6f6e 5f70 6f6c 6963 795d  aluation_policy]
+00025200: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
+00025210: 2020 2020 2020 6576 616c 7561 7469 6f6e        evaluation
+00025220: 5f70 6f6c 6963 795f 6163 7469 6f6e 2c0a  _policy_action,.
+00025230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025240: 2020 2020 6576 616c 7561 7469 6f6e 5f70      evaluation_p
+00025250: 6f6c 6963 795f 6163 7469 6f6e 5f64 6973  olicy_action_dis
+00025260: 742c 0a20 2020 2020 2020 2020 2020 2020  t,.             
+00025270: 2020 2020 2020 2073 7461 7465 5f61 6374         state_act
+00025280: 696f 6e5f 7661 6c75 655f 7072 6564 6963  ion_value_predic
+00025290: 7469 6f6e 2c0a 2020 2020 2020 2020 2020  tion,.          
+000252a0: 2020 2020 2020 2020 2020 696e 6974 6961            initia
+000252b0: 6c5f 7374 6174 655f 7661 6c75 655f 7072  l_state_value_pr
+000252c0: 6564 6963 7469 6f6e 2c0a 2020 2020 2020  ediction,.      
+000252d0: 2020 2020 2020 2020 2020 2020 2020 7374                st
+000252e0: 6174 655f 6163 7469 6f6e 5f6d 6172 6769  ate_action_margi
+000252f0: 6e61 6c5f 696d 706f 7274 616e 6365 5f77  nal_importance_w
+00025300: 6569 6768 742c 0a20 2020 2020 2020 2020  eight,.         
+00025310: 2020 2020 2020 2020 2020 2073 7461 7465             state
+00025320: 5f6d 6172 6769 6e61 6c5f 696d 706f 7274  _marginal_import
+00025330: 616e 6365 5f77 6569 6768 742c 0a20 2020  ance_weight,.   
+00025340: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025350: 206f 6e5f 706f 6c69 6379 5f70 6f6c 6963   on_policy_polic
+00025360: 795f 7661 6c75 652c 0a20 2020 2020 2020  y_value,.       
+00025370: 2020 2020 2020 2020 2020 2020 2067 616d               gam
+00025380: 6d61 2c0a 2020 2020 2020 2020 2020 2020  ma,.            
+00025390: 2020 2020 2020 2020 6265 6861 7669 6f72          behavior
+000253a0: 5f70 6f6c 6963 792c 0a20 2020 2020 2020  _policy,.       
+000253b0: 2020 2020 2020 2020 2020 2020 2065 7661               eva
+000253c0: 6c75 6174 696f 6e5f 706f 6c69 6379 2c0a  luation_policy,.
+000253d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000253e0: 2020 2020 6461 7461 7365 745f 6964 2c0a      dataset_id,.
+000253f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025400: 5d0a 0a20 2020 2020 2020 2020 2020 202e  ]..            .
+00025410: 2e20 7365 6561 6c73 6f3a 3a0a 0a20 2020  . seealso::..   
+00025420: 2020 2020 2020 2020 2020 2020 203a 636c               :cl
+00025430: 6173 733a 6073 636f 7065 5f72 6c2e 6f70  ass:`scope_rl.op
+00025440: 652e 696e 7075 742e 4372 6561 7465 4f50  e.input.CreateOP
+00025450: 4549 6e70 7574 6020 6465 7363 7269 6265  EInput` describe
+00025460: 7320 7468 6520 636f 6d70 6f6e 656e 7473  s the components
+00025470: 206f 6620 3a63 6c61 7373 3a60 696e 7075   of :class:`inpu
+00025480: 745f 6469 6374 602e 0a0a 2020 2020 2020  t_dict`...      
+00025490: 2020 636f 6d70 6172 6564 5f65 7374 696d    compared_estim
+000254a0: 6174 6f72 733a 206c 6973 7420 6f66 2073  ators: list of s
+000254b0: 7472 2c20 6465 6661 756c 743d 4e6f 6e65  tr, default=None
+000254c0: 0a20 2020 2020 2020 2020 2020 204e 616d  .            Nam
+000254d0: 6520 6f66 2063 6f6d 7061 7265 6420 6573  e of compared es
+000254e0: 7469 6d61 746f 7273 2e0a 2020 2020 2020  timators..      
+000254f0: 2020 2020 2020 4966 2060 4e6f 6e65 6020        If `None` 
+00025500: 6973 2067 6976 656e 2c20 616c 6c20 7468  is given, all th
+00025510: 6520 6573 7469 6d61 746f 7273 2061 7265  e estimators are
+00025520: 2063 6f6d 7061 7265 642e 0a0a 2020 2020   compared...    
+00025530: 2020 2020 6265 6861 7669 6f72 5f70 6f6c      behavior_pol
+00025540: 6963 795f 6e61 6d65 3a20 7374 722c 2064  icy_name: str, d
+00025550: 6566 6175 6c74 3d4e 6f6e 650a 2020 2020  efault=None.    
+00025560: 2020 2020 2020 2020 4e61 6d65 206f 6620          Name of 
+00025570: 7468 6520 6265 6861 7669 6f72 2070 6f6c  the behavior pol
+00025580: 6963 792e 0a0a 2020 2020 2020 2020 6461  icy...        da
+00025590: 7461 7365 745f 6964 3a20 696e 742c 2064  taset_id: int, d
+000255a0: 6566 6175 6c74 3d4e 6f6e 650a 2020 2020  efault=None.    
+000255b0: 2020 2020 2020 2020 4964 206f 6620 7468          Id of th
+000255c0: 6520 6c6f 6767 6564 2064 6174 6173 6574  e logged dataset
+000255d0: 2e0a 0a20 2020 2020 2020 2052 6574 7572  ...        Retur
+000255e0: 6e0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  n.        ------
+000255f0: 2d0a 2020 2020 2020 2020 7661 7269 616e  -.        varian
+00025600: 6365 5f64 6963 743a 2064 6963 7420 282c  ce_dict: dict (,
+00025610: 206c 6973 7420 6f66 2064 6963 7429 0a20   list of dict). 
+00025620: 2020 2020 2020 2020 2020 2044 6963 7469             Dicti
+00025630: 6f6e 6172 7920 636f 6e74 6169 6e69 6e67  onary containing
+00025640: 2074 6865 2076 6172 6961 6e63 6520 6f66   the variance of
+00025650: 2074 7261 6a65 6374 6f72 792d 7769 7365   trajectory-wise
+00025660: 2072 6577 6172 6420 6f66 2065 6163 6820   reward of each 
+00025670: 6576 616c 7561 7469 6f6e 2070 6f6c 6963  evaluation polic
+00025680: 7920 6573 7469 6d61 7465 6420 6279 204f  y estimated by O
+00025690: 5045 2065 7374 696d 6174 6f72 732e 0a20  PE estimators.. 
+000256a0: 2020 2020 2020 2020 2020 206b 6579 3a20             key: 
+000256b0: 3a63 6c61 7373 3a60 5b65 7661 6c75 6174  :class:`[evaluat
+000256c0: 696f 6e5f 706f 6c69 6379 5d5b 4f50 455f  ion_policy][OPE_
+000256d0: 6573 7469 6d61 746f 725f 6e61 6d65 5d60  estimator_name]`
+000256e0: 0a0a 2020 2020 2020 2020 2020 2020 5768  ..            Wh
+000256f0: 656e 2062 6568 6176 696f 725f 706f 6c69  en behavior_poli
+00025700: 6379 5f6e 616d 6520 6973 2060 4e6f 6e65  cy_name is `None
+00025710: 6020 616e 6420 6461 7461 7365 745f 6964  ` and dataset_id
+00025720: 2069 7320 604e 6f6e 6560 2c0a 2020 2020   is `None`,.    
+00025730: 2020 2020 2020 2020 6b65 793a 203a 636c          key: :cl
+00025740: 6173 733a 605b 6265 6861 7669 6f72 5f70  ass:`[behavior_p
+00025750: 6f6c 6963 795f 6e61 6d65 5d5b 6461 7461  olicy_name][data
+00025760: 7365 745f 6964 5d5b 6576 616c 7561 7469  set_id][evaluati
+00025770: 6f6e 5f70 6f6c 6963 795d 5b4f 5045 5f65  on_policy][OPE_e
+00025780: 7374 696d 6174 6f72 5f6e 616d 655d 600a  stimator_name]`.
+00025790: 0a20 2020 2020 2020 2020 2020 2057 6865  .            Whe
+000257a0: 6e20 6265 6861 7669 6f72 5f70 6f6c 6963  n behavior_polic
+000257b0: 795f 6e61 6d65 2069 7320 604e 6f6e 6560  y_name is `None`
+000257c0: 2061 6e64 2064 6174 6173 6574 5f69 6420   and dataset_id 
+000257d0: 6973 2073 7065 6369 6669 6564 2c0a 2020  is specified,.  
+000257e0: 2020 2020 2020 2020 2020 6b65 793a 203a            key: :
+000257f0: 636c 6173 733a 605b 6265 6861 7669 6f72  class:`[behavior
+00025800: 5f70 6f6c 6963 795f 6e61 6d65 5d5b 6576  _policy_name][ev
+00025810: 616c 7561 7469 6f6e 5f70 6f6c 6963 795d  aluation_policy]
+00025820: 5b4f 5045 5f65 7374 696d 6174 6f72 5f6e  [OPE_estimator_n
+00025830: 616d 655d 600a 0a20 2020 2020 2020 2020  ame]`..         
+00025840: 2020 2057 6865 6e20 6265 6861 7669 6f72     When behavior
+00025850: 5f70 6f6c 6963 795f 6e61 6d65 2069 7320  _policy_name is 
+00025860: 7370 6563 6966 6965 6420 616e 6420 6461  specified and da
+00025870: 7461 7365 745f 6964 2069 7320 604e 6f6e  taset_id is `Non
+00025880: 6560 2c0a 2020 2020 2020 2020 2020 2020  e`,.            
+00025890: 6b65 793a 203a 636c 6173 733a 605b 6461  key: :class:`[da
+000258a0: 7461 7365 745f 6964 5d5b 4f50 455f 6573  taset_id][OPE_es
+000258b0: 7469 6d61 746f 725f 6e61 6d65 5d60 0a0a  timator_name]`..
+000258c0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+000258d0: 2020 2020 636f 6d70 6172 6564 5f65 7374      compared_est
+000258e0: 696d 6174 6f72 7320 3d20 7365 6c66 2e5f  imators = self._
+000258f0: 6368 6563 6b5f 636f 6d70 6172 6564 5f65  check_compared_e
+00025900: 7374 696d 6174 6f72 7328 636f 6d70 6172  stimators(compar
+00025910: 6564 5f65 7374 696d 6174 6f72 7329 0a0a  ed_estimators)..
+00025920: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00025930: 7573 655f 6d75 6c74 6970 6c65 5f6c 6f67  use_multiple_log
+00025940: 6765 645f 6461 7461 7365 743a 0a20 2020  ged_dataset:.   
+00025950: 2020 2020 2020 2020 2069 6620 6973 696e           if isin
+00025960: 7374 616e 6365 2869 6e70 7574 5f64 6963  stance(input_dic
+00025970: 742c 204d 756c 7469 706c 6549 6e70 7574  t, MultipleInput
+00025980: 4469 6374 293a 0a20 2020 2020 2020 2020  Dict):.         
+00025990: 2020 2020 2020 2069 6620 6265 6861 7669         if behavi
+000259a0: 6f72 5f70 6f6c 6963 795f 6e61 6d65 2069  or_policy_name i
+000259b0: 7320 4e6f 6e65 2061 6e64 2064 6174 6173  s None and datas
+000259c0: 6574 5f69 6420 6973 204e 6f6e 653a 0a20  et_id is None:. 
+000259d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000259e0: 2020 2069 6620 7365 6c66 2e6d 756c 7469     if self.multi
+000259f0: 706c 655f 6c6f 6767 6564 5f64 6174 6173  ple_logged_datas
+00025a00: 6574 2e6e 5f64 6174 6173 6574 7320 213d  et.n_datasets !=
+00025a10: 2069 6e70 7574 5f64 6963 742e 6e5f 6461   input_dict.n_da
+00025a20: 7461 7365 7473 3a0a 2020 2020 2020 2020  tasets:.        
+00025a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025a40: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+00025a50: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00025a60: 2020 2020 2020 2020 2020 2020 2020 2245                "E
+00025a70: 7870 6563 7465 6420 7468 6174 206c 6f67  xpected that log
+00025a80: 6765 6420 6461 7461 7365 7473 2061 6e64  ged datasets and
+00025a90: 2069 6e70 7574 2064 6963 7473 2063 6f6e   input dicts con
+00025aa0: 7369 7374 7320 6f66 2074 6865 2073 616d  sists of the sam
+00025ab0: 6520 6265 6861 7669 6f72 2070 6f6c 6963  e behavior polic
+00025ac0: 6965 7320 616e 6420 6461 7461 7365 7420  ies and dataset 
+00025ad0: 6964 732c 2062 7574 2066 6f75 6e64 2046  ids, but found F
+00025ae0: 616c 7365 2e22 0a20 2020 2020 2020 2020  alse.".         
+00025af0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+00025b00: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00025b10: 2020 2020 2020 7661 7269 616e 6365 5f64        variance_d
+00025b20: 6963 7420 3d20 6465 6661 756c 7464 6963  ict = defaultdic
+00025b30: 7428 6c69 7374 290a 2020 2020 2020 2020  t(list).        
+00025b40: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00025b50: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00025b60: 2020 2020 2020 2020 2020 6265 6861 7669            behavi
+00025b70: 6f72 5f70 6f6c 6963 792c 0a20 2020 2020  or_policy,.     
+00025b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025b90: 2020 206e 5f64 6174 6173 6574 732c 0a20     n_datasets,. 
+00025ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025bb0: 2020 2029 2069 6e20 696e 7075 745f 6469     ) in input_di
+00025bc0: 6374 2e6e 5f64 6174 6173 6574 732e 6974  ct.n_datasets.it
+00025bd0: 656d 7328 293a 0a20 2020 2020 2020 2020  ems():.         
+00025be0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00025bf0: 6f72 2064 6174 6173 6574 5f69 645f 2069  or dataset_id_ i
+00025c00: 6e20 7261 6e67 6528 6e5f 6461 7461 7365  n range(n_datase
+00025c10: 7473 293a 0a20 2020 2020 2020 2020 2020  ts):.           
+00025c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025c30: 2073 656c 662e 5f72 6567 6973 7465 725f   self._register_
+00025c40: 6c6f 6767 6564 5f64 6174 6173 6574 280a  logged_dataset(.
 00025c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025c60: 2020 2020 2020 206e 5f64 6174 6173 6574         n_dataset
-00025c70: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
-00025c80: 2020 2020 2020 2029 2069 6e20 696e 7075         ) in inpu
-00025c90: 745f 6469 6374 2e6e 5f64 6174 6173 6574  t_dict.n_dataset
-00025ca0: 732e 6974 656d 7328 293a 0a20 2020 2020  s.items():.     
-00025cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025cc0: 2020 2066 6f72 2064 6174 6173 6574 5f69     for dataset_i
-00025cd0: 645f 2069 6e20 7261 6e67 6528 6e5f 6461  d_ in range(n_da
-00025ce0: 7461 7365 7473 293a 0a20 2020 2020 2020  tasets):.       
+00025c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025c70: 6265 6861 7669 6f72 5f70 6f6c 6963 795f  behavior_policy_
+00025c80: 6e61 6d65 3d62 6568 6176 696f 725f 706f  name=behavior_po
+00025c90: 6c69 6379 2c0a 2020 2020 2020 2020 2020  licy,.          
+00025ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025cb0: 2020 2020 2020 6461 7461 7365 745f 6964        dataset_id
+00025cc0: 3d64 6174 6173 6574 5f69 645f 2c0a 2020  =dataset_id_,.  
+00025cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025ce0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
 00025cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025d00: 2020 2020 2073 656c 662e 5f72 6567 6973       self._regis
-00025d10: 7465 725f 6c6f 6767 6564 5f64 6174 6173  ter_logged_datas
-00025d20: 6574 280a 2020 2020 2020 2020 2020 2020  et(.            
+00025d00: 2020 2020 2020 2020 696e 7075 745f 6469          input_di
+00025d10: 6374 5f20 3d20 696e 7075 745f 6469 6374  ct_ = input_dict
+00025d20: 2e67 6574 280a 2020 2020 2020 2020 2020  .get(.          
 00025d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025d40: 2020 2020 6265 6861 7669 6f72 5f70 6f6c      behavior_pol
-00025d50: 6963 795f 6e61 6d65 3d62 6568 6176 696f  icy_name=behavio
-00025d60: 725f 706f 6c69 6379 2c0a 2020 2020 2020  r_policy,.      
+00025d40: 2020 2020 2020 6265 6861 7669 6f72 5f70        behavior_p
+00025d50: 6f6c 6963 795f 6e61 6d65 3d62 6568 6176  olicy_name=behav
+00025d60: 696f 725f 706f 6c69 6379 2c0a 2020 2020  ior_policy,.    
 00025d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025d80: 2020 2020 2020 2020 2020 6461 7461 7365            datase
-00025d90: 745f 6964 3d64 6174 6173 6574 5f69 645f  t_id=dataset_id_
-00025da0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00025db0: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-00025dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025dd0: 2020 2020 2020 2020 2020 2020 696e 7075              inpu
-00025de0: 745f 6469 6374 5f20 3d20 696e 7075 745f  t_dict_ = input_
-00025df0: 6469 6374 2e67 6574 280a 2020 2020 2020  dict.get(.      
-00025e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025e10: 2020 2020 2020 2020 2020 6265 6861 7669            behavi
-00025e20: 6f72 5f70 6f6c 6963 795f 6e61 6d65 3d62  or_policy_name=b
-00025e30: 6568 6176 696f 725f 706f 6c69 6379 2c0a  ehavior_policy,.
+00025d80: 2020 2020 2020 2020 2020 2020 6461 7461              data
+00025d90: 7365 745f 6964 3d64 6174 6173 6574 5f69  set_id=dataset_i
+00025da0: 645f 2c0a 2020 2020 2020 2020 2020 2020  d_,.            
+00025db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025dc0: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
+00025dd0: 2020 2020 2020 2020 2020 2020 2020 2076                 v
+00025de0: 6172 6961 6e63 655f 6469 6374 5f20 3d20  ariance_dict_ = 
+00025df0: 7365 6c66 2e5f 6573 7469 6d61 7465 5f76  self._estimate_v
+00025e00: 6172 6961 6e63 6528 0a20 2020 2020 2020  ariance(.       
+00025e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025e20: 2020 2020 2020 2020 2069 6e70 7574 5f64           input_d
+00025e30: 6963 745f 2c0a 2020 2020 2020 2020 2020  ict_,.          
 00025e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025e60: 6461 7461 7365 745f 6964 3d64 6174 6173  dataset_id=datas
-00025e70: 6574 5f69 645f 2c0a 2020 2020 2020 2020  et_id_,.        
+00025e50: 2020 2020 2020 636f 6d70 6172 6564 5f65        compared_e
+00025e60: 7374 696d 6174 6f72 733d 636f 6d70 6172  stimators=compar
+00025e70: 6564 5f65 7374 696d 6174 6f72 732c 0a20  ed_estimators,. 
 00025e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025e90: 2020 2020 290a 0a20 2020 2020 2020 2020      )..         
+00025e90: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
 00025ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025eb0: 2020 2076 6172 6961 6e63 655f 6469 6374     variance_dict
-00025ec0: 5f20 3d20 7365 6c66 2e5f 6573 7469 6d61  _ = self._estima
-00025ed0: 7465 5f76 6172 6961 6e63 6528 0a20 2020  te_variance(.   
-00025ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025ef0: 2020 2020 2020 2020 2020 2020 2069 6e70               inp
-00025f00: 7574 5f64 6963 745f 2c0a 2020 2020 2020  ut_dict_,.      
-00025f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025f20: 2020 2020 2020 2020 2020 636f 6d70 6172            compar
-00025f30: 6564 5f65 7374 696d 6174 6f72 733d 636f  ed_estimators=co
-00025f40: 6d70 6172 6564 5f65 7374 696d 6174 6f72  mpared_estimator
-00025f50: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
-00025f60: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-00025f70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00025f80: 2020 2020 2020 2020 2020 2020 2076 6172               var
-00025f90: 6961 6e63 655f 6469 6374 5b62 6568 6176  iance_dict[behav
-00025fa0: 696f 725f 706f 6c69 6379 5d2e 6170 7065  ior_policy].appe
-00025fb0: 6e64 2876 6172 6961 6e63 655f 6469 6374  nd(variance_dict
-00025fc0: 5f29 0a0a 2020 2020 2020 2020 2020 2020  _)..            
-00025fd0: 2020 2020 2020 2020 7661 7269 616e 6365          variance
-00025fe0: 5f64 6963 7420 3d20 6465 6661 756c 7464  _dict = defaultd
-00025ff0: 6963 745f 746f 5f64 6963 7428 7661 7269  ict_to_dict(vari
-00026000: 616e 6365 5f64 6963 7429 0a0a 2020 2020  ance_dict)..    
-00026010: 2020 2020 2020 2020 2020 2020 656c 6966              elif
-00026020: 2062 6568 6176 696f 725f 706f 6c69 6379   behavior_policy
-00026030: 5f6e 616d 6520 6973 204e 6f6e 6520 616e  _name is None an
-00026040: 6420 6461 7461 7365 745f 6964 2069 7320  d dataset_id is 
-00026050: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
-00026060: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00026070: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
-00026080: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00026090: 6d75 6c74 6970 6c65 5f6c 6f67 6765 645f  multiple_logged_
-000260a0: 6461 7461 7365 742e 6265 6861 7669 6f72  dataset.behavior
-000260b0: 5f70 6f6c 6963 795f 6e61 6d65 730a 2020  _policy_names.  
-000260c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000260d0: 2020 2020 2020 213d 2069 6e70 7574 5f64        != input_d
-000260e0: 6963 742e 6265 6861 7669 6f72 5f70 6f6c  ict.behavior_pol
-000260f0: 6963 795f 6e61 6d65 730a 2020 2020 2020  icy_names.      
-00026100: 2020 2020 2020 2020 2020 2020 2020 293a                ):
-00026110: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00026120: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-00026130: 616c 7565 4572 726f 7228 0a20 2020 2020  alueError(.     
-00026140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026150: 2020 2020 2020 2022 4578 7065 6374 6564         "Expected
-00026160: 2074 6861 7420 6c6f 6767 6564 2064 6174   that logged dat
-00026170: 6173 6574 7320 616e 6420 696e 7075 7420  asets and input 
-00026180: 6469 6374 7320 636f 6e73 6973 7473 206f  dicts consists o
-00026190: 6620 7468 6520 7361 6d65 2062 6568 6176  f the same behav
-000261a0: 696f 7220 706f 6c69 6369 6573 2c20 6275  ior policies, bu
-000261b0: 7420 666f 756e 6420 4661 6c73 652e 220a  t found False.".
-000261c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000261d0: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
-000261e0: 2020 2020 2020 2020 2020 2020 2020 2076                 v
-000261f0: 6172 6961 6e63 655f 6469 6374 203d 207b  ariance_dict = {
-00026200: 7d0a 2020 2020 2020 2020 2020 2020 2020  }.              
-00026210: 2020 2020 2020 666f 7220 6265 6861 7669        for behavi
-00026220: 6f72 5f70 6f6c 6963 7920 696e 2069 6e70  or_policy in inp
-00026230: 7574 5f64 6963 742e 6265 6861 7669 6f72  ut_dict.behavior
-00026240: 5f70 6f6c 6963 795f 6e61 6d65 733a 0a20  _policy_names:. 
-00026250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026260: 2020 2020 2020 2073 656c 662e 5f72 6567         self._reg
-00026270: 6973 7465 725f 6c6f 6767 6564 5f64 6174  ister_logged_dat
-00026280: 6173 6574 280a 2020 2020 2020 2020 2020  aset(.          
-00026290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000262a0: 2020 6265 6861 7669 6f72 5f70 6f6c 6963    behavior_polic
-000262b0: 795f 6e61 6d65 3d62 6568 6176 696f 725f  y_name=behavior_
-000262c0: 706f 6c69 6379 2c20 6461 7461 7365 745f  policy, dataset_
-000262d0: 6964 3d64 6174 6173 6574 5f69 640a 2020  id=dataset_id.  
-000262e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000262f0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00026300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026310: 696e 7075 745f 6469 6374 5f20 3d20 696e  input_dict_ = in
-00026320: 7075 745f 6469 6374 2e67 6574 280a 2020  put_dict.get(.  
+00025eb0: 2020 2020 2020 2020 2076 6172 6961 6e63           varianc
+00025ec0: 655f 6469 6374 5b62 6568 6176 696f 725f  e_dict[behavior_
+00025ed0: 706f 6c69 6379 5d2e 6170 7065 6e64 2876  policy].append(v
+00025ee0: 6172 6961 6e63 655f 6469 6374 5f29 0a0a  ariance_dict_)..
+00025ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025f00: 2020 2020 7661 7269 616e 6365 5f64 6963      variance_dic
+00025f10: 7420 3d20 6465 6661 756c 7464 6963 745f  t = defaultdict_
+00025f20: 746f 5f64 6963 7428 7661 7269 616e 6365  to_dict(variance
+00025f30: 5f64 6963 7429 0a0a 2020 2020 2020 2020  _dict)..        
+00025f40: 2020 2020 2020 2020 656c 6966 2062 6568          elif beh
+00025f50: 6176 696f 725f 706f 6c69 6379 5f6e 616d  avior_policy_nam
+00025f60: 6520 6973 204e 6f6e 6520 616e 6420 6461  e is None and da
+00025f70: 7461 7365 745f 6964 2069 7320 6e6f 7420  taset_id is not 
+00025f80: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+00025f90: 2020 2020 2020 2020 2020 6966 2028 0a20            if (. 
+00025fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025fb0: 2020 2020 2020 2073 656c 662e 6d75 6c74         self.mult
+00025fc0: 6970 6c65 5f6c 6f67 6765 645f 6461 7461  iple_logged_data
+00025fd0: 7365 742e 6265 6861 7669 6f72 5f70 6f6c  set.behavior_pol
+00025fe0: 6963 795f 6e61 6d65 730a 2020 2020 2020  icy_names.      
+00025ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026000: 2020 213d 2069 6e70 7574 5f64 6963 742e    != input_dict.
+00026010: 6265 6861 7669 6f72 5f70 6f6c 6963 795f  behavior_policy_
+00026020: 6e61 6d65 730a 2020 2020 2020 2020 2020  names.          
+00026030: 2020 2020 2020 2020 2020 293a 0a20 2020            ):.   
+00026040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026050: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+00026060: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
+00026070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026080: 2020 2022 4578 7065 6374 6564 2074 6861     "Expected tha
+00026090: 7420 6c6f 6767 6564 2064 6174 6173 6574  t logged dataset
+000260a0: 7320 616e 6420 696e 7075 7420 6469 6374  s and input dict
+000260b0: 7320 636f 6e73 6973 7473 206f 6620 7468  s consists of th
+000260c0: 6520 7361 6d65 2062 6568 6176 696f 7220  e same behavior 
+000260d0: 706f 6c69 6369 6573 2c20 6275 7420 666f  policies, but fo
+000260e0: 756e 6420 4661 6c73 652e 220a 2020 2020  und False.".    
+000260f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026100: 2020 2020 290a 0a20 2020 2020 2020 2020      )..         
+00026110: 2020 2020 2020 2020 2020 2076 6172 6961             varia
+00026120: 6e63 655f 6469 6374 203d 207b 7d0a 2020  nce_dict = {}.  
+00026130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026140: 2020 666f 7220 6265 6861 7669 6f72 5f70    for behavior_p
+00026150: 6f6c 6963 7920 696e 2069 6e70 7574 5f64  olicy in input_d
+00026160: 6963 742e 6265 6861 7669 6f72 5f70 6f6c  ict.behavior_pol
+00026170: 6963 795f 6e61 6d65 733a 0a20 2020 2020  icy_names:.     
+00026180: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026190: 2020 2073 656c 662e 5f72 6567 6973 7465     self._registe
+000261a0: 725f 6c6f 6767 6564 5f64 6174 6173 6574  r_logged_dataset
+000261b0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+000261c0: 2020 2020 2020 2020 2020 2020 2020 6265                be
+000261d0: 6861 7669 6f72 5f70 6f6c 6963 795f 6e61  havior_policy_na
+000261e0: 6d65 3d62 6568 6176 696f 725f 706f 6c69  me=behavior_poli
+000261f0: 6379 2c20 6461 7461 7365 745f 6964 3d64  cy, dataset_id=d
+00026200: 6174 6173 6574 5f69 640a 2020 2020 2020  ataset_id.      
+00026210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026220: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+00026230: 2020 2020 2020 2020 2020 2020 696e 7075              inpu
+00026240: 745f 6469 6374 5f20 3d20 696e 7075 745f  t_dict_ = input_
+00026250: 6469 6374 2e67 6574 280a 2020 2020 2020  dict.get(.      
+00026260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026270: 2020 2020 2020 6265 6861 7669 6f72 5f70        behavior_p
+00026280: 6f6c 6963 795f 6e61 6d65 3d62 6568 6176  olicy_name=behav
+00026290: 696f 725f 706f 6c69 6379 2c0a 2020 2020  ior_policy,.    
+000262a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000262b0: 2020 2020 2020 2020 6461 7461 7365 745f          dataset_
+000262c0: 6964 3d64 6174 6173 6574 5f69 642c 0a20  id=dataset_id,. 
+000262d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000262e0: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+000262f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026300: 2020 7661 7269 616e 6365 5f64 6963 745f    variance_dict_
+00026310: 203d 2073 656c 662e 5f65 7374 696d 6174   = self._estimat
+00026320: 655f 7661 7269 616e 6365 280a 2020 2020  e_variance(.    
 00026330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026340: 2020 2020 2020 2020 2020 6265 6861 7669            behavi
-00026350: 6f72 5f70 6f6c 6963 795f 6e61 6d65 3d62  or_policy_name=b
-00026360: 6568 6176 696f 725f 706f 6c69 6379 2c0a  ehavior_policy,.
-00026370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026380: 2020 2020 2020 2020 2020 2020 6461 7461              data
-00026390: 7365 745f 6964 3d64 6174 6173 6574 5f69  set_id=dataset_i
-000263a0: 642c 0a20 2020 2020 2020 2020 2020 2020  d,.             
-000263b0: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
-000263c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000263d0: 2020 2020 2020 7661 7269 616e 6365 5f64        variance_d
-000263e0: 6963 745f 203d 2073 656c 662e 5f65 7374  ict_ = self._est
-000263f0: 696d 6174 655f 7661 7269 616e 6365 280a  imate_variance(.
-00026400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026410: 2020 2020 2020 2020 2020 2020 696e 7075              inpu
-00026420: 745f 6469 6374 5f2c 0a20 2020 2020 2020  t_dict_,.       
-00026430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026440: 2020 2020 2063 6f6d 7061 7265 645f 6573       compared_es
-00026450: 7469 6d61 746f 7273 3d63 6f6d 7061 7265  timators=compare
-00026460: 645f 6573 7469 6d61 746f 7273 2c0a 2020  d_estimators,.  
-00026470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026480: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00026490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000264a0: 7661 7269 616e 6365 5f64 6963 745b 6265  variance_dict[be
-000264b0: 6861 7669 6f72 5f70 6f6c 6963 795d 203d  havior_policy] =
-000264c0: 2076 6172 6961 6e63 655f 6469 6374 5f0a   variance_dict_.
-000264d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000264e0: 2065 6c69 6620 6265 6861 7669 6f72 5f70   elif behavior_p
-000264f0: 6f6c 6963 795f 6e61 6d65 2069 7320 6e6f  olicy_name is no
-00026500: 7420 4e6f 6e65 2061 6e64 2064 6174 6173  t None and datas
-00026510: 6574 5f69 6420 6973 204e 6f6e 653a 0a20  et_id is None:. 
+00026340: 2020 2020 2020 2020 696e 7075 745f 6469          input_di
+00026350: 6374 5f2c 0a20 2020 2020 2020 2020 2020  ct_,.           
+00026360: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026370: 2063 6f6d 7061 7265 645f 6573 7469 6d61   compared_estima
+00026380: 746f 7273 3d63 6f6d 7061 7265 645f 6573  tors=compared_es
+00026390: 7469 6d61 746f 7273 2c0a 2020 2020 2020  timators,.      
+000263a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000263b0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+000263c0: 2020 2020 2020 2020 2020 2020 7661 7269              vari
+000263d0: 616e 6365 5f64 6963 745b 6265 6861 7669  ance_dict[behavi
+000263e0: 6f72 5f70 6f6c 6963 795d 203d 2076 6172  or_policy] = var
+000263f0: 6961 6e63 655f 6469 6374 5f0a 0a20 2020  iance_dict_..   
+00026400: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
+00026410: 6620 6265 6861 7669 6f72 5f70 6f6c 6963  f behavior_polic
+00026420: 795f 6e61 6d65 2069 7320 6e6f 7420 4e6f  y_name is not No
+00026430: 6e65 2061 6e64 2064 6174 6173 6574 5f69  ne and dataset_i
+00026440: 6420 6973 204e 6f6e 653a 0a20 2020 2020  d is None:.     
+00026450: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00026460: 6620 280a 2020 2020 2020 2020 2020 2020  f (.            
+00026470: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00026480: 2e6d 756c 7469 706c 655f 6c6f 6767 6564  .multiple_logged
+00026490: 5f64 6174 6173 6574 2e6e 5f64 6174 6173  _dataset.n_datas
+000264a0: 6574 735b 6265 6861 7669 6f72 5f70 6f6c  ets[behavior_pol
+000264b0: 6963 795f 6e61 6d65 5d0a 2020 2020 2020  icy_name].      
+000264c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000264d0: 2020 213d 2069 6e70 7574 5f64 6963 742e    != input_dict.
+000264e0: 6e5f 6461 7461 7365 7473 5b62 6568 6176  n_datasets[behav
+000264f0: 696f 725f 706f 6c69 6379 5f6e 616d 655d  ior_policy_name]
+00026500: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00026510: 2020 2020 2029 3a0a 2020 2020 2020 2020       ):.        
 00026520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026530: 2020 2069 6620 280a 2020 2020 2020 2020     if (.        
-00026540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026550: 7365 6c66 2e6d 756c 7469 706c 655f 6c6f  self.multiple_lo
-00026560: 6767 6564 5f64 6174 6173 6574 2e6e 5f64  gged_dataset.n_d
-00026570: 6174 6173 6574 735b 6265 6861 7669 6f72  atasets[behavior
-00026580: 5f70 6f6c 6963 795f 6e61 6d65 5d0a 2020  _policy_name].  
-00026590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000265a0: 2020 2020 2020 213d 2069 6e70 7574 5f64        != input_d
-000265b0: 6963 742e 6e5f 6461 7461 7365 7473 5b62  ict.n_datasets[b
-000265c0: 6568 6176 696f 725f 706f 6c69 6379 5f6e  ehavior_policy_n
-000265d0: 616d 655d 0a20 2020 2020 2020 2020 2020  ame].           
-000265e0: 2020 2020 2020 2020 2029 3a0a 2020 2020           ):.    
-000265f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026600: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-00026610: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
-00026620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026630: 2020 2245 7870 6563 7465 6420 7468 6174    "Expected that
-00026640: 206c 6f67 6765 6420 6461 7461 7365 7473   logged datasets
-00026650: 2061 6e64 2069 6e70 7574 2064 6963 7473   and input dicts
-00026660: 2063 6f6e 7369 7374 7320 6f66 2074 6865   consists of the
-00026670: 2073 616d 6520 6461 7461 7365 7420 6964   same dataset id
-00026680: 732c 2062 7574 2066 6f75 6e64 2046 616c  s, but found Fal
-00026690: 7365 2e22 0a20 2020 2020 2020 2020 2020  se.".           
-000266a0: 2020 2020 2020 2020 2020 2020 2029 0a0a               )..
-000266b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000266c0: 2020 2020 7661 7269 616e 6365 5f64 6963      variance_dic
-000266d0: 7420 3d20 5b5d 0a20 2020 2020 2020 2020  t = [].         
-000266e0: 2020 2020 2020 2020 2020 2066 6f72 2064             for d
-000266f0: 6174 6173 6574 5f69 645f 2069 6e20 7261  ataset_id_ in ra
-00026700: 6e67 6528 0a20 2020 2020 2020 2020 2020  nge(.           
-00026710: 2020 2020 2020 2020 2020 2020 2069 6e70               inp
-00026720: 7574 5f64 6963 742e 6e5f 6461 7461 7365  ut_dict.n_datase
-00026730: 7473 5b62 6568 6176 696f 725f 706f 6c69  ts[behavior_poli
-00026740: 6379 5f6e 616d 655d 0a20 2020 2020 2020  cy_name].       
-00026750: 2020 2020 2020 2020 2020 2020 2029 3a0a               ):.
+00026530: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+00026540: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00026550: 2020 2020 2020 2020 2020 2020 2020 2245                "E
+00026560: 7870 6563 7465 6420 7468 6174 206c 6f67  xpected that log
+00026570: 6765 6420 6461 7461 7365 7473 2061 6e64  ged datasets and
+00026580: 2069 6e70 7574 2064 6963 7473 2063 6f6e   input dicts con
+00026590: 7369 7374 7320 6f66 2074 6865 2073 616d  sists of the sam
+000265a0: 6520 6461 7461 7365 7420 6964 732c 2062  e dataset ids, b
+000265b0: 7574 2066 6f75 6e64 2046 616c 7365 2e22  ut found False."
+000265c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000265d0: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
+000265e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000265f0: 7661 7269 616e 6365 5f64 6963 7420 3d20  variance_dict = 
+00026600: 5b5d 0a20 2020 2020 2020 2020 2020 2020  [].             
+00026610: 2020 2020 2020 2066 6f72 2064 6174 6173         for datas
+00026620: 6574 5f69 645f 2069 6e20 7261 6e67 6528  et_id_ in range(
+00026630: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00026640: 2020 2020 2020 2020 2069 6e70 7574 5f64           input_d
+00026650: 6963 742e 6e5f 6461 7461 7365 7473 5b62  ict.n_datasets[b
+00026660: 6568 6176 696f 725f 706f 6c69 6379 5f6e  ehavior_policy_n
+00026670: 616d 655d 0a20 2020 2020 2020 2020 2020  ame].           
+00026680: 2020 2020 2020 2020 2029 3a0a 2020 2020           ):.    
+00026690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000266a0: 2020 2020 7365 6c66 2e5f 7265 6769 7374      self._regist
+000266b0: 6572 5f6c 6f67 6765 645f 6461 7461 7365  er_logged_datase
+000266c0: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
+000266d0: 2020 2020 2020 2020 2020 2020 2020 2062                 b
+000266e0: 6568 6176 696f 725f 706f 6c69 6379 5f6e  ehavior_policy_n
+000266f0: 616d 653d 6265 6861 7669 6f72 5f70 6f6c  ame=behavior_pol
+00026700: 6963 795f 6e61 6d65 2c0a 2020 2020 2020  icy_name,.      
+00026710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026720: 2020 2020 2020 6461 7461 7365 745f 6964        dataset_id
+00026730: 3d64 6174 6173 6574 5f69 645f 2c0a 2020  =dataset_id_,.  
+00026740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026750: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
 00026760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026770: 2020 2020 2020 2020 7365 6c66 2e5f 7265          self._re
-00026780: 6769 7374 6572 5f6c 6f67 6765 645f 6461  gister_logged_da
-00026790: 7461 7365 7428 0a20 2020 2020 2020 2020  taset(.         
-000267a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000267b0: 2020 2062 6568 6176 696f 725f 706f 6c69     behavior_poli
-000267c0: 6379 5f6e 616d 653d 6265 6861 7669 6f72  cy_name=behavior
-000267d0: 5f70 6f6c 6963 795f 6e61 6d65 2c0a 2020  _policy_name,.  
+00026770: 696e 7075 745f 6469 6374 5f20 3d20 696e  input_dict_ = in
+00026780: 7075 745f 6469 6374 2e67 6574 280a 2020  put_dict.get(.  
+00026790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000267a0: 2020 2020 2020 2020 2020 6265 6861 7669            behavi
+000267b0: 6f72 5f70 6f6c 6963 795f 6e61 6d65 3d62  or_policy_name=b
+000267c0: 6568 6176 696f 725f 706f 6c69 6379 5f6e  ehavior_policy_n
+000267d0: 616d 652c 0a20 2020 2020 2020 2020 2020  ame,.           
 000267e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000267f0: 2020 2020 2020 2020 2020 6461 7461 7365            datase
-00026800: 745f 6964 3d64 6174 6173 6574 5f69 645f  t_id=dataset_id_
-00026810: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00026820: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00026830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026840: 2020 2020 696e 7075 745f 6469 6374 5f20      input_dict_ 
-00026850: 3d20 696e 7075 745f 6469 6374 2e67 6574  = input_dict.get
-00026860: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00026870: 2020 2020 2020 2020 2020 2020 2020 6265                be
-00026880: 6861 7669 6f72 5f70 6f6c 6963 795f 6e61  havior_policy_na
-00026890: 6d65 3d62 6568 6176 696f 725f 706f 6c69  me=behavior_poli
-000268a0: 6379 5f6e 616d 652c 0a20 2020 2020 2020  cy_name,.       
-000268b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000268c0: 2020 2020 2064 6174 6173 6574 5f69 643d       dataset_id=
-000268d0: 6461 7461 7365 745f 6964 5f2c 0a20 2020  dataset_id_,.   
-000268e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000268f0: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
-00026900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026910: 7661 7269 616e 6365 5f64 6963 745f 203d  variance_dict_ =
-00026920: 2073 656c 662e 5f65 7374 696d 6174 655f   self._estimate_
-00026930: 7661 7269 616e 6365 280a 2020 2020 2020  variance(.      
-00026940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026950: 2020 2020 2020 696e 7075 745f 6469 6374        input_dict
-00026960: 5f2c 0a20 2020 2020 2020 2020 2020 2020  _,.             
-00026970: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00026980: 6f6d 7061 7265 645f 6573 7469 6d61 746f  ompared_estimato
-00026990: 7273 3d63 6f6d 7061 7265 645f 6573 7469  rs=compared_esti
-000269a0: 6d61 746f 7273 2c0a 2020 2020 2020 2020  mators,.        
-000269b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000269c0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-000269d0: 2020 2020 2020 2020 2020 7661 7269 616e            varian
-000269e0: 6365 5f64 6963 742e 6170 7065 6e64 2876  ce_dict.append(v
-000269f0: 6172 6961 6e63 655f 6469 6374 5f29 0a0a  ariance_dict_)..
-00026a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026a10: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00026a20: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-00026a30: 7265 6769 7374 6572 5f6c 6f67 6765 645f  register_logged_
-00026a40: 6461 7461 7365 7428 0a20 2020 2020 2020  dataset(.       
-00026a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026a60: 2062 6568 6176 696f 725f 706f 6c69 6379   behavior_policy
-00026a70: 5f6e 616d 653d 6265 6861 7669 6f72 5f70  _name=behavior_p
-00026a80: 6f6c 6963 795f 6e61 6d65 2c20 6461 7461  olicy_name, data
-00026a90: 7365 745f 6964 3d64 6174 6173 6574 5f69  set_id=dataset_i
-00026aa0: 640a 2020 2020 2020 2020 2020 2020 2020  d.              
-00026ab0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00026ac0: 2020 2020 2020 2020 2020 2020 696e 7075              inpu
-00026ad0: 745f 6469 6374 5f20 3d20 696e 7075 745f  t_dict_ = input_
-00026ae0: 6469 6374 2e67 6574 280a 2020 2020 2020  dict.get(.      
+000267f0: 2064 6174 6173 6574 5f69 643d 6461 7461   dataset_id=data
+00026800: 7365 745f 6964 5f2c 0a20 2020 2020 2020  set_id_,.       
+00026810: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026820: 2029 0a0a 2020 2020 2020 2020 2020 2020   )..            
+00026830: 2020 2020 2020 2020 2020 2020 7661 7269              vari
+00026840: 616e 6365 5f64 6963 745f 203d 2073 656c  ance_dict_ = sel
+00026850: 662e 5f65 7374 696d 6174 655f 7661 7269  f._estimate_vari
+00026860: 616e 6365 280a 2020 2020 2020 2020 2020  ance(.          
+00026870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026880: 2020 696e 7075 745f 6469 6374 5f2c 0a20    input_dict_,. 
+00026890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000268a0: 2020 2020 2020 2020 2020 2063 6f6d 7061             compa
+000268b0: 7265 645f 6573 7469 6d61 746f 7273 3d63  red_estimators=c
+000268c0: 6f6d 7061 7265 645f 6573 7469 6d61 746f  ompared_estimato
+000268d0: 7273 2c0a 2020 2020 2020 2020 2020 2020  rs,.            
+000268e0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+000268f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026900: 2020 2020 2020 7661 7269 616e 6365 5f64        variance_d
+00026910: 6963 742e 6170 7065 6e64 2876 6172 6961  ict.append(varia
+00026920: 6e63 655f 6469 6374 5f29 0a0a 2020 2020  nce_dict_)..    
+00026930: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00026940: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00026950: 2020 2020 2020 7365 6c66 2e5f 7265 6769        self._regi
+00026960: 7374 6572 5f6c 6f67 6765 645f 6461 7461  ster_logged_data
+00026970: 7365 7428 0a20 2020 2020 2020 2020 2020  set(.           
+00026980: 2020 2020 2020 2020 2020 2020 2062 6568               beh
+00026990: 6176 696f 725f 706f 6c69 6379 5f6e 616d  avior_policy_nam
+000269a0: 653d 6265 6861 7669 6f72 5f70 6f6c 6963  e=behavior_polic
+000269b0: 795f 6e61 6d65 2c20 6461 7461 7365 745f  y_name, dataset_
+000269c0: 6964 3d64 6174 6173 6574 5f69 640a 2020  id=dataset_id.  
+000269d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000269e0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+000269f0: 2020 2020 2020 2020 696e 7075 745f 6469          input_di
+00026a00: 6374 5f20 3d20 696e 7075 745f 6469 6374  ct_ = input_dict
+00026a10: 2e67 6574 280a 2020 2020 2020 2020 2020  .get(.          
+00026a20: 2020 2020 2020 2020 2020 2020 2020 6265                be
+00026a30: 6861 7669 6f72 5f70 6f6c 6963 795f 6e61  havior_policy_na
+00026a40: 6d65 3d62 6568 6176 696f 725f 706f 6c69  me=behavior_poli
+00026a50: 6379 5f6e 616d 652c 2064 6174 6173 6574  cy_name, dataset
+00026a60: 5f69 643d 6461 7461 7365 745f 6964 0a20  _id=dataset_id. 
+00026a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026a80: 2020 2029 0a0a 2020 2020 2020 2020 2020     )..          
+00026a90: 2020 2020 2020 2020 2020 7661 7269 616e            varian
+00026aa0: 6365 5f64 6963 7420 3d20 7365 6c66 2e5f  ce_dict = self._
+00026ab0: 6573 7469 6d61 7465 5f76 6172 6961 6e63  estimate_varianc
+00026ac0: 6528 0a20 2020 2020 2020 2020 2020 2020  e(.             
+00026ad0: 2020 2020 2020 2020 2020 2069 6e70 7574             input
+00026ae0: 5f64 6963 745f 2c0a 2020 2020 2020 2020  _dict_,.        
 00026af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026b00: 2020 6265 6861 7669 6f72 5f70 6f6c 6963    behavior_polic
-00026b10: 795f 6e61 6d65 3d62 6568 6176 696f 725f  y_name=behavior_
-00026b20: 706f 6c69 6379 5f6e 616d 652c 2064 6174  policy_name, dat
-00026b30: 6173 6574 5f69 643d 6461 7461 7365 745f  aset_id=dataset_
-00026b40: 6964 0a20 2020 2020 2020 2020 2020 2020  id.             
-00026b50: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-00026b60: 2020 2020 2020 2020 2020 2020 2020 7661                va
-00026b70: 7269 616e 6365 5f64 6963 7420 3d20 7365  riance_dict = se
-00026b80: 6c66 2e5f 6573 7469 6d61 7465 5f76 6172  lf._estimate_var
-00026b90: 6961 6e63 6528 0a20 2020 2020 2020 2020  iance(.         
-00026ba0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00026bb0: 6e70 7574 5f64 6963 745f 2c0a 2020 2020  nput_dict_,.    
-00026bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026bd0: 2020 2020 636f 6d70 6172 6564 5f65 7374      compared_est
-00026be0: 696d 6174 6f72 733d 636f 6d70 6172 6564  imators=compared
-00026bf0: 5f65 7374 696d 6174 6f72 732c 0a20 2020  _estimators,.   
-00026c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026c10: 2029 0a0a 2020 2020 2020 2020 2020 2020   )..            
-00026c20: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00026c30: 2020 2020 2020 6265 6861 7669 6f72 5f70        behavior_p
-00026c40: 6f6c 6963 795f 6e61 6d65 203d 206c 6973  olicy_name = lis
-00026c50: 7428 696e 7075 745f 6469 6374 2e76 616c  t(input_dict.val
-00026c60: 7565 7328 2929 5b30 5d5b 2262 6568 6176  ues())[0]["behav
-00026c70: 696f 725f 706f 6c69 6379 225d 0a20 2020  ior_policy"].   
-00026c80: 2020 2020 2020 2020 2020 2020 2064 6174               dat
-00026c90: 6173 6574 5f69 6420 3d20 6c69 7374 2869  aset_id = list(i
-00026ca0: 6e70 7574 5f64 6963 742e 7661 6c75 6573  nput_dict.values
-00026cb0: 2829 295b 305d 5b22 6461 7461 7365 745f  ())[0]["dataset_
-00026cc0: 6964 225d 0a0a 2020 2020 2020 2020 2020  id"]..          
-00026cd0: 2020 2020 2020 7365 6c66 2e5f 7265 6769        self._regi
-00026ce0: 7374 6572 5f6c 6f67 6765 645f 6461 7461  ster_logged_data
-00026cf0: 7365 7428 0a20 2020 2020 2020 2020 2020  set(.           
-00026d00: 2020 2020 2020 2020 2062 6568 6176 696f           behavio
-00026d10: 725f 706f 6c69 6379 5f6e 616d 653d 6265  r_policy_name=be
-00026d20: 6861 7669 6f72 5f70 6f6c 6963 795f 6e61  havior_policy_na
-00026d30: 6d65 2c20 6461 7461 7365 745f 6964 3d64  me, dataset_id=d
-00026d40: 6174 6173 6574 5f69 640a 2020 2020 2020  ataset_id.      
-00026d50: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
-00026d60: 2020 2020 2020 2020 2020 2020 2076 6172               var
-00026d70: 6961 6e63 655f 6469 6374 203d 2073 656c  iance_dict = sel
-00026d80: 662e 5f65 7374 696d 6174 655f 7661 7269  f._estimate_vari
-00026d90: 616e 6365 280a 2020 2020 2020 2020 2020  ance(.          
-00026da0: 2020 2020 2020 2020 2020 696e 7075 745f            input_
-00026db0: 6469 6374 2c0a 2020 2020 2020 2020 2020  dict,.          
-00026dc0: 2020 2020 2020 2020 2020 636f 6d70 6172            compar
-00026dd0: 6564 5f65 7374 696d 6174 6f72 733d 636f  ed_estimators=co
-00026de0: 6d70 6172 6564 5f65 7374 696d 6174 6f72  mpared_estimator
-00026df0: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
-00026e00: 2020 2029 0a0a 2020 2020 2020 2020 656c     )..        el
-00026e10: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00026e20: 6966 2069 7369 6e73 7461 6e63 6528 696e  if isinstance(in
-00026e30: 7075 745f 6469 6374 2c20 4d75 6c74 6970  put_dict, Multip
-00026e40: 6c65 496e 7075 7444 6963 7429 3a0a 2020  leInputDict):.  
-00026e50: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-00026e60: 6973 6520 5661 6c75 6545 7272 6f72 280a  ise ValueError(.
-00026e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026e80: 2020 2020 2277 6865 6e20 7573 696e 6720      "when using 
-00026e90: 4c6f 6767 6564 4461 7461 7365 742c 2070  LoggedDataset, p
-00026ea0: 6c65 6173 6520 7573 6520 496e 7075 7444  lease use InputD
-00026eb0: 6963 7420 696e 7374 6561 6420 6f66 204d  ict instead of M
-00026ec0: 756c 7469 706c 6549 6e70 7574 4469 6374  ultipleInputDict
-00026ed0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-00026ee0: 2020 290a 0a20 2020 2020 2020 2020 2020    )..           
-00026ef0: 2076 6172 6961 6e63 655f 6469 6374 203d   variance_dict =
-00026f00: 2073 656c 662e 5f65 7374 696d 6174 655f   self._estimate_
-00026f10: 7661 7269 616e 6365 280a 2020 2020 2020  variance(.      
-00026f20: 2020 2020 2020 2020 2020 696e 7075 745f            input_
-00026f30: 6469 6374 2c0a 2020 2020 2020 2020 2020  dict,.          
+00026b00: 636f 6d70 6172 6564 5f65 7374 696d 6174  compared_estimat
+00026b10: 6f72 733d 636f 6d70 6172 6564 5f65 7374  ors=compared_est
+00026b20: 696d 6174 6f72 732c 0a20 2020 2020 2020  imators,.       
+00026b30: 2020 2020 2020 2020 2020 2020 2029 0a0a               )..
+00026b40: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00026b50: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00026b60: 2020 6265 6861 7669 6f72 5f70 6f6c 6963    behavior_polic
+00026b70: 795f 6e61 6d65 203d 206c 6973 7428 696e  y_name = list(in
+00026b80: 7075 745f 6469 6374 2e76 616c 7565 7328  put_dict.values(
+00026b90: 2929 5b30 5d5b 2262 6568 6176 696f 725f  ))[0]["behavior_
+00026ba0: 706f 6c69 6379 225d 0a20 2020 2020 2020  policy"].       
+00026bb0: 2020 2020 2020 2020 2064 6174 6173 6574           dataset
+00026bc0: 5f69 6420 3d20 6c69 7374 2869 6e70 7574  _id = list(input
+00026bd0: 5f64 6963 742e 7661 6c75 6573 2829 295b  _dict.values())[
+00026be0: 305d 5b22 6461 7461 7365 745f 6964 225d  0]["dataset_id"]
+00026bf0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00026c00: 2020 7365 6c66 2e5f 7265 6769 7374 6572    self._register
+00026c10: 5f6c 6f67 6765 645f 6461 7461 7365 7428  _logged_dataset(
+00026c20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00026c30: 2020 2020 2062 6568 6176 696f 725f 706f       behavior_po
+00026c40: 6c69 6379 5f6e 616d 653d 6265 6861 7669  licy_name=behavi
+00026c50: 6f72 5f70 6f6c 6963 795f 6e61 6d65 2c20  or_policy_name, 
+00026c60: 6461 7461 7365 745f 6964 3d64 6174 6173  dataset_id=datas
+00026c70: 6574 5f69 640a 2020 2020 2020 2020 2020  et_id.          
+00026c80: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+00026c90: 2020 2020 2020 2020 2076 6172 6961 6e63           varianc
+00026ca0: 655f 6469 6374 203d 2073 656c 662e 5f65  e_dict = self._e
+00026cb0: 7374 696d 6174 655f 7661 7269 616e 6365  stimate_variance
+00026cc0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00026cd0: 2020 2020 2020 696e 7075 745f 6469 6374        input_dict
+00026ce0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00026cf0: 2020 2020 2020 636f 6d70 6172 6564 5f65        compared_e
+00026d00: 7374 696d 6174 6f72 733d 636f 6d70 6172  stimators=compar
+00026d10: 6564 5f65 7374 696d 6174 6f72 732c 0a20  ed_estimators,. 
+00026d20: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+00026d30: 0a0a 2020 2020 2020 2020 656c 7365 3a0a  ..        else:.
+00026d40: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+00026d50: 7369 6e73 7461 6e63 6528 696e 7075 745f  sinstance(input_
+00026d60: 6469 6374 2c20 4d75 6c74 6970 6c65 496e  dict, MultipleIn
+00026d70: 7075 7444 6963 7429 3a0a 2020 2020 2020  putDict):.      
+00026d80: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00026d90: 5661 6c75 6545 7272 6f72 280a 2020 2020  ValueError(.    
+00026da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026db0: 2277 6865 6e20 7573 696e 6720 4c6f 6767  "when using Logg
+00026dc0: 6564 4461 7461 7365 742c 2070 6c65 6173  edDataset, pleas
+00026dd0: 6520 7573 6520 496e 7075 7444 6963 7420  e use InputDict 
+00026de0: 696e 7374 6561 6420 6f66 204d 756c 7469  instead of Multi
+00026df0: 706c 6549 6e70 7574 4469 6374 220a 2020  pleInputDict".  
+00026e00: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+00026e10: 0a20 2020 2020 2020 2020 2020 2076 6172  .            var
+00026e20: 6961 6e63 655f 6469 6374 203d 2073 656c  iance_dict = sel
+00026e30: 662e 5f65 7374 696d 6174 655f 7661 7269  f._estimate_vari
+00026e40: 616e 6365 280a 2020 2020 2020 2020 2020  ance(.          
+00026e50: 2020 2020 2020 696e 7075 745f 6469 6374        input_dict
+00026e60: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00026e70: 2020 636f 6d70 6172 6564 5f65 7374 696d    compared_estim
+00026e80: 6174 6f72 733d 636f 6d70 6172 6564 5f65  ators=compared_e
+00026e90: 7374 696d 6174 6f72 732c 0a20 2020 2020  stimators,.     
+00026ea0: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+00026eb0: 2020 7265 7475 726e 2076 6172 6961 6e63    return varianc
+00026ec0: 655f 6469 6374 0a0a 2020 2020 6465 6620  e_dict..    def 
+00026ed0: 6573 7469 6d61 7465 5f63 6f6e 6469 7469  estimate_conditi
+00026ee0: 6f6e 616c 5f76 616c 7565 5f61 745f 7269  onal_value_at_ri
+00026ef0: 736b 280a 2020 2020 2020 2020 7365 6c66  sk(.        self
+00026f00: 2c0a 2020 2020 2020 2020 696e 7075 745f  ,.        input_
+00026f10: 6469 6374 3a20 556e 696f 6e5b 4f50 4549  dict: Union[OPEI
+00026f20: 6e70 7574 4469 6374 2c20 4d75 6c74 6970  nputDict, Multip
+00026f30: 6c65 496e 7075 7444 6963 745d 2c0a 2020  leInputDict],.  
 00026f40: 2020 2020 2020 636f 6d70 6172 6564 5f65        compared_e
-00026f50: 7374 696d 6174 6f72 733d 636f 6d70 6172  stimators=compar
-00026f60: 6564 5f65 7374 696d 6174 6f72 732c 0a20  ed_estimators,. 
-00026f70: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
-00026f80: 2020 2020 2020 7265 7475 726e 2076 6172        return var
-00026f90: 6961 6e63 655f 6469 6374 0a0a 2020 2020  iance_dict..    
-00026fa0: 6465 6620 6573 7469 6d61 7465 5f63 6f6e  def estimate_con
-00026fb0: 6469 7469 6f6e 616c 5f76 616c 7565 5f61  ditional_value_a
-00026fc0: 745f 7269 736b 280a 2020 2020 2020 2020  t_risk(.        
-00026fd0: 7365 6c66 2c0a 2020 2020 2020 2020 696e  self,.        in
-00026fe0: 7075 745f 6469 6374 3a20 556e 696f 6e5b  put_dict: Union[
-00026ff0: 4f50 4549 6e70 7574 4469 6374 2c20 4d75  OPEInputDict, Mu
-00027000: 6c74 6970 6c65 496e 7075 7444 6963 745d  ltipleInputDict]
-00027010: 2c0a 2020 2020 2020 2020 636f 6d70 6172  ,.        compar
-00027020: 6564 5f65 7374 696d 6174 6f72 733a 204f  ed_estimators: O
-00027030: 7074 696f 6e61 6c5b 4c69 7374 5b73 7472  ptional[List[str
-00027040: 5d5d 203d 204e 6f6e 652c 0a20 2020 2020  ]] = None,.     
-00027050: 2020 2062 6568 6176 696f 725f 706f 6c69     behavior_poli
-00027060: 6379 5f6e 616d 653a 204f 7074 696f 6e61  cy_name: Optiona
-00027070: 6c5b 7374 725d 203d 204e 6f6e 652c 0a20  l[str] = None,. 
-00027080: 2020 2020 2020 2064 6174 6173 6574 5f69         dataset_i
-00027090: 643a 204f 7074 696f 6e61 6c5b 696e 745d  d: Optional[int]
-000270a0: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
-000270b0: 2061 6c70 6861 733a 204f 7074 696f 6e61   alphas: Optiona
-000270c0: 6c5b 556e 696f 6e5b 6e70 2e6e 6461 7272  l[Union[np.ndarr
-000270d0: 6179 2c20 666c 6f61 745d 5d20 3d20 4e6f  ay, float]] = No
-000270e0: 6e65 2c0a 2020 2020 293a 0a20 2020 2020  ne,.    ):.     
-000270f0: 2020 2022 2222 4573 7469 6d61 7465 2074     """Estimate t
-00027100: 6865 2063 6f6e 6469 7469 6f6e 616c 2076  he conditional v
-00027110: 616c 7565 2061 7420 7269 736b 206f 6620  alue at risk of 
-00027120: 7468 6520 7472 616a 6563 746f 7279 2d77  the trajectory-w
-00027130: 6973 6520 7265 7761 7264 2075 6e64 6572  ise reward under
-00027140: 2074 6865 2067 6976 656e 2065 7661 6c75   the given evalu
-00027150: 6174 696f 6e20 706f 6c69 6369 6573 2e0a  ation policies..
-00027160: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
-00027170: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
-00027180: 2d2d 2d0a 2020 2020 2020 2020 696e 7075  ---.        inpu
-00027190: 745f 6469 6374 3a20 4f50 4549 6e70 7574  t_dict: OPEInput
-000271a0: 4469 6374 206f 7220 4d75 6c74 6970 6c65  Dict or Multiple
-000271b0: 496e 7075 7444 6963 740a 2020 2020 2020  InputDict.      
-000271c0: 2020 2020 2020 4469 6374 696f 6e61 7279        Dictionary
-000271d0: 206f 6620 7468 6520 4f50 4520 696e 7075   of the OPE inpu
-000271e0: 7473 2066 6f72 2065 6163 6820 6576 616c  ts for each eval
-000271f0: 7561 7469 6f6e 2070 6f6c 6963 792e 0a0a  uation policy...
-00027200: 2020 2020 2020 2020 2020 2020 2e2e 2063              .. c
-00027210: 6f64 652d 626c 6f63 6b3a 3a20 7079 7468  ode-block:: pyth
-00027220: 6f6e 0a0a 2020 2020 2020 2020 2020 2020  on..            
-00027230: 2020 2020 6b65 793a 205b 6576 616c 7561      key: [evalua
-00027240: 7469 6f6e 5f70 6f6c 6963 795d 5b0a 2020  tion_policy][.  
-00027250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027260: 2020 6576 616c 7561 7469 6f6e 5f70 6f6c    evaluation_pol
-00027270: 6963 795f 6163 7469 6f6e 2c0a 2020 2020  icy_action,.    
+00026f50: 7374 696d 6174 6f72 733a 204f 7074 696f  stimators: Optio
+00026f60: 6e61 6c5b 4c69 7374 5b73 7472 5d5d 203d  nal[List[str]] =
+00026f70: 204e 6f6e 652c 0a20 2020 2020 2020 2062   None,.        b
+00026f80: 6568 6176 696f 725f 706f 6c69 6379 5f6e  ehavior_policy_n
+00026f90: 616d 653a 204f 7074 696f 6e61 6c5b 7374  ame: Optional[st
+00026fa0: 725d 203d 204e 6f6e 652c 0a20 2020 2020  r] = None,.     
+00026fb0: 2020 2064 6174 6173 6574 5f69 643a 204f     dataset_id: O
+00026fc0: 7074 696f 6e61 6c5b 696e 745d 203d 204e  ptional[int] = N
+00026fd0: 6f6e 652c 0a20 2020 2020 2020 2061 6c70  one,.        alp
+00026fe0: 6861 733a 204f 7074 696f 6e61 6c5b 556e  has: Optional[Un
+00026ff0: 696f 6e5b 6e70 2e6e 6461 7272 6179 2c20  ion[np.ndarray, 
+00027000: 666c 6f61 745d 5d20 3d20 4e6f 6e65 2c0a  float]] = None,.
+00027010: 2020 2020 293a 0a20 2020 2020 2020 2022      ):.        "
+00027020: 2222 4573 7469 6d61 7465 2074 6865 2063  ""Estimate the c
+00027030: 6f6e 6469 7469 6f6e 616c 2076 616c 7565  onditional value
+00027040: 2061 7420 7269 736b 206f 6620 7468 6520   at risk of the 
+00027050: 7472 616a 6563 746f 7279 2d77 6973 6520  trajectory-wise 
+00027060: 7265 7761 7264 2075 6e64 6572 2074 6865  reward under the
+00027070: 2067 6976 656e 2065 7661 6c75 6174 696f   given evaluatio
+00027080: 6e20 706f 6c69 6369 6573 2e0a 0a20 2020  n policies...   
+00027090: 2020 2020 2050 6172 616d 6574 6572 730a       Parameters.
+000270a0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0a          -------.
+000270b0: 2020 2020 2020 2020 696e 7075 745f 6469          input_di
+000270c0: 6374 3a20 4f50 4549 6e70 7574 4469 6374  ct: OPEInputDict
+000270d0: 206f 7220 4d75 6c74 6970 6c65 496e 7075   or MultipleInpu
+000270e0: 7444 6963 740a 2020 2020 2020 2020 2020  tDict.          
+000270f0: 2020 4469 6374 696f 6e61 7279 206f 6620    Dictionary of 
+00027100: 7468 6520 4f50 4520 696e 7075 7473 2066  the OPE inputs f
+00027110: 6f72 2065 6163 6820 6576 616c 7561 7469  or each evaluati
+00027120: 6f6e 2070 6f6c 6963 792e 0a0a 2020 2020  on policy...    
+00027130: 2020 2020 2020 2020 2e2e 2063 6f64 652d          .. code-
+00027140: 626c 6f63 6b3a 3a20 7079 7468 6f6e 0a0a  block:: python..
+00027150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027160: 6b65 793a 205b 6576 616c 7561 7469 6f6e  key: [evaluation
+00027170: 5f70 6f6c 6963 795d 5b0a 2020 2020 2020  _policy][.      
+00027180: 2020 2020 2020 2020 2020 2020 2020 6576                ev
+00027190: 616c 7561 7469 6f6e 5f70 6f6c 6963 795f  aluation_policy_
+000271a0: 6163 7469 6f6e 2c0a 2020 2020 2020 2020  action,.        
+000271b0: 2020 2020 2020 2020 2020 2020 6576 616c              eval
+000271c0: 7561 7469 6f6e 5f70 6f6c 6963 795f 6163  uation_policy_ac
+000271d0: 7469 6f6e 5f64 6973 742c 0a20 2020 2020  tion_dist,.     
+000271e0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+000271f0: 7461 7465 5f61 6374 696f 6e5f 7661 6c75  tate_action_valu
+00027200: 655f 7072 6564 6963 7469 6f6e 2c0a 2020  e_prediction,.  
+00027210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027220: 2020 696e 6974 6961 6c5f 7374 6174 655f    initial_state_
+00027230: 7661 6c75 655f 7072 6564 6963 7469 6f6e  value_prediction
+00027240: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00027250: 2020 2020 2020 7374 6174 655f 6163 7469        state_acti
+00027260: 6f6e 5f6d 6172 6769 6e61 6c5f 696d 706f  on_marginal_impo
+00027270: 7274 616e 6365 5f77 6569 6768 742c 0a20  rtance_weight,. 
 00027280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027290: 6576 616c 7561 7469 6f6e 5f70 6f6c 6963  evaluation_polic
-000272a0: 795f 6163 7469 6f6e 5f64 6973 742c 0a20  y_action_dist,. 
-000272b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000272c0: 2020 2073 7461 7465 5f61 6374 696f 6e5f     state_action_
-000272d0: 7661 6c75 655f 7072 6564 6963 7469 6f6e  value_prediction
-000272e0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000272f0: 2020 2020 2020 696e 6974 6961 6c5f 7374        initial_st
-00027300: 6174 655f 7661 6c75 655f 7072 6564 6963  ate_value_predic
-00027310: 7469 6f6e 2c0a 2020 2020 2020 2020 2020  tion,.          
-00027320: 2020 2020 2020 2020 2020 7374 6174 655f            state_
-00027330: 6163 7469 6f6e 5f6d 6172 6769 6e61 6c5f  action_marginal_
-00027340: 696d 706f 7274 616e 6365 5f77 6569 6768  importance_weigh
-00027350: 742c 0a20 2020 2020 2020 2020 2020 2020  t,.             
-00027360: 2020 2020 2020 2073 7461 7465 5f6d 6172         state_mar
-00027370: 6769 6e61 6c5f 696d 706f 7274 616e 6365  ginal_importance
-00027380: 5f77 6569 6768 742c 0a20 2020 2020 2020  _weight,.       
-00027390: 2020 2020 2020 2020 2020 2020 206f 6e5f               on_
-000273a0: 706f 6c69 6379 5f70 6f6c 6963 795f 7661  policy_policy_va
-000273b0: 6c75 652c 0a20 2020 2020 2020 2020 2020  lue,.           
-000273c0: 2020 2020 2020 2020 2067 616d 6d61 2c0a           gamma,.
-000273d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000273e0: 2020 2020 6265 6861 7669 6f72 5f70 6f6c      behavior_pol
-000273f0: 6963 792c 0a20 2020 2020 2020 2020 2020  icy,.           
-00027400: 2020 2020 2020 2020 2065 7661 6c75 6174           evaluat
-00027410: 696f 6e5f 706f 6c69 6379 2c0a 2020 2020  ion_policy,.    
-00027420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027430: 6461 7461 7365 745f 6964 2c0a 2020 2020  dataset_id,.    
-00027440: 2020 2020 2020 2020 2020 2020 5d0a 0a20              ].. 
-00027450: 2020 2020 2020 2020 2020 202e 2e20 7365             .. se
-00027460: 6561 6c73 6f3a 3a0a 0a20 2020 2020 2020  ealso::..       
-00027470: 2020 2020 2020 2020 203a 636c 6173 733a           :class:
-00027480: 6073 636f 7065 5f72 6c2e 6f70 652e 696e  `scope_rl.ope.in
-00027490: 7075 742e 4372 6561 7465 4f50 4549 6e70  put.CreateOPEInp
-000274a0: 7574 6020 6465 7363 7269 6265 7320 7468  ut` describes th
-000274b0: 6520 636f 6d70 6f6e 656e 7473 206f 6620  e components of 
-000274c0: 3a63 6c61 7373 3a60 696e 7075 745f 6469  :class:`input_di
-000274d0: 6374 602e 0a0a 2020 2020 2020 2020 636f  ct`...        co
-000274e0: 6d70 6172 6564 5f65 7374 696d 6174 6f72  mpared_estimator
-000274f0: 733a 206c 6973 7420 6f66 2073 7472 2c20  s: list of str, 
-00027500: 6465 6661 756c 743d 4e6f 6e65 0a20 2020  default=None.   
-00027510: 2020 2020 2020 2020 204e 616d 6520 6f66           Name of
-00027520: 2063 6f6d 7061 7265 6420 6573 7469 6d61   compared estima
-00027530: 746f 7273 2e0a 2020 2020 2020 2020 2020  tors..          
-00027540: 2020 4966 2060 4e6f 6e65 6020 6973 2067    If `None` is g
-00027550: 6976 656e 2c20 616c 6c20 7468 6520 6573  iven, all the es
-00027560: 7469 6d61 746f 7273 2061 7265 2063 6f6d  timators are com
-00027570: 7061 7265 642e 0a0a 2020 2020 2020 2020  pared...        
-00027580: 6265 6861 7669 6f72 5f70 6f6c 6963 795f  behavior_policy_
-00027590: 6e61 6d65 3a20 7374 722c 2064 6566 6175  name: str, defau
-000275a0: 6c74 3d4e 6f6e 650a 2020 2020 2020 2020  lt=None.        
-000275b0: 2020 2020 4e61 6d65 206f 6620 7468 6520      Name of the 
-000275c0: 6265 6861 7669 6f72 2070 6f6c 6963 792e  behavior policy.
-000275d0: 0a0a 2020 2020 2020 2020 6461 7461 7365  ..        datase
-000275e0: 745f 6964 3a20 696e 742c 2064 6566 6175  t_id: int, defau
-000275f0: 6c74 3d4e 6f6e 650a 2020 2020 2020 2020  lt=None.        
-00027600: 2020 2020 4964 206f 6620 7468 6520 6c6f      Id of the lo
-00027610: 6767 6564 2064 6174 6173 6574 2e0a 0a20  gged dataset... 
-00027620: 2020 2020 2020 2061 6c70 6861 733a 207b         alphas: {
-00027630: 666c 6f61 742c 2061 7272 6179 2d6c 696b  float, array-lik
-00027640: 6520 6f66 2073 6861 7065 2028 6e5f 616c  e of shape (n_al
-00027650: 7068 612c 2029 7d2c 2064 6566 6175 6c74  pha, )}, default
-00027660: 3d4e 6f6e 650a 2020 2020 2020 2020 2020  =None.          
-00027670: 2020 5365 7420 6f66 2070 726f 706f 7274    Set of proport
-00027680: 696f 6e73 206f 6620 7468 6520 7368 6164  ions of the shad
-00027690: 6564 2072 6567 696f 6e2e 2054 6865 2076  ed region. The v
-000276a0: 616c 7565 2873 2920 7368 6f75 6c64 2062  alue(s) should b
-000276b0: 6520 7769 7468 696e 2060 5b30 2c20 3129  e within `[0, 1)
-000276c0: 602e 0a20 2020 2020 2020 2020 2020 2049  `..            I
-000276d0: 6620 604e 6f6e 6560 2069 7320 6769 7665  f `None` is give
-000276e0: 6e2c 203a 636c 6173 733a 606e 702e 6c69  n, :class:`np.li
-000276f0: 6e73 7061 6365 2830 2c20 312c 2032 3129  nspace(0, 1, 21)
-00027700: 6020 7769 6c6c 2062 6520 7573 6564 2e0a  ` will be used..
-00027710: 0a20 2020 2020 2020 2052 6574 7572 6e0a  .        Return.
-00027720: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0a          -------.
-00027730: 2020 2020 2020 2020 636f 6e64 6974 696f          conditio
-00027740: 6e61 6c5f 7661 6c75 655f 6174 5f72 6973  nal_value_at_ris
-00027750: 6b5f 6469 6374 3a20 6469 6374 2028 2c20  k_dict: dict (, 
-00027760: 6c69 7374 206f 6620 6469 6374 290a 2020  list of dict).  
-00027770: 2020 2020 2020 2020 2020 4469 6374 696f            Dictio
-00027780: 6e61 7279 2063 6f6e 7461 696e 696e 6720  nary containing 
-00027790: 7468 6520 636f 6e64 6974 696f 6e61 6c20  the conditional 
-000277a0: 7661 6c75 6520 6174 2072 6973 6b20 6f66  value at risk of
-000277b0: 2074 7261 6a65 6374 6f72 792d 7769 7365   trajectory-wise
-000277c0: 2072 6577 6172 6420 6f66 2065 6163 6820   reward of each 
-000277d0: 6576 616c 7561 7469 6f6e 2070 6f6c 6963  evaluation polic
-000277e0: 7920 6573 7469 6d61 7465 6420 6279 204f  y estimated by O
-000277f0: 5045 2065 7374 696d 6174 6f72 732e 0a20  PE estimators.. 
-00027800: 2020 2020 2020 2020 2020 206b 6579 3a20             key: 
-00027810: 3a63 6c61 7373 3a60 5b65 7661 6c75 6174  :class:`[evaluat
-00027820: 696f 6e5f 706f 6c69 6379 5d5b 4f50 455f  ion_policy][OPE_
-00027830: 6573 7469 6d61 746f 725f 6e61 6d65 5d60  estimator_name]`
-00027840: 0a0a 2020 2020 2020 2020 2020 2020 5768  ..            Wh
-00027850: 656e 2062 6568 6176 696f 725f 706f 6c69  en behavior_poli
-00027860: 6379 5f6e 616d 6520 6973 2060 4e6f 6e65  cy_name is `None
-00027870: 6020 616e 6420 6461 7461 7365 745f 6964  ` and dataset_id
-00027880: 2069 7320 604e 6f6e 6560 2c0a 2020 2020   is `None`,.    
-00027890: 2020 2020 2020 2020 6b65 793a 203a 636c          key: :cl
-000278a0: 6173 733a 605b 6265 6861 7669 6f72 5f70  ass:`[behavior_p
-000278b0: 6f6c 6963 795f 6e61 6d65 5d5b 6461 7461  olicy_name][data
-000278c0: 7365 745f 6964 5d5b 6576 616c 7561 7469  set_id][evaluati
-000278d0: 6f6e 5f70 6f6c 6963 795d 5b4f 5045 5f65  on_policy][OPE_e
-000278e0: 7374 696d 6174 6f72 5f6e 616d 655d 600a  stimator_name]`.
-000278f0: 0a20 2020 2020 2020 2020 2020 2057 6865  .            Whe
-00027900: 6e20 6265 6861 7669 6f72 5f70 6f6c 6963  n behavior_polic
-00027910: 795f 6e61 6d65 2069 7320 604e 6f6e 6560  y_name is `None`
-00027920: 2061 6e64 2064 6174 6173 6574 5f69 6420   and dataset_id 
-00027930: 6973 2073 7065 6369 6669 6564 2c0a 2020  is specified,.  
-00027940: 2020 2020 2020 2020 2020 6b65 793a 203a            key: :
-00027950: 636c 6173 733a 605b 6265 6861 7669 6f72  class:`[behavior
-00027960: 5f70 6f6c 6963 795f 6e61 6d65 5d5b 6576  _policy_name][ev
-00027970: 616c 7561 7469 6f6e 5f70 6f6c 6963 795d  aluation_policy]
-00027980: 5b4f 5045 5f65 7374 696d 6174 6f72 5f6e  [OPE_estimator_n
-00027990: 616d 655d 600a 0a20 2020 2020 2020 2020  ame]`..         
-000279a0: 2020 2057 6865 6e20 6265 6861 7669 6f72     When behavior
-000279b0: 5f70 6f6c 6963 795f 6e61 6d65 2069 7320  _policy_name is 
-000279c0: 7370 6563 6966 6965 6420 616e 6420 6461  specified and da
-000279d0: 7461 7365 745f 6964 2069 7320 604e 6f6e  taset_id is `Non
-000279e0: 6560 2c0a 2020 2020 2020 2020 2020 2020  e`,.            
-000279f0: 6b65 793a 203a 636c 6173 733a 605b 6461  key: :class:`[da
-00027a00: 7461 7365 745f 6964 5d5b 4f50 455f 6573  taset_id][OPE_es
-00027a10: 7469 6d61 746f 725f 6e61 6d65 5d60 0a0a  timator_name]`..
-00027a20: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00027a30: 2020 2020 636f 6d70 6172 6564 5f65 7374      compared_est
-00027a40: 696d 6174 6f72 7320 3d20 7365 6c66 2e5f  imators = self._
-00027a50: 6368 6563 6b5f 636f 6d70 6172 6564 5f65  check_compared_e
-00027a60: 7374 696d 6174 6f72 7328 636f 6d70 6172  stimators(compar
-00027a70: 6564 5f65 7374 696d 6174 6f72 7329 0a20  ed_estimators). 
-00027a80: 2020 2020 2020 2061 6c70 6861 7320 3d20         alphas = 
-00027a90: 7365 6c66 2e5f 6368 6563 6b5f 6376 6172  self._check_cvar
-00027aa0: 5f61 6c70 6861 7328 616c 7068 6173 290a  _alphas(alphas).
-00027ab0: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
-00027ac0: 2e75 7365 5f6d 756c 7469 706c 655f 6c6f  .use_multiple_lo
-00027ad0: 6767 6564 5f64 6174 6173 6574 3a0a 2020  gged_dataset:.  
-00027ae0: 2020 2020 2020 2020 2020 6966 2069 7369            if isi
-00027af0: 6e73 7461 6e63 6528 696e 7075 745f 6469  nstance(input_di
-00027b00: 6374 2c20 4d75 6c74 6970 6c65 496e 7075  ct, MultipleInpu
-00027b10: 7444 6963 7429 3a0a 2020 2020 2020 2020  tDict):.        
-00027b20: 2020 2020 2020 2020 6966 2062 6568 6176          if behav
-00027b30: 696f 725f 706f 6c69 6379 5f6e 616d 6520  ior_policy_name 
-00027b40: 6973 204e 6f6e 6520 616e 6420 6461 7461  is None and data
-00027b50: 7365 745f 6964 2069 7320 4e6f 6e65 3a0a  set_id is None:.
-00027b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027b70: 2020 2020 6966 2073 656c 662e 6d75 6c74      if self.mult
-00027b80: 6970 6c65 5f6c 6f67 6765 645f 6461 7461  iple_logged_data
-00027b90: 7365 742e 6e5f 6461 7461 7365 7473 2021  set.n_datasets !
-00027ba0: 3d20 696e 7075 745f 6469 6374 2e6e 5f64  = input_dict.n_d
-00027bb0: 6174 6173 6574 733a 0a20 2020 2020 2020  atasets:.       
+00027290: 2020 2073 7461 7465 5f6d 6172 6769 6e61     state_margina
+000272a0: 6c5f 696d 706f 7274 616e 6365 5f77 6569  l_importance_wei
+000272b0: 6768 742c 0a20 2020 2020 2020 2020 2020  ght,.           
+000272c0: 2020 2020 2020 2020 206f 6e5f 706f 6c69           on_poli
+000272d0: 6379 5f70 6f6c 6963 795f 7661 6c75 652c  cy_policy_value,
+000272e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000272f0: 2020 2020 2067 616d 6d61 2c0a 2020 2020       gamma,.    
+00027300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027310: 6265 6861 7669 6f72 5f70 6f6c 6963 792c  behavior_policy,
+00027320: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00027330: 2020 2020 2065 7661 6c75 6174 696f 6e5f       evaluation_
+00027340: 706f 6c69 6379 2c0a 2020 2020 2020 2020  policy,.        
+00027350: 2020 2020 2020 2020 2020 2020 6461 7461              data
+00027360: 7365 745f 6964 2c0a 2020 2020 2020 2020  set_id,.        
+00027370: 2020 2020 2020 2020 5d0a 0a20 2020 2020          ]..     
+00027380: 2020 2020 2020 202e 2e20 7365 6561 6c73         .. seeals
+00027390: 6f3a 3a0a 0a20 2020 2020 2020 2020 2020  o::..           
+000273a0: 2020 2020 203a 636c 6173 733a 6073 636f       :class:`sco
+000273b0: 7065 5f72 6c2e 6f70 652e 696e 7075 742e  pe_rl.ope.input.
+000273c0: 4372 6561 7465 4f50 4549 6e70 7574 6020  CreateOPEInput` 
+000273d0: 6465 7363 7269 6265 7320 7468 6520 636f  describes the co
+000273e0: 6d70 6f6e 656e 7473 206f 6620 3a63 6c61  mponents of :cla
+000273f0: 7373 3a60 696e 7075 745f 6469 6374 602e  ss:`input_dict`.
+00027400: 0a0a 2020 2020 2020 2020 636f 6d70 6172  ..        compar
+00027410: 6564 5f65 7374 696d 6174 6f72 733a 206c  ed_estimators: l
+00027420: 6973 7420 6f66 2073 7472 2c20 6465 6661  ist of str, defa
+00027430: 756c 743d 4e6f 6e65 0a20 2020 2020 2020  ult=None.       
+00027440: 2020 2020 204e 616d 6520 6f66 2063 6f6d       Name of com
+00027450: 7061 7265 6420 6573 7469 6d61 746f 7273  pared estimators
+00027460: 2e0a 2020 2020 2020 2020 2020 2020 4966  ..            If
+00027470: 2060 4e6f 6e65 6020 6973 2067 6976 656e   `None` is given
+00027480: 2c20 616c 6c20 7468 6520 6573 7469 6d61  , all the estima
+00027490: 746f 7273 2061 7265 2063 6f6d 7061 7265  tors are compare
+000274a0: 642e 0a0a 2020 2020 2020 2020 6265 6861  d...        beha
+000274b0: 7669 6f72 5f70 6f6c 6963 795f 6e61 6d65  vior_policy_name
+000274c0: 3a20 7374 722c 2064 6566 6175 6c74 3d4e  : str, default=N
+000274d0: 6f6e 650a 2020 2020 2020 2020 2020 2020  one.            
+000274e0: 4e61 6d65 206f 6620 7468 6520 6265 6861  Name of the beha
+000274f0: 7669 6f72 2070 6f6c 6963 792e 0a0a 2020  vior policy...  
+00027500: 2020 2020 2020 6461 7461 7365 745f 6964        dataset_id
+00027510: 3a20 696e 742c 2064 6566 6175 6c74 3d4e  : int, default=N
+00027520: 6f6e 650a 2020 2020 2020 2020 2020 2020  one.            
+00027530: 4964 206f 6620 7468 6520 6c6f 6767 6564  Id of the logged
+00027540: 2064 6174 6173 6574 2e0a 0a20 2020 2020   dataset...     
+00027550: 2020 2061 6c70 6861 733a 207b 666c 6f61     alphas: {floa
+00027560: 742c 2061 7272 6179 2d6c 696b 6520 6f66  t, array-like of
+00027570: 2073 6861 7065 2028 6e5f 616c 7068 612c   shape (n_alpha,
+00027580: 2029 7d2c 2064 6566 6175 6c74 3d4e 6f6e   )}, default=Non
+00027590: 650a 2020 2020 2020 2020 2020 2020 5365  e.            Se
+000275a0: 7420 6f66 2070 726f 706f 7274 696f 6e73  t of proportions
+000275b0: 206f 6620 7468 6520 7368 6164 6564 2072   of the shaded r
+000275c0: 6567 696f 6e2e 2054 6865 2076 616c 7565  egion. The value
+000275d0: 2873 2920 7368 6f75 6c64 2062 6520 7769  (s) should be wi
+000275e0: 7468 696e 2060 5b30 2c20 3129 602e 0a20  thin `[0, 1)`.. 
+000275f0: 2020 2020 2020 2020 2020 2049 6620 604e             If `N
+00027600: 6f6e 6560 2069 7320 6769 7665 6e2c 203a  one` is given, :
+00027610: 636c 6173 733a 606e 702e 6c69 6e73 7061  class:`np.linspa
+00027620: 6365 2830 2c20 312c 2032 3129 6020 7769  ce(0, 1, 21)` wi
+00027630: 6c6c 2062 6520 7573 6564 2e0a 0a20 2020  ll be used...   
+00027640: 2020 2020 2052 6574 7572 6e0a 2020 2020       Return.    
+00027650: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
+00027660: 2020 2020 636f 6e64 6974 696f 6e61 6c5f      conditional_
+00027670: 7661 6c75 655f 6174 5f72 6973 6b5f 6469  value_at_risk_di
+00027680: 6374 3a20 6469 6374 2028 2c20 6c69 7374  ct: dict (, list
+00027690: 206f 6620 6469 6374 290a 2020 2020 2020   of dict).      
+000276a0: 2020 2020 2020 4469 6374 696f 6e61 7279        Dictionary
+000276b0: 2063 6f6e 7461 696e 696e 6720 7468 6520   containing the 
+000276c0: 636f 6e64 6974 696f 6e61 6c20 7661 6c75  conditional valu
+000276d0: 6520 6174 2072 6973 6b20 6f66 2074 7261  e at risk of tra
+000276e0: 6a65 6374 6f72 792d 7769 7365 2072 6577  jectory-wise rew
+000276f0: 6172 6420 6f66 2065 6163 6820 6576 616c  ard of each eval
+00027700: 7561 7469 6f6e 2070 6f6c 6963 7920 6573  uation policy es
+00027710: 7469 6d61 7465 6420 6279 204f 5045 2065  timated by OPE e
+00027720: 7374 696d 6174 6f72 732e 0a20 2020 2020  stimators..     
+00027730: 2020 2020 2020 206b 6579 3a20 3a63 6c61         key: :cla
+00027740: 7373 3a60 5b65 7661 6c75 6174 696f 6e5f  ss:`[evaluation_
+00027750: 706f 6c69 6379 5d5b 4f50 455f 6573 7469  policy][OPE_esti
+00027760: 6d61 746f 725f 6e61 6d65 5d60 0a0a 2020  mator_name]`..  
+00027770: 2020 2020 2020 2020 2020 5768 656e 2062            When b
+00027780: 6568 6176 696f 725f 706f 6c69 6379 5f6e  ehavior_policy_n
+00027790: 616d 6520 6973 2060 4e6f 6e65 6020 616e  ame is `None` an
+000277a0: 6420 6461 7461 7365 745f 6964 2069 7320  d dataset_id is 
+000277b0: 604e 6f6e 6560 2c0a 2020 2020 2020 2020  `None`,.        
+000277c0: 2020 2020 6b65 793a 203a 636c 6173 733a      key: :class:
+000277d0: 605b 6265 6861 7669 6f72 5f70 6f6c 6963  `[behavior_polic
+000277e0: 795f 6e61 6d65 5d5b 6461 7461 7365 745f  y_name][dataset_
+000277f0: 6964 5d5b 6576 616c 7561 7469 6f6e 5f70  id][evaluation_p
+00027800: 6f6c 6963 795d 5b4f 5045 5f65 7374 696d  olicy][OPE_estim
+00027810: 6174 6f72 5f6e 616d 655d 600a 0a20 2020  ator_name]`..   
+00027820: 2020 2020 2020 2020 2057 6865 6e20 6265           When be
+00027830: 6861 7669 6f72 5f70 6f6c 6963 795f 6e61  havior_policy_na
+00027840: 6d65 2069 7320 604e 6f6e 6560 2061 6e64  me is `None` and
+00027850: 2064 6174 6173 6574 5f69 6420 6973 2073   dataset_id is s
+00027860: 7065 6369 6669 6564 2c0a 2020 2020 2020  pecified,.      
+00027870: 2020 2020 2020 6b65 793a 203a 636c 6173        key: :clas
+00027880: 733a 605b 6265 6861 7669 6f72 5f70 6f6c  s:`[behavior_pol
+00027890: 6963 795f 6e61 6d65 5d5b 6576 616c 7561  icy_name][evalua
+000278a0: 7469 6f6e 5f70 6f6c 6963 795d 5b4f 5045  tion_policy][OPE
+000278b0: 5f65 7374 696d 6174 6f72 5f6e 616d 655d  _estimator_name]
+000278c0: 600a 0a20 2020 2020 2020 2020 2020 2057  `..            W
+000278d0: 6865 6e20 6265 6861 7669 6f72 5f70 6f6c  hen behavior_pol
+000278e0: 6963 795f 6e61 6d65 2069 7320 7370 6563  icy_name is spec
+000278f0: 6966 6965 6420 616e 6420 6461 7461 7365  ified and datase
+00027900: 745f 6964 2069 7320 604e 6f6e 6560 2c0a  t_id is `None`,.
+00027910: 2020 2020 2020 2020 2020 2020 6b65 793a              key:
+00027920: 203a 636c 6173 733a 605b 6461 7461 7365   :class:`[datase
+00027930: 745f 6964 5d5b 4f50 455f 6573 7469 6d61  t_id][OPE_estima
+00027940: 746f 725f 6e61 6d65 5d60 0a0a 2020 2020  tor_name]`..    
+00027950: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00027960: 636f 6d70 6172 6564 5f65 7374 696d 6174  compared_estimat
+00027970: 6f72 7320 3d20 7365 6c66 2e5f 6368 6563  ors = self._chec
+00027980: 6b5f 636f 6d70 6172 6564 5f65 7374 696d  k_compared_estim
+00027990: 6174 6f72 7328 636f 6d70 6172 6564 5f65  ators(compared_e
+000279a0: 7374 696d 6174 6f72 7329 0a20 2020 2020  stimators).     
+000279b0: 2020 2061 6c70 6861 7320 3d20 7365 6c66     alphas = self
+000279c0: 2e5f 6368 6563 6b5f 6376 6172 5f61 6c70  ._check_cvar_alp
+000279d0: 6861 7328 616c 7068 6173 290a 0a20 2020  has(alphas)..   
+000279e0: 2020 2020 2069 6620 7365 6c66 2e75 7365       if self.use
+000279f0: 5f6d 756c 7469 706c 655f 6c6f 6767 6564  _multiple_logged
+00027a00: 5f64 6174 6173 6574 3a0a 2020 2020 2020  _dataset:.      
+00027a10: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
+00027a20: 6e63 6528 696e 7075 745f 6469 6374 2c20  nce(input_dict, 
+00027a30: 4d75 6c74 6970 6c65 496e 7075 7444 6963  MultipleInputDic
+00027a40: 7429 3a0a 2020 2020 2020 2020 2020 2020  t):.            
+00027a50: 2020 2020 6966 2062 6568 6176 696f 725f      if behavior_
+00027a60: 706f 6c69 6379 5f6e 616d 6520 6973 204e  policy_name is N
+00027a70: 6f6e 6520 616e 6420 6461 7461 7365 745f  one and dataset_
+00027a80: 6964 2069 7320 4e6f 6e65 3a0a 2020 2020  id is None:.    
+00027a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027aa0: 6966 2073 656c 662e 6d75 6c74 6970 6c65  if self.multiple
+00027ab0: 5f6c 6f67 6765 645f 6461 7461 7365 742e  _logged_dataset.
+00027ac0: 6e5f 6461 7461 7365 7473 2021 3d20 696e  n_datasets != in
+00027ad0: 7075 745f 6469 6374 2e6e 5f64 6174 6173  put_dict.n_datas
+00027ae0: 6574 733a 0a20 2020 2020 2020 2020 2020  ets:.           
+00027af0: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+00027b00: 7365 2056 616c 7565 4572 726f 7228 0a20  se ValueError(. 
+00027b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027b20: 2020 2020 2020 2020 2020 2022 4578 7065             "Expe
+00027b30: 6374 6564 2074 6861 7420 6c6f 6767 6564  cted that logged
+00027b40: 2064 6174 6173 6574 7320 616e 6420 696e   datasets and in
+00027b50: 7075 7420 6469 6374 7320 636f 6e73 6973  put dicts consis
+00027b60: 7473 206f 6620 7468 6520 7361 6d65 2062  ts of the same b
+00027b70: 6568 6176 696f 7220 706f 6c69 6369 6573  ehavior policies
+00027b80: 2061 6e64 2064 6174 6173 6574 2069 6473   and dataset ids
+00027b90: 2c20 6275 7420 666f 756e 6420 4661 6c73  , but found Fals
+00027ba0: 652e 220a 2020 2020 2020 2020 2020 2020  e.".            
+00027bb0: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
 00027bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027bd0: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-00027be0: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
-00027bf0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00027c00: 4578 7065 6374 6564 2074 6861 7420 6c6f  Expected that lo
-00027c10: 6767 6564 2064 6174 6173 6574 7320 616e  gged datasets an
-00027c20: 6420 696e 7075 7420 6469 6374 7320 636f  d input dicts co
-00027c30: 6e73 6973 7473 206f 6620 7468 6520 7361  nsists of the sa
-00027c40: 6d65 2062 6568 6176 696f 7220 706f 6c69  me behavior poli
-00027c50: 6369 6573 2061 6e64 2064 6174 6173 6574  cies and dataset
-00027c60: 2069 6473 2c20 6275 7420 666f 756e 6420   ids, but found 
-00027c70: 4661 6c73 652e 220a 2020 2020 2020 2020  False.".        
-00027c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027c90: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
-00027ca0: 2020 2020 2020 2063 7661 725f 6469 6374         cvar_dict
-00027cb0: 203d 2064 6566 6175 6c74 6469 6374 286c   = defaultdict(l
-00027cc0: 6973 7429 0a20 2020 2020 2020 2020 2020  ist).           
-00027cd0: 2020 2020 2020 2020 2066 6f72 2028 0a20           for (. 
-00027ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027cf0: 2020 2020 2020 2062 6568 6176 696f 725f         behavior_
-00027d00: 706f 6c69 6379 2c0a 2020 2020 2020 2020  policy,.        
+00027bd0: 2020 2063 7661 725f 6469 6374 203d 2064     cvar_dict = d
+00027be0: 6566 6175 6c74 6469 6374 286c 6973 7429  efaultdict(list)
+00027bf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00027c00: 2020 2020 2066 6f72 2028 0a20 2020 2020       for (.     
+00027c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027c20: 2020 2062 6568 6176 696f 725f 706f 6c69     behavior_poli
+00027c30: 6379 2c0a 2020 2020 2020 2020 2020 2020  cy,.            
+00027c40: 2020 2020 2020 2020 2020 2020 6e5f 6461              n_da
+00027c50: 7461 7365 7473 2c0a 2020 2020 2020 2020  tasets,.        
+00027c60: 2020 2020 2020 2020 2020 2020 2920 696e              ) in
+00027c70: 2069 6e70 7574 5f64 6963 742e 6e5f 6461   input_dict.n_da
+00027c80: 7461 7365 7473 2e69 7465 6d73 2829 3a0a  tasets.items():.
+00027c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027ca0: 2020 2020 2020 2020 666f 7220 6461 7461          for data
+00027cb0: 7365 745f 6964 5f20 696e 2072 616e 6765  set_id_ in range
+00027cc0: 286e 5f64 6174 6173 6574 7329 3a0a 2020  (n_datasets):.  
+00027cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027ce0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+00027cf0: 7265 6769 7374 6572 5f6c 6f67 6765 645f  register_logged_
+00027d00: 6461 7461 7365 7428 0a20 2020 2020 2020  dataset(.       
 00027d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027d20: 6e5f 6461 7461 7365 7473 2c0a 2020 2020  n_datasets,.    
-00027d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027d40: 2920 696e 2069 6e70 7574 5f64 6963 742e  ) in input_dict.
-00027d50: 6e5f 6461 7461 7365 7473 2e69 7465 6d73  n_datasets.items
-00027d60: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
-00027d70: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00027d80: 6461 7461 7365 745f 6964 5f20 696e 2072  dataset_id_ in r
-00027d90: 616e 6765 286e 5f64 6174 6173 6574 7329  ange(n_datasets)
-00027da0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00027db0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00027dc0: 6c66 2e5f 7265 6769 7374 6572 5f6c 6f67  lf._register_log
-00027dd0: 6765 645f 6461 7461 7365 7428 0a20 2020  ged_dataset(.   
+00027d20: 2020 2020 2020 2020 2062 6568 6176 696f           behavio
+00027d30: 725f 706f 6c69 6379 5f6e 616d 653d 6265  r_policy_name=be
+00027d40: 6861 7669 6f72 5f70 6f6c 6963 792c 0a20  havior_policy,. 
+00027d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027d60: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+00027d70: 6174 6173 6574 5f69 643d 6461 7461 7365  ataset_id=datase
+00027d80: 745f 6964 5f2c 0a20 2020 2020 2020 2020  t_id_,.         
+00027d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027da0: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+00027db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027dc0: 2069 6e70 7574 5f64 6963 745f 203d 2069   input_dict_ = i
+00027dd0: 6e70 7574 5f64 6963 742e 6765 7428 0a20  nput_dict.get(. 
 00027de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027df0: 2020 2020 2020 2020 2020 2020 2062 6568               beh
-00027e00: 6176 696f 725f 706f 6c69 6379 5f6e 616d  avior_policy_nam
-00027e10: 653d 6265 6861 7669 6f72 5f70 6f6c 6963  e=behavior_polic
-00027e20: 792c 0a20 2020 2020 2020 2020 2020 2020  y,.             
+00027df0: 2020 2020 2020 2020 2020 2020 2020 2062                 b
+00027e00: 6568 6176 696f 725f 706f 6c69 6379 5f6e  ehavior_policy_n
+00027e10: 616d 653d 6265 6861 7669 6f72 5f70 6f6c  ame=behavior_pol
+00027e20: 6963 792c 0a20 2020 2020 2020 2020 2020  icy,.           
 00027e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027e40: 2020 2064 6174 6173 6574 5f69 643d 6461     dataset_id=da
-00027e50: 7461 7365 745f 6964 5f2c 0a20 2020 2020  taset_id_,.     
+00027e40: 2020 2020 2064 6174 6173 6574 5f69 643d       dataset_id=
+00027e50: 6461 7461 7365 745f 6964 5f2c 0a20 2020  dataset_id_,.   
 00027e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027e70: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00027e70: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
 00027e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027e90: 2020 2020 2069 6e70 7574 5f64 6963 745f       input_dict_
-00027ea0: 203d 2069 6e70 7574 5f64 6963 742e 6765   = input_dict.ge
-00027eb0: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
-00027ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027ed0: 2020 2062 6568 6176 696f 725f 706f 6c69     behavior_poli
-00027ee0: 6379 5f6e 616d 653d 6265 6861 7669 6f72  cy_name=behavior
-00027ef0: 5f70 6f6c 6963 792c 0a20 2020 2020 2020  _policy,.       
+00027e90: 2020 2020 2020 2020 6376 6172 5f64 6963          cvar_dic
+00027ea0: 745f 203d 2073 656c 662e 5f65 7374 696d  t_ = self._estim
+00027eb0: 6174 655f 636f 6e64 6974 696f 6e61 6c5f  ate_conditional_
+00027ec0: 7661 6c75 655f 6174 5f72 6973 6b28 0a20  value_at_risk(. 
+00027ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027ee0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00027ef0: 6e70 7574 5f64 6963 745f 2c0a 2020 2020  nput_dict_,.    
 00027f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027f10: 2020 2020 2020 2020 2064 6174 6173 6574           dataset
-00027f20: 5f69 643d 6461 7461 7365 745f 6964 5f2c  _id=dataset_id_,
-00027f30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00027f40: 2020 2020 2020 2020 2020 2020 2029 0a0a               )..
+00027f10: 2020 2020 2020 2020 2020 2020 636f 6d70              comp
+00027f20: 6172 6564 5f65 7374 696d 6174 6f72 733d  ared_estimators=
+00027f30: 636f 6d70 6172 6564 5f65 7374 696d 6174  compared_estimat
+00027f40: 6f72 732c 0a20 2020 2020 2020 2020 2020  ors,.           
 00027f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027f60: 2020 2020 2020 2020 2020 2020 6376 6172              cvar
-00027f70: 5f64 6963 745f 203d 2073 656c 662e 5f65  _dict_ = self._e
-00027f80: 7374 696d 6174 655f 636f 6e64 6974 696f  stimate_conditio
-00027f90: 6e61 6c5f 7661 6c75 655f 6174 5f72 6973  nal_value_at_ris
-00027fa0: 6b28 0a20 2020 2020 2020 2020 2020 2020  k(.             
-00027fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027fc0: 2020 2069 6e70 7574 5f64 6963 745f 2c0a     input_dict_,.
-00027fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027f60: 2020 2020 2061 6c70 6861 733d 616c 7068       alphas=alph
+00027f70: 6173 2c0a 2020 2020 2020 2020 2020 2020  as,.            
+00027f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027f90: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00027fa0: 2020 2020 2020 2020 2020 2020 2020 6376                cv
+00027fb0: 6172 5f64 6963 745b 6265 6861 7669 6f72  ar_dict[behavior
+00027fc0: 5f70 6f6c 6963 795d 2e61 7070 656e 6428  _policy].append(
+00027fd0: 6376 6172 5f64 6963 745f 290a 0a20 2020  cvar_dict_)..   
 00027fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027ff0: 636f 6d70 6172 6564 5f65 7374 696d 6174  compared_estimat
-00028000: 6f72 733d 636f 6d70 6172 6564 5f65 7374  ors=compared_est
-00028010: 696d 6174 6f72 732c 0a20 2020 2020 2020  imators,.       
-00028020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028030: 2020 2020 2020 2020 2061 6c70 6861 733d           alphas=
-00028040: 616c 7068 6173 2c0a 2020 2020 2020 2020  alphas,.        
-00028050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028060: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-00028070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028080: 2020 6376 6172 5f64 6963 745b 6265 6861    cvar_dict[beha
-00028090: 7669 6f72 5f70 6f6c 6963 795d 2e61 7070  vior_policy].app
-000280a0: 656e 6428 6376 6172 5f64 6963 745f 290a  end(cvar_dict_).
-000280b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000280c0: 2020 2020 2063 7661 725f 6469 6374 203d       cvar_dict =
-000280d0: 2064 6566 6175 6c74 6469 6374 5f74 6f5f   defaultdict_to_
-000280e0: 6469 6374 2863 7661 725f 6469 6374 290a  dict(cvar_dict).
-000280f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00028100: 2065 6c69 6620 6265 6861 7669 6f72 5f70   elif behavior_p
-00028110: 6f6c 6963 795f 6e61 6d65 2069 7320 4e6f  olicy_name is No
-00028120: 6e65 2061 6e64 2064 6174 6173 6574 5f69  ne and dataset_i
-00028130: 6420 6973 206e 6f74 204e 6f6e 653a 0a20  d is not None:. 
-00028140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028150: 2020 2069 6620 280a 2020 2020 2020 2020     if (.        
-00028160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028170: 7365 6c66 2e6d 756c 7469 706c 655f 6c6f  self.multiple_lo
-00028180: 6767 6564 5f64 6174 6173 6574 2e62 6568  gged_dataset.beh
-00028190: 6176 696f 725f 706f 6c69 6379 5f6e 616d  avior_policy_nam
-000281a0: 6573 0a20 2020 2020 2020 2020 2020 2020  es.             
-000281b0: 2020 2020 2020 2020 2020 2021 3d20 696e             != in
-000281c0: 7075 745f 6469 6374 2e62 6568 6176 696f  put_dict.behavio
-000281d0: 725f 706f 6c69 6379 5f6e 616d 6573 0a20  r_policy_names. 
-000281e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000281f0: 2020 2029 3a0a 2020 2020 2020 2020 2020     ):.          
-00028200: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-00028210: 6973 6520 5661 6c75 6545 7272 6f72 280a  ise ValueError(.
-00028220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028230: 2020 2020 2020 2020 2020 2020 2245 7870              "Exp
-00028240: 6563 7465 6420 7468 6174 206c 6f67 6765  ected that logge
-00028250: 6420 6461 7461 7365 7473 2061 6e64 2069  d datasets and i
-00028260: 6e70 7574 2064 6963 7473 2063 6f6e 7369  nput dicts consi
-00028270: 7374 7320 6f66 2074 6865 2073 616d 6520  sts of the same 
-00028280: 6265 6861 7669 6f72 2070 6f6c 6963 6965  behavior policie
-00028290: 732c 2062 7574 2066 6f75 6e64 2046 616c  s, but found Fal
-000282a0: 7365 2e22 0a20 2020 2020 2020 2020 2020  se.".           
-000282b0: 2020 2020 2020 2020 2020 2020 2029 0a0a               )..
-000282c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000282d0: 2020 2020 6376 6172 5f64 6963 7420 3d20      cvar_dict = 
-000282e0: 7b7d 0a20 2020 2020 2020 2020 2020 2020  {}.             
-000282f0: 2020 2020 2020 2066 6f72 2062 6568 6176         for behav
-00028300: 696f 725f 706f 6c69 6379 2069 6e20 7365  ior_policy in se
-00028310: 6c66 2e6d 756c 7469 706c 655f 6c6f 6767  lf.multiple_logg
-00028320: 6564 5f64 6174 6173 6574 3a0a 2020 2020  ed_dataset:.    
-00028330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028340: 2020 2020 7365 6c66 2e5f 7265 6769 7374      self._regist
-00028350: 6572 5f6c 6f67 6765 645f 6461 7461 7365  er_logged_datase
-00028360: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
-00028370: 2020 2020 2020 2020 2020 2020 2020 2062                 b
-00028380: 6568 6176 696f 725f 706f 6c69 6379 5f6e  ehavior_policy_n
-00028390: 616d 653d 6265 6861 7669 6f72 5f70 6f6c  ame=behavior_pol
-000283a0: 6963 792c 2064 6174 6173 6574 5f69 643d  icy, dataset_id=
-000283b0: 6461 7461 7365 745f 6964 0a20 2020 2020  dataset_id.     
-000283c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000283d0: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-000283e0: 2020 2020 2020 2020 2020 2020 2069 6e70               inp
-000283f0: 7574 5f64 6963 745f 203d 2069 6e70 7574  ut_dict_ = input
-00028400: 5f64 6963 742e 6765 7428 0a20 2020 2020  _dict.get(.     
-00028410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028420: 2020 2020 2020 2062 6568 6176 696f 725f         behavior_
-00028430: 706f 6c69 6379 5f6e 616d 653d 6265 6861  policy_name=beha
-00028440: 7669 6f72 5f70 6f6c 6963 792c 0a20 2020  vior_policy,.   
-00028450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028460: 2020 2020 2020 2020 2064 6174 6173 6574           dataset
-00028470: 5f69 643d 6461 7461 7365 745f 6964 2c0a  _id=dataset_id,.
-00028480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028490: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
-000284a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000284b0: 2020 2063 7661 725f 6469 6374 5f20 3d20     cvar_dict_ = 
-000284c0: 7365 6c66 2e5f 6573 7469 6d61 7465 5f63  self._estimate_c
-000284d0: 6f6e 6469 7469 6f6e 616c 5f76 616c 7565  onditional_value
-000284e0: 5f61 745f 7269 736b 280a 2020 2020 2020  _at_risk(.      
-000284f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028500: 2020 2020 2020 696e 7075 745f 6469 6374        input_dict
-00028510: 5f2c 0a20 2020 2020 2020 2020 2020 2020  _,.             
-00028520: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00028530: 6f6d 7061 7265 645f 6573 7469 6d61 746f  ompared_estimato
-00028540: 7273 3d63 6f6d 7061 7265 645f 6573 7469  rs=compared_esti
-00028550: 6d61 746f 7273 2c0a 2020 2020 2020 2020  mators,.        
-00028560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028570: 2020 2020 616c 7068 6173 3d61 6c70 6861      alphas=alpha
-00028580: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
-00028590: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-000285a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000285b0: 2020 2020 2063 7661 725f 6469 6374 5b62       cvar_dict[b
-000285c0: 6568 6176 696f 725f 706f 6c69 6379 5d20  ehavior_policy] 
-000285d0: 3d20 6376 6172 5f64 6963 745f 0a0a 2020  = cvar_dict_..  
-000285e0: 2020 2020 2020 2020 2020 2020 2020 656c                el
-000285f0: 6966 2062 6568 6176 696f 725f 706f 6c69  if behavior_poli
-00028600: 6379 5f6e 616d 6520 6973 206e 6f74 204e  cy_name is not N
-00028610: 6f6e 6520 616e 6420 6461 7461 7365 745f  one and dataset_
-00028620: 6964 2069 7320 4e6f 6e65 3a0a 2020 2020  id is None:.    
-00028630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028640: 6966 2028 0a20 2020 2020 2020 2020 2020  if (.           
-00028650: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00028660: 662e 6d75 6c74 6970 6c65 5f6c 6f67 6765  f.multiple_logge
-00028670: 645f 6461 7461 7365 742e 6e5f 6461 7461  d_dataset.n_data
-00028680: 7365 7473 5b62 6568 6176 696f 725f 706f  sets[behavior_po
-00028690: 6c69 6379 5f6e 616d 655d 0a20 2020 2020  licy_name].     
-000286a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000286b0: 2020 2021 3d20 696e 7075 745f 6469 6374     != input_dict
-000286c0: 2e6e 5f64 6174 6173 6574 735b 6265 6861  .n_datasets[beha
-000286d0: 7669 6f72 5f70 6f6c 6963 795f 6e61 6d65  vior_policy_name
-000286e0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-000286f0: 2020 2020 2020 293a 0a20 2020 2020 2020        ):.       
-00028700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028710: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-00028720: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
-00028730: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00028740: 4578 7065 6374 6564 2074 6861 7420 6c6f  Expected that lo
-00028750: 6767 6564 2064 6174 6173 6574 7320 616e  gged datasets an
-00028760: 6420 696e 7075 7420 6469 6374 7320 636f  d input dicts co
-00028770: 6e73 6973 7473 206f 6620 7468 6520 7361  nsists of the sa
-00028780: 6d65 2064 6174 6173 6574 2069 6473 2c20  me dataset ids, 
-00028790: 6275 7420 666f 756e 6420 4661 6c73 652e  but found False.
-000287a0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-000287b0: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
-000287c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000287d0: 2063 7661 725f 6469 6374 203d 205b 5d0a   cvar_dict = [].
-000287e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000287f0: 2020 2020 666f 7220 6461 7461 7365 745f      for dataset_
-00028800: 6964 5f20 696e 2072 616e 6765 280a 2020  id_ in range(.  
-00028810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028820: 2020 2020 2020 696e 7075 745f 6469 6374        input_dict
-00028830: 2e6e 5f64 6174 6173 6574 735b 6265 6861  .n_datasets[beha
-00028840: 7669 6f72 5f70 6f6c 6963 795f 6e61 6d65  vior_policy_name
-00028850: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-00028860: 2020 2020 2020 293a 0a20 2020 2020 2020        ):.       
-00028870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028880: 2073 656c 662e 5f72 6567 6973 7465 725f   self._register_
-00028890: 6c6f 6767 6564 5f64 6174 6173 6574 280a  logged_dataset(.
+00027ff0: 2063 7661 725f 6469 6374 203d 2064 6566   cvar_dict = def
+00028000: 6175 6c74 6469 6374 5f74 6f5f 6469 6374  aultdict_to_dict
+00028010: 2863 7661 725f 6469 6374 290a 0a20 2020  (cvar_dict)..   
+00028020: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
+00028030: 6620 6265 6861 7669 6f72 5f70 6f6c 6963  f behavior_polic
+00028040: 795f 6e61 6d65 2069 7320 4e6f 6e65 2061  y_name is None a
+00028050: 6e64 2064 6174 6173 6574 5f69 6420 6973  nd dataset_id is
+00028060: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
+00028070: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00028080: 6620 280a 2020 2020 2020 2020 2020 2020  f (.            
+00028090: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000280a0: 2e6d 756c 7469 706c 655f 6c6f 6767 6564  .multiple_logged
+000280b0: 5f64 6174 6173 6574 2e62 6568 6176 696f  _dataset.behavio
+000280c0: 725f 706f 6c69 6379 5f6e 616d 6573 0a20  r_policy_names. 
+000280d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000280e0: 2020 2020 2020 2021 3d20 696e 7075 745f         != input_
+000280f0: 6469 6374 2e62 6568 6176 696f 725f 706f  dict.behavior_po
+00028100: 6c69 6379 5f6e 616d 6573 0a20 2020 2020  licy_names.     
+00028110: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+00028120: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00028130: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00028140: 5661 6c75 6545 7272 6f72 280a 2020 2020  ValueError(.    
+00028150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028160: 2020 2020 2020 2020 2245 7870 6563 7465          "Expecte
+00028170: 6420 7468 6174 206c 6f67 6765 6420 6461  d that logged da
+00028180: 7461 7365 7473 2061 6e64 2069 6e70 7574  tasets and input
+00028190: 2064 6963 7473 2063 6f6e 7369 7374 7320   dicts consists 
+000281a0: 6f66 2074 6865 2073 616d 6520 6265 6861  of the same beha
+000281b0: 7669 6f72 2070 6f6c 6963 6965 732c 2062  vior policies, b
+000281c0: 7574 2066 6f75 6e64 2046 616c 7365 2e22  ut found False."
+000281d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000281e0: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
+000281f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028200: 6376 6172 5f64 6963 7420 3d20 7b7d 0a20  cvar_dict = {}. 
+00028210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028220: 2020 2066 6f72 2062 6568 6176 696f 725f     for behavior_
+00028230: 706f 6c69 6379 2069 6e20 7365 6c66 2e6d  policy in self.m
+00028240: 756c 7469 706c 655f 6c6f 6767 6564 5f64  ultiple_logged_d
+00028250: 6174 6173 6574 3a0a 2020 2020 2020 2020  ataset:.        
+00028260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028270: 7365 6c66 2e5f 7265 6769 7374 6572 5f6c  self._register_l
+00028280: 6f67 6765 645f 6461 7461 7365 7428 0a20  ogged_dataset(. 
+00028290: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000282a0: 2020 2020 2020 2020 2020 2062 6568 6176             behav
+000282b0: 696f 725f 706f 6c69 6379 5f6e 616d 653d  ior_policy_name=
+000282c0: 6265 6861 7669 6f72 5f70 6f6c 6963 792c  behavior_policy,
+000282d0: 2064 6174 6173 6574 5f69 643d 6461 7461   dataset_id=data
+000282e0: 7365 745f 6964 0a20 2020 2020 2020 2020  set_id.         
+000282f0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+00028300: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00028310: 2020 2020 2020 2020 2069 6e70 7574 5f64           input_d
+00028320: 6963 745f 203d 2069 6e70 7574 5f64 6963  ict_ = input_dic
+00028330: 742e 6765 7428 0a20 2020 2020 2020 2020  t.get(.         
+00028340: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028350: 2020 2062 6568 6176 696f 725f 706f 6c69     behavior_poli
+00028360: 6379 5f6e 616d 653d 6265 6861 7669 6f72  cy_name=behavior
+00028370: 5f70 6f6c 6963 792c 0a20 2020 2020 2020  _policy,.       
+00028380: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028390: 2020 2020 2064 6174 6173 6574 5f69 643d       dataset_id=
+000283a0: 6461 7461 7365 745f 6964 2c0a 2020 2020  dataset_id,.    
+000283b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000283c0: 2020 2020 290a 0a20 2020 2020 2020 2020      )..         
+000283d0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+000283e0: 7661 725f 6469 6374 5f20 3d20 7365 6c66  var_dict_ = self
+000283f0: 2e5f 6573 7469 6d61 7465 5f63 6f6e 6469  ._estimate_condi
+00028400: 7469 6f6e 616c 5f76 616c 7565 5f61 745f  tional_value_at_
+00028410: 7269 736b 280a 2020 2020 2020 2020 2020  risk(.          
+00028420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028430: 2020 696e 7075 745f 6469 6374 5f2c 0a20    input_dict_,. 
+00028440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028450: 2020 2020 2020 2020 2020 2063 6f6d 7061             compa
+00028460: 7265 645f 6573 7469 6d61 746f 7273 3d63  red_estimators=c
+00028470: 6f6d 7061 7265 645f 6573 7469 6d61 746f  ompared_estimato
+00028480: 7273 2c0a 2020 2020 2020 2020 2020 2020  rs,.            
+00028490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000284a0: 616c 7068 6173 3d61 6c70 6861 732c 0a20  alphas=alphas,. 
+000284b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000284c0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+000284d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000284e0: 2063 7661 725f 6469 6374 5b62 6568 6176   cvar_dict[behav
+000284f0: 696f 725f 706f 6c69 6379 5d20 3d20 6376  ior_policy] = cv
+00028500: 6172 5f64 6963 745f 0a0a 2020 2020 2020  ar_dict_..      
+00028510: 2020 2020 2020 2020 2020 656c 6966 2062            elif b
+00028520: 6568 6176 696f 725f 706f 6c69 6379 5f6e  ehavior_policy_n
+00028530: 616d 6520 6973 206e 6f74 204e 6f6e 6520  ame is not None 
+00028540: 616e 6420 6461 7461 7365 745f 6964 2069  and dataset_id i
+00028550: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
+00028560: 2020 2020 2020 2020 2020 2020 6966 2028              if (
+00028570: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00028580: 2020 2020 2020 2020 2073 656c 662e 6d75           self.mu
+00028590: 6c74 6970 6c65 5f6c 6f67 6765 645f 6461  ltiple_logged_da
+000285a0: 7461 7365 742e 6e5f 6461 7461 7365 7473  taset.n_datasets
+000285b0: 5b62 6568 6176 696f 725f 706f 6c69 6379  [behavior_policy
+000285c0: 5f6e 616d 655d 0a20 2020 2020 2020 2020  _name].         
+000285d0: 2020 2020 2020 2020 2020 2020 2020 2021                 !
+000285e0: 3d20 696e 7075 745f 6469 6374 2e6e 5f64  = input_dict.n_d
+000285f0: 6174 6173 6574 735b 6265 6861 7669 6f72  atasets[behavior
+00028600: 5f70 6f6c 6963 795f 6e61 6d65 5d0a 2020  _policy_name].  
+00028610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028620: 2020 293a 0a20 2020 2020 2020 2020 2020    ):.           
+00028630: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+00028640: 7365 2056 616c 7565 4572 726f 7228 0a20  se ValueError(. 
+00028650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028660: 2020 2020 2020 2020 2020 2022 4578 7065             "Expe
+00028670: 6374 6564 2074 6861 7420 6c6f 6767 6564  cted that logged
+00028680: 2064 6174 6173 6574 7320 616e 6420 696e   datasets and in
+00028690: 7075 7420 6469 6374 7320 636f 6e73 6973  put dicts consis
+000286a0: 7473 206f 6620 7468 6520 7361 6d65 2064  ts of the same d
+000286b0: 6174 6173 6574 2069 6473 2c20 6275 7420  ataset ids, but 
+000286c0: 666f 756e 6420 4661 6c73 652e 220a 2020  found False.".  
+000286d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000286e0: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+000286f0: 2020 2020 2020 2020 2020 2020 2063 7661               cva
+00028700: 725f 6469 6374 203d 205b 5d0a 2020 2020  r_dict = [].    
+00028710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028720: 666f 7220 6461 7461 7365 745f 6964 5f20  for dataset_id_ 
+00028730: 696e 2072 616e 6765 280a 2020 2020 2020  in range(.      
+00028740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028750: 2020 696e 7075 745f 6469 6374 2e6e 5f64    input_dict.n_d
+00028760: 6174 6173 6574 735b 6265 6861 7669 6f72  atasets[behavior
+00028770: 5f70 6f6c 6963 795f 6e61 6d65 5d0a 2020  _policy_name].  
+00028780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028790: 2020 293a 0a20 2020 2020 2020 2020 2020    ):.           
+000287a0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+000287b0: 662e 5f72 6567 6973 7465 725f 6c6f 6767  f._register_logg
+000287c0: 6564 5f64 6174 6173 6574 280a 2020 2020  ed_dataset(.    
+000287d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000287e0: 2020 2020 2020 2020 6265 6861 7669 6f72          behavior
+000287f0: 5f70 6f6c 6963 795f 6e61 6d65 3d62 6568  _policy_name=beh
+00028800: 6176 696f 725f 706f 6c69 6379 5f6e 616d  avior_policy_nam
+00028810: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+00028820: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+00028830: 6174 6173 6574 5f69 643d 6461 7461 7365  ataset_id=datase
+00028840: 745f 6964 5f2c 0a20 2020 2020 2020 2020  t_id_,.         
+00028850: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+00028860: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00028870: 2020 2020 2020 2020 2069 6e70 7574 5f64           input_d
+00028880: 6963 745f 203d 2069 6e70 7574 5f64 6963  ict_ = input_dic
+00028890: 742e 6765 7428 0a20 2020 2020 2020 2020  t.get(.         
 000288a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000288b0: 2020 2020 2020 2020 2020 2020 6265 6861              beha
-000288c0: 7669 6f72 5f70 6f6c 6963 795f 6e61 6d65  vior_policy_name
-000288d0: 3d62 6568 6176 696f 725f 706f 6c69 6379  =behavior_policy
-000288e0: 5f6e 616d 652c 0a20 2020 2020 2020 2020  _name,.         
-000288f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028900: 2020 2064 6174 6173 6574 5f69 643d 6461     dataset_id=da
-00028910: 7461 7365 745f 6964 5f2c 0a20 2020 2020  taset_id_,.     
-00028920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028930: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-00028940: 2020 2020 2020 2020 2020 2020 2069 6e70               inp
-00028950: 7574 5f64 6963 745f 203d 2069 6e70 7574  ut_dict_ = input
-00028960: 5f64 6963 742e 6765 7428 0a20 2020 2020  _dict.get(.     
-00028970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028980: 2020 2020 2020 2062 6568 6176 696f 725f         behavior_
-00028990: 706f 6c69 6379 5f6e 616d 653d 6265 6861  policy_name=beha
-000289a0: 7669 6f72 5f70 6f6c 6963 795f 6e61 6d65  vior_policy_name
-000289b0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000289c0: 2020 2020 2020 2020 2020 2020 2020 6461                da
-000289d0: 7461 7365 745f 6964 3d64 6174 6173 6574  taset_id=dataset
-000289e0: 5f69 645f 2c0a 2020 2020 2020 2020 2020  _id_,.          
-000289f0: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-00028a00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00028a10: 2020 2020 2020 2020 2063 7661 725f 6469           cvar_di
-00028a20: 6374 5f20 3d20 7365 6c66 2e5f 6573 7469  ct_ = self._esti
-00028a30: 6d61 7465 5f63 6f6e 6469 7469 6f6e 616c  mate_conditional
-00028a40: 5f76 616c 7565 5f61 745f 7269 736b 280a  _value_at_risk(.
-00028a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028a60: 2020 2020 2020 2020 2020 2020 696e 7075              inpu
-00028a70: 745f 6469 6374 5f2c 0a20 2020 2020 2020  t_dict_,.       
-00028a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028a90: 2020 2020 2063 6f6d 7061 7265 645f 6573       compared_es
-00028aa0: 7469 6d61 746f 7273 3d63 6f6d 7061 7265  timators=compare
-00028ab0: 645f 6573 7469 6d61 746f 7273 2c0a 2020  d_estimators,.  
-00028ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028ad0: 2020 2020 2020 2020 2020 616c 7068 6173            alphas
-00028ae0: 3d61 6c70 6861 732c 0a20 2020 2020 2020  =alphas,.       
-00028af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028b00: 2029 0a20 2020 2020 2020 2020 2020 2020   ).             
-00028b10: 2020 2020 2020 2020 2020 2063 7661 725f             cvar_
-00028b20: 6469 6374 2e61 7070 656e 6428 6376 6172  dict.append(cvar
-00028b30: 5f64 6963 745f 290a 0a20 2020 2020 2020  _dict_)..       
-00028b40: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+000288b0: 2020 2062 6568 6176 696f 725f 706f 6c69     behavior_poli
+000288c0: 6379 5f6e 616d 653d 6265 6861 7669 6f72  cy_name=behavior
+000288d0: 5f70 6f6c 6963 795f 6e61 6d65 2c0a 2020  _policy_name,.  
+000288e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000288f0: 2020 2020 2020 2020 2020 6461 7461 7365            datase
+00028900: 745f 6964 3d64 6174 6173 6574 5f69 645f  t_id=dataset_id_
+00028910: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00028920: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+00028930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028940: 2020 2020 2063 7661 725f 6469 6374 5f20       cvar_dict_ 
+00028950: 3d20 7365 6c66 2e5f 6573 7469 6d61 7465  = self._estimate
+00028960: 5f63 6f6e 6469 7469 6f6e 616c 5f76 616c  _conditional_val
+00028970: 7565 5f61 745f 7269 736b 280a 2020 2020  ue_at_risk(.    
+00028980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028990: 2020 2020 2020 2020 696e 7075 745f 6469          input_di
+000289a0: 6374 5f2c 0a20 2020 2020 2020 2020 2020  ct_,.           
+000289b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000289c0: 2063 6f6d 7061 7265 645f 6573 7469 6d61   compared_estima
+000289d0: 746f 7273 3d63 6f6d 7061 7265 645f 6573  tors=compared_es
+000289e0: 7469 6d61 746f 7273 2c0a 2020 2020 2020  timators,.      
+000289f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028a00: 2020 2020 2020 616c 7068 6173 3d61 6c70        alphas=alp
+00028a10: 6861 732c 0a20 2020 2020 2020 2020 2020  has,.           
+00028a20: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
+00028a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028a40: 2020 2020 2020 2063 7661 725f 6469 6374         cvar_dict
+00028a50: 2e61 7070 656e 6428 6376 6172 5f64 6963  .append(cvar_dic
+00028a60: 745f 290a 0a20 2020 2020 2020 2020 2020  t_)..           
+00028a70: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00028a80: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00028a90: 656c 662e 5f72 6567 6973 7465 725f 6c6f  elf._register_lo
+00028aa0: 6767 6564 5f64 6174 6173 6574 280a 2020  gged_dataset(.  
+00028ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028ac0: 2020 2020 2020 6265 6861 7669 6f72 5f70        behavior_p
+00028ad0: 6f6c 6963 795f 6e61 6d65 3d62 6568 6176  olicy_name=behav
+00028ae0: 696f 725f 706f 6c69 6379 5f6e 616d 652c  ior_policy_name,
+00028af0: 2064 6174 6173 6574 5f69 643d 6461 7461   dataset_id=data
+00028b00: 7365 745f 6964 0a20 2020 2020 2020 2020  set_id.         
+00028b10: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00028b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028b30: 2069 6e70 7574 5f64 6963 745f 203d 2069   input_dict_ = i
+00028b40: 6e70 7574 5f64 6963 742e 6765 7428 0a20  nput_dict.get(. 
 00028b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028b60: 2020 2073 656c 662e 5f72 6567 6973 7465     self._registe
-00028b70: 725f 6c6f 6767 6564 5f64 6174 6173 6574  r_logged_dataset
-00028b80: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00028b90: 2020 2020 2020 2020 2020 6265 6861 7669            behavi
-00028ba0: 6f72 5f70 6f6c 6963 795f 6e61 6d65 3d62  or_policy_name=b
-00028bb0: 6568 6176 696f 725f 706f 6c69 6379 5f6e  ehavior_policy_n
-00028bc0: 616d 652c 2064 6174 6173 6574 5f69 643d  ame, dataset_id=
-00028bd0: 6461 7461 7365 745f 6964 0a20 2020 2020  dataset_id.     
-00028be0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-00028bf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00028c00: 2020 2020 2069 6e70 7574 5f64 6963 745f       input_dict_
-00028c10: 203d 2069 6e70 7574 5f64 6963 742e 6765   = input_dict.ge
-00028c20: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
-00028c30: 2020 2020 2020 2020 2020 2062 6568 6176             behav
-00028c40: 696f 725f 706f 6c69 6379 5f6e 616d 653d  ior_policy_name=
-00028c50: 6265 6861 7669 6f72 5f70 6f6c 6963 795f  behavior_policy_
-00028c60: 6e61 6d65 2c20 6461 7461 7365 745f 6964  name, dataset_id
-00028c70: 3d64 6174 6173 6574 5f69 640a 2020 2020  =dataset_id.    
-00028c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028c90: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
-00028ca0: 2020 2020 2020 2063 7661 725f 6469 6374         cvar_dict
-00028cb0: 203d 2073 656c 662e 5f65 7374 696d 6174   = self._estimat
-00028cc0: 655f 636f 6e64 6974 696f 6e61 6c5f 7661  e_conditional_va
-00028cd0: 6c75 655f 6174 5f72 6973 6b28 0a20 2020  lue_at_risk(.   
-00028ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028cf0: 2020 2020 2069 6e70 7574 5f64 6963 745f       input_dict_
-00028d00: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00028d10: 2020 2020 2020 2020 2020 636f 6d70 6172            compar
-00028d20: 6564 5f65 7374 696d 6174 6f72 733d 636f  ed_estimators=co
-00028d30: 6d70 6172 6564 5f65 7374 696d 6174 6f72  mpared_estimator
-00028d40: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
-00028d50: 2020 2020 2020 2020 2020 2061 6c70 6861             alpha
-00028d60: 733d 616c 7068 6173 2c0a 2020 2020 2020  s=alphas,.      
-00028d70: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-00028d80: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
-00028d90: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00028da0: 2020 2062 6568 6176 696f 725f 706f 6c69     behavior_poli
-00028db0: 6379 5f6e 616d 6520 3d20 6c69 7374 2869  cy_name = list(i
-00028dc0: 6e70 7574 5f64 6963 742e 7661 6c75 6573  nput_dict.values
-00028dd0: 2829 295b 305d 5b22 6265 6861 7669 6f72  ())[0]["behavior
-00028de0: 5f70 6f6c 6963 7922 5d0a 2020 2020 2020  _policy"].      
-00028df0: 2020 2020 2020 2020 2020 6461 7461 7365            datase
-00028e00: 745f 6964 203d 206c 6973 7428 696e 7075  t_id = list(inpu
-00028e10: 745f 6469 6374 2e76 616c 7565 7328 2929  t_dict.values())
-00028e20: 5b30 5d5b 2264 6174 6173 6574 5f69 6422  [0]["dataset_id"
-00028e30: 5d0a 0a20 2020 2020 2020 2020 2020 2020  ]..             
-00028e40: 2020 2073 656c 662e 5f72 6567 6973 7465     self._registe
-00028e50: 725f 6c6f 6767 6564 5f64 6174 6173 6574  r_logged_dataset
-00028e60: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00028e70: 2020 2020 2020 6265 6861 7669 6f72 5f70        behavior_p
-00028e80: 6f6c 6963 795f 6e61 6d65 3d62 6568 6176  olicy_name=behav
-00028e90: 696f 725f 706f 6c69 6379 5f6e 616d 652c  ior_policy_name,
-00028ea0: 2064 6174 6173 6574 5f69 643d 6461 7461   dataset_id=data
-00028eb0: 7365 745f 6964 0a20 2020 2020 2020 2020  set_id.         
-00028ec0: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-00028ed0: 2020 2020 2020 2020 2020 6376 6172 5f64            cvar_d
-00028ee0: 6963 7420 3d20 7365 6c66 2e5f 6573 7469  ict = self._esti
-00028ef0: 6d61 7465 5f63 6f6e 6469 7469 6f6e 616c  mate_conditional
-00028f00: 5f76 616c 7565 5f61 745f 7269 736b 280a  _value_at_risk(.
-00028f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028f20: 2020 2020 696e 7075 745f 6469 6374 2c0a      input_dict,.
-00028f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028f40: 2020 2020 636f 6d70 6172 6564 5f65 7374      compared_est
-00028f50: 696d 6174 6f72 733d 636f 6d70 6172 6564  imators=compared
-00028f60: 5f65 7374 696d 6174 6f72 732c 0a20 2020  _estimators,.   
-00028f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028f80: 2061 6c70 6861 733d 616c 7068 6173 2c0a   alphas=alphas,.
-00028f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028fa0: 290a 0a20 2020 2020 2020 2065 6c73 653a  )..        else:
-00028fb0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00028fc0: 6973 696e 7374 616e 6365 2869 6e70 7574  isinstance(input
-00028fd0: 5f64 6963 742c 204d 756c 7469 706c 6549  _dict, MultipleI
-00028fe0: 6e70 7574 4469 6374 293a 0a20 2020 2020  nputDict):.     
-00028ff0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00029000: 2056 616c 7565 4572 726f 7228 0a20 2020   ValueError(.   
-00029010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029020: 2022 7768 656e 2075 7369 6e67 204c 6f67   "when using Log
-00029030: 6765 6444 6174 6173 6574 2c20 706c 6561  gedDataset, plea
-00029040: 7365 2075 7365 2049 6e70 7574 4469 6374  se use InputDict
-00029050: 2069 6e73 7465 6164 206f 6620 4d75 6c74   instead of Mult
-00029060: 6970 6c65 496e 7075 7444 6963 7422 0a20  ipleInputDict". 
-00029070: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-00029080: 0a0a 2020 2020 2020 2020 2020 2020 6376  ..            cv
-00029090: 6172 5f64 6963 7420 3d20 7365 6c66 2e5f  ar_dict = self._
-000290a0: 6573 7469 6d61 7465 5f63 6f6e 6469 7469  estimate_conditi
-000290b0: 6f6e 616c 5f76 616c 7565 5f61 745f 7269  onal_value_at_ri
-000290c0: 736b 280a 2020 2020 2020 2020 2020 2020  sk(.            
-000290d0: 2020 2020 696e 7075 745f 6469 6374 2c0a      input_dict,.
-000290e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000290f0: 636f 6d70 6172 6564 5f65 7374 696d 6174  compared_estimat
-00029100: 6f72 733d 636f 6d70 6172 6564 5f65 7374  ors=compared_est
-00029110: 696d 6174 6f72 732c 0a20 2020 2020 2020  imators,.       
-00029120: 2020 2020 2020 2020 2061 6c70 6861 733d           alphas=
-00029130: 616c 7068 6173 2c0a 2020 2020 2020 2020  alphas,.        
-00029140: 2020 2020 290a 0a20 2020 2020 2020 2072      )..        r
-00029150: 6574 7572 6e20 6376 6172 5f64 6963 740a  eturn cvar_dict.
-00029160: 0a20 2020 2064 6566 2065 7374 696d 6174  .    def estimat
-00029170: 655f 696e 7465 7271 7561 7274 696c 655f  e_interquartile_
-00029180: 7261 6e67 6528 0a20 2020 2020 2020 2073  range(.        s
-00029190: 656c 662c 0a20 2020 2020 2020 2069 6e70  elf,.        inp
-000291a0: 7574 5f64 6963 743a 2055 6e69 6f6e 5b4f  ut_dict: Union[O
-000291b0: 5045 496e 7075 7444 6963 742c 204d 756c  PEInputDict, Mul
-000291c0: 7469 706c 6549 6e70 7574 4469 6374 5d2c  tipleInputDict],
-000291d0: 0a20 2020 2020 2020 2063 6f6d 7061 7265  .        compare
-000291e0: 645f 6573 7469 6d61 746f 7273 3a20 4f70  d_estimators: Op
-000291f0: 7469 6f6e 616c 5b4c 6973 745b 7374 725d  tional[List[str]
-00029200: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
-00029210: 2020 6265 6861 7669 6f72 5f70 6f6c 6963    behavior_polic
-00029220: 795f 6e61 6d65 3a20 4f70 7469 6f6e 616c  y_name: Optional
-00029230: 5b73 7472 5d20 3d20 4e6f 6e65 2c0a 2020  [str] = None,.  
-00029240: 2020 2020 2020 6461 7461 7365 745f 6964        dataset_id
-00029250: 3a20 4f70 7469 6f6e 616c 5b69 6e74 5d20  : Optional[int] 
-00029260: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-00029270: 616c 7068 613a 2066 6c6f 6174 203d 2030  alpha: float = 0
-00029280: 2e30 352c 0a20 2020 2029 3a0a 2020 2020  .05,.    ):.    
-00029290: 2020 2020 2222 2245 7374 696d 6174 6520      """Estimate 
-000292a0: 7468 6520 696e 7465 7271 7561 7274 696c  the interquartil
-000292b0: 6520 7261 6e67 6520 6f66 2074 6865 2074  e range of the t
-000292c0: 7261 6a65 6374 6f72 792d 7769 7365 2072  rajectory-wise r
-000292d0: 6577 6172 6420 756e 6465 7220 7468 6520  eward under the 
-000292e0: 6769 7665 6e20 6576 616c 7561 7469 6f6e  given evaluation
-000292f0: 2070 6f6c 6963 6965 732e 0a0a 2020 2020   policies...    
-00029300: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
-00029310: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0a20         -------. 
-00029320: 2020 2020 2020 2069 6e70 7574 5f64 6963         input_dic
-00029330: 743a 204f 5045 496e 7075 7444 6963 7420  t: OPEInputDict 
-00029340: 6f72 204d 756c 7469 706c 6549 6e70 7574  or MultipleInput
-00029350: 4469 6374 0a20 2020 2020 2020 2020 2020  Dict.           
-00029360: 2044 6963 7469 6f6e 6172 7920 6f66 2074   Dictionary of t
-00029370: 6865 204f 5045 2069 6e70 7574 7320 666f  he OPE inputs fo
-00029380: 7220 6561 6368 2065 7661 6c75 6174 696f  r each evaluatio
-00029390: 6e20 706f 6c69 6379 2e0a 0a20 2020 2020  n policy...     
-000293a0: 2020 2020 2020 202e 2e20 636f 6465 2d62         .. code-b
-000293b0: 6c6f 636b 3a3a 2070 7974 686f 6e0a 0a20  lock:: python.. 
-000293c0: 2020 2020 2020 2020 2020 2020 2020 206b                 k
-000293d0: 6579 3a20 5b65 7661 6c75 6174 696f 6e5f  ey: [evaluation_
-000293e0: 706f 6c69 6379 5d5b 0a20 2020 2020 2020  policy][.       
-000293f0: 2020 2020 2020 2020 2020 2020 2065 7661               eva
-00029400: 6c75 6174 696f 6e5f 706f 6c69 6379 5f61  luation_policy_a
-00029410: 6374 696f 6e2c 0a20 2020 2020 2020 2020  ction,.         
-00029420: 2020 2020 2020 2020 2020 2065 7661 6c75             evalu
-00029430: 6174 696f 6e5f 706f 6c69 6379 5f61 6374  ation_policy_act
-00029440: 696f 6e5f 6469 7374 2c0a 2020 2020 2020  ion_dist,.      
-00029450: 2020 2020 2020 2020 2020 2020 2020 7374                st
-00029460: 6174 655f 6163 7469 6f6e 5f76 616c 7565  ate_action_value
-00029470: 5f70 7265 6469 6374 696f 6e2c 0a20 2020  _prediction,.   
+00028b60: 2020 2020 2020 2062 6568 6176 696f 725f         behavior_
+00028b70: 706f 6c69 6379 5f6e 616d 653d 6265 6861  policy_name=beha
+00028b80: 7669 6f72 5f70 6f6c 6963 795f 6e61 6d65  vior_policy_name
+00028b90: 2c20 6461 7461 7365 745f 6964 3d64 6174  , dataset_id=dat
+00028ba0: 6173 6574 5f69 640a 2020 2020 2020 2020  aset_id.        
+00028bb0: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+00028bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028bd0: 2020 2063 7661 725f 6469 6374 203d 2073     cvar_dict = s
+00028be0: 656c 662e 5f65 7374 696d 6174 655f 636f  elf._estimate_co
+00028bf0: 6e64 6974 696f 6e61 6c5f 7661 6c75 655f  nditional_value_
+00028c00: 6174 5f72 6973 6b28 0a20 2020 2020 2020  at_risk(.       
+00028c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028c20: 2069 6e70 7574 5f64 6963 745f 2c0a 2020   input_dict_,.  
+00028c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028c40: 2020 2020 2020 636f 6d70 6172 6564 5f65        compared_e
+00028c50: 7374 696d 6174 6f72 733d 636f 6d70 6172  stimators=compar
+00028c60: 6564 5f65 7374 696d 6174 6f72 732c 0a20  ed_estimators,. 
+00028c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028c80: 2020 2020 2020 2061 6c70 6861 733d 616c         alphas=al
+00028c90: 7068 6173 2c0a 2020 2020 2020 2020 2020  phas,.          
+00028ca0: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+00028cb0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+00028cc0: 2020 2020 2020 2020 2020 2020 2020 2062                 b
+00028cd0: 6568 6176 696f 725f 706f 6c69 6379 5f6e  ehavior_policy_n
+00028ce0: 616d 6520 3d20 6c69 7374 2869 6e70 7574  ame = list(input
+00028cf0: 5f64 6963 742e 7661 6c75 6573 2829 295b  _dict.values())[
+00028d00: 305d 5b22 6265 6861 7669 6f72 5f70 6f6c  0]["behavior_pol
+00028d10: 6963 7922 5d0a 2020 2020 2020 2020 2020  icy"].          
+00028d20: 2020 2020 2020 6461 7461 7365 745f 6964        dataset_id
+00028d30: 203d 206c 6973 7428 696e 7075 745f 6469   = list(input_di
+00028d40: 6374 2e76 616c 7565 7328 2929 5b30 5d5b  ct.values())[0][
+00028d50: 2264 6174 6173 6574 5f69 6422 5d0a 0a20  "dataset_id"].. 
+00028d60: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00028d70: 656c 662e 5f72 6567 6973 7465 725f 6c6f  elf._register_lo
+00028d80: 6767 6564 5f64 6174 6173 6574 280a 2020  gged_dataset(.  
+00028d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028da0: 2020 6265 6861 7669 6f72 5f70 6f6c 6963    behavior_polic
+00028db0: 795f 6e61 6d65 3d62 6568 6176 696f 725f  y_name=behavior_
+00028dc0: 706f 6c69 6379 5f6e 616d 652c 2064 6174  policy_name, dat
+00028dd0: 6173 6574 5f69 643d 6461 7461 7365 745f  aset_id=dataset_
+00028de0: 6964 0a20 2020 2020 2020 2020 2020 2020  id.             
+00028df0: 2020 2029 0a0a 2020 2020 2020 2020 2020     )..          
+00028e00: 2020 2020 2020 6376 6172 5f64 6963 7420        cvar_dict 
+00028e10: 3d20 7365 6c66 2e5f 6573 7469 6d61 7465  = self._estimate
+00028e20: 5f63 6f6e 6469 7469 6f6e 616c 5f76 616c  _conditional_val
+00028e30: 7565 5f61 745f 7269 736b 280a 2020 2020  ue_at_risk(.    
+00028e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028e50: 696e 7075 745f 6469 6374 2c0a 2020 2020  input_dict,.    
+00028e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028e70: 636f 6d70 6172 6564 5f65 7374 696d 6174  compared_estimat
+00028e80: 6f72 733d 636f 6d70 6172 6564 5f65 7374  ors=compared_est
+00028e90: 696d 6174 6f72 732c 0a20 2020 2020 2020  imators,.       
+00028ea0: 2020 2020 2020 2020 2020 2020 2061 6c70               alp
+00028eb0: 6861 733d 616c 7068 6173 2c0a 2020 2020  has=alphas,.    
+00028ec0: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+00028ed0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00028ee0: 2020 2020 2020 2020 2069 6620 6973 696e           if isin
+00028ef0: 7374 616e 6365 2869 6e70 7574 5f64 6963  stance(input_dic
+00028f00: 742c 204d 756c 7469 706c 6549 6e70 7574  t, MultipleInput
+00028f10: 4469 6374 293a 0a20 2020 2020 2020 2020  Dict):.         
+00028f20: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+00028f30: 7565 4572 726f 7228 0a20 2020 2020 2020  ueError(.       
+00028f40: 2020 2020 2020 2020 2020 2020 2022 7768               "wh
+00028f50: 656e 2075 7369 6e67 204c 6f67 6765 6444  en using LoggedD
+00028f60: 6174 6173 6574 2c20 706c 6561 7365 2075  ataset, please u
+00028f70: 7365 2049 6e70 7574 4469 6374 2069 6e73  se InputDict ins
+00028f80: 7465 6164 206f 6620 4d75 6c74 6970 6c65  tead of Multiple
+00028f90: 496e 7075 7444 6963 7422 0a20 2020 2020  InputDict".     
+00028fa0: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
+00028fb0: 2020 2020 2020 2020 2020 6376 6172 5f64            cvar_d
+00028fc0: 6963 7420 3d20 7365 6c66 2e5f 6573 7469  ict = self._esti
+00028fd0: 6d61 7465 5f63 6f6e 6469 7469 6f6e 616c  mate_conditional
+00028fe0: 5f76 616c 7565 5f61 745f 7269 736b 280a  _value_at_risk(.
+00028ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029000: 696e 7075 745f 6469 6374 2c0a 2020 2020  input_dict,.    
+00029010: 2020 2020 2020 2020 2020 2020 636f 6d70              comp
+00029020: 6172 6564 5f65 7374 696d 6174 6f72 733d  ared_estimators=
+00029030: 636f 6d70 6172 6564 5f65 7374 696d 6174  compared_estimat
+00029040: 6f72 732c 0a20 2020 2020 2020 2020 2020  ors,.           
+00029050: 2020 2020 2061 6c70 6861 733d 616c 7068       alphas=alph
+00029060: 6173 2c0a 2020 2020 2020 2020 2020 2020  as,.            
+00029070: 290a 0a20 2020 2020 2020 2072 6574 7572  )..        retur
+00029080: 6e20 6376 6172 5f64 6963 740a 0a20 2020  n cvar_dict..   
+00029090: 2064 6566 2065 7374 696d 6174 655f 696e   def estimate_in
+000290a0: 7465 7271 7561 7274 696c 655f 7261 6e67  terquartile_rang
+000290b0: 6528 0a20 2020 2020 2020 2073 656c 662c  e(.        self,
+000290c0: 0a20 2020 2020 2020 2069 6e70 7574 5f64  .        input_d
+000290d0: 6963 743a 2055 6e69 6f6e 5b4f 5045 496e  ict: Union[OPEIn
+000290e0: 7075 7444 6963 742c 204d 756c 7469 706c  putDict, Multipl
+000290f0: 6549 6e70 7574 4469 6374 5d2c 0a20 2020  eInputDict],.   
+00029100: 2020 2020 2063 6f6d 7061 7265 645f 6573       compared_es
+00029110: 7469 6d61 746f 7273 3a20 4f70 7469 6f6e  timators: Option
+00029120: 616c 5b4c 6973 745b 7374 725d 5d20 3d20  al[List[str]] = 
+00029130: 4e6f 6e65 2c0a 2020 2020 2020 2020 6265  None,.        be
+00029140: 6861 7669 6f72 5f70 6f6c 6963 795f 6e61  havior_policy_na
+00029150: 6d65 3a20 4f70 7469 6f6e 616c 5b73 7472  me: Optional[str
+00029160: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
+00029170: 2020 6461 7461 7365 745f 6964 3a20 4f70    dataset_id: Op
+00029180: 7469 6f6e 616c 5b69 6e74 5d20 3d20 4e6f  tional[int] = No
+00029190: 6e65 2c0a 2020 2020 2020 2020 616c 7068  ne,.        alph
+000291a0: 613a 2066 6c6f 6174 203d 2030 2e30 352c  a: float = 0.05,
+000291b0: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
+000291c0: 2222 2245 7374 696d 6174 6520 7468 6520  """Estimate the 
+000291d0: 696e 7465 7271 7561 7274 696c 6520 7261  interquartile ra
+000291e0: 6e67 6520 6f66 2074 6865 2074 7261 6a65  nge of the traje
+000291f0: 6374 6f72 792d 7769 7365 2072 6577 6172  ctory-wise rewar
+00029200: 6420 756e 6465 7220 7468 6520 6769 7665  d under the give
+00029210: 6e20 6576 616c 7561 7469 6f6e 2070 6f6c  n evaluation pol
+00029220: 6963 6965 732e 0a0a 2020 2020 2020 2020  icies...        
+00029230: 5061 7261 6d65 7465 7273 0a20 2020 2020  Parameters.     
+00029240: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 2020     -------.     
+00029250: 2020 2069 6e70 7574 5f64 6963 743a 204f     input_dict: O
+00029260: 5045 496e 7075 7444 6963 7420 6f72 204d  PEInputDict or M
+00029270: 756c 7469 706c 6549 6e70 7574 4469 6374  ultipleInputDict
+00029280: 0a20 2020 2020 2020 2020 2020 2044 6963  .            Dic
+00029290: 7469 6f6e 6172 7920 6f66 2074 6865 204f  tionary of the O
+000292a0: 5045 2069 6e70 7574 7320 666f 7220 6561  PE inputs for ea
+000292b0: 6368 2065 7661 6c75 6174 696f 6e20 706f  ch evaluation po
+000292c0: 6c69 6379 2e0a 0a20 2020 2020 2020 2020  licy...         
+000292d0: 2020 202e 2e20 636f 6465 2d62 6c6f 636b     .. code-block
+000292e0: 3a3a 2070 7974 686f 6e0a 0a20 2020 2020  :: python..     
+000292f0: 2020 2020 2020 2020 2020 206b 6579 3a20             key: 
+00029300: 5b65 7661 6c75 6174 696f 6e5f 706f 6c69  [evaluation_poli
+00029310: 6379 5d5b 0a20 2020 2020 2020 2020 2020  cy][.           
+00029320: 2020 2020 2020 2020 2065 7661 6c75 6174           evaluat
+00029330: 696f 6e5f 706f 6c69 6379 5f61 6374 696f  ion_policy_actio
+00029340: 6e2c 0a20 2020 2020 2020 2020 2020 2020  n,.             
+00029350: 2020 2020 2020 2065 7661 6c75 6174 696f         evaluatio
+00029360: 6e5f 706f 6c69 6379 5f61 6374 696f 6e5f  n_policy_action_
+00029370: 6469 7374 2c0a 2020 2020 2020 2020 2020  dist,.          
+00029380: 2020 2020 2020 2020 2020 7374 6174 655f            state_
+00029390: 6163 7469 6f6e 5f76 616c 7565 5f70 7265  action_value_pre
+000293a0: 6469 6374 696f 6e2c 0a20 2020 2020 2020  diction,.       
+000293b0: 2020 2020 2020 2020 2020 2020 2069 6e69               ini
+000293c0: 7469 616c 5f73 7461 7465 5f76 616c 7565  tial_state_value
+000293d0: 5f70 7265 6469 6374 696f 6e2c 0a20 2020  _prediction,.   
+000293e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000293f0: 2073 7461 7465 5f61 6374 696f 6e5f 6d61   state_action_ma
+00029400: 7267 696e 616c 5f69 6d70 6f72 7461 6e63  rginal_importanc
+00029410: 655f 7765 6967 6874 2c0a 2020 2020 2020  e_weight,.      
+00029420: 2020 2020 2020 2020 2020 2020 2020 7374                st
+00029430: 6174 655f 6d61 7267 696e 616c 5f69 6d70  ate_marginal_imp
+00029440: 6f72 7461 6e63 655f 7765 6967 6874 2c0a  ortance_weight,.
+00029450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029460: 2020 2020 6f6e 5f70 6f6c 6963 795f 706f      on_policy_po
+00029470: 6c69 6379 5f76 616c 7565 2c0a 2020 2020  licy_value,.    
 00029480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029490: 2069 6e69 7469 616c 5f73 7461 7465 5f76   initial_state_v
-000294a0: 616c 7565 5f70 7265 6469 6374 696f 6e2c  alue_prediction,
-000294b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000294c0: 2020 2020 2073 7461 7465 5f61 6374 696f       state_actio
-000294d0: 6e5f 6d61 7267 696e 616c 5f69 6d70 6f72  n_marginal_impor
-000294e0: 7461 6e63 655f 7765 6967 6874 2c0a 2020  tance_weight,.  
-000294f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029500: 2020 7374 6174 655f 6d61 7267 696e 616c    state_marginal
-00029510: 5f69 6d70 6f72 7461 6e63 655f 7765 6967  _importance_weig
-00029520: 6874 2c0a 2020 2020 2020 2020 2020 2020  ht,.            
-00029530: 2020 2020 2020 2020 6f6e 5f70 6f6c 6963          on_polic
-00029540: 795f 706f 6c69 6379 5f76 616c 7565 2c0a  y_policy_value,.
-00029550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029560: 2020 2020 6761 6d6d 612c 0a20 2020 2020      gamma,.     
-00029570: 2020 2020 2020 2020 2020 2020 2020 2062                 b
-00029580: 6568 6176 696f 725f 706f 6c69 6379 2c0a  ehavior_policy,.
-00029590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000295a0: 2020 2020 6576 616c 7561 7469 6f6e 5f70      evaluation_p
-000295b0: 6f6c 6963 792c 0a20 2020 2020 2020 2020  olicy,.         
-000295c0: 2020 2020 2020 2020 2020 2064 6174 6173             datas
-000295d0: 6574 5f69 642c 0a20 2020 2020 2020 2020  et_id,.         
-000295e0: 2020 2020 2020 205d 0a0a 2020 2020 2020         ]..      
-000295f0: 2020 2020 2020 2e2e 2073 6565 616c 736f        .. seealso
-00029600: 3a3a 0a0a 2020 2020 2020 2020 2020 2020  ::..            
-00029610: 2020 2020 3a63 6c61 7373 3a60 7363 6f70      :class:`scop
-00029620: 655f 726c 2e6f 7065 2e69 6e70 7574 2e43  e_rl.ope.input.C
-00029630: 7265 6174 654f 5045 496e 7075 7460 2064  reateOPEInput` d
-00029640: 6573 6372 6962 6573 2074 6865 2063 6f6d  escribes the com
-00029650: 706f 6e65 6e74 7320 6f66 203a 636c 6173  ponents of :clas
-00029660: 733a 6069 6e70 7574 5f64 6963 7460 2e0a  s:`input_dict`..
-00029670: 0a20 2020 2020 2020 2063 6f6d 7061 7265  .        compare
-00029680: 645f 6573 7469 6d61 746f 7273 3a20 6c69  d_estimators: li
-00029690: 7374 206f 6620 7374 722c 2064 6566 6175  st of str, defau
-000296a0: 6c74 3d4e 6f6e 650a 2020 2020 2020 2020  lt=None.        
-000296b0: 2020 2020 4e61 6d65 206f 6620 636f 6d70      Name of comp
-000296c0: 6172 6564 2065 7374 696d 6174 6f72 732e  ared estimators.
-000296d0: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
-000296e0: 604e 6f6e 6560 2069 7320 6769 7665 6e2c  `None` is given,
-000296f0: 2061 6c6c 2074 6865 2065 7374 696d 6174   all the estimat
-00029700: 6f72 7320 6172 6520 636f 6d70 6172 6564  ors are compared
-00029710: 2e0a 0a20 2020 2020 2020 2062 6568 6176  ...        behav
-00029720: 696f 725f 706f 6c69 6379 5f6e 616d 653a  ior_policy_name:
-00029730: 2073 7472 2c20 6465 6661 756c 743d 4e6f   str, default=No
-00029740: 6e65 0a20 2020 2020 2020 2020 2020 204e  ne.            N
-00029750: 616d 6520 6f66 2074 6865 2062 6568 6176  ame of the behav
-00029760: 696f 7220 706f 6c69 6379 2e0a 0a20 2020  ior policy...   
-00029770: 2020 2020 2064 6174 6173 6574 5f69 643a       dataset_id:
-00029780: 2069 6e74 2c20 6465 6661 756c 743d 4e6f   int, default=No
-00029790: 6e65 0a20 2020 2020 2020 2020 2020 2049  ne.            I
-000297a0: 6420 6f66 2074 6865 206c 6f67 6765 6420  d of the logged 
-000297b0: 6461 7461 7365 742e 0a0a 2020 2020 2020  dataset...      
-000297c0: 2020 616c 7068 613a 2066 6c6f 6174 2c20    alpha: float, 
-000297d0: 6465 6661 756c 743d 302e 3035 0a20 2020  default=0.05.   
-000297e0: 2020 2020 2020 2020 2050 726f 706f 7274           Proport
-000297f0: 696f 6e20 6f66 2074 6865 2073 6861 6465  ion of the shade
-00029800: 6420 7265 6769 6f6e 2e20 5468 6520 7661  d region. The va
-00029810: 6c75 6520 7368 6f75 6c64 2062 6520 7769  lue should be wi
-00029820: 7468 696e 2028 302c 2031 5d2e 0a0a 2020  thin (0, 1]...  
-00029830: 2020 2020 2020 5265 7475 726e 0a20 2020        Return.   
-00029840: 2020 2020 202d 2d2d 2d2d 2d2d 0a20 2020       -------.   
-00029850: 2020 2020 2069 6e74 6572 7175 6172 7469       interquarti
-00029860: 6c65 5f72 616e 6765 5f64 6963 743a 2064  le_range_dict: d
-00029870: 6963 7420 282c 206c 6973 7420 6f66 2064  ict (, list of d
-00029880: 6963 7429 0a20 2020 2020 2020 2020 2020  ict).           
-00029890: 2044 6963 7469 6f6e 6172 7920 636f 6e74   Dictionary cont
-000298a0: 6169 6e69 6e67 2074 6865 2069 6e74 6572  aining the inter
-000298b0: 7175 6172 7469 6c65 2072 616e 6765 206f  quartile range o
-000298c0: 6620 7472 616a 6563 746f 7279 2d77 6973  f trajectory-wis
-000298d0: 6520 7265 7761 7264 206f 6620 6561 6368  e reward of each
-000298e0: 2065 7661 6c75 6174 696f 6e20 706f 6c69   evaluation poli
-000298f0: 6379 2065 7374 696d 6174 6564 2062 7920  cy estimated by 
-00029900: 4f50 4520 6573 7469 6d61 746f 7273 2e0a  OPE estimators..
-00029910: 2020 2020 2020 2020 2020 2020 6b65 793a              key:
-00029920: 203a 636c 6173 733a 605b 6576 616c 7561   :class:`[evalua
-00029930: 7469 6f6e 5f70 6f6c 6963 795d 5b4f 5045  tion_policy][OPE
-00029940: 5f65 7374 696d 6174 6f72 5f6e 616d 655d  _estimator_name]
-00029950: 5b71 7561 7274 696c 655f 6e61 6d65 5d60  [quartile_name]`
-00029960: 0a0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-00029970: 2020 2020 2020 636f 6d70 6172 6564 5f65        compared_e
-00029980: 7374 696d 6174 6f72 7320 3d20 7365 6c66  stimators = self
-00029990: 2e5f 6368 6563 6b5f 636f 6d70 6172 6564  ._check_compared
-000299a0: 5f65 7374 696d 6174 6f72 7328 636f 6d70  _estimators(comp
-000299b0: 6172 6564 5f65 7374 696d 6174 6f72 7329  ared_estimators)
-000299c0: 0a20 2020 2020 2020 2063 6865 636b 5f73  .        check_s
-000299d0: 6361 6c61 7228 616c 7068 612c 206e 616d  calar(alpha, nam
-000299e0: 653d 2261 6c70 6861 222c 2074 6172 6765  e="alpha", targe
-000299f0: 745f 7479 7065 3d66 6c6f 6174 2c20 6d69  t_type=float, mi
-00029a00: 6e5f 7661 6c3d 302e 302c 206d 6178 5f76  n_val=0.0, max_v
-00029a10: 616c 3d30 2e35 290a 0a20 2020 2020 2020  al=0.5)..       
-00029a20: 2069 6620 7365 6c66 2e75 7365 5f6d 756c   if self.use_mul
-00029a30: 7469 706c 655f 6c6f 6767 6564 5f64 6174  tiple_logged_dat
-00029a40: 6173 6574 3a0a 2020 2020 2020 2020 2020  aset:.          
-00029a50: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-00029a60: 696e 7075 745f 6469 6374 2c20 4d75 6c74  input_dict, Mult
-00029a70: 6970 6c65 496e 7075 7444 6963 7429 3a0a  ipleInputDict):.
+00029490: 6761 6d6d 612c 0a20 2020 2020 2020 2020  gamma,.         
+000294a0: 2020 2020 2020 2020 2020 2062 6568 6176             behav
+000294b0: 696f 725f 706f 6c69 6379 2c0a 2020 2020  ior_policy,.    
+000294c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000294d0: 6576 616c 7561 7469 6f6e 5f70 6f6c 6963  evaluation_polic
+000294e0: 792c 0a20 2020 2020 2020 2020 2020 2020  y,.             
+000294f0: 2020 2020 2020 2064 6174 6173 6574 5f69         dataset_i
+00029500: 642c 0a20 2020 2020 2020 2020 2020 2020  d,.             
+00029510: 2020 205d 0a0a 2020 2020 2020 2020 2020     ]..          
+00029520: 2020 2e2e 2073 6565 616c 736f 3a3a 0a0a    .. seealso::..
+00029530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029540: 3a63 6c61 7373 3a60 7363 6f70 655f 726c  :class:`scope_rl
+00029550: 2e6f 7065 2e69 6e70 7574 2e43 7265 6174  .ope.input.Creat
+00029560: 654f 5045 496e 7075 7460 2064 6573 6372  eOPEInput` descr
+00029570: 6962 6573 2074 6865 2063 6f6d 706f 6e65  ibes the compone
+00029580: 6e74 7320 6f66 203a 636c 6173 733a 6069  nts of :class:`i
+00029590: 6e70 7574 5f64 6963 7460 2e0a 0a20 2020  nput_dict`...   
+000295a0: 2020 2020 2063 6f6d 7061 7265 645f 6573       compared_es
+000295b0: 7469 6d61 746f 7273 3a20 6c69 7374 206f  timators: list o
+000295c0: 6620 7374 722c 2064 6566 6175 6c74 3d4e  f str, default=N
+000295d0: 6f6e 650a 2020 2020 2020 2020 2020 2020  one.            
+000295e0: 4e61 6d65 206f 6620 636f 6d70 6172 6564  Name of compared
+000295f0: 2065 7374 696d 6174 6f72 732e 0a20 2020   estimators..   
+00029600: 2020 2020 2020 2020 2049 6620 604e 6f6e           If `Non
+00029610: 6560 2069 7320 6769 7665 6e2c 2061 6c6c  e` is given, all
+00029620: 2074 6865 2065 7374 696d 6174 6f72 7320   the estimators 
+00029630: 6172 6520 636f 6d70 6172 6564 2e0a 0a20  are compared... 
+00029640: 2020 2020 2020 2062 6568 6176 696f 725f         behavior_
+00029650: 706f 6c69 6379 5f6e 616d 653a 2073 7472  policy_name: str
+00029660: 2c20 6465 6661 756c 743d 4e6f 6e65 0a20  , default=None. 
+00029670: 2020 2020 2020 2020 2020 204e 616d 6520             Name 
+00029680: 6f66 2074 6865 2062 6568 6176 696f 7220  of the behavior 
+00029690: 706f 6c69 6379 2e0a 0a20 2020 2020 2020  policy...       
+000296a0: 2064 6174 6173 6574 5f69 643a 2069 6e74   dataset_id: int
+000296b0: 2c20 6465 6661 756c 743d 4e6f 6e65 0a20  , default=None. 
+000296c0: 2020 2020 2020 2020 2020 2049 6420 6f66             Id of
+000296d0: 2074 6865 206c 6f67 6765 6420 6461 7461   the logged data
+000296e0: 7365 742e 0a0a 2020 2020 2020 2020 616c  set...        al
+000296f0: 7068 613a 2066 6c6f 6174 2c20 6465 6661  pha: float, defa
+00029700: 756c 743d 302e 3035 0a20 2020 2020 2020  ult=0.05.       
+00029710: 2020 2020 2050 726f 706f 7274 696f 6e20       Proportion 
+00029720: 6f66 2074 6865 2073 6861 6465 6420 7265  of the shaded re
+00029730: 6769 6f6e 2e20 5468 6520 7661 6c75 6520  gion. The value 
+00029740: 7368 6f75 6c64 2062 6520 7769 7468 696e  should be within
+00029750: 2028 302c 2031 5d2e 0a0a 2020 2020 2020   (0, 1]...      
+00029760: 2020 5265 7475 726e 0a20 2020 2020 2020    Return.       
+00029770: 202d 2d2d 2d2d 2d2d 0a20 2020 2020 2020   -------.       
+00029780: 2069 6e74 6572 7175 6172 7469 6c65 5f72   interquartile_r
+00029790: 616e 6765 5f64 6963 743a 2064 6963 7420  ange_dict: dict 
+000297a0: 282c 206c 6973 7420 6f66 2064 6963 7429  (, list of dict)
+000297b0: 0a20 2020 2020 2020 2020 2020 2044 6963  .            Dic
+000297c0: 7469 6f6e 6172 7920 636f 6e74 6169 6e69  tionary containi
+000297d0: 6e67 2074 6865 2069 6e74 6572 7175 6172  ng the interquar
+000297e0: 7469 6c65 2072 616e 6765 206f 6620 7472  tile range of tr
+000297f0: 616a 6563 746f 7279 2d77 6973 6520 7265  ajectory-wise re
+00029800: 7761 7264 206f 6620 6561 6368 2065 7661  ward of each eva
+00029810: 6c75 6174 696f 6e20 706f 6c69 6379 2065  luation policy e
+00029820: 7374 696d 6174 6564 2062 7920 4f50 4520  stimated by OPE 
+00029830: 6573 7469 6d61 746f 7273 2e0a 2020 2020  estimators..    
+00029840: 2020 2020 2020 2020 6b65 793a 203a 636c          key: :cl
+00029850: 6173 733a 605b 6576 616c 7561 7469 6f6e  ass:`[evaluation
+00029860: 5f70 6f6c 6963 795d 5b4f 5045 5f65 7374  _policy][OPE_est
+00029870: 696d 6174 6f72 5f6e 616d 655d 5b71 7561  imator_name][qua
+00029880: 7274 696c 655f 6e61 6d65 5d60 0a0a 2020  rtile_name]`..  
+00029890: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+000298a0: 2020 636f 6d70 6172 6564 5f65 7374 696d    compared_estim
+000298b0: 6174 6f72 7320 3d20 7365 6c66 2e5f 6368  ators = self._ch
+000298c0: 6563 6b5f 636f 6d70 6172 6564 5f65 7374  eck_compared_est
+000298d0: 696d 6174 6f72 7328 636f 6d70 6172 6564  imators(compared
+000298e0: 5f65 7374 696d 6174 6f72 7329 0a20 2020  _estimators).   
+000298f0: 2020 2020 2063 6865 636b 5f73 6361 6c61       check_scala
+00029900: 7228 616c 7068 612c 206e 616d 653d 2261  r(alpha, name="a
+00029910: 6c70 6861 222c 2074 6172 6765 745f 7479  lpha", target_ty
+00029920: 7065 3d66 6c6f 6174 2c20 6d69 6e5f 7661  pe=float, min_va
+00029930: 6c3d 302e 302c 206d 6178 5f76 616c 3d30  l=0.0, max_val=0
+00029940: 2e35 290a 0a20 2020 2020 2020 2069 6620  .5)..        if 
+00029950: 7365 6c66 2e75 7365 5f6d 756c 7469 706c  self.use_multipl
+00029960: 655f 6c6f 6767 6564 5f64 6174 6173 6574  e_logged_dataset
+00029970: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+00029980: 2069 7369 6e73 7461 6e63 6528 696e 7075   isinstance(inpu
+00029990: 745f 6469 6374 2c20 4d75 6c74 6970 6c65  t_dict, Multiple
+000299a0: 496e 7075 7444 6963 7429 3a0a 2020 2020  InputDict):.    
+000299b0: 2020 2020 2020 2020 2020 2020 6966 2062              if b
+000299c0: 6568 6176 696f 725f 706f 6c69 6379 5f6e  ehavior_policy_n
+000299d0: 616d 6520 6973 204e 6f6e 6520 616e 6420  ame is None and 
+000299e0: 6461 7461 7365 745f 6964 2069 7320 4e6f  dataset_id is No
+000299f0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+00029a00: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+00029a10: 6d75 6c74 6970 6c65 5f6c 6f67 6765 645f  multiple_logged_
+00029a20: 6461 7461 7365 742e 6e5f 6461 7461 7365  dataset.n_datase
+00029a30: 7473 2021 3d20 696e 7075 745f 6469 6374  ts != input_dict
+00029a40: 2e6e 5f64 6174 6173 6574 733a 0a20 2020  .n_datasets:.   
+00029a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029a60: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+00029a70: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
 00029a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029a90: 6966 2062 6568 6176 696f 725f 706f 6c69  if behavior_poli
-00029aa0: 6379 5f6e 616d 6520 6973 204e 6f6e 6520  cy_name is None 
-00029ab0: 616e 6420 6461 7461 7365 745f 6964 2069  and dataset_id i
-00029ac0: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
-00029ad0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-00029ae0: 656c 662e 6d75 6c74 6970 6c65 5f6c 6f67  elf.multiple_log
-00029af0: 6765 645f 6461 7461 7365 742e 6e5f 6461  ged_dataset.n_da
-00029b00: 7461 7365 7473 2021 3d20 696e 7075 745f  tasets != input_
-00029b10: 6469 6374 2e6e 5f64 6174 6173 6574 733a  dict.n_datasets:
-00029b20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00029b30: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-00029b40: 616c 7565 4572 726f 7228 0a20 2020 2020  alueError(.     
-00029b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029b60: 2020 2020 2020 2022 4578 7065 6374 6564         "Expected
-00029b70: 2074 6861 7420 6c6f 6767 6564 2064 6174   that logged dat
-00029b80: 6173 6574 7320 616e 6420 696e 7075 7420  asets and input 
-00029b90: 6469 6374 7320 636f 6e73 6973 7473 206f  dicts consists o
-00029ba0: 6620 7468 6520 7361 6d65 2062 6568 6176  f the same behav
-00029bb0: 696f 7220 706f 6c69 6369 6573 2061 6e64  ior policies and
-00029bc0: 2064 6174 6173 6574 2069 6473 2c20 6275   dataset ids, bu
-00029bd0: 7420 666f 756e 6420 4661 6c73 652e 220a  t found False.".
-00029be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029bf0: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
-00029c00: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00029c10: 6e74 6572 7175 6172 7469 6c65 5f72 616e  nterquartile_ran
-00029c20: 6765 5f64 6963 7420 3d20 6465 6661 756c  ge_dict = defaul
-00029c30: 7464 6963 7428 6c69 7374 290a 2020 2020  tdict(list).    
-00029c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029c50: 666f 7220 280a 2020 2020 2020 2020 2020  for (.          
-00029c60: 2020 2020 2020 2020 2020 2020 2020 6265                be
-00029c70: 6861 7669 6f72 5f70 6f6c 6963 792c 0a20  havior_policy,. 
+00029a90: 2020 2022 4578 7065 6374 6564 2074 6861     "Expected tha
+00029aa0: 7420 6c6f 6767 6564 2064 6174 6173 6574  t logged dataset
+00029ab0: 7320 616e 6420 696e 7075 7420 6469 6374  s and input dict
+00029ac0: 7320 636f 6e73 6973 7473 206f 6620 7468  s consists of th
+00029ad0: 6520 7361 6d65 2062 6568 6176 696f 7220  e same behavior 
+00029ae0: 706f 6c69 6369 6573 2061 6e64 2064 6174  policies and dat
+00029af0: 6173 6574 2069 6473 2c20 6275 7420 666f  aset ids, but fo
+00029b00: 756e 6420 4661 6c73 652e 220a 2020 2020  und False.".    
+00029b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029b20: 2020 2020 290a 0a20 2020 2020 2020 2020      )..         
+00029b30: 2020 2020 2020 2020 2020 2069 6e74 6572             inter
+00029b40: 7175 6172 7469 6c65 5f72 616e 6765 5f64  quartile_range_d
+00029b50: 6963 7420 3d20 6465 6661 756c 7464 6963  ict = defaultdic
+00029b60: 7428 6c69 7374 290a 2020 2020 2020 2020  t(list).        
+00029b70: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00029b80: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00029b90: 2020 2020 2020 2020 2020 6265 6861 7669            behavi
+00029ba0: 6f72 5f70 6f6c 6963 792c 0a20 2020 2020  or_policy,.     
+00029bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029bc0: 2020 206e 5f64 6174 6173 6574 732c 0a20     n_datasets,. 
+00029bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029be0: 2020 2029 2069 6e20 696e 7075 745f 6469     ) in input_di
+00029bf0: 6374 2e6e 5f64 6174 6173 6574 732e 6974  ct.n_datasets.it
+00029c00: 656d 7328 293a 0a20 2020 2020 2020 2020  ems():.         
+00029c10: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00029c20: 6f72 2064 6174 6173 6574 5f69 645f 2069  or dataset_id_ i
+00029c30: 6e20 7261 6e67 6528 6e5f 6461 7461 7365  n range(n_datase
+00029c40: 7473 293a 0a20 2020 2020 2020 2020 2020  ts):.           
+00029c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029c60: 2073 656c 662e 5f72 6567 6973 7465 725f   self._register_
+00029c70: 6c6f 6767 6564 5f64 6174 6173 6574 280a  logged_dataset(.
 00029c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029c90: 2020 2020 2020 206e 5f64 6174 6173 6574         n_dataset
-00029ca0: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
-00029cb0: 2020 2020 2020 2029 2069 6e20 696e 7075         ) in inpu
-00029cc0: 745f 6469 6374 2e6e 5f64 6174 6173 6574  t_dict.n_dataset
-00029cd0: 732e 6974 656d 7328 293a 0a20 2020 2020  s.items():.     
-00029ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029cf0: 2020 2066 6f72 2064 6174 6173 6574 5f69     for dataset_i
-00029d00: 645f 2069 6e20 7261 6e67 6528 6e5f 6461  d_ in range(n_da
-00029d10: 7461 7365 7473 293a 0a20 2020 2020 2020  tasets):.       
+00029c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029ca0: 6265 6861 7669 6f72 5f70 6f6c 6963 795f  behavior_policy_
+00029cb0: 6e61 6d65 3d62 6568 6176 696f 725f 706f  name=behavior_po
+00029cc0: 6c69 6379 2c0a 2020 2020 2020 2020 2020  licy,.          
+00029cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029ce0: 2020 2020 2020 6461 7461 7365 745f 6964        dataset_id
+00029cf0: 3d64 6174 6173 6574 5f69 645f 2c0a 2020  =dataset_id_,.  
+00029d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029d10: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
 00029d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029d30: 2020 2020 2073 656c 662e 5f72 6567 6973       self._regis
-00029d40: 7465 725f 6c6f 6767 6564 5f64 6174 6173  ter_logged_datas
-00029d50: 6574 280a 2020 2020 2020 2020 2020 2020  et(.            
+00029d30: 2020 2020 2020 2020 696e 7075 745f 6469          input_di
+00029d40: 6374 5f20 3d20 696e 7075 745f 6469 6374  ct_ = input_dict
+00029d50: 2e67 6574 280a 2020 2020 2020 2020 2020  .get(.          
 00029d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029d70: 2020 2020 6265 6861 7669 6f72 5f70 6f6c      behavior_pol
-00029d80: 6963 795f 6e61 6d65 3d62 6568 6176 696f  icy_name=behavio
-00029d90: 725f 706f 6c69 6379 2c0a 2020 2020 2020  r_policy,.      
+00029d70: 2020 2020 2020 6265 6861 7669 6f72 5f70        behavior_p
+00029d80: 6f6c 6963 795f 6e61 6d65 3d62 6568 6176  olicy_name=behav
+00029d90: 696f 725f 706f 6c69 6379 2c0a 2020 2020  ior_policy,.    
 00029da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029db0: 2020 2020 2020 2020 2020 6461 7461 7365            datase
-00029dc0: 745f 6964 3d64 6174 6173 6574 5f69 645f  t_id=dataset_id_
-00029dd0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00029de0: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-00029df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029e00: 2020 2020 2020 2020 2020 2020 696e 7075              inpu
-00029e10: 745f 6469 6374 5f20 3d20 696e 7075 745f  t_dict_ = input_
-00029e20: 6469 6374 2e67 6574 280a 2020 2020 2020  dict.get(.      
+00029db0: 2020 2020 2020 2020 2020 2020 6461 7461              data
+00029dc0: 7365 745f 6964 3d64 6174 6173 6574 5f69  set_id=dataset_i
+00029dd0: 645f 2c0a 2020 2020 2020 2020 2020 2020  d_,.            
+00029de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029df0: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
+00029e00: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00029e10: 6e74 6572 7175 6172 7469 6c65 5f72 616e  nterquartile_ran
+00029e20: 6765 5f64 6963 745f 203d 2028 0a20 2020  ge_dict_ = (.   
 00029e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029e40: 2020 2020 2020 2020 2020 6265 6861 7669            behavi
-00029e50: 6f72 5f70 6f6c 6963 795f 6e61 6d65 3d62  or_policy_name=b
-00029e60: 6568 6176 696f 725f 706f 6c69 6379 2c0a  ehavior_policy,.
-00029e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029e40: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00029e50: 662e 5f65 7374 696d 6174 655f 696e 7465  f._estimate_inte
+00029e60: 7271 7561 7274 696c 655f 7261 6e67 6528  rquartile_range(
+00029e70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 00029e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029e90: 6461 7461 7365 745f 6964 3d64 6174 6173  dataset_id=datas
-00029ea0: 6574 5f69 645f 2c0a 2020 2020 2020 2020  et_id_,.        
+00029e90: 2020 2020 2069 6e70 7574 5f64 6963 745f       input_dict_
+00029ea0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
 00029eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029ec0: 2020 2020 290a 0a20 2020 2020 2020 2020      )..         
-00029ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029ee0: 2020 2069 6e74 6572 7175 6172 7469 6c65     interquartile
-00029ef0: 5f72 616e 6765 5f64 6963 745f 203d 2028  _range_dict_ = (
-00029f00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00029f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029f20: 2073 656c 662e 5f65 7374 696d 6174 655f   self._estimate_
-00029f30: 696e 7465 7271 7561 7274 696c 655f 7261  interquartile_ra
-00029f40: 6e67 6528 0a20 2020 2020 2020 2020 2020  nge(.           
-00029f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029f60: 2020 2020 2020 2020 2069 6e70 7574 5f64           input_d
-00029f70: 6963 745f 2c0a 2020 2020 2020 2020 2020  ict_,.          
-00029f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029f90: 2020 2020 2020 2020 2020 636f 6d70 6172            compar
-00029fa0: 6564 5f65 7374 696d 6174 6f72 733d 636f  ed_estimators=co
-00029fb0: 6d70 6172 6564 5f65 7374 696d 6174 6f72  mpared_estimator
-00029fc0: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
-00029fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00029fe0: 2020 2020 2020 2061 6c70 6861 3d61 6c70         alpha=alp
-00029ff0: 6861 2c0a 2020 2020 2020 2020 2020 2020  ha,.            
-0002a000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a010: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-0002a020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a030: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-0002a040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a050: 696e 7465 7271 7561 7274 696c 655f 7261  interquartile_ra
-0002a060: 6e67 655f 6469 6374 5b62 6568 6176 696f  nge_dict[behavio
-0002a070: 725f 706f 6c69 6379 5d2e 6170 7065 6e64  r_policy].append
-0002a080: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0002a090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a0a0: 2020 696e 7465 7271 7561 7274 696c 655f    interquartile_
-0002a0b0: 7261 6e67 655f 6469 6374 5f0a 2020 2020  range_dict_.    
-0002a0c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a0d0: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
-0002a0e0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0002a0f0: 6e74 6572 7175 6172 7469 6c65 5f72 616e  nterquartile_ran
-0002a100: 6765 5f64 6963 7420 3d20 6465 6661 756c  ge_dict = defaul
-0002a110: 7464 6963 745f 746f 5f64 6963 7428 0a20  tdict_to_dict(. 
-0002a120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a130: 2020 2020 2020 2069 6e74 6572 7175 6172         interquar
-0002a140: 7469 6c65 5f72 616e 6765 5f64 6963 740a  tile_range_dict.
-0002a150: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a160: 2020 2020 290a 0a20 2020 2020 2020 2020      )..         
-0002a170: 2020 2020 2020 2065 6c69 6620 6265 6861         elif beha
-0002a180: 7669 6f72 5f70 6f6c 6963 795f 6e61 6d65  vior_policy_name
-0002a190: 2069 7320 4e6f 6e65 2061 6e64 2064 6174   is None and dat
-0002a1a0: 6173 6574 5f69 6420 6973 206e 6f74 204e  aset_id is not N
-0002a1b0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-0002a1c0: 2020 2020 2020 2020 2069 6620 280a 2020           if (.  
-0002a1d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a1e0: 2020 2020 2020 7365 6c66 2e6d 756c 7469        self.multi
-0002a1f0: 706c 655f 6c6f 6767 6564 5f64 6174 6173  ple_logged_datas
-0002a200: 6574 2e62 6568 6176 696f 725f 706f 6c69  et.behavior_poli
-0002a210: 6379 5f6e 616d 6573 0a20 2020 2020 2020  cy_names.       
-0002a220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a230: 2021 3d20 696e 7075 745f 6469 6374 2e62   != input_dict.b
-0002a240: 6568 6176 696f 725f 706f 6c69 6379 5f6e  ehavior_policy_n
-0002a250: 616d 6573 0a20 2020 2020 2020 2020 2020  ames.           
-0002a260: 2020 2020 2020 2020 2029 3a0a 2020 2020           ):.    
-0002a270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a280: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-0002a290: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
-0002a2a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a2b0: 2020 2245 7870 6563 7465 6420 7468 6174    "Expected that
-0002a2c0: 206c 6f67 6765 6420 6461 7461 7365 7473   logged datasets
-0002a2d0: 2061 6e64 2069 6e70 7574 2064 6963 7473   and input dicts
-0002a2e0: 2063 6f6e 7369 7374 7320 6f66 2074 6865   consists of the
-0002a2f0: 2073 616d 6520 6265 6861 7669 6f72 2070   same behavior p
-0002a300: 6f6c 6963 6965 732c 2062 7574 2066 6f75  olicies, but fou
-0002a310: 6e64 2046 616c 7365 2e22 0a20 2020 2020  nd False.".     
+00029ec0: 2020 2020 2020 636f 6d70 6172 6564 5f65        compared_e
+00029ed0: 7374 696d 6174 6f72 733d 636f 6d70 6172  stimators=compar
+00029ee0: 6564 5f65 7374 696d 6174 6f72 732c 0a20  ed_estimators,. 
+00029ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029f10: 2020 2061 6c70 6861 3d61 6c70 6861 2c0a     alpha=alpha,.
+00029f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029f40: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00029f50: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+00029f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029f70: 2020 2020 2020 2020 2020 2020 696e 7465              inte
+00029f80: 7271 7561 7274 696c 655f 7261 6e67 655f  rquartile_range_
+00029f90: 6469 6374 5b62 6568 6176 696f 725f 706f  dict[behavior_po
+00029fa0: 6c69 6379 5d2e 6170 7065 6e64 280a 2020  licy].append(.  
+00029fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029fc0: 2020 2020 2020 2020 2020 2020 2020 696e                in
+00029fd0: 7465 7271 7561 7274 696c 655f 7261 6e67  terquartile_rang
+00029fe0: 655f 6469 6374 5f0a 2020 2020 2020 2020  e_dict_.        
+00029ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a000: 2020 2020 290a 0a20 2020 2020 2020 2020      )..         
+0002a010: 2020 2020 2020 2020 2020 2069 6e74 6572             inter
+0002a020: 7175 6172 7469 6c65 5f72 616e 6765 5f64  quartile_range_d
+0002a030: 6963 7420 3d20 6465 6661 756c 7464 6963  ict = defaultdic
+0002a040: 745f 746f 5f64 6963 7428 0a20 2020 2020  t_to_dict(.     
+0002a050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a060: 2020 2069 6e74 6572 7175 6172 7469 6c65     interquartile
+0002a070: 5f72 616e 6765 5f64 6963 740a 2020 2020  _range_dict.    
+0002a080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a090: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
+0002a0a0: 2020 2065 6c69 6620 6265 6861 7669 6f72     elif behavior
+0002a0b0: 5f70 6f6c 6963 795f 6e61 6d65 2069 7320  _policy_name is 
+0002a0c0: 4e6f 6e65 2061 6e64 2064 6174 6173 6574  None and dataset
+0002a0d0: 5f69 6420 6973 206e 6f74 204e 6f6e 653a  _id is not None:
+0002a0e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002a0f0: 2020 2020 2069 6620 280a 2020 2020 2020       if (.      
+0002a100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a110: 2020 7365 6c66 2e6d 756c 7469 706c 655f    self.multiple_
+0002a120: 6c6f 6767 6564 5f64 6174 6173 6574 2e62  logged_dataset.b
+0002a130: 6568 6176 696f 725f 706f 6c69 6379 5f6e  ehavior_policy_n
+0002a140: 616d 6573 0a20 2020 2020 2020 2020 2020  ames.           
+0002a150: 2020 2020 2020 2020 2020 2020 2021 3d20               != 
+0002a160: 696e 7075 745f 6469 6374 2e62 6568 6176  input_dict.behav
+0002a170: 696f 725f 706f 6c69 6379 5f6e 616d 6573  ior_policy_names
+0002a180: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002a190: 2020 2020 2029 3a0a 2020 2020 2020 2020       ):.        
+0002a1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a1b0: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+0002a1c0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0002a1d0: 2020 2020 2020 2020 2020 2020 2020 2245                "E
+0002a1e0: 7870 6563 7465 6420 7468 6174 206c 6f67  xpected that log
+0002a1f0: 6765 6420 6461 7461 7365 7473 2061 6e64  ged datasets and
+0002a200: 2069 6e70 7574 2064 6963 7473 2063 6f6e   input dicts con
+0002a210: 7369 7374 7320 6f66 2074 6865 2073 616d  sists of the sam
+0002a220: 6520 6265 6861 7669 6f72 2070 6f6c 6963  e behavior polic
+0002a230: 6965 732c 2062 7574 2066 6f75 6e64 2046  ies, but found F
+0002a240: 616c 7365 2e22 0a20 2020 2020 2020 2020  alse.".         
+0002a250: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+0002a260: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0002a270: 2020 2020 2020 696e 7465 7271 7561 7274        interquart
+0002a280: 696c 655f 7261 6e67 655f 6469 6374 203d  ile_range_dict =
+0002a290: 207b 7d0a 2020 2020 2020 2020 2020 2020   {}.            
+0002a2a0: 2020 2020 2020 2020 666f 7220 6265 6861          for beha
+0002a2b0: 7669 6f72 5f70 6f6c 6963 7920 696e 2073  vior_policy in s
+0002a2c0: 656c 662e 6d75 6c74 6970 6c65 5f6c 6f67  elf.multiple_log
+0002a2d0: 6765 645f 6461 7461 7365 743a 0a20 2020  ged_dataset:.   
+0002a2e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a2f0: 2020 2020 2073 656c 662e 5f72 6567 6973       self._regis
+0002a300: 7465 725f 6c6f 6767 6564 5f64 6174 6173  ter_logged_datas
+0002a310: 6574 280a 2020 2020 2020 2020 2020 2020  et(.            
 0002a320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a330: 2020 2029 0a0a 2020 2020 2020 2020 2020     )..          
-0002a340: 2020 2020 2020 2020 2020 696e 7465 7271            interq
-0002a350: 7561 7274 696c 655f 7261 6e67 655f 6469  uartile_range_di
-0002a360: 6374 203d 207b 7d0a 2020 2020 2020 2020  ct = {}.        
-0002a370: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-0002a380: 6265 6861 7669 6f72 5f70 6f6c 6963 7920  behavior_policy 
-0002a390: 696e 2073 656c 662e 6d75 6c74 6970 6c65  in self.multiple
-0002a3a0: 5f6c 6f67 6765 645f 6461 7461 7365 743a  _logged_dataset:
-0002a3b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002a3c0: 2020 2020 2020 2020 2073 656c 662e 5f72           self._r
-0002a3d0: 6567 6973 7465 725f 6c6f 6767 6564 5f64  egister_logged_d
-0002a3e0: 6174 6173 6574 280a 2020 2020 2020 2020  ataset(.        
-0002a3f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a400: 2020 2020 6265 6861 7669 6f72 5f70 6f6c      behavior_pol
-0002a410: 6963 795f 6e61 6d65 3d62 6568 6176 696f  icy_name=behavio
-0002a420: 725f 706f 6c69 6379 2c20 6461 7461 7365  r_policy, datase
-0002a430: 745f 6964 3d64 6174 6173 6574 5f69 640a  t_id=dataset_id.
-0002a440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a450: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0002a460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a470: 2020 696e 7075 745f 6469 6374 5f20 3d20    input_dict_ = 
-0002a480: 696e 7075 745f 6469 6374 2e67 6574 280a  input_dict.get(.
-0002a490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a4a0: 2020 2020 2020 2020 2020 2020 6265 6861              beha
-0002a4b0: 7669 6f72 5f70 6f6c 6963 795f 6e61 6d65  vior_policy_name
-0002a4c0: 3d62 6568 6176 696f 725f 706f 6c69 6379  =behavior_policy
-0002a4d0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0002a4e0: 2020 2020 2020 2020 2020 2020 2020 6461                da
-0002a4f0: 7461 7365 745f 6964 3d64 6174 6173 6574  taset_id=dataset
-0002a500: 5f69 642c 0a20 2020 2020 2020 2020 2020  _id,.           
-0002a510: 2020 2020 2020 2020 2020 2020 2029 0a0a               )..
-0002a520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a530: 2020 2020 2020 2020 696e 7465 7271 7561          interqua
-0002a540: 7274 696c 655f 7261 6e67 655f 6469 6374  rtile_range_dict
-0002a550: 5f20 3d20 7365 6c66 2e5f 6573 7469 6d61  _ = self._estima
-0002a560: 7465 5f69 6e74 6572 7175 6172 7469 6c65  te_interquartile
-0002a570: 5f72 616e 6765 280a 2020 2020 2020 2020  _range(.        
-0002a580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a590: 2020 2020 696e 7075 745f 6469 6374 5f2c      input_dict_,
-0002a5a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002a5b0: 2020 2020 2020 2020 2020 2020 2063 6f6d               com
-0002a5c0: 7061 7265 645f 6573 7469 6d61 746f 7273  pared_estimators
-0002a5d0: 3d63 6f6d 7061 7265 645f 6573 7469 6d61  =compared_estima
-0002a5e0: 746f 7273 2c0a 2020 2020 2020 2020 2020  tors,.          
-0002a5f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a600: 2020 616c 7068 613d 616c 7068 612c 0a20    alpha=alpha,. 
-0002a610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a620: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0002a630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a640: 2069 6e74 6572 7175 6172 7469 6c65 5f72   interquartile_r
-0002a650: 616e 6765 5f64 6963 745b 0a20 2020 2020  ange_dict[.     
-0002a660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a670: 2020 2020 2020 2062 6568 6176 696f 725f         behavior_
-0002a680: 706f 6c69 6379 0a20 2020 2020 2020 2020  policy.         
-0002a690: 2020 2020 2020 2020 2020 2020 2020 205d                 ]
-0002a6a0: 203d 2069 6e74 6572 7175 6172 7469 6c65   = interquartile
-0002a6b0: 5f72 616e 6765 5f64 6963 745f 0a0a 2020  _range_dict_..  
-0002a6c0: 2020 2020 2020 2020 2020 2020 2020 656c                el
-0002a6d0: 6966 2062 6568 6176 696f 725f 706f 6c69  if behavior_poli
-0002a6e0: 6379 5f6e 616d 6520 6973 206e 6f74 204e  cy_name is not N
-0002a6f0: 6f6e 6520 616e 6420 6461 7461 7365 745f  one and dataset_
-0002a700: 6964 2069 7320 4e6f 6e65 3a0a 2020 2020  id is None:.    
-0002a710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a720: 6966 2028 0a20 2020 2020 2020 2020 2020  if (.           
-0002a730: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0002a740: 662e 6d75 6c74 6970 6c65 5f6c 6f67 6765  f.multiple_logge
-0002a750: 645f 6461 7461 7365 742e 6e5f 6461 7461  d_dataset.n_data
-0002a760: 7365 7473 5b62 6568 6176 696f 725f 706f  sets[behavior_po
-0002a770: 6c69 6379 5f6e 616d 655d 0a20 2020 2020  licy_name].     
-0002a780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a790: 2020 2021 3d20 696e 7075 745f 6469 6374     != input_dict
-0002a7a0: 2e6e 5f64 6174 6173 6574 735b 6265 6861  .n_datasets[beha
-0002a7b0: 7669 6f72 5f70 6f6c 6963 795f 6e61 6d65  vior_policy_name
-0002a7c0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-0002a7d0: 2020 2020 2020 293a 0a20 2020 2020 2020        ):.       
-0002a7e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a7f0: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-0002a800: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
-0002a810: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0002a820: 4578 7065 6374 6564 2074 6861 7420 6c6f  Expected that lo
-0002a830: 6767 6564 2064 6174 6173 6574 7320 616e  gged datasets an
-0002a840: 6420 696e 7075 7420 6469 6374 7320 636f  d input dicts co
-0002a850: 6e73 6973 7473 206f 6620 7468 6520 7361  nsists of the sa
-0002a860: 6d65 2064 6174 6173 6574 2069 6473 2c20  me dataset ids, 
-0002a870: 6275 7420 666f 756e 6420 4661 6c73 652e  but found False.
-0002a880: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-0002a890: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
-0002a8a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a8b0: 2069 6e74 6572 7175 6172 7469 6c65 5f72   interquartile_r
-0002a8c0: 616e 6765 5f64 6963 7420 3d20 5b5d 0a20  ange_dict = []. 
-0002a8d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a8e0: 2020 2066 6f72 2064 6174 6173 6574 5f69     for dataset_i
-0002a8f0: 645f 2069 6e20 7261 6e67 6528 0a20 2020  d_ in range(.   
-0002a900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a910: 2020 2020 2069 6e70 7574 5f64 6963 742e       input_dict.
-0002a920: 6e5f 6461 7461 7365 7473 5b62 6568 6176  n_datasets[behav
-0002a930: 696f 725f 706f 6c69 6379 5f6e 616d 655d  ior_policy_name]
-0002a940: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002a950: 2020 2020 2029 3a0a 2020 2020 2020 2020       ):.        
-0002a960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a970: 7365 6c66 2e5f 7265 6769 7374 6572 5f6c  self._register_l
-0002a980: 6f67 6765 645f 6461 7461 7365 7428 0a20  ogged_dataset(. 
+0002a330: 6265 6861 7669 6f72 5f70 6f6c 6963 795f  behavior_policy_
+0002a340: 6e61 6d65 3d62 6568 6176 696f 725f 706f  name=behavior_po
+0002a350: 6c69 6379 2c20 6461 7461 7365 745f 6964  licy, dataset_id
+0002a360: 3d64 6174 6173 6574 5f69 640a 2020 2020  =dataset_id.    
+0002a370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a380: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+0002a390: 2020 2020 2020 2020 2020 2020 2020 696e                in
+0002a3a0: 7075 745f 6469 6374 5f20 3d20 696e 7075  put_dict_ = inpu
+0002a3b0: 745f 6469 6374 2e67 6574 280a 2020 2020  t_dict.get(.    
+0002a3c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a3d0: 2020 2020 2020 2020 6265 6861 7669 6f72          behavior
+0002a3e0: 5f70 6f6c 6963 795f 6e61 6d65 3d62 6568  _policy_name=beh
+0002a3f0: 6176 696f 725f 706f 6c69 6379 2c0a 2020  avior_policy,.  
+0002a400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a410: 2020 2020 2020 2020 2020 6461 7461 7365            datase
+0002a420: 745f 6964 3d64 6174 6173 6574 5f69 642c  t_id=dataset_id,
+0002a430: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002a440: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
+0002a450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a460: 2020 2020 696e 7465 7271 7561 7274 696c      interquartil
+0002a470: 655f 7261 6e67 655f 6469 6374 5f20 3d20  e_range_dict_ = 
+0002a480: 7365 6c66 2e5f 6573 7469 6d61 7465 5f69  self._estimate_i
+0002a490: 6e74 6572 7175 6172 7469 6c65 5f72 616e  nterquartile_ran
+0002a4a0: 6765 280a 2020 2020 2020 2020 2020 2020  ge(.            
+0002a4b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a4c0: 696e 7075 745f 6469 6374 5f2c 0a20 2020  input_dict_,.   
+0002a4d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a4e0: 2020 2020 2020 2020 2063 6f6d 7061 7265           compare
+0002a4f0: 645f 6573 7469 6d61 746f 7273 3d63 6f6d  d_estimators=com
+0002a500: 7061 7265 645f 6573 7469 6d61 746f 7273  pared_estimators
+0002a510: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0002a520: 2020 2020 2020 2020 2020 2020 2020 616c                al
+0002a530: 7068 613d 616c 7068 612c 0a20 2020 2020  pha=alpha,.     
+0002a540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a550: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+0002a560: 2020 2020 2020 2020 2020 2020 2069 6e74               int
+0002a570: 6572 7175 6172 7469 6c65 5f72 616e 6765  erquartile_range
+0002a580: 5f64 6963 745b 0a20 2020 2020 2020 2020  _dict[.         
+0002a590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a5a0: 2020 2062 6568 6176 696f 725f 706f 6c69     behavior_poli
+0002a5b0: 6379 0a20 2020 2020 2020 2020 2020 2020  cy.             
+0002a5c0: 2020 2020 2020 2020 2020 205d 203d 2069             ] = i
+0002a5d0: 6e74 6572 7175 6172 7469 6c65 5f72 616e  nterquartile_ran
+0002a5e0: 6765 5f64 6963 745f 0a0a 2020 2020 2020  ge_dict_..      
+0002a5f0: 2020 2020 2020 2020 2020 656c 6966 2062            elif b
+0002a600: 6568 6176 696f 725f 706f 6c69 6379 5f6e  ehavior_policy_n
+0002a610: 616d 6520 6973 206e 6f74 204e 6f6e 6520  ame is not None 
+0002a620: 616e 6420 6461 7461 7365 745f 6964 2069  and dataset_id i
+0002a630: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
+0002a640: 2020 2020 2020 2020 2020 2020 6966 2028              if (
+0002a650: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002a660: 2020 2020 2020 2020 2073 656c 662e 6d75           self.mu
+0002a670: 6c74 6970 6c65 5f6c 6f67 6765 645f 6461  ltiple_logged_da
+0002a680: 7461 7365 742e 6e5f 6461 7461 7365 7473  taset.n_datasets
+0002a690: 5b62 6568 6176 696f 725f 706f 6c69 6379  [behavior_policy
+0002a6a0: 5f6e 616d 655d 0a20 2020 2020 2020 2020  _name].         
+0002a6b0: 2020 2020 2020 2020 2020 2020 2020 2021                 !
+0002a6c0: 3d20 696e 7075 745f 6469 6374 2e6e 5f64  = input_dict.n_d
+0002a6d0: 6174 6173 6574 735b 6265 6861 7669 6f72  atasets[behavior
+0002a6e0: 5f70 6f6c 6963 795f 6e61 6d65 5d0a 2020  _policy_name].  
+0002a6f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a700: 2020 293a 0a20 2020 2020 2020 2020 2020    ):.           
+0002a710: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+0002a720: 7365 2056 616c 7565 4572 726f 7228 0a20  se ValueError(. 
+0002a730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a740: 2020 2020 2020 2020 2020 2022 4578 7065             "Expe
+0002a750: 6374 6564 2074 6861 7420 6c6f 6767 6564  cted that logged
+0002a760: 2064 6174 6173 6574 7320 616e 6420 696e   datasets and in
+0002a770: 7075 7420 6469 6374 7320 636f 6e73 6973  put dicts consis
+0002a780: 7473 206f 6620 7468 6520 7361 6d65 2064  ts of the same d
+0002a790: 6174 6173 6574 2069 6473 2c20 6275 7420  ataset ids, but 
+0002a7a0: 666f 756e 6420 4661 6c73 652e 220a 2020  found False.".  
+0002a7b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a7c0: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+0002a7d0: 2020 2020 2020 2020 2020 2020 2069 6e74               int
+0002a7e0: 6572 7175 6172 7469 6c65 5f72 616e 6765  erquartile_range
+0002a7f0: 5f64 6963 7420 3d20 5b5d 0a20 2020 2020  _dict = [].     
+0002a800: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0002a810: 6f72 2064 6174 6173 6574 5f69 645f 2069  or dataset_id_ i
+0002a820: 6e20 7261 6e67 6528 0a20 2020 2020 2020  n range(.       
+0002a830: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a840: 2069 6e70 7574 5f64 6963 742e 6e5f 6461   input_dict.n_da
+0002a850: 7461 7365 7473 5b62 6568 6176 696f 725f  tasets[behavior_
+0002a860: 706f 6c69 6379 5f6e 616d 655d 0a20 2020  policy_name].   
+0002a870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a880: 2029 3a0a 2020 2020 2020 2020 2020 2020   ):.            
+0002a890: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0002a8a0: 2e5f 7265 6769 7374 6572 5f6c 6f67 6765  ._register_logge
+0002a8b0: 645f 6461 7461 7365 7428 0a20 2020 2020  d_dataset(.     
+0002a8c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a8d0: 2020 2020 2020 2062 6568 6176 696f 725f         behavior_
+0002a8e0: 706f 6c69 6379 5f6e 616d 653d 6265 6861  policy_name=beha
+0002a8f0: 7669 6f72 5f70 6f6c 6963 795f 6e61 6d65  vior_policy_name
+0002a900: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0002a910: 2020 2020 2020 2020 2020 2020 2020 6461                da
+0002a920: 7461 7365 745f 6964 3d64 6174 6173 6574  taset_id=dataset
+0002a930: 5f69 645f 2c0a 2020 2020 2020 2020 2020  _id_,.          
+0002a940: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+0002a950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a960: 2020 2020 2020 2020 696e 7075 745f 6469          input_di
+0002a970: 6374 5f20 3d20 696e 7075 745f 6469 6374  ct_ = input_dict
+0002a980: 2e67 6574 280a 2020 2020 2020 2020 2020  .get(.          
 0002a990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a9a0: 2020 2020 2020 2020 2020 2062 6568 6176             behav
-0002a9b0: 696f 725f 706f 6c69 6379 5f6e 616d 653d  ior_policy_name=
-0002a9c0: 6265 6861 7669 6f72 5f70 6f6c 6963 795f  behavior_policy_
-0002a9d0: 6e61 6d65 2c0a 2020 2020 2020 2020 2020  name,.          
-0002a9e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a9f0: 2020 6461 7461 7365 745f 6964 3d64 6174    dataset_id=dat
-0002aa00: 6173 6574 5f69 645f 2c0a 2020 2020 2020  aset_id_,.      
-0002aa10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002aa20: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-0002aa30: 2020 2020 2020 2020 2020 2020 696e 7075              inpu
-0002aa40: 745f 6469 6374 5f20 3d20 696e 7075 745f  t_dict_ = input_
-0002aa50: 6469 6374 2e67 6574 280a 2020 2020 2020  dict.get(.      
-0002aa60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002aa70: 2020 2020 2020 6265 6861 7669 6f72 5f70        behavior_p
-0002aa80: 6f6c 6963 795f 6e61 6d65 3d62 6568 6176  olicy_name=behav
-0002aa90: 696f 725f 706f 6c69 6379 5f6e 616d 652c  ior_policy_name,
-0002aaa0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002aab0: 2020 2020 2020 2020 2020 2020 2064 6174               dat
-0002aac0: 6173 6574 5f69 643d 6461 7461 7365 745f  aset_id=dataset_
-0002aad0: 6964 5f2c 0a20 2020 2020 2020 2020 2020  id_,.           
-0002aae0: 2020 2020 2020 2020 2020 2020 2029 0a0a               )..
-0002aaf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ab00: 2020 2020 2020 2020 696e 7465 7271 7561          interqua
-0002ab10: 7274 696c 655f 7261 6e67 655f 6469 6374  rtile_range_dict
-0002ab20: 5f20 3d20 7365 6c66 2e5f 6573 7469 6d61  _ = self._estima
-0002ab30: 7465 5f69 6e74 6572 7175 6172 7469 6c65  te_interquartile
-0002ab40: 5f72 616e 6765 280a 2020 2020 2020 2020  _range(.        
-0002ab50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ab60: 2020 2020 696e 7075 745f 6469 6374 5f2c      input_dict_,
-0002ab70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002ab80: 2020 2020 2020 2020 2020 2020 2063 6f6d               com
-0002ab90: 7061 7265 645f 6573 7469 6d61 746f 7273  pared_estimators
-0002aba0: 3d63 6f6d 7061 7265 645f 6573 7469 6d61  =compared_estima
-0002abb0: 746f 7273 2c0a 2020 2020 2020 2020 2020  tors,.          
-0002abc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002abd0: 2020 616c 7068 613d 616c 7068 612c 0a20    alpha=alpha,. 
-0002abe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002abf0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0002ac00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ac10: 2069 6e74 6572 7175 6172 7469 6c65 5f72   interquartile_r
-0002ac20: 616e 6765 5f64 6963 742e 6170 7065 6e64  ange_dict.append
-0002ac30: 2869 6e74 6572 7175 6172 7469 6c65 5f72  (interquartile_r
-0002ac40: 616e 6765 5f64 6963 745f 290a 0a20 2020  ange_dict_)..   
-0002ac50: 2020 2020 2020 2020 2020 2020 2065 6c73               els
-0002ac60: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-0002ac70: 2020 2020 2020 2073 656c 662e 5f72 6567         self._reg
-0002ac80: 6973 7465 725f 6c6f 6767 6564 5f64 6174  ister_logged_dat
-0002ac90: 6173 6574 280a 2020 2020 2020 2020 2020  aset(.          
-0002aca0: 2020 2020 2020 2020 2020 2020 2020 6265                be
-0002acb0: 6861 7669 6f72 5f70 6f6c 6963 795f 6e61  havior_policy_na
-0002acc0: 6d65 3d62 6568 6176 696f 725f 706f 6c69  me=behavior_poli
-0002acd0: 6379 5f6e 616d 652c 2064 6174 6173 6574  cy_name, dataset
-0002ace0: 5f69 643d 6461 7461 7365 745f 6964 0a20  _id=dataset_id. 
-0002acf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ad00: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-0002ad10: 2020 2020 2020 2020 2069 6e70 7574 5f64           input_d
-0002ad20: 6963 745f 203d 2069 6e70 7574 5f64 6963  ict_ = input_dic
-0002ad30: 742e 6765 7428 0a20 2020 2020 2020 2020  t.get(.         
-0002ad40: 2020 2020 2020 2020 2020 2020 2020 2062                 b
-0002ad50: 6568 6176 696f 725f 706f 6c69 6379 5f6e  ehavior_policy_n
-0002ad60: 616d 653d 6265 6861 7669 6f72 5f70 6f6c  ame=behavior_pol
-0002ad70: 6963 795f 6e61 6d65 2c20 6461 7461 7365  icy_name, datase
-0002ad80: 745f 6964 3d64 6174 6173 6574 5f69 640a  t_id=dataset_id.
+0002a9a0: 2020 6265 6861 7669 6f72 5f70 6f6c 6963    behavior_polic
+0002a9b0: 795f 6e61 6d65 3d62 6568 6176 696f 725f  y_name=behavior_
+0002a9c0: 706f 6c69 6379 5f6e 616d 652c 0a20 2020  policy_name,.   
+0002a9d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a9e0: 2020 2020 2020 2020 2064 6174 6173 6574           dataset
+0002a9f0: 5f69 643d 6461 7461 7365 745f 6964 5f2c  _id=dataset_id_,
+0002aa00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002aa10: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
+0002aa20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002aa30: 2020 2020 696e 7465 7271 7561 7274 696c      interquartil
+0002aa40: 655f 7261 6e67 655f 6469 6374 5f20 3d20  e_range_dict_ = 
+0002aa50: 7365 6c66 2e5f 6573 7469 6d61 7465 5f69  self._estimate_i
+0002aa60: 6e74 6572 7175 6172 7469 6c65 5f72 616e  nterquartile_ran
+0002aa70: 6765 280a 2020 2020 2020 2020 2020 2020  ge(.            
+0002aa80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002aa90: 696e 7075 745f 6469 6374 5f2c 0a20 2020  input_dict_,.   
+0002aaa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002aab0: 2020 2020 2020 2020 2063 6f6d 7061 7265           compare
+0002aac0: 645f 6573 7469 6d61 746f 7273 3d63 6f6d  d_estimators=com
+0002aad0: 7061 7265 645f 6573 7469 6d61 746f 7273  pared_estimators
+0002aae0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0002aaf0: 2020 2020 2020 2020 2020 2020 2020 616c                al
+0002ab00: 7068 613d 616c 7068 612c 0a20 2020 2020  pha=alpha,.     
+0002ab10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ab20: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+0002ab30: 2020 2020 2020 2020 2020 2020 2069 6e74               int
+0002ab40: 6572 7175 6172 7469 6c65 5f72 616e 6765  erquartile_range
+0002ab50: 5f64 6963 742e 6170 7065 6e64 2869 6e74  _dict.append(int
+0002ab60: 6572 7175 6172 7469 6c65 5f72 616e 6765  erquartile_range
+0002ab70: 5f64 6963 745f 290a 0a20 2020 2020 2020  _dict_)..       
+0002ab80: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+0002ab90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002aba0: 2020 2073 656c 662e 5f72 6567 6973 7465     self._registe
+0002abb0: 725f 6c6f 6767 6564 5f64 6174 6173 6574  r_logged_dataset
+0002abc0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0002abd0: 2020 2020 2020 2020 2020 6265 6861 7669            behavi
+0002abe0: 6f72 5f70 6f6c 6963 795f 6e61 6d65 3d62  or_policy_name=b
+0002abf0: 6568 6176 696f 725f 706f 6c69 6379 5f6e  ehavior_policy_n
+0002ac00: 616d 652c 2064 6174 6173 6574 5f69 643d  ame, dataset_id=
+0002ac10: 6461 7461 7365 745f 6964 0a20 2020 2020  dataset_id.     
+0002ac20: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+0002ac30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002ac40: 2020 2020 2069 6e70 7574 5f64 6963 745f       input_dict_
+0002ac50: 203d 2069 6e70 7574 5f64 6963 742e 6765   = input_dict.ge
+0002ac60: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
+0002ac70: 2020 2020 2020 2020 2020 2062 6568 6176             behav
+0002ac80: 696f 725f 706f 6c69 6379 5f6e 616d 653d  ior_policy_name=
+0002ac90: 6265 6861 7669 6f72 5f70 6f6c 6963 795f  behavior_policy_
+0002aca0: 6e61 6d65 2c20 6461 7461 7365 745f 6964  name, dataset_id
+0002acb0: 3d64 6174 6173 6574 5f69 640a 2020 2020  =dataset_id.    
+0002acc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002acd0: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
+0002ace0: 2020 2020 2020 2069 6e74 6572 7175 6172         interquar
+0002acf0: 7469 6c65 5f72 616e 6765 5f64 6963 7420  tile_range_dict 
+0002ad00: 3d20 7365 6c66 2e5f 6573 7469 6d61 7465  = self._estimate
+0002ad10: 5f69 6e74 6572 7175 6172 7469 6c65 5f72  _interquartile_r
+0002ad20: 616e 6765 280a 2020 2020 2020 2020 2020  ange(.          
+0002ad30: 2020 2020 2020 2020 2020 2020 2020 696e                in
+0002ad40: 7075 745f 6469 6374 5f2c 0a20 2020 2020  put_dict_,.     
+0002ad50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ad60: 2020 2063 6f6d 7061 7265 645f 6573 7469     compared_esti
+0002ad70: 6d61 746f 7273 3d63 6f6d 7061 7265 645f  mators=compared_
+0002ad80: 6573 7469 6d61 746f 7273 2c0a 2020 2020  estimators,.    
 0002ad90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ada0: 2020 2020 290a 0a20 2020 2020 2020 2020      )..         
-0002adb0: 2020 2020 2020 2020 2020 2069 6e74 6572             inter
-0002adc0: 7175 6172 7469 6c65 5f72 616e 6765 5f64  quartile_range_d
-0002add0: 6963 7420 3d20 7365 6c66 2e5f 6573 7469  ict = self._esti
-0002ade0: 6d61 7465 5f69 6e74 6572 7175 6172 7469  mate_interquarti
-0002adf0: 6c65 5f72 616e 6765 280a 2020 2020 2020  le_range(.      
-0002ae00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ae10: 2020 696e 7075 745f 6469 6374 5f2c 0a20    input_dict_,. 
-0002ae20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ae30: 2020 2020 2020 2063 6f6d 7061 7265 645f         compared_
-0002ae40: 6573 7469 6d61 746f 7273 3d63 6f6d 7061  estimators=compa
-0002ae50: 7265 645f 6573 7469 6d61 746f 7273 2c0a  red_estimators,.
-0002ae60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ae70: 2020 2020 2020 2020 616c 7068 613d 616c          alpha=al
-0002ae80: 7068 612c 0a20 2020 2020 2020 2020 2020  pha,.           
-0002ae90: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-0002aea0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0002aeb0: 2020 2020 2020 2020 2020 2020 2020 6265                be
-0002aec0: 6861 7669 6f72 5f70 6f6c 6963 795f 6e61  havior_policy_na
-0002aed0: 6d65 203d 206c 6973 7428 696e 7075 745f  me = list(input_
-0002aee0: 6469 6374 2e76 616c 7565 7328 2929 5b30  dict.values())[0
-0002aef0: 5d5b 2262 6568 6176 696f 725f 706f 6c69  ]["behavior_poli
-0002af00: 6379 225d 0a20 2020 2020 2020 2020 2020  cy"].           
-0002af10: 2020 2020 2064 6174 6173 6574 5f69 6420       dataset_id 
-0002af20: 3d20 6c69 7374 2869 6e70 7574 5f64 6963  = list(input_dic
-0002af30: 742e 7661 6c75 6573 2829 295b 305d 5b22  t.values())[0]["
-0002af40: 6461 7461 7365 745f 6964 225d 0a0a 2020  dataset_id"]..  
-0002af50: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0002af60: 6c66 2e5f 7265 6769 7374 6572 5f6c 6f67  lf._register_log
-0002af70: 6765 645f 6461 7461 7365 7428 0a20 2020  ged_dataset(.   
+0002ada0: 2020 2020 616c 7068 613d 616c 7068 612c      alpha=alpha,
+0002adb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002adc0: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+0002add0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0002ade0: 2020 2020 2020 2020 2020 6265 6861 7669            behavi
+0002adf0: 6f72 5f70 6f6c 6963 795f 6e61 6d65 203d  or_policy_name =
+0002ae00: 206c 6973 7428 696e 7075 745f 6469 6374   list(input_dict
+0002ae10: 2e76 616c 7565 7328 2929 5b30 5d5b 2262  .values())[0]["b
+0002ae20: 6568 6176 696f 725f 706f 6c69 6379 225d  ehavior_policy"]
+0002ae30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002ae40: 2064 6174 6173 6574 5f69 6420 3d20 6c69   dataset_id = li
+0002ae50: 7374 2869 6e70 7574 5f64 6963 742e 7661  st(input_dict.va
+0002ae60: 6c75 6573 2829 295b 305d 5b22 6461 7461  lues())[0]["data
+0002ae70: 7365 745f 6964 225d 0a0a 2020 2020 2020  set_id"]..      
+0002ae80: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+0002ae90: 7265 6769 7374 6572 5f6c 6f67 6765 645f  register_logged_
+0002aea0: 6461 7461 7365 7428 0a20 2020 2020 2020  dataset(.       
+0002aeb0: 2020 2020 2020 2020 2020 2020 2062 6568               beh
+0002aec0: 6176 696f 725f 706f 6c69 6379 5f6e 616d  avior_policy_nam
+0002aed0: 653d 6265 6861 7669 6f72 5f70 6f6c 6963  e=behavior_polic
+0002aee0: 795f 6e61 6d65 2c20 6461 7461 7365 745f  y_name, dataset_
+0002aef0: 6964 3d64 6174 6173 6574 5f69 640a 2020  id=dataset_id.  
+0002af00: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+0002af10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002af20: 2069 6e74 6572 7175 6172 7469 6c65 5f72   interquartile_r
+0002af30: 616e 6765 5f64 6963 7420 3d20 7365 6c66  ange_dict = self
+0002af40: 2e5f 6573 7469 6d61 7465 5f69 6e74 6572  ._estimate_inter
+0002af50: 7175 6172 7469 6c65 5f72 616e 6765 280a  quartile_range(.
+0002af60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002af70: 2020 2020 696e 7075 745f 6469 6374 2c0a      input_dict,.
 0002af80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002af90: 2062 6568 6176 696f 725f 706f 6c69 6379   behavior_policy
-0002afa0: 5f6e 616d 653d 6265 6861 7669 6f72 5f70  _name=behavior_p
-0002afb0: 6f6c 6963 795f 6e61 6d65 2c20 6461 7461  olicy_name, data
-0002afc0: 7365 745f 6964 3d64 6174 6173 6574 5f69  set_id=dataset_i
-0002afd0: 640a 2020 2020 2020 2020 2020 2020 2020  d.              
-0002afe0: 2020 290a 0a20 2020 2020 2020 2020 2020    )..           
-0002aff0: 2020 2020 2069 6e74 6572 7175 6172 7469       interquarti
-0002b000: 6c65 5f72 616e 6765 5f64 6963 7420 3d20  le_range_dict = 
-0002b010: 7365 6c66 2e5f 6573 7469 6d61 7465 5f69  self._estimate_i
-0002b020: 6e74 6572 7175 6172 7469 6c65 5f72 616e  nterquartile_ran
-0002b030: 6765 280a 2020 2020 2020 2020 2020 2020  ge(.            
-0002b040: 2020 2020 2020 2020 696e 7075 745f 6469          input_di
-0002b050: 6374 2c0a 2020 2020 2020 2020 2020 2020  ct,.            
-0002b060: 2020 2020 2020 2020 636f 6d70 6172 6564          compared
-0002b070: 5f65 7374 696d 6174 6f72 733d 636f 6d70  _estimators=comp
-0002b080: 6172 6564 5f65 7374 696d 6174 6f72 732c  ared_estimators,
-0002b090: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002b0a0: 2020 2020 2061 6c70 6861 3d61 6c70 6861       alpha=alpha
-0002b0b0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0002b0c0: 2020 290a 0a20 2020 2020 2020 2065 6c73    )..        els
-0002b0d0: 653a 0a20 2020 2020 2020 2020 2020 2069  e:.            i
-0002b0e0: 6620 6973 696e 7374 616e 6365 2869 6e70  f isinstance(inp
-0002b0f0: 7574 5f64 6963 742c 204d 756c 7469 706c  ut_dict, Multipl
-0002b100: 6549 6e70 7574 4469 6374 293a 0a20 2020  eInputDict):.   
-0002b110: 2020 2020 2020 2020 2020 2020 2072 6169               rai
-0002b120: 7365 2056 616c 7565 4572 726f 7228 0a20  se ValueError(. 
-0002b130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b140: 2020 2022 7768 656e 2075 7369 6e67 204c     "when using L
-0002b150: 6f67 6765 6444 6174 6173 6574 2c20 706c  oggedDataset, pl
-0002b160: 6561 7365 2075 7365 2049 6e70 7574 4469  ease use InputDi
-0002b170: 6374 2069 6e73 7465 6164 206f 6620 4d75  ct instead of Mu
-0002b180: 6c74 6970 6c65 496e 7075 7444 6963 7422  ltipleInputDict"
-0002b190: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002b1a0: 2029 0a0a 2020 2020 2020 2020 2020 2020   )..            
-0002b1b0: 696e 7465 7271 7561 7274 696c 655f 7261  interquartile_ra
-0002b1c0: 6e67 655f 6469 6374 203d 2073 656c 662e  nge_dict = self.
-0002b1d0: 5f65 7374 696d 6174 655f 696e 7465 7271  _estimate_interq
-0002b1e0: 7561 7274 696c 655f 7261 6e67 6528 0a20  uartile_range(. 
-0002b1f0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0002b200: 6e70 7574 5f64 6963 742c 0a20 2020 2020  nput_dict,.     
-0002b210: 2020 2020 2020 2020 2020 2063 6f6d 7061             compa
-0002b220: 7265 645f 6573 7469 6d61 746f 7273 3d63  red_estimators=c
-0002b230: 6f6d 7061 7265 645f 6573 7469 6d61 746f  ompared_estimato
-0002b240: 7273 2c0a 2020 2020 2020 2020 2020 2020  rs,.            
-0002b250: 2020 2020 616c 7068 613d 616c 7068 612c      alpha=alpha,
-0002b260: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
-0002b270: 2020 2020 2020 2020 7265 7475 726e 2069          return i
-0002b280: 6e74 6572 7175 6172 7469 6c65 5f72 616e  nterquartile_ran
-0002b290: 6765 5f64 6963 740a 0a20 2020 2064 6566  ge_dict..    def
-0002b2a0: 2076 6973 7561 6c69 7a65 5f63 756d 756c   visualize_cumul
-0002b2b0: 6174 6976 655f 6469 7374 7269 6275 7469  ative_distributi
-0002b2c0: 6f6e 5f66 756e 6374 696f 6e28 0a20 2020  on_function(.   
-0002b2d0: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-0002b2e0: 2020 2069 6e70 7574 5f64 6963 743a 2055     input_dict: U
-0002b2f0: 6e69 6f6e 5b4f 5045 496e 7075 7444 6963  nion[OPEInputDic
-0002b300: 742c 204d 756c 7469 706c 6549 6e70 7574  t, MultipleInput
-0002b310: 4469 6374 5d2c 0a20 2020 2020 2020 2063  Dict],.        c
-0002b320: 6f6d 7061 7265 645f 6573 7469 6d61 746f  ompared_estimato
-0002b330: 7273 3a20 4f70 7469 6f6e 616c 5b4c 6973  rs: Optional[Lis
-0002b340: 745b 7374 725d 5d20 3d20 4e6f 6e65 2c0a  t[str]] = None,.
-0002b350: 2020 2020 2020 2020 6265 6861 7669 6f72          behavior
-0002b360: 5f70 6f6c 6963 795f 6e61 6d65 3a20 4f70  _policy_name: Op
-0002b370: 7469 6f6e 616c 5b73 7472 5d20 3d20 4e6f  tional[str] = No
-0002b380: 6e65 2c0a 2020 2020 2020 2020 6461 7461  ne,.        data
-0002b390: 7365 745f 6964 3a20 4f70 7469 6f6e 616c  set_id: Optional
-0002b3a0: 5b69 6e74 5d20 3d20 4e6f 6e65 2c0a 2020  [int] = None,.  
-0002b3b0: 2020 2020 2020 6875 653a 2073 7472 203d        hue: str =
-0002b3c0: 2022 6573 7469 6d61 746f 7222 2c0a 2020   "estimator",.  
-0002b3d0: 2020 2020 2020 6c65 6765 6e64 3a20 626f        legend: bo
-0002b3e0: 6f6c 203d 2054 7275 652c 0a20 2020 2020  ol = True,.     
-0002b3f0: 2020 206e 5f63 6f6c 733a 204f 7074 696f     n_cols: Optio
-0002b400: 6e61 6c5b 696e 745d 203d 204e 6f6e 652c  nal[int] = None,
-0002b410: 0a20 2020 2020 2020 2066 6967 5f64 6972  .        fig_dir
-0002b420: 3a20 4f70 7469 6f6e 616c 5b50 6174 685d  : Optional[Path]
-0002b430: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
-0002b440: 2066 6967 5f6e 616d 653a 2073 7472 203d   fig_name: str =
-0002b450: 2022 6573 7469 6d61 7465 645f 6375 6d75   "estimated_cumu
-0002b460: 6c61 7469 7665 5f64 6973 7472 6962 7574  lative_distribut
-0002b470: 696f 6e5f 6675 6e63 7469 6f6e 2e70 6e67  ion_function.png
-0002b480: 222c 0a20 2020 2029 202d 3e20 4e6f 6e65  ",.    ) -> None
-0002b490: 3a0a 2020 2020 2020 2020 2222 2256 6973  :.        """Vis
-0002b4a0: 7561 6c69 7a65 2074 6865 2063 756d 756c  ualize the cumul
-0002b4b0: 6174 6976 6520 6469 7374 7269 6275 7469  ative distributi
-0002b4c0: 6f6e 2066 756e 6374 696f 6e20 6573 7469  on function esti
-0002b4d0: 6d61 7465 6420 6279 204f 5045 2065 7374  mated by OPE est
-0002b4e0: 696d 6174 6f72 732e 0a0a 2020 2020 2020  imators...      
-0002b4f0: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
-0002b500: 2020 2020 202d 2d2d 2d2d 2d2d 0a20 2020       -------.   
-0002b510: 2020 2020 2069 6e70 7574 5f64 6963 743a       input_dict:
-0002b520: 204f 5045 496e 7075 7444 6963 7420 6f72   OPEInputDict or
-0002b530: 204d 756c 7469 706c 6549 6e70 7574 4469   MultipleInputDi
-0002b540: 6374 0a20 2020 2020 2020 2020 2020 2044  ct.            D
-0002b550: 6963 7469 6f6e 6172 7920 6f66 2074 6865  ictionary of the
-0002b560: 204f 5045 2069 6e70 7574 7320 666f 7220   OPE inputs for 
-0002b570: 6561 6368 2065 7661 6c75 6174 696f 6e20  each evaluation 
-0002b580: 706f 6c69 6379 2e0a 0a20 2020 2020 2020  policy...       
-0002b590: 2020 2020 202e 2e20 636f 6465 2d62 6c6f       .. code-blo
-0002b5a0: 636b 3a3a 2070 7974 686f 6e0a 0a20 2020  ck:: python..   
-0002b5b0: 2020 2020 2020 2020 2020 2020 206b 6579               key
-0002b5c0: 3a20 5b65 7661 6c75 6174 696f 6e5f 706f  : [evaluation_po
-0002b5d0: 6c69 6379 5d5b 0a20 2020 2020 2020 2020  licy][.         
-0002b5e0: 2020 2020 2020 2020 2020 2065 7661 6c75             evalu
-0002b5f0: 6174 696f 6e5f 706f 6c69 6379 5f61 6374  ation_policy_act
-0002b600: 696f 6e2c 0a20 2020 2020 2020 2020 2020  ion,.           
-0002b610: 2020 2020 2020 2020 2065 7661 6c75 6174           evaluat
-0002b620: 696f 6e5f 706f 6c69 6379 5f61 6374 696f  ion_policy_actio
-0002b630: 6e5f 6469 7374 2c0a 2020 2020 2020 2020  n_dist,.        
-0002b640: 2020 2020 2020 2020 2020 2020 7374 6174              stat
-0002b650: 655f 6163 7469 6f6e 5f76 616c 7565 5f70  e_action_value_p
-0002b660: 7265 6469 6374 696f 6e2c 0a20 2020 2020  rediction,.     
-0002b670: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0002b680: 6e69 7469 616c 5f73 7461 7465 5f76 616c  nitial_state_val
-0002b690: 7565 5f70 7265 6469 6374 696f 6e2c 0a20  ue_prediction,. 
-0002b6a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b6b0: 2020 2073 7461 7465 5f61 6374 696f 6e5f     state_action_
-0002b6c0: 6d61 7267 696e 616c 5f69 6d70 6f72 7461  marginal_importa
-0002b6d0: 6e63 655f 7765 6967 6874 2c0a 2020 2020  nce_weight,.    
-0002b6e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b6f0: 7374 6174 655f 6d61 7267 696e 616c 5f69  state_marginal_i
-0002b700: 6d70 6f72 7461 6e63 655f 7765 6967 6874  mportance_weight
-0002b710: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0002b720: 2020 2020 2020 6f6e 5f70 6f6c 6963 795f        on_policy_
-0002b730: 706f 6c69 6379 5f76 616c 7565 2c0a 2020  policy_value,.  
-0002b740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b750: 2020 6761 6d6d 612c 0a20 2020 2020 2020    gamma,.       
-0002b760: 2020 2020 2020 2020 2020 2020 2062 6568               beh
-0002b770: 6176 696f 725f 706f 6c69 6379 2c0a 2020  avior_policy,.  
-0002b780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002b790: 2020 6576 616c 7561 7469 6f6e 5f70 6f6c    evaluation_pol
-0002b7a0: 6963 792c 0a20 2020 2020 2020 2020 2020  icy,.           
-0002b7b0: 2020 2020 2020 2020 2064 6174 6173 6574           dataset
-0002b7c0: 5f69 642c 0a20 2020 2020 2020 2020 2020  _id,.           
-0002b7d0: 2020 2020 205d 0a0a 2020 2020 2020 2020       ]..        
-0002b7e0: 2020 2020 2e2e 2073 6565 616c 736f 3a3a      .. seealso::
-0002b7f0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0002b800: 2020 3a63 6c61 7373 3a60 7363 6f70 655f    :class:`scope_
-0002b810: 726c 2e6f 7065 2e69 6e70 7574 2e43 7265  rl.ope.input.Cre
-0002b820: 6174 654f 5045 496e 7075 7460 2064 6573  ateOPEInput` des
-0002b830: 6372 6962 6573 2074 6865 2063 6f6d 706f  cribes the compo
-0002b840: 6e65 6e74 7320 6f66 203a 636c 6173 733a  nents of :class:
-0002b850: 6069 6e70 7574 5f64 6963 7460 2e0a 0a20  `input_dict`... 
-0002b860: 2020 2020 2020 2063 6f6d 7061 7265 645f         compared_
-0002b870: 6573 7469 6d61 746f 7273 3a20 6c69 7374  estimators: list
-0002b880: 206f 6620 7374 722c 2064 6566 6175 6c74   of str, default
-0002b890: 3d4e 6f6e 650a 2020 2020 2020 2020 2020  =None.          
-0002b8a0: 2020 4e61 6d65 206f 6620 636f 6d70 6172    Name of compar
-0002b8b0: 6564 2065 7374 696d 6174 6f72 732e 0a20  ed estimators.. 
-0002b8c0: 2020 2020 2020 2020 2020 2049 6620 604e             If `N
-0002b8d0: 6f6e 6560 2069 7320 6769 7665 6e2c 2061  one` is given, a
-0002b8e0: 6c6c 2074 6865 2065 7374 696d 6174 6f72  ll the estimator
-0002b8f0: 7320 6172 6520 636f 6d70 6172 6564 2e0a  s are compared..
-0002b900: 0a20 2020 2020 2020 2062 6568 6176 696f  .        behavio
-0002b910: 725f 706f 6c69 6379 5f6e 616d 653a 2073  r_policy_name: s
-0002b920: 7472 2c20 6465 6661 756c 743d 4e6f 6e65  tr, default=None
-0002b930: 0a20 2020 2020 2020 2020 2020 204e 616d  .            Nam
-0002b940: 6520 6f66 2074 6865 2062 6568 6176 696f  e of the behavio
-0002b950: 7220 706f 6c69 6379 2e0a 0a20 2020 2020  r policy...     
-0002b960: 2020 2064 6174 6173 6574 5f69 643a 2069     dataset_id: i
-0002b970: 6e74 2c20 6465 6661 756c 743d 4e6f 6e65  nt, default=None
-0002b980: 0a20 2020 2020 2020 2020 2020 2049 6420  .            Id 
-0002b990: 6f66 2074 6865 206c 6f67 6765 6420 6461  of the logged da
-0002b9a0: 7461 7365 742e 0a0a 2020 2020 2020 2020  taset...        
-0002b9b0: 6875 653a 207b 2265 7374 696d 6174 6f72  hue: {"estimator
-0002b9c0: 222c 2022 706f 6c69 6379 227d 2c20 6465  ", "policy"}, de
-0002b9d0: 6661 756c 743d 2265 7374 696d 6174 6f72  fault="estimator
-0002b9e0: 220a 2020 2020 2020 2020 2020 2020 4875  ".            Hu
-0002b9f0: 6520 6f66 2074 6865 2070 6c6f 742e 0a0a  e of the plot...
-0002ba00: 2020 2020 2020 2020 6c65 6765 6e64 3a20          legend: 
-0002ba10: 626f 6f6c 2c20 6465 6661 756c 743d 5472  bool, default=Tr
-0002ba20: 7565 0a20 2020 2020 2020 2020 2020 2057  ue.            W
-0002ba30: 6865 7468 6572 2074 6f20 696e 636c 7564  hether to includ
-0002ba40: 6520 6120 6c65 6765 6e64 2069 6e20 7468  e a legend in th
-0002ba50: 6520 6669 6775 7265 2e0a 0a20 2020 2020  e figure...     
-0002ba60: 2020 206e 5f63 6f6c 733a 2069 6e74 2c20     n_cols: int, 
-0002ba70: 6465 6661 756c 743d 4e6f 6e65 0a20 2020  default=None.   
-0002ba80: 2020 2020 2020 2020 204e 756d 6265 7220           Number 
-0002ba90: 6f66 2063 6f6c 756d 6e73 2069 6e20 7468  of columns in th
-0002baa0: 6520 6669 6775 7265 2e0a 0a20 2020 2020  e figure...     
-0002bab0: 2020 2066 6967 5f64 6972 3a20 5061 7468     fig_dir: Path
-0002bac0: 2c20 6465 6661 756c 743d 4e6f 6e65 0a20  , default=None. 
-0002bad0: 2020 2020 2020 2020 2020 2050 6174 6820             Path 
-0002bae0: 746f 2073 746f 7265 2074 6865 2062 6172  to store the bar
-0002baf0: 2066 6967 7572 652e 0a20 2020 2020 2020   figure..       
-0002bb00: 2020 2020 2049 6620 604e 6f6e 6560 2069       If `None` i
-0002bb10: 7320 6769 7665 6e2c 2074 6865 2066 6967  s given, the fig
-0002bb20: 7572 6520 7769 6c6c 206e 6f74 2062 6520  ure will not be 
-0002bb30: 7361 7665 642e 0a0a 2020 2020 2020 2020  saved...        
-0002bb40: 6669 675f 6e61 6d65 3a20 7374 722c 2064  fig_name: str, d
-0002bb50: 6566 6175 6c74 3d22 6573 7469 6d61 7465  efault="estimate
-0002bb60: 645f 6375 6d75 6c61 7469 7665 5f64 6973  d_cumulative_dis
-0002bb70: 7472 6962 7574 696f 6e5f 6675 6e63 7469  tribution_functi
-0002bb80: 6f6e 2e70 6e67 220a 2020 2020 2020 2020  on.png".        
-0002bb90: 2020 2020 4e61 6d65 206f 6620 7468 6520      Name of the 
-0002bba0: 6261 7220 6669 6775 7265 2e0a 0a20 2020  bar figure...   
-0002bbb0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0002bbc0: 2063 6f6d 7061 7265 645f 6573 7469 6d61   compared_estima
-0002bbd0: 746f 7273 203d 2073 656c 662e 5f63 6865  tors = self._che
-0002bbe0: 636b 5f63 6f6d 7061 7265 645f 6573 7469  ck_compared_esti
-0002bbf0: 6d61 746f 7273 2863 6f6d 7061 7265 645f  mators(compared_
-0002bc00: 6573 7469 6d61 746f 7273 290a 2020 2020  estimators).    
-0002bc10: 2020 2020 7365 6c66 2e5f 6368 6563 6b5f      self._check_
-0002bc20: 6261 7369 635f 7669 7375 616c 697a 6174  basic_visualizat
-0002bc30: 696f 6e5f 696e 7075 7473 280a 2020 2020  ion_inputs(.    
-0002bc40: 2020 2020 2020 2020 6875 653d 6875 652c          hue=hue,
-0002bc50: 206e 5f63 6f6c 733d 6e5f 636f 6c73 2c20   n_cols=n_cols, 
-0002bc60: 6669 675f 6469 723d 6669 675f 6469 722c  fig_dir=fig_dir,
-0002bc70: 2066 6967 5f6e 616d 653d 6669 675f 6e61   fig_name=fig_na
-0002bc80: 6d65 0a20 2020 2020 2020 2029 0a0a 2020  me.        )..  
-0002bc90: 2020 2020 2020 6966 2073 656c 662e 7573        if self.us
-0002bca0: 655f 6d75 6c74 6970 6c65 5f6c 6f67 6765  e_multiple_logge
-0002bcb0: 645f 6461 7461 7365 743a 0a20 2020 2020  d_dataset:.     
-0002bcc0: 2020 2020 2020 2069 6620 6265 6861 7669         if behavi
-0002bcd0: 6f72 5f70 6f6c 6963 795f 6e61 6d65 2069  or_policy_name i
-0002bce0: 7320 4e6f 6e65 206f 7220 6461 7461 7365  s None or datase
-0002bcf0: 745f 6964 2069 7320 4e6f 6e65 3a0a 2020  t_id is None:.  
-0002bd00: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-0002bd10: 6973 6520 5661 6c75 6545 7272 6f72 280a  ise ValueError(.
-0002bd20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002bd30: 2020 2020 2262 6568 6176 696f 725f 706f      "behavior_po
-0002bd40: 6c69 6379 5f6e 616d 6520 616e 6420 6461  licy_name and da
-0002bd50: 7461 7365 745f 6964 206d 7573 7420 6265  taset_id must be
-0002bd60: 2073 7065 6369 6669 6564 2077 6865 6e20   specified when 
-0002bd70: 7573 696e 6720 4d75 6c74 6970 6c65 4c6f  using MultipleLo
-0002bd80: 6767 6564 4461 7461 7365 742e 220a 2020  ggedDataset.".  
-0002bd90: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-0002bda0: 2020 2020 2020 2020 2020 2020 6966 2069              if i
-0002bdb0: 7369 6e73 7461 6e63 6528 696e 7075 745f  sinstance(input_
-0002bdc0: 6469 6374 2c20 4d75 6c74 6970 6c65 496e  dict, MultipleIn
-0002bdd0: 7075 7444 6963 7429 3a0a 2020 2020 2020  putDict):.      
-0002bde0: 2020 2020 2020 2020 2020 696e 7075 745f            input_
-0002bdf0: 6469 6374 203d 2069 6e70 7574 5f64 6963  dict = input_dic
-0002be00: 742e 6765 7428 0a20 2020 2020 2020 2020  t.get(.         
-0002be10: 2020 2020 2020 2020 2020 2062 6568 6176             behav
-0002be20: 696f 725f 706f 6c69 6379 5f6e 616d 653d  ior_policy_name=
-0002be30: 6265 6861 7669 6f72 5f70 6f6c 6963 795f  behavior_policy_
-0002be40: 6e61 6d65 2c20 6461 7461 7365 745f 6964  name, dataset_id
-0002be50: 3d64 6174 6173 6574 5f69 640a 2020 2020  =dataset_id.    
-0002be60: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-0002be70: 2020 2020 2020 6368 6563 6b5f 696e 7075        check_inpu
-0002be80: 745f 6469 6374 2869 6e70 7574 5f64 6963  t_dict(input_dic
-0002be90: 7429 0a0a 2020 2020 2020 2020 6375 6d75  t)..        cumu
-0002bea0: 6c61 7469 7665 5f64 6973 7472 6962 7574  lative_distribut
-0002beb0: 696f 6e5f 6675 6e63 7469 6f6e 5f64 6963  ion_function_dic
-0002bec0: 7420 3d20 280a 2020 2020 2020 2020 2020  t = (.          
-0002bed0: 2020 7365 6c66 2e65 7374 696d 6174 655f    self.estimate_
-0002bee0: 6375 6d75 6c61 7469 7665 5f64 6973 7472  cumulative_distr
-0002bef0: 6962 7574 696f 6e5f 6675 6e63 7469 6f6e  ibution_function
-0002bf00: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0002bf10: 2020 696e 7075 745f 6469 6374 2c0a 2020    input_dict,.  
-0002bf20: 2020 2020 2020 2020 2020 2020 2020 636f                co
-0002bf30: 6d70 6172 6564 5f65 7374 696d 6174 6f72  mpared_estimator
-0002bf40: 733d 636f 6d70 6172 6564 5f65 7374 696d  s=compared_estim
-0002bf50: 6174 6f72 732c 0a20 2020 2020 2020 2020  ators,.         
-0002bf60: 2020 2020 2020 2062 6568 6176 696f 725f         behavior_
-0002bf70: 706f 6c69 6379 5f6e 616d 653d 6265 6861  policy_name=beha
-0002bf80: 7669 6f72 5f70 6f6c 6963 795f 6e61 6d65  vior_policy_name
-0002bf90: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0002bfa0: 2020 6461 7461 7365 745f 6964 3d64 6174    dataset_id=dat
-0002bfb0: 6173 6574 5f69 642c 0a20 2020 2020 2020  aset_id,.       
-0002bfc0: 2020 2020 2029 0a20 2020 2020 2020 2029       ).        )
-0002bfd0: 0a20 2020 2020 2020 2072 6577 6172 645f  .        reward_
-0002bfe0: 7363 616c 6520 3d20 7365 6c66 2e6f 6274  scale = self.obt
-0002bff0: 6169 6e5f 7265 7761 7264 5f73 6361 6c65  ain_reward_scale
-0002c000: 2829 0a0a 2020 2020 2020 2020 706c 742e  ()..        plt.
-0002c010: 7374 796c 652e 7573 6528 2267 6770 6c6f  style.use("ggplo
-0002c020: 7422 290a 0a20 2020 2020 2020 2069 6620  t")..        if 
-0002c030: 6875 6520 3d3d 2022 6573 7469 6d61 746f  hue == "estimato
-0002c040: 7222 3a0a 2020 2020 2020 2020 2020 2020  r":.            
-0002c050: 6e5f 6669 6773 203d 206c 656e 2869 6e70  n_figs = len(inp
-0002c060: 7574 5f64 6963 7429 0a20 2020 2020 2020  ut_dict).       
-0002c070: 2020 2020 206e 5f63 6f6c 7320 3d20 6d69       n_cols = mi
-0002c080: 6e28 332c 206e 5f66 6967 7329 2069 6620  n(3, n_figs) if 
-0002c090: 6e5f 636f 6c73 2069 7320 4e6f 6e65 2065  n_cols is None e
-0002c0a0: 6c73 6520 6e5f 636f 6c73 0a20 2020 2020  lse n_cols.     
-0002c0b0: 2020 2020 2020 206e 5f72 6f77 7320 3d20         n_rows = 
-0002c0c0: 286e 5f66 6967 7320 2d20 3129 202f 2f20  (n_figs - 1) // 
-0002c0d0: 6e5f 636f 6c73 202b 2031 0a0a 2020 2020  n_cols + 1..    
-0002c0e0: 2020 2020 2020 2020 6669 672c 2061 7865          fig, axe
-0002c0f0: 7320 3d20 706c 742e 7375 6270 6c6f 7473  s = plt.subplots
-0002c100: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0002c110: 2020 6e72 6f77 733d 6e5f 726f 7773 2c20    nrows=n_rows, 
-0002c120: 6e63 6f6c 733d 6e5f 636f 6c73 2c20 6669  ncols=n_cols, fi
-0002c130: 6773 697a 653d 2836 202a 206e 5f63 6f6c  gsize=(6 * n_col
-0002c140: 732c 2034 202a 206e 5f72 6f77 7329 0a20  s, 4 * n_rows). 
-0002c150: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
-0002c160: 2020 2020 2020 2020 2020 6966 206e 5f72            if n_r
-0002c170: 6f77 7320 3d3d 2031 3a0a 2020 2020 2020  ows == 1:.      
-0002c180: 2020 2020 2020 2020 2020 666f 7220 692c            for i,
-0002c190: 2065 7661 6c5f 706f 6c69 6379 2069 6e20   eval_policy in 
-0002c1a0: 656e 756d 6572 6174 6528 696e 7075 745f  enumerate(input_
-0002c1b0: 6469 6374 2e6b 6579 7328 2929 3a0a 2020  dict.keys()):.  
-0002c1c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c1d0: 2020 666f 7220 6a2c 2065 7374 696d 6174    for j, estimat
-0002c1e0: 6f72 2069 6e20 656e 756d 6572 6174 6528  or in enumerate(
-0002c1f0: 636f 6d70 6172 6564 5f65 7374 696d 6174  compared_estimat
-0002c200: 6f72 7329 3a0a 2020 2020 2020 2020 2020  ors):.          
-0002c210: 2020 2020 2020 2020 2020 2020 2020 6178                ax
-0002c220: 6573 5b69 5d2e 706c 6f74 280a 2020 2020  es[i].plot(.    
-0002c230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c240: 2020 2020 2020 2020 7265 7761 7264 5f73          reward_s
-0002c250: 6361 6c65 2c0a 2020 2020 2020 2020 2020  cale,.          
-0002c260: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c270: 2020 6375 6d75 6c61 7469 7665 5f64 6973    cumulative_dis
-0002c280: 7472 6962 7574 696f 6e5f 6675 6e63 7469  tribution_functi
-0002c290: 6f6e 5f64 6963 745b 6576 616c 5f70 6f6c  on_dict[eval_pol
-0002c2a0: 6963 795d 5b0a 2020 2020 2020 2020 2020  icy][.          
-0002c2b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c2c0: 2020 2020 2020 6573 7469 6d61 746f 720a        estimator.
-0002c2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c2e0: 2020 2020 2020 2020 2020 2020 5d2c 0a20              ],. 
-0002c2f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c300: 2020 2020 2020 2020 2020 206c 6162 656c             label
-0002c310: 3d65 7374 696d 6174 6f72 2c0a 2020 2020  =estimator,.    
-0002c320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c330: 2020 2020 290a 0a20 2020 2020 2020 2020      )..         
-0002c340: 2020 2020 2020 2020 2020 2069 6620 696e             if in
-0002c350: 7075 745f 6469 6374 5b65 7661 6c5f 706f  put_dict[eval_po
-0002c360: 6c69 6379 5d5b 226f 6e5f 706f 6c69 6379  licy]["on_policy
-0002c370: 5f70 6f6c 6963 795f 7661 6c75 6522 5d20  _policy_value"] 
-0002c380: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+0002af90: 2020 2020 636f 6d70 6172 6564 5f65 7374      compared_est
+0002afa0: 696d 6174 6f72 733d 636f 6d70 6172 6564  imators=compared
+0002afb0: 5f65 7374 696d 6174 6f72 732c 0a20 2020  _estimators,.   
+0002afc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002afd0: 2061 6c70 6861 3d61 6c70 6861 2c0a 2020   alpha=alpha,.  
+0002afe0: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+0002aff0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+0002b000: 2020 2020 2020 2020 2020 2069 6620 6973             if is
+0002b010: 696e 7374 616e 6365 2869 6e70 7574 5f64  instance(input_d
+0002b020: 6963 742c 204d 756c 7469 706c 6549 6e70  ict, MultipleInp
+0002b030: 7574 4469 6374 293a 0a20 2020 2020 2020  utDict):.       
+0002b040: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+0002b050: 616c 7565 4572 726f 7228 0a20 2020 2020  alueError(.     
+0002b060: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0002b070: 7768 656e 2075 7369 6e67 204c 6f67 6765  when using Logge
+0002b080: 6444 6174 6173 6574 2c20 706c 6561 7365  dDataset, please
+0002b090: 2075 7365 2049 6e70 7574 4469 6374 2069   use InputDict i
+0002b0a0: 6e73 7465 6164 206f 6620 4d75 6c74 6970  nstead of Multip
+0002b0b0: 6c65 496e 7075 7444 6963 7422 0a20 2020  leInputDict".   
+0002b0c0: 2020 2020 2020 2020 2020 2020 2029 0a0a               )..
+0002b0d0: 2020 2020 2020 2020 2020 2020 696e 7465              inte
+0002b0e0: 7271 7561 7274 696c 655f 7261 6e67 655f  rquartile_range_
+0002b0f0: 6469 6374 203d 2073 656c 662e 5f65 7374  dict = self._est
+0002b100: 696d 6174 655f 696e 7465 7271 7561 7274  imate_interquart
+0002b110: 696c 655f 7261 6e67 6528 0a20 2020 2020  ile_range(.     
+0002b120: 2020 2020 2020 2020 2020 2069 6e70 7574             input
+0002b130: 5f64 6963 742c 0a20 2020 2020 2020 2020  _dict,.         
+0002b140: 2020 2020 2020 2063 6f6d 7061 7265 645f         compared_
+0002b150: 6573 7469 6d61 746f 7273 3d63 6f6d 7061  estimators=compa
+0002b160: 7265 645f 6573 7469 6d61 746f 7273 2c0a  red_estimators,.
+0002b170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b180: 616c 7068 613d 616c 7068 612c 0a20 2020  alpha=alpha,.   
+0002b190: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
+0002b1a0: 2020 2020 7265 7475 726e 2069 6e74 6572      return inter
+0002b1b0: 7175 6172 7469 6c65 5f72 616e 6765 5f64  quartile_range_d
+0002b1c0: 6963 740a 0a20 2020 2064 6566 2076 6973  ict..    def vis
+0002b1d0: 7561 6c69 7a65 5f63 756d 756c 6174 6976  ualize_cumulativ
+0002b1e0: 655f 6469 7374 7269 6275 7469 6f6e 5f66  e_distribution_f
+0002b1f0: 756e 6374 696f 6e28 0a20 2020 2020 2020  unction(.       
+0002b200: 2073 656c 662c 0a20 2020 2020 2020 2069   self,.        i
+0002b210: 6e70 7574 5f64 6963 743a 2055 6e69 6f6e  nput_dict: Union
+0002b220: 5b4f 5045 496e 7075 7444 6963 742c 204d  [OPEInputDict, M
+0002b230: 756c 7469 706c 6549 6e70 7574 4469 6374  ultipleInputDict
+0002b240: 5d2c 0a20 2020 2020 2020 2063 6f6d 7061  ],.        compa
+0002b250: 7265 645f 6573 7469 6d61 746f 7273 3a20  red_estimators: 
+0002b260: 4f70 7469 6f6e 616c 5b4c 6973 745b 7374  Optional[List[st
+0002b270: 725d 5d20 3d20 4e6f 6e65 2c0a 2020 2020  r]] = None,.    
+0002b280: 2020 2020 6265 6861 7669 6f72 5f70 6f6c      behavior_pol
+0002b290: 6963 795f 6e61 6d65 3a20 4f70 7469 6f6e  icy_name: Option
+0002b2a0: 616c 5b73 7472 5d20 3d20 4e6f 6e65 2c0a  al[str] = None,.
+0002b2b0: 2020 2020 2020 2020 6461 7461 7365 745f          dataset_
+0002b2c0: 6964 3a20 4f70 7469 6f6e 616c 5b69 6e74  id: Optional[int
+0002b2d0: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
+0002b2e0: 2020 6875 653a 2073 7472 203d 2022 6573    hue: str = "es
+0002b2f0: 7469 6d61 746f 7222 2c0a 2020 2020 2020  timator",.      
+0002b300: 2020 6c65 6765 6e64 3a20 626f 6f6c 203d    legend: bool =
+0002b310: 2054 7275 652c 0a20 2020 2020 2020 206e   True,.        n
+0002b320: 5f63 6f6c 733a 204f 7074 696f 6e61 6c5b  _cols: Optional[
+0002b330: 696e 745d 203d 204e 6f6e 652c 0a20 2020  int] = None,.   
+0002b340: 2020 2020 2066 6967 5f64 6972 3a20 4f70       fig_dir: Op
+0002b350: 7469 6f6e 616c 5b50 6174 685d 203d 204e  tional[Path] = N
+0002b360: 6f6e 652c 0a20 2020 2020 2020 2066 6967  one,.        fig
+0002b370: 5f6e 616d 653a 2073 7472 203d 2022 6573  _name: str = "es
+0002b380: 7469 6d61 7465 645f 6375 6d75 6c61 7469  timated_cumulati
+0002b390: 7665 5f64 6973 7472 6962 7574 696f 6e5f  ve_distribution_
+0002b3a0: 6675 6e63 7469 6f6e 2e70 6e67 222c 0a20  function.png",. 
+0002b3b0: 2020 2029 202d 3e20 4e6f 6e65 3a0a 2020     ) -> None:.  
+0002b3c0: 2020 2020 2020 2222 2256 6973 7561 6c69        """Visuali
+0002b3d0: 7a65 2074 6865 2063 756d 756c 6174 6976  ze the cumulativ
+0002b3e0: 6520 6469 7374 7269 6275 7469 6f6e 2066  e distribution f
+0002b3f0: 756e 6374 696f 6e20 6573 7469 6d61 7465  unction estimate
+0002b400: 6420 6279 204f 5045 2065 7374 696d 6174  d by OPE estimat
+0002b410: 6f72 732e 0a0a 2020 2020 2020 2020 5061  ors...        Pa
+0002b420: 7261 6d65 7465 7273 0a20 2020 2020 2020  rameters.       
+0002b430: 202d 2d2d 2d2d 2d2d 0a20 2020 2020 2020   -------.       
+0002b440: 2069 6e70 7574 5f64 6963 743a 204f 5045   input_dict: OPE
+0002b450: 496e 7075 7444 6963 7420 6f72 204d 756c  InputDict or Mul
+0002b460: 7469 706c 6549 6e70 7574 4469 6374 0a20  tipleInputDict. 
+0002b470: 2020 2020 2020 2020 2020 2044 6963 7469             Dicti
+0002b480: 6f6e 6172 7920 6f66 2074 6865 204f 5045  onary of the OPE
+0002b490: 2069 6e70 7574 7320 666f 7220 6561 6368   inputs for each
+0002b4a0: 2065 7661 6c75 6174 696f 6e20 706f 6c69   evaluation poli
+0002b4b0: 6379 2e0a 0a20 2020 2020 2020 2020 2020  cy...           
+0002b4c0: 202e 2e20 636f 6465 2d62 6c6f 636b 3a3a   .. code-block::
+0002b4d0: 2070 7974 686f 6e0a 0a20 2020 2020 2020   python..       
+0002b4e0: 2020 2020 2020 2020 206b 6579 3a20 5b65           key: [e
+0002b4f0: 7661 6c75 6174 696f 6e5f 706f 6c69 6379  valuation_policy
+0002b500: 5d5b 0a20 2020 2020 2020 2020 2020 2020  ][.             
+0002b510: 2020 2020 2020 2065 7661 6c75 6174 696f         evaluatio
+0002b520: 6e5f 706f 6c69 6379 5f61 6374 696f 6e2c  n_policy_action,
+0002b530: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002b540: 2020 2020 2065 7661 6c75 6174 696f 6e5f       evaluation_
+0002b550: 706f 6c69 6379 5f61 6374 696f 6e5f 6469  policy_action_di
+0002b560: 7374 2c0a 2020 2020 2020 2020 2020 2020  st,.            
+0002b570: 2020 2020 2020 2020 7374 6174 655f 6163          state_ac
+0002b580: 7469 6f6e 5f76 616c 7565 5f70 7265 6469  tion_value_predi
+0002b590: 6374 696f 6e2c 0a20 2020 2020 2020 2020  ction,.         
+0002b5a0: 2020 2020 2020 2020 2020 2069 6e69 7469             initi
+0002b5b0: 616c 5f73 7461 7465 5f76 616c 7565 5f70  al_state_value_p
+0002b5c0: 7265 6469 6374 696f 6e2c 0a20 2020 2020  rediction,.     
+0002b5d0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0002b5e0: 7461 7465 5f61 6374 696f 6e5f 6d61 7267  tate_action_marg
+0002b5f0: 696e 616c 5f69 6d70 6f72 7461 6e63 655f  inal_importance_
+0002b600: 7765 6967 6874 2c0a 2020 2020 2020 2020  weight,.        
+0002b610: 2020 2020 2020 2020 2020 2020 7374 6174              stat
+0002b620: 655f 6d61 7267 696e 616c 5f69 6d70 6f72  e_marginal_impor
+0002b630: 7461 6e63 655f 7765 6967 6874 2c0a 2020  tance_weight,.  
+0002b640: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002b650: 2020 6f6e 5f70 6f6c 6963 795f 706f 6c69    on_policy_poli
+0002b660: 6379 5f76 616c 7565 2c0a 2020 2020 2020  cy_value,.      
+0002b670: 2020 2020 2020 2020 2020 2020 2020 6761                ga
+0002b680: 6d6d 612c 0a20 2020 2020 2020 2020 2020  mma,.           
+0002b690: 2020 2020 2020 2020 2062 6568 6176 696f           behavio
+0002b6a0: 725f 706f 6c69 6379 2c0a 2020 2020 2020  r_policy,.      
+0002b6b0: 2020 2020 2020 2020 2020 2020 2020 6576                ev
+0002b6c0: 616c 7561 7469 6f6e 5f70 6f6c 6963 792c  aluation_policy,
+0002b6d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002b6e0: 2020 2020 2064 6174 6173 6574 5f69 642c       dataset_id,
+0002b6f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002b700: 205d 0a0a 2020 2020 2020 2020 2020 2020   ]..            
+0002b710: 2e2e 2073 6565 616c 736f 3a3a 0a0a 2020  .. seealso::..  
+0002b720: 2020 2020 2020 2020 2020 2020 2020 3a63                :c
+0002b730: 6c61 7373 3a60 7363 6f70 655f 726c 2e6f  lass:`scope_rl.o
+0002b740: 7065 2e69 6e70 7574 2e43 7265 6174 654f  pe.input.CreateO
+0002b750: 5045 496e 7075 7460 2064 6573 6372 6962  PEInput` describ
+0002b760: 6573 2074 6865 2063 6f6d 706f 6e65 6e74  es the component
+0002b770: 7320 6f66 203a 636c 6173 733a 6069 6e70  s of :class:`inp
+0002b780: 7574 5f64 6963 7460 2e0a 0a20 2020 2020  ut_dict`...     
+0002b790: 2020 2063 6f6d 7061 7265 645f 6573 7469     compared_esti
+0002b7a0: 6d61 746f 7273 3a20 6c69 7374 206f 6620  mators: list of 
+0002b7b0: 7374 722c 2064 6566 6175 6c74 3d4e 6f6e  str, default=Non
+0002b7c0: 650a 2020 2020 2020 2020 2020 2020 4e61  e.            Na
+0002b7d0: 6d65 206f 6620 636f 6d70 6172 6564 2065  me of compared e
+0002b7e0: 7374 696d 6174 6f72 732e 0a20 2020 2020  stimators..     
+0002b7f0: 2020 2020 2020 2049 6620 604e 6f6e 6560         If `None`
+0002b800: 2069 7320 6769 7665 6e2c 2061 6c6c 2074   is given, all t
+0002b810: 6865 2065 7374 696d 6174 6f72 7320 6172  he estimators ar
+0002b820: 6520 636f 6d70 6172 6564 2e0a 0a20 2020  e compared...   
+0002b830: 2020 2020 2062 6568 6176 696f 725f 706f       behavior_po
+0002b840: 6c69 6379 5f6e 616d 653a 2073 7472 2c20  licy_name: str, 
+0002b850: 6465 6661 756c 743d 4e6f 6e65 0a20 2020  default=None.   
+0002b860: 2020 2020 2020 2020 204e 616d 6520 6f66           Name of
+0002b870: 2074 6865 2062 6568 6176 696f 7220 706f   the behavior po
+0002b880: 6c69 6379 2e0a 0a20 2020 2020 2020 2064  licy...        d
+0002b890: 6174 6173 6574 5f69 643a 2069 6e74 2c20  ataset_id: int, 
+0002b8a0: 6465 6661 756c 743d 4e6f 6e65 0a20 2020  default=None.   
+0002b8b0: 2020 2020 2020 2020 2049 6420 6f66 2074           Id of t
+0002b8c0: 6865 206c 6f67 6765 6420 6461 7461 7365  he logged datase
+0002b8d0: 742e 0a0a 2020 2020 2020 2020 6875 653a  t...        hue:
+0002b8e0: 207b 2265 7374 696d 6174 6f72 222c 2022   {"estimator", "
+0002b8f0: 706f 6c69 6379 227d 2c20 6465 6661 756c  policy"}, defaul
+0002b900: 743d 2265 7374 696d 6174 6f72 220a 2020  t="estimator".  
+0002b910: 2020 2020 2020 2020 2020 4875 6520 6f66            Hue of
+0002b920: 2074 6865 2070 6c6f 742e 0a0a 2020 2020   the plot...    
+0002b930: 2020 2020 6c65 6765 6e64 3a20 626f 6f6c      legend: bool
+0002b940: 2c20 6465 6661 756c 743d 5472 7565 0a20  , default=True. 
+0002b950: 2020 2020 2020 2020 2020 2057 6865 7468             Wheth
+0002b960: 6572 2074 6f20 696e 636c 7564 6520 6120  er to include a 
+0002b970: 6c65 6765 6e64 2069 6e20 7468 6520 6669  legend in the fi
+0002b980: 6775 7265 2e0a 0a20 2020 2020 2020 206e  gure...        n
+0002b990: 5f63 6f6c 733a 2069 6e74 2c20 6465 6661  _cols: int, defa
+0002b9a0: 756c 743d 4e6f 6e65 0a20 2020 2020 2020  ult=None.       
+0002b9b0: 2020 2020 204e 756d 6265 7220 6f66 2063       Number of c
+0002b9c0: 6f6c 756d 6e73 2069 6e20 7468 6520 6669  olumns in the fi
+0002b9d0: 6775 7265 2e0a 0a20 2020 2020 2020 2066  gure...        f
+0002b9e0: 6967 5f64 6972 3a20 5061 7468 2c20 6465  ig_dir: Path, de
+0002b9f0: 6661 756c 743d 4e6f 6e65 0a20 2020 2020  fault=None.     
+0002ba00: 2020 2020 2020 2050 6174 6820 746f 2073         Path to s
+0002ba10: 746f 7265 2074 6865 2062 6172 2066 6967  tore the bar fig
+0002ba20: 7572 652e 0a20 2020 2020 2020 2020 2020  ure..           
+0002ba30: 2049 6620 604e 6f6e 6560 2069 7320 6769   If `None` is gi
+0002ba40: 7665 6e2c 2074 6865 2066 6967 7572 6520  ven, the figure 
+0002ba50: 7769 6c6c 206e 6f74 2062 6520 7361 7665  will not be save
+0002ba60: 642e 0a0a 2020 2020 2020 2020 6669 675f  d...        fig_
+0002ba70: 6e61 6d65 3a20 7374 722c 2064 6566 6175  name: str, defau
+0002ba80: 6c74 3d22 6573 7469 6d61 7465 645f 6375  lt="estimated_cu
+0002ba90: 6d75 6c61 7469 7665 5f64 6973 7472 6962  mulative_distrib
+0002baa0: 7574 696f 6e5f 6675 6e63 7469 6f6e 2e70  ution_function.p
+0002bab0: 6e67 220a 2020 2020 2020 2020 2020 2020  ng".            
+0002bac0: 4e61 6d65 206f 6620 7468 6520 6261 7220  Name of the bar 
+0002bad0: 6669 6775 7265 2e0a 0a20 2020 2020 2020  figure...       
+0002bae0: 2022 2222 0a20 2020 2020 2020 2063 6f6d   """.        com
+0002baf0: 7061 7265 645f 6573 7469 6d61 746f 7273  pared_estimators
+0002bb00: 203d 2073 656c 662e 5f63 6865 636b 5f63   = self._check_c
+0002bb10: 6f6d 7061 7265 645f 6573 7469 6d61 746f  ompared_estimato
+0002bb20: 7273 2863 6f6d 7061 7265 645f 6573 7469  rs(compared_esti
+0002bb30: 6d61 746f 7273 290a 2020 2020 2020 2020  mators).        
+0002bb40: 7365 6c66 2e5f 6368 6563 6b5f 6261 7369  self._check_basi
+0002bb50: 635f 7669 7375 616c 697a 6174 696f 6e5f  c_visualization_
+0002bb60: 696e 7075 7473 280a 2020 2020 2020 2020  inputs(.        
+0002bb70: 2020 2020 6875 653d 6875 652c 206e 5f63      hue=hue, n_c
+0002bb80: 6f6c 733d 6e5f 636f 6c73 2c20 6669 675f  ols=n_cols, fig_
+0002bb90: 6469 723d 6669 675f 6469 722c 2066 6967  dir=fig_dir, fig
+0002bba0: 5f6e 616d 653d 6669 675f 6e61 6d65 0a20  _name=fig_name. 
+0002bbb0: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+0002bbc0: 2020 6966 2073 656c 662e 7573 655f 6d75    if self.use_mu
+0002bbd0: 6c74 6970 6c65 5f6c 6f67 6765 645f 6461  ltiple_logged_da
+0002bbe0: 7461 7365 743a 0a20 2020 2020 2020 2020  taset:.         
+0002bbf0: 2020 2069 6620 6265 6861 7669 6f72 5f70     if behavior_p
+0002bc00: 6f6c 6963 795f 6e61 6d65 2069 7320 4e6f  olicy_name is No
+0002bc10: 6e65 206f 7220 6461 7461 7365 745f 6964  ne or dataset_id
+0002bc20: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
+0002bc30: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+0002bc40: 5661 6c75 6545 7272 6f72 280a 2020 2020  ValueError(.    
+0002bc50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002bc60: 2262 6568 6176 696f 725f 706f 6c69 6379  "behavior_policy
+0002bc70: 5f6e 616d 6520 616e 6420 6461 7461 7365  _name and datase
+0002bc80: 745f 6964 206d 7573 7420 6265 2073 7065  t_id must be spe
+0002bc90: 6369 6669 6564 2077 6865 6e20 7573 696e  cified when usin
+0002bca0: 6720 4d75 6c74 6970 6c65 4c6f 6767 6564  g MultipleLogged
+0002bcb0: 4461 7461 7365 742e 220a 2020 2020 2020  Dataset.".      
+0002bcc0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+0002bcd0: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+0002bce0: 7461 6e63 6528 696e 7075 745f 6469 6374  tance(input_dict
+0002bcf0: 2c20 4d75 6c74 6970 6c65 496e 7075 7444  , MultipleInputD
+0002bd00: 6963 7429 3a0a 2020 2020 2020 2020 2020  ict):.          
+0002bd10: 2020 2020 2020 696e 7075 745f 6469 6374        input_dict
+0002bd20: 203d 2069 6e70 7574 5f64 6963 742e 6765   = input_dict.ge
+0002bd30: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
+0002bd40: 2020 2020 2020 2062 6568 6176 696f 725f         behavior_
+0002bd50: 706f 6c69 6379 5f6e 616d 653d 6265 6861  policy_name=beha
+0002bd60: 7669 6f72 5f70 6f6c 6963 795f 6e61 6d65  vior_policy_name
+0002bd70: 2c20 6461 7461 7365 745f 6964 3d64 6174  , dataset_id=dat
+0002bd80: 6173 6574 5f69 640a 2020 2020 2020 2020  aset_id.        
+0002bd90: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0002bda0: 2020 6368 6563 6b5f 696e 7075 745f 6469    check_input_di
+0002bdb0: 6374 2869 6e70 7574 5f64 6963 7429 0a0a  ct(input_dict)..
+0002bdc0: 2020 2020 2020 2020 6375 6d75 6c61 7469          cumulati
+0002bdd0: 7665 5f64 6973 7472 6962 7574 696f 6e5f  ve_distribution_
+0002bde0: 6675 6e63 7469 6f6e 5f64 6963 7420 3d20  function_dict = 
+0002bdf0: 280a 2020 2020 2020 2020 2020 2020 7365  (.            se
+0002be00: 6c66 2e65 7374 696d 6174 655f 6375 6d75  lf.estimate_cumu
+0002be10: 6c61 7469 7665 5f64 6973 7472 6962 7574  lative_distribut
+0002be20: 696f 6e5f 6675 6e63 7469 6f6e 280a 2020  ion_function(.  
+0002be30: 2020 2020 2020 2020 2020 2020 2020 696e                in
+0002be40: 7075 745f 6469 6374 2c0a 2020 2020 2020  put_dict,.      
+0002be50: 2020 2020 2020 2020 2020 636f 6d70 6172            compar
+0002be60: 6564 5f65 7374 696d 6174 6f72 733d 636f  ed_estimators=co
+0002be70: 6d70 6172 6564 5f65 7374 696d 6174 6f72  mpared_estimator
+0002be80: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
+0002be90: 2020 2062 6568 6176 696f 725f 706f 6c69     behavior_poli
+0002bea0: 6379 5f6e 616d 653d 6265 6861 7669 6f72  cy_name=behavior
+0002beb0: 5f70 6f6c 6963 795f 6e61 6d65 2c0a 2020  _policy_name,.  
+0002bec0: 2020 2020 2020 2020 2020 2020 2020 6461                da
+0002bed0: 7461 7365 745f 6964 3d64 6174 6173 6574  taset_id=dataset
+0002bee0: 5f69 642c 0a20 2020 2020 2020 2020 2020  _id,.           
+0002bef0: 2029 0a20 2020 2020 2020 2029 0a20 2020   ).        ).   
+0002bf00: 2020 2020 2072 6577 6172 645f 7363 616c       reward_scal
+0002bf10: 6520 3d20 7365 6c66 2e6f 6274 6169 6e5f  e = self.obtain_
+0002bf20: 7265 7761 7264 5f73 6361 6c65 2829 0a0a  reward_scale()..
+0002bf30: 2020 2020 2020 2020 706c 742e 7374 796c          plt.styl
+0002bf40: 652e 7573 6528 2267 6770 6c6f 7422 290a  e.use("ggplot").
+0002bf50: 0a20 2020 2020 2020 2069 6620 6875 6520  .        if hue 
+0002bf60: 3d3d 2022 6573 7469 6d61 746f 7222 3a0a  == "estimator":.
+0002bf70: 2020 2020 2020 2020 2020 2020 6e5f 6669              n_fi
+0002bf80: 6773 203d 206c 656e 2869 6e70 7574 5f64  gs = len(input_d
+0002bf90: 6963 7429 0a20 2020 2020 2020 2020 2020  ict).           
+0002bfa0: 206e 5f63 6f6c 7320 3d20 6d69 6e28 332c   n_cols = min(3,
+0002bfb0: 206e 5f66 6967 7329 2069 6620 6e5f 636f   n_figs) if n_co
+0002bfc0: 6c73 2069 7320 4e6f 6e65 2065 6c73 6520  ls is None else 
+0002bfd0: 6e5f 636f 6c73 0a20 2020 2020 2020 2020  n_cols.         
+0002bfe0: 2020 206e 5f72 6f77 7320 3d20 286e 5f66     n_rows = (n_f
+0002bff0: 6967 7320 2d20 3129 202f 2f20 6e5f 636f  igs - 1) // n_co
+0002c000: 6c73 202b 2031 0a0a 2020 2020 2020 2020  ls + 1..        
+0002c010: 2020 2020 6669 672c 2061 7865 7320 3d20      fig, axes = 
+0002c020: 706c 742e 7375 6270 6c6f 7473 280a 2020  plt.subplots(.  
+0002c030: 2020 2020 2020 2020 2020 2020 2020 6e72                nr
+0002c040: 6f77 733d 6e5f 726f 7773 2c20 6e63 6f6c  ows=n_rows, ncol
+0002c050: 733d 6e5f 636f 6c73 2c20 6669 6773 697a  s=n_cols, figsiz
+0002c060: 653d 2836 202a 206e 5f63 6f6c 732c 2034  e=(6 * n_cols, 4
+0002c070: 202a 206e 5f72 6f77 7329 0a20 2020 2020   * n_rows).     
+0002c080: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+0002c090: 2020 2020 2020 6966 206e 5f72 6f77 7320        if n_rows 
+0002c0a0: 3d3d 2031 3a0a 2020 2020 2020 2020 2020  == 1:.          
+0002c0b0: 2020 2020 2020 666f 7220 692c 2065 7661        for i, eva
+0002c0c0: 6c5f 706f 6c69 6379 2069 6e20 656e 756d  l_policy in enum
+0002c0d0: 6572 6174 6528 696e 7075 745f 6469 6374  erate(input_dict
+0002c0e0: 2e6b 6579 7328 2929 3a0a 2020 2020 2020  .keys()):.      
+0002c0f0: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+0002c100: 7220 6a2c 2065 7374 696d 6174 6f72 2069  r j, estimator i
+0002c110: 6e20 656e 756d 6572 6174 6528 636f 6d70  n enumerate(comp
+0002c120: 6172 6564 5f65 7374 696d 6174 6f72 7329  ared_estimators)
+0002c130: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0002c140: 2020 2020 2020 2020 2020 6178 6573 5b69            axes[i
+0002c150: 5d2e 706c 6f74 280a 2020 2020 2020 2020  ].plot(.        
+0002c160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c170: 2020 2020 7265 7761 7264 5f73 6361 6c65      reward_scale
+0002c180: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0002c190: 2020 2020 2020 2020 2020 2020 2020 6375                cu
+0002c1a0: 6d75 6c61 7469 7665 5f64 6973 7472 6962  mulative_distrib
+0002c1b0: 7574 696f 6e5f 6675 6e63 7469 6f6e 5f64  ution_function_d
+0002c1c0: 6963 745b 6576 616c 5f70 6f6c 6963 795d  ict[eval_policy]
+0002c1d0: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
+0002c1e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c1f0: 2020 6573 7469 6d61 746f 720a 2020 2020    estimator.    
+0002c200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c210: 2020 2020 2020 2020 5d2c 0a20 2020 2020          ],.     
+0002c220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c230: 2020 2020 2020 206c 6162 656c 3d65 7374         label=est
+0002c240: 696d 6174 6f72 2c0a 2020 2020 2020 2020  imator,.        
+0002c250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c260: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
+0002c270: 2020 2020 2020 2069 6620 696e 7075 745f         if input_
+0002c280: 6469 6374 5b65 7661 6c5f 706f 6c69 6379  dict[eval_policy
+0002c290: 5d5b 226f 6e5f 706f 6c69 6379 5f70 6f6c  ]["on_policy_pol
+0002c2a0: 6963 795f 7661 6c75 6522 5d20 6973 206e  icy_value"] is n
+0002c2b0: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
+0002c2c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c2d0: 2061 7865 735b 695d 2e70 6c6f 7428 0a20   axes[i].plot(. 
+0002c2e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c2f0: 2020 2020 2020 2020 2020 2072 6577 6172             rewar
+0002c300: 645f 7363 616c 652c 0a20 2020 2020 2020  d_scale,.       
+0002c310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c320: 2020 2020 2063 756d 756c 6174 6976 655f       cumulative_
+0002c330: 6469 7374 7269 6275 7469 6f6e 5f66 756e  distribution_fun
+0002c340: 6374 696f 6e5f 6469 6374 5b65 7661 6c5f  ction_dict[eval_
+0002c350: 706f 6c69 6379 5d5b 0a20 2020 2020 2020  policy][.       
+0002c360: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c370: 2020 2020 2020 2020 2022 6f6e 5f70 6f6c           "on_pol
+0002c380: 6963 7922 0a20 2020 2020 2020 2020 2020  icy".           
 0002c390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c3a0: 2020 2020 2061 7865 735b 695d 2e70 6c6f       axes[i].plo
-0002c3b0: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
-0002c3c0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0002c3d0: 6577 6172 645f 7363 616c 652c 0a20 2020  eward_scale,.   
-0002c3e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c3f0: 2020 2020 2020 2020 2063 756d 756c 6174           cumulat
-0002c400: 6976 655f 6469 7374 7269 6275 7469 6f6e  ive_distribution
-0002c410: 5f66 756e 6374 696f 6e5f 6469 6374 5b65  _function_dict[e
-0002c420: 7661 6c5f 706f 6c69 6379 5d5b 0a20 2020  val_policy][.   
-0002c430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c440: 2020 2020 2020 2020 2020 2020 2022 6f6e               "on
-0002c450: 5f70 6f6c 6963 7922 0a20 2020 2020 2020  _policy".       
-0002c460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c470: 2020 2020 205d 2c0a 2020 2020 2020 2020       ],.        
-0002c480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c490: 2020 2020 6c61 6265 6c3d 226f 6e5f 706f      label="on_po
-0002c4a0: 6c69 6379 222c 0a20 2020 2020 2020 2020  licy",.         
-0002c4b0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-0002c4c0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0002c4d0: 2020 2020 2020 6178 6573 5b69 5d2e 7365        axes[i].se
-0002c4e0: 745f 7469 746c 6528 6576 616c 5f70 6f6c  t_title(eval_pol
-0002c4f0: 6963 7929 0a20 2020 2020 2020 2020 2020  icy).           
-0002c500: 2020 2020 2020 2020 2061 7865 735b 695d           axes[i]
-0002c510: 2e73 6574 5f78 6c61 6265 6c28 2274 7261  .set_xlabel("tra
-0002c520: 6a65 6374 6f72 792d 7769 7365 2072 6577  jectory-wise rew
-0002c530: 6172 6422 290a 2020 2020 2020 2020 2020  ard").          
-0002c540: 2020 2020 2020 2020 2020 6178 6573 5b69            axes[i
-0002c550: 5d2e 7365 745f 796c 6162 656c 2822 6375  ].set_ylabel("cu
-0002c560: 6d75 6c61 7469 7665 2070 726f 6261 6269  mulative probabi
-0002c570: 6c69 7479 2229 0a20 2020 2020 2020 2020  lity").         
-0002c580: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
-0002c590: 6765 6e64 3a0a 2020 2020 2020 2020 2020  gend:.          
-0002c5a0: 2020 2020 2020 2020 2020 2020 2020 6178                ax
-0002c5b0: 6573 5b69 5d2e 6c65 6765 6e64 2829 0a0a  es[i].legend()..
-0002c5c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c5d0: 6966 206c 6567 656e 643a 0a20 2020 2020  if legend:.     
-0002c5e0: 2020 2020 2020 2020 2020 2020 2020 2068                 h
-0002c5f0: 616e 646c 6573 2c20 6c61 6265 6c73 203d  andles, labels =
-0002c600: 2061 7865 735b 305d 2e67 6574 5f6c 6567   axes[0].get_leg
-0002c610: 656e 645f 6861 6e64 6c65 735f 6c61 6265  end_handles_labe
-0002c620: 6c73 2829 0a20 2020 2020 2020 2020 2020  ls().           
-0002c630: 2020 2020 2020 2020 2023 206e 5f63 6f6c           # n_col
-0002c640: 7320 7368 6f77 7320 6572 720a 2020 2020  s shows err.    
+0002c3a0: 205d 2c0a 2020 2020 2020 2020 2020 2020   ],.            
+0002c3b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c3c0: 6c61 6265 6c3d 226f 6e5f 706f 6c69 6379  label="on_policy
+0002c3d0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+0002c3e0: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
+0002c3f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c400: 2020 6178 6573 5b69 5d2e 7365 745f 7469    axes[i].set_ti
+0002c410: 746c 6528 6576 616c 5f70 6f6c 6963 7929  tle(eval_policy)
+0002c420: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002c430: 2020 2020 2061 7865 735b 695d 2e73 6574       axes[i].set
+0002c440: 5f78 6c61 6265 6c28 2274 7261 6a65 6374  _xlabel("traject
+0002c450: 6f72 792d 7769 7365 2072 6577 6172 6422  ory-wise reward"
+0002c460: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0002c470: 2020 2020 2020 6178 6573 5b69 5d2e 7365        axes[i].se
+0002c480: 745f 796c 6162 656c 2822 6375 6d75 6c61  t_ylabel("cumula
+0002c490: 7469 7665 2070 726f 6261 6269 6c69 7479  tive probability
+0002c4a0: 2229 0a20 2020 2020 2020 2020 2020 2020  ").             
+0002c4b0: 2020 2020 2020 2069 6620 6c65 6765 6e64         if legend
+0002c4c0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0002c4d0: 2020 2020 2020 2020 2020 6178 6573 5b69            axes[i
+0002c4e0: 5d2e 6c65 6765 6e64 2829 0a0a 2020 2020  ].legend()..    
+0002c4f0: 2020 2020 2020 2020 2020 2020 6966 206c              if l
+0002c500: 6567 656e 643a 0a20 2020 2020 2020 2020  egend:.         
+0002c510: 2020 2020 2020 2020 2020 2068 616e 646c             handl
+0002c520: 6573 2c20 6c61 6265 6c73 203d 2061 7865  es, labels = axe
+0002c530: 735b 305d 2e67 6574 5f6c 6567 656e 645f  s[0].get_legend_
+0002c540: 6861 6e64 6c65 735f 6c61 6265 6c73 2829  handles_labels()
+0002c550: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002c560: 2020 2020 2023 206e 5f63 6f6c 7320 7368       # n_cols sh
+0002c570: 6f77 7320 6572 720a 2020 2020 2020 2020  ows err.        
+0002c580: 2020 2020 2020 2020 2020 2020 2320 6669              # fi
+0002c590: 672e 6c65 6765 6e64 2868 616e 646c 6573  g.legend(handles
+0002c5a0: 2c20 6c61 6265 6c73 2c20 6c6f 633d 2775  , labels, loc='u
+0002c5b0: 7070 6572 2063 656e 7465 7227 2c20 6262  pper center', bb
+0002c5c0: 6f78 5f74 6f5f 616e 6368 6f72 3d28 302e  ox_to_anchor=(0.
+0002c5d0: 352c 202d 302e 3129 2c20 6e5f 636f 6c73  5, -0.1), n_cols
+0002c5e0: 3d6d 696e 286c 656e 286c 6162 656c 7329  =min(len(labels)
+0002c5f0: 2c20 3629 290a 0a20 2020 2020 2020 2020  , 6))..         
+0002c600: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0002c610: 2020 2020 2020 2020 2066 6f72 2069 2c20           for i, 
+0002c620: 6576 616c 5f70 6f6c 6963 7920 696e 2065  eval_policy in e
+0002c630: 6e75 6d65 7261 7465 2869 6e70 7574 5f64  numerate(input_d
+0002c640: 6963 742e 6b65 7973 2829 293a 0a20 2020  ict.keys()):.   
 0002c650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c660: 2320 6669 672e 6c65 6765 6e64 2868 616e  # fig.legend(han
-0002c670: 646c 6573 2c20 6c61 6265 6c73 2c20 6c6f  dles, labels, lo
-0002c680: 633d 2775 7070 6572 2063 656e 7465 7227  c='upper center'
-0002c690: 2c20 6262 6f78 5f74 6f5f 616e 6368 6f72  , bbox_to_anchor
-0002c6a0: 3d28 302e 352c 202d 302e 3129 2c20 6e5f  =(0.5, -0.1), n_
-0002c6b0: 636f 6c73 3d6d 696e 286c 656e 286c 6162  cols=min(len(lab
-0002c6c0: 656c 7329 2c20 3629 290a 0a20 2020 2020  els), 6))..     
-0002c6d0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-0002c6e0: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-0002c6f0: 2069 2c20 6576 616c 5f70 6f6c 6963 7920   i, eval_policy 
-0002c700: 696e 2065 6e75 6d65 7261 7465 2869 6e70  in enumerate(inp
-0002c710: 7574 5f64 6963 742e 6b65 7973 2829 293a  ut_dict.keys()):
-0002c720: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002c730: 2020 2020 2066 6f72 206a 2c20 6573 7469       for j, esti
-0002c740: 6d61 746f 7220 696e 2065 6e75 6d65 7261  mator in enumera
-0002c750: 7465 2863 6f6d 7061 7265 645f 6573 7469  te(compared_esti
-0002c760: 6d61 746f 7273 293a 0a20 2020 2020 2020  mators):.       
-0002c770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c780: 2061 7865 735b 6920 2f2f 206e 5f63 6f6c   axes[i // n_col
-0002c790: 732c 2069 2025 206e 5f63 6f6c 735d 2e70  s, i % n_cols].p
-0002c7a0: 6c6f 7428 0a20 2020 2020 2020 2020 2020  lot(.           
-0002c7b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c7c0: 2072 6577 6172 645f 7363 616c 652c 0a20   reward_scale,. 
-0002c7d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c7e0: 2020 2020 2020 2020 2020 2063 756d 756c             cumul
-0002c7f0: 6174 6976 655f 6469 7374 7269 6275 7469  ative_distributi
-0002c800: 6f6e 5f66 756e 6374 696f 6e5f 6469 6374  on_function_dict
-0002c810: 5b65 7661 6c5f 706f 6c69 6379 5d5b 0a20  [eval_policy][. 
-0002c820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c830: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0002c840: 7374 696d 6174 6f72 0a20 2020 2020 2020  stimator.       
-0002c850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c860: 2020 2020 205d 2c0a 2020 2020 2020 2020       ],.        
+0002c660: 2066 6f72 206a 2c20 6573 7469 6d61 746f   for j, estimato
+0002c670: 7220 696e 2065 6e75 6d65 7261 7465 2863  r in enumerate(c
+0002c680: 6f6d 7061 7265 645f 6573 7469 6d61 746f  ompared_estimato
+0002c690: 7273 293a 0a20 2020 2020 2020 2020 2020  rs):.           
+0002c6a0: 2020 2020 2020 2020 2020 2020 2061 7865               axe
+0002c6b0: 735b 6920 2f2f 206e 5f63 6f6c 732c 2069  s[i // n_cols, i
+0002c6c0: 2025 206e 5f63 6f6c 735d 2e70 6c6f 7428   % n_cols].plot(
+0002c6d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002c6e0: 2020 2020 2020 2020 2020 2020 2072 6577               rew
+0002c6f0: 6172 645f 7363 616c 652c 0a20 2020 2020  ard_scale,.     
+0002c700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c710: 2020 2020 2020 2063 756d 756c 6174 6976         cumulativ
+0002c720: 655f 6469 7374 7269 6275 7469 6f6e 5f66  e_distribution_f
+0002c730: 756e 6374 696f 6e5f 6469 6374 5b65 7661  unction_dict[eva
+0002c740: 6c5f 706f 6c69 6379 5d5b 0a20 2020 2020  l_policy][.     
+0002c750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c760: 2020 2020 2020 2020 2020 2065 7374 696d             estim
+0002c770: 6174 6f72 0a20 2020 2020 2020 2020 2020  ator.           
+0002c780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c790: 205d 2c0a 2020 2020 2020 2020 2020 2020   ],.            
+0002c7a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c7b0: 6c61 6265 6c3d 6573 7469 6d61 746f 722c  label=estimator,
+0002c7c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002c7d0: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
+0002c7e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c7f0: 6966 2069 6e70 7574 5f64 6963 745b 6576  if input_dict[ev
+0002c800: 616c 5f70 6f6c 6963 795d 5b22 6f6e 5f70  al_policy]["on_p
+0002c810: 6f6c 6963 795f 706f 6c69 6379 5f76 616c  olicy_policy_val
+0002c820: 7565 225d 2069 7320 6e6f 7420 4e6f 6e65  ue"] is not None
+0002c830: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0002c840: 2020 2020 2020 2020 2020 6178 6573 5b69            axes[i
+0002c850: 202f 2f20 6e5f 636f 6c73 2c20 6920 2520   // n_cols, i % 
+0002c860: 6e5f 636f 6c73 5d2e 706c 6f74 280a 2020  n_cols].plot(.  
 0002c870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c880: 2020 2020 6c61 6265 6c3d 6573 7469 6d61      label=estima
-0002c890: 746f 722c 0a20 2020 2020 2020 2020 2020  tor,.           
-0002c8a0: 2020 2020 2020 2020 2020 2020 2029 0a0a               )..
-0002c8b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c8c0: 2020 2020 6966 2069 6e70 7574 5f64 6963      if input_dic
-0002c8d0: 745b 6576 616c 5f70 6f6c 6963 795d 5b22  t[eval_policy]["
-0002c8e0: 6f6e 5f70 6f6c 6963 795f 706f 6c69 6379  on_policy_policy
-0002c8f0: 5f76 616c 7565 225d 2069 7320 6e6f 7420  _value"] is not 
-0002c900: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-0002c910: 2020 2020 2020 2020 2020 2020 2020 6178                ax
-0002c920: 6573 5b69 202f 2f20 6e5f 636f 6c73 2c20  es[i // n_cols, 
-0002c930: 6920 2520 6e5f 636f 6c73 5d2e 706c 6f74  i % n_cols].plot
-0002c940: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0002c950: 2020 2020 2020 2020 2020 2020 2020 7265                re
-0002c960: 7761 7264 5f73 6361 6c65 2c0a 2020 2020  ward_scale,.    
-0002c970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c980: 2020 2020 2020 2020 6375 6d75 6c61 7469          cumulati
-0002c990: 7665 5f64 6973 7472 6962 7574 696f 6e5f  ve_distribution_
-0002c9a0: 6675 6e63 7469 6f6e 5f64 6963 745b 6576  function_dict[ev
-0002c9b0: 616c 5f70 6f6c 6963 795d 5b0a 2020 2020  al_policy][.    
-0002c9c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c9d0: 2020 2020 2020 2020 2020 2020 226f 6e5f              "on_
-0002c9e0: 706f 6c69 6379 220a 2020 2020 2020 2020  policy".        
-0002c9f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ca00: 2020 2020 5d2c 0a20 2020 2020 2020 2020      ],.         
-0002ca10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ca20: 2020 206c 6162 656c 3d22 6f6e 5f70 6f6c     label="on_pol
-0002ca30: 6963 7922 2c0a 2020 2020 2020 2020 2020  icy",.          
-0002ca40: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-0002ca50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002ca60: 2020 2020 2061 7865 735b 6920 2f2f 206e       axes[i // n
-0002ca70: 5f63 6f6c 732c 2069 2025 206e 5f63 6f6c  _cols, i % n_col
-0002ca80: 735d 2e73 6574 5f74 6974 6c65 2865 7661  s].set_title(eva
-0002ca90: 6c5f 706f 6c69 6379 290a 2020 2020 2020  l_policy).      
-0002caa0: 2020 2020 2020 2020 2020 2020 2020 6178                ax
-0002cab0: 6573 5b69 202f 2f20 6e5f 636f 6c73 2c20  es[i // n_cols, 
-0002cac0: 6920 2520 6e5f 636f 6c73 5d2e 7365 745f  i % n_cols].set_
-0002cad0: 786c 6162 656c 2822 7472 616a 6563 746f  xlabel("trajecto
-0002cae0: 7279 2d77 6973 6520 7265 7761 7264 2229  ry-wise reward")
-0002caf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002cb00: 2020 2020 2061 7865 735b 6920 2f2f 206e       axes[i // n
-0002cb10: 5f63 6f6c 732c 2069 2025 206e 5f63 6f6c  _cols, i % n_col
-0002cb20: 735d 2e73 6574 5f79 6c61 6265 6c28 2263  s].set_ylabel("c
-0002cb30: 756d 756c 6174 6976 6520 7072 6f62 6162  umulative probab
-0002cb40: 696c 6974 7922 290a 2020 2020 2020 2020  ility").        
-0002cb50: 2020 2020 2020 2020 2020 2020 6966 206c              if l
-0002cb60: 6567 656e 643a 0a20 2020 2020 2020 2020  egend:.         
-0002cb70: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-0002cb80: 7865 735b 6920 2f2f 206e 5f63 6f6c 732c  xes[i // n_cols,
-0002cb90: 2069 2025 206e 5f63 6f6c 735d 2e6c 6567   i % n_cols].leg
-0002cba0: 656e 6428 290a 0a20 2020 2020 2020 2020  end()..         
-0002cbb0: 2020 2020 2020 2069 6620 6c65 6765 6e64         if legend
-0002cbc0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0002cbd0: 2020 2020 2020 6861 6e64 6c65 732c 206c        handles, l
-0002cbe0: 6162 656c 7320 3d20 6178 6573 5b30 2c20  abels = axes[0, 
-0002cbf0: 305d 2e67 6574 5f6c 6567 656e 645f 6861  0].get_legend_ha
-0002cc00: 6e64 6c65 735f 6c61 6265 6c73 2829 0a20  ndles_labels(). 
-0002cc10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002cc20: 2020 2023 206e 5f63 6f6c 7320 7368 6f77     # n_cols show
-0002cc30: 7320 6572 720a 2020 2020 2020 2020 2020  s err.          
-0002cc40: 2020 2020 2020 2020 2020 2320 6669 672e            # fig.
-0002cc50: 6c65 6765 6e64 2868 616e 646c 6573 2c20  legend(handles, 
-0002cc60: 6c61 6265 6c73 2c20 6c6f 633d 2775 7070  labels, loc='upp
-0002cc70: 6572 2063 656e 7465 7227 2c20 6262 6f78  er center', bbox
-0002cc80: 5f74 6f5f 616e 6368 6f72 3d28 302e 352c  _to_anchor=(0.5,
-0002cc90: 202d 302e 3129 2c20 6e5f 636f 6c73 3d6d   -0.1), n_cols=m
-0002cca0: 696e 286c 656e 286c 6162 656c 7329 2c20  in(len(labels), 
-0002ccb0: 3629 290a 0a20 2020 2020 2020 2065 6c73  6))..        els
-0002ccc0: 653a 0a20 2020 2020 2020 2020 2020 2076  e:.            v
-0002ccd0: 6973 7561 6c69 7a65 5f6f 6e5f 706f 6c69  isualize_on_poli
-0002cce0: 6379 203d 2054 7275 650a 2020 2020 2020  cy = True.      
-0002ccf0: 2020 2020 2020 666f 7220 6576 616c 5f70        for eval_p
-0002cd00: 6f6c 6963 7920 696e 2069 6e70 7574 5f64  olicy in input_d
-0002cd10: 6963 742e 6b65 7973 2829 3a0a 2020 2020  ict.keys():.    
-0002cd20: 2020 2020 2020 2020 2020 2020 6966 2069              if i
-0002cd30: 6e70 7574 5f64 6963 745b 6576 616c 5f70  nput_dict[eval_p
-0002cd40: 6f6c 6963 795d 5b22 6f6e 5f70 6f6c 6963  olicy]["on_polic
-0002cd50: 795f 706f 6c69 6379 5f76 616c 7565 225d  y_policy_value"]
-0002cd60: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
-0002cd70: 2020 2020 2020 2020 2020 2020 2020 7669                vi
-0002cd80: 7375 616c 697a 655f 6f6e 5f70 6f6c 6963  sualize_on_polic
-0002cd90: 7920 3d20 4661 6c73 650a 0a20 2020 2020  y = False..     
-0002cda0: 2020 2020 2020 206e 5f66 6967 7320 3d20         n_figs = 
-0002cdb0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0002cdc0: 2020 6c65 6e28 636f 6d70 6172 6564 5f65    len(compared_e
-0002cdd0: 7374 696d 6174 6f72 7329 202b 2031 0a20  stimators) + 1. 
-0002cde0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0002cdf0: 6620 7669 7375 616c 697a 655f 6f6e 5f70  f visualize_on_p
-0002ce00: 6f6c 6963 790a 2020 2020 2020 2020 2020  olicy.          
-0002ce10: 2020 2020 2020 656c 7365 206c 656e 2863        else len(c
-0002ce20: 6f6d 7061 7265 645f 6573 7469 6d61 746f  ompared_estimato
-0002ce30: 7273 290a 2020 2020 2020 2020 2020 2020  rs).            
-0002ce40: 290a 2020 2020 2020 2020 2020 2020 6e5f  ).            n_
-0002ce50: 636f 6c73 203d 206d 696e 2833 2c20 6e5f  cols = min(3, n_
-0002ce60: 6669 6773 2920 6966 206e 5f63 6f6c 7320  figs) if n_cols 
-0002ce70: 6973 204e 6f6e 6520 656c 7365 206e 5f63  is None else n_c
-0002ce80: 6f6c 730a 2020 2020 2020 2020 2020 2020  ols.            
-0002ce90: 6e5f 726f 7773 203d 2028 6e5f 6669 6773  n_rows = (n_figs
-0002cea0: 202d 2031 2920 2f2f 206e 5f63 6f6c 7320   - 1) // n_cols 
-0002ceb0: 2b20 310a 0a20 2020 2020 2020 2020 2020  + 1..           
-0002cec0: 2066 6967 2c20 6178 6573 203d 2070 6c74   fig, axes = plt
-0002ced0: 2e73 7562 706c 6f74 7328 0a20 2020 2020  .subplots(.     
-0002cee0: 2020 2020 2020 2020 2020 206e 726f 7773             nrows
-0002cef0: 3d6e 5f72 6f77 732c 206e 636f 6c73 3d6e  =n_rows, ncols=n
-0002cf00: 5f63 6f6c 732c 2066 6967 7369 7a65 3d28  _cols, figsize=(
-0002cf10: 3620 2a20 6e5f 636f 6c73 2c20 3420 2a20  6 * n_cols, 4 * 
-0002cf20: 6e5f 726f 7773 290a 2020 2020 2020 2020  n_rows).        
-0002cf30: 2020 2020 290a 0a20 2020 2020 2020 2020      )..         
-0002cf40: 2020 2069 6620 6e5f 726f 7773 203d 3d20     if n_rows == 
-0002cf50: 313a 0a20 2020 2020 2020 2020 2020 2020  1:.             
-0002cf60: 2020 2066 6f72 2069 2c20 6573 7469 6d61     for i, estima
-0002cf70: 746f 7220 696e 2065 6e75 6d65 7261 7465  tor in enumerate
-0002cf80: 2863 6f6d 7061 7265 645f 6573 7469 6d61  (compared_estima
-0002cf90: 746f 7273 293a 0a20 2020 2020 2020 2020  tors):.         
-0002cfa0: 2020 2020 2020 2020 2020 2066 6f72 206a             for j
-0002cfb0: 2c20 6576 616c 5f70 6f6c 6963 7920 696e  , eval_policy in
-0002cfc0: 2065 6e75 6d65 7261 7465 2869 6e70 7574   enumerate(input
-0002cfd0: 5f64 6963 742e 6b65 7973 2829 293a 0a20  _dict.keys()):. 
+0002c880: 2020 2020 2020 2020 2020 7265 7761 7264            reward
+0002c890: 5f73 6361 6c65 2c0a 2020 2020 2020 2020  _scale,.        
+0002c8a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c8b0: 2020 2020 6375 6d75 6c61 7469 7665 5f64      cumulative_d
+0002c8c0: 6973 7472 6962 7574 696f 6e5f 6675 6e63  istribution_func
+0002c8d0: 7469 6f6e 5f64 6963 745b 6576 616c 5f70  tion_dict[eval_p
+0002c8e0: 6f6c 6963 795d 5b0a 2020 2020 2020 2020  olicy][.        
+0002c8f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c900: 2020 2020 2020 2020 226f 6e5f 706f 6c69          "on_poli
+0002c910: 6379 220a 2020 2020 2020 2020 2020 2020  cy".            
+0002c920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c930: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+0002c940: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+0002c950: 6162 656c 3d22 6f6e 5f70 6f6c 6963 7922  abel="on_policy"
+0002c960: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0002c970: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+0002c980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c990: 2061 7865 735b 6920 2f2f 206e 5f63 6f6c   axes[i // n_col
+0002c9a0: 732c 2069 2025 206e 5f63 6f6c 735d 2e73  s, i % n_cols].s
+0002c9b0: 6574 5f74 6974 6c65 2865 7661 6c5f 706f  et_title(eval_po
+0002c9c0: 6c69 6379 290a 2020 2020 2020 2020 2020  licy).          
+0002c9d0: 2020 2020 2020 2020 2020 6178 6573 5b69            axes[i
+0002c9e0: 202f 2f20 6e5f 636f 6c73 2c20 6920 2520   // n_cols, i % 
+0002c9f0: 6e5f 636f 6c73 5d2e 7365 745f 786c 6162  n_cols].set_xlab
+0002ca00: 656c 2822 7472 616a 6563 746f 7279 2d77  el("trajectory-w
+0002ca10: 6973 6520 7265 7761 7264 2229 0a20 2020  ise reward").   
+0002ca20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ca30: 2061 7865 735b 6920 2f2f 206e 5f63 6f6c   axes[i // n_col
+0002ca40: 732c 2069 2025 206e 5f63 6f6c 735d 2e73  s, i % n_cols].s
+0002ca50: 6574 5f79 6c61 6265 6c28 2263 756d 756c  et_ylabel("cumul
+0002ca60: 6174 6976 6520 7072 6f62 6162 696c 6974  ative probabilit
+0002ca70: 7922 290a 2020 2020 2020 2020 2020 2020  y").            
+0002ca80: 2020 2020 2020 2020 6966 206c 6567 656e          if legen
+0002ca90: 643a 0a20 2020 2020 2020 2020 2020 2020  d:.             
+0002caa0: 2020 2020 2020 2020 2020 2061 7865 735b             axes[
+0002cab0: 6920 2f2f 206e 5f63 6f6c 732c 2069 2025  i // n_cols, i %
+0002cac0: 206e 5f63 6f6c 735d 2e6c 6567 656e 6428   n_cols].legend(
+0002cad0: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
+0002cae0: 2020 2069 6620 6c65 6765 6e64 3a0a 2020     if legend:.  
+0002caf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cb00: 2020 6861 6e64 6c65 732c 206c 6162 656c    handles, label
+0002cb10: 7320 3d20 6178 6573 5b30 2c20 305d 2e67  s = axes[0, 0].g
+0002cb20: 6574 5f6c 6567 656e 645f 6861 6e64 6c65  et_legend_handle
+0002cb30: 735f 6c61 6265 6c73 2829 0a20 2020 2020  s_labels().     
+0002cb40: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+0002cb50: 206e 5f63 6f6c 7320 7368 6f77 7320 6572   n_cols shows er
+0002cb60: 720a 2020 2020 2020 2020 2020 2020 2020  r.              
+0002cb70: 2020 2020 2020 2320 6669 672e 6c65 6765        # fig.lege
+0002cb80: 6e64 2868 616e 646c 6573 2c20 6c61 6265  nd(handles, labe
+0002cb90: 6c73 2c20 6c6f 633d 2775 7070 6572 2063  ls, loc='upper c
+0002cba0: 656e 7465 7227 2c20 6262 6f78 5f74 6f5f  enter', bbox_to_
+0002cbb0: 616e 6368 6f72 3d28 302e 352c 202d 302e  anchor=(0.5, -0.
+0002cbc0: 3129 2c20 6e5f 636f 6c73 3d6d 696e 286c  1), n_cols=min(l
+0002cbd0: 656e 286c 6162 656c 7329 2c20 3629 290a  en(labels), 6)).
+0002cbe0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+0002cbf0: 2020 2020 2020 2020 2020 2076 6973 7561             visua
+0002cc00: 6c69 7a65 5f6f 6e5f 706f 6c69 6379 203d  lize_on_policy =
+0002cc10: 2054 7275 650a 2020 2020 2020 2020 2020   True.          
+0002cc20: 2020 666f 7220 6576 616c 5f70 6f6c 6963    for eval_polic
+0002cc30: 7920 696e 2069 6e70 7574 5f64 6963 742e  y in input_dict.
+0002cc40: 6b65 7973 2829 3a0a 2020 2020 2020 2020  keys():.        
+0002cc50: 2020 2020 2020 2020 6966 2069 6e70 7574          if input
+0002cc60: 5f64 6963 745b 6576 616c 5f70 6f6c 6963  _dict[eval_polic
+0002cc70: 795d 5b22 6f6e 5f70 6f6c 6963 795f 706f  y]["on_policy_po
+0002cc80: 6c69 6379 5f76 616c 7565 225d 2069 7320  licy_value"] is 
+0002cc90: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+0002cca0: 2020 2020 2020 2020 2020 7669 7375 616c            visual
+0002ccb0: 697a 655f 6f6e 5f70 6f6c 6963 7920 3d20  ize_on_policy = 
+0002ccc0: 4661 6c73 650a 0a20 2020 2020 2020 2020  False..         
+0002ccd0: 2020 206e 5f66 6967 7320 3d20 280a 2020     n_figs = (.  
+0002cce0: 2020 2020 2020 2020 2020 2020 2020 6c65                le
+0002ccf0: 6e28 636f 6d70 6172 6564 5f65 7374 696d  n(compared_estim
+0002cd00: 6174 6f72 7329 202b 2031 0a20 2020 2020  ators) + 1.     
+0002cd10: 2020 2020 2020 2020 2020 2069 6620 7669             if vi
+0002cd20: 7375 616c 697a 655f 6f6e 5f70 6f6c 6963  sualize_on_polic
+0002cd30: 790a 2020 2020 2020 2020 2020 2020 2020  y.              
+0002cd40: 2020 656c 7365 206c 656e 2863 6f6d 7061    else len(compa
+0002cd50: 7265 645f 6573 7469 6d61 746f 7273 290a  red_estimators).
+0002cd60: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+0002cd70: 2020 2020 2020 2020 2020 6e5f 636f 6c73            n_cols
+0002cd80: 203d 206d 696e 2833 2c20 6e5f 6669 6773   = min(3, n_figs
+0002cd90: 2920 6966 206e 5f63 6f6c 7320 6973 204e  ) if n_cols is N
+0002cda0: 6f6e 6520 656c 7365 206e 5f63 6f6c 730a  one else n_cols.
+0002cdb0: 2020 2020 2020 2020 2020 2020 6e5f 726f              n_ro
+0002cdc0: 7773 203d 2028 6e5f 6669 6773 202d 2031  ws = (n_figs - 1
+0002cdd0: 2920 2f2f 206e 5f63 6f6c 7320 2b20 310a  ) // n_cols + 1.
+0002cde0: 0a20 2020 2020 2020 2020 2020 2066 6967  .            fig
+0002cdf0: 2c20 6178 6573 203d 2070 6c74 2e73 7562  , axes = plt.sub
+0002ce00: 706c 6f74 7328 0a20 2020 2020 2020 2020  plots(.         
+0002ce10: 2020 2020 2020 206e 726f 7773 3d6e 5f72         nrows=n_r
+0002ce20: 6f77 732c 206e 636f 6c73 3d6e 5f63 6f6c  ows, ncols=n_col
+0002ce30: 732c 2066 6967 7369 7a65 3d28 3620 2a20  s, figsize=(6 * 
+0002ce40: 6e5f 636f 6c73 2c20 3420 2a20 6e5f 726f  n_cols, 4 * n_ro
+0002ce50: 7773 290a 2020 2020 2020 2020 2020 2020  ws).            
+0002ce60: 290a 0a20 2020 2020 2020 2020 2020 2069  )..            i
+0002ce70: 6620 6e5f 726f 7773 203d 3d20 313a 0a20  f n_rows == 1:. 
+0002ce80: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0002ce90: 6f72 2069 2c20 6573 7469 6d61 746f 7220  or i, estimator 
+0002cea0: 696e 2065 6e75 6d65 7261 7465 2863 6f6d  in enumerate(com
+0002ceb0: 7061 7265 645f 6573 7469 6d61 746f 7273  pared_estimators
+0002cec0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+0002ced0: 2020 2020 2020 2066 6f72 206a 2c20 6576         for j, ev
+0002cee0: 616c 5f70 6f6c 6963 7920 696e 2065 6e75  al_policy in enu
+0002cef0: 6d65 7261 7465 2869 6e70 7574 5f64 6963  merate(input_dic
+0002cf00: 742e 6b65 7973 2829 293a 0a20 2020 2020  t.keys()):.     
+0002cf10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cf20: 2020 2061 7865 735b 695d 2e70 6c6f 7428     axes[i].plot(
+0002cf30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002cf40: 2020 2020 2020 2020 2020 2020 2072 6577               rew
+0002cf50: 6172 645f 7363 616c 652c 0a20 2020 2020  ard_scale,.     
+0002cf60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cf70: 2020 2020 2020 2063 756d 756c 6174 6976         cumulativ
+0002cf80: 655f 6469 7374 7269 6275 7469 6f6e 5f66  e_distribution_f
+0002cf90: 756e 6374 696f 6e5f 6469 6374 5b65 7661  unction_dict[eva
+0002cfa0: 6c5f 706f 6c69 6379 5d5b 0a20 2020 2020  l_policy][.     
+0002cfb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cfc0: 2020 2020 2020 2020 2020 2065 7374 696d             estim
+0002cfd0: 6174 6f72 0a20 2020 2020 2020 2020 2020  ator.           
 0002cfe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002cff0: 2020 2020 2020 2061 7865 735b 695d 2e70         axes[i].p
-0002d000: 6c6f 7428 0a20 2020 2020 2020 2020 2020  lot(.           
-0002d010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d020: 2072 6577 6172 645f 7363 616c 652c 0a20   reward_scale,. 
-0002d030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d040: 2020 2020 2020 2020 2020 2063 756d 756c             cumul
-0002d050: 6174 6976 655f 6469 7374 7269 6275 7469  ative_distributi
-0002d060: 6f6e 5f66 756e 6374 696f 6e5f 6469 6374  on_function_dict
-0002d070: 5b65 7661 6c5f 706f 6c69 6379 5d5b 0a20  [eval_policy][. 
-0002d080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d090: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0002d0a0: 7374 696d 6174 6f72 0a20 2020 2020 2020  stimator.       
+0002cff0: 205d 2c0a 2020 2020 2020 2020 2020 2020   ],.            
+0002d000: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d010: 6c61 6265 6c3d 6576 616c 5f70 6f6c 6963  label=eval_polic
+0002d020: 792c 0a20 2020 2020 2020 2020 2020 2020  y,.             
+0002d030: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
+0002d040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d050: 2020 6178 6573 5b69 5d2e 7365 745f 7469    axes[i].set_ti
+0002d060: 746c 6528 6573 7469 6d61 746f 7229 0a20  tle(estimator). 
+0002d070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d080: 2020 2061 7865 735b 695d 2e73 6574 5f78     axes[i].set_x
+0002d090: 6c61 6265 6c28 2274 7261 6a65 6374 6f72  label("trajector
+0002d0a0: 792d 7769 7365 2072 6577 6172 6422 290a  y-wise reward").
 0002d0b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d0c0: 2020 2020 205d 2c0a 2020 2020 2020 2020       ],.        
-0002d0d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d0e0: 2020 2020 6c61 6265 6c3d 6576 616c 5f70      label=eval_p
-0002d0f0: 6f6c 6963 792c 0a20 2020 2020 2020 2020  olicy,.         
-0002d100: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-0002d110: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0002d120: 2020 2020 2020 6178 6573 5b69 5d2e 7365        axes[i].se
-0002d130: 745f 7469 746c 6528 6573 7469 6d61 746f  t_title(estimato
-0002d140: 7229 0a20 2020 2020 2020 2020 2020 2020  r).             
-0002d150: 2020 2020 2020 2061 7865 735b 695d 2e73         axes[i].s
-0002d160: 6574 5f78 6c61 6265 6c28 2274 7261 6a65  et_xlabel("traje
-0002d170: 6374 6f72 792d 7769 7365 2072 6577 6172  ctory-wise rewar
-0002d180: 6422 290a 2020 2020 2020 2020 2020 2020  d").            
-0002d190: 2020 2020 2020 2020 6178 6573 5b69 5d2e          axes[i].
-0002d1a0: 7365 745f 796c 6162 656c 2822 6375 6d75  set_ylabel("cumu
-0002d1b0: 6c61 7469 7665 2070 726f 6261 6269 6c69  lative probabili
-0002d1c0: 7479 2229 0a20 2020 2020 2020 2020 2020  ty").           
-0002d1d0: 2020 2020 2020 2020 2069 6620 6c65 6765           if lege
-0002d1e0: 6e64 3a0a 2020 2020 2020 2020 2020 2020  nd:.            
-0002d1f0: 2020 2020 2020 2020 2020 2020 6178 6573              axes
-0002d200: 5b69 5d2e 6c65 6765 6e64 2829 0a0a 2020  [i].legend()..  
-0002d210: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0002d220: 2076 6973 7561 6c69 7a65 5f6f 6e5f 706f   visualize_on_po
-0002d230: 6c69 6379 3a0a 2020 2020 2020 2020 2020  licy:.          
-0002d240: 2020 2020 2020 2020 2020 666f 7220 6a2c            for j,
-0002d250: 2065 7661 6c5f 706f 6c69 6379 2069 6e20   eval_policy in 
-0002d260: 656e 756d 6572 6174 6528 696e 7075 745f  enumerate(input_
-0002d270: 6469 6374 2e6b 6579 7328 2929 3a0a 2020  dict.keys()):.  
+0002d0c0: 2020 2020 6178 6573 5b69 5d2e 7365 745f      axes[i].set_
+0002d0d0: 796c 6162 656c 2822 6375 6d75 6c61 7469  ylabel("cumulati
+0002d0e0: 7665 2070 726f 6261 6269 6c69 7479 2229  ve probability")
+0002d0f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002d100: 2020 2020 2069 6620 6c65 6765 6e64 3a0a       if legend:.
+0002d110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d120: 2020 2020 2020 2020 6178 6573 5b69 5d2e          axes[i].
+0002d130: 6c65 6765 6e64 2829 0a0a 2020 2020 2020  legend()..      
+0002d140: 2020 2020 2020 2020 2020 6966 2076 6973            if vis
+0002d150: 7561 6c69 7a65 5f6f 6e5f 706f 6c69 6379  ualize_on_policy
+0002d160: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0002d170: 2020 2020 2020 666f 7220 6a2c 2065 7661        for j, eva
+0002d180: 6c5f 706f 6c69 6379 2069 6e20 656e 756d  l_policy in enum
+0002d190: 6572 6174 6528 696e 7075 745f 6469 6374  erate(input_dict
+0002d1a0: 2e6b 6579 7328 2929 3a0a 2020 2020 2020  .keys()):.      
+0002d1b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d1c0: 2020 6178 6573 5b69 202b 2031 5d2e 706c    axes[i + 1].pl
+0002d1d0: 6f74 280a 2020 2020 2020 2020 2020 2020  ot(.            
+0002d1e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d1f0: 7265 7761 7264 5f73 6361 6c65 2c0a 2020  reward_scale,.  
+0002d200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d210: 2020 2020 2020 2020 2020 6375 6d75 6c61            cumula
+0002d220: 7469 7665 5f64 6973 7472 6962 7574 696f  tive_distributio
+0002d230: 6e5f 6675 6e63 7469 6f6e 5f64 6963 745b  n_function_dict[
+0002d240: 6576 616c 5f70 6f6c 6963 795d 5b0a 2020  eval_policy][.  
+0002d250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d260: 2020 2020 2020 2020 2020 2020 2020 226f                "o
+0002d270: 6e5f 706f 6c69 6379 220a 2020 2020 2020  n_policy".      
 0002d280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d290: 2020 2020 2020 6178 6573 5b69 202b 2031        axes[i + 1
-0002d2a0: 5d2e 706c 6f74 280a 2020 2020 2020 2020  ].plot(.        
-0002d2b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d2c0: 2020 2020 7265 7761 7264 5f73 6361 6c65      reward_scale
-0002d2d0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0002d2e0: 2020 2020 2020 2020 2020 2020 2020 6375                cu
-0002d2f0: 6d75 6c61 7469 7665 5f64 6973 7472 6962  mulative_distrib
-0002d300: 7574 696f 6e5f 6675 6e63 7469 6f6e 5f64  ution_function_d
-0002d310: 6963 745b 6576 616c 5f70 6f6c 6963 795d  ict[eval_policy]
-0002d320: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
-0002d330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d340: 2020 226f 6e5f 706f 6c69 6379 220a 2020    "on_policy".  
-0002d350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d360: 2020 2020 2020 2020 2020 5d2c 0a20 2020            ],.   
-0002d370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d380: 2020 2020 2020 2020 206c 6162 656c 3d65           label=e
-0002d390: 7661 6c5f 706f 6c69 6379 2c0a 2020 2020  val_policy,.    
-0002d3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d3b0: 2020 2020 290a 0a20 2020 2020 2020 2020      )..         
-0002d3c0: 2020 2020 2020 2020 2020 2061 7865 735b             axes[
-0002d3d0: 6920 2b20 315d 2e73 6574 5f74 6974 6c65  i + 1].set_title
-0002d3e0: 2822 6f6e 5f70 6f6c 6963 7922 290a 2020  ("on_policy").  
-0002d3f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d400: 2020 6178 6573 5b69 202b 2031 5d2e 7365    axes[i + 1].se
-0002d410: 745f 786c 6162 656c 2822 7472 616a 6563  t_xlabel("trajec
-0002d420: 746f 7279 2d77 6973 6520 7265 7761 7264  tory-wise reward
-0002d430: 2229 0a20 2020 2020 2020 2020 2020 2020  ").             
-0002d440: 2020 2020 2020 2061 7865 735b 6920 2b20         axes[i + 
-0002d450: 315d 2e73 6574 5f79 6c61 6265 6c28 2263  1].set_ylabel("c
-0002d460: 756d 756c 6174 6976 6520 7072 6f62 6162  umulative probab
-0002d470: 696c 6974 7922 290a 2020 2020 2020 2020  ility").        
-0002d480: 2020 2020 2020 2020 2020 2020 6966 206c              if l
-0002d490: 6567 656e 643a 0a20 2020 2020 2020 2020  egend:.         
-0002d4a0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-0002d4b0: 7865 735b 6920 2b20 315d 2e6c 6567 656e  xes[i + 1].legen
-0002d4c0: 6428 290a 0a20 2020 2020 2020 2020 2020  d()..           
-0002d4d0: 2020 2020 2069 6620 6c65 6765 6e64 3a0a       if legend:.
-0002d4e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d4f0: 2020 2020 6861 6e64 6c65 732c 206c 6162      handles, lab
-0002d500: 656c 7320 3d20 6178 6573 5b30 5d2e 6765  els = axes[0].ge
-0002d510: 745f 6c65 6765 6e64 5f68 616e 646c 6573  t_legend_handles
-0002d520: 5f6c 6162 656c 7328 290a 2020 2020 2020  _labels().      
-0002d530: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-0002d540: 6e5f 636f 6c73 2073 686f 7773 2065 7272  n_cols shows err
-0002d550: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002d560: 2020 2020 2023 2066 6967 2e6c 6567 656e       # fig.legen
-0002d570: 6428 6861 6e64 6c65 732c 206c 6162 656c  d(handles, label
-0002d580: 732c 206c 6f63 3d27 7570 7065 7220 6365  s, loc='upper ce
-0002d590: 6e74 6572 272c 2062 626f 785f 746f 5f61  nter', bbox_to_a
-0002d5a0: 6e63 686f 723d 2830 2e35 2c20 2d30 2e31  nchor=(0.5, -0.1
-0002d5b0: 292c 206e 5f63 6f6c 733d 6d69 6e28 6c65  ), n_cols=min(le
-0002d5c0: 6e28 6c61 6265 6c73 292c 2036 2929 0a0a  n(labels), 6))..
-0002d5d0: 2020 2020 2020 2020 2020 2020 656c 7365              else
-0002d5e0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0002d5f0: 2020 666f 7220 692c 2065 7374 696d 6174    for i, estimat
-0002d600: 6f72 2069 6e20 656e 756d 6572 6174 6528  or in enumerate(
-0002d610: 636f 6d70 6172 6564 5f65 7374 696d 6174  compared_estimat
-0002d620: 6f72 7329 3a0a 2020 2020 2020 2020 2020  ors):.          
-0002d630: 2020 2020 2020 2020 2020 666f 7220 6a2c            for j,
-0002d640: 2065 7661 6c5f 706f 6c69 6379 2069 6e20   eval_policy in 
-0002d650: 656e 756d 6572 6174 6528 696e 7075 745f  enumerate(input_
-0002d660: 6469 6374 2e6b 6579 7328 2929 3a0a 2020  dict.keys()):.  
-0002d670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d680: 2020 2020 2020 6178 6573 5b69 202f 2f20        axes[i // 
-0002d690: 6e5f 636f 6c73 2c20 6920 2520 6e5f 636f  n_cols, i % n_co
-0002d6a0: 6c73 5d2e 706c 6f74 280a 2020 2020 2020  ls].plot(.      
-0002d6b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d6c0: 2020 2020 2020 7265 7761 7264 5f73 6361        reward_sca
-0002d6d0: 6c65 2c0a 2020 2020 2020 2020 2020 2020  le,.            
-0002d6e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d6f0: 6375 6d75 6c61 7469 7665 5f64 6973 7472  cumulative_distr
-0002d700: 6962 7574 696f 6e5f 6675 6e63 7469 6f6e  ibution_function
-0002d710: 5f64 6963 745b 6576 616c 5f70 6f6c 6963  _dict[eval_polic
-0002d720: 795d 5b0a 2020 2020 2020 2020 2020 2020  y][.            
-0002d730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d740: 2020 2020 6573 7469 6d61 746f 720a 2020      estimator.  
-0002d750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d760: 2020 2020 2020 2020 2020 5d2c 0a20 2020            ],.   
-0002d770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d780: 2020 2020 2020 2020 206c 6162 656c 3d65           label=e
-0002d790: 7661 6c5f 706f 6c69 6379 2c0a 2020 2020  val_policy,.    
-0002d7a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d7b0: 2020 2020 290a 0a20 2020 2020 2020 2020      )..         
-0002d7c0: 2020 2020 2020 2020 2020 2061 7865 735b             axes[
-0002d7d0: 6920 2f2f 206e 5f63 6f6c 732c 2069 2025  i // n_cols, i %
-0002d7e0: 206e 5f63 6f6c 735d 2e73 6574 5f74 6974   n_cols].set_tit
-0002d7f0: 6c65 2865 7374 696d 6174 6f72 290a 2020  le(estimator).  
-0002d800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d810: 2020 6178 6573 5b69 202f 2f20 6e5f 636f    axes[i // n_co
-0002d820: 6c73 2c20 6920 2520 6e5f 636f 6c73 5d2e  ls, i % n_cols].
-0002d830: 7365 745f 786c 6162 656c 2822 7472 616a  set_xlabel("traj
-0002d840: 6563 746f 7279 2d77 6973 6520 7265 7761  ectory-wise rewa
-0002d850: 7264 2229 0a20 2020 2020 2020 2020 2020  rd").           
-0002d860: 2020 2020 2020 2020 2061 7865 735b 6920           axes[i 
-0002d870: 2f2f 206e 5f63 6f6c 732c 2069 2025 206e  // n_cols, i % n
-0002d880: 5f63 6f6c 735d 2e73 6574 5f79 6c61 6265  _cols].set_ylabe
-0002d890: 6c28 2263 756d 756c 6174 6976 6520 7072  l("cumulative pr
-0002d8a0: 6f62 6162 696c 6974 7922 290a 2020 2020  obability").    
-0002d8b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d8c0: 6966 206c 6567 656e 643a 0a20 2020 2020  if legend:.     
-0002d8d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d8e0: 2020 2061 7865 735b 6920 2f2f 206e 5f63     axes[i // n_c
-0002d8f0: 6f6c 732c 2069 2025 206e 5f63 6f6c 735d  ols, i % n_cols]
-0002d900: 2e6c 6567 656e 6428 290a 0a20 2020 2020  .legend()..     
-0002d910: 2020 2020 2020 2020 2020 2069 6620 7669             if vi
-0002d920: 7375 616c 697a 655f 6f6e 5f70 6f6c 6963  sualize_on_polic
-0002d930: 793a 0a20 2020 2020 2020 2020 2020 2020  y:.             
-0002d940: 2020 2020 2020 2066 6f72 206a 2c20 6576         for j, ev
-0002d950: 616c 5f70 6f6c 6963 7920 696e 2065 6e75  al_policy in enu
-0002d960: 6d65 7261 7465 2869 6e70 7574 5f64 6963  merate(input_dic
-0002d970: 742e 6b65 7973 2829 293a 0a20 2020 2020  t.keys()):.     
-0002d980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d990: 2020 2061 7865 735b 2869 202b 2031 2920     axes[(i + 1) 
-0002d9a0: 2f2f 206e 5f63 6f6c 732c 2028 6920 2b20  // n_cols, (i + 
-0002d9b0: 3129 2025 206e 5f63 6f6c 735d 2e70 6c6f  1) % n_cols].plo
-0002d9c0: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
-0002d9d0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0002d9e0: 6577 6172 645f 7363 616c 652c 0a20 2020  eward_scale,.   
-0002d9f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002da00: 2020 2020 2020 2020 2063 756d 756c 6174           cumulat
-0002da10: 6976 655f 6469 7374 7269 6275 7469 6f6e  ive_distribution
-0002da20: 5f66 756e 6374 696f 6e5f 6469 6374 5b65  _function_dict[e
-0002da30: 7661 6c5f 706f 6c69 6379 5d5b 0a20 2020  val_policy][.   
-0002da40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002da50: 2020 2020 2020 2020 2020 2020 2022 6f6e               "on
-0002da60: 5f70 6f6c 6963 7922 0a20 2020 2020 2020  _policy".       
-0002da70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002da80: 2020 2020 205d 2c0a 2020 2020 2020 2020       ],.        
-0002da90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002daa0: 2020 2020 6c61 6265 6c3d 6576 616c 5f70      label=eval_p
-0002dab0: 6f6c 6963 792c 0a20 2020 2020 2020 2020  olicy,.         
-0002dac0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-0002dad0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0002dae0: 2020 2020 2020 6178 6573 5b28 6920 2b20        axes[(i + 
-0002daf0: 3129 202f 2f20 6e5f 636f 6c73 2c20 2869  1) // n_cols, (i
-0002db00: 202b 2031 2920 2520 6e5f 636f 6c73 5d2e   + 1) % n_cols].
-0002db10: 7365 745f 7469 746c 6528 226f 6e5f 706f  set_title("on_po
-0002db20: 6c69 6379 2229 0a20 2020 2020 2020 2020  licy").         
-0002db30: 2020 2020 2020 2020 2020 2061 7865 735b             axes[
-0002db40: 2869 202b 2031 2920 2f2f 206e 5f63 6f6c  (i + 1) // n_col
-0002db50: 732c 2028 6920 2b20 3129 2025 206e 5f63  s, (i + 1) % n_c
-0002db60: 6f6c 735d 2e73 6574 5f78 6c61 6265 6c28  ols].set_xlabel(
-0002db70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002db80: 2020 2020 2020 2020 2022 7472 616a 6563           "trajec
-0002db90: 746f 7279 2d77 6973 6520 7265 7761 7264  tory-wise reward
-0002dba0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-0002dbb0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-0002dbc0: 2020 2020 2020 2020 2020 2020 6178 6573              axes
-0002dbd0: 5b28 6920 2b20 3129 202f 2f20 6e5f 636f  [(i + 1) // n_co
-0002dbe0: 6c73 2c20 2869 202b 2031 2920 2520 6e5f  ls, (i + 1) % n_
-0002dbf0: 636f 6c73 5d2e 7365 745f 796c 6162 656c  cols].set_ylabel
-0002dc00: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0002dc10: 2020 2020 2020 2020 2020 2263 756d 756c            "cumul
-0002dc20: 6174 6976 6520 7072 6f62 6162 696c 6974  ative probabilit
-0002dc30: 7922 0a20 2020 2020 2020 2020 2020 2020  y".             
-0002dc40: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0002dc50: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-0002dc60: 6c65 6765 6e64 3a0a 2020 2020 2020 2020  legend:.        
+0002d290: 2020 2020 2020 5d2c 0a20 2020 2020 2020        ],.       
+0002d2a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d2b0: 2020 2020 206c 6162 656c 3d65 7661 6c5f       label=eval_
+0002d2c0: 706f 6c69 6379 2c0a 2020 2020 2020 2020  policy,.        
+0002d2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d2e0: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
+0002d2f0: 2020 2020 2020 2061 7865 735b 6920 2b20         axes[i + 
+0002d300: 315d 2e73 6574 5f74 6974 6c65 2822 6f6e  1].set_title("on
+0002d310: 5f70 6f6c 6963 7922 290a 2020 2020 2020  _policy").      
+0002d320: 2020 2020 2020 2020 2020 2020 2020 6178                ax
+0002d330: 6573 5b69 202b 2031 5d2e 7365 745f 786c  es[i + 1].set_xl
+0002d340: 6162 656c 2822 7472 616a 6563 746f 7279  abel("trajectory
+0002d350: 2d77 6973 6520 7265 7761 7264 2229 0a20  -wise reward"). 
+0002d360: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d370: 2020 2061 7865 735b 6920 2b20 315d 2e73     axes[i + 1].s
+0002d380: 6574 5f79 6c61 6265 6c28 2263 756d 756c  et_ylabel("cumul
+0002d390: 6174 6976 6520 7072 6f62 6162 696c 6974  ative probabilit
+0002d3a0: 7922 290a 2020 2020 2020 2020 2020 2020  y").            
+0002d3b0: 2020 2020 2020 2020 6966 206c 6567 656e          if legen
+0002d3c0: 643a 0a20 2020 2020 2020 2020 2020 2020  d:.             
+0002d3d0: 2020 2020 2020 2020 2020 2061 7865 735b             axes[
+0002d3e0: 6920 2b20 315d 2e6c 6567 656e 6428 290a  i + 1].legend().
+0002d3f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002d400: 2069 6620 6c65 6765 6e64 3a0a 2020 2020   if legend:.    
+0002d410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d420: 6861 6e64 6c65 732c 206c 6162 656c 7320  handles, labels 
+0002d430: 3d20 6178 6573 5b30 5d2e 6765 745f 6c65  = axes[0].get_le
+0002d440: 6765 6e64 5f68 616e 646c 6573 5f6c 6162  gend_handles_lab
+0002d450: 656c 7328 290a 2020 2020 2020 2020 2020  els().          
+0002d460: 2020 2020 2020 2020 2020 2320 6e5f 636f            # n_co
+0002d470: 6c73 2073 686f 7773 2065 7272 0a20 2020  ls shows err.   
+0002d480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d490: 2023 2066 6967 2e6c 6567 656e 6428 6861   # fig.legend(ha
+0002d4a0: 6e64 6c65 732c 206c 6162 656c 732c 206c  ndles, labels, l
+0002d4b0: 6f63 3d27 7570 7065 7220 6365 6e74 6572  oc='upper center
+0002d4c0: 272c 2062 626f 785f 746f 5f61 6e63 686f  ', bbox_to_ancho
+0002d4d0: 723d 2830 2e35 2c20 2d30 2e31 292c 206e  r=(0.5, -0.1), n
+0002d4e0: 5f63 6f6c 733d 6d69 6e28 6c65 6e28 6c61  _cols=min(len(la
+0002d4f0: 6265 6c73 292c 2036 2929 0a0a 2020 2020  bels), 6))..    
+0002d500: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+0002d510: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+0002d520: 7220 692c 2065 7374 696d 6174 6f72 2069  r i, estimator i
+0002d530: 6e20 656e 756d 6572 6174 6528 636f 6d70  n enumerate(comp
+0002d540: 6172 6564 5f65 7374 696d 6174 6f72 7329  ared_estimators)
+0002d550: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0002d560: 2020 2020 2020 666f 7220 6a2c 2065 7661        for j, eva
+0002d570: 6c5f 706f 6c69 6379 2069 6e20 656e 756d  l_policy in enum
+0002d580: 6572 6174 6528 696e 7075 745f 6469 6374  erate(input_dict
+0002d590: 2e6b 6579 7328 2929 3a0a 2020 2020 2020  .keys()):.      
+0002d5a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d5b0: 2020 6178 6573 5b69 202f 2f20 6e5f 636f    axes[i // n_co
+0002d5c0: 6c73 2c20 6920 2520 6e5f 636f 6c73 5d2e  ls, i % n_cols].
+0002d5d0: 706c 6f74 280a 2020 2020 2020 2020 2020  plot(.          
+0002d5e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d5f0: 2020 7265 7761 7264 5f73 6361 6c65 2c0a    reward_scale,.
+0002d600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d610: 2020 2020 2020 2020 2020 2020 6375 6d75              cumu
+0002d620: 6c61 7469 7665 5f64 6973 7472 6962 7574  lative_distribut
+0002d630: 696f 6e5f 6675 6e63 7469 6f6e 5f64 6963  ion_function_dic
+0002d640: 745b 6576 616c 5f70 6f6c 6963 795d 5b0a  t[eval_policy][.
+0002d650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d670: 6573 7469 6d61 746f 720a 2020 2020 2020  estimator.      
+0002d680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d690: 2020 2020 2020 5d2c 0a20 2020 2020 2020        ],.       
+0002d6a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d6b0: 2020 2020 206c 6162 656c 3d65 7661 6c5f       label=eval_
+0002d6c0: 706f 6c69 6379 2c0a 2020 2020 2020 2020  policy,.        
+0002d6d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d6e0: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
+0002d6f0: 2020 2020 2020 2061 7865 735b 6920 2f2f         axes[i //
+0002d700: 206e 5f63 6f6c 732c 2069 2025 206e 5f63   n_cols, i % n_c
+0002d710: 6f6c 735d 2e73 6574 5f74 6974 6c65 2865  ols].set_title(e
+0002d720: 7374 696d 6174 6f72 290a 2020 2020 2020  stimator).      
+0002d730: 2020 2020 2020 2020 2020 2020 2020 6178                ax
+0002d740: 6573 5b69 202f 2f20 6e5f 636f 6c73 2c20  es[i // n_cols, 
+0002d750: 6920 2520 6e5f 636f 6c73 5d2e 7365 745f  i % n_cols].set_
+0002d760: 786c 6162 656c 2822 7472 616a 6563 746f  xlabel("trajecto
+0002d770: 7279 2d77 6973 6520 7265 7761 7264 2229  ry-wise reward")
+0002d780: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002d790: 2020 2020 2061 7865 735b 6920 2f2f 206e       axes[i // n
+0002d7a0: 5f63 6f6c 732c 2069 2025 206e 5f63 6f6c  _cols, i % n_col
+0002d7b0: 735d 2e73 6574 5f79 6c61 6265 6c28 2263  s].set_ylabel("c
+0002d7c0: 756d 756c 6174 6976 6520 7072 6f62 6162  umulative probab
+0002d7d0: 696c 6974 7922 290a 2020 2020 2020 2020  ility").        
+0002d7e0: 2020 2020 2020 2020 2020 2020 6966 206c              if l
+0002d7f0: 6567 656e 643a 0a20 2020 2020 2020 2020  egend:.         
+0002d800: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+0002d810: 7865 735b 6920 2f2f 206e 5f63 6f6c 732c  xes[i // n_cols,
+0002d820: 2069 2025 206e 5f63 6f6c 735d 2e6c 6567   i % n_cols].leg
+0002d830: 656e 6428 290a 0a20 2020 2020 2020 2020  end()..         
+0002d840: 2020 2020 2020 2069 6620 7669 7375 616c         if visual
+0002d850: 697a 655f 6f6e 5f70 6f6c 6963 793a 0a20  ize_on_policy:. 
+0002d860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d870: 2020 2066 6f72 206a 2c20 6576 616c 5f70     for j, eval_p
+0002d880: 6f6c 6963 7920 696e 2065 6e75 6d65 7261  olicy in enumera
+0002d890: 7465 2869 6e70 7574 5f64 6963 742e 6b65  te(input_dict.ke
+0002d8a0: 7973 2829 293a 0a20 2020 2020 2020 2020  ys()):.         
+0002d8b0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+0002d8c0: 7865 735b 2869 202b 2031 2920 2f2f 206e  xes[(i + 1) // n
+0002d8d0: 5f63 6f6c 732c 2028 6920 2b20 3129 2025  _cols, (i + 1) %
+0002d8e0: 206e 5f63 6f6c 735d 2e70 6c6f 7428 0a20   n_cols].plot(. 
+0002d8f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d900: 2020 2020 2020 2020 2020 2072 6577 6172             rewar
+0002d910: 645f 7363 616c 652c 0a20 2020 2020 2020  d_scale,.       
+0002d920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d930: 2020 2020 2063 756d 756c 6174 6976 655f       cumulative_
+0002d940: 6469 7374 7269 6275 7469 6f6e 5f66 756e  distribution_fun
+0002d950: 6374 696f 6e5f 6469 6374 5b65 7661 6c5f  ction_dict[eval_
+0002d960: 706f 6c69 6379 5d5b 0a20 2020 2020 2020  policy][.       
+0002d970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d980: 2020 2020 2020 2020 2022 6f6e 5f70 6f6c           "on_pol
+0002d990: 6963 7922 0a20 2020 2020 2020 2020 2020  icy".           
+0002d9a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d9b0: 205d 2c0a 2020 2020 2020 2020 2020 2020   ],.            
+0002d9c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d9d0: 6c61 6265 6c3d 6576 616c 5f70 6f6c 6963  label=eval_polic
+0002d9e0: 792c 0a20 2020 2020 2020 2020 2020 2020  y,.             
+0002d9f0: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
+0002da00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002da10: 2020 6178 6573 5b28 6920 2b20 3129 202f    axes[(i + 1) /
+0002da20: 2f20 6e5f 636f 6c73 2c20 2869 202b 2031  / n_cols, (i + 1
+0002da30: 2920 2520 6e5f 636f 6c73 5d2e 7365 745f  ) % n_cols].set_
+0002da40: 7469 746c 6528 226f 6e5f 706f 6c69 6379  title("on_policy
+0002da50: 2229 0a20 2020 2020 2020 2020 2020 2020  ").             
+0002da60: 2020 2020 2020 2061 7865 735b 2869 202b         axes[(i +
+0002da70: 2031 2920 2f2f 206e 5f63 6f6c 732c 2028   1) // n_cols, (
+0002da80: 6920 2b20 3129 2025 206e 5f63 6f6c 735d  i + 1) % n_cols]
+0002da90: 2e73 6574 5f78 6c61 6265 6c28 0a20 2020  .set_xlabel(.   
+0002daa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002dab0: 2020 2020 2022 7472 616a 6563 746f 7279       "trajectory
+0002dac0: 2d77 6973 6520 7265 7761 7264 220a 2020  -wise reward".  
+0002dad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002dae0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+0002daf0: 2020 2020 2020 2020 6178 6573 5b28 6920          axes[(i 
+0002db00: 2b20 3129 202f 2f20 6e5f 636f 6c73 2c20  + 1) // n_cols, 
+0002db10: 2869 202b 2031 2920 2520 6e5f 636f 6c73  (i + 1) % n_cols
+0002db20: 5d2e 7365 745f 796c 6162 656c 280a 2020  ].set_ylabel(.  
+0002db30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002db40: 2020 2020 2020 2263 756d 756c 6174 6976        "cumulativ
+0002db50: 6520 7072 6f62 6162 696c 6974 7922 0a20  e probability". 
+0002db60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002db70: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+0002db80: 2020 2020 2020 2020 2069 6620 6c65 6765           if lege
+0002db90: 6e64 3a0a 2020 2020 2020 2020 2020 2020  nd:.            
+0002dba0: 2020 2020 2020 2020 2020 2020 6178 6573              axes
+0002dbb0: 5b28 6920 2b20 3129 202f 2f20 6e5f 636f  [(i + 1) // n_co
+0002dbc0: 6c73 2c20 2869 202b 2031 2920 2520 6e5f  ls, (i + 1) % n_
+0002dbd0: 636f 6c73 5d2e 6c65 6765 6e64 2829 0a0a  cols].legend()..
+0002dbe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002dbf0: 6966 206c 6567 656e 643a 0a20 2020 2020  if legend:.     
+0002dc00: 2020 2020 2020 2020 2020 2020 2020 2068                 h
+0002dc10: 616e 646c 6573 2c20 6c61 6265 6c73 203d  andles, labels =
+0002dc20: 2061 7865 735b 302c 2030 5d2e 6765 745f   axes[0, 0].get_
+0002dc30: 6c65 6765 6e64 5f68 616e 646c 6573 5f6c  legend_handles_l
+0002dc40: 6162 656c 7328 290a 2020 2020 2020 2020  abels().        
+0002dc50: 2020 2020 2020 2020 2020 2020 2320 6e5f              # n_
+0002dc60: 636f 6c73 2073 686f 7773 2065 7272 0a20  cols shows err. 
 0002dc70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002dc80: 6178 6573 5b28 6920 2b20 3129 202f 2f20  axes[(i + 1) // 
-0002dc90: 6e5f 636f 6c73 2c20 2869 202b 2031 2920  n_cols, (i + 1) 
-0002dca0: 2520 6e5f 636f 6c73 5d2e 6c65 6765 6e64  % n_cols].legend
-0002dcb0: 2829 0a0a 2020 2020 2020 2020 2020 2020  ()..            
-0002dcc0: 2020 2020 6966 206c 6567 656e 643a 0a20      if legend:. 
-0002dcd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002dce0: 2020 2068 616e 646c 6573 2c20 6c61 6265     handles, labe
-0002dcf0: 6c73 203d 2061 7865 735b 302c 2030 5d2e  ls = axes[0, 0].
-0002dd00: 6765 745f 6c65 6765 6e64 5f68 616e 646c  get_legend_handl
-0002dd10: 6573 5f6c 6162 656c 7328 290a 2020 2020  es_labels().    
-0002dd20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002dd30: 2320 6e5f 636f 6c73 2073 686f 7773 2065  # n_cols shows e
-0002dd40: 7272 0a20 2020 2020 2020 2020 2020 2020  rr.             
-0002dd50: 2020 2020 2020 2023 2066 6967 2e6c 6567         # fig.leg
-0002dd60: 656e 6428 6861 6e64 6c65 732c 206c 6162  end(handles, lab
-0002dd70: 656c 732c 206c 6f63 3d27 7570 7065 7220  els, loc='upper 
-0002dd80: 6365 6e74 6572 272c 2062 626f 785f 746f  center', bbox_to
-0002dd90: 5f61 6e63 686f 723d 2830 2e35 2c20 2d30  _anchor=(0.5, -0
-0002dda0: 2e31 292c 206e 5f63 6f6c 733d 6d69 6e28  .1), n_cols=min(
-0002ddb0: 6c65 6e28 6c61 6265 6c73 292c 2036 2929  len(labels), 6))
-0002ddc0: 0a0a 2020 2020 2020 2020 6669 672e 7375  ..        fig.su
-0002ddd0: 6270 6c6f 7473 5f61 646a 7573 7428 6873  bplots_adjust(hs
-0002dde0: 7061 6365 3d30 2e33 352c 2077 7370 6163  pace=0.35, wspac
-0002ddf0: 653d 302e 3229 0a20 2020 2020 2020 2070  e=0.2).        p
-0002de00: 6c74 2e73 686f 7728 290a 0a20 2020 2020  lt.show()..     
-0002de10: 2020 2069 6620 6669 675f 6469 723a 0a20     if fig_dir:. 
-0002de20: 2020 2020 2020 2020 2020 2066 6967 2e73             fig.s
-0002de30: 6176 6566 6967 2873 7472 2866 6967 5f64  avefig(str(fig_d
-0002de40: 6972 202f 2066 6967 5f6e 616d 6529 2c20  ir / fig_name), 
-0002de50: 6470 693d 3330 302c 2062 626f 785f 696e  dpi=300, bbox_in
-0002de60: 6368 6573 3d22 7469 6768 7422 290a 0a20  ches="tight").. 
-0002de70: 2020 2064 6566 2076 6973 7561 6c69 7a65     def visualize
-0002de80: 5f70 6f6c 6963 795f 7661 6c75 6528 0a20  _policy_value(. 
-0002de90: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-0002dea0: 2020 2020 2069 6e70 7574 5f64 6963 743a       input_dict:
-0002deb0: 2055 6e69 6f6e 5b4f 5045 496e 7075 7444   Union[OPEInputD
-0002dec0: 6963 742c 204d 756c 7469 706c 6549 6e70  ict, MultipleInp
-0002ded0: 7574 4469 6374 5d2c 0a20 2020 2020 2020  utDict],.       
-0002dee0: 2063 6f6d 7061 7265 645f 6573 7469 6d61   compared_estima
-0002def0: 746f 7273 3a20 4f70 7469 6f6e 616c 5b4c  tors: Optional[L
-0002df00: 6973 745b 7374 725d 5d20 3d20 4e6f 6e65  ist[str]] = None
-0002df10: 2c0a 2020 2020 2020 2020 6265 6861 7669  ,.        behavi
-0002df20: 6f72 5f70 6f6c 6963 795f 6e61 6d65 3a20  or_policy_name: 
-0002df30: 4f70 7469 6f6e 616c 5b73 7472 5d20 3d20  Optional[str] = 
-0002df40: 4e6f 6e65 2c0a 2020 2020 2020 2020 6461  None,.        da
-0002df50: 7461 7365 745f 6964 3a20 4f70 7469 6f6e  taset_id: Option
-0002df60: 616c 5b69 6e74 5d20 3d20 4e6f 6e65 2c0a  al[int] = None,.
-0002df70: 2020 2020 2020 2020 616c 7068 613a 2066          alpha: f
-0002df80: 6c6f 6174 203d 2030 2e30 352c 0a20 2020  loat = 0.05,.   
-0002df90: 2020 2020 2069 735f 7265 6c61 7469 7665       is_relative
-0002dfa0: 3a20 626f 6f6c 203d 2046 616c 7365 2c0a  : bool = False,.
-0002dfb0: 2020 2020 2020 2020 6875 653a 2073 7472          hue: str
-0002dfc0: 203d 2022 6573 7469 6d61 746f 7222 2c0a   = "estimator",.
-0002dfd0: 2020 2020 2020 2020 7368 6172 6579 3a20          sharey: 
-0002dfe0: 626f 6f6c 203d 2046 616c 7365 2c0a 2020  bool = False,.  
-0002dff0: 2020 2020 2020 6669 675f 6469 723a 204f        fig_dir: O
-0002e000: 7074 696f 6e61 6c5b 5061 7468 5d20 3d20  ptional[Path] = 
-0002e010: 4e6f 6e65 2c0a 2020 2020 2020 2020 6669  None,.        fi
-0002e020: 675f 6e61 6d65 3a20 7374 7220 3d20 2265  g_name: str = "e
-0002e030: 7374 696d 6174 6564 5f70 6f6c 6963 795f  stimated_policy_
-0002e040: 7661 6c75 652e 706e 6722 2c0a 2020 2020  value.png",.    
-0002e050: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
-0002e060: 2020 2022 2222 5669 7375 616c 697a 6520     """Visualize 
-0002e070: 7468 6520 706f 6c69 6379 2076 616c 7565  the policy value
-0002e080: 2065 7374 696d 6174 6564 2062 7920 4f50   estimated by OP
-0002e090: 4520 6573 7469 6d61 746f 7273 2e0a 0a20  E estimators... 
-0002e0a0: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
-0002e0b0: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
-0002e0c0: 2d0a 2020 2020 2020 2020 696e 7075 745f  -.        input_
-0002e0d0: 6469 6374 3a20 4f50 4549 6e70 7574 4469  dict: OPEInputDi
-0002e0e0: 6374 206f 7220 4d75 6c74 6970 6c65 496e  ct or MultipleIn
-0002e0f0: 7075 7444 6963 740a 2020 2020 2020 2020  putDict.        
-0002e100: 2020 2020 4469 6374 696f 6e61 7279 206f      Dictionary o
-0002e110: 6620 7468 6520 4f50 4520 696e 7075 7473  f the OPE inputs
-0002e120: 2066 6f72 2065 6163 6820 6576 616c 7561   for each evalua
-0002e130: 7469 6f6e 2070 6f6c 6963 792e 0a0a 2020  tion policy...  
-0002e140: 2020 2020 2020 2020 2020 2e2e 2063 6f64            .. cod
-0002e150: 652d 626c 6f63 6b3a 3a20 7079 7468 6f6e  e-block:: python
-0002e160: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0002e170: 2020 6b65 793a 205b 6576 616c 7561 7469    key: [evaluati
-0002e180: 6f6e 5f70 6f6c 6963 795d 5b0a 2020 2020  on_policy][.    
-0002e190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e1a0: 6576 616c 7561 7469 6f6e 5f70 6f6c 6963  evaluation_polic
-0002e1b0: 795f 6163 7469 6f6e 2c0a 2020 2020 2020  y_action,.      
-0002e1c0: 2020 2020 2020 2020 2020 2020 2020 6576                ev
-0002e1d0: 616c 7561 7469 6f6e 5f70 6f6c 6963 795f  aluation_policy_
-0002e1e0: 6163 7469 6f6e 5f64 6973 742c 0a20 2020  action_dist,.   
-0002e1f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e200: 2073 7461 7465 5f61 6374 696f 6e5f 7661   state_action_va
-0002e210: 6c75 655f 7072 6564 6963 7469 6f6e 2c0a  lue_prediction,.
+0002dc80: 2020 2023 2066 6967 2e6c 6567 656e 6428     # fig.legend(
+0002dc90: 6861 6e64 6c65 732c 206c 6162 656c 732c  handles, labels,
+0002dca0: 206c 6f63 3d27 7570 7065 7220 6365 6e74   loc='upper cent
+0002dcb0: 6572 272c 2062 626f 785f 746f 5f61 6e63  er', bbox_to_anc
+0002dcc0: 686f 723d 2830 2e35 2c20 2d30 2e31 292c  hor=(0.5, -0.1),
+0002dcd0: 206e 5f63 6f6c 733d 6d69 6e28 6c65 6e28   n_cols=min(len(
+0002dce0: 6c61 6265 6c73 292c 2036 2929 0a0a 2020  labels), 6))..  
+0002dcf0: 2020 2020 2020 6669 672e 7375 6270 6c6f        fig.subplo
+0002dd00: 7473 5f61 646a 7573 7428 6873 7061 6365  ts_adjust(hspace
+0002dd10: 3d30 2e33 352c 2077 7370 6163 653d 302e  =0.35, wspace=0.
+0002dd20: 3229 0a20 2020 2020 2020 2070 6c74 2e73  2).        plt.s
+0002dd30: 686f 7728 290a 0a20 2020 2020 2020 2069  how()..        i
+0002dd40: 6620 6669 675f 6469 723a 0a20 2020 2020  f fig_dir:.     
+0002dd50: 2020 2020 2020 2066 6967 2e73 6176 6566         fig.savef
+0002dd60: 6967 2873 7472 2866 6967 5f64 6972 202f  ig(str(fig_dir /
+0002dd70: 2066 6967 5f6e 616d 6529 2c20 6470 693d   fig_name), dpi=
+0002dd80: 3330 302c 2062 626f 785f 696e 6368 6573  300, bbox_inches
+0002dd90: 3d22 7469 6768 7422 290a 0a20 2020 2064  ="tight")..    d
+0002dda0: 6566 2076 6973 7561 6c69 7a65 5f70 6f6c  ef visualize_pol
+0002ddb0: 6963 795f 7661 6c75 6528 0a20 2020 2020  icy_value(.     
+0002ddc0: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+0002ddd0: 2069 6e70 7574 5f64 6963 743a 2055 6e69   input_dict: Uni
+0002dde0: 6f6e 5b4f 5045 496e 7075 7444 6963 742c  on[OPEInputDict,
+0002ddf0: 204d 756c 7469 706c 6549 6e70 7574 4469   MultipleInputDi
+0002de00: 6374 5d2c 0a20 2020 2020 2020 2063 6f6d  ct],.        com
+0002de10: 7061 7265 645f 6573 7469 6d61 746f 7273  pared_estimators
+0002de20: 3a20 4f70 7469 6f6e 616c 5b4c 6973 745b  : Optional[List[
+0002de30: 7374 725d 5d20 3d20 4e6f 6e65 2c0a 2020  str]] = None,.  
+0002de40: 2020 2020 2020 6265 6861 7669 6f72 5f70        behavior_p
+0002de50: 6f6c 6963 795f 6e61 6d65 3a20 4f70 7469  olicy_name: Opti
+0002de60: 6f6e 616c 5b73 7472 5d20 3d20 4e6f 6e65  onal[str] = None
+0002de70: 2c0a 2020 2020 2020 2020 6461 7461 7365  ,.        datase
+0002de80: 745f 6964 3a20 4f70 7469 6f6e 616c 5b69  t_id: Optional[i
+0002de90: 6e74 5d20 3d20 4e6f 6e65 2c0a 2020 2020  nt] = None,.    
+0002dea0: 2020 2020 616c 7068 613a 2066 6c6f 6174      alpha: float
+0002deb0: 203d 2030 2e30 352c 0a20 2020 2020 2020   = 0.05,.       
+0002dec0: 2069 735f 7265 6c61 7469 7665 3a20 626f   is_relative: bo
+0002ded0: 6f6c 203d 2046 616c 7365 2c0a 2020 2020  ol = False,.    
+0002dee0: 2020 2020 6875 653a 2073 7472 203d 2022      hue: str = "
+0002def0: 6573 7469 6d61 746f 7222 2c0a 2020 2020  estimator",.    
+0002df00: 2020 2020 7368 6172 6579 3a20 626f 6f6c      sharey: bool
+0002df10: 203d 2046 616c 7365 2c0a 2020 2020 2020   = False,.      
+0002df20: 2020 6669 675f 6469 723a 204f 7074 696f    fig_dir: Optio
+0002df30: 6e61 6c5b 5061 7468 5d20 3d20 4e6f 6e65  nal[Path] = None
+0002df40: 2c0a 2020 2020 2020 2020 6669 675f 6e61  ,.        fig_na
+0002df50: 6d65 3a20 7374 7220 3d20 2265 7374 696d  me: str = "estim
+0002df60: 6174 6564 5f70 6f6c 6963 795f 7661 6c75  ated_policy_valu
+0002df70: 652e 706e 6722 2c0a 2020 2020 2920 2d3e  e.png",.    ) ->
+0002df80: 204e 6f6e 653a 0a20 2020 2020 2020 2022   None:.        "
+0002df90: 2222 5669 7375 616c 697a 6520 7468 6520  ""Visualize the 
+0002dfa0: 706f 6c69 6379 2076 616c 7565 2065 7374  policy value est
+0002dfb0: 696d 6174 6564 2062 7920 4f50 4520 6573  imated by OPE es
+0002dfc0: 7469 6d61 746f 7273 2e0a 0a20 2020 2020  timators...     
+0002dfd0: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
+0002dfe0: 2020 2020 2020 2d2d 2d2d 2d2d 2d0a 2020        -------.  
+0002dff0: 2020 2020 2020 696e 7075 745f 6469 6374        input_dict
+0002e000: 3a20 4f50 4549 6e70 7574 4469 6374 206f  : OPEInputDict o
+0002e010: 7220 4d75 6c74 6970 6c65 496e 7075 7444  r MultipleInputD
+0002e020: 6963 740a 2020 2020 2020 2020 2020 2020  ict.            
+0002e030: 4469 6374 696f 6e61 7279 206f 6620 7468  Dictionary of th
+0002e040: 6520 4f50 4520 696e 7075 7473 2066 6f72  e OPE inputs for
+0002e050: 2065 6163 6820 6576 616c 7561 7469 6f6e   each evaluation
+0002e060: 2070 6f6c 6963 792e 0a0a 2020 2020 2020   policy...      
+0002e070: 2020 2020 2020 2e2e 2063 6f64 652d 626c        .. code-bl
+0002e080: 6f63 6b3a 3a20 7079 7468 6f6e 0a0a 2020  ock:: python..  
+0002e090: 2020 2020 2020 2020 2020 2020 2020 6b65                ke
+0002e0a0: 793a 205b 6576 616c 7561 7469 6f6e 5f70  y: [evaluation_p
+0002e0b0: 6f6c 6963 795d 5b0a 2020 2020 2020 2020  olicy][.        
+0002e0c0: 2020 2020 2020 2020 2020 2020 6576 616c              eval
+0002e0d0: 7561 7469 6f6e 5f70 6f6c 6963 795f 6163  uation_policy_ac
+0002e0e0: 7469 6f6e 2c0a 2020 2020 2020 2020 2020  tion,.          
+0002e0f0: 2020 2020 2020 2020 2020 6576 616c 7561            evalua
+0002e100: 7469 6f6e 5f70 6f6c 6963 795f 6163 7469  tion_policy_acti
+0002e110: 6f6e 5f64 6973 742c 0a20 2020 2020 2020  on_dist,.       
+0002e120: 2020 2020 2020 2020 2020 2020 2073 7461               sta
+0002e130: 7465 5f61 6374 696f 6e5f 7661 6c75 655f  te_action_value_
+0002e140: 7072 6564 6963 7469 6f6e 2c0a 2020 2020  prediction,.    
+0002e150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e160: 696e 6974 6961 6c5f 7374 6174 655f 7661  initial_state_va
+0002e170: 6c75 655f 7072 6564 6963 7469 6f6e 2c0a  lue_prediction,.
+0002e180: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e190: 2020 2020 7374 6174 655f 6163 7469 6f6e      state_action
+0002e1a0: 5f6d 6172 6769 6e61 6c5f 696d 706f 7274  _marginal_import
+0002e1b0: 616e 6365 5f77 6569 6768 742c 0a20 2020  ance_weight,.   
+0002e1c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e1d0: 2073 7461 7465 5f6d 6172 6769 6e61 6c5f   state_marginal_
+0002e1e0: 696d 706f 7274 616e 6365 5f77 6569 6768  importance_weigh
+0002e1f0: 742c 0a20 2020 2020 2020 2020 2020 2020  t,.             
+0002e200: 2020 2020 2020 206f 6e5f 706f 6c69 6379         on_policy
+0002e210: 5f70 6f6c 6963 795f 7661 6c75 652c 0a20  _policy_value,. 
 0002e220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e230: 2020 2020 696e 6974 6961 6c5f 7374 6174      initial_stat
-0002e240: 655f 7661 6c75 655f 7072 6564 6963 7469  e_value_predicti
-0002e250: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
-0002e260: 2020 2020 2020 2020 7374 6174 655f 6163          state_ac
-0002e270: 7469 6f6e 5f6d 6172 6769 6e61 6c5f 696d  tion_marginal_im
-0002e280: 706f 7274 616e 6365 5f77 6569 6768 742c  portance_weight,
-0002e290: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002e2a0: 2020 2020 2073 7461 7465 5f6d 6172 6769       state_margi
-0002e2b0: 6e61 6c5f 696d 706f 7274 616e 6365 5f77  nal_importance_w
-0002e2c0: 6569 6768 742c 0a20 2020 2020 2020 2020  eight,.         
-0002e2d0: 2020 2020 2020 2020 2020 206f 6e5f 706f             on_po
-0002e2e0: 6c69 6379 5f70 6f6c 6963 795f 7661 6c75  licy_policy_valu
-0002e2f0: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
-0002e300: 2020 2020 2020 2067 616d 6d61 2c0a 2020         gamma,.  
-0002e310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002e320: 2020 6265 6861 7669 6f72 5f70 6f6c 6963    behavior_polic
-0002e330: 792c 0a20 2020 2020 2020 2020 2020 2020  y,.             
-0002e340: 2020 2020 2020 2065 7661 6c75 6174 696f         evaluatio
-0002e350: 6e5f 706f 6c69 6379 2c0a 2020 2020 2020  n_policy,.      
-0002e360: 2020 2020 2020 2020 2020 2020 2020 6461                da
-0002e370: 7461 7365 745f 6964 2c0a 2020 2020 2020  taset_id,.      
-0002e380: 2020 2020 2020 2020 2020 5d0a 0a20 2020            ]..   
-0002e390: 2020 2020 2020 2020 202e 2e20 7365 6561           .. seea
-0002e3a0: 6c73 6f3a 3a0a 0a20 2020 2020 2020 2020  lso::..         
-0002e3b0: 2020 2020 2020 203a 636c 6173 733a 6073         :class:`s
-0002e3c0: 636f 7065 5f72 6c2e 6f70 652e 696e 7075  cope_rl.ope.inpu
-0002e3d0: 742e 4372 6561 7465 4f50 4549 6e70 7574  t.CreateOPEInput
-0002e3e0: 6020 6465 7363 7269 6265 7320 7468 6520  ` describes the 
-0002e3f0: 636f 6d70 6f6e 656e 7473 206f 6620 3a63  components of :c
-0002e400: 6c61 7373 3a60 696e 7075 745f 6469 6374  lass:`input_dict
-0002e410: 602e 0a0a 2020 2020 2020 2020 636f 6d70  `...        comp
-0002e420: 6172 6564 5f65 7374 696d 6174 6f72 733a  ared_estimators:
-0002e430: 206c 6973 7420 6f66 2073 7472 2c20 6465   list of str, de
-0002e440: 6661 756c 743d 4e6f 6e65 0a20 2020 2020  fault=None.     
-0002e450: 2020 2020 2020 204e 616d 6520 6f66 2063         Name of c
-0002e460: 6f6d 7061 7265 6420 6573 7469 6d61 746f  ompared estimato
-0002e470: 7273 2e0a 2020 2020 2020 2020 2020 2020  rs..            
-0002e480: 4966 2060 4e6f 6e65 6020 6973 2067 6976  If `None` is giv
-0002e490: 656e 2c20 616c 6c20 7468 6520 6573 7469  en, all the esti
-0002e4a0: 6d61 746f 7273 2061 7265 2063 6f6d 7061  mators are compa
-0002e4b0: 7265 642e 0a0a 2020 2020 2020 2020 6265  red...        be
-0002e4c0: 6861 7669 6f72 5f70 6f6c 6963 795f 6e61  havior_policy_na
-0002e4d0: 6d65 3a20 7374 722c 2064 6566 6175 6c74  me: str, default
-0002e4e0: 3d4e 6f6e 650a 2020 2020 2020 2020 2020  =None.          
-0002e4f0: 2020 4e61 6d65 206f 6620 7468 6520 6265    Name of the be
-0002e500: 6861 7669 6f72 2070 6f6c 6963 792e 0a0a  havior policy...
-0002e510: 2020 2020 2020 2020 6461 7461 7365 745f          dataset_
-0002e520: 6964 3a20 696e 742c 2064 6566 6175 6c74  id: int, default
-0002e530: 3d4e 6f6e 650a 2020 2020 2020 2020 2020  =None.          
-0002e540: 2020 4964 206f 6620 7468 6520 6c6f 6767    Id of the logg
-0002e550: 6564 2064 6174 6173 6574 2e0a 0a20 2020  ed dataset...   
-0002e560: 2020 2020 2061 6c70 6861 3a20 666c 6f61       alpha: floa
-0002e570: 742c 2064 6566 6175 6c74 3d30 2e30 350a  t, default=0.05.
-0002e580: 2020 2020 2020 2020 2020 2020 5369 676e              Sign
-0002e590: 6966 6963 616e 6365 206c 6576 656c 2e20  ificance level. 
-0002e5a0: 5468 6520 7661 6c75 6520 7368 6f75 6c64  The value should
-0002e5b0: 2062 6520 7769 7468 696e 2060 5b30 2c20   be within `[0, 
-0002e5c0: 3129 602e 0a0a 2020 2020 2020 2020 6973  1)`...        is
-0002e5d0: 5f72 656c 6174 6976 653a 2062 6f6f 6c2c  _relative: bool,
-0002e5e0: 2064 6566 6175 6c74 3d46 616c 7365 0a20   default=False. 
-0002e5f0: 2020 2020 2020 2020 2020 2049 6620 6054             If `T
-0002e600: 7275 6560 2c20 7765 2067 6574 2074 6865  rue`, we get the
-0002e610: 2065 7374 696d 6174 6564 2070 6f6c 6963   estimated polic
-0002e620: 7920 7661 6c75 6573 206f 6620 7468 6520  y values of the 
-0002e630: 6576 616c 7561 7469 6f6e 2070 6f6c 6963  evaluation polic
-0002e640: 6965 730a 2020 2020 2020 2020 2020 2020  ies.            
-0002e650: 7265 6c61 7469 7665 2074 6f20 7468 6520  relative to the 
-0002e660: 6772 6f75 6e64 2d74 7275 7468 2070 6f6c  ground-truth pol
-0002e670: 6963 7920 7661 6c75 6520 6f66 2074 6865  icy value of the
-0002e680: 2062 6568 6176 696f 7220 706f 6c69 6379   behavior policy
-0002e690: 2e0a 0a20 2020 2020 2020 2068 7565 3a20  ...        hue: 
-0002e6a0: 7b22 6573 7469 6d61 746f 7222 2c20 2270  {"estimator", "p
-0002e6b0: 6f6c 6963 7922 7d2c 2064 6566 6175 6c74  olicy"}, default
-0002e6c0: 3d22 6573 7469 6d61 746f 7222 0a20 2020  ="estimator".   
-0002e6d0: 2020 2020 2020 2020 2048 7565 206f 6620           Hue of 
-0002e6e0: 7468 6520 706c 6f74 2e0a 0a20 2020 2020  the plot...     
-0002e6f0: 2020 2073 6861 7265 793a 2062 6f6f 6c2c     sharey: bool,
-0002e700: 2064 6566 6175 6c74 3d46 616c 7365 0a20   default=False. 
-0002e710: 2020 2020 2020 2020 2020 2049 6620 6054             If `T
-0002e720: 7275 6560 2c20 7468 6520 792d 6178 6973  rue`, the y-axis
-0002e730: 2077 696c 6c20 6265 2073 6861 7265 6420   will be shared 
-0002e740: 616d 6f6e 6720 6469 6666 6572 656e 7420  among different 
-0002e750: 6576 616c 7561 7469 6f6e 2070 6f6c 6963  evaluation polic
-0002e760: 6965 732e 0a0a 2020 2020 2020 2020 6669  ies...        fi
-0002e770: 675f 6469 723a 2050 6174 682c 2064 6566  g_dir: Path, def
-0002e780: 6175 6c74 3d4e 6f6e 650a 2020 2020 2020  ault=None.      
-0002e790: 2020 2020 2020 5061 7468 2074 6f20 7374        Path to st
-0002e7a0: 6f72 6520 7468 6520 6261 7220 6669 6775  ore the bar figu
-0002e7b0: 7265 2e0a 2020 2020 2020 2020 2020 2020  re..            
-0002e7c0: 4966 2060 4e6f 6e65 6020 6973 2067 6976  If `None` is giv
-0002e7d0: 656e 2c20 7468 6520 6669 6775 7265 2077  en, the figure w
-0002e7e0: 696c 6c20 6e6f 7420 6265 2073 6176 6564  ill not be saved
-0002e7f0: 2e0a 0a20 2020 2020 2020 2066 6967 5f6e  ...        fig_n
-0002e800: 616d 653a 2073 7472 2c20 6465 6661 756c  ame: str, defaul
-0002e810: 743d 2265 7374 696d 6174 6564 5f70 6f6c  t="estimated_pol
-0002e820: 6963 795f 7661 6c75 652e 706e 6722 0a20  icy_value.png". 
-0002e830: 2020 2020 2020 2020 2020 204e 616d 6520             Name 
-0002e840: 6f66 2074 6865 2062 6172 2066 6967 7572  of the bar figur
-0002e850: 652e 0a0a 2020 2020 2020 2020 2222 220a  e...        """.
-0002e860: 2020 2020 2020 2020 636f 6d70 6172 6564          compared
-0002e870: 5f65 7374 696d 6174 6f72 7320 3d20 7365  _estimators = se
-0002e880: 6c66 2e5f 6368 6563 6b5f 636f 6d70 6172  lf._check_compar
-0002e890: 6564 5f65 7374 696d 6174 6f72 7328 636f  ed_estimators(co
-0002e8a0: 6d70 6172 6564 5f65 7374 696d 6174 6f72  mpared_estimator
-0002e8b0: 7329 0a20 2020 2020 2020 2073 656c 662e  s).        self.
-0002e8c0: 5f63 6865 636b 5f62 6173 6963 5f76 6973  _check_basic_vis
-0002e8d0: 7561 6c69 7a61 7469 6f6e 5f69 6e70 7574  ualization_input
-0002e8e0: 7328 0a20 2020 2020 2020 2020 2020 2068  s(.            h
-0002e8f0: 7565 3d68 7565 2c20 6669 675f 6469 723d  ue=hue, fig_dir=
-0002e900: 6669 675f 6469 722c 2066 6967 5f6e 616d  fig_dir, fig_nam
-0002e910: 653d 6669 675f 6e61 6d65 0a20 2020 2020  e=fig_name.     
-0002e920: 2020 2029 0a20 2020 2020 2020 2063 6865     ).        che
-0002e930: 636b 5f73 6361 6c61 7228 616c 7068 612c  ck_scalar(alpha,
-0002e940: 206e 616d 653d 2261 6c70 6861 222c 2074   name="alpha", t
-0002e950: 6172 6765 745f 7479 7065 3d66 6c6f 6174  arget_type=float
-0002e960: 2c20 6d69 6e5f 7661 6c3d 302e 302c 206d  , min_val=0.0, m
-0002e970: 6178 5f76 616c 3d31 2e30 290a 0a20 2020  ax_val=1.0)..   
-0002e980: 2020 2020 2069 6620 7365 6c66 2e75 7365       if self.use
-0002e990: 5f6d 756c 7469 706c 655f 6c6f 6767 6564  _multiple_logged
-0002e9a0: 5f64 6174 6173 6574 3a0a 2020 2020 2020  _dataset:.      
-0002e9b0: 2020 2020 2020 6966 2062 6568 6176 696f        if behavio
-0002e9c0: 725f 706f 6c69 6379 5f6e 616d 6520 6973  r_policy_name is
-0002e9d0: 204e 6f6e 6520 6f72 2064 6174 6173 6574   None or dataset
-0002e9e0: 5f69 6420 6973 204e 6f6e 653a 0a20 2020  _id is None:.   
-0002e9f0: 2020 2020 2020 2020 2020 2020 2072 6169               rai
-0002ea00: 7365 2056 616c 7565 4572 726f 7228 0a20  se ValueError(. 
-0002ea10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ea20: 2020 2022 6265 6861 7669 6f72 5f70 6f6c     "behavior_pol
-0002ea30: 6963 7920 616e 6420 6461 7461 7365 745f  icy and dataset_
-0002ea40: 6964 206d 7573 7420 6265 2073 7065 6369  id must be speci
-0002ea50: 6669 6564 2077 6865 6e20 7573 696e 6720  fied when using 
-0002ea60: 4d75 6c74 6970 6c65 4c6f 6767 6564 4461  MultipleLoggedDa
-0002ea70: 7461 7365 742e 220a 2020 2020 2020 2020  taset.".        
-0002ea80: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0002ea90: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
-0002eaa0: 6e63 6528 696e 7075 745f 6469 6374 2c20  nce(input_dict, 
-0002eab0: 4d75 6c74 6970 6c65 496e 7075 7444 6963  MultipleInputDic
-0002eac0: 7429 3a0a 2020 2020 2020 2020 2020 2020  t):.            
-0002ead0: 2020 2020 696e 7075 745f 6469 6374 203d      input_dict =
-0002eae0: 2069 6e70 7574 5f64 6963 742e 6765 7428   input_dict.get(
-0002eaf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002eb00: 2020 2020 2062 6568 6176 696f 725f 706f       behavior_po
-0002eb10: 6c69 6379 5f6e 616d 653d 6265 6861 7669  licy_name=behavi
-0002eb20: 6f72 5f70 6f6c 6963 795f 6e61 6d65 2c20  or_policy_name, 
-0002eb30: 6461 7461 7365 745f 6964 3d64 6174 6173  dataset_id=datas
-0002eb40: 6574 5f69 640a 2020 2020 2020 2020 2020  et_id.          
-0002eb50: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-0002eb60: 6368 6563 6b5f 696e 7075 745f 6469 6374  check_input_dict
-0002eb70: 2869 6e70 7574 5f64 6963 7429 0a0a 2020  (input_dict)..  
-0002eb80: 2020 2020 2020 6d65 616e 5f64 6963 7420        mean_dict 
-0002eb90: 3d20 7365 6c66 2e65 7374 696d 6174 655f  = self.estimate_
-0002eba0: 6d65 616e 280a 2020 2020 2020 2020 2020  mean(.          
-0002ebb0: 2020 696e 7075 745f 6469 6374 2c0a 2020    input_dict,.  
-0002ebc0: 2020 2020 2020 2020 2020 636f 6d70 6172            compar
-0002ebd0: 6564 5f65 7374 696d 6174 6f72 733d 636f  ed_estimators=co
-0002ebe0: 6d70 6172 6564 5f65 7374 696d 6174 6f72  mpared_estimator
-0002ebf0: 732c 0a20 2020 2020 2020 2020 2020 2062  s,.            b
-0002ec00: 6568 6176 696f 725f 706f 6c69 6379 5f6e  ehavior_policy_n
-0002ec10: 616d 653d 6265 6861 7669 6f72 5f70 6f6c  ame=behavior_pol
-0002ec20: 6963 795f 6e61 6d65 2c0a 2020 2020 2020  icy_name,.      
-0002ec30: 2020 2020 2020 6461 7461 7365 745f 6964        dataset_id
-0002ec40: 3d64 6174 6173 6574 5f69 642c 0a20 2020  =dataset_id,.   
-0002ec50: 2020 2020 2029 0a20 2020 2020 2020 2076       ).        v
-0002ec60: 6172 6961 6e63 655f 6469 6374 203d 2073  ariance_dict = s
-0002ec70: 656c 662e 6573 7469 6d61 7465 5f76 6172  elf.estimate_var
-0002ec80: 6961 6e63 6528 0a20 2020 2020 2020 2020  iance(.         
-0002ec90: 2020 2069 6e70 7574 5f64 6963 742c 0a20     input_dict,. 
-0002eca0: 2020 2020 2020 2020 2020 2063 6f6d 7061             compa
-0002ecb0: 7265 645f 6573 7469 6d61 746f 7273 3d63  red_estimators=c
-0002ecc0: 6f6d 7061 7265 645f 6573 7469 6d61 746f  ompared_estimato
-0002ecd0: 7273 2c0a 2020 2020 2020 2020 2020 2020  rs,.            
-0002ece0: 6265 6861 7669 6f72 5f70 6f6c 6963 795f  behavior_policy_
-0002ecf0: 6e61 6d65 3d62 6568 6176 696f 725f 706f  name=behavior_po
-0002ed00: 6c69 6379 5f6e 616d 652c 0a20 2020 2020  licy_name,.     
-0002ed10: 2020 2020 2020 2064 6174 6173 6574 5f69         dataset_i
-0002ed20: 643d 6461 7461 7365 745f 6964 2c0a 2020  d=dataset_id,.  
-0002ed30: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-0002ed40: 2069 6620 6973 5f72 656c 6174 6976 653a   if is_relative:
-0002ed50: 0a20 2020 2020 2020 2020 2020 2067 616d  .            gam
-0002ed60: 6d61 203d 2069 6e70 7574 5f64 6963 745b  ma = input_dict[
-0002ed70: 6c69 7374 2869 6e70 7574 5f64 6963 742e  list(input_dict.
-0002ed80: 6b65 7973 2829 295b 305d 5d5b 2267 616d  keys())[0]]["gam
-0002ed90: 6d61 225d 0a20 2020 2020 2020 2020 2020  ma"].           
-0002eda0: 2064 6973 636f 756e 7420 3d20 6e70 2e66   discount = np.f
-0002edb0: 756c 6c28 7365 6c66 2e73 7465 705f 7065  ull(self.step_pe
-0002edc0: 725f 7472 616a 6563 746f 7279 2c20 6761  r_trajectory, ga
-0002edd0: 6d6d 6129 2e63 756d 7072 6f64 2829 202f  mma).cumprod() /
-0002ede0: 2067 616d 6d61 0a20 2020 2020 2020 2020   gamma.         
-0002edf0: 2020 2062 6568 6176 696f 725f 706f 6c69     behavior_poli
-0002ee00: 6379 5f76 616c 7565 203d 2028 0a20 2020  cy_value = (.   
-0002ee10: 2020 2020 2020 2020 2020 2020 2064 6973               dis
-0002ee20: 636f 756e 745b 6e70 2e6e 6577 6178 6973  count[np.newaxis
-0002ee30: 2c20 3a5d 202a 2073 656c 662e 6265 6861  , :] * self.beha
-0002ee40: 7669 6f72 5f70 6f6c 6963 795f 7265 7761  vior_policy_rewa
-0002ee50: 7264 0a20 2020 2020 2020 2020 2020 2029  rd.            )
-0002ee60: 2e73 756d 280a 2020 2020 2020 2020 2020  .sum(.          
-0002ee70: 2020 2020 2020 6178 6973 3d31 0a20 2020        axis=1.   
-0002ee80: 2020 2020 2020 2020 2029 2e6d 6561 6e28           ).mean(
-0002ee90: 2920 2b20 3165 2d31 3020 2023 2074 6f20  ) + 1e-10  # to 
-0002eea0: 6176 6f69 6420 7a65 726f 2064 6976 6973  avoid zero divis
-0002eeb0: 696f 6e0a 0a20 2020 2020 2020 2070 6c74  ion..        plt
-0002eec0: 2e73 7479 6c65 2e75 7365 2822 6767 706c  .style.use("ggpl
-0002eed0: 6f74 2229 0a20 2020 2020 2020 2063 6f6c  ot").        col
-0002eee0: 6f72 203d 2070 6c74 2e72 6350 6172 616d  or = plt.rcParam
-0002eef0: 735b 2261 7865 732e 7072 6f70 5f63 7963  s["axes.prop_cyc
-0002ef00: 6c65 225d 2e62 795f 6b65 7928 295b 2263  le"].by_key()["c
-0002ef10: 6f6c 6f72 225d 0a20 2020 2020 2020 206e  olor"].        n
-0002ef20: 5f63 6f6c 6f72 7320 3d20 6c65 6e28 636f  _colors = len(co
-0002ef30: 6c6f 7229 0a0a 2020 2020 2020 2020 6e5f  lor)..        n_
-0002ef40: 706f 6c69 6369 6573 203d 206c 656e 2869  policies = len(i
-0002ef50: 6e70 7574 5f64 6963 7429 0a20 2020 2020  nput_dict).     
-0002ef60: 2020 206e 5f65 7374 696d 6174 6f72 7320     n_estimators 
-0002ef70: 3d20 6c65 6e28 636f 6d70 6172 6564 5f65  = len(compared_e
-0002ef80: 7374 696d 6174 6f72 7329 0a0a 2020 2020  stimators)..    
-0002ef90: 2020 2020 6966 2068 7565 203d 3d20 2265      if hue == "e
-0002efa0: 7374 696d 6174 6f72 223a 0a20 2020 2020  stimator":.     
-0002efb0: 2020 2020 2020 2066 6967 203d 2070 6c74         fig = plt
-0002efc0: 2e66 6967 7572 6528 6669 6773 697a 653d  .figure(figsize=
-0002efd0: 2832 202a 206e 5f65 7374 696d 6174 6f72  (2 * n_estimator
-0002efe0: 732c 2034 202a 206e 5f70 6f6c 6963 6965  s, 4 * n_policie
-0002eff0: 7329 290a 0a20 2020 2020 2020 2020 2020  s))..           
-0002f000: 2066 6f72 2069 2c20 6576 616c 5f70 6f6c   for i, eval_pol
-0002f010: 6963 7920 696e 2065 6e75 6d65 7261 7465  icy in enumerate
-0002f020: 2869 6e70 7574 5f64 6963 742e 6b65 7973  (input_dict.keys
-0002f030: 2829 293a 0a20 2020 2020 2020 2020 2020  ()):.           
-0002f040: 2020 2020 2069 6620 6920 3d3d 2030 3a0a       if i == 0:.
-0002f050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f060: 2020 2020 6178 203d 2061 7830 203d 2066      ax = ax0 = f
-0002f070: 6967 2e61 6464 5f73 7562 706c 6f74 286c  ig.add_subplot(l
-0002f080: 656e 2869 6e70 7574 5f64 6963 7429 2c20  en(input_dict), 
-0002f090: 312c 2069 202b 2031 290a 2020 2020 2020  1, i + 1).      
-0002f0a0: 2020 2020 2020 2020 2020 656c 6966 2073            elif s
-0002f0b0: 6861 7265 793a 0a20 2020 2020 2020 2020  harey:.         
-0002f0c0: 2020 2020 2020 2020 2020 2061 7820 3d20             ax = 
-0002f0d0: 6669 672e 6164 645f 7375 6270 6c6f 7428  fig.add_subplot(
-0002f0e0: 6c65 6e28 696e 7075 745f 6469 6374 292c  len(input_dict),
-0002f0f0: 2031 2c20 6920 2b20 312c 2073 6861 7265   1, i + 1, share
-0002f100: 793d 6178 3029 0a20 2020 2020 2020 2020  y=ax0).         
-0002f110: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-0002f120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f130: 2061 7820 3d20 6669 672e 6164 645f 7375   ax = fig.add_su
-0002f140: 6270 6c6f 7428 6c65 6e28 696e 7075 745f  bplot(len(input_
-0002f150: 6469 6374 292c 2031 2c20 6920 2b20 3129  dict), 1, i + 1)
-0002f160: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0002f170: 2020 6f6e 5f70 6f6c 6963 795f 6d65 616e    on_policy_mean
-0002f180: 203d 206d 6561 6e5f 6469 6374 5b65 7661   = mean_dict[eva
-0002f190: 6c5f 706f 6c69 6379 5d2e 706f 7028 226f  l_policy].pop("o
-0002f1a0: 6e5f 706f 6c69 6379 2229 0a20 2020 2020  n_policy").     
-0002f1b0: 2020 2020 2020 2020 2020 206f 6e5f 706f             on_po
-0002f1c0: 6c69 6379 5f76 6172 6961 6e63 6520 3d20  licy_variance = 
-0002f1d0: 7661 7269 616e 6365 5f64 6963 745b 6576  variance_dict[ev
-0002f1e0: 616c 5f70 6f6c 6963 795d 2e70 6f70 2822  al_policy].pop("
-0002f1f0: 6f6e 5f70 6f6c 6963 7922 290a 0a20 2020  on_policy")..   
-0002f200: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-0002f210: 6f6e 5f70 6f6c 6963 795f 6d65 616e 2069  on_policy_mean i
-0002f220: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
-0002f230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f240: 6f6e 5f70 6f6c 6963 795f 7570 7065 722c  on_policy_upper,
-0002f250: 206f 6e5f 706f 6c69 6379 5f6c 6f77 6572   on_policy_lower
-0002f260: 203d 206e 6f72 6d2e 696e 7465 7276 616c   = norm.interval
-0002f270: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0002f280: 2020 2020 2020 2020 2020 3120 2d20 616c            1 - al
-0002f290: 7068 612c 206c 6f63 3d6f 6e5f 706f 6c69  pha, loc=on_poli
-0002f2a0: 6379 5f6d 6561 6e2c 2073 6361 6c65 3d6e  cy_mean, scale=n
-0002f2b0: 702e 7371 7274 286f 6e5f 706f 6c69 6379  p.sqrt(on_policy
-0002f2c0: 5f76 6172 6961 6e63 6529 0a20 2020 2020  _variance).     
-0002f2d0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-0002f2e0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0002f2f0: 2020 6d65 616e 203d 206e 702e 6172 7261    mean = np.arra
-0002f300: 7928 6c69 7374 286d 6561 6e5f 6469 6374  y(list(mean_dict
-0002f310: 5b65 7661 6c5f 706f 6c69 6379 5d2e 7661  [eval_policy].va
-0002f320: 6c75 6573 2829 292c 2064 7479 7065 3d66  lues()), dtype=f
-0002f330: 6c6f 6174 290a 2020 2020 2020 2020 2020  loat).          
-0002f340: 2020 2020 2020 7661 7269 616e 6365 203d        variance =
-0002f350: 206e 702e 6172 7261 7928 0a20 2020 2020   np.array(.     
-0002f360: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-0002f370: 6973 7428 7661 7269 616e 6365 5f64 6963  ist(variance_dic
-0002f380: 745b 6576 616c 5f70 6f6c 6963 795d 2e76  t[eval_policy].v
-0002f390: 616c 7565 7328 2929 2c20 6474 7970 653d  alues()), dtype=
-0002f3a0: 666c 6f61 740a 2020 2020 2020 2020 2020  float.          
-0002f3b0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-0002f3c0: 2020 2020 2020 2020 6c6f 7765 722c 2075          lower, u
-0002f3d0: 7070 6572 203d 206e 6f72 6d2e 696e 7465  pper = norm.inte
-0002f3e0: 7276 616c 280a 2020 2020 2020 2020 2020  rval(.          
-0002f3f0: 2020 2020 2020 2020 2020 3120 2d20 616c            1 - al
-0002f400: 7068 612c 206c 6f63 3d6d 6561 6e2c 2073  pha, loc=mean, s
-0002f410: 6361 6c65 3d6e 702e 7371 7274 2876 6172  cale=np.sqrt(var
-0002f420: 6961 6e63 6529 0a20 2020 2020 2020 2020  iance).         
-0002f430: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-0002f440: 2020 2020 2020 2020 2020 6966 2069 735f            if is_
-0002f450: 7265 6c61 7469 7665 3a0a 2020 2020 2020  relative:.      
-0002f460: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0002f470: 206f 6e5f 706f 6c69 6379 5f6d 6561 6e20   on_policy_mean 
-0002f480: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
-0002f490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f4a0: 2020 2020 206f 6e5f 706f 6c69 6379 5f6d       on_policy_m
-0002f4b0: 6561 6e20 3d20 6f6e 5f70 6f6c 6963 795f  ean = on_policy_
-0002f4c0: 6d65 616e 202f 2062 6568 6176 696f 725f  mean / behavior_
-0002f4d0: 706f 6c69 6379 5f76 616c 7565 0a20 2020  policy_value.   
-0002f4e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f4f0: 2020 2020 206f 6e5f 706f 6c69 6379 5f75       on_policy_u
-0002f500: 7070 6572 203d 206f 6e5f 706f 6c69 6379  pper = on_policy
-0002f510: 5f75 7070 6572 202f 2062 6568 6176 696f  _upper / behavio
-0002f520: 725f 706f 6c69 6379 5f76 616c 7565 0a20  r_policy_value. 
-0002f530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f540: 2020 2020 2020 206f 6e5f 706f 6c69 6379         on_policy
-0002f550: 5f6c 6f77 6572 203d 206f 6e5f 706f 6c69  _lower = on_poli
-0002f560: 6379 5f6c 6f77 6572 202f 2062 6568 6176  cy_lower / behav
-0002f570: 696f 725f 706f 6c69 6379 5f76 616c 7565  ior_policy_value
-0002f580: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0002f590: 2020 2020 2020 6d65 616e 203d 206d 6561        mean = mea
-0002f5a0: 6e20 2f20 6265 6861 7669 6f72 5f70 6f6c  n / behavior_pol
-0002f5b0: 6963 795f 7661 6c75 650a 2020 2020 2020  icy_value.      
-0002f5c0: 2020 2020 2020 2020 2020 2020 2020 7570                up
-0002f5d0: 7065 7220 3d20 7570 7065 7220 2f20 6265  per = upper / be
-0002f5e0: 6861 7669 6f72 5f70 6f6c 6963 795f 7661  havior_policy_va
-0002f5f0: 6c75 650a 2020 2020 2020 2020 2020 2020  lue.            
-0002f600: 2020 2020 2020 2020 6c6f 7765 7220 3d20          lower = 
-0002f610: 6c6f 7765 7220 2f20 6265 6861 7669 6f72  lower / behavior
-0002f620: 5f70 6f6c 6963 795f 7661 6c75 650a 0a20  _policy_value.. 
-0002f630: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0002f640: 6f72 206a 2069 6e20 7261 6e67 6528 6e5f  or j in range(n_
-0002f650: 6573 7469 6d61 746f 7273 293a 0a20 2020  estimators):.   
-0002f660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f670: 2061 782e 6572 726f 7262 6172 280a 2020   ax.errorbar(.  
+0002e230: 2020 2067 616d 6d61 2c0a 2020 2020 2020     gamma,.      
+0002e240: 2020 2020 2020 2020 2020 2020 2020 6265                be
+0002e250: 6861 7669 6f72 5f70 6f6c 6963 792c 0a20  havior_policy,. 
+0002e260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e270: 2020 2065 7661 6c75 6174 696f 6e5f 706f     evaluation_po
+0002e280: 6c69 6379 2c0a 2020 2020 2020 2020 2020  licy,.          
+0002e290: 2020 2020 2020 2020 2020 6461 7461 7365            datase
+0002e2a0: 745f 6964 2c0a 2020 2020 2020 2020 2020  t_id,.          
+0002e2b0: 2020 2020 2020 5d0a 0a20 2020 2020 2020        ]..       
+0002e2c0: 2020 2020 202e 2e20 7365 6561 6c73 6f3a       .. seealso:
+0002e2d0: 3a0a 0a20 2020 2020 2020 2020 2020 2020  :..             
+0002e2e0: 2020 203a 636c 6173 733a 6073 636f 7065     :class:`scope
+0002e2f0: 5f72 6c2e 6f70 652e 696e 7075 742e 4372  _rl.ope.input.Cr
+0002e300: 6561 7465 4f50 4549 6e70 7574 6020 6465  eateOPEInput` de
+0002e310: 7363 7269 6265 7320 7468 6520 636f 6d70  scribes the comp
+0002e320: 6f6e 656e 7473 206f 6620 3a63 6c61 7373  onents of :class
+0002e330: 3a60 696e 7075 745f 6469 6374 602e 0a0a  :`input_dict`...
+0002e340: 2020 2020 2020 2020 636f 6d70 6172 6564          compared
+0002e350: 5f65 7374 696d 6174 6f72 733a 206c 6973  _estimators: lis
+0002e360: 7420 6f66 2073 7472 2c20 6465 6661 756c  t of str, defaul
+0002e370: 743d 4e6f 6e65 0a20 2020 2020 2020 2020  t=None.         
+0002e380: 2020 204e 616d 6520 6f66 2063 6f6d 7061     Name of compa
+0002e390: 7265 6420 6573 7469 6d61 746f 7273 2e0a  red estimators..
+0002e3a0: 2020 2020 2020 2020 2020 2020 4966 2060              If `
+0002e3b0: 4e6f 6e65 6020 6973 2067 6976 656e 2c20  None` is given, 
+0002e3c0: 616c 6c20 7468 6520 6573 7469 6d61 746f  all the estimato
+0002e3d0: 7273 2061 7265 2063 6f6d 7061 7265 642e  rs are compared.
+0002e3e0: 0a0a 2020 2020 2020 2020 6265 6861 7669  ..        behavi
+0002e3f0: 6f72 5f70 6f6c 6963 795f 6e61 6d65 3a20  or_policy_name: 
+0002e400: 7374 722c 2064 6566 6175 6c74 3d4e 6f6e  str, default=Non
+0002e410: 650a 2020 2020 2020 2020 2020 2020 4e61  e.            Na
+0002e420: 6d65 206f 6620 7468 6520 6265 6861 7669  me of the behavi
+0002e430: 6f72 2070 6f6c 6963 792e 0a0a 2020 2020  or policy...    
+0002e440: 2020 2020 6461 7461 7365 745f 6964 3a20      dataset_id: 
+0002e450: 696e 742c 2064 6566 6175 6c74 3d4e 6f6e  int, default=Non
+0002e460: 650a 2020 2020 2020 2020 2020 2020 4964  e.            Id
+0002e470: 206f 6620 7468 6520 6c6f 6767 6564 2064   of the logged d
+0002e480: 6174 6173 6574 2e0a 0a20 2020 2020 2020  ataset...       
+0002e490: 2061 6c70 6861 3a20 666c 6f61 742c 2064   alpha: float, d
+0002e4a0: 6566 6175 6c74 3d30 2e30 350a 2020 2020  efault=0.05.    
+0002e4b0: 2020 2020 2020 2020 5369 676e 6966 6963          Signific
+0002e4c0: 616e 6365 206c 6576 656c 2e20 5468 6520  ance level. The 
+0002e4d0: 7661 6c75 6520 7368 6f75 6c64 2062 6520  value should be 
+0002e4e0: 7769 7468 696e 2060 5b30 2c20 3129 602e  within `[0, 1)`.
+0002e4f0: 0a0a 2020 2020 2020 2020 6973 5f72 656c  ..        is_rel
+0002e500: 6174 6976 653a 2062 6f6f 6c2c 2064 6566  ative: bool, def
+0002e510: 6175 6c74 3d46 616c 7365 0a20 2020 2020  ault=False.     
+0002e520: 2020 2020 2020 2049 6620 6054 7275 6560         If `True`
+0002e530: 2c20 7765 2067 6574 2074 6865 2065 7374  , we get the est
+0002e540: 696d 6174 6564 2070 6f6c 6963 7920 7661  imated policy va
+0002e550: 6c75 6573 206f 6620 7468 6520 6576 616c  lues of the eval
+0002e560: 7561 7469 6f6e 2070 6f6c 6963 6965 730a  uation policies.
+0002e570: 2020 2020 2020 2020 2020 2020 7265 6c61              rela
+0002e580: 7469 7665 2074 6f20 7468 6520 6772 6f75  tive to the grou
+0002e590: 6e64 2d74 7275 7468 2070 6f6c 6963 7920  nd-truth policy 
+0002e5a0: 7661 6c75 6520 6f66 2074 6865 2062 6568  value of the beh
+0002e5b0: 6176 696f 7220 706f 6c69 6379 2e0a 0a20  avior policy... 
+0002e5c0: 2020 2020 2020 2068 7565 3a20 7b22 6573         hue: {"es
+0002e5d0: 7469 6d61 746f 7222 2c20 2270 6f6c 6963  timator", "polic
+0002e5e0: 7922 7d2c 2064 6566 6175 6c74 3d22 6573  y"}, default="es
+0002e5f0: 7469 6d61 746f 7222 0a20 2020 2020 2020  timator".       
+0002e600: 2020 2020 2048 7565 206f 6620 7468 6520       Hue of the 
+0002e610: 706c 6f74 2e0a 0a20 2020 2020 2020 2073  plot...        s
+0002e620: 6861 7265 793a 2062 6f6f 6c2c 2064 6566  harey: bool, def
+0002e630: 6175 6c74 3d46 616c 7365 0a20 2020 2020  ault=False.     
+0002e640: 2020 2020 2020 2049 6620 6054 7275 6560         If `True`
+0002e650: 2c20 7468 6520 792d 6178 6973 2077 696c  , the y-axis wil
+0002e660: 6c20 6265 2073 6861 7265 6420 616d 6f6e  l be shared amon
+0002e670: 6720 6469 6666 6572 656e 7420 6576 616c  g different eval
+0002e680: 7561 7469 6f6e 2070 6f6c 6963 6965 732e  uation policies.
+0002e690: 0a0a 2020 2020 2020 2020 6669 675f 6469  ..        fig_di
+0002e6a0: 723a 2050 6174 682c 2064 6566 6175 6c74  r: Path, default
+0002e6b0: 3d4e 6f6e 650a 2020 2020 2020 2020 2020  =None.          
+0002e6c0: 2020 5061 7468 2074 6f20 7374 6f72 6520    Path to store 
+0002e6d0: 7468 6520 6261 7220 6669 6775 7265 2e0a  the bar figure..
+0002e6e0: 2020 2020 2020 2020 2020 2020 4966 2060              If `
+0002e6f0: 4e6f 6e65 6020 6973 2067 6976 656e 2c20  None` is given, 
+0002e700: 7468 6520 6669 6775 7265 2077 696c 6c20  the figure will 
+0002e710: 6e6f 7420 6265 2073 6176 6564 2e0a 0a20  not be saved... 
+0002e720: 2020 2020 2020 2066 6967 5f6e 616d 653a         fig_name:
+0002e730: 2073 7472 2c20 6465 6661 756c 743d 2265   str, default="e
+0002e740: 7374 696d 6174 6564 5f70 6f6c 6963 795f  stimated_policy_
+0002e750: 7661 6c75 652e 706e 6722 0a20 2020 2020  value.png".     
+0002e760: 2020 2020 2020 204e 616d 6520 6f66 2074         Name of t
+0002e770: 6865 2062 6172 2066 6967 7572 652e 0a0a  he bar figure...
+0002e780: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0002e790: 2020 2020 636f 6d70 6172 6564 5f65 7374      compared_est
+0002e7a0: 696d 6174 6f72 7320 3d20 7365 6c66 2e5f  imators = self._
+0002e7b0: 6368 6563 6b5f 636f 6d70 6172 6564 5f65  check_compared_e
+0002e7c0: 7374 696d 6174 6f72 7328 636f 6d70 6172  stimators(compar
+0002e7d0: 6564 5f65 7374 696d 6174 6f72 7329 0a20  ed_estimators). 
+0002e7e0: 2020 2020 2020 2073 656c 662e 5f63 6865         self._che
+0002e7f0: 636b 5f62 6173 6963 5f76 6973 7561 6c69  ck_basic_visuali
+0002e800: 7a61 7469 6f6e 5f69 6e70 7574 7328 0a20  zation_inputs(. 
+0002e810: 2020 2020 2020 2020 2020 2068 7565 3d68             hue=h
+0002e820: 7565 2c20 6669 675f 6469 723d 6669 675f  ue, fig_dir=fig_
+0002e830: 6469 722c 2066 6967 5f6e 616d 653d 6669  dir, fig_name=fi
+0002e840: 675f 6e61 6d65 0a20 2020 2020 2020 2029  g_name.        )
+0002e850: 0a20 2020 2020 2020 2063 6865 636b 5f73  .        check_s
+0002e860: 6361 6c61 7228 616c 7068 612c 206e 616d  calar(alpha, nam
+0002e870: 653d 2261 6c70 6861 222c 2074 6172 6765  e="alpha", targe
+0002e880: 745f 7479 7065 3d66 6c6f 6174 2c20 6d69  t_type=float, mi
+0002e890: 6e5f 7661 6c3d 302e 302c 206d 6178 5f76  n_val=0.0, max_v
+0002e8a0: 616c 3d31 2e30 290a 0a20 2020 2020 2020  al=1.0)..       
+0002e8b0: 2069 6620 7365 6c66 2e75 7365 5f6d 756c   if self.use_mul
+0002e8c0: 7469 706c 655f 6c6f 6767 6564 5f64 6174  tiple_logged_dat
+0002e8d0: 6173 6574 3a0a 2020 2020 2020 2020 2020  aset:.          
+0002e8e0: 2020 6966 2062 6568 6176 696f 725f 706f    if behavior_po
+0002e8f0: 6c69 6379 5f6e 616d 6520 6973 204e 6f6e  licy_name is Non
+0002e900: 6520 6f72 2064 6174 6173 6574 5f69 6420  e or dataset_id 
+0002e910: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
+0002e920: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+0002e930: 616c 7565 4572 726f 7228 0a20 2020 2020  alueError(.     
+0002e940: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0002e950: 6265 6861 7669 6f72 5f70 6f6c 6963 7920  behavior_policy 
+0002e960: 616e 6420 6461 7461 7365 745f 6964 206d  and dataset_id m
+0002e970: 7573 7420 6265 2073 7065 6369 6669 6564  ust be specified
+0002e980: 2077 6865 6e20 7573 696e 6720 4d75 6c74   when using Mult
+0002e990: 6970 6c65 4c6f 6767 6564 4461 7461 7365  ipleLoggedDatase
+0002e9a0: 742e 220a 2020 2020 2020 2020 2020 2020  t.".            
+0002e9b0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+0002e9c0: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+0002e9d0: 696e 7075 745f 6469 6374 2c20 4d75 6c74  input_dict, Mult
+0002e9e0: 6970 6c65 496e 7075 7444 6963 7429 3a0a  ipleInputDict):.
+0002e9f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ea00: 696e 7075 745f 6469 6374 203d 2069 6e70  input_dict = inp
+0002ea10: 7574 5f64 6963 742e 6765 7428 0a20 2020  ut_dict.get(.   
+0002ea20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ea30: 2062 6568 6176 696f 725f 706f 6c69 6379   behavior_policy
+0002ea40: 5f6e 616d 653d 6265 6861 7669 6f72 5f70  _name=behavior_p
+0002ea50: 6f6c 6963 795f 6e61 6d65 2c20 6461 7461  olicy_name, data
+0002ea60: 7365 745f 6964 3d64 6174 6173 6574 5f69  set_id=dataset_i
+0002ea70: 640a 2020 2020 2020 2020 2020 2020 2020  d.              
+0002ea80: 2020 290a 2020 2020 2020 2020 6368 6563    ).        chec
+0002ea90: 6b5f 696e 7075 745f 6469 6374 2869 6e70  k_input_dict(inp
+0002eaa0: 7574 5f64 6963 7429 0a0a 2020 2020 2020  ut_dict)..      
+0002eab0: 2020 6d65 616e 5f64 6963 7420 3d20 7365    mean_dict = se
+0002eac0: 6c66 2e65 7374 696d 6174 655f 6d65 616e  lf.estimate_mean
+0002ead0: 280a 2020 2020 2020 2020 2020 2020 696e  (.            in
+0002eae0: 7075 745f 6469 6374 2c0a 2020 2020 2020  put_dict,.      
+0002eaf0: 2020 2020 2020 636f 6d70 6172 6564 5f65        compared_e
+0002eb00: 7374 696d 6174 6f72 733d 636f 6d70 6172  stimators=compar
+0002eb10: 6564 5f65 7374 696d 6174 6f72 732c 0a20  ed_estimators,. 
+0002eb20: 2020 2020 2020 2020 2020 2062 6568 6176             behav
+0002eb30: 696f 725f 706f 6c69 6379 5f6e 616d 653d  ior_policy_name=
+0002eb40: 6265 6861 7669 6f72 5f70 6f6c 6963 795f  behavior_policy_
+0002eb50: 6e61 6d65 2c0a 2020 2020 2020 2020 2020  name,.          
+0002eb60: 2020 6461 7461 7365 745f 6964 3d64 6174    dataset_id=dat
+0002eb70: 6173 6574 5f69 642c 0a20 2020 2020 2020  aset_id,.       
+0002eb80: 2029 0a20 2020 2020 2020 2076 6172 6961   ).        varia
+0002eb90: 6e63 655f 6469 6374 203d 2073 656c 662e  nce_dict = self.
+0002eba0: 6573 7469 6d61 7465 5f76 6172 6961 6e63  estimate_varianc
+0002ebb0: 6528 0a20 2020 2020 2020 2020 2020 2069  e(.            i
+0002ebc0: 6e70 7574 5f64 6963 742c 0a20 2020 2020  nput_dict,.     
+0002ebd0: 2020 2020 2020 2063 6f6d 7061 7265 645f         compared_
+0002ebe0: 6573 7469 6d61 746f 7273 3d63 6f6d 7061  estimators=compa
+0002ebf0: 7265 645f 6573 7469 6d61 746f 7273 2c0a  red_estimators,.
+0002ec00: 2020 2020 2020 2020 2020 2020 6265 6861              beha
+0002ec10: 7669 6f72 5f70 6f6c 6963 795f 6e61 6d65  vior_policy_name
+0002ec20: 3d62 6568 6176 696f 725f 706f 6c69 6379  =behavior_policy
+0002ec30: 5f6e 616d 652c 0a20 2020 2020 2020 2020  _name,.         
+0002ec40: 2020 2064 6174 6173 6574 5f69 643d 6461     dataset_id=da
+0002ec50: 7461 7365 745f 6964 2c0a 2020 2020 2020  taset_id,.      
+0002ec60: 2020 290a 0a20 2020 2020 2020 2069 6620    )..        if 
+0002ec70: 6973 5f72 656c 6174 6976 653a 0a20 2020  is_relative:.   
+0002ec80: 2020 2020 2020 2020 2067 616d 6d61 203d           gamma =
+0002ec90: 2069 6e70 7574 5f64 6963 745b 6c69 7374   input_dict[list
+0002eca0: 2869 6e70 7574 5f64 6963 742e 6b65 7973  (input_dict.keys
+0002ecb0: 2829 295b 305d 5d5b 2267 616d 6d61 225d  ())[0]]["gamma"]
+0002ecc0: 0a20 2020 2020 2020 2020 2020 2064 6973  .            dis
+0002ecd0: 636f 756e 7420 3d20 6e70 2e66 756c 6c28  count = np.full(
+0002ece0: 7365 6c66 2e73 7465 705f 7065 725f 7472  self.step_per_tr
+0002ecf0: 616a 6563 746f 7279 2c20 6761 6d6d 6129  ajectory, gamma)
+0002ed00: 2e63 756d 7072 6f64 2829 202f 2067 616d  .cumprod() / gam
+0002ed10: 6d61 0a20 2020 2020 2020 2020 2020 2062  ma.            b
+0002ed20: 6568 6176 696f 725f 706f 6c69 6379 5f76  ehavior_policy_v
+0002ed30: 616c 7565 203d 2028 0a20 2020 2020 2020  alue = (.       
+0002ed40: 2020 2020 2020 2020 2064 6973 636f 756e           discoun
+0002ed50: 745b 6e70 2e6e 6577 6178 6973 2c20 3a5d  t[np.newaxis, :]
+0002ed60: 202a 2073 656c 662e 6265 6861 7669 6f72   * self.behavior
+0002ed70: 5f70 6f6c 6963 795f 7265 7761 7264 0a20  _policy_reward. 
+0002ed80: 2020 2020 2020 2020 2020 2029 2e73 756d             ).sum
+0002ed90: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0002eda0: 2020 6178 6973 3d31 0a20 2020 2020 2020    axis=1.       
+0002edb0: 2020 2020 2029 2e6d 6561 6e28 2920 2b20       ).mean() + 
+0002edc0: 3165 2d31 3020 2023 2074 6f20 6176 6f69  1e-10  # to avoi
+0002edd0: 6420 7a65 726f 2064 6976 6973 696f 6e0a  d zero division.
+0002ede0: 0a20 2020 2020 2020 2070 6c74 2e73 7479  .        plt.sty
+0002edf0: 6c65 2e75 7365 2822 6767 706c 6f74 2229  le.use("ggplot")
+0002ee00: 0a20 2020 2020 2020 2063 6f6c 6f72 203d  .        color =
+0002ee10: 2070 6c74 2e72 6350 6172 616d 735b 2261   plt.rcParams["a
+0002ee20: 7865 732e 7072 6f70 5f63 7963 6c65 225d  xes.prop_cycle"]
+0002ee30: 2e62 795f 6b65 7928 295b 2263 6f6c 6f72  .by_key()["color
+0002ee40: 225d 0a20 2020 2020 2020 206e 5f63 6f6c  "].        n_col
+0002ee50: 6f72 7320 3d20 6c65 6e28 636f 6c6f 7229  ors = len(color)
+0002ee60: 0a0a 2020 2020 2020 2020 6e5f 706f 6c69  ..        n_poli
+0002ee70: 6369 6573 203d 206c 656e 2869 6e70 7574  cies = len(input
+0002ee80: 5f64 6963 7429 0a20 2020 2020 2020 206e  _dict).        n
+0002ee90: 5f65 7374 696d 6174 6f72 7320 3d20 6c65  _estimators = le
+0002eea0: 6e28 636f 6d70 6172 6564 5f65 7374 696d  n(compared_estim
+0002eeb0: 6174 6f72 7329 0a0a 2020 2020 2020 2020  ators)..        
+0002eec0: 6966 2068 7565 203d 3d20 2265 7374 696d  if hue == "estim
+0002eed0: 6174 6f72 223a 0a20 2020 2020 2020 2020  ator":.         
+0002eee0: 2020 2066 6967 203d 2070 6c74 2e66 6967     fig = plt.fig
+0002eef0: 7572 6528 6669 6773 697a 653d 2832 202a  ure(figsize=(2 *
+0002ef00: 206e 5f65 7374 696d 6174 6f72 732c 2034   n_estimators, 4
+0002ef10: 202a 206e 5f70 6f6c 6963 6965 7329 290a   * n_policies)).
+0002ef20: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+0002ef30: 2069 2c20 6576 616c 5f70 6f6c 6963 7920   i, eval_policy 
+0002ef40: 696e 2065 6e75 6d65 7261 7465 2869 6e70  in enumerate(inp
+0002ef50: 7574 5f64 6963 742e 6b65 7973 2829 293a  ut_dict.keys()):
+0002ef60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002ef70: 2069 6620 6920 3d3d 2030 3a0a 2020 2020   if i == 0:.    
+0002ef80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ef90: 6178 203d 2061 7830 203d 2066 6967 2e61  ax = ax0 = fig.a
+0002efa0: 6464 5f73 7562 706c 6f74 286c 656e 2869  dd_subplot(len(i
+0002efb0: 6e70 7574 5f64 6963 7429 2c20 312c 2069  nput_dict), 1, i
+0002efc0: 202b 2031 290a 2020 2020 2020 2020 2020   + 1).          
+0002efd0: 2020 2020 2020 656c 6966 2073 6861 7265        elif share
+0002efe0: 793a 0a20 2020 2020 2020 2020 2020 2020  y:.             
+0002eff0: 2020 2020 2020 2061 7820 3d20 6669 672e         ax = fig.
+0002f000: 6164 645f 7375 6270 6c6f 7428 6c65 6e28  add_subplot(len(
+0002f010: 696e 7075 745f 6469 6374 292c 2031 2c20  input_dict), 1, 
+0002f020: 6920 2b20 312c 2073 6861 7265 793d 6178  i + 1, sharey=ax
+0002f030: 3029 0a20 2020 2020 2020 2020 2020 2020  0).             
+0002f040: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0002f050: 2020 2020 2020 2020 2020 2020 2061 7820               ax 
+0002f060: 3d20 6669 672e 6164 645f 7375 6270 6c6f  = fig.add_subplo
+0002f070: 7428 6c65 6e28 696e 7075 745f 6469 6374  t(len(input_dict
+0002f080: 292c 2031 2c20 6920 2b20 3129 0a0a 2020  ), 1, i + 1)..  
+0002f090: 2020 2020 2020 2020 2020 2020 2020 6f6e                on
+0002f0a0: 5f70 6f6c 6963 795f 6d65 616e 203d 206d  _policy_mean = m
+0002f0b0: 6561 6e5f 6469 6374 5b65 7661 6c5f 706f  ean_dict[eval_po
+0002f0c0: 6c69 6379 5d2e 706f 7028 226f 6e5f 706f  licy].pop("on_po
+0002f0d0: 6c69 6379 2229 0a20 2020 2020 2020 2020  licy").         
+0002f0e0: 2020 2020 2020 206f 6e5f 706f 6c69 6379         on_policy
+0002f0f0: 5f76 6172 6961 6e63 6520 3d20 7661 7269  _variance = vari
+0002f100: 616e 6365 5f64 6963 745b 6576 616c 5f70  ance_dict[eval_p
+0002f110: 6f6c 6963 795d 2e70 6f70 2822 6f6e 5f70  olicy].pop("on_p
+0002f120: 6f6c 6963 7922 290a 0a20 2020 2020 2020  olicy")..       
+0002f130: 2020 2020 2020 2020 2069 6620 6f6e 5f70           if on_p
+0002f140: 6f6c 6963 795f 6d65 616e 2069 7320 6e6f  olicy_mean is no
+0002f150: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
+0002f160: 2020 2020 2020 2020 2020 2020 6f6e 5f70              on_p
+0002f170: 6f6c 6963 795f 7570 7065 722c 206f 6e5f  olicy_upper, on_
+0002f180: 706f 6c69 6379 5f6c 6f77 6572 203d 206e  policy_lower = n
+0002f190: 6f72 6d2e 696e 7465 7276 616c 280a 2020  orm.interval(.  
+0002f1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f1b0: 2020 2020 2020 3120 2d20 616c 7068 612c        1 - alpha,
+0002f1c0: 206c 6f63 3d6f 6e5f 706f 6c69 6379 5f6d   loc=on_policy_m
+0002f1d0: 6561 6e2c 2073 6361 6c65 3d6e 702e 7371  ean, scale=np.sq
+0002f1e0: 7274 286f 6e5f 706f 6c69 6379 5f76 6172  rt(on_policy_var
+0002f1f0: 6961 6e63 6529 0a20 2020 2020 2020 2020  iance).         
+0002f200: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
+0002f210: 2020 2020 2020 2020 2020 2020 2020 6d65                me
+0002f220: 616e 203d 206e 702e 6172 7261 7928 6c69  an = np.array(li
+0002f230: 7374 286d 6561 6e5f 6469 6374 5b65 7661  st(mean_dict[eva
+0002f240: 6c5f 706f 6c69 6379 5d2e 7661 6c75 6573  l_policy].values
+0002f250: 2829 292c 2064 7479 7065 3d66 6c6f 6174  ()), dtype=float
+0002f260: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0002f270: 2020 7661 7269 616e 6365 203d 206e 702e    variance = np.
+0002f280: 6172 7261 7928 0a20 2020 2020 2020 2020  array(.         
+0002f290: 2020 2020 2020 2020 2020 206c 6973 7428             list(
+0002f2a0: 7661 7269 616e 6365 5f64 6963 745b 6576  variance_dict[ev
+0002f2b0: 616c 5f70 6f6c 6963 795d 2e76 616c 7565  al_policy].value
+0002f2c0: 7328 2929 2c20 6474 7970 653d 666c 6f61  s()), dtype=floa
+0002f2d0: 740a 2020 2020 2020 2020 2020 2020 2020  t.              
+0002f2e0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+0002f2f0: 2020 2020 6c6f 7765 722c 2075 7070 6572      lower, upper
+0002f300: 203d 206e 6f72 6d2e 696e 7465 7276 616c   = norm.interval
+0002f310: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0002f320: 2020 2020 2020 3120 2d20 616c 7068 612c        1 - alpha,
+0002f330: 206c 6f63 3d6d 6561 6e2c 2073 6361 6c65   loc=mean, scale
+0002f340: 3d6e 702e 7371 7274 2876 6172 6961 6e63  =np.sqrt(varianc
+0002f350: 6529 0a20 2020 2020 2020 2020 2020 2020  e).             
+0002f360: 2020 2029 0a0a 2020 2020 2020 2020 2020     )..          
+0002f370: 2020 2020 2020 6966 2069 735f 7265 6c61        if is_rela
+0002f380: 7469 7665 3a0a 2020 2020 2020 2020 2020  tive:.          
+0002f390: 2020 2020 2020 2020 2020 6966 206f 6e5f            if on_
+0002f3a0: 706f 6c69 6379 5f6d 6561 6e20 6973 206e  policy_mean is n
+0002f3b0: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
+0002f3c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f3d0: 206f 6e5f 706f 6c69 6379 5f6d 6561 6e20   on_policy_mean 
+0002f3e0: 3d20 6f6e 5f70 6f6c 6963 795f 6d65 616e  = on_policy_mean
+0002f3f0: 202f 2062 6568 6176 696f 725f 706f 6c69   / behavior_poli
+0002f400: 6379 5f76 616c 7565 0a20 2020 2020 2020  cy_value.       
+0002f410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f420: 206f 6e5f 706f 6c69 6379 5f75 7070 6572   on_policy_upper
+0002f430: 203d 206f 6e5f 706f 6c69 6379 5f75 7070   = on_policy_upp
+0002f440: 6572 202f 2062 6568 6176 696f 725f 706f  er / behavior_po
+0002f450: 6c69 6379 5f76 616c 7565 0a20 2020 2020  licy_value.     
+0002f460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f470: 2020 206f 6e5f 706f 6c69 6379 5f6c 6f77     on_policy_low
+0002f480: 6572 203d 206f 6e5f 706f 6c69 6379 5f6c  er = on_policy_l
+0002f490: 6f77 6572 202f 2062 6568 6176 696f 725f  ower / behavior_
+0002f4a0: 706f 6c69 6379 5f76 616c 7565 0a0a 2020  policy_value..  
+0002f4b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f4c0: 2020 6d65 616e 203d 206d 6561 6e20 2f20    mean = mean / 
+0002f4d0: 6265 6861 7669 6f72 5f70 6f6c 6963 795f  behavior_policy_
+0002f4e0: 7661 6c75 650a 2020 2020 2020 2020 2020  value.          
+0002f4f0: 2020 2020 2020 2020 2020 7570 7065 7220            upper 
+0002f500: 3d20 7570 7065 7220 2f20 6265 6861 7669  = upper / behavi
+0002f510: 6f72 5f70 6f6c 6963 795f 7661 6c75 650a  or_policy_value.
+0002f520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f530: 2020 2020 6c6f 7765 7220 3d20 6c6f 7765      lower = lowe
+0002f540: 7220 2f20 6265 6861 7669 6f72 5f70 6f6c  r / behavior_pol
+0002f550: 6963 795f 7661 6c75 650a 0a20 2020 2020  icy_value..     
+0002f560: 2020 2020 2020 2020 2020 2066 6f72 206a             for j
+0002f570: 2069 6e20 7261 6e67 6528 6e5f 6573 7469   in range(n_esti
+0002f580: 6d61 746f 7273 293a 0a20 2020 2020 2020  mators):.       
+0002f590: 2020 2020 2020 2020 2020 2020 2061 782e               ax.
+0002f5a0: 6572 726f 7262 6172 280a 2020 2020 2020  errorbar(.      
+0002f5b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f5c0: 2020 6e70 2e61 7261 6e67 6528 6a2c 206a    np.arange(j, j
+0002f5d0: 202b 2031 292c 0a20 2020 2020 2020 2020   + 1),.         
+0002f5e0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+0002f5f0: 6561 6e5b 6a5d 2c0a 2020 2020 2020 2020  ean[j],.        
+0002f600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f610: 7865 7272 3d5b 302e 345d 2c0a 2020 2020  xerr=[0.4],.    
+0002f620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f630: 2020 2020 7965 7272 3d5b 0a20 2020 2020      yerr=[.     
+0002f640: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f650: 2020 2020 2020 206e 702e 6172 7261 7928         np.array(
+0002f660: 5b6d 6561 6e5b 6a5d 202d 206c 6f77 6572  [mean[j] - lower
+0002f670: 5b6a 5d5d 292c 0a20 2020 2020 2020 2020  [j]]),.         
 0002f680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f690: 2020 2020 2020 6e70 2e61 7261 6e67 6528        np.arange(
-0002f6a0: 6a2c 206a 202b 2031 292c 0a20 2020 2020  j, j + 1),.     
-0002f6b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f6c0: 2020 206d 6561 6e5b 6a5d 2c0a 2020 2020     mean[j],.    
+0002f690: 2020 206e 702e 6172 7261 7928 5b75 7070     np.array([upp
+0002f6a0: 6572 5b6a 5d20 2d20 6d65 616e 5b6a 5d5d  er[j] - mean[j]]
+0002f6b0: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+0002f6c0: 2020 2020 2020 2020 2020 205d 2c0a 2020             ],.  
 0002f6d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f6e0: 2020 2020 7865 7272 3d5b 302e 345d 2c0a      xerr=[0.4],.
-0002f6f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f700: 2020 2020 2020 2020 7965 7272 3d5b 0a20          yerr=[. 
-0002f710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f720: 2020 2020 2020 2020 2020 206e 702e 6172             np.ar
-0002f730: 7261 7928 5b6d 6561 6e5b 6a5d 202d 206c  ray([mean[j] - l
-0002f740: 6f77 6572 5b6a 5d5d 292c 0a20 2020 2020  ower[j]]),.     
-0002f750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f760: 2020 2020 2020 206e 702e 6172 7261 7928         np.array(
-0002f770: 5b75 7070 6572 5b6a 5d20 2d20 6d65 616e  [upper[j] - mean
-0002f780: 5b6a 5d5d 292c 0a20 2020 2020 2020 2020  [j]]),.         
-0002f790: 2020 2020 2020 2020 2020 2020 2020 205d                 ]
-0002f7a0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0002f7b0: 2020 2020 2020 2020 2020 636f 6c6f 723d            color=
-0002f7c0: 636f 6c6f 725b 6a20 2520 6e5f 636f 6c6f  color[j % n_colo
-0002f7d0: 7273 5d2c 0a20 2020 2020 2020 2020 2020  rs],.           
-0002f7e0: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
-0002f7f0: 6e65 7769 6474 683d 352e 302c 0a20 2020  newidth=5.0,.   
-0002f800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f810: 2029 0a0a 2020 2020 2020 2020 2020 2020   )..            
-0002f820: 2020 2020 656c 696e 6573 203d 2061 782e      elines = ax.
-0002f830: 6765 745f 6368 696c 6472 656e 2829 0a20  get_children(). 
-0002f840: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0002f850: 6f72 206a 2069 6e20 7261 6e67 6528 6e5f  or j in range(n_
-0002f860: 6573 7469 6d61 746f 7273 293a 0a20 2020  estimators):.   
-0002f870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f880: 2065 6c69 6e65 735b 3320 2a20 6a20 2b20   elines[3 * j + 
-0002f890: 325d 2e73 6574 5f63 6f6c 6f72 2822 626c  2].set_color("bl
-0002f8a0: 6163 6b22 290a 2020 2020 2020 2020 2020  ack").          
-0002f8b0: 2020 2020 2020 2020 2020 656c 696e 6573            elines
-0002f8c0: 5b33 202a 206a 202b 2032 5d2e 7365 745f  [3 * j + 2].set_
-0002f8d0: 6c69 6e65 7769 6474 6828 322e 3029 0a0a  linewidth(2.0)..
-0002f8e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f8f0: 6966 206f 6e5f 706f 6c69 6379 5f6d 6561  if on_policy_mea
-0002f900: 6e20 6973 206e 6f74 204e 6f6e 653a 0a20  n is not None:. 
-0002f910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f920: 2020 2061 782e 6178 686c 696e 6528 6f6e     ax.axhline(on
-0002f930: 5f70 6f6c 6963 795f 6d65 616e 290a 2020  _policy_mean).  
-0002f940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f950: 2020 6178 2e61 7868 7370 616e 280a 2020    ax.axhspan(.  
-0002f960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f970: 2020 2020 2020 796d 696e 3d6f 6e5f 706f        ymin=on_po
-0002f980: 6c69 6379 5f6c 6f77 6572 2c0a 2020 2020  licy_lower,.    
-0002f990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f9a0: 2020 2020 796d 6178 3d6f 6e5f 706f 6c69      ymax=on_poli
-0002f9b0: 6379 5f75 7070 6572 2c0a 2020 2020 2020  cy_upper,.      
-0002f9c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f9d0: 2020 616c 7068 613d 302e 332c 0a20 2020    alpha=0.3,.   
-0002f9e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f9f0: 2029 0a20 2020 2020 2020 2020 2020 2020   ).             
-0002fa00: 2020 2061 782e 7365 745f 7469 746c 6528     ax.set_title(
-0002fa10: 6576 616c 5f70 6f6c 6963 792c 2066 6f6e  eval_policy, fon
-0002fa20: 7473 697a 653d 3136 290a 2020 2020 2020  tsize=16).      
-0002fa30: 2020 2020 2020 2020 2020 6178 2e73 6574            ax.set
-0002fa40: 5f78 7469 636b 7328 6e70 2e61 7261 6e67  _xticks(np.arang
-0002fa50: 6528 6e5f 6573 7469 6d61 746f 7273 2929  e(n_estimators))
-0002fa60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002fa70: 2061 782e 7365 745f 7874 6963 6b6c 6162   ax.set_xticklab
-0002fa80: 656c 7328 636f 6d70 6172 6564 5f65 7374  els(compared_est
-0002fa90: 696d 6174 6f72 7329 0a20 2020 2020 2020  imators).       
-0002faa0: 2020 2020 2020 2020 2061 782e 7365 745f           ax.set_
-0002fab0: 796c 6162 656c 280a 2020 2020 2020 2020  ylabel(.        
-0002fac0: 2020 2020 2020 2020 2020 2020 6622 4573              f"Es
-0002fad0: 7469 6d61 7465 6420 506f 6c69 6379 2056  timated Policy V
-0002fae0: 616c 7565 2028 c2b1 207b 6e70 2e69 6e74  alue (.. {np.int
-0002faf0: 3634 2831 3030 2a28 3120 2d20 616c 7068  64(100*(1 - alph
-0002fb00: 6129 297d 2520 4349 2922 2c0a 2020 2020  a))}% CI)",.    
-0002fb10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fb20: 666f 6e74 7369 7a65 3d31 322c 0a20 2020  fontsize=12,.   
-0002fb30: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
-0002fb40: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0002fb50: 6c74 2e79 7469 636b 7328 666f 6e74 7369  lt.yticks(fontsi
-0002fb60: 7a65 3d31 3229 0a20 2020 2020 2020 2020  ze=12).         
-0002fb70: 2020 2020 2020 2070 6c74 2e78 7469 636b         plt.xtick
-0002fb80: 7328 666f 6e74 7369 7a65 3d31 3229 0a20  s(fontsize=12). 
-0002fb90: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0002fba0: 6c74 2e78 6c69 6d28 2d30 2e35 2c20 6e5f  lt.xlim(-0.5, n_
-0002fbb0: 6573 7469 6d61 746f 7273 202d 2030 2e35  estimators - 0.5
-0002fbc0: 290a 0a20 2020 2020 2020 2065 6c73 653a  )..        else:
-0002fbd0: 0a20 2020 2020 2020 2020 2020 2076 6973  .            vis
-0002fbe0: 7561 6c69 7a65 5f6f 6e5f 706f 6c69 6379  ualize_on_policy
-0002fbf0: 203d 2054 7275 650a 2020 2020 2020 2020   = True.        
-0002fc00: 2020 2020 666f 7220 6576 616c 5f70 6f6c      for eval_pol
-0002fc10: 6963 7920 696e 2069 6e70 7574 5f64 6963  icy in input_dic
-0002fc20: 742e 6b65 7973 2829 3a0a 2020 2020 2020  t.keys():.      
-0002fc30: 2020 2020 2020 2020 2020 6966 2069 6e70            if inp
-0002fc40: 7574 5f64 6963 745b 6576 616c 5f70 6f6c  ut_dict[eval_pol
-0002fc50: 6963 795d 5b22 6f6e 5f70 6f6c 6963 795f  icy]["on_policy_
-0002fc60: 706f 6c69 6379 5f76 616c 7565 225d 2069  policy_value"] i
-0002fc70: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
-0002fc80: 2020 2020 2020 2020 2020 2020 7669 7375              visu
-0002fc90: 616c 697a 655f 6f6e 5f70 6f6c 6963 7920  alize_on_policy 
-0002fca0: 3d20 4661 6c73 650a 0a20 2020 2020 2020  = False..       
-0002fcb0: 2020 2020 206e 5f70 6f6c 6963 6965 7320       n_policies 
-0002fcc0: 3d20 6c65 6e28 696e 7075 745f 6469 6374  = len(input_dict
-0002fcd0: 290a 2020 2020 2020 2020 2020 2020 6e5f  ).            n_
-0002fce0: 6573 7469 6d61 746f 7273 203d 2028 0a20  estimators = (. 
-0002fcf0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-0002fd00: 656e 2863 6f6d 7061 7265 645f 6573 7469  en(compared_esti
-0002fd10: 6d61 746f 7273 2920 2b20 310a 2020 2020  mators) + 1.    
-0002fd20: 2020 2020 2020 2020 2020 2020 6966 2076              if v
-0002fd30: 6973 7561 6c69 7a65 5f6f 6e5f 706f 6c69  isualize_on_poli
-0002fd40: 6379 0a20 2020 2020 2020 2020 2020 2020  cy.             
-0002fd50: 2020 2065 6c73 6520 6c65 6e28 636f 6d70     else len(comp
-0002fd60: 6172 6564 5f65 7374 696d 6174 6f72 7329  ared_estimators)
-0002fd70: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
-0002fd80: 2020 2020 2020 2020 2020 2020 6669 6720              fig 
-0002fd90: 3d20 706c 742e 6669 6775 7265 2866 6967  = plt.figure(fig
-0002fda0: 7369 7a65 3d28 3220 2a20 6e5f 706f 6c69  size=(2 * n_poli
-0002fdb0: 6369 6573 2c20 3420 2a20 6e5f 6573 7469  cies, 4 * n_esti
-0002fdc0: 6d61 746f 7273 2929 0a0a 2020 2020 2020  mators))..      
-0002fdd0: 2020 2020 2020 666f 7220 692c 2065 7374        for i, est
-0002fde0: 696d 6174 6f72 2069 6e20 656e 756d 6572  imator in enumer
-0002fdf0: 6174 6528 7365 6c66 2e6f 7065 5f65 7374  ate(self.ope_est
-0002fe00: 696d 6174 6f72 735f 293a 0a20 2020 2020  imators_):.     
-0002fe10: 2020 2020 2020 2020 2020 2069 6620 6920             if i 
-0002fe20: 3d3d 2030 3a0a 2020 2020 2020 2020 2020  == 0:.          
-0002fe30: 2020 2020 2020 2020 2020 6178 203d 2061            ax = a
-0002fe40: 7830 203d 2066 6967 2e61 6464 5f73 7562  x0 = fig.add_sub
-0002fe50: 706c 6f74 286e 5f65 7374 696d 6174 6f72  plot(n_estimator
-0002fe60: 732c 2031 2c20 6920 2b20 3129 0a20 2020  s, 1, i + 1).   
-0002fe70: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
-0002fe80: 6620 7368 6172 6579 3a0a 2020 2020 2020  f sharey:.      
-0002fe90: 2020 2020 2020 2020 2020 2020 2020 6178                ax
-0002fea0: 203d 2066 6967 2e61 6464 5f73 7562 706c   = fig.add_subpl
-0002feb0: 6f74 286e 5f65 7374 696d 6174 6f72 732c  ot(n_estimators,
-0002fec0: 2031 2c20 6920 2b20 312c 2073 6861 7265   1, i + 1, share
-0002fed0: 793d 6178 3029 0a20 2020 2020 2020 2020  y=ax0).         
-0002fee0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-0002fef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ff00: 2061 7820 3d20 6669 672e 6164 645f 7375   ax = fig.add_su
-0002ff10: 6270 6c6f 7428 6e5f 6573 7469 6d61 746f  bplot(n_estimato
-0002ff20: 7273 2c20 312c 2069 202b 2031 290a 0a20  rs, 1, i + 1).. 
-0002ff30: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-0002ff40: 6561 6e20 3d20 6e70 2e7a 6572 6f73 286c  ean = np.zeros(l
-0002ff50: 656e 2869 6e70 7574 5f64 6963 7429 290a  en(input_dict)).
-0002ff60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ff70: 7661 7269 616e 6365 203d 206e 702e 7a65  variance = np.ze
-0002ff80: 726f 7328 6c65 6e28 696e 7075 745f 6469  ros(len(input_di
-0002ff90: 6374 2929 0a20 2020 2020 2020 2020 2020  ct)).           
-0002ffa0: 2020 2020 2066 6f72 206a 2c20 6576 616c       for j, eval
-0002ffb0: 5f70 6f6c 6963 7920 696e 2065 6e75 6d65  _policy in enume
-0002ffc0: 7261 7465 2869 6e70 7574 5f64 6963 742e  rate(input_dict.
-0002ffd0: 6b65 7973 2829 293a 0a20 2020 2020 2020  keys()):.       
-0002ffe0: 2020 2020 2020 2020 2020 2020 206d 6561               mea
-0002fff0: 6e5b 6a5d 203d 206d 6561 6e5f 6469 6374  n[j] = mean_dict
-00030000: 5b65 7661 6c5f 706f 6c69 6379 5d5b 6573  [eval_policy][es
-00030010: 7469 6d61 746f 725d 0a20 2020 2020 2020  timator].       
-00030020: 2020 2020 2020 2020 2020 2020 2076 6172               var
-00030030: 6961 6e63 655b 6a5d 203d 2076 6172 6961  iance[j] = varia
-00030040: 6e63 655f 6469 6374 5b65 7661 6c5f 706f  nce_dict[eval_po
-00030050: 6c69 6379 5d5b 6573 7469 6d61 746f 725d  licy][estimator]
-00030060: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00030070: 2020 6c6f 7765 722c 2075 7070 6572 203d    lower, upper =
-00030080: 206e 6f72 6d2e 696e 7465 7276 616c 280a   norm.interval(.
-00030090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000300a0: 2020 2020 3120 2d20 616c 7068 612c 206c      1 - alpha, l
-000300b0: 6f63 3d6d 6561 6e2c 2073 6361 6c65 3d6e  oc=mean, scale=n
-000300c0: 702e 7371 7274 2876 6172 6961 6e63 6529  p.sqrt(variance)
-000300d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000300e0: 2029 0a0a 2020 2020 2020 2020 2020 2020   )..            
-000300f0: 2020 2020 6966 2069 735f 7265 6c61 7469      if is_relati
-00030100: 7665 3a0a 2020 2020 2020 2020 2020 2020  ve:.            
-00030110: 2020 2020 2020 2020 6d65 616e 203d 206d          mean = m
-00030120: 6561 6e20 2f20 6265 6861 7669 6f72 5f70  ean / behavior_p
-00030130: 6f6c 6963 795f 7661 6c75 650a 2020 2020  olicy_value.    
-00030140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030150: 7570 7065 7220 3d20 7570 7065 7220 2f20  upper = upper / 
-00030160: 6265 6861 7669 6f72 5f70 6f6c 6963 795f  behavior_policy_
-00030170: 7661 6c75 650a 2020 2020 2020 2020 2020  value.          
-00030180: 2020 2020 2020 2020 2020 6c6f 7765 7220            lower 
-00030190: 3d20 6c6f 7765 7220 2f20 6265 6861 7669  = lower / behavi
-000301a0: 6f72 5f70 6f6c 6963 795f 7661 6c75 650a  or_policy_value.
-000301b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000301c0: 2066 6f72 206a 2069 6e20 7261 6e67 6528   for j in range(
-000301d0: 6e5f 706f 6c69 6369 6573 293a 0a20 2020  n_policies):.   
-000301e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000301f0: 2061 782e 6572 726f 7262 6172 280a 2020   ax.errorbar(.  
+0002f6e0: 2020 2020 2020 636f 6c6f 723d 636f 6c6f        color=colo
+0002f6f0: 725b 6a20 2520 6e5f 636f 6c6f 7273 5d2c  r[j % n_colors],
+0002f700: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002f710: 2020 2020 2020 2020 2065 6c69 6e65 7769           elinewi
+0002f720: 6474 683d 352e 302c 0a20 2020 2020 2020  dth=5.0,.       
+0002f730: 2020 2020 2020 2020 2020 2020 2029 0a0a               )..
+0002f740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f750: 656c 696e 6573 203d 2061 782e 6765 745f  elines = ax.get_
+0002f760: 6368 696c 6472 656e 2829 0a20 2020 2020  children().     
+0002f770: 2020 2020 2020 2020 2020 2066 6f72 206a             for j
+0002f780: 2069 6e20 7261 6e67 6528 6e5f 6573 7469   in range(n_esti
+0002f790: 6d61 746f 7273 293a 0a20 2020 2020 2020  mators):.       
+0002f7a0: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
+0002f7b0: 6e65 735b 3320 2a20 6a20 2b20 325d 2e73  nes[3 * j + 2].s
+0002f7c0: 6574 5f63 6f6c 6f72 2822 626c 6163 6b22  et_color("black"
+0002f7d0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0002f7e0: 2020 2020 2020 656c 696e 6573 5b33 202a        elines[3 *
+0002f7f0: 206a 202b 2032 5d2e 7365 745f 6c69 6e65   j + 2].set_line
+0002f800: 7769 6474 6828 322e 3029 0a0a 2020 2020  width(2.0)..    
+0002f810: 2020 2020 2020 2020 2020 2020 6966 206f              if o
+0002f820: 6e5f 706f 6c69 6379 5f6d 6561 6e20 6973  n_policy_mean is
+0002f830: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
+0002f840: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+0002f850: 782e 6178 686c 696e 6528 6f6e 5f70 6f6c  x.axhline(on_pol
+0002f860: 6963 795f 6d65 616e 290a 2020 2020 2020  icy_mean).      
+0002f870: 2020 2020 2020 2020 2020 2020 2020 6178                ax
+0002f880: 2e61 7868 7370 616e 280a 2020 2020 2020  .axhspan(.      
+0002f890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f8a0: 2020 796d 696e 3d6f 6e5f 706f 6c69 6379    ymin=on_policy
+0002f8b0: 5f6c 6f77 6572 2c0a 2020 2020 2020 2020  _lower,.        
+0002f8c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002f8d0: 796d 6178 3d6f 6e5f 706f 6c69 6379 5f75  ymax=on_policy_u
+0002f8e0: 7070 6572 2c0a 2020 2020 2020 2020 2020  pper,.          
+0002f8f0: 2020 2020 2020 2020 2020 2020 2020 616c                al
+0002f900: 7068 613d 302e 332c 0a20 2020 2020 2020  pha=0.3,.       
+0002f910: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
+0002f920: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+0002f930: 782e 7365 745f 7469 746c 6528 6576 616c  x.set_title(eval
+0002f940: 5f70 6f6c 6963 792c 2066 6f6e 7473 697a  _policy, fontsiz
+0002f950: 653d 3136 290a 2020 2020 2020 2020 2020  e=16).          
+0002f960: 2020 2020 2020 6178 2e73 6574 5f78 7469        ax.set_xti
+0002f970: 636b 7328 6e70 2e61 7261 6e67 6528 6e5f  cks(np.arange(n_
+0002f980: 6573 7469 6d61 746f 7273 2929 0a20 2020  estimators)).   
+0002f990: 2020 2020 2020 2020 2020 2020 2061 782e               ax.
+0002f9a0: 7365 745f 7874 6963 6b6c 6162 656c 7328  set_xticklabels(
+0002f9b0: 636f 6d70 6172 6564 5f65 7374 696d 6174  compared_estimat
+0002f9c0: 6f72 7329 0a20 2020 2020 2020 2020 2020  ors).           
+0002f9d0: 2020 2020 2061 782e 7365 745f 796c 6162       ax.set_ylab
+0002f9e0: 656c 280a 2020 2020 2020 2020 2020 2020  el(.            
+0002f9f0: 2020 2020 2020 2020 6622 4573 7469 6d61          f"Estima
+0002fa00: 7465 6420 506f 6c69 6379 2056 616c 7565  ted Policy Value
+0002fa10: 2028 c2b1 207b 6e70 2e69 6e74 3634 2831   (.. {np.int64(1
+0002fa20: 3030 2a28 3120 2d20 616c 7068 6129 297d  00*(1 - alpha))}
+0002fa30: 2520 4349 2922 2c0a 2020 2020 2020 2020  % CI)",.        
+0002fa40: 2020 2020 2020 2020 2020 2020 666f 6e74              font
+0002fa50: 7369 7a65 3d31 322c 0a20 2020 2020 2020  size=12,.       
+0002fa60: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+0002fa70: 2020 2020 2020 2020 2020 2070 6c74 2e79             plt.y
+0002fa80: 7469 636b 7328 666f 6e74 7369 7a65 3d31  ticks(fontsize=1
+0002fa90: 3229 0a20 2020 2020 2020 2020 2020 2020  2).             
+0002faa0: 2020 2070 6c74 2e78 7469 636b 7328 666f     plt.xticks(fo
+0002fab0: 6e74 7369 7a65 3d31 3229 0a20 2020 2020  ntsize=12).     
+0002fac0: 2020 2020 2020 2020 2020 2070 6c74 2e78             plt.x
+0002fad0: 6c69 6d28 2d30 2e35 2c20 6e5f 6573 7469  lim(-0.5, n_esti
+0002fae0: 6d61 746f 7273 202d 2030 2e35 290a 0a20  mators - 0.5).. 
+0002faf0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+0002fb00: 2020 2020 2020 2020 2076 6973 7561 6c69           visuali
+0002fb10: 7a65 5f6f 6e5f 706f 6c69 6379 203d 2054  ze_on_policy = T
+0002fb20: 7275 650a 2020 2020 2020 2020 2020 2020  rue.            
+0002fb30: 666f 7220 6576 616c 5f70 6f6c 6963 7920  for eval_policy 
+0002fb40: 696e 2069 6e70 7574 5f64 6963 742e 6b65  in input_dict.ke
+0002fb50: 7973 2829 3a0a 2020 2020 2020 2020 2020  ys():.          
+0002fb60: 2020 2020 2020 6966 2069 6e70 7574 5f64        if input_d
+0002fb70: 6963 745b 6576 616c 5f70 6f6c 6963 795d  ict[eval_policy]
+0002fb80: 5b22 6f6e 5f70 6f6c 6963 795f 706f 6c69  ["on_policy_poli
+0002fb90: 6379 5f76 616c 7565 225d 2069 7320 4e6f  cy_value"] is No
+0002fba0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+0002fbb0: 2020 2020 2020 2020 7669 7375 616c 697a          visualiz
+0002fbc0: 655f 6f6e 5f70 6f6c 6963 7920 3d20 4661  e_on_policy = Fa
+0002fbd0: 6c73 650a 0a20 2020 2020 2020 2020 2020  lse..           
+0002fbe0: 206e 5f70 6f6c 6963 6965 7320 3d20 6c65   n_policies = le
+0002fbf0: 6e28 696e 7075 745f 6469 6374 290a 2020  n(input_dict).  
+0002fc00: 2020 2020 2020 2020 2020 6e5f 6573 7469            n_esti
+0002fc10: 6d61 746f 7273 203d 2028 0a20 2020 2020  mators = (.     
+0002fc20: 2020 2020 2020 2020 2020 206c 656e 2863             len(c
+0002fc30: 6f6d 7061 7265 645f 6573 7469 6d61 746f  ompared_estimato
+0002fc40: 7273 2920 2b20 310a 2020 2020 2020 2020  rs) + 1.        
+0002fc50: 2020 2020 2020 2020 6966 2076 6973 7561          if visua
+0002fc60: 6c69 7a65 5f6f 6e5f 706f 6c69 6379 0a20  lize_on_policy. 
+0002fc70: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0002fc80: 6c73 6520 6c65 6e28 636f 6d70 6172 6564  lse len(compared
+0002fc90: 5f65 7374 696d 6174 6f72 7329 0a20 2020  _estimators).   
+0002fca0: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
+0002fcb0: 2020 2020 2020 2020 6669 6720 3d20 706c          fig = pl
+0002fcc0: 742e 6669 6775 7265 2866 6967 7369 7a65  t.figure(figsize
+0002fcd0: 3d28 3220 2a20 6e5f 706f 6c69 6369 6573  =(2 * n_policies
+0002fce0: 2c20 3420 2a20 6e5f 6573 7469 6d61 746f  , 4 * n_estimato
+0002fcf0: 7273 2929 0a0a 2020 2020 2020 2020 2020  rs))..          
+0002fd00: 2020 666f 7220 692c 2065 7374 696d 6174    for i, estimat
+0002fd10: 6f72 2069 6e20 656e 756d 6572 6174 6528  or in enumerate(
+0002fd20: 7365 6c66 2e6f 7065 5f65 7374 696d 6174  self.ope_estimat
+0002fd30: 6f72 735f 293a 0a20 2020 2020 2020 2020  ors_):.         
+0002fd40: 2020 2020 2020 2069 6620 6920 3d3d 2030         if i == 0
+0002fd50: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0002fd60: 2020 2020 2020 6178 203d 2061 7830 203d        ax = ax0 =
+0002fd70: 2066 6967 2e61 6464 5f73 7562 706c 6f74   fig.add_subplot
+0002fd80: 286e 5f65 7374 696d 6174 6f72 732c 2031  (n_estimators, 1
+0002fd90: 2c20 6920 2b20 3129 0a20 2020 2020 2020  , i + 1).       
+0002fda0: 2020 2020 2020 2020 2065 6c69 6620 7368           elif sh
+0002fdb0: 6172 6579 3a0a 2020 2020 2020 2020 2020  arey:.          
+0002fdc0: 2020 2020 2020 2020 2020 6178 203d 2066            ax = f
+0002fdd0: 6967 2e61 6464 5f73 7562 706c 6f74 286e  ig.add_subplot(n
+0002fde0: 5f65 7374 696d 6174 6f72 732c 2031 2c20  _estimators, 1, 
+0002fdf0: 6920 2b20 312c 2073 6861 7265 793d 6178  i + 1, sharey=ax
+0002fe00: 3029 0a20 2020 2020 2020 2020 2020 2020  0).             
+0002fe10: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0002fe20: 2020 2020 2020 2020 2020 2020 2061 7820               ax 
+0002fe30: 3d20 6669 672e 6164 645f 7375 6270 6c6f  = fig.add_subplo
+0002fe40: 7428 6e5f 6573 7469 6d61 746f 7273 2c20  t(n_estimators, 
+0002fe50: 312c 2069 202b 2031 290a 0a20 2020 2020  1, i + 1)..     
+0002fe60: 2020 2020 2020 2020 2020 206d 6561 6e20             mean 
+0002fe70: 3d20 6e70 2e7a 6572 6f73 286c 656e 2869  = np.zeros(len(i
+0002fe80: 6e70 7574 5f64 6963 7429 290a 2020 2020  nput_dict)).    
+0002fe90: 2020 2020 2020 2020 2020 2020 7661 7269              vari
+0002fea0: 616e 6365 203d 206e 702e 7a65 726f 7328  ance = np.zeros(
+0002feb0: 6c65 6e28 696e 7075 745f 6469 6374 2929  len(input_dict))
+0002fec0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002fed0: 2066 6f72 206a 2c20 6576 616c 5f70 6f6c   for j, eval_pol
+0002fee0: 6963 7920 696e 2065 6e75 6d65 7261 7465  icy in enumerate
+0002fef0: 2869 6e70 7574 5f64 6963 742e 6b65 7973  (input_dict.keys
+0002ff00: 2829 293a 0a20 2020 2020 2020 2020 2020  ()):.           
+0002ff10: 2020 2020 2020 2020 206d 6561 6e5b 6a5d           mean[j]
+0002ff20: 203d 206d 6561 6e5f 6469 6374 5b65 7661   = mean_dict[eva
+0002ff30: 6c5f 706f 6c69 6379 5d5b 6573 7469 6d61  l_policy][estima
+0002ff40: 746f 725d 0a20 2020 2020 2020 2020 2020  tor].           
+0002ff50: 2020 2020 2020 2020 2076 6172 6961 6e63           varianc
+0002ff60: 655b 6a5d 203d 2076 6172 6961 6e63 655f  e[j] = variance_
+0002ff70: 6469 6374 5b65 7661 6c5f 706f 6c69 6379  dict[eval_policy
+0002ff80: 5d5b 6573 7469 6d61 746f 725d 0a0a 2020  ][estimator]..  
+0002ff90: 2020 2020 2020 2020 2020 2020 2020 6c6f                lo
+0002ffa0: 7765 722c 2075 7070 6572 203d 206e 6f72  wer, upper = nor
+0002ffb0: 6d2e 696e 7465 7276 616c 280a 2020 2020  m.interval(.    
+0002ffc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ffd0: 3120 2d20 616c 7068 612c 206c 6f63 3d6d  1 - alpha, loc=m
+0002ffe0: 6561 6e2c 2073 6361 6c65 3d6e 702e 7371  ean, scale=np.sq
+0002fff0: 7274 2876 6172 6961 6e63 6529 0a20 2020  rt(variance).   
+00030000: 2020 2020 2020 2020 2020 2020 2029 0a0a               )..
+00030010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030020: 6966 2069 735f 7265 6c61 7469 7665 3a0a  if is_relative:.
+00030030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030040: 2020 2020 6d65 616e 203d 206d 6561 6e20      mean = mean 
+00030050: 2f20 6265 6861 7669 6f72 5f70 6f6c 6963  / behavior_polic
+00030060: 795f 7661 6c75 650a 2020 2020 2020 2020  y_value.        
+00030070: 2020 2020 2020 2020 2020 2020 7570 7065              uppe
+00030080: 7220 3d20 7570 7065 7220 2f20 6265 6861  r = upper / beha
+00030090: 7669 6f72 5f70 6f6c 6963 795f 7661 6c75  vior_policy_valu
+000300a0: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
+000300b0: 2020 2020 2020 6c6f 7765 7220 3d20 6c6f        lower = lo
+000300c0: 7765 7220 2f20 6265 6861 7669 6f72 5f70  wer / behavior_p
+000300d0: 6f6c 6963 795f 7661 6c75 650a 0a20 2020  olicy_value..   
+000300e0: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+000300f0: 206a 2069 6e20 7261 6e67 6528 6e5f 706f   j in range(n_po
+00030100: 6c69 6369 6573 293a 0a20 2020 2020 2020  licies):.       
+00030110: 2020 2020 2020 2020 2020 2020 2061 782e               ax.
+00030120: 6572 726f 7262 6172 280a 2020 2020 2020  errorbar(.      
+00030130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030140: 2020 6e70 2e61 7261 6e67 6528 6a2c 206a    np.arange(j, j
+00030150: 202b 2031 292c 0a20 2020 2020 2020 2020   + 1),.         
+00030160: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+00030170: 6561 6e5b 6a5d 2c0a 2020 2020 2020 2020  ean[j],.        
+00030180: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030190: 7865 7272 3d5b 302e 345d 2c0a 2020 2020  xerr=[0.4],.    
+000301a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000301b0: 2020 2020 7965 7272 3d5b 0a20 2020 2020      yerr=[.     
+000301c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000301d0: 2020 2020 2020 206e 702e 6172 7261 7928         np.array(
+000301e0: 5b6d 6561 6e5b 6a5d 202d 206c 6f77 6572  [mean[j] - lower
+000301f0: 5b6a 5d5d 292c 0a20 2020 2020 2020 2020  [j]]),.         
 00030200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030210: 2020 2020 2020 6e70 2e61 7261 6e67 6528        np.arange(
-00030220: 6a2c 206a 202b 2031 292c 0a20 2020 2020  j, j + 1),.     
-00030230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030240: 2020 206d 6561 6e5b 6a5d 2c0a 2020 2020     mean[j],.    
+00030210: 2020 206e 702e 6172 7261 7928 5b75 7070     np.array([upp
+00030220: 6572 5b6a 5d20 2d20 6d65 616e 5b6a 5d5d  er[j] - mean[j]]
+00030230: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+00030240: 2020 2020 2020 2020 2020 205d 2c0a 2020             ],.  
 00030250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030260: 2020 2020 7865 7272 3d5b 302e 345d 2c0a      xerr=[0.4],.
-00030270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030280: 2020 2020 2020 2020 7965 7272 3d5b 0a20          yerr=[. 
-00030290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000302a0: 2020 2020 2020 2020 2020 206e 702e 6172             np.ar
-000302b0: 7261 7928 5b6d 6561 6e5b 6a5d 202d 206c  ray([mean[j] - l
-000302c0: 6f77 6572 5b6a 5d5d 292c 0a20 2020 2020  ower[j]]),.     
-000302d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000302e0: 2020 2020 2020 206e 702e 6172 7261 7928         np.array(
-000302f0: 5b75 7070 6572 5b6a 5d20 2d20 6d65 616e  [upper[j] - mean
-00030300: 5b6a 5d5d 292c 0a20 2020 2020 2020 2020  [j]]),.         
-00030310: 2020 2020 2020 2020 2020 2020 2020 205d                 ]
-00030320: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00030330: 2020 2020 2020 2020 2020 636f 6c6f 723d            color=
-00030340: 636f 6c6f 725b 6a20 2520 6e5f 636f 6c6f  color[j % n_colo
-00030350: 7273 5d2c 0a20 2020 2020 2020 2020 2020  rs],.           
-00030360: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
-00030370: 6e65 7769 6474 683d 352e 302c 0a20 2020  newidth=5.0,.   
-00030380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030390: 2029 0a0a 2020 2020 2020 2020 2020 2020   )..            
-000303a0: 2020 2020 656c 696e 6573 203d 2061 782e      elines = ax.
-000303b0: 6765 745f 6368 696c 6472 656e 2829 0a20  get_children(). 
-000303c0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-000303d0: 6f72 206a 2069 6e20 7261 6e67 6528 6e5f  or j in range(n_
-000303e0: 706f 6c69 6369 6573 293a 0a20 2020 2020  policies):.     
-000303f0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00030400: 6c69 6e65 735b 3320 2a20 6a20 2b20 325d  lines[3 * j + 2]
-00030410: 2e73 6574 5f63 6f6c 6f72 2822 626c 6163  .set_color("blac
-00030420: 6b22 290a 2020 2020 2020 2020 2020 2020  k").            
-00030430: 2020 2020 2020 2020 656c 696e 6573 5b33          elines[3
-00030440: 202a 206a 202b 2032 5d2e 7365 745f 6c69   * j + 2].set_li
-00030450: 6e65 7769 6474 6828 322e 3029 0a0a 2020  newidth(2.0)..  
-00030460: 2020 2020 2020 2020 2020 2020 2020 6178                ax
-00030470: 2e73 6574 5f74 6974 6c65 2865 7374 696d  .set_title(estim
-00030480: 6174 6f72 2c20 666f 6e74 7369 7a65 3d31  ator, fontsize=1
-00030490: 3629 0a20 2020 2020 2020 2020 2020 2020  6).             
-000304a0: 2020 2061 782e 7365 745f 7874 6963 6b73     ax.set_xticks
-000304b0: 286e 702e 6172 616e 6765 286e 5f70 6f6c  (np.arange(n_pol
-000304c0: 6963 6965 7329 290a 2020 2020 2020 2020  icies)).        
-000304d0: 2020 2020 2020 2020 6178 2e73 6574 5f78          ax.set_x
-000304e0: 7469 636b 6c61 6265 6c73 286c 6973 7428  ticklabels(list(
-000304f0: 696e 7075 745f 6469 6374 2e6b 6579 7328  input_dict.keys(
-00030500: 2929 290a 2020 2020 2020 2020 2020 2020  ))).            
-00030510: 2020 2020 6178 2e73 6574 5f79 6c61 6265      ax.set_ylabe
-00030520: 6c28 0a20 2020 2020 2020 2020 2020 2020  l(.             
-00030530: 2020 2020 2020 2066 2245 7374 696d 6174         f"Estimat
-00030540: 6564 2050 6f6c 6963 7920 5661 6c75 6520  ed Policy Value 
-00030550: 28c2 b120 7b6e 702e 696e 7436 3428 3130  (.. {np.int64(10
-00030560: 302a 2831 202d 2061 6c70 6861 2929 7d25  0*(1 - alpha))}%
-00030570: 2043 4929 222c 0a20 2020 2020 2020 2020   CI)",.         
-00030580: 2020 2020 2020 2020 2020 2066 6f6e 7473             fonts
-00030590: 697a 653d 3132 2c0a 2020 2020 2020 2020  ize=12,.        
-000305a0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-000305b0: 2020 2020 2020 2020 2020 706c 742e 7974            plt.yt
-000305c0: 6963 6b73 2866 6f6e 7473 697a 653d 3132  icks(fontsize=12
-000305d0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-000305e0: 2020 706c 742e 7874 6963 6b73 2866 6f6e    plt.xticks(fon
-000305f0: 7473 697a 653d 3132 290a 2020 2020 2020  tsize=12).      
-00030600: 2020 2020 2020 2020 2020 706c 742e 786c            plt.xl
-00030610: 696d 282d 302e 352c 206e 5f70 6f6c 6963  im(-0.5, n_polic
-00030620: 6965 7320 2d20 302e 3529 0a0a 2020 2020  ies - 0.5)..    
-00030630: 2020 2020 2020 2020 6966 2076 6973 7561          if visua
-00030640: 6c69 7a65 5f6f 6e5f 706f 6c69 6379 3a0a  lize_on_policy:.
-00030650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030660: 6966 2073 6861 7265 793a 0a20 2020 2020  if sharey:.     
-00030670: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-00030680: 7820 3d20 6669 672e 6164 645f 7375 6270  x = fig.add_subp
-00030690: 6c6f 7428 6e5f 6573 7469 6d61 746f 7273  lot(n_estimators
-000306a0: 2c20 312c 2069 202b 2032 2c20 7368 6172  , 1, i + 2, shar
-000306b0: 6579 3d61 7830 290a 2020 2020 2020 2020  ey=ax0).        
-000306c0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-000306d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000306e0: 2020 6178 203d 2066 6967 2e61 6464 5f73    ax = fig.add_s
-000306f0: 7562 706c 6f74 286e 5f65 7374 696d 6174  ubplot(n_estimat
-00030700: 6f72 732c 2031 2c20 6920 2b20 3229 0a0a  ors, 1, i + 2)..
+00030260: 2020 2020 2020 636f 6c6f 723d 636f 6c6f        color=colo
+00030270: 725b 6a20 2520 6e5f 636f 6c6f 7273 5d2c  r[j % n_colors],
+00030280: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00030290: 2020 2020 2020 2020 2065 6c69 6e65 7769           elinewi
+000302a0: 6474 683d 352e 302c 0a20 2020 2020 2020  dth=5.0,.       
+000302b0: 2020 2020 2020 2020 2020 2020 2029 0a0a               )..
+000302c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000302d0: 656c 696e 6573 203d 2061 782e 6765 745f  elines = ax.get_
+000302e0: 6368 696c 6472 656e 2829 0a20 2020 2020  children().     
+000302f0: 2020 2020 2020 2020 2020 2066 6f72 206a             for j
+00030300: 2069 6e20 7261 6e67 6528 6e5f 706f 6c69   in range(n_poli
+00030310: 6369 6573 293a 0a20 2020 2020 2020 2020  cies):.         
+00030320: 2020 2020 2020 2020 2020 2065 6c69 6e65             eline
+00030330: 735b 3320 2a20 6a20 2b20 325d 2e73 6574  s[3 * j + 2].set
+00030340: 5f63 6f6c 6f72 2822 626c 6163 6b22 290a  _color("black").
+00030350: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030360: 2020 2020 656c 696e 6573 5b33 202a 206a      elines[3 * j
+00030370: 202b 2032 5d2e 7365 745f 6c69 6e65 7769   + 2].set_linewi
+00030380: 6474 6828 322e 3029 0a0a 2020 2020 2020  dth(2.0)..      
+00030390: 2020 2020 2020 2020 2020 6178 2e73 6574            ax.set
+000303a0: 5f74 6974 6c65 2865 7374 696d 6174 6f72  _title(estimator
+000303b0: 2c20 666f 6e74 7369 7a65 3d31 3629 0a20  , fontsize=16). 
+000303c0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+000303d0: 782e 7365 745f 7874 6963 6b73 286e 702e  x.set_xticks(np.
+000303e0: 6172 616e 6765 286e 5f70 6f6c 6963 6965  arange(n_policie
+000303f0: 7329 290a 2020 2020 2020 2020 2020 2020  s)).            
+00030400: 2020 2020 6178 2e73 6574 5f78 7469 636b      ax.set_xtick
+00030410: 6c61 6265 6c73 286c 6973 7428 696e 7075  labels(list(inpu
+00030420: 745f 6469 6374 2e6b 6579 7328 2929 290a  t_dict.keys())).
+00030430: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030440: 6178 2e73 6574 5f79 6c61 6265 6c28 0a20  ax.set_ylabel(. 
+00030450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030460: 2020 2066 2245 7374 696d 6174 6564 2050     f"Estimated P
+00030470: 6f6c 6963 7920 5661 6c75 6520 28c2 b120  olicy Value (.. 
+00030480: 7b6e 702e 696e 7436 3428 3130 302a 2831  {np.int64(100*(1
+00030490: 202d 2061 6c70 6861 2929 7d25 2043 4929   - alpha))}% CI)
+000304a0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+000304b0: 2020 2020 2020 2066 6f6e 7473 697a 653d         fontsize=
+000304c0: 3132 2c0a 2020 2020 2020 2020 2020 2020  12,.            
+000304d0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+000304e0: 2020 2020 2020 706c 742e 7974 6963 6b73        plt.yticks
+000304f0: 2866 6f6e 7473 697a 653d 3132 290a 2020  (fontsize=12).  
+00030500: 2020 2020 2020 2020 2020 2020 2020 706c                pl
+00030510: 742e 7874 6963 6b73 2866 6f6e 7473 697a  t.xticks(fontsiz
+00030520: 653d 3132 290a 2020 2020 2020 2020 2020  e=12).          
+00030530: 2020 2020 2020 706c 742e 786c 696d 282d        plt.xlim(-
+00030540: 302e 352c 206e 5f70 6f6c 6963 6965 7320  0.5, n_policies 
+00030550: 2d20 302e 3529 0a0a 2020 2020 2020 2020  - 0.5)..        
+00030560: 2020 2020 6966 2076 6973 7561 6c69 7a65      if visualize
+00030570: 5f6f 6e5f 706f 6c69 6379 3a0a 2020 2020  _on_policy:.    
+00030580: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+00030590: 6861 7265 793a 0a20 2020 2020 2020 2020  harey:.         
+000305a0: 2020 2020 2020 2020 2020 2061 7820 3d20             ax = 
+000305b0: 6669 672e 6164 645f 7375 6270 6c6f 7428  fig.add_subplot(
+000305c0: 6e5f 6573 7469 6d61 746f 7273 2c20 312c  n_estimators, 1,
+000305d0: 2069 202b 2032 2c20 7368 6172 6579 3d61   i + 2, sharey=a
+000305e0: 7830 290a 2020 2020 2020 2020 2020 2020  x0).            
+000305f0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00030600: 2020 2020 2020 2020 2020 2020 2020 6178                ax
+00030610: 203d 2066 6967 2e61 6464 5f73 7562 706c   = fig.add_subpl
+00030620: 6f74 286e 5f65 7374 696d 6174 6f72 732c  ot(n_estimators,
+00030630: 2031 2c20 6920 2b20 3229 0a0a 2020 2020   1, i + 2)..    
+00030640: 2020 2020 2020 2020 2020 2020 6f6e 5f70              on_p
+00030650: 6f6c 6963 795f 6d65 616e 203d 206d 6561  olicy_mean = mea
+00030660: 6e5f 6469 6374 5b65 7661 6c5f 706f 6c69  n_dict[eval_poli
+00030670: 6379 5d5b 226f 6e5f 706f 6c69 6379 225d  cy]["on_policy"]
+00030680: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00030690: 206f 6e5f 706f 6c69 6379 5f76 6172 6961   on_policy_varia
+000306a0: 6e63 6520 3d20 7661 7269 616e 6365 5f64  nce = variance_d
+000306b0: 6963 745b 6576 616c 5f70 6f6c 6963 795d  ict[eval_policy]
+000306c0: 5b22 6f6e 5f70 6f6c 6963 7922 5d0a 2020  ["on_policy"].  
+000306d0: 2020 2020 2020 2020 2020 2020 2020 6f6e                on
+000306e0: 5f70 6f6c 6963 795f 6c6f 7765 722c 206f  _policy_lower, o
+000306f0: 6e5f 706f 6c69 6379 5f75 7070 6572 203d  n_policy_upper =
+00030700: 206e 6f72 6d2e 696e 7465 7276 616c 280a   norm.interval(.
 00030710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030720: 6f6e 5f70 6f6c 6963 795f 6d65 616e 203d  on_policy_mean =
-00030730: 206d 6561 6e5f 6469 6374 5b65 7661 6c5f   mean_dict[eval_
-00030740: 706f 6c69 6379 5d5b 226f 6e5f 706f 6c69  policy]["on_poli
-00030750: 6379 225d 0a20 2020 2020 2020 2020 2020  cy"].           
-00030760: 2020 2020 206f 6e5f 706f 6c69 6379 5f76       on_policy_v
-00030770: 6172 6961 6e63 6520 3d20 7661 7269 616e  ariance = varian
-00030780: 6365 5f64 6963 745b 6576 616c 5f70 6f6c  ce_dict[eval_pol
-00030790: 6963 795d 5b22 6f6e 5f70 6f6c 6963 7922  icy]["on_policy"
-000307a0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-000307b0: 2020 6f6e 5f70 6f6c 6963 795f 6c6f 7765    on_policy_lowe
-000307c0: 722c 206f 6e5f 706f 6c69 6379 5f75 7070  r, on_policy_upp
-000307d0: 6572 203d 206e 6f72 6d2e 696e 7465 7276  er = norm.interv
-000307e0: 616c 280a 2020 2020 2020 2020 2020 2020  al(.            
-000307f0: 2020 2020 2020 2020 3120 2d20 616c 7068          1 - alph
-00030800: 612c 206c 6f63 3d6f 6e5f 706f 6c69 6379  a, loc=on_policy
-00030810: 5f6d 6561 6e2c 2073 6361 6c65 3d6e 702e  _mean, scale=np.
-00030820: 7371 7274 286f 6e5f 706f 6c69 6379 5f76  sqrt(on_policy_v
-00030830: 6172 6961 6e63 6529 0a20 2020 2020 2020  ariance).       
-00030840: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-00030850: 2020 2020 2020 2020 2020 2020 6966 2069              if i
-00030860: 735f 7265 6c61 7469 7665 3a0a 2020 2020  s_relative:.    
-00030870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030880: 6f6e 5f70 6f6c 6963 795f 6d65 616e 203d  on_policy_mean =
-00030890: 206f 6e5f 706f 6c69 6379 5f6d 6561 6e20   on_policy_mean 
-000308a0: 2f20 6265 6861 7669 6f72 5f70 6f6c 6963  / behavior_polic
-000308b0: 795f 7661 6c75 650a 2020 2020 2020 2020  y_value.        
-000308c0: 2020 2020 2020 2020 2020 2020 6f6e 5f70              on_p
-000308d0: 6f6c 6963 795f 7570 7065 7220 3d20 6f6e  olicy_upper = on
-000308e0: 5f70 6f6c 6963 795f 7570 7065 7220 2f20  _policy_upper / 
-000308f0: 6265 6861 7669 6f72 5f70 6f6c 6963 795f  behavior_policy_
-00030900: 7661 6c75 650a 2020 2020 2020 2020 2020  value.          
-00030910: 2020 2020 2020 2020 2020 6f6e 5f70 6f6c            on_pol
-00030920: 6963 795f 6c6f 7765 7220 3d20 6f6e 5f70  icy_lower = on_p
-00030930: 6f6c 6963 795f 6c6f 7765 7220 2f20 6265  olicy_lower / be
-00030940: 6861 7669 6f72 5f70 6f6c 6963 795f 7661  havior_policy_va
-00030950: 6c75 650a 0a20 2020 2020 2020 2020 2020  lue..           
-00030960: 2020 2020 2066 6f72 206a 2069 6e20 7261       for j in ra
-00030970: 6e67 6528 6e5f 706f 6c69 6369 6573 293a  nge(n_policies):
-00030980: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00030990: 2020 2020 2061 782e 6572 726f 7262 6172       ax.errorbar
-000309a0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-000309b0: 2020 2020 2020 2020 2020 6e70 2e61 7261            np.ara
-000309c0: 6e67 6528 6a2c 206a 202b 2031 292c 0a20  nge(j, j + 1),. 
-000309d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000309e0: 2020 2020 2020 206d 6561 6e5b 6a5d 2c0a         mean[j],.
-000309f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030a00: 2020 2020 2020 2020 7865 7272 3d5b 302e          xerr=[0.
-00030a10: 345d 2c0a 2020 2020 2020 2020 2020 2020  4],.            
-00030a20: 2020 2020 2020 2020 2020 2020 7965 7272              yerr
-00030a30: 3d5b 0a20 2020 2020 2020 2020 2020 2020  =[.             
-00030a40: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-00030a50: 702e 6172 7261 7928 5b6d 6561 6e5b 6a5d  p.array([mean[j]
-00030a60: 202d 206c 6f77 6572 5b6a 5d5d 292c 0a20   - lower[j]]),. 
-00030a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030a80: 2020 2020 2020 2020 2020 206e 702e 6172             np.ar
-00030a90: 7261 7928 5b75 7070 6572 5b6a 5d20 2d20  ray([upper[j] - 
-00030aa0: 6d65 616e 5b6a 5d5d 292c 0a20 2020 2020  mean[j]]),.     
-00030ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030ac0: 2020 205d 2c0a 2020 2020 2020 2020 2020     ],.          
-00030ad0: 2020 2020 2020 2020 2020 2020 2020 636f                co
-00030ae0: 6c6f 723d 636f 6c6f 725b 6a20 2520 6e5f  lor=color[j % n_
-00030af0: 636f 6c6f 7273 5d2c 0a20 2020 2020 2020  colors],.       
-00030b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030b10: 2065 6c69 6e65 7769 6474 683d 352e 302c   elinewidth=5.0,
-00030b20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00030b30: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
-00030b40: 2020 2020 2020 2020 656c 696e 6573 203d          elines =
-00030b50: 2061 782e 6765 745f 6368 696c 6472 656e   ax.get_children
-00030b60: 2829 0a20 2020 2020 2020 2020 2020 2020  ().             
-00030b70: 2020 2066 6f72 206a 2069 6e20 7261 6e67     for j in rang
-00030b80: 6528 6e5f 706f 6c69 6369 6573 293a 0a20  e(n_policies):. 
-00030b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030ba0: 2020 2065 6c69 6e65 735b 3320 2a20 6a20     elines[3 * j 
-00030bb0: 2b20 325d 2e73 6574 5f63 6f6c 6f72 2822  + 2].set_color("
-00030bc0: 626c 6163 6b22 290a 2020 2020 2020 2020  black").        
-00030bd0: 2020 2020 2020 2020 2020 2020 656c 696e              elin
-00030be0: 6573 5b33 202a 206a 202b 2032 5d2e 7365  es[3 * j + 2].se
-00030bf0: 745f 6c69 6e65 7769 6474 6828 322e 3029  t_linewidth(2.0)
-00030c00: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00030c10: 2020 6178 2e73 6574 5f74 6974 6c65 2822    ax.set_title("
-00030c20: 6f6e 5f70 6f6c 6963 7922 2c20 666f 6e74  on_policy", font
-00030c30: 7369 7a65 3d31 3629 0a20 2020 2020 2020  size=16).       
-00030c40: 2020 2020 2020 2020 2061 782e 7365 745f           ax.set_
-00030c50: 7874 6963 6b73 286e 702e 6172 616e 6765  xticks(np.arange
-00030c60: 286e 5f70 6f6c 6963 6965 7329 290a 2020  (n_policies)).  
-00030c70: 2020 2020 2020 2020 2020 2020 2020 6178                ax
-00030c80: 2e73 6574 5f78 7469 636b 6c61 6265 6c73  .set_xticklabels
-00030c90: 286c 6973 7428 696e 7075 745f 6469 6374  (list(input_dict
-00030ca0: 2e6b 6579 7328 2929 290a 2020 2020 2020  .keys())).      
-00030cb0: 2020 2020 2020 2020 2020 6178 2e73 6574            ax.set
-00030cc0: 5f79 6c61 6265 6c28 0a20 2020 2020 2020  _ylabel(.       
-00030cd0: 2020 2020 2020 2020 2020 2020 2066 2245               f"E
-00030ce0: 7374 696d 6174 6564 2050 6f6c 6963 7920  stimated Policy 
-00030cf0: 5661 6c75 6520 28c2 b120 7b6e 702e 696e  Value (.. {np.in
-00030d00: 7436 3428 3130 302a 2831 202d 2061 6c70  t64(100*(1 - alp
-00030d10: 6861 2929 7d25 2043 4929 222c 0a20 2020  ha))}% CI)",.   
-00030d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030d30: 2066 6f6e 7473 697a 653d 3132 2c0a 2020   fontsize=12,.  
-00030d40: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-00030d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030d60: 706c 742e 7974 6963 6b73 2866 6f6e 7473  plt.yticks(fonts
-00030d70: 697a 653d 3132 290a 2020 2020 2020 2020  ize=12).        
-00030d80: 2020 2020 2020 2020 706c 742e 7874 6963          plt.xtic
-00030d90: 6b73 2866 6f6e 7473 697a 653d 3132 290a  ks(fontsize=12).
-00030da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00030db0: 706c 742e 786c 696d 282d 302e 352c 206c  plt.xlim(-0.5, l
-00030dc0: 656e 2869 6e70 7574 5f64 6963 7429 202d  en(input_dict) -
-00030dd0: 2030 2e35 290a 0a20 2020 2020 2020 2066   0.5)..        f
-00030de0: 6967 2e73 7562 706c 6f74 735f 6164 6a75  ig.subplots_adju
-00030df0: 7374 2874 6f70 3d31 2e30 290a 2020 2020  st(top=1.0).    
-00030e00: 2020 2020 706c 742e 7368 6f77 2829 0a0a      plt.show()..
-00030e10: 2020 2020 2020 2020 6966 2066 6967 5f64          if fig_d
-00030e20: 6972 3a0a 2020 2020 2020 2020 2020 2020  ir:.            
-00030e30: 6669 672e 7361 7665 6669 6728 7374 7228  fig.savefig(str(
-00030e40: 6669 675f 6469 7220 2f20 6669 675f 6e61  fig_dir / fig_na
-00030e50: 6d65 292c 2064 7069 3d33 3030 2c20 6262  me), dpi=300, bb
-00030e60: 6f78 5f69 6e63 6865 733d 2274 6967 6874  ox_inches="tight
-00030e70: 2229 0a0a 2020 2020 6465 6620 7669 7375  ")..    def visu
-00030e80: 616c 697a 655f 636f 6e64 6974 696f 6e61  alize_conditiona
-00030e90: 6c5f 7661 6c75 655f 6174 5f72 6973 6b28  l_value_at_risk(
-00030ea0: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
-00030eb0: 2020 2020 2020 2069 6e70 7574 5f64 6963         input_dic
-00030ec0: 743a 2055 6e69 6f6e 5b4f 5045 496e 7075  t: Union[OPEInpu
-00030ed0: 7444 6963 742c 204d 756c 7469 706c 6549  tDict, MultipleI
-00030ee0: 6e70 7574 4469 6374 5d2c 0a20 2020 2020  nputDict],.     
-00030ef0: 2020 2063 6f6d 7061 7265 645f 6573 7469     compared_esti
-00030f00: 6d61 746f 7273 3a20 4f70 7469 6f6e 616c  mators: Optional
-00030f10: 5b4c 6973 745b 7374 725d 5d20 3d20 4e6f  [List[str]] = No
-00030f20: 6e65 2c0a 2020 2020 2020 2020 6265 6861  ne,.        beha
-00030f30: 7669 6f72 5f70 6f6c 6963 795f 6e61 6d65  vior_policy_name
-00030f40: 3a20 4f70 7469 6f6e 616c 5b73 7472 5d20  : Optional[str] 
-00030f50: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-00030f60: 6461 7461 7365 745f 6964 3a20 4f70 7469  dataset_id: Opti
-00030f70: 6f6e 616c 5b69 6e74 5d20 3d20 4e6f 6e65  onal[int] = None
-00030f80: 2c0a 2020 2020 2020 2020 616c 7068 6173  ,.        alphas
-00030f90: 3a20 4f70 7469 6f6e 616c 5b6e 702e 6e64  : Optional[np.nd
-00030fa0: 6172 7261 795d 203d 204e 6f6e 652c 0a20  array] = None,. 
-00030fb0: 2020 2020 2020 2068 7565 3a20 7374 7220         hue: str 
-00030fc0: 3d20 2265 7374 696d 6174 6f72 222c 0a20  = "estimator",. 
-00030fd0: 2020 2020 2020 206c 6567 656e 643a 2062         legend: b
-00030fe0: 6f6f 6c20 3d20 5472 7565 2c0a 2020 2020  ool = True,.    
-00030ff0: 2020 2020 6e5f 636f 6c73 3a20 4f70 7469      n_cols: Opti
-00031000: 6f6e 616c 5b69 6e74 5d20 3d20 4e6f 6e65  onal[int] = None
-00031010: 2c0a 2020 2020 2020 2020 7368 6172 6579  ,.        sharey
-00031020: 3a20 626f 6f6c 203d 2046 616c 7365 2c0a  : bool = False,.
-00031030: 2020 2020 2020 2020 6669 675f 6469 723a          fig_dir:
-00031040: 204f 7074 696f 6e61 6c5b 5061 7468 5d20   Optional[Path] 
-00031050: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-00031060: 6669 675f 6e61 6d65 3a20 7374 7220 3d20  fig_name: str = 
-00031070: 2265 7374 696d 6174 6564 5f63 6f6e 6469  "estimated_condi
-00031080: 7469 6f6e 616c 5f76 616c 7565 5f61 745f  tional_value_at_
-00031090: 7269 736b 2e70 6e67 222c 0a20 2020 2029  risk.png",.    )
-000310a0: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
-000310b0: 2020 2222 2256 6973 7561 6c69 7a65 2074    """Visualize t
-000310c0: 6865 2063 6f6e 6469 7469 6f6e 616c 2076  he conditional v
-000310d0: 616c 7565 2061 7420 7269 736b 2065 7374  alue at risk est
-000310e0: 696d 6174 6564 2062 7920 4f50 4520 6573  imated by OPE es
-000310f0: 7469 6d61 746f 7273 2e0a 0a20 2020 2020  timators...     
-00031100: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
-00031110: 2020 2020 2020 2d2d 2d2d 2d2d 2d0a 2020        -------.  
-00031120: 2020 2020 2020 696e 7075 745f 6469 6374        input_dict
-00031130: 3a20 4f50 4549 6e70 7574 4469 6374 206f  : OPEInputDict o
-00031140: 7220 4d75 6c74 6970 6c65 496e 7075 7444  r MultipleInputD
-00031150: 6963 740a 2020 2020 2020 2020 2020 2020  ict.            
-00031160: 4469 6374 696f 6e61 7279 206f 6620 7468  Dictionary of th
-00031170: 6520 4f50 4520 696e 7075 7473 2066 6f72  e OPE inputs for
-00031180: 2065 6163 6820 6576 616c 7561 7469 6f6e   each evaluation
-00031190: 2070 6f6c 6963 792e 0a0a 2020 2020 2020   policy...      
-000311a0: 2020 2020 2020 2e2e 2063 6f64 652d 626c        .. code-bl
-000311b0: 6f63 6b3a 3a20 7079 7468 6f6e 0a0a 2020  ock:: python..  
-000311c0: 2020 2020 2020 2020 2020 2020 2020 6b65                ke
-000311d0: 793a 205b 6576 616c 7561 7469 6f6e 5f70  y: [evaluation_p
-000311e0: 6f6c 6963 795d 5b0a 2020 2020 2020 2020  olicy][.        
-000311f0: 2020 2020 2020 2020 2020 2020 6576 616c              eval
-00031200: 7561 7469 6f6e 5f70 6f6c 6963 795f 6163  uation_policy_ac
-00031210: 7469 6f6e 2c0a 2020 2020 2020 2020 2020  tion,.          
-00031220: 2020 2020 2020 2020 2020 6576 616c 7561            evalua
-00031230: 7469 6f6e 5f70 6f6c 6963 795f 6163 7469  tion_policy_acti
-00031240: 6f6e 5f64 6973 742c 0a20 2020 2020 2020  on_dist,.       
-00031250: 2020 2020 2020 2020 2020 2020 2073 7461               sta
-00031260: 7465 5f61 6374 696f 6e5f 7661 6c75 655f  te_action_value_
-00031270: 7072 6564 6963 7469 6f6e 2c0a 2020 2020  prediction,.    
-00031280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031290: 696e 6974 6961 6c5f 7374 6174 655f 7661  initial_state_va
-000312a0: 6c75 655f 7072 6564 6963 7469 6f6e 2c0a  lue_prediction,.
-000312b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000312c0: 2020 2020 7374 6174 655f 6163 7469 6f6e      state_action
-000312d0: 5f6d 6172 6769 6e61 6c5f 696d 706f 7274  _marginal_import
-000312e0: 616e 6365 5f77 6569 6768 742c 0a20 2020  ance_weight,.   
-000312f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031300: 2073 7461 7465 5f6d 6172 6769 6e61 6c5f   state_marginal_
-00031310: 696d 706f 7274 616e 6365 5f77 6569 6768  importance_weigh
-00031320: 742c 0a20 2020 2020 2020 2020 2020 2020  t,.             
-00031330: 2020 2020 2020 206f 6e5f 706f 6c69 6379         on_policy
-00031340: 5f70 6f6c 6963 795f 7661 6c75 652c 0a20  _policy_value,. 
-00031350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031360: 2020 2067 616d 6d61 2c0a 2020 2020 2020     gamma,.      
-00031370: 2020 2020 2020 2020 2020 2020 2020 6265                be
-00031380: 6861 7669 6f72 5f70 6f6c 6963 792c 0a20  havior_policy,. 
-00031390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000313a0: 2020 2065 7661 6c75 6174 696f 6e5f 706f     evaluation_po
-000313b0: 6c69 6379 2c0a 2020 2020 2020 2020 2020  licy,.          
-000313c0: 2020 2020 2020 2020 2020 6461 7461 7365            datase
-000313d0: 745f 6964 2c0a 2020 2020 2020 2020 2020  t_id,.          
-000313e0: 2020 2020 2020 5d0a 0a20 2020 2020 2020        ]..       
-000313f0: 2020 2020 202e 2e20 7365 6561 6c73 6f3a       .. seealso:
-00031400: 3a0a 0a20 2020 2020 2020 2020 2020 2020  :..             
-00031410: 2020 203a 636c 6173 733a 6073 636f 7065     :class:`scope
-00031420: 5f72 6c2e 6f70 652e 696e 7075 742e 4372  _rl.ope.input.Cr
-00031430: 6561 7465 4f50 4549 6e70 7574 6020 6465  eateOPEInput` de
-00031440: 7363 7269 6265 7320 7468 6520 636f 6d70  scribes the comp
-00031450: 6f6e 656e 7473 206f 6620 3a63 6c61 7373  onents of :class
-00031460: 3a60 696e 7075 745f 6469 6374 602e 0a0a  :`input_dict`...
-00031470: 2020 2020 2020 2020 636f 6d70 6172 6564          compared
-00031480: 5f65 7374 696d 6174 6f72 733a 206c 6973  _estimators: lis
-00031490: 7420 6f66 2073 7472 2c20 6465 6661 756c  t of str, defaul
-000314a0: 743d 4e6f 6e65 0a20 2020 2020 2020 2020  t=None.         
-000314b0: 2020 204e 616d 6520 6f66 2063 6f6d 7061     Name of compa
-000314c0: 7265 6420 6573 7469 6d61 746f 7273 2e0a  red estimators..
-000314d0: 2020 2020 2020 2020 2020 2020 4966 2060              If `
-000314e0: 4e6f 6e65 6020 6973 2067 6976 656e 2c20  None` is given, 
-000314f0: 616c 6c20 7468 6520 6573 7469 6d61 746f  all the estimato
-00031500: 7273 2061 7265 2063 6f6d 7061 7265 642e  rs are compared.
-00031510: 0a0a 2020 2020 2020 2020 6265 6861 7669  ..        behavi
-00031520: 6f72 5f70 6f6c 6963 795f 6e61 6d65 3a20  or_policy_name: 
-00031530: 7374 722c 2064 6566 6175 6c74 3d4e 6f6e  str, default=Non
-00031540: 650a 2020 2020 2020 2020 2020 2020 4e61  e.            Na
-00031550: 6d65 206f 6620 7468 6520 6265 6861 7669  me of the behavi
-00031560: 6f72 2070 6f6c 6963 792e 0a0a 2020 2020  or policy...    
-00031570: 2020 2020 6461 7461 7365 745f 6964 3a20      dataset_id: 
-00031580: 696e 742c 2064 6566 6175 6c74 3d4e 6f6e  int, default=Non
-00031590: 650a 2020 2020 2020 2020 2020 2020 4964  e.            Id
-000315a0: 206f 6620 7468 6520 6c6f 6767 6564 2064   of the logged d
-000315b0: 6174 6173 6574 2e0a 0a20 2020 2020 2020  ataset...       
-000315c0: 2061 6c70 6861 733a 2061 7272 6179 2d6c   alphas: array-l
-000315d0: 696b 6520 6f66 2073 6861 7065 2028 6e5f  ike of shape (n_
-000315e0: 616c 7068 612c 2029 2c20 6465 6661 756c  alpha, ), defaul
-000315f0: 743d 4e6f 6e65 0a20 2020 2020 2020 2020  t=None.         
-00031600: 2020 2053 6574 206f 6620 7072 6f70 6f72     Set of propor
-00031610: 7469 6f6e 7320 6f66 2074 6865 2073 6861  tions of the sha
-00031620: 6465 6420 7265 6769 6f6e 2e20 5468 6520  ded region. The 
-00031630: 7661 6c75 6573 2073 686f 756c 6420 6265  values should be
-00031640: 2077 6974 6869 6e20 605b 302c 2031 2960   within `[0, 1)`
-00031650: 2e0a 2020 2020 2020 2020 2020 2020 4966  ..            If
-00031660: 2060 4e6f 6e65 6020 6973 2067 6976 656e   `None` is given
-00031670: 2c20 3a63 6c61 7373 3a60 6e70 2e6c 696e  , :class:`np.lin
-00031680: 7370 6163 6528 302c 2031 2c20 3231 2960  space(0, 1, 21)`
-00031690: 2077 696c 6c20 6265 2075 7365 642e 0a0a   will be used...
-000316a0: 2020 2020 2020 2020 6875 653a 207b 2265          hue: {"e
-000316b0: 7374 696d 6174 6f72 222c 2022 706f 6c69  stimator", "poli
-000316c0: 6379 227d 2c20 6465 6661 756c 743d 2265  cy"}, default="e
-000316d0: 7374 696d 6174 6f72 220a 2020 2020 2020  stimator".      
-000316e0: 2020 2020 2020 4875 6520 6f66 2074 6865        Hue of the
-000316f0: 2070 6c6f 742e 0a0a 2020 2020 2020 2020   plot...        
-00031700: 6c65 6765 6e64 3a20 626f 6f6c 2c20 6465  legend: bool, de
-00031710: 6661 756c 743d 5472 7565 0a20 2020 2020  fault=True.     
-00031720: 2020 2020 2020 2057 6865 7468 6572 2074         Whether t
-00031730: 6f20 696e 636c 7564 6520 6120 6c65 6765  o include a lege
-00031740: 6e64 2069 6e20 7468 6520 6669 6775 7265  nd in the figure
-00031750: 2e0a 0a20 2020 2020 2020 206e 5f63 6f6c  ...        n_col
-00031760: 733a 2069 6e74 2c20 6465 6661 756c 743d  s: int, default=
-00031770: 4e6f 6e65 0a20 2020 2020 2020 2020 2020  None.           
-00031780: 204e 756d 6265 7220 6f66 2063 6f6c 756d   Number of colum
-00031790: 6e73 2069 6e20 7468 6520 6669 6775 7265  ns in the figure
-000317a0: 2e0a 0a20 2020 2020 2020 2073 6861 7265  ...        share
-000317b0: 793a 2062 6f6f 6c2c 2064 6566 6175 6c74  y: bool, default
-000317c0: 3d46 616c 7365 0a20 2020 2020 2020 2020  =False.         
-000317d0: 2020 2054 6869 7320 7061 7261 6d65 7465     This paramete
-000317e0: 7220 6973 2066 6f72 2041 5049 2063 6f6e  r is for API con
-000317f0: 7369 7374 656e 6379 2e0a 0a20 2020 2020  sistency...     
-00031800: 2020 2066 6967 5f64 6972 3a20 5061 7468     fig_dir: Path
-00031810: 2c20 6465 6661 756c 743d 4e6f 6e65 0a20  , default=None. 
-00031820: 2020 2020 2020 2020 2020 2050 6174 6820             Path 
-00031830: 746f 2073 746f 7265 2074 6865 2062 6172  to store the bar
-00031840: 2066 6967 7572 652e 0a20 2020 2020 2020   figure..       
-00031850: 2020 2020 2049 6620 604e 6f6e 6560 2069       If `None` i
-00031860: 7320 6769 7665 6e2c 2074 6865 2066 6967  s given, the fig
-00031870: 7572 6520 7769 6c6c 206e 6f74 2062 6520  ure will not be 
-00031880: 7361 7665 642e 0a0a 2020 2020 2020 2020  saved...        
-00031890: 6669 675f 6e61 6d65 3a20 7374 722c 2064  fig_name: str, d
-000318a0: 6566 6175 6c74 3d22 6573 7469 6d61 7465  efault="estimate
-000318b0: 645f 636f 6e64 6974 696f 6e61 6c5f 7661  d_conditional_va
-000318c0: 6c75 655f 6174 5f72 6973 6b2e 706e 6722  lue_at_risk.png"
-000318d0: 0a20 2020 2020 2020 2020 2020 204e 616d  .            Nam
-000318e0: 6520 6f66 2074 6865 2062 6172 2066 6967  e of the bar fig
-000318f0: 7572 652e 0a0a 2020 2020 2020 2020 2222  ure...        ""
-00031900: 220a 2020 2020 2020 2020 636f 6d70 6172  ".        compar
-00031910: 6564 5f65 7374 696d 6174 6f72 7320 3d20  ed_estimators = 
-00031920: 7365 6c66 2e5f 6368 6563 6b5f 636f 6d70  self._check_comp
-00031930: 6172 6564 5f65 7374 696d 6174 6f72 7328  ared_estimators(
-00031940: 636f 6d70 6172 6564 5f65 7374 696d 6174  compared_estimat
-00031950: 6f72 7329 0a20 2020 2020 2020 2061 6c70  ors).        alp
-00031960: 6861 7320 3d20 7365 6c66 2e5f 6368 6563  has = self._chec
-00031970: 6b5f 6376 6172 5f61 6c70 6861 7328 616c  k_cvar_alphas(al
-00031980: 7068 6173 290a 2020 2020 2020 2020 7365  phas).        se
-00031990: 6c66 2e5f 6368 6563 6b5f 6261 7369 635f  lf._check_basic_
-000319a0: 7669 7375 616c 697a 6174 696f 6e5f 696e  visualization_in
-000319b0: 7075 7473 280a 2020 2020 2020 2020 2020  puts(.          
-000319c0: 2020 6875 653d 6875 652c 2066 6967 5f64    hue=hue, fig_d
-000319d0: 6972 3d66 6967 5f64 6972 2c20 6669 675f  ir=fig_dir, fig_
-000319e0: 6e61 6d65 3d66 6967 5f6e 616d 650a 2020  name=fig_name.  
-000319f0: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-00031a00: 2069 6620 7365 6c66 2e75 7365 5f6d 756c   if self.use_mul
-00031a10: 7469 706c 655f 6c6f 6767 6564 5f64 6174  tiple_logged_dat
-00031a20: 6173 6574 3a0a 2020 2020 2020 2020 2020  aset:.          
-00031a30: 2020 6966 2062 6568 6176 696f 725f 706f    if behavior_po
-00031a40: 6c69 6379 5f6e 616d 6520 6973 204e 6f6e  licy_name is Non
-00031a50: 6520 6f72 2064 6174 6173 6574 5f69 6420  e or dataset_id 
-00031a60: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
-00031a70: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-00031a80: 616c 7565 4572 726f 7228 0a20 2020 2020  alueError(.     
-00031a90: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00031aa0: 6265 6861 7669 6f72 5f70 6f6c 6963 7920  behavior_policy 
-00031ab0: 616e 6420 6461 7461 7365 745f 6964 206d  and dataset_id m
-00031ac0: 7573 7420 6265 2073 7065 6369 6669 6564  ust be specified
-00031ad0: 2077 6865 6e20 7573 696e 6720 4d75 6c74   when using Mult
-00031ae0: 6970 6c65 4c6f 6767 6564 4461 7461 7365  ipleLoggedDatase
-00031af0: 742e 220a 2020 2020 2020 2020 2020 2020  t.".            
-00031b00: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-00031b10: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-00031b20: 696e 7075 745f 6469 6374 2c20 4d75 6c74  input_dict, Mult
-00031b30: 6970 6c65 496e 7075 7444 6963 7429 3a0a  ipleInputDict):.
-00031b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031b50: 696e 7075 745f 6469 6374 203d 2069 6e70  input_dict = inp
-00031b60: 7574 5f64 6963 742e 6765 7428 0a20 2020  ut_dict.get(.   
-00031b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00031b80: 2062 6568 6176 696f 725f 706f 6c69 6379   behavior_policy
-00031b90: 5f6e 616d 653d 6265 6861 7669 6f72 5f70  _name=behavior_p
-00031ba0: 6f6c 6963 795f 6e61 6d65 2c20 6461 7461  olicy_name, data
-00031bb0: 7365 745f 6964 3d64 6174 6173 6574 5f69  set_id=dataset_i
-00031bc0: 640a 2020 2020 2020 2020 2020 2020 2020  d.              
-00031bd0: 2020 290a 2020 2020 2020 2020 6368 6563    ).        chec
-00031be0: 6b5f 696e 7075 745f 6469 6374 2869 6e70  k_input_dict(inp
-00031bf0: 7574 5f64 6963 7429 0a0a 2020 2020 2020  ut_dict)..      
-00031c00: 2020 7669 7375 616c 697a 655f 6f6e 5f70    visualize_on_p
-00031c10: 6f6c 6963 7920 3d20 5472 7565 0a20 2020  olicy = True.   
-00031c20: 2020 2020 2066 6f72 2065 7661 6c5f 706f       for eval_po
-00031c30: 6c69 6379 2069 6e20 696e 7075 745f 6469  licy in input_di
-00031c40: 6374 2e6b 6579 7328 293a 0a20 2020 2020  ct.keys():.     
-00031c50: 2020 2020 2020 2069 6620 696e 7075 745f         if input_
-00031c60: 6469 6374 5b65 7661 6c5f 706f 6c69 6379  dict[eval_policy
-00031c70: 5d5b 226f 6e5f 706f 6c69 6379 5f70 6f6c  ]["on_policy_pol
-00031c80: 6963 795f 7661 6c75 6522 5d20 6973 204e  icy_value"] is N
-00031c90: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-00031ca0: 2020 2020 2076 6973 7561 6c69 7a65 5f6f       visualize_o
-00031cb0: 6e5f 706f 6c69 6379 203d 2046 616c 7365  n_policy = False
-00031cc0: 0a0a 2020 2020 2020 2020 6376 6172 5f64  ..        cvar_d
-00031cd0: 6963 7420 3d20 7365 6c66 2e65 7374 696d  ict = self.estim
-00031ce0: 6174 655f 636f 6e64 6974 696f 6e61 6c5f  ate_conditional_
-00031cf0: 7661 6c75 655f 6174 5f72 6973 6b28 0a20  value_at_risk(. 
-00031d00: 2020 2020 2020 2020 2020 2069 6e70 7574             input
-00031d10: 5f64 6963 742c 0a20 2020 2020 2020 2020  _dict,.         
-00031d20: 2020 2063 6f6d 7061 7265 645f 6573 7469     compared_esti
-00031d30: 6d61 746f 7273 3d63 6f6d 7061 7265 645f  mators=compared_
-00031d40: 6573 7469 6d61 746f 7273 2c0a 2020 2020  estimators,.    
-00031d50: 2020 2020 2020 2020 6265 6861 7669 6f72          behavior
-00031d60: 5f70 6f6c 6963 795f 6e61 6d65 3d62 6568  _policy_name=beh
-00031d70: 6176 696f 725f 706f 6c69 6379 5f6e 616d  avior_policy_nam
-00031d80: 652c 0a20 2020 2020 2020 2020 2020 2064  e,.            d
-00031d90: 6174 6173 6574 5f69 643d 6461 7461 7365  ataset_id=datase
-00031da0: 745f 6964 2c0a 2020 2020 2020 2020 2020  t_id,.          
-00031db0: 2020 616c 7068 6173 3d61 6c70 6861 732c    alphas=alphas,
-00031dc0: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-00031dd0: 2020 2020 6966 2076 6973 7561 6c69 7a65      if visualize
-00031de0: 5f6f 6e5f 706f 6c69 6379 3a0a 2020 2020  _on_policy:.    
-00031df0: 2020 2020 2020 2020 636f 6d70 6172 6564          compared
-00031e00: 5f65 7374 696d 6174 6f72 732e 6170 7065  _estimators.appe
-00031e10: 6e64 2822 6f6e 5f70 6f6c 6963 7922 290a  nd("on_policy").
-00031e20: 0a20 2020 2020 2020 2070 6c74 2e73 7479  .        plt.sty
-00031e30: 6c65 2e75 7365 2822 6767 706c 6f74 2229  le.use("ggplot")
-00031e40: 0a0a 2020 2020 2020 2020 6966 2068 7565  ..        if hue
-00031e50: 203d 3d20 2265 7374 696d 6174 6f72 223a   == "estimator":
-00031e60: 0a20 2020 2020 2020 2020 2020 206e 5f66  .            n_f
-00031e70: 6967 7320 3d20 6c65 6e28 696e 7075 745f  igs = len(input_
-00031e80: 6469 6374 290a 2020 2020 2020 2020 2020  dict).          
-00031e90: 2020 6e5f 636f 6c73 203d 206d 696e 2833    n_cols = min(3
-00031ea0: 2c20 6e5f 6669 6773 2920 6966 206e 5f63  , n_figs) if n_c
-00031eb0: 6f6c 7320 6973 204e 6f6e 6520 656c 7365  ols is None else
-00031ec0: 206e 5f63 6f6c 730a 2020 2020 2020 2020   n_cols.        
-00031ed0: 2020 2020 6e5f 726f 7773 203d 2028 6e5f      n_rows = (n_
-00031ee0: 6669 6773 202d 2031 2920 2f2f 206e 5f63  figs - 1) // n_c
-00031ef0: 6f6c 7320 2b20 310a 0a20 2020 2020 2020  ols + 1..       
-00031f00: 2020 2020 2066 6967 2c20 6178 6573 203d       fig, axes =
-00031f10: 2070 6c74 2e73 7562 706c 6f74 7328 0a20   plt.subplots(. 
-00031f20: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-00031f30: 726f 7773 3d6e 5f72 6f77 732c 206e 636f  rows=n_rows, nco
-00031f40: 6c73 3d6e 5f63 6f6c 732c 2066 6967 7369  ls=n_cols, figsi
-00031f50: 7a65 3d28 3620 2a20 6e5f 636f 6c73 2c20  ze=(6 * n_cols, 
-00031f60: 3420 2a20 6e5f 726f 7773 290a 2020 2020  4 * n_rows).    
-00031f70: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
-00031f80: 2020 2020 2020 2069 6620 6e5f 726f 7773         if n_rows
-00031f90: 203d 3d20 313a 0a20 2020 2020 2020 2020   == 1:.         
-00031fa0: 2020 2020 2020 2066 6f72 2069 2c20 6576         for i, ev
-00031fb0: 616c 5f70 6f6c 6963 7920 696e 2065 6e75  al_policy in enu
-00031fc0: 6d65 7261 7465 2869 6e70 7574 5f64 6963  merate(input_dic
-00031fd0: 742e 6b65 7973 2829 293a 0a20 2020 2020  t.keys()):.     
-00031fe0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00031ff0: 6f72 206a 2c20 6573 7469 6d61 746f 7220  or j, estimator 
-00032000: 696e 2065 6e75 6d65 7261 7465 2863 6f6d  in enumerate(com
-00032010: 7061 7265 645f 6573 7469 6d61 746f 7273  pared_estimators
-00032020: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-00032030: 2020 2020 2020 2020 2020 2061 7865 735b             axes[
-00032040: 695d 2e70 6c6f 7428 0a20 2020 2020 2020  i].plot(.       
-00032050: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032060: 2020 2020 2061 6c70 6861 732c 0a20 2020       alphas,.   
-00032070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032080: 2020 2020 2020 2020 2063 7661 725f 6469           cvar_di
-00032090: 6374 5b65 7661 6c5f 706f 6c69 6379 5d5b  ct[eval_policy][
-000320a0: 6573 7469 6d61 746f 725d 2c0a 2020 2020  estimator],.    
-000320b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000320c0: 2020 2020 2020 2020 6c61 6265 6c3d 6573          label=es
-000320d0: 7469 6d61 746f 722c 0a20 2020 2020 2020  timator,.       
-000320e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000320f0: 2029 0a0a 2020 2020 2020 2020 2020 2020   )..            
-00032100: 2020 2020 2020 2020 6178 6573 5b69 5d2e          axes[i].
-00032110: 7365 745f 7469 746c 6528 6576 616c 5f70  set_title(eval_p
-00032120: 6f6c 6963 7929 0a20 2020 2020 2020 2020  olicy).         
-00032130: 2020 2020 2020 2020 2020 2061 7865 735b             axes[
-00032140: 695d 2e73 6574 5f78 6c61 6265 6c28 2261  i].set_xlabel("a
-00032150: 6c70 6861 2229 0a20 2020 2020 2020 2020  lpha").         
-00032160: 2020 2020 2020 2020 2020 2061 7865 735b             axes[
-00032170: 695d 2e73 6574 5f79 6c61 6265 6c28 2243  i].set_ylabel("C
-00032180: 5661 5222 290a 2020 2020 2020 2020 2020  VaR").          
-00032190: 2020 2020 2020 2020 2020 6966 206c 6567            if leg
-000321a0: 656e 643a 0a20 2020 2020 2020 2020 2020  end:.           
-000321b0: 2020 2020 2020 2020 2020 2020 2061 7865               axe
-000321c0: 735b 695d 2e6c 6567 656e 6428 290a 0a20  s[i].legend().. 
-000321d0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-000321e0: 6620 6c65 6765 6e64 3a0a 2020 2020 2020  f legend:.      
-000321f0: 2020 2020 2020 2020 2020 2020 2020 6861                ha
-00032200: 6e64 6c65 732c 206c 6162 656c 7320 3d20  ndles, labels = 
-00032210: 6178 6573 5b30 5d2e 6765 745f 6c65 6765  axes[0].get_lege
-00032220: 6e64 5f68 616e 646c 6573 5f6c 6162 656c  nd_handles_label
-00032230: 7328 290a 2020 2020 2020 2020 2020 2020  s().            
-00032240: 2020 2020 2020 2020 2320 6e5f 636f 6c73          # n_cols
-00032250: 2073 686f 7773 2065 7272 0a20 2020 2020   shows err.     
-00032260: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00032270: 2066 6967 2e6c 6567 656e 6428 6861 6e64   fig.legend(hand
-00032280: 6c65 732c 206c 6162 656c 732c 206c 6f63  les, labels, loc
-00032290: 3d27 7570 7065 7220 6365 6e74 6572 272c  ='upper center',
-000322a0: 2062 626f 785f 746f 5f61 6e63 686f 723d   bbox_to_anchor=
-000322b0: 2830 2e35 2c20 2d30 2e31 292c 206e 5f63  (0.5, -0.1), n_c
-000322c0: 6f6c 733d 6d69 6e28 6c65 6e28 6c61 6265  ols=min(len(labe
-000322d0: 6c73 292c 2036 2929 0a0a 2020 2020 2020  ls), 6))..      
-000322e0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-000322f0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00032300: 692c 2065 7661 6c5f 706f 6c69 6379 2069  i, eval_policy i
-00032310: 6e20 656e 756d 6572 6174 6528 696e 7075  n enumerate(inpu
-00032320: 745f 6469 6374 2e6b 6579 7328 2929 3a0a  t_dict.keys()):.
-00032330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032340: 2020 2020 666f 7220 6a2c 2065 7374 696d      for j, estim
-00032350: 6174 6f72 2069 6e20 656e 756d 6572 6174  ator in enumerat
-00032360: 6528 636f 6d70 6172 6564 5f65 7374 696d  e(compared_estim
-00032370: 6174 6f72 7329 3a0a 2020 2020 2020 2020  ators):.        
-00032380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032390: 6178 6573 5b69 202f 2f20 6e5f 636f 6c73  axes[i // n_cols
-000323a0: 2c20 6920 2520 6e5f 636f 6c73 5d2e 706c  , i % n_cols].pl
-000323b0: 6f74 280a 2020 2020 2020 2020 2020 2020  ot(.            
-000323c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000323d0: 616c 7068 6173 2c0a 2020 2020 2020 2020  alphas,.        
-000323e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000323f0: 2020 2020 6376 6172 5f64 6963 745b 6576      cvar_dict[ev
-00032400: 616c 5f70 6f6c 6963 795d 5b65 7374 696d  al_policy][estim
-00032410: 6174 6f72 5d2c 0a20 2020 2020 2020 2020  ator],.         
-00032420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032430: 2020 206c 6162 656c 3d65 7374 696d 6174     label=estimat
-00032440: 6f72 2c0a 2020 2020 2020 2020 2020 2020  or,.            
-00032450: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+00030720: 2020 2020 3120 2d20 616c 7068 612c 206c      1 - alpha, l
+00030730: 6f63 3d6f 6e5f 706f 6c69 6379 5f6d 6561  oc=on_policy_mea
+00030740: 6e2c 2073 6361 6c65 3d6e 702e 7371 7274  n, scale=np.sqrt
+00030750: 286f 6e5f 706f 6c69 6379 5f76 6172 6961  (on_policy_varia
+00030760: 6e63 6529 0a20 2020 2020 2020 2020 2020  nce).           
+00030770: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+00030780: 2020 2020 2020 2020 6966 2069 735f 7265          if is_re
+00030790: 6c61 7469 7665 3a0a 2020 2020 2020 2020  lative:.        
+000307a0: 2020 2020 2020 2020 2020 2020 6f6e 5f70              on_p
+000307b0: 6f6c 6963 795f 6d65 616e 203d 206f 6e5f  olicy_mean = on_
+000307c0: 706f 6c69 6379 5f6d 6561 6e20 2f20 6265  policy_mean / be
+000307d0: 6861 7669 6f72 5f70 6f6c 6963 795f 7661  havior_policy_va
+000307e0: 6c75 650a 2020 2020 2020 2020 2020 2020  lue.            
+000307f0: 2020 2020 2020 2020 6f6e 5f70 6f6c 6963          on_polic
+00030800: 795f 7570 7065 7220 3d20 6f6e 5f70 6f6c  y_upper = on_pol
+00030810: 6963 795f 7570 7065 7220 2f20 6265 6861  icy_upper / beha
+00030820: 7669 6f72 5f70 6f6c 6963 795f 7661 6c75  vior_policy_valu
+00030830: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
+00030840: 2020 2020 2020 6f6e 5f70 6f6c 6963 795f        on_policy_
+00030850: 6c6f 7765 7220 3d20 6f6e 5f70 6f6c 6963  lower = on_polic
+00030860: 795f 6c6f 7765 7220 2f20 6265 6861 7669  y_lower / behavi
+00030870: 6f72 5f70 6f6c 6963 795f 7661 6c75 650a  or_policy_value.
+00030880: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00030890: 2066 6f72 206a 2069 6e20 7261 6e67 6528   for j in range(
+000308a0: 6e5f 706f 6c69 6369 6573 293a 0a20 2020  n_policies):.   
+000308b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000308c0: 2061 782e 6572 726f 7262 6172 280a 2020   ax.errorbar(.  
+000308d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000308e0: 2020 2020 2020 6e70 2e61 7261 6e67 6528        np.arange(
+000308f0: 6a2c 206a 202b 2031 292c 0a20 2020 2020  j, j + 1),.     
+00030900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030910: 2020 206d 6561 6e5b 6a5d 2c0a 2020 2020     mean[j],.    
+00030920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030930: 2020 2020 7865 7272 3d5b 302e 345d 2c0a      xerr=[0.4],.
+00030940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030950: 2020 2020 2020 2020 7965 7272 3d5b 0a20          yerr=[. 
+00030960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030970: 2020 2020 2020 2020 2020 206e 702e 6172             np.ar
+00030980: 7261 7928 5b6d 6561 6e5b 6a5d 202d 206c  ray([mean[j] - l
+00030990: 6f77 6572 5b6a 5d5d 292c 0a20 2020 2020  ower[j]]),.     
+000309a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000309b0: 2020 2020 2020 206e 702e 6172 7261 7928         np.array(
+000309c0: 5b75 7070 6572 5b6a 5d20 2d20 6d65 616e  [upper[j] - mean
+000309d0: 5b6a 5d5d 292c 0a20 2020 2020 2020 2020  [j]]),.         
+000309e0: 2020 2020 2020 2020 2020 2020 2020 205d                 ]
+000309f0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00030a00: 2020 2020 2020 2020 2020 636f 6c6f 723d            color=
+00030a10: 636f 6c6f 725b 6a20 2520 6e5f 636f 6c6f  color[j % n_colo
+00030a20: 7273 5d2c 0a20 2020 2020 2020 2020 2020  rs],.           
+00030a30: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
+00030a40: 6e65 7769 6474 683d 352e 302c 0a20 2020  newidth=5.0,.   
+00030a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030a60: 2029 0a0a 2020 2020 2020 2020 2020 2020   )..            
+00030a70: 2020 2020 656c 696e 6573 203d 2061 782e      elines = ax.
+00030a80: 6765 745f 6368 696c 6472 656e 2829 0a20  get_children(). 
+00030a90: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00030aa0: 6f72 206a 2069 6e20 7261 6e67 6528 6e5f  or j in range(n_
+00030ab0: 706f 6c69 6369 6573 293a 0a20 2020 2020  policies):.     
+00030ac0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00030ad0: 6c69 6e65 735b 3320 2a20 6a20 2b20 325d  lines[3 * j + 2]
+00030ae0: 2e73 6574 5f63 6f6c 6f72 2822 626c 6163  .set_color("blac
+00030af0: 6b22 290a 2020 2020 2020 2020 2020 2020  k").            
+00030b00: 2020 2020 2020 2020 656c 696e 6573 5b33          elines[3
+00030b10: 202a 206a 202b 2032 5d2e 7365 745f 6c69   * j + 2].set_li
+00030b20: 6e65 7769 6474 6828 322e 3029 0a0a 2020  newidth(2.0)..  
+00030b30: 2020 2020 2020 2020 2020 2020 2020 6178                ax
+00030b40: 2e73 6574 5f74 6974 6c65 2822 6f6e 5f70  .set_title("on_p
+00030b50: 6f6c 6963 7922 2c20 666f 6e74 7369 7a65  olicy", fontsize
+00030b60: 3d31 3629 0a20 2020 2020 2020 2020 2020  =16).           
+00030b70: 2020 2020 2061 782e 7365 745f 7874 6963       ax.set_xtic
+00030b80: 6b73 286e 702e 6172 616e 6765 286e 5f70  ks(np.arange(n_p
+00030b90: 6f6c 6963 6965 7329 290a 2020 2020 2020  olicies)).      
+00030ba0: 2020 2020 2020 2020 2020 6178 2e73 6574            ax.set
+00030bb0: 5f78 7469 636b 6c61 6265 6c73 286c 6973  _xticklabels(lis
+00030bc0: 7428 696e 7075 745f 6469 6374 2e6b 6579  t(input_dict.key
+00030bd0: 7328 2929 290a 2020 2020 2020 2020 2020  s())).          
+00030be0: 2020 2020 2020 6178 2e73 6574 5f79 6c61        ax.set_yla
+00030bf0: 6265 6c28 0a20 2020 2020 2020 2020 2020  bel(.           
+00030c00: 2020 2020 2020 2020 2066 2245 7374 696d           f"Estim
+00030c10: 6174 6564 2050 6f6c 6963 7920 5661 6c75  ated Policy Valu
+00030c20: 6520 28c2 b120 7b6e 702e 696e 7436 3428  e (.. {np.int64(
+00030c30: 3130 302a 2831 202d 2061 6c70 6861 2929  100*(1 - alpha))
+00030c40: 7d25 2043 4929 222c 0a20 2020 2020 2020  }% CI)",.       
+00030c50: 2020 2020 2020 2020 2020 2020 2066 6f6e               fon
+00030c60: 7473 697a 653d 3132 2c0a 2020 2020 2020  tsize=12,.      
+00030c70: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00030c80: 2020 2020 2020 2020 2020 2020 706c 742e              plt.
+00030c90: 7974 6963 6b73 2866 6f6e 7473 697a 653d  yticks(fontsize=
+00030ca0: 3132 290a 2020 2020 2020 2020 2020 2020  12).            
+00030cb0: 2020 2020 706c 742e 7874 6963 6b73 2866      plt.xticks(f
+00030cc0: 6f6e 7473 697a 653d 3132 290a 2020 2020  ontsize=12).    
+00030cd0: 2020 2020 2020 2020 2020 2020 706c 742e              plt.
+00030ce0: 786c 696d 282d 302e 352c 206c 656e 2869  xlim(-0.5, len(i
+00030cf0: 6e70 7574 5f64 6963 7429 202d 2030 2e35  nput_dict) - 0.5
+00030d00: 290a 0a20 2020 2020 2020 2066 6967 2e73  )..        fig.s
+00030d10: 7562 706c 6f74 735f 6164 6a75 7374 2874  ubplots_adjust(t
+00030d20: 6f70 3d31 2e30 290a 2020 2020 2020 2020  op=1.0).        
+00030d30: 706c 742e 7368 6f77 2829 0a0a 2020 2020  plt.show()..    
+00030d40: 2020 2020 6966 2066 6967 5f64 6972 3a0a      if fig_dir:.
+00030d50: 2020 2020 2020 2020 2020 2020 6669 672e              fig.
+00030d60: 7361 7665 6669 6728 7374 7228 6669 675f  savefig(str(fig_
+00030d70: 6469 7220 2f20 6669 675f 6e61 6d65 292c  dir / fig_name),
+00030d80: 2064 7069 3d33 3030 2c20 6262 6f78 5f69   dpi=300, bbox_i
+00030d90: 6e63 6865 733d 2274 6967 6874 2229 0a0a  nches="tight")..
+00030da0: 2020 2020 6465 6620 7669 7375 616c 697a      def visualiz
+00030db0: 655f 636f 6e64 6974 696f 6e61 6c5f 7661  e_conditional_va
+00030dc0: 6c75 655f 6174 5f72 6973 6b28 0a20 2020  lue_at_risk(.   
+00030dd0: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+00030de0: 2020 2069 6e70 7574 5f64 6963 743a 2055     input_dict: U
+00030df0: 6e69 6f6e 5b4f 5045 496e 7075 7444 6963  nion[OPEInputDic
+00030e00: 742c 204d 756c 7469 706c 6549 6e70 7574  t, MultipleInput
+00030e10: 4469 6374 5d2c 0a20 2020 2020 2020 2063  Dict],.        c
+00030e20: 6f6d 7061 7265 645f 6573 7469 6d61 746f  ompared_estimato
+00030e30: 7273 3a20 4f70 7469 6f6e 616c 5b4c 6973  rs: Optional[Lis
+00030e40: 745b 7374 725d 5d20 3d20 4e6f 6e65 2c0a  t[str]] = None,.
+00030e50: 2020 2020 2020 2020 6265 6861 7669 6f72          behavior
+00030e60: 5f70 6f6c 6963 795f 6e61 6d65 3a20 4f70  _policy_name: Op
+00030e70: 7469 6f6e 616c 5b73 7472 5d20 3d20 4e6f  tional[str] = No
+00030e80: 6e65 2c0a 2020 2020 2020 2020 6461 7461  ne,.        data
+00030e90: 7365 745f 6964 3a20 4f70 7469 6f6e 616c  set_id: Optional
+00030ea0: 5b69 6e74 5d20 3d20 4e6f 6e65 2c0a 2020  [int] = None,.  
+00030eb0: 2020 2020 2020 616c 7068 6173 3a20 4f70        alphas: Op
+00030ec0: 7469 6f6e 616c 5b6e 702e 6e64 6172 7261  tional[np.ndarra
+00030ed0: 795d 203d 204e 6f6e 652c 0a20 2020 2020  y] = None,.     
+00030ee0: 2020 2068 7565 3a20 7374 7220 3d20 2265     hue: str = "e
+00030ef0: 7374 696d 6174 6f72 222c 0a20 2020 2020  stimator",.     
+00030f00: 2020 206c 6567 656e 643a 2062 6f6f 6c20     legend: bool 
+00030f10: 3d20 5472 7565 2c0a 2020 2020 2020 2020  = True,.        
+00030f20: 6e5f 636f 6c73 3a20 4f70 7469 6f6e 616c  n_cols: Optional
+00030f30: 5b69 6e74 5d20 3d20 4e6f 6e65 2c0a 2020  [int] = None,.  
+00030f40: 2020 2020 2020 7368 6172 6579 3a20 626f        sharey: bo
+00030f50: 6f6c 203d 2046 616c 7365 2c0a 2020 2020  ol = False,.    
+00030f60: 2020 2020 6669 675f 6469 723a 204f 7074      fig_dir: Opt
+00030f70: 696f 6e61 6c5b 5061 7468 5d20 3d20 4e6f  ional[Path] = No
+00030f80: 6e65 2c0a 2020 2020 2020 2020 6669 675f  ne,.        fig_
+00030f90: 6e61 6d65 3a20 7374 7220 3d20 2265 7374  name: str = "est
+00030fa0: 696d 6174 6564 5f63 6f6e 6469 7469 6f6e  imated_condition
+00030fb0: 616c 5f76 616c 7565 5f61 745f 7269 736b  al_value_at_risk
+00030fc0: 2e70 6e67 222c 0a20 2020 2029 202d 3e20  .png",.    ) -> 
+00030fd0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2222  None:.        ""
+00030fe0: 2256 6973 7561 6c69 7a65 2074 6865 2063  "Visualize the c
+00030ff0: 6f6e 6469 7469 6f6e 616c 2076 616c 7565  onditional value
+00031000: 2061 7420 7269 736b 2065 7374 696d 6174   at risk estimat
+00031010: 6564 2062 7920 4f50 4520 6573 7469 6d61  ed by OPE estima
+00031020: 746f 7273 2e0a 0a20 2020 2020 2020 2050  tors...        P
+00031030: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
+00031040: 2020 2d2d 2d2d 2d2d 2d0a 2020 2020 2020    -------.      
+00031050: 2020 696e 7075 745f 6469 6374 3a20 4f50    input_dict: OP
+00031060: 4549 6e70 7574 4469 6374 206f 7220 4d75  EInputDict or Mu
+00031070: 6c74 6970 6c65 496e 7075 7444 6963 740a  ltipleInputDict.
+00031080: 2020 2020 2020 2020 2020 2020 4469 6374              Dict
+00031090: 696f 6e61 7279 206f 6620 7468 6520 4f50  ionary of the OP
+000310a0: 4520 696e 7075 7473 2066 6f72 2065 6163  E inputs for eac
+000310b0: 6820 6576 616c 7561 7469 6f6e 2070 6f6c  h evaluation pol
+000310c0: 6963 792e 0a0a 2020 2020 2020 2020 2020  icy...          
+000310d0: 2020 2e2e 2063 6f64 652d 626c 6f63 6b3a    .. code-block:
+000310e0: 3a20 7079 7468 6f6e 0a0a 2020 2020 2020  : python..      
+000310f0: 2020 2020 2020 2020 2020 6b65 793a 205b            key: [
+00031100: 6576 616c 7561 7469 6f6e 5f70 6f6c 6963  evaluation_polic
+00031110: 795d 5b0a 2020 2020 2020 2020 2020 2020  y][.            
+00031120: 2020 2020 2020 2020 6576 616c 7561 7469          evaluati
+00031130: 6f6e 5f70 6f6c 6963 795f 6163 7469 6f6e  on_policy_action
+00031140: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00031150: 2020 2020 2020 6576 616c 7561 7469 6f6e        evaluation
+00031160: 5f70 6f6c 6963 795f 6163 7469 6f6e 5f64  _policy_action_d
+00031170: 6973 742c 0a20 2020 2020 2020 2020 2020  ist,.           
+00031180: 2020 2020 2020 2020 2073 7461 7465 5f61           state_a
+00031190: 6374 696f 6e5f 7661 6c75 655f 7072 6564  ction_value_pred
+000311a0: 6963 7469 6f6e 2c0a 2020 2020 2020 2020  iction,.        
+000311b0: 2020 2020 2020 2020 2020 2020 696e 6974              init
+000311c0: 6961 6c5f 7374 6174 655f 7661 6c75 655f  ial_state_value_
+000311d0: 7072 6564 6963 7469 6f6e 2c0a 2020 2020  prediction,.    
+000311e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000311f0: 7374 6174 655f 6163 7469 6f6e 5f6d 6172  state_action_mar
+00031200: 6769 6e61 6c5f 696d 706f 7274 616e 6365  ginal_importance
+00031210: 5f77 6569 6768 742c 0a20 2020 2020 2020  _weight,.       
+00031220: 2020 2020 2020 2020 2020 2020 2073 7461               sta
+00031230: 7465 5f6d 6172 6769 6e61 6c5f 696d 706f  te_marginal_impo
+00031240: 7274 616e 6365 5f77 6569 6768 742c 0a20  rtance_weight,. 
+00031250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031260: 2020 206f 6e5f 706f 6c69 6379 5f70 6f6c     on_policy_pol
+00031270: 6963 795f 7661 6c75 652c 0a20 2020 2020  icy_value,.     
+00031280: 2020 2020 2020 2020 2020 2020 2020 2067                 g
+00031290: 616d 6d61 2c0a 2020 2020 2020 2020 2020  amma,.          
+000312a0: 2020 2020 2020 2020 2020 6265 6861 7669            behavi
+000312b0: 6f72 5f70 6f6c 6963 792c 0a20 2020 2020  or_policy,.     
+000312c0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+000312d0: 7661 6c75 6174 696f 6e5f 706f 6c69 6379  valuation_policy
+000312e0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000312f0: 2020 2020 2020 6461 7461 7365 745f 6964        dataset_id
+00031300: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00031310: 2020 5d0a 0a20 2020 2020 2020 2020 2020    ]..           
+00031320: 202e 2e20 7365 6561 6c73 6f3a 3a0a 0a20   .. seealso::.. 
+00031330: 2020 2020 2020 2020 2020 2020 2020 203a                 :
+00031340: 636c 6173 733a 6073 636f 7065 5f72 6c2e  class:`scope_rl.
+00031350: 6f70 652e 696e 7075 742e 4372 6561 7465  ope.input.Create
+00031360: 4f50 4549 6e70 7574 6020 6465 7363 7269  OPEInput` descri
+00031370: 6265 7320 7468 6520 636f 6d70 6f6e 656e  bes the componen
+00031380: 7473 206f 6620 3a63 6c61 7373 3a60 696e  ts of :class:`in
+00031390: 7075 745f 6469 6374 602e 0a0a 2020 2020  put_dict`...    
+000313a0: 2020 2020 636f 6d70 6172 6564 5f65 7374      compared_est
+000313b0: 696d 6174 6f72 733a 206c 6973 7420 6f66  imators: list of
+000313c0: 2073 7472 2c20 6465 6661 756c 743d 4e6f   str, default=No
+000313d0: 6e65 0a20 2020 2020 2020 2020 2020 204e  ne.            N
+000313e0: 616d 6520 6f66 2063 6f6d 7061 7265 6420  ame of compared 
+000313f0: 6573 7469 6d61 746f 7273 2e0a 2020 2020  estimators..    
+00031400: 2020 2020 2020 2020 4966 2060 4e6f 6e65          If `None
+00031410: 6020 6973 2067 6976 656e 2c20 616c 6c20  ` is given, all 
+00031420: 7468 6520 6573 7469 6d61 746f 7273 2061  the estimators a
+00031430: 7265 2063 6f6d 7061 7265 642e 0a0a 2020  re compared...  
+00031440: 2020 2020 2020 6265 6861 7669 6f72 5f70        behavior_p
+00031450: 6f6c 6963 795f 6e61 6d65 3a20 7374 722c  olicy_name: str,
+00031460: 2064 6566 6175 6c74 3d4e 6f6e 650a 2020   default=None.  
+00031470: 2020 2020 2020 2020 2020 4e61 6d65 206f            Name o
+00031480: 6620 7468 6520 6265 6861 7669 6f72 2070  f the behavior p
+00031490: 6f6c 6963 792e 0a0a 2020 2020 2020 2020  olicy...        
+000314a0: 6461 7461 7365 745f 6964 3a20 696e 742c  dataset_id: int,
+000314b0: 2064 6566 6175 6c74 3d4e 6f6e 650a 2020   default=None.  
+000314c0: 2020 2020 2020 2020 2020 4964 206f 6620            Id of 
+000314d0: 7468 6520 6c6f 6767 6564 2064 6174 6173  the logged datas
+000314e0: 6574 2e0a 0a20 2020 2020 2020 2061 6c70  et...        alp
+000314f0: 6861 733a 2061 7272 6179 2d6c 696b 6520  has: array-like 
+00031500: 6f66 2073 6861 7065 2028 6e5f 616c 7068  of shape (n_alph
+00031510: 612c 2029 2c20 6465 6661 756c 743d 4e6f  a, ), default=No
+00031520: 6e65 0a20 2020 2020 2020 2020 2020 2053  ne.            S
+00031530: 6574 206f 6620 7072 6f70 6f72 7469 6f6e  et of proportion
+00031540: 7320 6f66 2074 6865 2073 6861 6465 6420  s of the shaded 
+00031550: 7265 6769 6f6e 2e20 5468 6520 7661 6c75  region. The valu
+00031560: 6573 2073 686f 756c 6420 6265 2077 6974  es should be wit
+00031570: 6869 6e20 605b 302c 2031 2960 2e0a 2020  hin `[0, 1)`..  
+00031580: 2020 2020 2020 2020 2020 4966 2060 4e6f            If `No
+00031590: 6e65 6020 6973 2067 6976 656e 2c20 3a63  ne` is given, :c
+000315a0: 6c61 7373 3a60 6e70 2e6c 696e 7370 6163  lass:`np.linspac
+000315b0: 6528 302c 2031 2c20 3231 2960 2077 696c  e(0, 1, 21)` wil
+000315c0: 6c20 6265 2075 7365 642e 0a0a 2020 2020  l be used...    
+000315d0: 2020 2020 6875 653a 207b 2265 7374 696d      hue: {"estim
+000315e0: 6174 6f72 222c 2022 706f 6c69 6379 227d  ator", "policy"}
+000315f0: 2c20 6465 6661 756c 743d 2265 7374 696d  , default="estim
+00031600: 6174 6f72 220a 2020 2020 2020 2020 2020  ator".          
+00031610: 2020 4875 6520 6f66 2074 6865 2070 6c6f    Hue of the plo
+00031620: 742e 0a0a 2020 2020 2020 2020 6c65 6765  t...        lege
+00031630: 6e64 3a20 626f 6f6c 2c20 6465 6661 756c  nd: bool, defaul
+00031640: 743d 5472 7565 0a20 2020 2020 2020 2020  t=True.         
+00031650: 2020 2057 6865 7468 6572 2074 6f20 696e     Whether to in
+00031660: 636c 7564 6520 6120 6c65 6765 6e64 2069  clude a legend i
+00031670: 6e20 7468 6520 6669 6775 7265 2e0a 0a20  n the figure... 
+00031680: 2020 2020 2020 206e 5f63 6f6c 733a 2069         n_cols: i
+00031690: 6e74 2c20 6465 6661 756c 743d 4e6f 6e65  nt, default=None
+000316a0: 0a20 2020 2020 2020 2020 2020 204e 756d  .            Num
+000316b0: 6265 7220 6f66 2063 6f6c 756d 6e73 2069  ber of columns i
+000316c0: 6e20 7468 6520 6669 6775 7265 2e0a 0a20  n the figure... 
+000316d0: 2020 2020 2020 2073 6861 7265 793a 2062         sharey: b
+000316e0: 6f6f 6c2c 2064 6566 6175 6c74 3d46 616c  ool, default=Fal
+000316f0: 7365 0a20 2020 2020 2020 2020 2020 2054  se.            T
+00031700: 6869 7320 7061 7261 6d65 7465 7220 6973  his parameter is
+00031710: 2066 6f72 2041 5049 2063 6f6e 7369 7374   for API consist
+00031720: 656e 6379 2e0a 0a20 2020 2020 2020 2066  ency...        f
+00031730: 6967 5f64 6972 3a20 5061 7468 2c20 6465  ig_dir: Path, de
+00031740: 6661 756c 743d 4e6f 6e65 0a20 2020 2020  fault=None.     
+00031750: 2020 2020 2020 2050 6174 6820 746f 2073         Path to s
+00031760: 746f 7265 2074 6865 2062 6172 2066 6967  tore the bar fig
+00031770: 7572 652e 0a20 2020 2020 2020 2020 2020  ure..           
+00031780: 2049 6620 604e 6f6e 6560 2069 7320 6769   If `None` is gi
+00031790: 7665 6e2c 2074 6865 2066 6967 7572 6520  ven, the figure 
+000317a0: 7769 6c6c 206e 6f74 2062 6520 7361 7665  will not be save
+000317b0: 642e 0a0a 2020 2020 2020 2020 6669 675f  d...        fig_
+000317c0: 6e61 6d65 3a20 7374 722c 2064 6566 6175  name: str, defau
+000317d0: 6c74 3d22 6573 7469 6d61 7465 645f 636f  lt="estimated_co
+000317e0: 6e64 6974 696f 6e61 6c5f 7661 6c75 655f  nditional_value_
+000317f0: 6174 5f72 6973 6b2e 706e 6722 0a20 2020  at_risk.png".   
+00031800: 2020 2020 2020 2020 204e 616d 6520 6f66           Name of
+00031810: 2074 6865 2062 6172 2066 6967 7572 652e   the bar figure.
+00031820: 0a0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+00031830: 2020 2020 2020 636f 6d70 6172 6564 5f65        compared_e
+00031840: 7374 696d 6174 6f72 7320 3d20 7365 6c66  stimators = self
+00031850: 2e5f 6368 6563 6b5f 636f 6d70 6172 6564  ._check_compared
+00031860: 5f65 7374 696d 6174 6f72 7328 636f 6d70  _estimators(comp
+00031870: 6172 6564 5f65 7374 696d 6174 6f72 7329  ared_estimators)
+00031880: 0a20 2020 2020 2020 2061 6c70 6861 7320  .        alphas 
+00031890: 3d20 7365 6c66 2e5f 6368 6563 6b5f 6376  = self._check_cv
+000318a0: 6172 5f61 6c70 6861 7328 616c 7068 6173  ar_alphas(alphas
+000318b0: 290a 2020 2020 2020 2020 7365 6c66 2e5f  ).        self._
+000318c0: 6368 6563 6b5f 6261 7369 635f 7669 7375  check_basic_visu
+000318d0: 616c 697a 6174 696f 6e5f 696e 7075 7473  alization_inputs
+000318e0: 280a 2020 2020 2020 2020 2020 2020 6875  (.            hu
+000318f0: 653d 6875 652c 2066 6967 5f64 6972 3d66  e=hue, fig_dir=f
+00031900: 6967 5f64 6972 2c20 6669 675f 6e61 6d65  ig_dir, fig_name
+00031910: 3d66 6967 5f6e 616d 650a 2020 2020 2020  =fig_name.      
+00031920: 2020 290a 0a20 2020 2020 2020 2069 6620    )..        if 
+00031930: 7365 6c66 2e75 7365 5f6d 756c 7469 706c  self.use_multipl
+00031940: 655f 6c6f 6767 6564 5f64 6174 6173 6574  e_logged_dataset
+00031950: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+00031960: 2062 6568 6176 696f 725f 706f 6c69 6379   behavior_policy
+00031970: 5f6e 616d 6520 6973 204e 6f6e 6520 6f72  _name is None or
+00031980: 2064 6174 6173 6574 5f69 6420 6973 204e   dataset_id is N
+00031990: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+000319a0: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+000319b0: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
+000319c0: 2020 2020 2020 2020 2020 2022 6265 6861             "beha
+000319d0: 7669 6f72 5f70 6f6c 6963 7920 616e 6420  vior_policy and 
+000319e0: 6461 7461 7365 745f 6964 206d 7573 7420  dataset_id must 
+000319f0: 6265 2073 7065 6369 6669 6564 2077 6865  be specified whe
+00031a00: 6e20 7573 696e 6720 4d75 6c74 6970 6c65  n using Multiple
+00031a10: 4c6f 6767 6564 4461 7461 7365 742e 220a  LoggedDataset.".
+00031a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031a30: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
+00031a40: 2069 7369 6e73 7461 6e63 6528 696e 7075   isinstance(inpu
+00031a50: 745f 6469 6374 2c20 4d75 6c74 6970 6c65  t_dict, Multiple
+00031a60: 496e 7075 7444 6963 7429 3a0a 2020 2020  InputDict):.    
+00031a70: 2020 2020 2020 2020 2020 2020 696e 7075              inpu
+00031a80: 745f 6469 6374 203d 2069 6e70 7574 5f64  t_dict = input_d
+00031a90: 6963 742e 6765 7428 0a20 2020 2020 2020  ict.get(.       
+00031aa0: 2020 2020 2020 2020 2020 2020 2062 6568               beh
+00031ab0: 6176 696f 725f 706f 6c69 6379 5f6e 616d  avior_policy_nam
+00031ac0: 653d 6265 6861 7669 6f72 5f70 6f6c 6963  e=behavior_polic
+00031ad0: 795f 6e61 6d65 2c20 6461 7461 7365 745f  y_name, dataset_
+00031ae0: 6964 3d64 6174 6173 6574 5f69 640a 2020  id=dataset_id.  
+00031af0: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+00031b00: 2020 2020 2020 2020 6368 6563 6b5f 696e          check_in
+00031b10: 7075 745f 6469 6374 2869 6e70 7574 5f64  put_dict(input_d
+00031b20: 6963 7429 0a0a 2020 2020 2020 2020 7669  ict)..        vi
+00031b30: 7375 616c 697a 655f 6f6e 5f70 6f6c 6963  sualize_on_polic
+00031b40: 7920 3d20 5472 7565 0a20 2020 2020 2020  y = True.       
+00031b50: 2066 6f72 2065 7661 6c5f 706f 6c69 6379   for eval_policy
+00031b60: 2069 6e20 696e 7075 745f 6469 6374 2e6b   in input_dict.k
+00031b70: 6579 7328 293a 0a20 2020 2020 2020 2020  eys():.         
+00031b80: 2020 2069 6620 696e 7075 745f 6469 6374     if input_dict
+00031b90: 5b65 7661 6c5f 706f 6c69 6379 5d5b 226f  [eval_policy]["o
+00031ba0: 6e5f 706f 6c69 6379 5f70 6f6c 6963 795f  n_policy_policy_
+00031bb0: 7661 6c75 6522 5d20 6973 204e 6f6e 653a  value"] is None:
+00031bc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00031bd0: 2076 6973 7561 6c69 7a65 5f6f 6e5f 706f   visualize_on_po
+00031be0: 6c69 6379 203d 2046 616c 7365 0a0a 2020  licy = False..  
+00031bf0: 2020 2020 2020 6376 6172 5f64 6963 7420        cvar_dict 
+00031c00: 3d20 7365 6c66 2e65 7374 696d 6174 655f  = self.estimate_
+00031c10: 636f 6e64 6974 696f 6e61 6c5f 7661 6c75  conditional_valu
+00031c20: 655f 6174 5f72 6973 6b28 0a20 2020 2020  e_at_risk(.     
+00031c30: 2020 2020 2020 2069 6e70 7574 5f64 6963         input_dic
+00031c40: 742c 0a20 2020 2020 2020 2020 2020 2063  t,.            c
+00031c50: 6f6d 7061 7265 645f 6573 7469 6d61 746f  ompared_estimato
+00031c60: 7273 3d63 6f6d 7061 7265 645f 6573 7469  rs=compared_esti
+00031c70: 6d61 746f 7273 2c0a 2020 2020 2020 2020  mators,.        
+00031c80: 2020 2020 6265 6861 7669 6f72 5f70 6f6c      behavior_pol
+00031c90: 6963 795f 6e61 6d65 3d62 6568 6176 696f  icy_name=behavio
+00031ca0: 725f 706f 6c69 6379 5f6e 616d 652c 0a20  r_policy_name,. 
+00031cb0: 2020 2020 2020 2020 2020 2064 6174 6173             datas
+00031cc0: 6574 5f69 643d 6461 7461 7365 745f 6964  et_id=dataset_id
+00031cd0: 2c0a 2020 2020 2020 2020 2020 2020 616c  ,.            al
+00031ce0: 7068 6173 3d61 6c70 6861 732c 0a20 2020  phas=alphas,.   
+00031cf0: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+00031d00: 6966 2076 6973 7561 6c69 7a65 5f6f 6e5f  if visualize_on_
+00031d10: 706f 6c69 6379 3a0a 2020 2020 2020 2020  policy:.        
+00031d20: 2020 2020 636f 6d70 6172 6564 5f65 7374      compared_est
+00031d30: 696d 6174 6f72 732e 6170 7065 6e64 2822  imators.append("
+00031d40: 6f6e 5f70 6f6c 6963 7922 290a 0a20 2020  on_policy")..   
+00031d50: 2020 2020 2070 6c74 2e73 7479 6c65 2e75       plt.style.u
+00031d60: 7365 2822 6767 706c 6f74 2229 0a0a 2020  se("ggplot")..  
+00031d70: 2020 2020 2020 6966 2068 7565 203d 3d20        if hue == 
+00031d80: 2265 7374 696d 6174 6f72 223a 0a20 2020  "estimator":.   
+00031d90: 2020 2020 2020 2020 206e 5f66 6967 7320           n_figs 
+00031da0: 3d20 6c65 6e28 696e 7075 745f 6469 6374  = len(input_dict
+00031db0: 290a 2020 2020 2020 2020 2020 2020 6e5f  ).            n_
+00031dc0: 636f 6c73 203d 206d 696e 2833 2c20 6e5f  cols = min(3, n_
+00031dd0: 6669 6773 2920 6966 206e 5f63 6f6c 7320  figs) if n_cols 
+00031de0: 6973 204e 6f6e 6520 656c 7365 206e 5f63  is None else n_c
+00031df0: 6f6c 730a 2020 2020 2020 2020 2020 2020  ols.            
+00031e00: 6e5f 726f 7773 203d 2028 6e5f 6669 6773  n_rows = (n_figs
+00031e10: 202d 2031 2920 2f2f 206e 5f63 6f6c 7320   - 1) // n_cols 
+00031e20: 2b20 310a 0a20 2020 2020 2020 2020 2020  + 1..           
+00031e30: 2066 6967 2c20 6178 6573 203d 2070 6c74   fig, axes = plt
+00031e40: 2e73 7562 706c 6f74 7328 0a20 2020 2020  .subplots(.     
+00031e50: 2020 2020 2020 2020 2020 206e 726f 7773             nrows
+00031e60: 3d6e 5f72 6f77 732c 206e 636f 6c73 3d6e  =n_rows, ncols=n
+00031e70: 5f63 6f6c 732c 2066 6967 7369 7a65 3d28  _cols, figsize=(
+00031e80: 3620 2a20 6e5f 636f 6c73 2c20 3420 2a20  6 * n_cols, 4 * 
+00031e90: 6e5f 726f 7773 290a 2020 2020 2020 2020  n_rows).        
+00031ea0: 2020 2020 290a 0a20 2020 2020 2020 2020      )..         
+00031eb0: 2020 2069 6620 6e5f 726f 7773 203d 3d20     if n_rows == 
+00031ec0: 313a 0a20 2020 2020 2020 2020 2020 2020  1:.             
+00031ed0: 2020 2066 6f72 2069 2c20 6576 616c 5f70     for i, eval_p
+00031ee0: 6f6c 6963 7920 696e 2065 6e75 6d65 7261  olicy in enumera
+00031ef0: 7465 2869 6e70 7574 5f64 6963 742e 6b65  te(input_dict.ke
+00031f00: 7973 2829 293a 0a20 2020 2020 2020 2020  ys()):.         
+00031f10: 2020 2020 2020 2020 2020 2066 6f72 206a             for j
+00031f20: 2c20 6573 7469 6d61 746f 7220 696e 2065  , estimator in e
+00031f30: 6e75 6d65 7261 7465 2863 6f6d 7061 7265  numerate(compare
+00031f40: 645f 6573 7469 6d61 746f 7273 293a 0a20  d_estimators):. 
+00031f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031f60: 2020 2020 2020 2061 7865 735b 695d 2e70         axes[i].p
+00031f70: 6c6f 7428 0a20 2020 2020 2020 2020 2020  lot(.           
+00031f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031f90: 2061 6c70 6861 732c 0a20 2020 2020 2020   alphas,.       
+00031fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031fb0: 2020 2020 2063 7661 725f 6469 6374 5b65       cvar_dict[e
+00031fc0: 7661 6c5f 706f 6c69 6379 5d5b 6573 7469  val_policy][esti
+00031fd0: 6d61 746f 725d 2c0a 2020 2020 2020 2020  mator],.        
+00031fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031ff0: 2020 2020 6c61 6265 6c3d 6573 7469 6d61      label=estima
+00032000: 746f 722c 0a20 2020 2020 2020 2020 2020  tor,.           
+00032010: 2020 2020 2020 2020 2020 2020 2029 0a0a               )..
+00032020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032030: 2020 2020 6178 6573 5b69 5d2e 7365 745f      axes[i].set_
+00032040: 7469 746c 6528 6576 616c 5f70 6f6c 6963  title(eval_polic
+00032050: 7929 0a20 2020 2020 2020 2020 2020 2020  y).             
+00032060: 2020 2020 2020 2061 7865 735b 695d 2e73         axes[i].s
+00032070: 6574 5f78 6c61 6265 6c28 2261 6c70 6861  et_xlabel("alpha
+00032080: 2229 0a20 2020 2020 2020 2020 2020 2020  ").             
+00032090: 2020 2020 2020 2061 7865 735b 695d 2e73         axes[i].s
+000320a0: 6574 5f79 6c61 6265 6c28 2243 5661 5222  et_ylabel("CVaR"
+000320b0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+000320c0: 2020 2020 2020 6966 206c 6567 656e 643a        if legend:
+000320d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000320e0: 2020 2020 2020 2020 2061 7865 735b 695d           axes[i]
+000320f0: 2e6c 6567 656e 6428 290a 0a20 2020 2020  .legend()..     
+00032100: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
+00032110: 6765 6e64 3a0a 2020 2020 2020 2020 2020  gend:.          
+00032120: 2020 2020 2020 2020 2020 6861 6e64 6c65            handle
+00032130: 732c 206c 6162 656c 7320 3d20 6178 6573  s, labels = axes
+00032140: 5b30 5d2e 6765 745f 6c65 6765 6e64 5f68  [0].get_legend_h
+00032150: 616e 646c 6573 5f6c 6162 656c 7328 290a  andles_labels().
+00032160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032170: 2020 2020 2320 6e5f 636f 6c73 2073 686f      # n_cols sho
+00032180: 7773 2065 7272 0a20 2020 2020 2020 2020  ws err.         
+00032190: 2020 2020 2020 2020 2020 2023 2066 6967             # fig
+000321a0: 2e6c 6567 656e 6428 6861 6e64 6c65 732c  .legend(handles,
+000321b0: 206c 6162 656c 732c 206c 6f63 3d27 7570   labels, loc='up
+000321c0: 7065 7220 6365 6e74 6572 272c 2062 626f  per center', bbo
+000321d0: 785f 746f 5f61 6e63 686f 723d 2830 2e35  x_to_anchor=(0.5
+000321e0: 2c20 2d30 2e31 292c 206e 5f63 6f6c 733d  , -0.1), n_cols=
+000321f0: 6d69 6e28 6c65 6e28 6c61 6265 6c73 292c  min(len(labels),
+00032200: 2036 2929 0a0a 2020 2020 2020 2020 2020   6))..          
+00032210: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00032220: 2020 2020 2020 2020 666f 7220 692c 2065          for i, e
+00032230: 7661 6c5f 706f 6c69 6379 2069 6e20 656e  val_policy in en
+00032240: 756d 6572 6174 6528 696e 7075 745f 6469  umerate(input_di
+00032250: 6374 2e6b 6579 7328 2929 3a0a 2020 2020  ct.keys()):.    
+00032260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032270: 666f 7220 6a2c 2065 7374 696d 6174 6f72  for j, estimator
+00032280: 2069 6e20 656e 756d 6572 6174 6528 636f   in enumerate(co
+00032290: 6d70 6172 6564 5f65 7374 696d 6174 6f72  mpared_estimator
+000322a0: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
+000322b0: 2020 2020 2020 2020 2020 2020 6178 6573              axes
+000322c0: 5b69 202f 2f20 6e5f 636f 6c73 2c20 6920  [i // n_cols, i 
+000322d0: 2520 6e5f 636f 6c73 5d2e 706c 6f74 280a  % n_cols].plot(.
+000322e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000322f0: 2020 2020 2020 2020 2020 2020 616c 7068              alph
+00032300: 6173 2c0a 2020 2020 2020 2020 2020 2020  as,.            
+00032310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032320: 6376 6172 5f64 6963 745b 6576 616c 5f70  cvar_dict[eval_p
+00032330: 6f6c 6963 795d 5b65 7374 696d 6174 6f72  olicy][estimator
+00032340: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+00032350: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+00032360: 6162 656c 3d65 7374 696d 6174 6f72 2c0a  abel=estimator,.
+00032370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032380: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+00032390: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+000323a0: 7865 735b 6920 2f2f 206e 5f63 6f6c 732c  xes[i // n_cols,
+000323b0: 2069 2025 206e 5f63 6f6c 735d 2e73 6574   i % n_cols].set
+000323c0: 5f74 6974 6c65 2865 7661 6c5f 706f 6c69  _title(eval_poli
+000323d0: 6379 290a 2020 2020 2020 2020 2020 2020  cy).            
+000323e0: 2020 2020 2020 2020 6178 6573 5b69 202f          axes[i /
+000323f0: 2f20 6e5f 636f 6c73 2c20 6920 2520 6e5f  / n_cols, i % n_
+00032400: 636f 6c73 5d2e 7365 745f 786c 6162 656c  cols].set_xlabel
+00032410: 2822 616c 7068 6122 290a 2020 2020 2020  ("alpha").      
+00032420: 2020 2020 2020 2020 2020 2020 2020 6178                ax
+00032430: 6573 5b69 202f 2f20 6e5f 636f 6c73 2c20  es[i // n_cols, 
+00032440: 6920 2520 6e5f 636f 6c73 5d2e 7365 745f  i % n_cols].set_
+00032450: 796c 6162 656c 2822 4356 6152 2229 0a20  ylabel("CVaR"). 
 00032460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032470: 2020 2061 7865 735b 6920 2f2f 206e 5f63     axes[i // n_c
-00032480: 6f6c 732c 2069 2025 206e 5f63 6f6c 735d  ols, i % n_cols]
-00032490: 2e73 6574 5f74 6974 6c65 2865 7661 6c5f  .set_title(eval_
-000324a0: 706f 6c69 6379 290a 2020 2020 2020 2020  policy).        
-000324b0: 2020 2020 2020 2020 2020 2020 6178 6573              axes
-000324c0: 5b69 202f 2f20 6e5f 636f 6c73 2c20 6920  [i // n_cols, i 
-000324d0: 2520 6e5f 636f 6c73 5d2e 7365 745f 786c  % n_cols].set_xl
-000324e0: 6162 656c 2822 616c 7068 6122 290a 2020  abel("alpha").  
-000324f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032500: 2020 6178 6573 5b69 202f 2f20 6e5f 636f    axes[i // n_co
-00032510: 6c73 2c20 6920 2520 6e5f 636f 6c73 5d2e  ls, i % n_cols].
-00032520: 7365 745f 796c 6162 656c 2822 4356 6152  set_ylabel("CVaR
-00032530: 2229 0a20 2020 2020 2020 2020 2020 2020  ").             
-00032540: 2020 2020 2020 2069 6620 6c65 6765 6e64         if legend
-00032550: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00032560: 2020 2020 2020 2020 2020 6178 6573 5b69            axes[i
-00032570: 202f 2f20 6e5f 636f 6c73 2c20 6920 2520   // n_cols, i % 
-00032580: 6e5f 636f 6c73 5d2e 6c65 6765 6e64 2829  n_cols].legend()
-00032590: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000325a0: 2020 6966 206c 6567 656e 643a 0a20 2020    if legend:.   
-000325b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000325c0: 2068 616e 646c 6573 2c20 6c61 6265 6c73   handles, labels
-000325d0: 203d 2061 7865 735b 302c 2030 5d2e 6765   = axes[0, 0].ge
-000325e0: 745f 6c65 6765 6e64 5f68 616e 646c 6573  t_legend_handles
-000325f0: 5f6c 6162 656c 7328 290a 2020 2020 2020  _labels().      
-00032600: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-00032610: 6e5f 636f 6c73 2073 686f 7773 2065 7272  n_cols shows err
-00032620: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00032630: 2020 2020 2023 2066 6967 2e6c 6567 656e       # fig.legen
-00032640: 6428 6861 6e64 6c65 732c 206c 6162 656c  d(handles, label
-00032650: 732c 206c 6f63 3d27 7570 7065 7220 6365  s, loc='upper ce
-00032660: 6e74 6572 272c 2062 626f 785f 746f 5f61  nter', bbox_to_a
-00032670: 6e63 686f 723d 2830 2e35 2c20 2d30 2e31  nchor=(0.5, -0.1
-00032680: 292c 206e 5f63 6f6c 733d 6d69 6e28 6c65  ), n_cols=min(le
-00032690: 6e28 6c61 6265 6c73 292c 2036 2929 0a0a  n(labels), 6))..
-000326a0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-000326b0: 2020 2020 2020 2020 2020 6e5f 6669 6773            n_figs
-000326c0: 203d 206c 656e 2863 6f6d 7061 7265 645f   = len(compared_
-000326d0: 6573 7469 6d61 746f 7273 290a 2020 2020  estimators).    
-000326e0: 2020 2020 2020 2020 6e5f 636f 6c73 203d          n_cols =
-000326f0: 206d 696e 2833 2c20 6e5f 6669 6773 2920   min(3, n_figs) 
-00032700: 6966 206e 5f63 6f6c 7320 6973 204e 6f6e  if n_cols is Non
-00032710: 6520 656c 7365 206e 5f63 6f6c 730a 2020  e else n_cols.  
-00032720: 2020 2020 2020 2020 2020 6e5f 726f 7773            n_rows
-00032730: 203d 2028 6e5f 6669 6773 202d 2031 2920   = (n_figs - 1) 
-00032740: 2f2f 206e 5f63 6f6c 7320 2b20 310a 0a20  // n_cols + 1.. 
-00032750: 2020 2020 2020 2020 2020 2066 6967 2c20             fig, 
-00032760: 6178 6573 203d 2070 6c74 2e73 7562 706c  axes = plt.subpl
-00032770: 6f74 7328 0a20 2020 2020 2020 2020 2020  ots(.           
-00032780: 2020 2020 206e 726f 7773 3d6e 5f72 6f77       nrows=n_row
-00032790: 732c 206e 636f 6c73 3d6e 5f63 6f6c 732c  s, ncols=n_cols,
-000327a0: 2066 6967 7369 7a65 3d28 3620 2a20 6e5f   figsize=(6 * n_
-000327b0: 636f 6c73 2c20 3420 2a20 6e5f 726f 7773  cols, 4 * n_rows
-000327c0: 290a 2020 2020 2020 2020 2020 2020 290a  ).            ).
-000327d0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-000327e0: 6e5f 726f 7773 203d 3d20 313a 0a20 2020  n_rows == 1:.   
-000327f0: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-00032800: 2069 2c20 6573 7469 6d61 746f 7220 696e   i, estimator in
-00032810: 2065 6e75 6d65 7261 7465 2863 6f6d 7061   enumerate(compa
-00032820: 7265 645f 6573 7469 6d61 746f 7273 293a  red_estimators):
-00032830: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00032840: 2020 2020 2066 6f72 206a 2c20 6576 616c       for j, eval
-00032850: 5f70 6f6c 6963 7920 696e 2065 6e75 6d65  _policy in enume
-00032860: 7261 7465 2869 6e70 7574 5f64 6963 742e  rate(input_dict.
-00032870: 6b65 7973 2829 293a 0a20 2020 2020 2020  keys()):.       
-00032880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032890: 2061 7865 735b 695d 2e70 6c6f 7428 0a20   axes[i].plot(. 
-000328a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000328b0: 2020 2020 2020 2020 2020 2061 6c70 6861             alpha
-000328c0: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
-000328d0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-000328e0: 7661 725f 6469 6374 5b65 7661 6c5f 706f  var_dict[eval_po
-000328f0: 6c69 6379 5d5b 6573 7469 6d61 746f 725d  licy][estimator]
-00032900: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00032910: 2020 2020 2020 2020 2020 2020 2020 6c61                la
-00032920: 6265 6c3d 6576 616c 5f70 6f6c 6963 792c  bel=eval_policy,
-00032930: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00032940: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-00032950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032960: 6178 6573 5b69 5d2e 7365 745f 7469 746c  axes[i].set_titl
-00032970: 6528 6573 7469 6d61 746f 7229 0a20 2020  e(estimator).   
-00032980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032990: 2061 7865 735b 695d 2e73 6574 5f78 6c61   axes[i].set_xla
-000329a0: 6265 6c28 2261 6c70 6861 2229 0a20 2020  bel("alpha").   
-000329b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000329c0: 2061 7865 735b 695d 2e73 6574 5f79 6c61   axes[i].set_yla
-000329d0: 6265 6c28 2243 5661 5222 290a 2020 2020  bel("CVaR").    
+00032470: 2020 2069 6620 6c65 6765 6e64 3a0a 2020     if legend:.  
+00032480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032490: 2020 2020 2020 6178 6573 5b69 202f 2f20        axes[i // 
+000324a0: 6e5f 636f 6c73 2c20 6920 2520 6e5f 636f  n_cols, i % n_co
+000324b0: 6c73 5d2e 6c65 6765 6e64 2829 0a0a 2020  ls].legend()..  
+000324c0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+000324d0: 206c 6567 656e 643a 0a20 2020 2020 2020   legend:.       
+000324e0: 2020 2020 2020 2020 2020 2020 2068 616e               han
+000324f0: 646c 6573 2c20 6c61 6265 6c73 203d 2061  dles, labels = a
+00032500: 7865 735b 302c 2030 5d2e 6765 745f 6c65  xes[0, 0].get_le
+00032510: 6765 6e64 5f68 616e 646c 6573 5f6c 6162  gend_handles_lab
+00032520: 656c 7328 290a 2020 2020 2020 2020 2020  els().          
+00032530: 2020 2020 2020 2020 2020 2320 6e5f 636f            # n_co
+00032540: 6c73 2073 686f 7773 2065 7272 0a20 2020  ls shows err.   
+00032550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032560: 2023 2066 6967 2e6c 6567 656e 6428 6861   # fig.legend(ha
+00032570: 6e64 6c65 732c 206c 6162 656c 732c 206c  ndles, labels, l
+00032580: 6f63 3d27 7570 7065 7220 6365 6e74 6572  oc='upper center
+00032590: 272c 2062 626f 785f 746f 5f61 6e63 686f  ', bbox_to_ancho
+000325a0: 723d 2830 2e35 2c20 2d30 2e31 292c 206e  r=(0.5, -0.1), n
+000325b0: 5f63 6f6c 733d 6d69 6e28 6c65 6e28 6c61  _cols=min(len(la
+000325c0: 6265 6c73 292c 2036 2929 0a0a 2020 2020  bels), 6))..    
+000325d0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+000325e0: 2020 2020 2020 6e5f 6669 6773 203d 206c        n_figs = l
+000325f0: 656e 2863 6f6d 7061 7265 645f 6573 7469  en(compared_esti
+00032600: 6d61 746f 7273 290a 2020 2020 2020 2020  mators).        
+00032610: 2020 2020 6e5f 636f 6c73 203d 206d 696e      n_cols = min
+00032620: 2833 2c20 6e5f 6669 6773 2920 6966 206e  (3, n_figs) if n
+00032630: 5f63 6f6c 7320 6973 204e 6f6e 6520 656c  _cols is None el
+00032640: 7365 206e 5f63 6f6c 730a 2020 2020 2020  se n_cols.      
+00032650: 2020 2020 2020 6e5f 726f 7773 203d 2028        n_rows = (
+00032660: 6e5f 6669 6773 202d 2031 2920 2f2f 206e  n_figs - 1) // n
+00032670: 5f63 6f6c 7320 2b20 310a 0a20 2020 2020  _cols + 1..     
+00032680: 2020 2020 2020 2066 6967 2c20 6178 6573         fig, axes
+00032690: 203d 2070 6c74 2e73 7562 706c 6f74 7328   = plt.subplots(
+000326a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000326b0: 206e 726f 7773 3d6e 5f72 6f77 732c 206e   nrows=n_rows, n
+000326c0: 636f 6c73 3d6e 5f63 6f6c 732c 2066 6967  cols=n_cols, fig
+000326d0: 7369 7a65 3d28 3620 2a20 6e5f 636f 6c73  size=(6 * n_cols
+000326e0: 2c20 3420 2a20 6e5f 726f 7773 290a 2020  , 4 * n_rows).  
+000326f0: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+00032700: 2020 2020 2020 2020 2069 6620 6e5f 726f           if n_ro
+00032710: 7773 203d 3d20 313a 0a20 2020 2020 2020  ws == 1:.       
+00032720: 2020 2020 2020 2020 2066 6f72 2069 2c20           for i, 
+00032730: 6573 7469 6d61 746f 7220 696e 2065 6e75  estimator in enu
+00032740: 6d65 7261 7465 2863 6f6d 7061 7265 645f  merate(compared_
+00032750: 6573 7469 6d61 746f 7273 293a 0a20 2020  estimators):.   
+00032760: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032770: 2066 6f72 206a 2c20 6576 616c 5f70 6f6c   for j, eval_pol
+00032780: 6963 7920 696e 2065 6e75 6d65 7261 7465  icy in enumerate
+00032790: 2869 6e70 7574 5f64 6963 742e 6b65 7973  (input_dict.keys
+000327a0: 2829 293a 0a20 2020 2020 2020 2020 2020  ()):.           
+000327b0: 2020 2020 2020 2020 2020 2020 2061 7865               axe
+000327c0: 735b 695d 2e70 6c6f 7428 0a20 2020 2020  s[i].plot(.     
+000327d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000327e0: 2020 2020 2020 2061 6c70 6861 732c 0a20         alphas,. 
+000327f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032800: 2020 2020 2020 2020 2020 2063 7661 725f             cvar_
+00032810: 6469 6374 5b65 7661 6c5f 706f 6c69 6379  dict[eval_policy
+00032820: 5d5b 6573 7469 6d61 746f 725d 2c0a 2020  ][estimator],.  
+00032830: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032840: 2020 2020 2020 2020 2020 6c61 6265 6c3d            label=
+00032850: 6576 616c 5f70 6f6c 6963 792c 0a20 2020  eval_policy,.   
+00032860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032870: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+00032880: 2020 2020 2020 2020 2020 2020 6178 6573              axes
+00032890: 5b69 5d2e 7365 745f 7469 746c 6528 6573  [i].set_title(es
+000328a0: 7469 6d61 746f 7229 0a20 2020 2020 2020  timator).       
+000328b0: 2020 2020 2020 2020 2020 2020 2061 7865               axe
+000328c0: 735b 695d 2e73 6574 5f78 6c61 6265 6c28  s[i].set_xlabel(
+000328d0: 2261 6c70 6861 2229 0a20 2020 2020 2020  "alpha").       
+000328e0: 2020 2020 2020 2020 2020 2020 2061 7865               axe
+000328f0: 735b 695d 2e73 6574 5f79 6c61 6265 6c28  s[i].set_ylabel(
+00032900: 2243 5661 5222 290a 2020 2020 2020 2020  "CVaR").        
+00032910: 2020 2020 2020 2020 2020 2020 6966 206c              if l
+00032920: 6567 656e 643a 0a20 2020 2020 2020 2020  egend:.         
+00032930: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+00032940: 7865 735b 695d 2e6c 6567 656e 6428 290a  xes[i].legend().
+00032950: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00032960: 2069 6620 6c65 6765 6e64 3a0a 2020 2020   if legend:.    
+00032970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032980: 6861 6e64 6c65 732c 206c 6162 656c 7320  handles, labels 
+00032990: 3d20 6178 6573 5b30 5d2e 6765 745f 6c65  = axes[0].get_le
+000329a0: 6765 6e64 5f68 616e 646c 6573 5f6c 6162  gend_handles_lab
+000329b0: 656c 7328 290a 2020 2020 2020 2020 2020  els().          
+000329c0: 2020 2020 2020 2020 2020 2320 6e5f 636f            # n_co
+000329d0: 6c73 2073 686f 7773 2065 7272 0a20 2020  ls shows err.   
 000329e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000329f0: 6966 206c 6567 656e 643a 0a20 2020 2020  if legend:.     
-00032a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032a10: 2020 2061 7865 735b 695d 2e6c 6567 656e     axes[i].legen
-00032a20: 6428 290a 0a20 2020 2020 2020 2020 2020  d()..           
-00032a30: 2020 2020 2069 6620 6c65 6765 6e64 3a0a       if legend:.
-00032a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032a50: 2020 2020 6861 6e64 6c65 732c 206c 6162      handles, lab
-00032a60: 656c 7320 3d20 6178 6573 5b30 5d2e 6765  els = axes[0].ge
-00032a70: 745f 6c65 6765 6e64 5f68 616e 646c 6573  t_legend_handles
-00032a80: 5f6c 6162 656c 7328 290a 2020 2020 2020  _labels().      
-00032a90: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-00032aa0: 6e5f 636f 6c73 2073 686f 7773 2065 7272  n_cols shows err
-00032ab0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00032ac0: 2020 2020 2023 2066 6967 2e6c 6567 656e       # fig.legen
-00032ad0: 6428 6861 6e64 6c65 732c 206c 6162 656c  d(handles, label
-00032ae0: 732c 206c 6f63 3d27 7570 7065 7220 6365  s, loc='upper ce
-00032af0: 6e74 6572 272c 2062 626f 785f 746f 5f61  nter', bbox_to_a
-00032b00: 6e63 686f 723d 2830 2e35 2c20 2d30 2e31  nchor=(0.5, -0.1
-00032b10: 292c 206e 5f63 6f6c 733d 6d69 6e28 6c65  ), n_cols=min(le
-00032b20: 6e28 6c61 6265 6c73 292c 2036 2929 0a0a  n(labels), 6))..
-00032b30: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00032b40: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00032b50: 2020 666f 7220 692c 2065 7374 696d 6174    for i, estimat
-00032b60: 6f72 2069 6e20 656e 756d 6572 6174 6528  or in enumerate(
-00032b70: 636f 6d70 6172 6564 5f65 7374 696d 6174  compared_estimat
-00032b80: 6f72 7329 3a0a 2020 2020 2020 2020 2020  ors):.          
-00032b90: 2020 2020 2020 2020 2020 666f 7220 6a2c            for j,
-00032ba0: 2065 7661 6c5f 706f 6c69 6379 2069 6e20   eval_policy in 
-00032bb0: 656e 756d 6572 6174 6528 696e 7075 745f  enumerate(input_
-00032bc0: 6469 6374 2e6b 6579 7328 2929 3a0a 2020  dict.keys()):.  
+000329f0: 2023 2066 6967 2e6c 6567 656e 6428 6861   # fig.legend(ha
+00032a00: 6e64 6c65 732c 206c 6162 656c 732c 206c  ndles, labels, l
+00032a10: 6f63 3d27 7570 7065 7220 6365 6e74 6572  oc='upper center
+00032a20: 272c 2062 626f 785f 746f 5f61 6e63 686f  ', bbox_to_ancho
+00032a30: 723d 2830 2e35 2c20 2d30 2e31 292c 206e  r=(0.5, -0.1), n
+00032a40: 5f63 6f6c 733d 6d69 6e28 6c65 6e28 6c61  _cols=min(len(la
+00032a50: 6265 6c73 292c 2036 2929 0a0a 2020 2020  bels), 6))..    
+00032a60: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00032a70: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+00032a80: 7220 692c 2065 7374 696d 6174 6f72 2069  r i, estimator i
+00032a90: 6e20 656e 756d 6572 6174 6528 636f 6d70  n enumerate(comp
+00032aa0: 6172 6564 5f65 7374 696d 6174 6f72 7329  ared_estimators)
+00032ab0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00032ac0: 2020 2020 2020 666f 7220 6a2c 2065 7661        for j, eva
+00032ad0: 6c5f 706f 6c69 6379 2069 6e20 656e 756d  l_policy in enum
+00032ae0: 6572 6174 6528 696e 7075 745f 6469 6374  erate(input_dict
+00032af0: 2e6b 6579 7328 2929 3a0a 2020 2020 2020  .keys()):.      
+00032b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032b10: 2020 6178 6573 5b69 202f 2f20 6e5f 636f    axes[i // n_co
+00032b20: 6c73 2c20 6920 2520 6e5f 636f 6c73 5d2e  ls, i % n_cols].
+00032b30: 706c 6f74 280a 2020 2020 2020 2020 2020  plot(.          
+00032b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032b50: 2020 616c 7068 6173 2c0a 2020 2020 2020    alphas,.      
+00032b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032b70: 2020 2020 2020 6376 6172 5f64 6963 745b        cvar_dict[
+00032b80: 6576 616c 5f70 6f6c 6963 795d 5b65 7374  eval_policy][est
+00032b90: 696d 6174 6f72 5d2c 0a20 2020 2020 2020  imator],.       
+00032ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00032bb0: 2020 2020 206c 6162 656c 3d65 7661 6c5f       label=eval_
+00032bc0: 706f 6c69 6379 2c0a 2020 2020 2020 2020  policy,.        
 00032bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032be0: 2020 2020 2020 6178 6573 5b69 202f 2f20        axes[i // 
-00032bf0: 6e5f 636f 6c73 2c20 6920 2520 6e5f 636f  n_cols, i % n_co
-00032c00: 6c73 5d2e 706c 6f74 280a 2020 2020 2020  ls].plot(.      
-00032c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032c20: 2020 2020 2020 616c 7068 6173 2c0a 2020        alphas,.  
-00032c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032c40: 2020 2020 2020 2020 2020 6376 6172 5f64            cvar_d
-00032c50: 6963 745b 6576 616c 5f70 6f6c 6963 795d  ict[eval_policy]
-00032c60: 5b65 7374 696d 6174 6f72 5d2c 0a20 2020  [estimator],.   
+00032be0: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
+00032bf0: 2020 2020 2020 2061 7865 735b 6920 2f2f         axes[i //
+00032c00: 206e 5f63 6f6c 732c 2069 2025 206e 5f63   n_cols, i % n_c
+00032c10: 6f6c 735d 2e73 6574 5f74 6974 6c65 2865  ols].set_title(e
+00032c20: 7374 696d 6174 6f72 290a 2020 2020 2020  stimator).      
+00032c30: 2020 2020 2020 2020 2020 2020 2020 6178                ax
+00032c40: 6573 5b69 202f 2f20 6e5f 636f 6c73 2c20  es[i // n_cols, 
+00032c50: 6920 2520 6e5f 636f 6c73 5d2e 7365 745f  i % n_cols].set_
+00032c60: 786c 6162 656c 2822 616c 7068 6122 290a  xlabel("alpha").
 00032c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032c80: 2020 2020 2020 2020 206c 6162 656c 3d65           label=e
-00032c90: 7661 6c5f 706f 6c69 6379 2c0a 2020 2020  val_policy,.    
-00032ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032cb0: 2020 2020 290a 0a20 2020 2020 2020 2020      )..         
-00032cc0: 2020 2020 2020 2020 2020 2061 7865 735b             axes[
-00032cd0: 6920 2f2f 206e 5f63 6f6c 732c 2069 2025  i // n_cols, i %
-00032ce0: 206e 5f63 6f6c 735d 2e73 6574 5f74 6974   n_cols].set_tit
-00032cf0: 6c65 2865 7374 696d 6174 6f72 290a 2020  le(estimator).  
-00032d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032d10: 2020 6178 6573 5b69 202f 2f20 6e5f 636f    axes[i // n_co
-00032d20: 6c73 2c20 6920 2520 6e5f 636f 6c73 5d2e  ls, i % n_cols].
-00032d30: 7365 745f 786c 6162 656c 2822 616c 7068  set_xlabel("alph
-00032d40: 6122 290a 2020 2020 2020 2020 2020 2020  a").            
-00032d50: 2020 2020 2020 2020 6178 6573 5b69 202f          axes[i /
-00032d60: 2f20 6e5f 636f 6c73 2c20 6920 2520 6e5f  / n_cols, i % n_
-00032d70: 636f 6c73 5d2e 7365 745f 796c 6162 656c  cols].set_ylabel
-00032d80: 2822 4356 6152 2229 0a20 2020 2020 2020  ("CVaR").       
-00032d90: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00032da0: 6c65 6765 6e64 3a0a 2020 2020 2020 2020  legend:.        
-00032db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032dc0: 6178 6573 5b69 202f 2f20 6e5f 636f 6c73  axes[i // n_cols
-00032dd0: 2c20 6920 2520 6e5f 636f 6c73 5d2e 6c65  , i % n_cols].le
-00032de0: 6765 6e64 2829 0a0a 2020 2020 2020 2020  gend()..        
-00032df0: 2020 2020 6966 206c 6567 656e 643a 0a20      if legend:. 
-00032e00: 2020 2020 2020 2020 2020 2020 2020 2068                 h
-00032e10: 616e 646c 6573 2c20 6c61 6265 6c73 203d  andles, labels =
-00032e20: 2061 7865 735b 302c 2030 5d2e 6765 745f   axes[0, 0].get_
-00032e30: 6c65 6765 6e64 5f68 616e 646c 6573 5f6c  legend_handles_l
-00032e40: 6162 656c 7328 290a 2020 2020 2020 2020  abels().        
-00032e50: 2020 2020 2020 2020 2320 6e5f 636f 6c73          # n_cols
-00032e60: 2073 686f 7773 2065 7272 0a20 2020 2020   shows err.     
-00032e70: 2020 2020 2020 2020 2020 2023 2066 6967             # fig
-00032e80: 2e6c 6567 656e 6428 6861 6e64 6c65 732c  .legend(handles,
-00032e90: 206c 6162 656c 732c 206c 6f63 3d27 7570   labels, loc='up
-00032ea0: 7065 7220 6365 6e74 6572 272c 2062 626f  per center', bbo
-00032eb0: 785f 746f 5f61 6e63 686f 723d 2830 2e35  x_to_anchor=(0.5
-00032ec0: 2c20 2d30 2e31 292c 206e 5f63 6f6c 733d  , -0.1), n_cols=
-00032ed0: 6d69 6e28 6c65 6e28 6c61 6265 6c73 292c  min(len(labels),
-00032ee0: 2036 2929 0a0a 2020 2020 2020 2020 6669   6))..        fi
-00032ef0: 672e 7375 6270 6c6f 7473 5f61 646a 7573  g.subplots_adjus
-00032f00: 7428 6873 7061 6365 3d30 2e33 352c 2077  t(hspace=0.35, w
-00032f10: 7370 6163 653d 302e 3229 0a20 2020 2020  space=0.2).     
-00032f20: 2020 2070 6c74 2e73 686f 7728 290a 0a20     plt.show().. 
-00032f30: 2020 2020 2020 2069 6620 6669 675f 6469         if fig_di
-00032f40: 723a 0a20 2020 2020 2020 2020 2020 2066  r:.            f
-00032f50: 6967 2e73 6176 6566 6967 2873 7472 2866  ig.savefig(str(f
-00032f60: 6967 5f64 6972 202f 2066 6967 5f6e 616d  ig_dir / fig_nam
-00032f70: 6529 2c20 6470 693d 3330 302c 2062 626f  e), dpi=300, bbo
-00032f80: 785f 696e 6368 6573 3d22 7469 6768 7422  x_inches="tight"
-00032f90: 290a 0a20 2020 2064 6566 2076 6973 7561  )..    def visua
-00032fa0: 6c69 7a65 5f69 6e74 6572 7175 6172 7469  lize_interquarti
-00032fb0: 6c65 5f72 616e 6765 280a 2020 2020 2020  le_range(.      
-00032fc0: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-00032fd0: 696e 7075 745f 6469 6374 3a20 556e 696f  input_dict: Unio
-00032fe0: 6e5b 4f50 4549 6e70 7574 4469 6374 2c20  n[OPEInputDict, 
-00032ff0: 4d75 6c74 6970 6c65 496e 7075 7444 6963  MultipleInputDic
-00033000: 745d 2c0a 2020 2020 2020 2020 636f 6d70  t],.        comp
-00033010: 6172 6564 5f65 7374 696d 6174 6f72 733a  ared_estimators:
-00033020: 204f 7074 696f 6e61 6c5b 4c69 7374 5b73   Optional[List[s
-00033030: 7472 5d5d 203d 204e 6f6e 652c 0a20 2020  tr]] = None,.   
-00033040: 2020 2020 2062 6568 6176 696f 725f 706f       behavior_po
-00033050: 6c69 6379 5f6e 616d 653a 204f 7074 696f  licy_name: Optio
-00033060: 6e61 6c5b 7374 725d 203d 204e 6f6e 652c  nal[str] = None,
-00033070: 0a20 2020 2020 2020 2064 6174 6173 6574  .        dataset
-00033080: 5f69 643a 204f 7074 696f 6e61 6c5b 696e  _id: Optional[in
-00033090: 745d 203d 204e 6f6e 652c 0a20 2020 2020  t] = None,.     
-000330a0: 2020 2061 6c70 6861 3a20 666c 6f61 7420     alpha: float 
-000330b0: 3d20 302e 3035 2c0a 2020 2020 2020 2020  = 0.05,.        
-000330c0: 6875 653a 2073 7472 203d 2022 6573 7469  hue: str = "esti
-000330d0: 6d61 746f 7222 2c0a 2020 2020 2020 2020  mator",.        
-000330e0: 7368 6172 6579 3a20 626f 6f6c 203d 2046  sharey: bool = F
-000330f0: 616c 7365 2c0a 2020 2020 2020 2020 6669  alse,.        fi
-00033100: 675f 6469 723a 204f 7074 696f 6e61 6c5b  g_dir: Optional[
-00033110: 5061 7468 5d20 3d20 4e6f 6e65 2c0a 2020  Path] = None,.  
-00033120: 2020 2020 2020 6669 675f 6e61 6d65 3a20        fig_name: 
-00033130: 7374 7220 3d20 2265 7374 696d 6174 6564  str = "estimated
-00033140: 5f69 6e74 6572 7175 6172 7469 6c65 5f72  _interquartile_r
-00033150: 616e 6765 2e70 6e67 222c 0a20 2020 2029  ange.png",.    )
-00033160: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
-00033170: 2020 2222 2256 6973 7561 6c69 7a65 2074    """Visualize t
-00033180: 6865 2069 6e74 6572 7175 6172 7469 6c65  he interquartile
-00033190: 2072 616e 6765 2065 7374 696d 6174 6564   range estimated
-000331a0: 2062 7920 4f50 4520 6573 7469 6d61 746f   by OPE estimato
-000331b0: 7273 2e0a 0a20 2020 2020 2020 2050 6172  rs...        Par
-000331c0: 616d 6574 6572 730a 2020 2020 2020 2020  ameters.        
-000331d0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-000331e0: 696e 7075 745f 6469 6374 3a20 4f50 4549  input_dict: OPEI
-000331f0: 6e70 7574 4469 6374 206f 7220 4d75 6c74  nputDict or Mult
-00033200: 6970 6c65 496e 7075 7444 6963 740a 2020  ipleInputDict.  
-00033210: 2020 2020 2020 2020 2020 4469 6374 696f            Dictio
-00033220: 6e61 7279 206f 6620 7468 6520 4f50 4520  nary of the OPE 
-00033230: 696e 7075 7473 2066 6f72 2065 6163 6820  inputs for each 
-00033240: 6576 616c 7561 7469 6f6e 2070 6f6c 6963  evaluation polic
-00033250: 792e 0a0a 2020 2020 2020 2020 2020 2020  y...            
-00033260: 2e2e 2063 6f64 652d 626c 6f63 6b3a 3a20  .. code-block:: 
-00033270: 7079 7468 6f6e 0a0a 2020 2020 2020 2020  python..        
-00033280: 2020 2020 2020 2020 6b65 793a 205b 6576          key: [ev
-00033290: 616c 7561 7469 6f6e 5f70 6f6c 6963 795d  aluation_policy]
-000332a0: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
-000332b0: 2020 2020 2020 6576 616c 7561 7469 6f6e        evaluation
-000332c0: 5f70 6f6c 6963 795f 6163 7469 6f6e 2c0a  _policy_action,.
-000332d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000332e0: 2020 2020 6576 616c 7561 7469 6f6e 5f70      evaluation_p
-000332f0: 6f6c 6963 795f 6163 7469 6f6e 5f64 6973  olicy_action_dis
-00033300: 742c 0a20 2020 2020 2020 2020 2020 2020  t,.             
-00033310: 2020 2020 2020 2073 7461 7465 5f61 6374         state_act
-00033320: 696f 6e5f 7661 6c75 655f 7072 6564 6963  ion_value_predic
-00033330: 7469 6f6e 2c0a 2020 2020 2020 2020 2020  tion,.          
-00033340: 2020 2020 2020 2020 2020 696e 6974 6961            initia
-00033350: 6c5f 7374 6174 655f 7661 6c75 655f 7072  l_state_value_pr
-00033360: 6564 6963 7469 6f6e 2c0a 2020 2020 2020  ediction,.      
-00033370: 2020 2020 2020 2020 2020 2020 2020 7374                st
-00033380: 6174 655f 6163 7469 6f6e 5f6d 6172 6769  ate_action_margi
-00033390: 6e61 6c5f 696d 706f 7274 616e 6365 5f77  nal_importance_w
-000333a0: 6569 6768 742c 0a20 2020 2020 2020 2020  eight,.         
-000333b0: 2020 2020 2020 2020 2020 2073 7461 7465             state
-000333c0: 5f6d 6172 6769 6e61 6c5f 696d 706f 7274  _marginal_import
-000333d0: 616e 6365 5f77 6569 6768 742c 0a20 2020  ance_weight,.   
-000333e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000333f0: 206f 6e5f 706f 6c69 6379 5f70 6f6c 6963   on_policy_polic
-00033400: 795f 7661 6c75 652c 0a20 2020 2020 2020  y_value,.       
-00033410: 2020 2020 2020 2020 2020 2020 2067 616d               gam
-00033420: 6d61 2c0a 2020 2020 2020 2020 2020 2020  ma,.            
-00033430: 2020 2020 2020 2020 6265 6861 7669 6f72          behavior
-00033440: 5f70 6f6c 6963 792c 0a20 2020 2020 2020  _policy,.       
-00033450: 2020 2020 2020 2020 2020 2020 2065 7661               eva
-00033460: 6c75 6174 696f 6e5f 706f 6c69 6379 2c0a  luation_policy,.
-00033470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00033480: 2020 2020 6461 7461 7365 745f 6964 2c0a      dataset_id,.
-00033490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000334a0: 5d0a 0a20 2020 2020 2020 2020 2020 202e  ]..            .
-000334b0: 2e20 7365 6561 6c73 6f3a 3a0a 0a20 2020  . seealso::..   
-000334c0: 2020 2020 2020 2020 2020 2020 203a 636c               :cl
-000334d0: 6173 733a 6073 636f 7065 5f72 6c2e 6f70  ass:`scope_rl.op
-000334e0: 652e 696e 7075 742e 4372 6561 7465 4f50  e.input.CreateOP
-000334f0: 4549 6e70 7574 6020 6465 7363 7269 6265  EInput` describe
-00033500: 7320 7468 6520 636f 6d70 6f6e 656e 7473  s the components
-00033510: 206f 6620 3a63 6c61 7373 3a60 696e 7075   of :class:`inpu
-00033520: 745f 6469 6374 602e 0a0a 2020 2020 2020  t_dict`...      
-00033530: 2020 636f 6d70 6172 6564 5f65 7374 696d    compared_estim
-00033540: 6174 6f72 733a 206c 6973 7420 6f66 2073  ators: list of s
-00033550: 7472 2c20 6465 6661 756c 743d 4e6f 6e65  tr, default=None
-00033560: 0a20 2020 2020 2020 2020 2020 204e 616d  .            Nam
-00033570: 6520 6f66 2063 6f6d 7061 7265 6420 6573  e of compared es
-00033580: 7469 6d61 746f 7273 2e0a 2020 2020 2020  timators..      
-00033590: 2020 2020 2020 4966 2060 4e6f 6e65 6020        If `None` 
-000335a0: 6973 2067 6976 656e 2c20 616c 6c20 7468  is given, all th
-000335b0: 6520 6573 7469 6d61 746f 7273 2061 7265  e estimators are
-000335c0: 2063 6f6d 7061 7265 642e 0a0a 2020 2020   compared...    
-000335d0: 2020 2020 6265 6861 7669 6f72 5f70 6f6c      behavior_pol
-000335e0: 6963 795f 6e61 6d65 3a20 7374 722c 2064  icy_name: str, d
-000335f0: 6566 6175 6c74 3d4e 6f6e 650a 2020 2020  efault=None.    
-00033600: 2020 2020 2020 2020 4e61 6d65 206f 6620          Name of 
-00033610: 7468 6520 6265 6861 7669 6f72 2070 6f6c  the behavior pol
-00033620: 6963 792e 0a0a 2020 2020 2020 2020 6461  icy...        da
-00033630: 7461 7365 745f 6964 3a20 696e 742c 2064  taset_id: int, d
-00033640: 6566 6175 6c74 3d4e 6f6e 650a 2020 2020  efault=None.    
-00033650: 2020 2020 2020 2020 4964 206f 6620 7468          Id of th
-00033660: 6520 6c6f 6767 6564 2064 6174 6173 6574  e logged dataset
-00033670: 2e0a 0a20 2020 2020 2020 2061 6c70 6861  ...        alpha
-00033680: 3a20 666c 6f61 742c 2064 6566 6175 6c74  : float, default
-00033690: 3d30 2e30 350a 2020 2020 2020 2020 2020  =0.05.          
-000336a0: 2020 5369 676e 6966 6963 616e 6365 206c    Significance l
-000336b0: 6576 656c 2e20 5468 6520 7661 6c75 6520  evel. The value 
-000336c0: 7368 6f75 6c64 2062 6520 7769 7468 696e  should be within
-000336d0: 2060 5b30 2c20 3129 602e 0a0a 2020 2020   `[0, 1)`...    
-000336e0: 2020 2020 6875 653a 207b 2265 7374 696d      hue: {"estim
-000336f0: 6174 6f72 222c 2022 706f 6c69 6379 227d  ator", "policy"}
-00033700: 2c20 6465 6661 756c 743d 2265 7374 696d  , default="estim
-00033710: 6174 6f72 220a 2020 2020 2020 2020 2020  ator".          
-00033720: 2020 4875 6520 6f66 2074 6865 2070 6c6f    Hue of the plo
-00033730: 742e 0a0a 2020 2020 2020 2020 7368 6172  t...        shar
-00033740: 6579 3a20 626f 6f6c 2c20 6465 6661 756c  ey: bool, defaul
-00033750: 743d 4661 6c73 650a 2020 2020 2020 2020  t=False.        
-00033760: 2020 2020 4966 2060 5472 7565 602c 2074      If `True`, t
-00033770: 6865 2079 2d61 7869 7320 7769 6c6c 2062  he y-axis will b
-00033780: 6520 7368 6172 6564 2061 6d6f 6e67 2064  e shared among d
-00033790: 6966 6665 7265 6e74 2065 7661 6c75 6174  ifferent evaluat
-000337a0: 696f 6e20 706f 6c69 6369 6573 2e0a 0a20  ion policies... 
-000337b0: 2020 2020 2020 2066 6967 5f64 6972 3a20         fig_dir: 
-000337c0: 5061 7468 2c20 6465 6661 756c 743d 4e6f  Path, default=No
-000337d0: 6e65 0a20 2020 2020 2020 2020 2020 2050  ne.            P
-000337e0: 6174 6820 746f 2073 746f 7265 2074 6865  ath to store the
-000337f0: 2062 6172 2066 6967 7572 652e 0a20 2020   bar figure..   
-00033800: 2020 2020 2020 2020 2049 6620 604e 6f6e           If `Non
-00033810: 6560 2069 7320 6769 7665 6e2c 2074 6865  e` is given, the
-00033820: 2066 6967 7572 6520 7769 6c6c 206e 6f74   figure will not
-00033830: 2062 6520 7361 7665 642e 0a0a 2020 2020   be saved...    
-00033840: 2020 2020 6669 675f 6e61 6d65 3a20 7374      fig_name: st
-00033850: 722c 2064 6566 6175 6c74 3d22 6573 7469  r, default="esti
-00033860: 6d61 7465 645f 696e 7465 7271 7561 7274  mated_interquart
-00033870: 696c 655f 7261 6e67 652e 706e 6722 0a20  ile_range.png". 
-00033880: 2020 2020 2020 2020 2020 204e 616d 6520             Name 
-00033890: 6f66 2074 6865 2062 6172 2066 6967 7572  of the bar figur
-000338a0: 652e 0a0a 2020 2020 2020 2020 2222 220a  e...        """.
-000338b0: 2020 2020 2020 2020 636f 6d70 6172 6564          compared
-000338c0: 5f65 7374 696d 6174 6f72 7320 3d20 7365  _estimators = se
-000338d0: 6c66 2e5f 6368 6563 6b5f 636f 6d70 6172  lf._check_compar
-000338e0: 6564 5f65 7374 696d 6174 6f72 7328 636f  ed_estimators(co
-000338f0: 6d70 6172 6564 5f65 7374 696d 6174 6f72  mpared_estimator
-00033900: 7329 0a20 2020 2020 2020 2073 656c 662e  s).        self.
-00033910: 5f63 6865 636b 5f62 6173 6963 5f76 6973  _check_basic_vis
-00033920: 7561 6c69 7a61 7469 6f6e 5f69 6e70 7574  ualization_input
-00033930: 7328 0a20 2020 2020 2020 2020 2020 2068  s(.            h
-00033940: 7565 3d68 7565 2c20 6669 675f 6469 723d  ue=hue, fig_dir=
-00033950: 6669 675f 6469 722c 2066 6967 5f6e 616d  fig_dir, fig_nam
-00033960: 653d 6669 675f 6e61 6d65 0a20 2020 2020  e=fig_name.     
-00033970: 2020 2029 0a0a 2020 2020 2020 2020 6966     )..        if
-00033980: 2073 656c 662e 7573 655f 6d75 6c74 6970   self.use_multip
-00033990: 6c65 5f6c 6f67 6765 645f 6461 7461 7365  le_logged_datase
-000339a0: 743a 0a20 2020 2020 2020 2020 2020 2069  t:.            i
-000339b0: 6620 6265 6861 7669 6f72 5f70 6f6c 6963  f behavior_polic
-000339c0: 795f 6e61 6d65 2069 7320 4e6f 6e65 206f  y_name is None o
-000339d0: 7220 6461 7461 7365 745f 6964 2069 7320  r dataset_id is 
-000339e0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-000339f0: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-00033a00: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
-00033a10: 2020 2020 2020 2020 2020 2020 2262 6568              "beh
-00033a20: 6176 696f 725f 706f 6c69 6379 2061 6e64  avior_policy and
-00033a30: 2064 6174 6173 6574 5f69 6420 6d75 7374   dataset_id must
-00033a40: 2062 6520 7370 6563 6966 6965 6420 7768   be specified wh
-00033a50: 656e 2075 7369 6e67 204d 756c 7469 706c  en using Multipl
-00033a60: 654c 6f67 6765 6444 6174 6173 6574 2e22  eLoggedDataset."
-00033a70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00033a80: 2029 0a20 2020 2020 2020 2020 2020 2069   ).            i
-00033a90: 6620 6973 696e 7374 616e 6365 2869 6e70  f isinstance(inp
-00033aa0: 7574 5f64 6963 742c 204d 756c 7469 706c  ut_dict, Multipl
-00033ab0: 6549 6e70 7574 4469 6374 293a 0a20 2020  eInputDict):.   
-00033ac0: 2020 2020 2020 2020 2020 2020 2069 6e70               inp
-00033ad0: 7574 5f64 6963 7420 3d20 696e 7075 745f  ut_dict = input_
-00033ae0: 6469 6374 2e67 6574 280a 2020 2020 2020  dict.get(.      
-00033af0: 2020 2020 2020 2020 2020 2020 2020 6265                be
-00033b00: 6861 7669 6f72 5f70 6f6c 6963 795f 6e61  havior_policy_na
-00033b10: 6d65 3d62 6568 6176 696f 725f 706f 6c69  me=behavior_poli
-00033b20: 6379 5f6e 616d 652c 2064 6174 6173 6574  cy_name, dataset
-00033b30: 5f69 643d 6461 7461 7365 745f 6964 0a20  _id=dataset_id. 
-00033b40: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-00033b50: 0a20 2020 2020 2020 2063 6865 636b 5f69  .        check_i
-00033b60: 6e70 7574 5f64 6963 7428 696e 7075 745f  nput_dict(input_
-00033b70: 6469 6374 290a 0a20 2020 2020 2020 206d  dict)..        m
-00033b80: 6561 6e5f 6469 6374 203d 2073 656c 662e  ean_dict = self.
-00033b90: 6573 7469 6d61 7465 5f6d 6561 6e28 0a20  estimate_mean(. 
-00033ba0: 2020 2020 2020 2020 2020 2069 6e70 7574             input
-00033bb0: 5f64 6963 742c 0a20 2020 2020 2020 2020  _dict,.         
-00033bc0: 2020 2063 6f6d 7061 7265 645f 6573 7469     compared_esti
-00033bd0: 6d61 746f 7273 3d63 6f6d 7061 7265 645f  mators=compared_
-00033be0: 6573 7469 6d61 746f 7273 2c0a 2020 2020  estimators,.    
-00033bf0: 2020 2020 2020 2020 6265 6861 7669 6f72          behavior
-00033c00: 5f70 6f6c 6963 795f 6e61 6d65 3d62 6568  _policy_name=beh
-00033c10: 6176 696f 725f 706f 6c69 6379 5f6e 616d  avior_policy_nam
-00033c20: 652c 0a20 2020 2020 2020 2020 2020 2064  e,.            d
-00033c30: 6174 6173 6574 5f69 643d 6461 7461 7365  ataset_id=datase
-00033c40: 745f 6964 2c0a 2020 2020 2020 2020 290a  t_id,.        ).
-00033c50: 2020 2020 2020 2020 696e 7465 7271 7561          interqua
-00033c60: 7274 696c 655f 6469 6374 203d 2073 656c  rtile_dict = sel
-00033c70: 662e 6573 7469 6d61 7465 5f69 6e74 6572  f.estimate_inter
-00033c80: 7175 6172 7469 6c65 5f72 616e 6765 280a  quartile_range(.
-00033c90: 2020 2020 2020 2020 2020 2020 696e 7075              inpu
-00033ca0: 745f 6469 6374 2c0a 2020 2020 2020 2020  t_dict,.        
-00033cb0: 2020 2020 636f 6d70 6172 6564 5f65 7374      compared_est
-00033cc0: 696d 6174 6f72 733d 636f 6d70 6172 6564  imators=compared
-00033cd0: 5f65 7374 696d 6174 6f72 732c 0a20 2020  _estimators,.   
-00033ce0: 2020 2020 2020 2020 2062 6568 6176 696f           behavio
-00033cf0: 725f 706f 6c69 6379 5f6e 616d 653d 6265  r_policy_name=be
-00033d00: 6861 7669 6f72 5f70 6f6c 6963 795f 6e61  havior_policy_na
-00033d10: 6d65 2c0a 2020 2020 2020 2020 2020 2020  me,.            
-00033d20: 6461 7461 7365 745f 6964 3d64 6174 6173  dataset_id=datas
-00033d30: 6574 5f69 642c 0a20 2020 2020 2020 2020  et_id,.         
-00033d40: 2020 2061 6c70 6861 3d61 6c70 6861 2c0a     alpha=alpha,.
-00033d50: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
-00033d60: 2020 2070 6c74 2e73 7479 6c65 2e75 7365     plt.style.use
-00033d70: 2822 6767 706c 6f74 2229 0a20 2020 2020  ("ggplot").     
-00033d80: 2020 2063 6f6c 6f72 203d 2070 6c74 2e72     color = plt.r
-00033d90: 6350 6172 616d 735b 2261 7865 732e 7072  cParams["axes.pr
-00033da0: 6f70 5f63 7963 6c65 225d 2e62 795f 6b65  op_cycle"].by_ke
-00033db0: 7928 295b 2263 6f6c 6f72 225d 0a20 2020  y()["color"].   
-00033dc0: 2020 2020 206e 5f63 6f6c 6f72 7320 3d20       n_colors = 
-00033dd0: 6c65 6e28 636f 6c6f 7229 0a0a 2020 2020  len(color)..    
-00033de0: 2020 2020 7669 7375 616c 697a 655f 6f6e      visualize_on
-00033df0: 5f70 6f6c 6963 7920 3d20 5472 7565 0a20  _policy = True. 
-00033e00: 2020 2020 2020 2066 6f72 2065 7661 6c5f         for eval_
-00033e10: 706f 6c69 6379 2069 6e20 696e 7075 745f  policy in input_
-00033e20: 6469 6374 2e6b 6579 7328 293a 0a20 2020  dict.keys():.   
-00033e30: 2020 2020 2020 2020 2069 6620 696e 7075           if inpu
-00033e40: 745f 6469 6374 5b65 7661 6c5f 706f 6c69  t_dict[eval_poli
-00033e50: 6379 5d5b 226f 6e5f 706f 6c69 6379 5f70  cy]["on_policy_p
-00033e60: 6f6c 6963 795f 7661 6c75 6522 5d20 6973  olicy_value"] is
-00033e70: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-00033e80: 2020 2020 2020 2076 6973 7561 6c69 7a65         visualize
-00033e90: 5f6f 6e5f 706f 6c69 6379 203d 2046 616c  _on_policy = Fal
-00033ea0: 7365 0a0a 2020 2020 2020 2020 6e5f 6573  se..        n_es
-00033eb0: 7469 6d61 746f 7273 203d 2028 0a20 2020  timators = (.   
-00033ec0: 2020 2020 2020 2020 206c 656e 2863 6f6d           len(com
-00033ed0: 7061 7265 645f 6573 7469 6d61 746f 7273  pared_estimators
-00033ee0: 2920 2b20 310a 2020 2020 2020 2020 2020  ) + 1.          
-00033ef0: 2020 6966 2076 6973 7561 6c69 7a65 5f6f    if visualize_o
-00033f00: 6e5f 706f 6c69 6379 0a20 2020 2020 2020  n_policy.       
-00033f10: 2020 2020 2065 6c73 6520 6c65 6e28 636f       else len(co
-00033f20: 6d70 6172 6564 5f65 7374 696d 6174 6f72  mpared_estimator
-00033f30: 7329 0a20 2020 2020 2020 2029 0a20 2020  s).        ).   
-00033f40: 2020 2020 2069 6620 7669 7375 616c 697a       if visualiz
-00033f50: 655f 6f6e 5f70 6f6c 6963 793a 0a20 2020  e_on_policy:.   
-00033f60: 2020 2020 2020 2020 2063 6f6d 7061 7265           compare
-00033f70: 645f 6573 7469 6d61 746f 7273 2e61 7070  d_estimators.app
-00033f80: 656e 6428 226f 6e5f 706f 6c69 6379 2229  end("on_policy")
-00033f90: 0a0a 2020 2020 2020 2020 6e5f 706f 6c69  ..        n_poli
-00033fa0: 6369 6573 203d 206c 656e 2869 6e70 7574  cies = len(input
-00033fb0: 5f64 6963 7429 0a0a 2020 2020 2020 2020  _dict)..        
-00033fc0: 6966 2068 7565 203d 3d20 2265 7374 696d  if hue == "estim
-00033fd0: 6174 6f72 223a 0a20 2020 2020 2020 2020  ator":.         
-00033fe0: 2020 2066 6967 203d 2070 6c74 2e66 6967     fig = plt.fig
-00033ff0: 7572 6528 6669 6773 697a 653d 2832 202a  ure(figsize=(2 *
-00034000: 206e 5f65 7374 696d 6174 6f72 732c 2034   n_estimators, 4
-00034010: 202a 206e 5f70 6f6c 6963 6965 7329 290a   * n_policies)).
-00034020: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
-00034030: 2069 2c20 6576 616c 5f70 6f6c 6963 7920   i, eval_policy 
-00034040: 696e 2065 6e75 6d65 7261 7465 2869 6e70  in enumerate(inp
-00034050: 7574 5f64 6963 742e 6b65 7973 2829 293a  ut_dict.keys()):
-00034060: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00034070: 2069 6620 6920 3d3d 2030 3a0a 2020 2020   if i == 0:.    
-00034080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034090: 6178 203d 2061 7830 203d 2066 6967 2e61  ax = ax0 = fig.a
-000340a0: 6464 5f73 7562 706c 6f74 286e 5f70 6f6c  dd_subplot(n_pol
-000340b0: 6963 6965 732c 2031 2c20 6920 2b20 3129  icies, 1, i + 1)
-000340c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000340d0: 2065 6c69 6620 7368 6172 6579 3a0a 2020   elif sharey:.  
-000340e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000340f0: 2020 6178 203d 2066 6967 2e61 6464 5f73    ax = fig.add_s
-00034100: 7562 706c 6f74 286e 5f70 6f6c 6963 6965  ubplot(n_policie
-00034110: 732c 2031 2c20 6920 2b20 312c 2073 6861  s, 1, i + 1, sha
-00034120: 7265 793d 6178 3029 0a20 2020 2020 2020  rey=ax0).       
-00034130: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-00034140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034150: 2020 2061 7820 3d20 6669 672e 6164 645f     ax = fig.add_
-00034160: 7375 6270 6c6f 7428 6e5f 706f 6c69 6369  subplot(n_polici
-00034170: 6573 2c20 312c 2069 202b 2031 290a 0a20  es, 1, i + 1).. 
-00034180: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-00034190: 6561 6e20 3d20 6e70 2e7a 6572 6f73 286e  ean = np.zeros(n
-000341a0: 5f65 7374 696d 6174 6f72 7329 0a20 2020  _estimators).   
-000341b0: 2020 2020 2020 2020 2020 2020 206d 6564               med
-000341c0: 6961 6e20 3d20 6e70 2e7a 6572 6f73 286e  ian = np.zeros(n
-000341d0: 5f65 7374 696d 6174 6f72 7329 0a20 2020  _estimators).   
-000341e0: 2020 2020 2020 2020 2020 2020 2075 7070               upp
-000341f0: 6572 203d 206e 702e 7a65 726f 7328 6e5f  er = np.zeros(n_
-00034200: 6573 7469 6d61 746f 7273 290a 2020 2020  estimators).    
-00034210: 2020 2020 2020 2020 2020 2020 6c6f 7765              lowe
-00034220: 7220 3d20 6e70 2e7a 6572 6f73 286e 5f65  r = np.zeros(n_e
-00034230: 7374 696d 6174 6f72 7329 0a0a 2020 2020  stimators)..    
-00034240: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00034250: 6a2c 2065 7374 696d 6174 6f72 2069 6e20  j, estimator in 
-00034260: 656e 756d 6572 6174 6528 636f 6d70 6172  enumerate(compar
-00034270: 6564 5f65 7374 696d 6174 6f72 7329 3a0a  ed_estimators):.
+00032c80: 2020 2020 6178 6573 5b69 202f 2f20 6e5f      axes[i // n_
+00032c90: 636f 6c73 2c20 6920 2520 6e5f 636f 6c73  cols, i % n_cols
+00032ca0: 5d2e 7365 745f 796c 6162 656c 2822 4356  ].set_ylabel("CV
+00032cb0: 6152 2229 0a20 2020 2020 2020 2020 2020  aR").           
+00032cc0: 2020 2020 2020 2020 2069 6620 6c65 6765           if lege
+00032cd0: 6e64 3a0a 2020 2020 2020 2020 2020 2020  nd:.            
+00032ce0: 2020 2020 2020 2020 2020 2020 6178 6573              axes
+00032cf0: 5b69 202f 2f20 6e5f 636f 6c73 2c20 6920  [i // n_cols, i 
+00032d00: 2520 6e5f 636f 6c73 5d2e 6c65 6765 6e64  % n_cols].legend
+00032d10: 2829 0a0a 2020 2020 2020 2020 2020 2020  ()..            
+00032d20: 6966 206c 6567 656e 643a 0a20 2020 2020  if legend:.     
+00032d30: 2020 2020 2020 2020 2020 2068 616e 646c             handl
+00032d40: 6573 2c20 6c61 6265 6c73 203d 2061 7865  es, labels = axe
+00032d50: 735b 302c 2030 5d2e 6765 745f 6c65 6765  s[0, 0].get_lege
+00032d60: 6e64 5f68 616e 646c 6573 5f6c 6162 656c  nd_handles_label
+00032d70: 7328 290a 2020 2020 2020 2020 2020 2020  s().            
+00032d80: 2020 2020 2320 6e5f 636f 6c73 2073 686f      # n_cols sho
+00032d90: 7773 2065 7272 0a20 2020 2020 2020 2020  ws err.         
+00032da0: 2020 2020 2020 2023 2066 6967 2e6c 6567         # fig.leg
+00032db0: 656e 6428 6861 6e64 6c65 732c 206c 6162  end(handles, lab
+00032dc0: 656c 732c 206c 6f63 3d27 7570 7065 7220  els, loc='upper 
+00032dd0: 6365 6e74 6572 272c 2062 626f 785f 746f  center', bbox_to
+00032de0: 5f61 6e63 686f 723d 2830 2e35 2c20 2d30  _anchor=(0.5, -0
+00032df0: 2e31 292c 206e 5f63 6f6c 733d 6d69 6e28  .1), n_cols=min(
+00032e00: 6c65 6e28 6c61 6265 6c73 292c 2036 2929  len(labels), 6))
+00032e10: 0a0a 2020 2020 2020 2020 6669 672e 7375  ..        fig.su
+00032e20: 6270 6c6f 7473 5f61 646a 7573 7428 6873  bplots_adjust(hs
+00032e30: 7061 6365 3d30 2e33 352c 2077 7370 6163  pace=0.35, wspac
+00032e40: 653d 302e 3229 0a20 2020 2020 2020 2070  e=0.2).        p
+00032e50: 6c74 2e73 686f 7728 290a 0a20 2020 2020  lt.show()..     
+00032e60: 2020 2069 6620 6669 675f 6469 723a 0a20     if fig_dir:. 
+00032e70: 2020 2020 2020 2020 2020 2066 6967 2e73             fig.s
+00032e80: 6176 6566 6967 2873 7472 2866 6967 5f64  avefig(str(fig_d
+00032e90: 6972 202f 2066 6967 5f6e 616d 6529 2c20  ir / fig_name), 
+00032ea0: 6470 693d 3330 302c 2062 626f 785f 696e  dpi=300, bbox_in
+00032eb0: 6368 6573 3d22 7469 6768 7422 290a 0a20  ches="tight").. 
+00032ec0: 2020 2064 6566 2076 6973 7561 6c69 7a65     def visualize
+00032ed0: 5f69 6e74 6572 7175 6172 7469 6c65 5f72  _interquartile_r
+00032ee0: 616e 6765 280a 2020 2020 2020 2020 7365  ange(.        se
+00032ef0: 6c66 2c0a 2020 2020 2020 2020 696e 7075  lf,.        inpu
+00032f00: 745f 6469 6374 3a20 556e 696f 6e5b 4f50  t_dict: Union[OP
+00032f10: 4549 6e70 7574 4469 6374 2c20 4d75 6c74  EInputDict, Mult
+00032f20: 6970 6c65 496e 7075 7444 6963 745d 2c0a  ipleInputDict],.
+00032f30: 2020 2020 2020 2020 636f 6d70 6172 6564          compared
+00032f40: 5f65 7374 696d 6174 6f72 733a 204f 7074  _estimators: Opt
+00032f50: 696f 6e61 6c5b 4c69 7374 5b73 7472 5d5d  ional[List[str]]
+00032f60: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
+00032f70: 2062 6568 6176 696f 725f 706f 6c69 6379   behavior_policy
+00032f80: 5f6e 616d 653a 204f 7074 696f 6e61 6c5b  _name: Optional[
+00032f90: 7374 725d 203d 204e 6f6e 652c 0a20 2020  str] = None,.   
+00032fa0: 2020 2020 2064 6174 6173 6574 5f69 643a       dataset_id:
+00032fb0: 204f 7074 696f 6e61 6c5b 696e 745d 203d   Optional[int] =
+00032fc0: 204e 6f6e 652c 0a20 2020 2020 2020 2061   None,.        a
+00032fd0: 6c70 6861 3a20 666c 6f61 7420 3d20 302e  lpha: float = 0.
+00032fe0: 3035 2c0a 2020 2020 2020 2020 6875 653a  05,.        hue:
+00032ff0: 2073 7472 203d 2022 6573 7469 6d61 746f   str = "estimato
+00033000: 7222 2c0a 2020 2020 2020 2020 7368 6172  r",.        shar
+00033010: 6579 3a20 626f 6f6c 203d 2046 616c 7365  ey: bool = False
+00033020: 2c0a 2020 2020 2020 2020 6669 675f 6469  ,.        fig_di
+00033030: 723a 204f 7074 696f 6e61 6c5b 5061 7468  r: Optional[Path
+00033040: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
+00033050: 2020 6669 675f 6e61 6d65 3a20 7374 7220    fig_name: str 
+00033060: 3d20 2265 7374 696d 6174 6564 5f69 6e74  = "estimated_int
+00033070: 6572 7175 6172 7469 6c65 5f72 616e 6765  erquartile_range
+00033080: 2e70 6e67 222c 0a20 2020 2029 202d 3e20  .png",.    ) -> 
+00033090: 4e6f 6e65 3a0a 2020 2020 2020 2020 2222  None:.        ""
+000330a0: 2256 6973 7561 6c69 7a65 2074 6865 2069  "Visualize the i
+000330b0: 6e74 6572 7175 6172 7469 6c65 2072 616e  nterquartile ran
+000330c0: 6765 2065 7374 696d 6174 6564 2062 7920  ge estimated by 
+000330d0: 4f50 4520 6573 7469 6d61 746f 7273 2e0a  OPE estimators..
+000330e0: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
+000330f0: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
+00033100: 2d2d 2d0a 2020 2020 2020 2020 696e 7075  ---.        inpu
+00033110: 745f 6469 6374 3a20 4f50 4549 6e70 7574  t_dict: OPEInput
+00033120: 4469 6374 206f 7220 4d75 6c74 6970 6c65  Dict or Multiple
+00033130: 496e 7075 7444 6963 740a 2020 2020 2020  InputDict.      
+00033140: 2020 2020 2020 4469 6374 696f 6e61 7279        Dictionary
+00033150: 206f 6620 7468 6520 4f50 4520 696e 7075   of the OPE inpu
+00033160: 7473 2066 6f72 2065 6163 6820 6576 616c  ts for each eval
+00033170: 7561 7469 6f6e 2070 6f6c 6963 792e 0a0a  uation policy...
+00033180: 2020 2020 2020 2020 2020 2020 2e2e 2063              .. c
+00033190: 6f64 652d 626c 6f63 6b3a 3a20 7079 7468  ode-block:: pyth
+000331a0: 6f6e 0a0a 2020 2020 2020 2020 2020 2020  on..            
+000331b0: 2020 2020 6b65 793a 205b 6576 616c 7561      key: [evalua
+000331c0: 7469 6f6e 5f70 6f6c 6963 795d 5b0a 2020  tion_policy][.  
+000331d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000331e0: 2020 6576 616c 7561 7469 6f6e 5f70 6f6c    evaluation_pol
+000331f0: 6963 795f 6163 7469 6f6e 2c0a 2020 2020  icy_action,.    
+00033200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033210: 6576 616c 7561 7469 6f6e 5f70 6f6c 6963  evaluation_polic
+00033220: 795f 6163 7469 6f6e 5f64 6973 742c 0a20  y_action_dist,. 
+00033230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033240: 2020 2073 7461 7465 5f61 6374 696f 6e5f     state_action_
+00033250: 7661 6c75 655f 7072 6564 6963 7469 6f6e  value_prediction
+00033260: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00033270: 2020 2020 2020 696e 6974 6961 6c5f 7374        initial_st
+00033280: 6174 655f 7661 6c75 655f 7072 6564 6963  ate_value_predic
+00033290: 7469 6f6e 2c0a 2020 2020 2020 2020 2020  tion,.          
+000332a0: 2020 2020 2020 2020 2020 7374 6174 655f            state_
+000332b0: 6163 7469 6f6e 5f6d 6172 6769 6e61 6c5f  action_marginal_
+000332c0: 696d 706f 7274 616e 6365 5f77 6569 6768  importance_weigh
+000332d0: 742c 0a20 2020 2020 2020 2020 2020 2020  t,.             
+000332e0: 2020 2020 2020 2073 7461 7465 5f6d 6172         state_mar
+000332f0: 6769 6e61 6c5f 696d 706f 7274 616e 6365  ginal_importance
+00033300: 5f77 6569 6768 742c 0a20 2020 2020 2020  _weight,.       
+00033310: 2020 2020 2020 2020 2020 2020 206f 6e5f               on_
+00033320: 706f 6c69 6379 5f70 6f6c 6963 795f 7661  policy_policy_va
+00033330: 6c75 652c 0a20 2020 2020 2020 2020 2020  lue,.           
+00033340: 2020 2020 2020 2020 2067 616d 6d61 2c0a           gamma,.
+00033350: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00033360: 2020 2020 6265 6861 7669 6f72 5f70 6f6c      behavior_pol
+00033370: 6963 792c 0a20 2020 2020 2020 2020 2020  icy,.           
+00033380: 2020 2020 2020 2020 2065 7661 6c75 6174           evaluat
+00033390: 696f 6e5f 706f 6c69 6379 2c0a 2020 2020  ion_policy,.    
+000333a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000333b0: 6461 7461 7365 745f 6964 2c0a 2020 2020  dataset_id,.    
+000333c0: 2020 2020 2020 2020 2020 2020 5d0a 0a20              ].. 
+000333d0: 2020 2020 2020 2020 2020 202e 2e20 7365             .. se
+000333e0: 6561 6c73 6f3a 3a0a 0a20 2020 2020 2020  ealso::..       
+000333f0: 2020 2020 2020 2020 203a 636c 6173 733a           :class:
+00033400: 6073 636f 7065 5f72 6c2e 6f70 652e 696e  `scope_rl.ope.in
+00033410: 7075 742e 4372 6561 7465 4f50 4549 6e70  put.CreateOPEInp
+00033420: 7574 6020 6465 7363 7269 6265 7320 7468  ut` describes th
+00033430: 6520 636f 6d70 6f6e 656e 7473 206f 6620  e components of 
+00033440: 3a63 6c61 7373 3a60 696e 7075 745f 6469  :class:`input_di
+00033450: 6374 602e 0a0a 2020 2020 2020 2020 636f  ct`...        co
+00033460: 6d70 6172 6564 5f65 7374 696d 6174 6f72  mpared_estimator
+00033470: 733a 206c 6973 7420 6f66 2073 7472 2c20  s: list of str, 
+00033480: 6465 6661 756c 743d 4e6f 6e65 0a20 2020  default=None.   
+00033490: 2020 2020 2020 2020 204e 616d 6520 6f66           Name of
+000334a0: 2063 6f6d 7061 7265 6420 6573 7469 6d61   compared estima
+000334b0: 746f 7273 2e0a 2020 2020 2020 2020 2020  tors..          
+000334c0: 2020 4966 2060 4e6f 6e65 6020 6973 2067    If `None` is g
+000334d0: 6976 656e 2c20 616c 6c20 7468 6520 6573  iven, all the es
+000334e0: 7469 6d61 746f 7273 2061 7265 2063 6f6d  timators are com
+000334f0: 7061 7265 642e 0a0a 2020 2020 2020 2020  pared...        
+00033500: 6265 6861 7669 6f72 5f70 6f6c 6963 795f  behavior_policy_
+00033510: 6e61 6d65 3a20 7374 722c 2064 6566 6175  name: str, defau
+00033520: 6c74 3d4e 6f6e 650a 2020 2020 2020 2020  lt=None.        
+00033530: 2020 2020 4e61 6d65 206f 6620 7468 6520      Name of the 
+00033540: 6265 6861 7669 6f72 2070 6f6c 6963 792e  behavior policy.
+00033550: 0a0a 2020 2020 2020 2020 6461 7461 7365  ..        datase
+00033560: 745f 6964 3a20 696e 742c 2064 6566 6175  t_id: int, defau
+00033570: 6c74 3d4e 6f6e 650a 2020 2020 2020 2020  lt=None.        
+00033580: 2020 2020 4964 206f 6620 7468 6520 6c6f      Id of the lo
+00033590: 6767 6564 2064 6174 6173 6574 2e0a 0a20  gged dataset... 
+000335a0: 2020 2020 2020 2061 6c70 6861 3a20 666c         alpha: fl
+000335b0: 6f61 742c 2064 6566 6175 6c74 3d30 2e30  oat, default=0.0
+000335c0: 350a 2020 2020 2020 2020 2020 2020 5369  5.            Si
+000335d0: 676e 6966 6963 616e 6365 206c 6576 656c  gnificance level
+000335e0: 2e20 5468 6520 7661 6c75 6520 7368 6f75  . The value shou
+000335f0: 6c64 2062 6520 7769 7468 696e 2060 5b30  ld be within `[0
+00033600: 2c20 3129 602e 0a0a 2020 2020 2020 2020  , 1)`...        
+00033610: 6875 653a 207b 2265 7374 696d 6174 6f72  hue: {"estimator
+00033620: 222c 2022 706f 6c69 6379 227d 2c20 6465  ", "policy"}, de
+00033630: 6661 756c 743d 2265 7374 696d 6174 6f72  fault="estimator
+00033640: 220a 2020 2020 2020 2020 2020 2020 4875  ".            Hu
+00033650: 6520 6f66 2074 6865 2070 6c6f 742e 0a0a  e of the plot...
+00033660: 2020 2020 2020 2020 7368 6172 6579 3a20          sharey: 
+00033670: 626f 6f6c 2c20 6465 6661 756c 743d 4661  bool, default=Fa
+00033680: 6c73 650a 2020 2020 2020 2020 2020 2020  lse.            
+00033690: 4966 2060 5472 7565 602c 2074 6865 2079  If `True`, the y
+000336a0: 2d61 7869 7320 7769 6c6c 2062 6520 7368  -axis will be sh
+000336b0: 6172 6564 2061 6d6f 6e67 2064 6966 6665  ared among diffe
+000336c0: 7265 6e74 2065 7661 6c75 6174 696f 6e20  rent evaluation 
+000336d0: 706f 6c69 6369 6573 2e0a 0a20 2020 2020  policies...     
+000336e0: 2020 2066 6967 5f64 6972 3a20 5061 7468     fig_dir: Path
+000336f0: 2c20 6465 6661 756c 743d 4e6f 6e65 0a20  , default=None. 
+00033700: 2020 2020 2020 2020 2020 2050 6174 6820             Path 
+00033710: 746f 2073 746f 7265 2074 6865 2062 6172  to store the bar
+00033720: 2066 6967 7572 652e 0a20 2020 2020 2020   figure..       
+00033730: 2020 2020 2049 6620 604e 6f6e 6560 2069       If `None` i
+00033740: 7320 6769 7665 6e2c 2074 6865 2066 6967  s given, the fig
+00033750: 7572 6520 7769 6c6c 206e 6f74 2062 6520  ure will not be 
+00033760: 7361 7665 642e 0a0a 2020 2020 2020 2020  saved...        
+00033770: 6669 675f 6e61 6d65 3a20 7374 722c 2064  fig_name: str, d
+00033780: 6566 6175 6c74 3d22 6573 7469 6d61 7465  efault="estimate
+00033790: 645f 696e 7465 7271 7561 7274 696c 655f  d_interquartile_
+000337a0: 7261 6e67 652e 706e 6722 0a20 2020 2020  range.png".     
+000337b0: 2020 2020 2020 204e 616d 6520 6f66 2074         Name of t
+000337c0: 6865 2062 6172 2066 6967 7572 652e 0a0a  he bar figure...
+000337d0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+000337e0: 2020 2020 636f 6d70 6172 6564 5f65 7374      compared_est
+000337f0: 696d 6174 6f72 7320 3d20 7365 6c66 2e5f  imators = self._
+00033800: 6368 6563 6b5f 636f 6d70 6172 6564 5f65  check_compared_e
+00033810: 7374 696d 6174 6f72 7328 636f 6d70 6172  stimators(compar
+00033820: 6564 5f65 7374 696d 6174 6f72 7329 0a20  ed_estimators). 
+00033830: 2020 2020 2020 2073 656c 662e 5f63 6865         self._che
+00033840: 636b 5f62 6173 6963 5f76 6973 7561 6c69  ck_basic_visuali
+00033850: 7a61 7469 6f6e 5f69 6e70 7574 7328 0a20  zation_inputs(. 
+00033860: 2020 2020 2020 2020 2020 2068 7565 3d68             hue=h
+00033870: 7565 2c20 6669 675f 6469 723d 6669 675f  ue, fig_dir=fig_
+00033880: 6469 722c 2066 6967 5f6e 616d 653d 6669  dir, fig_name=fi
+00033890: 675f 6e61 6d65 0a20 2020 2020 2020 2029  g_name.        )
+000338a0: 0a0a 2020 2020 2020 2020 6966 2073 656c  ..        if sel
+000338b0: 662e 7573 655f 6d75 6c74 6970 6c65 5f6c  f.use_multiple_l
+000338c0: 6f67 6765 645f 6461 7461 7365 743a 0a20  ogged_dataset:. 
+000338d0: 2020 2020 2020 2020 2020 2069 6620 6265             if be
+000338e0: 6861 7669 6f72 5f70 6f6c 6963 795f 6e61  havior_policy_na
+000338f0: 6d65 2069 7320 4e6f 6e65 206f 7220 6461  me is None or da
+00033900: 7461 7365 745f 6964 2069 7320 4e6f 6e65  taset_id is None
+00033910: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00033920: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+00033930: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
+00033940: 2020 2020 2020 2020 2262 6568 6176 696f          "behavio
+00033950: 725f 706f 6c69 6379 2061 6e64 2064 6174  r_policy and dat
+00033960: 6173 6574 5f69 6420 6d75 7374 2062 6520  aset_id must be 
+00033970: 7370 6563 6966 6965 6420 7768 656e 2075  specified when u
+00033980: 7369 6e67 204d 756c 7469 706c 654c 6f67  sing MultipleLog
+00033990: 6765 6444 6174 6173 6574 2e22 0a20 2020  gedDataset.".   
+000339a0: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
+000339b0: 2020 2020 2020 2020 2020 2069 6620 6973             if is
+000339c0: 696e 7374 616e 6365 2869 6e70 7574 5f64  instance(input_d
+000339d0: 6963 742c 204d 756c 7469 706c 6549 6e70  ict, MultipleInp
+000339e0: 7574 4469 6374 293a 0a20 2020 2020 2020  utDict):.       
+000339f0: 2020 2020 2020 2020 2069 6e70 7574 5f64           input_d
+00033a00: 6963 7420 3d20 696e 7075 745f 6469 6374  ict = input_dict
+00033a10: 2e67 6574 280a 2020 2020 2020 2020 2020  .get(.          
+00033a20: 2020 2020 2020 2020 2020 6265 6861 7669            behavi
+00033a30: 6f72 5f70 6f6c 6963 795f 6e61 6d65 3d62  or_policy_name=b
+00033a40: 6568 6176 696f 725f 706f 6c69 6379 5f6e  ehavior_policy_n
+00033a50: 616d 652c 2064 6174 6173 6574 5f69 643d  ame, dataset_id=
+00033a60: 6461 7461 7365 745f 6964 0a20 2020 2020  dataset_id.     
+00033a70: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00033a80: 2020 2020 2063 6865 636b 5f69 6e70 7574       check_input
+00033a90: 5f64 6963 7428 696e 7075 745f 6469 6374  _dict(input_dict
+00033aa0: 290a 0a20 2020 2020 2020 206d 6561 6e5f  )..        mean_
+00033ab0: 6469 6374 203d 2073 656c 662e 6573 7469  dict = self.esti
+00033ac0: 6d61 7465 5f6d 6561 6e28 0a20 2020 2020  mate_mean(.     
+00033ad0: 2020 2020 2020 2069 6e70 7574 5f64 6963         input_dic
+00033ae0: 742c 0a20 2020 2020 2020 2020 2020 2063  t,.            c
+00033af0: 6f6d 7061 7265 645f 6573 7469 6d61 746f  ompared_estimato
+00033b00: 7273 3d63 6f6d 7061 7265 645f 6573 7469  rs=compared_esti
+00033b10: 6d61 746f 7273 2c0a 2020 2020 2020 2020  mators,.        
+00033b20: 2020 2020 6265 6861 7669 6f72 5f70 6f6c      behavior_pol
+00033b30: 6963 795f 6e61 6d65 3d62 6568 6176 696f  icy_name=behavio
+00033b40: 725f 706f 6c69 6379 5f6e 616d 652c 0a20  r_policy_name,. 
+00033b50: 2020 2020 2020 2020 2020 2064 6174 6173             datas
+00033b60: 6574 5f69 643d 6461 7461 7365 745f 6964  et_id=dataset_id
+00033b70: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
+00033b80: 2020 2020 696e 7465 7271 7561 7274 696c      interquartil
+00033b90: 655f 6469 6374 203d 2073 656c 662e 6573  e_dict = self.es
+00033ba0: 7469 6d61 7465 5f69 6e74 6572 7175 6172  timate_interquar
+00033bb0: 7469 6c65 5f72 616e 6765 280a 2020 2020  tile_range(.    
+00033bc0: 2020 2020 2020 2020 696e 7075 745f 6469          input_di
+00033bd0: 6374 2c0a 2020 2020 2020 2020 2020 2020  ct,.            
+00033be0: 636f 6d70 6172 6564 5f65 7374 696d 6174  compared_estimat
+00033bf0: 6f72 733d 636f 6d70 6172 6564 5f65 7374  ors=compared_est
+00033c00: 696d 6174 6f72 732c 0a20 2020 2020 2020  imators,.       
+00033c10: 2020 2020 2062 6568 6176 696f 725f 706f       behavior_po
+00033c20: 6c69 6379 5f6e 616d 653d 6265 6861 7669  licy_name=behavi
+00033c30: 6f72 5f70 6f6c 6963 795f 6e61 6d65 2c0a  or_policy_name,.
+00033c40: 2020 2020 2020 2020 2020 2020 6461 7461              data
+00033c50: 7365 745f 6964 3d64 6174 6173 6574 5f69  set_id=dataset_i
+00033c60: 642c 0a20 2020 2020 2020 2020 2020 2061  d,.            a
+00033c70: 6c70 6861 3d61 6c70 6861 2c0a 2020 2020  lpha=alpha,.    
+00033c80: 2020 2020 290a 0a20 2020 2020 2020 2070      )..        p
+00033c90: 6c74 2e73 7479 6c65 2e75 7365 2822 6767  lt.style.use("gg
+00033ca0: 706c 6f74 2229 0a20 2020 2020 2020 2063  plot").        c
+00033cb0: 6f6c 6f72 203d 2070 6c74 2e72 6350 6172  olor = plt.rcPar
+00033cc0: 616d 735b 2261 7865 732e 7072 6f70 5f63  ams["axes.prop_c
+00033cd0: 7963 6c65 225d 2e62 795f 6b65 7928 295b  ycle"].by_key()[
+00033ce0: 2263 6f6c 6f72 225d 0a20 2020 2020 2020  "color"].       
+00033cf0: 206e 5f63 6f6c 6f72 7320 3d20 6c65 6e28   n_colors = len(
+00033d00: 636f 6c6f 7229 0a0a 2020 2020 2020 2020  color)..        
+00033d10: 7669 7375 616c 697a 655f 6f6e 5f70 6f6c  visualize_on_pol
+00033d20: 6963 7920 3d20 5472 7565 0a20 2020 2020  icy = True.     
+00033d30: 2020 2066 6f72 2065 7661 6c5f 706f 6c69     for eval_poli
+00033d40: 6379 2069 6e20 696e 7075 745f 6469 6374  cy in input_dict
+00033d50: 2e6b 6579 7328 293a 0a20 2020 2020 2020  .keys():.       
+00033d60: 2020 2020 2069 6620 696e 7075 745f 6469       if input_di
+00033d70: 6374 5b65 7661 6c5f 706f 6c69 6379 5d5b  ct[eval_policy][
+00033d80: 226f 6e5f 706f 6c69 6379 5f70 6f6c 6963  "on_policy_polic
+00033d90: 795f 7661 6c75 6522 5d20 6973 204e 6f6e  y_value"] is Non
+00033da0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00033db0: 2020 2076 6973 7561 6c69 7a65 5f6f 6e5f     visualize_on_
+00033dc0: 706f 6c69 6379 203d 2046 616c 7365 0a0a  policy = False..
+00033dd0: 2020 2020 2020 2020 6e5f 6573 7469 6d61          n_estima
+00033de0: 746f 7273 203d 2028 0a20 2020 2020 2020  tors = (.       
+00033df0: 2020 2020 206c 656e 2863 6f6d 7061 7265       len(compare
+00033e00: 645f 6573 7469 6d61 746f 7273 2920 2b20  d_estimators) + 
+00033e10: 310a 2020 2020 2020 2020 2020 2020 6966  1.            if
+00033e20: 2076 6973 7561 6c69 7a65 5f6f 6e5f 706f   visualize_on_po
+00033e30: 6c69 6379 0a20 2020 2020 2020 2020 2020  licy.           
+00033e40: 2065 6c73 6520 6c65 6e28 636f 6d70 6172   else len(compar
+00033e50: 6564 5f65 7374 696d 6174 6f72 7329 0a20  ed_estimators). 
+00033e60: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00033e70: 2069 6620 7669 7375 616c 697a 655f 6f6e   if visualize_on
+00033e80: 5f70 6f6c 6963 793a 0a20 2020 2020 2020  _policy:.       
+00033e90: 2020 2020 2063 6f6d 7061 7265 645f 6573       compared_es
+00033ea0: 7469 6d61 746f 7273 2e61 7070 656e 6428  timators.append(
+00033eb0: 226f 6e5f 706f 6c69 6379 2229 0a0a 2020  "on_policy")..  
+00033ec0: 2020 2020 2020 6e5f 706f 6c69 6369 6573        n_policies
+00033ed0: 203d 206c 656e 2869 6e70 7574 5f64 6963   = len(input_dic
+00033ee0: 7429 0a0a 2020 2020 2020 2020 6966 2068  t)..        if h
+00033ef0: 7565 203d 3d20 2265 7374 696d 6174 6f72  ue == "estimator
+00033f00: 223a 0a20 2020 2020 2020 2020 2020 2066  ":.            f
+00033f10: 6967 203d 2070 6c74 2e66 6967 7572 6528  ig = plt.figure(
+00033f20: 6669 6773 697a 653d 2832 202a 206e 5f65  figsize=(2 * n_e
+00033f30: 7374 696d 6174 6f72 732c 2034 202a 206e  stimators, 4 * n
+00033f40: 5f70 6f6c 6963 6965 7329 290a 0a20 2020  _policies))..   
+00033f50: 2020 2020 2020 2020 2066 6f72 2069 2c20           for i, 
+00033f60: 6576 616c 5f70 6f6c 6963 7920 696e 2065  eval_policy in e
+00033f70: 6e75 6d65 7261 7465 2869 6e70 7574 5f64  numerate(input_d
+00033f80: 6963 742e 6b65 7973 2829 293a 0a20 2020  ict.keys()):.   
+00033f90: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00033fa0: 6920 3d3d 2030 3a0a 2020 2020 2020 2020  i == 0:.        
+00033fb0: 2020 2020 2020 2020 2020 2020 6178 203d              ax =
+00033fc0: 2061 7830 203d 2066 6967 2e61 6464 5f73   ax0 = fig.add_s
+00033fd0: 7562 706c 6f74 286e 5f70 6f6c 6963 6965  ubplot(n_policie
+00033fe0: 732c 2031 2c20 6920 2b20 3129 0a20 2020  s, 1, i + 1).   
+00033ff0: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
+00034000: 6620 7368 6172 6579 3a0a 2020 2020 2020  f sharey:.      
+00034010: 2020 2020 2020 2020 2020 2020 2020 6178                ax
+00034020: 203d 2066 6967 2e61 6464 5f73 7562 706c   = fig.add_subpl
+00034030: 6f74 286e 5f70 6f6c 6963 6965 732c 2031  ot(n_policies, 1
+00034040: 2c20 6920 2b20 312c 2073 6861 7265 793d  , i + 1, sharey=
+00034050: 6178 3029 0a20 2020 2020 2020 2020 2020  ax0).           
+00034060: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00034070: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+00034080: 7820 3d20 6669 672e 6164 645f 7375 6270  x = fig.add_subp
+00034090: 6c6f 7428 6e5f 706f 6c69 6369 6573 2c20  lot(n_policies, 
+000340a0: 312c 2069 202b 2031 290a 0a20 2020 2020  1, i + 1)..     
+000340b0: 2020 2020 2020 2020 2020 206d 6561 6e20             mean 
+000340c0: 3d20 6e70 2e7a 6572 6f73 286e 5f65 7374  = np.zeros(n_est
+000340d0: 696d 6174 6f72 7329 0a20 2020 2020 2020  imators).       
+000340e0: 2020 2020 2020 2020 206d 6564 6961 6e20           median 
+000340f0: 3d20 6e70 2e7a 6572 6f73 286e 5f65 7374  = np.zeros(n_est
+00034100: 696d 6174 6f72 7329 0a20 2020 2020 2020  imators).       
+00034110: 2020 2020 2020 2020 2075 7070 6572 203d           upper =
+00034120: 206e 702e 7a65 726f 7328 6e5f 6573 7469   np.zeros(n_esti
+00034130: 6d61 746f 7273 290a 2020 2020 2020 2020  mators).        
+00034140: 2020 2020 2020 2020 6c6f 7765 7220 3d20          lower = 
+00034150: 6e70 2e7a 6572 6f73 286e 5f65 7374 696d  np.zeros(n_estim
+00034160: 6174 6f72 7329 0a0a 2020 2020 2020 2020  ators)..        
+00034170: 2020 2020 2020 2020 666f 7220 6a2c 2065          for j, e
+00034180: 7374 696d 6174 6f72 2069 6e20 656e 756d  stimator in enum
+00034190: 6572 6174 6528 636f 6d70 6172 6564 5f65  erate(compared_e
+000341a0: 7374 696d 6174 6f72 7329 3a0a 2020 2020  stimators):.    
+000341b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000341c0: 696e 7465 7271 7561 7274 696c 655f 6469  interquartile_di
+000341d0: 6374 5f20 3d20 696e 7465 7271 7561 7274  ct_ = interquart
+000341e0: 696c 655f 6469 6374 5b65 7661 6c5f 706f  ile_dict[eval_po
+000341f0: 6c69 6379 5d5b 6573 7469 6d61 746f 725d  licy][estimator]
+00034200: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00034210: 2020 2020 206d 6561 6e5b 6a5d 203d 206d       mean[j] = m
+00034220: 6561 6e5f 6469 6374 5b65 7661 6c5f 706f  ean_dict[eval_po
+00034230: 6c69 6379 5d5b 6573 7469 6d61 746f 725d  licy][estimator]
+00034240: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00034250: 2020 2020 206d 6564 6961 6e5b 6a5d 203d       median[j] =
+00034260: 2069 6e74 6572 7175 6172 7469 6c65 5f64   interquartile_d
+00034270: 6963 745f 5b22 6d65 6469 616e 225d 0a20  ict_["median"]. 
 00034280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034290: 2020 2020 696e 7465 7271 7561 7274 696c      interquartil
-000342a0: 655f 6469 6374 5f20 3d20 696e 7465 7271  e_dict_ = interq
-000342b0: 7561 7274 696c 655f 6469 6374 5b65 7661  uartile_dict[eva
-000342c0: 6c5f 706f 6c69 6379 5d5b 6573 7469 6d61  l_policy][estima
-000342d0: 746f 725d 0a20 2020 2020 2020 2020 2020  tor].           
-000342e0: 2020 2020 2020 2020 206d 6561 6e5b 6a5d           mean[j]
-000342f0: 203d 206d 6561 6e5f 6469 6374 5b65 7661   = mean_dict[eva
-00034300: 6c5f 706f 6c69 6379 5d5b 6573 7469 6d61  l_policy][estima
-00034310: 746f 725d 0a20 2020 2020 2020 2020 2020  tor].           
-00034320: 2020 2020 2020 2020 206d 6564 6961 6e5b           median[
-00034330: 6a5d 203d 2069 6e74 6572 7175 6172 7469  j] = interquarti
-00034340: 6c65 5f64 6963 745f 5b22 6d65 6469 616e  le_dict_["median
-00034350: 225d 0a20 2020 2020 2020 2020 2020 2020  "].             
-00034360: 2020 2020 2020 2075 7070 6572 5b6a 5d20         upper[j] 
-00034370: 3d20 696e 7465 7271 7561 7274 696c 655f  = interquartile_
-00034380: 6469 6374 5f5b 0a20 2020 2020 2020 2020  dict_[.         
-00034390: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-000343a0: 227b 3130 3020 2a20 2831 2e20 2d20 616c  "{100 * (1. - al
-000343b0: 7068 6129 7d25 2071 7561 7274 696c 6520  pha)}% quartile 
-000343c0: 2875 7070 6572 2922 0a20 2020 2020 2020  (upper)".       
-000343d0: 2020 2020 2020 2020 2020 2020 205d 0a20               ]. 
+00034290: 2020 2075 7070 6572 5b6a 5d20 3d20 696e     upper[j] = in
+000342a0: 7465 7271 7561 7274 696c 655f 6469 6374  terquartile_dict
+000342b0: 5f5b 0a20 2020 2020 2020 2020 2020 2020  _[.             
+000342c0: 2020 2020 2020 2020 2020 2066 227b 3130             f"{10
+000342d0: 3020 2a20 2831 2e20 2d20 616c 7068 6129  0 * (1. - alpha)
+000342e0: 7d25 2071 7561 7274 696c 6520 2875 7070  }% quartile (upp
+000342f0: 6572 2922 0a20 2020 2020 2020 2020 2020  er)".           
+00034300: 2020 2020 2020 2020 205d 0a20 2020 2020           ].     
+00034310: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+00034320: 6f77 6572 5b6a 5d20 3d20 696e 7465 7271  ower[j] = interq
+00034330: 7561 7274 696c 655f 6469 6374 5f5b 0a20  uartile_dict_[. 
+00034340: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034350: 2020 2020 2020 2066 227b 3130 3020 2a20         f"{100 * 
+00034360: 2831 2e20 2d20 616c 7068 6129 7d25 2071  (1. - alpha)}% q
+00034370: 7561 7274 696c 6520 286c 6f77 6572 2922  uartile (lower)"
+00034380: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00034390: 2020 2020 205d 0a0a 2020 2020 2020 2020       ]..        
+000343a0: 2020 2020 2020 2020 6178 2e62 6172 280a          ax.bar(.
+000343b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000343c0: 2020 2020 6e70 2e61 7261 6e67 6528 6e5f      np.arange(n_
+000343d0: 6573 7469 6d61 746f 7273 292c 0a20 2020  estimators),.   
 000343e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000343f0: 2020 206c 6f77 6572 5b6a 5d20 3d20 696e     lower[j] = in
-00034400: 7465 7271 7561 7274 696c 655f 6469 6374  terquartile_dict
-00034410: 5f5b 0a20 2020 2020 2020 2020 2020 2020  _[.             
-00034420: 2020 2020 2020 2020 2020 2066 227b 3130             f"{10
-00034430: 3020 2a20 2831 2e20 2d20 616c 7068 6129  0 * (1. - alpha)
-00034440: 7d25 2071 7561 7274 696c 6520 286c 6f77  }% quartile (low
-00034450: 6572 2922 0a20 2020 2020 2020 2020 2020  er)".           
-00034460: 2020 2020 2020 2020 205d 0a0a 2020 2020           ]..    
-00034470: 2020 2020 2020 2020 2020 2020 6178 2e62              ax.b
-00034480: 6172 280a 2020 2020 2020 2020 2020 2020  ar(.            
-00034490: 2020 2020 2020 2020 6e70 2e61 7261 6e67          np.arang
-000344a0: 6528 6e5f 6573 7469 6d61 746f 7273 292c  e(n_estimators),
-000344b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000344c0: 2020 2020 2075 7070 6572 202d 206c 6f77       upper - low
-000344d0: 6572 2c0a 2020 2020 2020 2020 2020 2020  er,.            
-000344e0: 2020 2020 2020 2020 626f 7474 6f6d 3d6c          bottom=l
-000344f0: 6f77 6572 2c0a 2020 2020 2020 2020 2020  ower,.          
-00034500: 2020 2020 2020 2020 2020 636f 6c6f 723d            color=
-00034510: 636f 6c6f 722c 0a20 2020 2020 2020 2020  color,.         
-00034520: 2020 2020 2020 2020 2020 2065 6467 6563             edgec
-00034530: 6f6c 6f72 3d22 626c 6163 6b22 2c0a 2020  olor="black",.  
-00034540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034550: 2020 6c69 6e65 7769 6474 683d 302e 332c    linewidth=0.3,
-00034560: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00034570: 2020 2020 2074 6963 6b5f 6c61 6265 6c3d       tick_label=
-00034580: 636f 6d70 6172 6564 5f65 7374 696d 6174  compared_estimat
-00034590: 6f72 732c 0a20 2020 2020 2020 2020 2020  ors,.           
-000345a0: 2020 2020 2020 2020 2061 6c70 6861 3d30           alpha=0
-000345b0: 2e33 2c0a 2020 2020 2020 2020 2020 2020  .3,.            
-000345c0: 2020 2020 290a 0a20 2020 2020 2020 2020      )..         
-000345d0: 2020 2020 2020 2066 6f72 206a 2069 6e20         for j in 
-000345e0: 7261 6e67 6528 6e5f 6573 7469 6d61 746f  range(n_estimato
-000345f0: 7273 293a 0a20 2020 2020 2020 2020 2020  rs):.           
-00034600: 2020 2020 2020 2020 2061 782e 6572 726f           ax.erro
-00034610: 7262 6172 280a 2020 2020 2020 2020 2020  rbar(.          
-00034620: 2020 2020 2020 2020 2020 2020 2020 6e70                np
-00034630: 2e61 7261 6e67 6528 6a2c 206a 202b 2031  .arange(j, j + 1
-00034640: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-00034650: 2020 2020 2020 2020 2020 206d 6564 6961             media
-00034660: 6e5b 6a5d 2c0a 2020 2020 2020 2020 2020  n[j],.          
-00034670: 2020 2020 2020 2020 2020 2020 2020 7865                xe
-00034680: 7272 3d5b 302e 345d 2c0a 2020 2020 2020  rr=[0.4],.      
-00034690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000346a0: 2020 636f 6c6f 723d 636f 6c6f 725b 6a20    color=color[j 
-000346b0: 2520 6e5f 636f 6c6f 7273 5d2c 0a20 2020  % n_colors],.   
+000343f0: 2075 7070 6572 202d 206c 6f77 6572 2c0a   upper - lower,.
+00034400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034410: 2020 2020 626f 7474 6f6d 3d6c 6f77 6572      bottom=lower
+00034420: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00034430: 2020 2020 2020 636f 6c6f 723d 636f 6c6f        color=colo
+00034440: 722c 0a20 2020 2020 2020 2020 2020 2020  r,.             
+00034450: 2020 2020 2020 2065 6467 6563 6f6c 6f72         edgecolor
+00034460: 3d22 626c 6163 6b22 2c0a 2020 2020 2020  ="black",.      
+00034470: 2020 2020 2020 2020 2020 2020 2020 6c69                li
+00034480: 6e65 7769 6474 683d 302e 332c 0a20 2020  newidth=0.3,.   
+00034490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000344a0: 2074 6963 6b5f 6c61 6265 6c3d 636f 6d70   tick_label=comp
+000344b0: 6172 6564 5f65 7374 696d 6174 6f72 732c  ared_estimators,
+000344c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000344d0: 2020 2020 2061 6c70 6861 3d30 2e33 2c0a       alpha=0.3,.
+000344e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000344f0: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
+00034500: 2020 2066 6f72 206a 2069 6e20 7261 6e67     for j in rang
+00034510: 6528 6e5f 6573 7469 6d61 746f 7273 293a  e(n_estimators):
+00034520: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00034530: 2020 2020 2061 782e 6572 726f 7262 6172       ax.errorbar
+00034540: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00034550: 2020 2020 2020 2020 2020 6e70 2e61 7261            np.ara
+00034560: 6e67 6528 6a2c 206a 202b 2031 292c 0a20  nge(j, j + 1),. 
+00034570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034580: 2020 2020 2020 206d 6564 6961 6e5b 6a5d         median[j]
+00034590: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000345a0: 2020 2020 2020 2020 2020 7865 7272 3d5b            xerr=[
+000345b0: 302e 345d 2c0a 2020 2020 2020 2020 2020  0.4],.          
+000345c0: 2020 2020 2020 2020 2020 2020 2020 636f                co
+000345d0: 6c6f 723d 636f 6c6f 725b 6a20 2520 6e5f  lor=color[j % n_
+000345e0: 636f 6c6f 7273 5d2c 0a20 2020 2020 2020  colors],.       
+000345f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034600: 2065 6c69 6e65 7769 6474 683d 352e 302c   elinewidth=5.0,
+00034610: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00034620: 2020 2020 2020 2020 2066 6d74 3d22 6f22           fmt="o"
+00034630: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00034640: 2020 2020 2020 2020 2020 6d61 726b 6572            marker
+00034650: 7369 7a65 3d30 2e31 2c0a 2020 2020 2020  size=0.1,.      
+00034660: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+00034670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034680: 2020 2020 6178 2e65 7272 6f72 6261 7228      ax.errorbar(
+00034690: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000346a0: 2020 2020 2020 2020 206e 702e 6172 616e           np.aran
+000346b0: 6765 286a 2c20 6a20 2b20 3129 2c0a 2020  ge(j, j + 1),.  
 000346c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000346d0: 2020 2020 2065 6c69 6e65 7769 6474 683d       elinewidth=
-000346e0: 352e 302c 0a20 2020 2020 2020 2020 2020  5.0,.           
-000346f0: 2020 2020 2020 2020 2020 2020 2066 6d74               fmt
-00034700: 3d22 6f22 2c0a 2020 2020 2020 2020 2020  ="o",.          
-00034710: 2020 2020 2020 2020 2020 2020 2020 6d61                ma
-00034720: 726b 6572 7369 7a65 3d30 2e31 2c0a 2020  rkersize=0.1,.  
-00034730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034740: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-00034750: 2020 2020 2020 2020 6178 2e65 7272 6f72          ax.error
-00034760: 6261 7228 0a20 2020 2020 2020 2020 2020  bar(.           
-00034770: 2020 2020 2020 2020 2020 2020 206e 702e               np.
-00034780: 6172 616e 6765 286a 2c20 6a20 2b20 3129  arange(j, j + 1)
-00034790: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000347a0: 2020 2020 2020 2020 2020 6d65 616e 5b6a            mean[j
-000347b0: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
-000347c0: 2020 2020 2020 2020 2020 2063 6f6c 6f72             color
-000347d0: 3d63 6f6c 6f72 5b6a 2025 206e 5f63 6f6c  =color[j % n_col
-000347e0: 6f72 735d 2c0a 2020 2020 2020 2020 2020  ors],.          
-000347f0: 2020 2020 2020 2020 2020 2020 2020 666d                fm
-00034800: 743d 226f 222c 0a20 2020 2020 2020 2020  t="o",.         
-00034810: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-00034820: 6172 6b65 7273 697a 653d 3130 2e30 2c0a  arkersize=10.0,.
-00034830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034840: 2020 2020 290a 0a20 2020 2020 2020 2020      )..         
-00034850: 2020 2020 2020 2061 782e 7365 745f 7469         ax.set_ti
-00034860: 746c 6528 6576 616c 5f70 6f6c 6963 792c  tle(eval_policy,
-00034870: 2066 6f6e 7473 697a 653d 3136 290a 2020   fontsize=16).  
-00034880: 2020 2020 2020 2020 2020 2020 2020 6178                ax
-00034890: 2e73 6574 5f79 6c61 6265 6c28 0a20 2020  .set_ylabel(.   
-000348a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000348b0: 2066 2245 7374 696d 6174 6564 207b 6e70   f"Estimated {np
-000348c0: 2e69 6e74 3634 2831 3030 2a28 3120 2d20  .int64(100*(1 - 
-000348d0: 616c 7068 6129 297d 2520 496e 7465 7271  alpha))}% Interq
-000348e0: 7561 7274 696c 6520 5261 6e67 6522 2c0a  uartile Range",.
-000348f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034900: 2020 2020 666f 6e74 7369 7a65 3d31 322c      fontsize=12,
-00034910: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00034920: 2029 0a20 2020 2020 2020 2020 2020 2020   ).             
-00034930: 2020 2070 6c74 2e79 7469 636b 7328 666f     plt.yticks(fo
-00034940: 6e74 7369 7a65 3d31 3229 0a20 2020 2020  ntsize=12).     
-00034950: 2020 2020 2020 2020 2020 2070 6c74 2e78             plt.x
-00034960: 7469 636b 7328 666f 6e74 7369 7a65 3d31  ticks(fontsize=1
-00034970: 3229 0a20 2020 2020 2020 2020 2020 2020  2).             
-00034980: 2020 2070 6c74 2e78 6c69 6d28 2d30 2e35     plt.xlim(-0.5
-00034990: 2c20 6e5f 6573 7469 6d61 746f 7273 202d  , n_estimators -
-000349a0: 2030 2e35 290a 0a20 2020 2020 2020 2065   0.5)..        e
-000349b0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-000349c0: 2066 6967 203d 2070 6c74 2e66 6967 7572   fig = plt.figur
-000349d0: 6528 6669 6773 697a 653d 2832 202a 206e  e(figsize=(2 * n
-000349e0: 5f70 6f6c 6963 6965 732c 2034 202a 206e  _policies, 4 * n
-000349f0: 5f65 7374 696d 6174 6f72 7329 290a 0a20  _estimators)).. 
-00034a00: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
-00034a10: 2c20 6573 7469 6d61 746f 7220 696e 2065  , estimator in e
-00034a20: 6e75 6d65 7261 7465 2863 6f6d 7061 7265  numerate(compare
-00034a30: 645f 6573 7469 6d61 746f 7273 293a 0a20  d_estimators):. 
-00034a40: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00034a50: 6620 6920 3d3d 2030 3a0a 2020 2020 2020  f i == 0:.      
-00034a60: 2020 2020 2020 2020 2020 2020 2020 6178                ax
-00034a70: 203d 2061 7830 203d 2066 6967 2e61 6464   = ax0 = fig.add
-00034a80: 5f73 7562 706c 6f74 286e 5f65 7374 696d  _subplot(n_estim
-00034a90: 6174 6f72 732c 2031 2c20 6920 2b20 3129  ators, 1, i + 1)
-00034aa0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00034ab0: 2065 6c69 6620 7368 6172 6579 3a0a 2020   elif sharey:.  
-00034ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034ad0: 2020 6178 203d 2066 6967 2e61 6464 5f73    ax = fig.add_s
-00034ae0: 7562 706c 6f74 286e 5f65 7374 696d 6174  ubplot(n_estimat
-00034af0: 6f72 732c 2031 2c20 6920 2b20 312c 2073  ors, 1, i + 1, s
-00034b00: 6861 7265 793d 6178 3029 0a20 2020 2020  harey=ax0).     
-00034b10: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-00034b20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00034b30: 2020 2020 2061 7820 3d20 6669 672e 6164       ax = fig.ad
-00034b40: 645f 7375 6270 6c6f 7428 6e5f 6573 7469  d_subplot(n_esti
-00034b50: 6d61 746f 7273 2c20 312c 2069 202b 2031  mators, 1, i + 1
-00034b60: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
-00034b70: 2020 206d 6561 6e20 3d20 6e70 2e7a 6572     mean = np.zer
-00034b80: 6f73 286e 5f70 6f6c 6963 6965 7329 0a20  os(n_policies). 
-00034b90: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-00034ba0: 6564 6961 6e20 3d20 6e70 2e7a 6572 6f73  edian = np.zeros
-00034bb0: 286e 5f70 6f6c 6963 6965 7329 0a20 2020  (n_policies).   
-00034bc0: 2020 2020 2020 2020 2020 2020 2075 7070               upp
-00034bd0: 6572 203d 206e 702e 7a65 726f 7328 6e5f  er = np.zeros(n_
-00034be0: 706f 6c69 6369 6573 290a 2020 2020 2020  policies).      
-00034bf0: 2020 2020 2020 2020 2020 6c6f 7765 7220            lower 
-00034c00: 3d20 6e70 2e7a 6572 6f73 286e 5f70 6f6c  = np.zeros(n_pol
-00034c10: 6963 6965 7329 0a0a 2020 2020 2020 2020  icies)..        
-00034c20: 2020 2020 2020 2020 666f 7220 6a2c 2065          for j, e
-00034c30: 7661 6c5f 706f 6c69 6379 2069 6e20 656e  val_policy in en
-00034c40: 756d 6572 6174 6528 696e 7075 745f 6469  umerate(input_di
-00034c50: 6374 2e6b 6579 7328 2929 3a0a 2020 2020  ct.keys()):.    
-00034c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034c70: 696e 7465 7271 7561 7274 696c 655f 6469  interquartile_di
-00034c80: 6374 5f20 3d20 696e 7465 7271 7561 7274  ct_ = interquart
-00034c90: 696c 655f 6469 6374 5b65 7661 6c5f 706f  ile_dict[eval_po
-00034ca0: 6c69 6379 5d5b 6573 7469 6d61 746f 725d  licy][estimator]
-00034cb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00034cc0: 2020 2020 206d 6561 6e5b 6a5d 203d 206d       mean[j] = m
-00034cd0: 6561 6e5f 6469 6374 5b65 7661 6c5f 706f  ean_dict[eval_po
-00034ce0: 6c69 6379 5d5b 6573 7469 6d61 746f 725d  licy][estimator]
-00034cf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00034d00: 2020 2020 206d 6564 6961 6e5b 6a5d 203d       median[j] =
-00034d10: 2069 6e74 6572 7175 6172 7469 6c65 5f64   interquartile_d
-00034d20: 6963 745f 5b22 6d65 6469 616e 225d 0a20  ict_["median"]. 
-00034d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034d40: 2020 2075 7070 6572 5b6a 5d20 3d20 696e     upper[j] = in
-00034d50: 7465 7271 7561 7274 696c 655f 6469 6374  terquartile_dict
-00034d60: 5f5b 0a20 2020 2020 2020 2020 2020 2020  _[.             
-00034d70: 2020 2020 2020 2020 2020 2066 227b 3130             f"{10
-00034d80: 3020 2a20 2831 2e20 2d20 616c 7068 6129  0 * (1. - alpha)
-00034d90: 7d25 2071 7561 7274 696c 6520 2875 7070  }% quartile (upp
-00034da0: 6572 2922 0a20 2020 2020 2020 2020 2020  er)".           
-00034db0: 2020 2020 2020 2020 205d 0a20 2020 2020           ].     
-00034dc0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-00034dd0: 6f77 6572 5b6a 5d20 3d20 696e 7465 7271  ower[j] = interq
-00034de0: 7561 7274 696c 655f 6469 6374 5f5b 0a20  uartile_dict_[. 
-00034df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034e00: 2020 2020 2020 2066 227b 3130 3020 2a20         f"{100 * 
-00034e10: 2831 2e20 2d20 616c 7068 6129 7d25 2071  (1. - alpha)}% q
-00034e20: 7561 7274 696c 6520 286c 6f77 6572 2922  uartile (lower)"
-00034e30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00034e40: 2020 2020 205d 0a0a 2020 2020 2020 2020       ]..        
-00034e50: 2020 2020 2020 2020 6178 2e62 6172 280a          ax.bar(.
-00034e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034e70: 2020 2020 6e70 2e61 7261 6e67 6528 6e5f      np.arange(n_
-00034e80: 706f 6c69 6369 6573 292c 0a20 2020 2020  policies),.     
-00034e90: 2020 2020 2020 2020 2020 2020 2020 2075                 u
-00034ea0: 7070 6572 202d 206c 6f77 6572 2c0a 2020  pper - lower,.  
-00034eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034ec0: 2020 626f 7474 6f6d 3d6c 6f77 6572 2c0a    bottom=lower,.
-00034ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034ee0: 2020 2020 636f 6c6f 723d 636f 6c6f 722c      color=color,
-00034ef0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00034f00: 2020 2020 2065 6467 6563 6f6c 6f72 3d22       edgecolor="
-00034f10: 626c 6163 6b22 2c0a 2020 2020 2020 2020  black",.        
-00034f20: 2020 2020 2020 2020 2020 2020 6c69 6e65              line
-00034f30: 7769 6474 683d 302e 332c 0a20 2020 2020  width=0.3,.     
-00034f40: 2020 2020 2020 2020 2020 2020 2020 2074                 t
-00034f50: 6963 6b5f 6c61 6265 6c3d 6c69 7374 2869  ick_label=list(i
-00034f60: 6e70 7574 5f64 6963 742e 6b65 7973 2829  nput_dict.keys()
-00034f70: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-00034f80: 2020 2020 2020 2061 6c70 6861 3d30 2e33         alpha=0.3
+000346d0: 2020 2020 2020 6d65 616e 5b6a 5d2c 0a20        mean[j],. 
+000346e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000346f0: 2020 2020 2020 2063 6f6c 6f72 3d63 6f6c         color=col
+00034700: 6f72 5b6a 2025 206e 5f63 6f6c 6f72 735d  or[j % n_colors]
+00034710: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00034720: 2020 2020 2020 2020 2020 666d 743d 226f            fmt="o
+00034730: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00034740: 2020 2020 2020 2020 2020 206d 6172 6b65             marke
+00034750: 7273 697a 653d 3130 2e30 2c0a 2020 2020  rsize=10.0,.    
+00034760: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034770: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
+00034780: 2020 2061 782e 7365 745f 7469 746c 6528     ax.set_title(
+00034790: 6576 616c 5f70 6f6c 6963 792c 2066 6f6e  eval_policy, fon
+000347a0: 7473 697a 653d 3136 290a 2020 2020 2020  tsize=16).      
+000347b0: 2020 2020 2020 2020 2020 6178 2e73 6574            ax.set
+000347c0: 5f79 6c61 6265 6c28 0a20 2020 2020 2020  _ylabel(.       
+000347d0: 2020 2020 2020 2020 2020 2020 2066 2245               f"E
+000347e0: 7374 696d 6174 6564 207b 6e70 2e69 6e74  stimated {np.int
+000347f0: 3634 2831 3030 2a28 3120 2d20 616c 7068  64(100*(1 - alph
+00034800: 6129 297d 2520 496e 7465 7271 7561 7274  a))}% Interquart
+00034810: 696c 6520 5261 6e67 6522 2c0a 2020 2020  ile Range",.    
+00034820: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034830: 666f 6e74 7369 7a65 3d31 322c 0a20 2020  fontsize=12,.   
+00034840: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
+00034850: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00034860: 6c74 2e79 7469 636b 7328 666f 6e74 7369  lt.yticks(fontsi
+00034870: 7a65 3d31 3229 0a20 2020 2020 2020 2020  ze=12).         
+00034880: 2020 2020 2020 2070 6c74 2e78 7469 636b         plt.xtick
+00034890: 7328 666f 6e74 7369 7a65 3d31 3229 0a20  s(fontsize=12). 
+000348a0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+000348b0: 6c74 2e78 6c69 6d28 2d30 2e35 2c20 6e5f  lt.xlim(-0.5, n_
+000348c0: 6573 7469 6d61 746f 7273 202d 2030 2e35  estimators - 0.5
+000348d0: 290a 0a20 2020 2020 2020 2065 6c73 653a  )..        else:
+000348e0: 0a20 2020 2020 2020 2020 2020 2066 6967  .            fig
+000348f0: 203d 2070 6c74 2e66 6967 7572 6528 6669   = plt.figure(fi
+00034900: 6773 697a 653d 2832 202a 206e 5f70 6f6c  gsize=(2 * n_pol
+00034910: 6963 6965 732c 2034 202a 206e 5f65 7374  icies, 4 * n_est
+00034920: 696d 6174 6f72 7329 290a 0a20 2020 2020  imators))..     
+00034930: 2020 2020 2020 2066 6f72 2069 2c20 6573         for i, es
+00034940: 7469 6d61 746f 7220 696e 2065 6e75 6d65  timator in enume
+00034950: 7261 7465 2863 6f6d 7061 7265 645f 6573  rate(compared_es
+00034960: 7469 6d61 746f 7273 293a 0a20 2020 2020  timators):.     
+00034970: 2020 2020 2020 2020 2020 2069 6620 6920             if i 
+00034980: 3d3d 2030 3a0a 2020 2020 2020 2020 2020  == 0:.          
+00034990: 2020 2020 2020 2020 2020 6178 203d 2061            ax = a
+000349a0: 7830 203d 2066 6967 2e61 6464 5f73 7562  x0 = fig.add_sub
+000349b0: 706c 6f74 286e 5f65 7374 696d 6174 6f72  plot(n_estimator
+000349c0: 732c 2031 2c20 6920 2b20 3129 0a20 2020  s, 1, i + 1).   
+000349d0: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
+000349e0: 6620 7368 6172 6579 3a0a 2020 2020 2020  f sharey:.      
+000349f0: 2020 2020 2020 2020 2020 2020 2020 6178                ax
+00034a00: 203d 2066 6967 2e61 6464 5f73 7562 706c   = fig.add_subpl
+00034a10: 6f74 286e 5f65 7374 696d 6174 6f72 732c  ot(n_estimators,
+00034a20: 2031 2c20 6920 2b20 312c 2073 6861 7265   1, i + 1, share
+00034a30: 793d 6178 3029 0a20 2020 2020 2020 2020  y=ax0).         
+00034a40: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00034a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034a60: 2061 7820 3d20 6669 672e 6164 645f 7375   ax = fig.add_su
+00034a70: 6270 6c6f 7428 6e5f 6573 7469 6d61 746f  bplot(n_estimato
+00034a80: 7273 2c20 312c 2069 202b 2031 290a 0a20  rs, 1, i + 1).. 
+00034a90: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+00034aa0: 6561 6e20 3d20 6e70 2e7a 6572 6f73 286e  ean = np.zeros(n
+00034ab0: 5f70 6f6c 6963 6965 7329 0a20 2020 2020  _policies).     
+00034ac0: 2020 2020 2020 2020 2020 206d 6564 6961             media
+00034ad0: 6e20 3d20 6e70 2e7a 6572 6f73 286e 5f70  n = np.zeros(n_p
+00034ae0: 6f6c 6963 6965 7329 0a20 2020 2020 2020  olicies).       
+00034af0: 2020 2020 2020 2020 2075 7070 6572 203d           upper =
+00034b00: 206e 702e 7a65 726f 7328 6e5f 706f 6c69   np.zeros(n_poli
+00034b10: 6369 6573 290a 2020 2020 2020 2020 2020  cies).          
+00034b20: 2020 2020 2020 6c6f 7765 7220 3d20 6e70        lower = np
+00034b30: 2e7a 6572 6f73 286e 5f70 6f6c 6963 6965  .zeros(n_policie
+00034b40: 7329 0a0a 2020 2020 2020 2020 2020 2020  s)..            
+00034b50: 2020 2020 666f 7220 6a2c 2065 7661 6c5f      for j, eval_
+00034b60: 706f 6c69 6379 2069 6e20 656e 756d 6572  policy in enumer
+00034b70: 6174 6528 696e 7075 745f 6469 6374 2e6b  ate(input_dict.k
+00034b80: 6579 7328 2929 3a0a 2020 2020 2020 2020  eys()):.        
+00034b90: 2020 2020 2020 2020 2020 2020 696e 7465              inte
+00034ba0: 7271 7561 7274 696c 655f 6469 6374 5f20  rquartile_dict_ 
+00034bb0: 3d20 696e 7465 7271 7561 7274 696c 655f  = interquartile_
+00034bc0: 6469 6374 5b65 7661 6c5f 706f 6c69 6379  dict[eval_policy
+00034bd0: 5d5b 6573 7469 6d61 746f 725d 0a20 2020  ][estimator].   
+00034be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034bf0: 206d 6561 6e5b 6a5d 203d 206d 6561 6e5f   mean[j] = mean_
+00034c00: 6469 6374 5b65 7661 6c5f 706f 6c69 6379  dict[eval_policy
+00034c10: 5d5b 6573 7469 6d61 746f 725d 0a20 2020  ][estimator].   
+00034c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034c30: 206d 6564 6961 6e5b 6a5d 203d 2069 6e74   median[j] = int
+00034c40: 6572 7175 6172 7469 6c65 5f64 6963 745f  erquartile_dict_
+00034c50: 5b22 6d65 6469 616e 225d 0a20 2020 2020  ["median"].     
+00034c60: 2020 2020 2020 2020 2020 2020 2020 2075                 u
+00034c70: 7070 6572 5b6a 5d20 3d20 696e 7465 7271  pper[j] = interq
+00034c80: 7561 7274 696c 655f 6469 6374 5f5b 0a20  uartile_dict_[. 
+00034c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034ca0: 2020 2020 2020 2066 227b 3130 3020 2a20         f"{100 * 
+00034cb0: 2831 2e20 2d20 616c 7068 6129 7d25 2071  (1. - alpha)}% q
+00034cc0: 7561 7274 696c 6520 2875 7070 6572 2922  uartile (upper)"
+00034cd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00034ce0: 2020 2020 205d 0a20 2020 2020 2020 2020       ].         
+00034cf0: 2020 2020 2020 2020 2020 206c 6f77 6572             lower
+00034d00: 5b6a 5d20 3d20 696e 7465 7271 7561 7274  [j] = interquart
+00034d10: 696c 655f 6469 6374 5f5b 0a20 2020 2020  ile_dict_[.     
+00034d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034d30: 2020 2066 227b 3130 3020 2a20 2831 2e20     f"{100 * (1. 
+00034d40: 2d20 616c 7068 6129 7d25 2071 7561 7274  - alpha)}% quart
+00034d50: 696c 6520 286c 6f77 6572 2922 0a20 2020  ile (lower)".   
+00034d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034d70: 205d 0a0a 2020 2020 2020 2020 2020 2020   ]..            
+00034d80: 2020 2020 6178 2e62 6172 280a 2020 2020      ax.bar(.    
+00034d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034da0: 6e70 2e61 7261 6e67 6528 6e5f 706f 6c69  np.arange(n_poli
+00034db0: 6369 6573 292c 0a20 2020 2020 2020 2020  cies),.         
+00034dc0: 2020 2020 2020 2020 2020 2075 7070 6572             upper
+00034dd0: 202d 206c 6f77 6572 2c0a 2020 2020 2020   - lower,.      
+00034de0: 2020 2020 2020 2020 2020 2020 2020 626f                bo
+00034df0: 7474 6f6d 3d6c 6f77 6572 2c0a 2020 2020  ttom=lower,.    
+00034e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034e10: 636f 6c6f 723d 636f 6c6f 722c 0a20 2020  color=color,.   
+00034e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034e30: 2065 6467 6563 6f6c 6f72 3d22 626c 6163   edgecolor="blac
+00034e40: 6b22 2c0a 2020 2020 2020 2020 2020 2020  k",.            
+00034e50: 2020 2020 2020 2020 6c69 6e65 7769 6474          linewidt
+00034e60: 683d 302e 332c 0a20 2020 2020 2020 2020  h=0.3,.         
+00034e70: 2020 2020 2020 2020 2020 2074 6963 6b5f             tick_
+00034e80: 6c61 6265 6c3d 6c69 7374 2869 6e70 7574  label=list(input
+00034e90: 5f64 6963 742e 6b65 7973 2829 292c 0a20  _dict.keys()),. 
+00034ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034eb0: 2020 2061 6c70 6861 3d30 2e33 2c0a 2020     alpha=0.3,.  
+00034ec0: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+00034ed0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00034ee0: 2066 6f72 206a 2069 6e20 7261 6e67 6528   for j in range(
+00034ef0: 6e5f 706f 6c69 6369 6573 293a 0a20 2020  n_policies):.   
+00034f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034f10: 2061 782e 6572 726f 7262 6172 280a 2020   ax.errorbar(.  
+00034f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034f30: 2020 2020 2020 6e70 2e61 7261 6e67 6528        np.arange(
+00034f40: 6a2c 206a 202b 2031 292c 0a20 2020 2020  j, j + 1),.     
+00034f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034f60: 2020 206d 6564 6961 6e5b 6a5d 2c0a 2020     median[j],.  
+00034f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00034f80: 2020 2020 2020 7865 7272 3d5b 302e 345d        xerr=[0.4]
 00034f90: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00034fa0: 2020 290a 0a20 2020 2020 2020 2020 2020    )..           
-00034fb0: 2020 2020 2066 6f72 206a 2069 6e20 7261       for j in ra
-00034fc0: 6e67 6528 6e5f 706f 6c69 6369 6573 293a  nge(n_policies):
-00034fd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00034fe0: 2020 2020 2061 782e 6572 726f 7262 6172       ax.errorbar
-00034ff0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00035000: 2020 2020 2020 2020 2020 6e70 2e61 7261            np.ara
-00035010: 6e67 6528 6a2c 206a 202b 2031 292c 0a20  nge(j, j + 1),. 
-00035020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035030: 2020 2020 2020 206d 6564 6961 6e5b 6a5d         median[j]
-00035040: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00035050: 2020 2020 2020 2020 2020 7865 7272 3d5b            xerr=[
-00035060: 302e 345d 2c0a 2020 2020 2020 2020 2020  0.4],.          
-00035070: 2020 2020 2020 2020 2020 2020 2020 636f                co
-00035080: 6c6f 723d 636f 6c6f 725b 6a20 2520 6e5f  lor=color[j % n_
-00035090: 636f 6c6f 7273 5d2c 0a20 2020 2020 2020  colors],.       
+00034fa0: 2020 2020 2020 2020 2020 636f 6c6f 723d            color=
+00034fb0: 636f 6c6f 725b 6a20 2520 6e5f 636f 6c6f  color[j % n_colo
+00034fc0: 7273 5d2c 0a20 2020 2020 2020 2020 2020  rs],.           
+00034fd0: 2020 2020 2020 2020 2020 2020 2065 6c69               eli
+00034fe0: 6e65 7769 6474 683d 352e 302c 0a20 2020  newidth=5.0,.   
+00034ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035000: 2020 2020 2066 6d74 3d22 6f22 2c0a 2020       fmt="o",.  
+00035010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035020: 2020 2020 2020 6d61 726b 6572 7369 7a65        markersize
+00035030: 3d30 2e31 2c0a 2020 2020 2020 2020 2020  =0.1,.          
+00035040: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00035050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035060: 6178 2e65 7272 6f72 6261 7228 0a20 2020  ax.errorbar(.   
+00035070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035080: 2020 2020 206e 702e 6172 616e 6765 286a       np.arange(j
+00035090: 2c20 6a20 2b20 3129 2c0a 2020 2020 2020  , j + 1),.      
 000350a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000350b0: 2065 6c69 6e65 7769 6474 683d 352e 302c   elinewidth=5.0,
-000350c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000350d0: 2020 2020 2020 2020 2066 6d74 3d22 6f22           fmt="o"
-000350e0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000350f0: 2020 2020 2020 2020 2020 6d61 726b 6572            marker
-00035100: 7369 7a65 3d30 2e31 2c0a 2020 2020 2020  size=0.1,.      
-00035110: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-00035120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035130: 2020 2020 6178 2e65 7272 6f72 6261 7228      ax.errorbar(
-00035140: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00035150: 2020 2020 2020 2020 206e 702e 6172 616e           np.aran
-00035160: 6765 286a 2c20 6a20 2b20 3129 2c0a 2020  ge(j, j + 1),.  
-00035170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035180: 2020 2020 2020 6d65 616e 5b6a 5d2c 0a20        mean[j],. 
-00035190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000351a0: 2020 2020 2020 2063 6f6c 6f72 3d63 6f6c         color=col
-000351b0: 6f72 5b6a 2025 206e 5f63 6f6c 6f72 735d  or[j % n_colors]
-000351c0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000351d0: 2020 2020 2020 2020 2020 666d 743d 226f            fmt="o
-000351e0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-000351f0: 2020 2020 2020 2020 2020 206d 6172 6b65             marke
-00035200: 7273 697a 653d 3130 2e30 2c0a 2020 2020  rsize=10.0,.    
-00035210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035220: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
-00035230: 2020 2061 782e 7365 745f 7469 746c 6528     ax.set_title(
-00035240: 6573 7469 6d61 746f 722c 2066 6f6e 7473  estimator, fonts
-00035250: 697a 653d 3136 290a 2020 2020 2020 2020  ize=16).        
-00035260: 2020 2020 2020 2020 6178 2e73 6574 5f79          ax.set_y
-00035270: 6c61 6265 6c28 0a20 2020 2020 2020 2020  label(.         
-00035280: 2020 2020 2020 2020 2020 2066 2245 7374             f"Est
-00035290: 696d 6174 6564 207b 6e70 2e69 6e74 3634  imated {np.int64
-000352a0: 2831 3030 2a28 3120 2d20 616c 7068 6129  (100*(1 - alpha)
-000352b0: 297d 2520 496e 7465 7271 7561 7274 696c  )}% Interquartil
-000352c0: 6520 5261 6e67 6522 2c0a 2020 2020 2020  e Range",.      
-000352d0: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-000352e0: 6e74 7369 7a65 3d31 322c 0a20 2020 2020  ntsize=12,.     
-000352f0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00035300: 2020 2020 2020 2020 2020 2020 2070 6c74               plt
-00035310: 2e79 7469 636b 7328 666f 6e74 7369 7a65  .yticks(fontsize
-00035320: 3d31 3229 0a20 2020 2020 2020 2020 2020  =12).           
-00035330: 2020 2020 2070 6c74 2e78 7469 636b 7328       plt.xticks(
-00035340: 666f 6e74 7369 7a65 3d31 3229 0a20 2020  fontsize=12).   
-00035350: 2020 2020 2020 2020 2020 2020 2070 6c74               plt
-00035360: 2e78 6c69 6d28 2d30 2e35 2c20 6e5f 706f  .xlim(-0.5, n_po
-00035370: 6c69 6369 6573 202d 2030 2e35 290a 0a20  licies - 0.5).. 
-00035380: 2020 2020 2020 2066 6967 2e73 7562 706c         fig.subpl
-00035390: 6f74 735f 6164 6a75 7374 2874 6f70 3d31  ots_adjust(top=1
-000353a0: 2e30 290a 2020 2020 2020 2020 706c 742e  .0).        plt.
-000353b0: 7368 6f77 2829 0a0a 2020 2020 2020 2020  show()..        
-000353c0: 6966 2066 6967 5f64 6972 3a0a 2020 2020  if fig_dir:.    
-000353d0: 2020 2020 2020 2020 6669 672e 7361 7665          fig.save
-000353e0: 6669 6728 7374 7228 6669 675f 6469 7220  fig(str(fig_dir 
-000353f0: 2f20 6669 675f 6e61 6d65 292c 2064 7069  / fig_name), dpi
-00035400: 3d33 3030 2c20 6262 6f78 5f69 6e63 6865  =300, bbox_inche
-00035410: 733d 2274 6967 6874 2229 0a0a 2020 2020  s="tight")..    
-00035420: 6465 6620 5f76 6973 7561 6c69 7a65 5f6f  def _visualize_o
-00035430: 6666 5f70 6f6c 6963 795f 6573 7469 6d61  ff_policy_estima
-00035440: 7465 735f 7769 7468 5f6d 756c 7469 706c  tes_with_multipl
-00035450: 655f 6573 7469 6d61 7465 7328 0a20 2020  e_estimates(.   
-00035460: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-00035470: 2020 2069 6e70 7574 5f64 6963 743a 204d     input_dict: M
-00035480: 756c 7469 706c 6549 6e70 7574 4469 6374  ultipleInputDict
-00035490: 2c0a 2020 2020 2020 2020 6573 7469 6d61  ,.        estima
-000354a0: 7469 6f6e 5f64 6963 743a 2044 6963 745b  tion_dict: Dict[
-000354b0: 7374 722c 2044 6963 745b 7374 722c 206e  str, Dict[str, n
-000354c0: 702e 6e64 6172 7261 795d 5d2c 0a20 2020  p.ndarray]],.   
-000354d0: 2020 2020 2063 6f6d 7061 7265 645f 6573       compared_es
-000354e0: 7469 6d61 746f 7273 3a20 4f70 7469 6f6e  timators: Option
-000354f0: 616c 5b4c 6973 745b 7374 725d 5d20 3d20  al[List[str]] = 
-00035500: 4e6f 6e65 2c0a 2020 2020 2020 2020 6265  None,.        be
-00035510: 6861 7669 6f72 5f70 6f6c 6963 795f 6e61  havior_policy_na
-00035520: 6d65 3a20 4f70 7469 6f6e 616c 5b73 7472  me: Optional[str
-00035530: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
-00035540: 2020 706c 6f74 5f74 7970 653a 2073 7472    plot_type: str
-00035550: 203d 2022 6369 222c 0a20 2020 2020 2020   = "ci",.       
-00035560: 2068 7565 3a20 7374 7220 3d20 2265 7374   hue: str = "est
-00035570: 696d 6174 6f72 222c 0a20 2020 2020 2020  imator",.       
-00035580: 206c 6567 656e 643a 2062 6f6f 6c20 3d20   legend: bool = 
-00035590: 5472 7565 2c0a 2020 2020 2020 2020 7368  True,.        sh
-000355a0: 6172 6579 3a20 626f 6f6c 203d 2046 616c  arey: bool = Fal
-000355b0: 7365 2c0a 2020 2020 2020 2020 796c 6162  se,.        ylab
-000355c0: 656c 3a20 7374 7220 3d20 2245 7374 696d  el: str = "Estim
-000355d0: 6174 6564 2050 6572 666f 726d 616e 6365  ated Performance
-000355e0: 222c 0a20 2020 2020 2020 2066 6967 5f64  ",.        fig_d
-000355f0: 6972 3a20 4f70 7469 6f6e 616c 5b50 6174  ir: Optional[Pat
-00035600: 685d 203d 204e 6f6e 652c 0a20 2020 2020  h] = None,.     
-00035610: 2020 2066 6967 5f6e 616d 653a 204f 7074     fig_name: Opt
-00035620: 696f 6e61 6c5b 7374 725d 203d 204e 6f6e  ional[str] = Non
-00035630: 652c 0a20 2020 2029 202d 3e20 4e6f 6e65  e,.    ) -> None
-00035640: 3a0a 2020 2020 2020 2020 2222 2256 6973  :.        """Vis
-00035650: 7561 6c69 7a65 2076 616c 7565 7320 6573  ualize values es
-00035660: 7469 6d61 7465 6420 6279 204f 5045 2065  timated by OPE e
-00035670: 7374 696d 6174 6f72 7320 6163 726f 7373  stimators across
-00035680: 206d 756c 7469 706c 6520 6c6f 6767 6564   multiple logged
-00035690: 2064 6174 6173 6574 2e0a 0a20 2020 2020   dataset...     
-000356a0: 2020 204e 6f74 650a 2020 2020 2020 2020     Note.        
-000356b0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-000356c0: 5468 6973 2066 756e 6374 696f 6e20 6973  This function is
-000356d0: 2061 7070 6c69 6361 626c 6520 6f6e 6c79   applicable only
-000356e0: 2077 6865 6e20 4d75 6c74 6970 6c65 4c6f   when MultipleLo
-000356f0: 6767 6564 4461 7461 7365 7420 6973 2075  ggedDataset is u
-00035700: 7365 6420 616e 640a 2020 2020 2020 2020  sed and.        
-00035710: 4d75 6c74 6970 6c65 496e 7075 7444 6963  MultipleInputDic
-00035720: 7420 6973 2063 6f6c 6c65 6374 6564 2062  t is collected b
-00035730: 7920 7468 6520 7361 6d65 2065 7661 6c75  y the same evalu
-00035740: 6174 696f 6e20 706f 6c69 6379 2061 6372  ation policy acr
-00035750: 6f73 7320 6c6f 6767 6564 2064 6174 6173  oss logged datas
-00035760: 6574 732e 0a0a 2020 2020 2020 2020 5061  ets...        Pa
-00035770: 7261 6d65 7465 7273 0a20 2020 2020 2020  rameters.       
-00035780: 202d 2d2d 2d2d 2d2d 0a20 2020 2020 2020   -------.       
-00035790: 2069 6e70 7574 5f64 6963 743a 204d 756c   input_dict: Mul
-000357a0: 7469 706c 6549 6e70 7574 4469 6374 0a20  tipleInputDict. 
-000357b0: 2020 2020 2020 2020 2020 2044 6963 7469             Dicti
-000357c0: 6f6e 6172 7920 6f66 2074 6865 204f 5045  onary of the OPE
-000357d0: 2069 6e70 7574 7320 666f 7220 6561 6368   inputs for each
-000357e0: 2065 7661 6c75 6174 696f 6e20 706f 6c69   evaluation poli
-000357f0: 6379 2e0a 0a20 2020 2020 2020 2020 2020  cy...           
-00035800: 202e 2e20 636f 6465 2d62 6c6f 636b 3a3a   .. code-block::
-00035810: 2070 7974 686f 6e0a 0a20 2020 2020 2020   python..       
-00035820: 2020 2020 2020 2020 206b 6579 3a20 5b65           key: [e
-00035830: 7661 6c75 6174 696f 6e5f 706f 6c69 6379  valuation_policy
-00035840: 5d5b 0a20 2020 2020 2020 2020 2020 2020  ][.             
-00035850: 2020 2020 2020 2065 7661 6c75 6174 696f         evaluatio
-00035860: 6e5f 706f 6c69 6379 5f61 6374 696f 6e2c  n_policy_action,
-00035870: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00035880: 2020 2020 2065 7661 6c75 6174 696f 6e5f       evaluation_
-00035890: 706f 6c69 6379 5f61 6374 696f 6e5f 6469  policy_action_di
-000358a0: 7374 2c0a 2020 2020 2020 2020 2020 2020  st,.            
-000358b0: 2020 2020 2020 2020 7374 6174 655f 6163          state_ac
-000358c0: 7469 6f6e 5f76 616c 7565 5f70 7265 6469  tion_value_predi
-000358d0: 6374 696f 6e2c 0a20 2020 2020 2020 2020  ction,.         
-000358e0: 2020 2020 2020 2020 2020 2069 6e69 7469             initi
-000358f0: 616c 5f73 7461 7465 5f76 616c 7565 5f70  al_state_value_p
-00035900: 7265 6469 6374 696f 6e2c 0a20 2020 2020  rediction,.     
-00035910: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00035920: 7461 7465 5f61 6374 696f 6e5f 6d61 7267  tate_action_marg
-00035930: 696e 616c 5f69 6d70 6f72 7461 6e63 655f  inal_importance_
-00035940: 7765 6967 6874 2c0a 2020 2020 2020 2020  weight,.        
-00035950: 2020 2020 2020 2020 2020 2020 7374 6174              stat
-00035960: 655f 6d61 7267 696e 616c 5f69 6d70 6f72  e_marginal_impor
-00035970: 7461 6e63 655f 7765 6967 6874 2c0a 2020  tance_weight,.  
-00035980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00035990: 2020 6f6e 5f70 6f6c 6963 795f 706f 6c69    on_policy_poli
-000359a0: 6379 5f76 616c 7565 2c0a 2020 2020 2020  cy_value,.      
-000359b0: 2020 2020 2020 2020 2020 2020 2020 6761                ga
-000359c0: 6d6d 612c 0a20 2020 2020 2020 2020 2020  mma,.           
-000359d0: 2020 2020 2020 2020 2062 6568 6176 696f           behavio
-000359e0: 725f 706f 6c69 6379 2c0a 2020 2020 2020  r_policy,.      
-000359f0: 2020 2020 2020 2020 2020 2020 2020 6576                ev
-00035a00: 616c 7561 7469 6f6e 5f70 6f6c 6963 792c  aluation_policy,
-00035a10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00035a20: 2020 2020 2064 6174 6173 6574 5f69 642c       dataset_id,
-00035a30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00035a40: 205d 0a0a 2020 2020 2020 2020 2020 2020   ]..            
-00035a50: 2e2e 2073 6565 616c 736f 3a3a 0a0a 2020  .. seealso::..  
-00035a60: 2020 2020 2020 2020 2020 2020 2020 3a63                :c
-00035a70: 6c61 7373 3a60 7363 6f70 655f 726c 2e6f  lass:`scope_rl.o
-00035a80: 7065 2e69 6e70 7574 2e43 7265 6174 654f  pe.input.CreateO
-00035a90: 5045 496e 7075 7460 2064 6573 6372 6962  PEInput` describ
-00035aa0: 6573 2074 6865 2063 6f6d 706f 6e65 6e74  es the component
-00035ab0: 7320 6f66 203a 636c 6173 733a 6069 6e70  s of :class:`inp
-00035ac0: 7574 5f64 6963 7460 2e0a 0a20 2020 2020  ut_dict`...     
-00035ad0: 2020 2065 7374 696d 6174 696f 6e5f 6469     estimation_di
-00035ae0: 6374 3a20 6469 6374 0a20 2020 2020 2020  ct: dict.       
-00035af0: 2020 2020 2044 6963 7469 6f6e 6172 7920       Dictionary 
-00035b00: 636f 6e74 6169 6e69 6e67 2065 7374 696d  containing estim
-00035b10: 6174 696f 6e20 7265 7375 6c74 206f 6620  ation result of 
-00035b20: 4f50 452e 206b 6579 3a20 6060 5b65 7661  OPE. key: ``[eva
-00035b30: 6c5f 706f 6c69 6379 5d5b 6573 7469 6d61  l_policy][estima
-00035b40: 746f 725d 6060 0a0a 2020 2020 2020 2020  tor]``..        
-00035b50: 636f 6d70 6172 6564 5f65 7374 696d 6174  compared_estimat
-00035b60: 6f72 733a 206c 6973 7420 6f66 2073 7472  ors: list of str
-00035b70: 2c20 6465 6661 756c 743d 4e6f 6e65 0a20  , default=None. 
-00035b80: 2020 2020 2020 2020 2020 204e 616d 6520             Name 
-00035b90: 6f66 2063 6f6d 7061 7265 6420 6573 7469  of compared esti
-00035ba0: 6d61 746f 7273 2e0a 2020 2020 2020 2020  mators..        
-00035bb0: 2020 2020 4966 2060 4e6f 6e65 6020 6973      If `None` is
-00035bc0: 2067 6976 656e 2c20 616c 6c20 7468 6520   given, all the 
-00035bd0: 6573 7469 6d61 746f 7273 2061 7265 2063  estimators are c
-00035be0: 6f6d 7061 7265 642e 0a0a 2020 2020 2020  ompared...      
-00035bf0: 2020 6265 6861 7669 6f72 5f70 6f6c 6963    behavior_polic
-00035c00: 795f 6e61 6d65 3a20 7374 722c 2064 6566  y_name: str, def
-00035c10: 6175 6c74 3d4e 6f6e 650a 2020 2020 2020  ault=None.      
-00035c20: 2020 2020 2020 4e61 6d65 206f 6620 7468        Name of th
-00035c30: 6520 6265 6861 7669 6f72 2070 6f6c 6963  e behavior polic
-00035c40: 792e 0a0a 2020 2020 2020 2020 706c 6f74  y...        plot
-00035c50: 5f74 7970 653a 207b 2263 6922 2c20 2273  _type: {"ci", "s
-00035c60: 6361 7474 6572 222c 2022 7669 6f6c 696e  catter", "violin
-00035c70: 227d 2c20 6465 6661 756c 743d 2263 6922  "}, default="ci"
-00035c80: 0a20 2020 2020 2020 2020 2020 2054 7970  .            Typ
-00035c90: 6520 6f66 2070 6c6f 742e 0a20 2020 2020  e of plot..     
-00035ca0: 2020 2020 2020 2049 6620 2263 6922 2069         If "ci" i
-00035cb0: 7320 6769 7665 6e2c 2077 6520 6765 7420  s given, we get 
-00035cc0: 7468 6520 656d 7069 7269 6361 6c20 6176  the empirical av
-00035cd0: 6572 6167 6520 6f66 2074 6865 2065 7374  erage of the est
-00035ce0: 696d 6174 6564 2076 616c 7565 7320 7769  imated values wi
-00035cf0: 7468 2074 6865 6972 2065 7374 696d 6174  th their estimat
-00035d00: 6564 2063 6f6e 6669 6465 6e63 6520 696e  ed confidence in
-00035d10: 7465 7276 616c 732e 0a20 2020 2020 2020  tervals..       
-00035d20: 2020 2020 2049 6620 2273 6361 7474 6572       If "scatter
-00035d30: 2220 6973 2067 6976 656e 2c20 7765 2067  " is given, we g
-00035d40: 6574 2061 2073 6361 7474 6572 2070 6c6f  et a scatter plo
-00035d50: 7420 6f66 2065 7374 696d 6174 6564 2076  t of estimated v
-00035d60: 616c 7565 732e 0a0a 2020 2020 2020 2020  alues...        
-00035d70: 6875 653a 207b 2265 7374 696d 6174 6f72  hue: {"estimator
-00035d80: 222c 2022 706f 6c69 6379 227d 2c20 6465  ", "policy"}, de
-00035d90: 6661 756c 743d 2265 7374 696d 6174 6f72  fault="estimator
-00035da0: 220a 2020 2020 2020 2020 2020 2020 4875  ".            Hu
-00035db0: 6520 6f66 2074 6865 2070 6c6f 742e 0a0a  e of the plot...
-00035dc0: 2020 2020 2020 2020 6c65 6765 6e64 3a20          legend: 
-00035dd0: 626f 6f6c 2c20 6465 6661 756c 743d 5472  bool, default=Tr
-00035de0: 7565 0a20 2020 2020 2020 2020 2020 2057  ue.            W
-00035df0: 6865 7468 6572 2074 6f20 696e 636c 7564  hether to includ
-00035e00: 6520 6120 6c65 6765 6e64 2069 6e20 7468  e a legend in th
-00035e10: 6520 7363 6174 7465 7220 706c 6f74 2e0a  e scatter plot..
-00035e20: 0a20 2020 2020 2020 2073 6861 7265 793a  .        sharey:
-00035e30: 2062 6f6f 6c2c 2064 6566 6175 6c74 3d46   bool, default=F
-00035e40: 616c 7365 0a20 2020 2020 2020 2020 2020  alse.           
-00035e50: 2049 6620 6054 7275 6560 2c20 7468 6520   If `True`, the 
-00035e60: 792d 6178 6973 2077 696c 6c20 6265 2073  y-axis will be s
-00035e70: 6861 7265 6420 616d 6f6e 6720 6469 6666  hared among diff
-00035e80: 6572 656e 7420 6573 7469 6d61 746f 7273  erent estimators
-00035e90: 206f 7220 6576 616c 7561 7469 6f6e 2070   or evaluation p
-00035ea0: 6f6c 6963 6965 732e 0a0a 2020 2020 2020  olicies...      
-00035eb0: 2020 796c 6162 656c 3a20 7374 722c 2064    ylabel: str, d
-00035ec0: 6566 6175 6c74 3d22 4573 7469 6d61 7465  efault="Estimate
-00035ed0: 6420 5065 7266 6f72 6d61 6e63 6522 0a20  d Performance". 
-00035ee0: 2020 2020 2020 2020 2020 204c 6162 656c             Label
-00035ef0: 206f 6620 7468 6520 792d 6178 6973 2e0a   of the y-axis..
-00035f00: 0a20 2020 2020 2020 2066 6967 5f64 6972  .        fig_dir
-00035f10: 3a20 5061 7468 2c20 6465 6661 756c 743d  : Path, default=
-00035f20: 4e6f 6e65 0a20 2020 2020 2020 2020 2020  None.           
-00035f30: 2050 6174 6820 746f 2073 746f 7265 2074   Path to store t
-00035f40: 6865 2062 6172 2066 6967 7572 652e 0a20  he bar figure.. 
-00035f50: 2020 2020 2020 2020 2020 2049 6620 604e             If `N
-00035f60: 6f6e 6560 2069 7320 6769 7665 6e2c 2074  one` is given, t
-00035f70: 6865 2066 6967 7572 6520 7769 6c6c 206e  he figure will n
-00035f80: 6f74 2062 6520 7361 7665 642e 0a0a 2020  ot be saved...  
-00035f90: 2020 2020 2020 6669 675f 6e61 6d65 3a20        fig_name: 
-00035fa0: 7374 722c 2064 6566 6175 6c74 3d4e 6f6e  str, default=Non
-00035fb0: 650a 2020 2020 2020 2020 2020 2020 4e61  e.            Na
-00035fc0: 6d65 206f 6620 7468 6520 6261 7220 6669  me of the bar fi
-00035fd0: 6775 7265 2e0a 0a20 2020 2020 2020 2022  gure...        "
-00035fe0: 2222 0a20 2020 2020 2020 2070 6c74 2e73  "".        plt.s
-00035ff0: 7479 6c65 2e75 7365 2822 6767 706c 6f74  tyle.use("ggplot
-00036000: 2229 0a20 2020 2020 2020 2063 6f6c 6f72  ").        color
-00036010: 203d 2070 6c74 2e72 6350 6172 616d 735b   = plt.rcParams[
-00036020: 2261 7865 732e 7072 6f70 5f63 7963 6c65  "axes.prop_cycle
-00036030: 225d 2e62 795f 6b65 7928 295b 2263 6f6c  "].by_key()["col
-00036040: 6f72 225d 0a20 2020 2020 2020 206e 5f63  or"].        n_c
-00036050: 6f6c 6f72 7320 3d20 6c65 6e28 636f 6c6f  olors = len(colo
-00036060: 7229 0a0a 2020 2020 2020 2020 6265 6861  r)..        beha
-00036070: 7669 6f72 5f70 6f6c 6963 795f 6e61 6d65  vior_policy_name
-00036080: 7320 3d20 696e 7075 745f 6469 6374 2e62  s = input_dict.b
-00036090: 6568 6176 696f 725f 706f 6c69 6379 5f6e  ehavior_policy_n
-000360a0: 616d 6573 0a20 2020 2020 2020 2069 6620  ames.        if 
-000360b0: 6265 6861 7669 6f72 5f70 6f6c 6963 795f  behavior_policy_
-000360c0: 6e61 6d65 2069 7320 4e6f 6e65 3a0a 2020  name is None:.  
-000360d0: 2020 2020 2020 2020 2020 696e 7075 745f            input_
-000360e0: 6469 6374 5f30 203d 2069 6e70 7574 5f64  dict_0 = input_d
-000360f0: 6963 742e 6765 7428 0a20 2020 2020 2020  ict.get(.       
-00036100: 2020 2020 2020 2020 2062 6568 6176 696f           behavio
-00036110: 725f 706f 6c69 6379 5f6e 616d 653d 6265  r_policy_name=be
-00036120: 6861 7669 6f72 5f70 6f6c 6963 795f 6e61  havior_policy_na
-00036130: 6d65 735b 305d 2c20 6461 7461 7365 745f  mes[0], dataset_
-00036140: 6964 3d30 0a20 2020 2020 2020 2020 2020  id=0.           
-00036150: 2029 0a20 2020 2020 2020 2065 6c73 653a   ).        else:
-00036160: 0a20 2020 2020 2020 2020 2020 2069 6e70  .            inp
-00036170: 7574 5f64 6963 745f 3020 3d20 696e 7075  ut_dict_0 = inpu
-00036180: 745f 6469 6374 2e67 6574 280a 2020 2020  t_dict.get(.    
-00036190: 2020 2020 2020 2020 2020 2020 6265 6861              beha
-000361a0: 7669 6f72 5f70 6f6c 6963 795f 6e61 6d65  vior_policy_name
-000361b0: 3d62 6568 6176 696f 725f 706f 6c69 6379  =behavior_policy
-000361c0: 5f6e 616d 652c 2064 6174 6173 6574 5f69  _name, dataset_i
-000361d0: 643d 300a 2020 2020 2020 2020 2020 2020  d=0.            
-000361e0: 290a 0a20 2020 2020 2020 206e 5f65 7661  )..        n_eva
-000361f0: 6c5f 706f 6c69 6369 6573 203d 206c 656e  l_policies = len
-00036200: 2869 6e70 7574 5f64 6963 745f 3029 0a20  (input_dict_0). 
-00036210: 2020 2020 2020 206e 5f65 7374 696d 6174         n_estimat
-00036220: 6f72 7320 3d20 6c65 6e28 636f 6d70 6172  ors = len(compar
-00036230: 6564 5f65 7374 696d 6174 6f72 7329 0a0a  ed_estimators)..
-00036240: 2020 2020 2020 2020 6966 2062 6568 6176          if behav
-00036250: 696f 725f 706f 6c69 6379 5f6e 616d 6520  ior_policy_name 
-00036260: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
-00036270: 2020 2020 2070 616c 6574 7465 203d 207b       palette = {
-00036280: 7d0a 2020 2020 2020 2020 2020 2020 666f  }.            fo
-00036290: 7220 6a2c 2062 6568 6176 696f 725f 706f  r j, behavior_po
-000362a0: 6c69 6379 2069 6e20 656e 756d 6572 6174  licy in enumerat
-000362b0: 6528 6265 6861 7669 6f72 5f70 6f6c 6963  e(behavior_polic
-000362c0: 795f 6e61 6d65 7329 3a0a 2020 2020 2020  y_names):.      
-000362d0: 2020 2020 2020 2020 2020 7061 6c65 7474            palett
-000362e0: 655b 6265 6861 7669 6f72 5f70 6f6c 6963  e[behavior_polic
-000362f0: 795d 203d 2063 6f6c 6f72 5b6a 2025 206e  y] = color[j % n
-00036300: 5f63 6f6c 6f72 735d 0a0a 2020 2020 2020  _colors]..      
-00036310: 2020 2020 2020 6966 2068 7565 203d 3d20        if hue == 
-00036320: 2265 7374 696d 6174 6f72 223a 0a20 2020  "estimator":.   
-00036330: 2020 2020 2020 2020 2020 2020 2066 6967               fig
-00036340: 203d 2070 6c74 2e66 6967 7572 6528 6669   = plt.figure(fi
-00036350: 6773 697a 653d 2832 202a 206e 5f65 7374  gsize=(2 * n_est
-00036360: 696d 6174 6f72 732c 2034 202a 206e 5f65  imators, 4 * n_e
-00036370: 7661 6c5f 706f 6c69 6369 6573 2929 0a0a  val_policies))..
+000350b0: 2020 6d65 616e 5b6a 5d2c 0a20 2020 2020    mean[j],.     
+000350c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000350d0: 2020 2063 6f6c 6f72 3d63 6f6c 6f72 5b6a     color=color[j
+000350e0: 2025 206e 5f63 6f6c 6f72 735d 2c0a 2020   % n_colors],.  
+000350f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035100: 2020 2020 2020 666d 743d 226f 222c 0a20        fmt="o",. 
+00035110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035120: 2020 2020 2020 206d 6172 6b65 7273 697a         markersiz
+00035130: 653d 3130 2e30 2c0a 2020 2020 2020 2020  e=10.0,.        
+00035140: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+00035150: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+00035160: 782e 7365 745f 7469 746c 6528 6573 7469  x.set_title(esti
+00035170: 6d61 746f 722c 2066 6f6e 7473 697a 653d  mator, fontsize=
+00035180: 3136 290a 2020 2020 2020 2020 2020 2020  16).            
+00035190: 2020 2020 6178 2e73 6574 5f79 6c61 6265      ax.set_ylabe
+000351a0: 6c28 0a20 2020 2020 2020 2020 2020 2020  l(.             
+000351b0: 2020 2020 2020 2066 2245 7374 696d 6174         f"Estimat
+000351c0: 6564 207b 6e70 2e69 6e74 3634 2831 3030  ed {np.int64(100
+000351d0: 2a28 3120 2d20 616c 7068 6129 297d 2520  *(1 - alpha))}% 
+000351e0: 496e 7465 7271 7561 7274 696c 6520 5261  Interquartile Ra
+000351f0: 6e67 6522 2c0a 2020 2020 2020 2020 2020  nge",.          
+00035200: 2020 2020 2020 2020 2020 666f 6e74 7369            fontsi
+00035210: 7a65 3d31 322c 0a20 2020 2020 2020 2020  ze=12,.         
+00035220: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00035230: 2020 2020 2020 2020 2070 6c74 2e79 7469           plt.yti
+00035240: 636b 7328 666f 6e74 7369 7a65 3d31 3229  cks(fontsize=12)
+00035250: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00035260: 2070 6c74 2e78 7469 636b 7328 666f 6e74   plt.xticks(font
+00035270: 7369 7a65 3d31 3229 0a20 2020 2020 2020  size=12).       
+00035280: 2020 2020 2020 2020 2070 6c74 2e78 6c69           plt.xli
+00035290: 6d28 2d30 2e35 2c20 6e5f 706f 6c69 6369  m(-0.5, n_polici
+000352a0: 6573 202d 2030 2e35 290a 0a20 2020 2020  es - 0.5)..     
+000352b0: 2020 2066 6967 2e73 7562 706c 6f74 735f     fig.subplots_
+000352c0: 6164 6a75 7374 2874 6f70 3d31 2e30 290a  adjust(top=1.0).
+000352d0: 2020 2020 2020 2020 706c 742e 7368 6f77          plt.show
+000352e0: 2829 0a0a 2020 2020 2020 2020 6966 2066  ()..        if f
+000352f0: 6967 5f64 6972 3a0a 2020 2020 2020 2020  ig_dir:.        
+00035300: 2020 2020 6669 672e 7361 7665 6669 6728      fig.savefig(
+00035310: 7374 7228 6669 675f 6469 7220 2f20 6669  str(fig_dir / fi
+00035320: 675f 6e61 6d65 292c 2064 7069 3d33 3030  g_name), dpi=300
+00035330: 2c20 6262 6f78 5f69 6e63 6865 733d 2274  , bbox_inches="t
+00035340: 6967 6874 2229 0a0a 2020 2020 6465 6620  ight")..    def 
+00035350: 5f76 6973 7561 6c69 7a65 5f6f 6666 5f70  _visualize_off_p
+00035360: 6f6c 6963 795f 6573 7469 6d61 7465 735f  olicy_estimates_
+00035370: 7769 7468 5f6d 756c 7469 706c 655f 6573  with_multiple_es
+00035380: 7469 6d61 7465 7328 0a20 2020 2020 2020  timates(.       
+00035390: 2073 656c 662c 0a20 2020 2020 2020 2069   self,.        i
+000353a0: 6e70 7574 5f64 6963 743a 204d 756c 7469  nput_dict: Multi
+000353b0: 706c 6549 6e70 7574 4469 6374 2c0a 2020  pleInputDict,.  
+000353c0: 2020 2020 2020 6573 7469 6d61 7469 6f6e        estimation
+000353d0: 5f64 6963 743a 2044 6963 745b 7374 722c  _dict: Dict[str,
+000353e0: 2044 6963 745b 7374 722c 206e 702e 6e64   Dict[str, np.nd
+000353f0: 6172 7261 795d 5d2c 0a20 2020 2020 2020  array]],.       
+00035400: 2063 6f6d 7061 7265 645f 6573 7469 6d61   compared_estima
+00035410: 746f 7273 3a20 4f70 7469 6f6e 616c 5b4c  tors: Optional[L
+00035420: 6973 745b 7374 725d 5d20 3d20 4e6f 6e65  ist[str]] = None
+00035430: 2c0a 2020 2020 2020 2020 6265 6861 7669  ,.        behavi
+00035440: 6f72 5f70 6f6c 6963 795f 6e61 6d65 3a20  or_policy_name: 
+00035450: 4f70 7469 6f6e 616c 5b73 7472 5d20 3d20  Optional[str] = 
+00035460: 4e6f 6e65 2c0a 2020 2020 2020 2020 706c  None,.        pl
+00035470: 6f74 5f74 7970 653a 2073 7472 203d 2022  ot_type: str = "
+00035480: 6369 222c 0a20 2020 2020 2020 2068 7565  ci",.        hue
+00035490: 3a20 7374 7220 3d20 2265 7374 696d 6174  : str = "estimat
+000354a0: 6f72 222c 0a20 2020 2020 2020 206c 6567  or",.        leg
+000354b0: 656e 643a 2062 6f6f 6c20 3d20 5472 7565  end: bool = True
+000354c0: 2c0a 2020 2020 2020 2020 7368 6172 6579  ,.        sharey
+000354d0: 3a20 626f 6f6c 203d 2046 616c 7365 2c0a  : bool = False,.
+000354e0: 2020 2020 2020 2020 796c 6162 656c 3a20          ylabel: 
+000354f0: 7374 7220 3d20 2245 7374 696d 6174 6564  str = "Estimated
+00035500: 2050 6572 666f 726d 616e 6365 222c 0a20   Performance",. 
+00035510: 2020 2020 2020 2066 6967 5f64 6972 3a20         fig_dir: 
+00035520: 4f70 7469 6f6e 616c 5b50 6174 685d 203d  Optional[Path] =
+00035530: 204e 6f6e 652c 0a20 2020 2020 2020 2066   None,.        f
+00035540: 6967 5f6e 616d 653a 204f 7074 696f 6e61  ig_name: Optiona
+00035550: 6c5b 7374 725d 203d 204e 6f6e 652c 0a20  l[str] = None,. 
+00035560: 2020 2029 202d 3e20 4e6f 6e65 3a0a 2020     ) -> None:.  
+00035570: 2020 2020 2020 2222 2256 6973 7561 6c69        """Visuali
+00035580: 7a65 2076 616c 7565 7320 6573 7469 6d61  ze values estima
+00035590: 7465 6420 6279 204f 5045 2065 7374 696d  ted by OPE estim
+000355a0: 6174 6f72 7320 6163 726f 7373 206d 756c  ators across mul
+000355b0: 7469 706c 6520 6c6f 6767 6564 2064 6174  tiple logged dat
+000355c0: 6173 6574 2e0a 0a20 2020 2020 2020 204e  aset...        N
+000355d0: 6f74 650a 2020 2020 2020 2020 2d2d 2d2d  ote.        ----
+000355e0: 2d2d 2d0a 2020 2020 2020 2020 5468 6973  ---.        This
+000355f0: 2066 756e 6374 696f 6e20 6973 2061 7070   function is app
+00035600: 6c69 6361 626c 6520 6f6e 6c79 2077 6865  licable only whe
+00035610: 6e20 4d75 6c74 6970 6c65 4c6f 6767 6564  n MultipleLogged
+00035620: 4461 7461 7365 7420 6973 2075 7365 6420  Dataset is used 
+00035630: 616e 640a 2020 2020 2020 2020 4d75 6c74  and.        Mult
+00035640: 6970 6c65 496e 7075 7444 6963 7420 6973  ipleInputDict is
+00035650: 2063 6f6c 6c65 6374 6564 2062 7920 7468   collected by th
+00035660: 6520 7361 6d65 2065 7661 6c75 6174 696f  e same evaluatio
+00035670: 6e20 706f 6c69 6379 2061 6372 6f73 7320  n policy across 
+00035680: 6c6f 6767 6564 2064 6174 6173 6574 732e  logged datasets.
+00035690: 0a0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
+000356a0: 7465 7273 0a20 2020 2020 2020 202d 2d2d  ters.        ---
+000356b0: 2d2d 2d2d 0a20 2020 2020 2020 2069 6e70  ----.        inp
+000356c0: 7574 5f64 6963 743a 204d 756c 7469 706c  ut_dict: Multipl
+000356d0: 6549 6e70 7574 4469 6374 0a20 2020 2020  eInputDict.     
+000356e0: 2020 2020 2020 2044 6963 7469 6f6e 6172         Dictionar
+000356f0: 7920 6f66 2074 6865 204f 5045 2069 6e70  y of the OPE inp
+00035700: 7574 7320 666f 7220 6561 6368 2065 7661  uts for each eva
+00035710: 6c75 6174 696f 6e20 706f 6c69 6379 2e0a  luation policy..
+00035720: 0a20 2020 2020 2020 2020 2020 202e 2e20  .            .. 
+00035730: 636f 6465 2d62 6c6f 636b 3a3a 2070 7974  code-block:: pyt
+00035740: 686f 6e0a 0a20 2020 2020 2020 2020 2020  hon..           
+00035750: 2020 2020 206b 6579 3a20 5b65 7661 6c75       key: [evalu
+00035760: 6174 696f 6e5f 706f 6c69 6379 5d5b 0a20  ation_policy][. 
+00035770: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035780: 2020 2065 7661 6c75 6174 696f 6e5f 706f     evaluation_po
+00035790: 6c69 6379 5f61 6374 696f 6e2c 0a20 2020  licy_action,.   
+000357a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000357b0: 2065 7661 6c75 6174 696f 6e5f 706f 6c69   evaluation_poli
+000357c0: 6379 5f61 6374 696f 6e5f 6469 7374 2c0a  cy_action_dist,.
+000357d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000357e0: 2020 2020 7374 6174 655f 6163 7469 6f6e      state_action
+000357f0: 5f76 616c 7565 5f70 7265 6469 6374 696f  _value_predictio
+00035800: 6e2c 0a20 2020 2020 2020 2020 2020 2020  n,.             
+00035810: 2020 2020 2020 2069 6e69 7469 616c 5f73         initial_s
+00035820: 7461 7465 5f76 616c 7565 5f70 7265 6469  tate_value_predi
+00035830: 6374 696f 6e2c 0a20 2020 2020 2020 2020  ction,.         
+00035840: 2020 2020 2020 2020 2020 2073 7461 7465             state
+00035850: 5f61 6374 696f 6e5f 6d61 7267 696e 616c  _action_marginal
+00035860: 5f69 6d70 6f72 7461 6e63 655f 7765 6967  _importance_weig
+00035870: 6874 2c0a 2020 2020 2020 2020 2020 2020  ht,.            
+00035880: 2020 2020 2020 2020 7374 6174 655f 6d61          state_ma
+00035890: 7267 696e 616c 5f69 6d70 6f72 7461 6e63  rginal_importanc
+000358a0: 655f 7765 6967 6874 2c0a 2020 2020 2020  e_weight,.      
+000358b0: 2020 2020 2020 2020 2020 2020 2020 6f6e                on
+000358c0: 5f70 6f6c 6963 795f 706f 6c69 6379 5f76  _policy_policy_v
+000358d0: 616c 7565 2c0a 2020 2020 2020 2020 2020  alue,.          
+000358e0: 2020 2020 2020 2020 2020 6761 6d6d 612c            gamma,
+000358f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00035900: 2020 2020 2062 6568 6176 696f 725f 706f       behavior_po
+00035910: 6c69 6379 2c0a 2020 2020 2020 2020 2020  licy,.          
+00035920: 2020 2020 2020 2020 2020 6576 616c 7561            evalua
+00035930: 7469 6f6e 5f70 6f6c 6963 792c 0a20 2020  tion_policy,.   
+00035940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035950: 2064 6174 6173 6574 5f69 642c 0a20 2020   dataset_id,.   
+00035960: 2020 2020 2020 2020 2020 2020 205d 0a0a               ]..
+00035970: 2020 2020 2020 2020 2020 2020 2e2e 2073              .. s
+00035980: 6565 616c 736f 3a3a 0a0a 2020 2020 2020  eealso::..      
+00035990: 2020 2020 2020 2020 2020 3a63 6c61 7373            :class
+000359a0: 3a60 7363 6f70 655f 726c 2e6f 7065 2e69  :`scope_rl.ope.i
+000359b0: 6e70 7574 2e43 7265 6174 654f 5045 496e  nput.CreateOPEIn
+000359c0: 7075 7460 2064 6573 6372 6962 6573 2074  put` describes t
+000359d0: 6865 2063 6f6d 706f 6e65 6e74 7320 6f66  he components of
+000359e0: 203a 636c 6173 733a 6069 6e70 7574 5f64   :class:`input_d
+000359f0: 6963 7460 2e0a 0a20 2020 2020 2020 2065  ict`...        e
+00035a00: 7374 696d 6174 696f 6e5f 6469 6374 3a20  stimation_dict: 
+00035a10: 6469 6374 0a20 2020 2020 2020 2020 2020  dict.           
+00035a20: 2044 6963 7469 6f6e 6172 7920 636f 6e74   Dictionary cont
+00035a30: 6169 6e69 6e67 2065 7374 696d 6174 696f  aining estimatio
+00035a40: 6e20 7265 7375 6c74 206f 6620 4f50 452e  n result of OPE.
+00035a50: 206b 6579 3a20 6060 5b65 7661 6c5f 706f   key: ``[eval_po
+00035a60: 6c69 6379 5d5b 6573 7469 6d61 746f 725d  licy][estimator]
+00035a70: 6060 0a0a 2020 2020 2020 2020 636f 6d70  ``..        comp
+00035a80: 6172 6564 5f65 7374 696d 6174 6f72 733a  ared_estimators:
+00035a90: 206c 6973 7420 6f66 2073 7472 2c20 6465   list of str, de
+00035aa0: 6661 756c 743d 4e6f 6e65 0a20 2020 2020  fault=None.     
+00035ab0: 2020 2020 2020 204e 616d 6520 6f66 2063         Name of c
+00035ac0: 6f6d 7061 7265 6420 6573 7469 6d61 746f  ompared estimato
+00035ad0: 7273 2e0a 2020 2020 2020 2020 2020 2020  rs..            
+00035ae0: 4966 2060 4e6f 6e65 6020 6973 2067 6976  If `None` is giv
+00035af0: 656e 2c20 616c 6c20 7468 6520 6573 7469  en, all the esti
+00035b00: 6d61 746f 7273 2061 7265 2063 6f6d 7061  mators are compa
+00035b10: 7265 642e 0a0a 2020 2020 2020 2020 6265  red...        be
+00035b20: 6861 7669 6f72 5f70 6f6c 6963 795f 6e61  havior_policy_na
+00035b30: 6d65 3a20 7374 722c 2064 6566 6175 6c74  me: str, default
+00035b40: 3d4e 6f6e 650a 2020 2020 2020 2020 2020  =None.          
+00035b50: 2020 4e61 6d65 206f 6620 7468 6520 6265    Name of the be
+00035b60: 6861 7669 6f72 2070 6f6c 6963 792e 0a0a  havior policy...
+00035b70: 2020 2020 2020 2020 706c 6f74 5f74 7970          plot_typ
+00035b80: 653a 207b 2263 6922 2c20 2273 6361 7474  e: {"ci", "scatt
+00035b90: 6572 222c 2022 7669 6f6c 696e 227d 2c20  er", "violin"}, 
+00035ba0: 6465 6661 756c 743d 2263 6922 0a20 2020  default="ci".   
+00035bb0: 2020 2020 2020 2020 2054 7970 6520 6f66           Type of
+00035bc0: 2070 6c6f 742e 0a20 2020 2020 2020 2020   plot..         
+00035bd0: 2020 2049 6620 2263 6922 2069 7320 6769     If "ci" is gi
+00035be0: 7665 6e2c 2077 6520 6765 7420 7468 6520  ven, we get the 
+00035bf0: 656d 7069 7269 6361 6c20 6176 6572 6167  empirical averag
+00035c00: 6520 6f66 2074 6865 2065 7374 696d 6174  e of the estimat
+00035c10: 6564 2076 616c 7565 7320 7769 7468 2074  ed values with t
+00035c20: 6865 6972 2065 7374 696d 6174 6564 2063  heir estimated c
+00035c30: 6f6e 6669 6465 6e63 6520 696e 7465 7276  onfidence interv
+00035c40: 616c 732e 0a20 2020 2020 2020 2020 2020  als..           
+00035c50: 2049 6620 2273 6361 7474 6572 2220 6973   If "scatter" is
+00035c60: 2067 6976 656e 2c20 7765 2067 6574 2061   given, we get a
+00035c70: 2073 6361 7474 6572 2070 6c6f 7420 6f66   scatter plot of
+00035c80: 2065 7374 696d 6174 6564 2076 616c 7565   estimated value
+00035c90: 732e 0a0a 2020 2020 2020 2020 6875 653a  s...        hue:
+00035ca0: 207b 2265 7374 696d 6174 6f72 222c 2022   {"estimator", "
+00035cb0: 706f 6c69 6379 227d 2c20 6465 6661 756c  policy"}, defaul
+00035cc0: 743d 2265 7374 696d 6174 6f72 220a 2020  t="estimator".  
+00035cd0: 2020 2020 2020 2020 2020 4875 6520 6f66            Hue of
+00035ce0: 2074 6865 2070 6c6f 742e 0a0a 2020 2020   the plot...    
+00035cf0: 2020 2020 6c65 6765 6e64 3a20 626f 6f6c      legend: bool
+00035d00: 2c20 6465 6661 756c 743d 5472 7565 0a20  , default=True. 
+00035d10: 2020 2020 2020 2020 2020 2057 6865 7468             Wheth
+00035d20: 6572 2074 6f20 696e 636c 7564 6520 6120  er to include a 
+00035d30: 6c65 6765 6e64 2069 6e20 7468 6520 7363  legend in the sc
+00035d40: 6174 7465 7220 706c 6f74 2e0a 0a20 2020  atter plot...   
+00035d50: 2020 2020 2073 6861 7265 793a 2062 6f6f       sharey: boo
+00035d60: 6c2c 2064 6566 6175 6c74 3d46 616c 7365  l, default=False
+00035d70: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
+00035d80: 6054 7275 6560 2c20 7468 6520 792d 6178  `True`, the y-ax
+00035d90: 6973 2077 696c 6c20 6265 2073 6861 7265  is will be share
+00035da0: 6420 616d 6f6e 6720 6469 6666 6572 656e  d among differen
+00035db0: 7420 6573 7469 6d61 746f 7273 206f 7220  t estimators or 
+00035dc0: 6576 616c 7561 7469 6f6e 2070 6f6c 6963  evaluation polic
+00035dd0: 6965 732e 0a0a 2020 2020 2020 2020 796c  ies...        yl
+00035de0: 6162 656c 3a20 7374 722c 2064 6566 6175  abel: str, defau
+00035df0: 6c74 3d22 4573 7469 6d61 7465 6420 5065  lt="Estimated Pe
+00035e00: 7266 6f72 6d61 6e63 6522 0a20 2020 2020  rformance".     
+00035e10: 2020 2020 2020 204c 6162 656c 206f 6620         Label of 
+00035e20: 7468 6520 792d 6178 6973 2e0a 0a20 2020  the y-axis...   
+00035e30: 2020 2020 2066 6967 5f64 6972 3a20 5061       fig_dir: Pa
+00035e40: 7468 2c20 6465 6661 756c 743d 4e6f 6e65  th, default=None
+00035e50: 0a20 2020 2020 2020 2020 2020 2050 6174  .            Pat
+00035e60: 6820 746f 2073 746f 7265 2074 6865 2062  h to store the b
+00035e70: 6172 2066 6967 7572 652e 0a20 2020 2020  ar figure..     
+00035e80: 2020 2020 2020 2049 6620 604e 6f6e 6560         If `None`
+00035e90: 2069 7320 6769 7665 6e2c 2074 6865 2066   is given, the f
+00035ea0: 6967 7572 6520 7769 6c6c 206e 6f74 2062  igure will not b
+00035eb0: 6520 7361 7665 642e 0a0a 2020 2020 2020  e saved...      
+00035ec0: 2020 6669 675f 6e61 6d65 3a20 7374 722c    fig_name: str,
+00035ed0: 2064 6566 6175 6c74 3d4e 6f6e 650a 2020   default=None.  
+00035ee0: 2020 2020 2020 2020 2020 4e61 6d65 206f            Name o
+00035ef0: 6620 7468 6520 6261 7220 6669 6775 7265  f the bar figure
+00035f00: 2e0a 0a20 2020 2020 2020 2022 2222 0a20  ...        """. 
+00035f10: 2020 2020 2020 2070 6c74 2e73 7479 6c65         plt.style
+00035f20: 2e75 7365 2822 6767 706c 6f74 2229 0a20  .use("ggplot"). 
+00035f30: 2020 2020 2020 2063 6f6c 6f72 203d 2070         color = p
+00035f40: 6c74 2e72 6350 6172 616d 735b 2261 7865  lt.rcParams["axe
+00035f50: 732e 7072 6f70 5f63 7963 6c65 225d 2e62  s.prop_cycle"].b
+00035f60: 795f 6b65 7928 295b 2263 6f6c 6f72 225d  y_key()["color"]
+00035f70: 0a20 2020 2020 2020 206e 5f63 6f6c 6f72  .        n_color
+00035f80: 7320 3d20 6c65 6e28 636f 6c6f 7229 0a0a  s = len(color)..
+00035f90: 2020 2020 2020 2020 6265 6861 7669 6f72          behavior
+00035fa0: 5f70 6f6c 6963 795f 6e61 6d65 7320 3d20  _policy_names = 
+00035fb0: 696e 7075 745f 6469 6374 2e62 6568 6176  input_dict.behav
+00035fc0: 696f 725f 706f 6c69 6379 5f6e 616d 6573  ior_policy_names
+00035fd0: 0a20 2020 2020 2020 2069 6620 6265 6861  .        if beha
+00035fe0: 7669 6f72 5f70 6f6c 6963 795f 6e61 6d65  vior_policy_name
+00035ff0: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
+00036000: 2020 2020 2020 696e 7075 745f 6469 6374        input_dict
+00036010: 5f30 203d 2069 6e70 7574 5f64 6963 742e  _0 = input_dict.
+00036020: 6765 7428 0a20 2020 2020 2020 2020 2020  get(.           
+00036030: 2020 2020 2062 6568 6176 696f 725f 706f       behavior_po
+00036040: 6c69 6379 5f6e 616d 653d 6265 6861 7669  licy_name=behavi
+00036050: 6f72 5f70 6f6c 6963 795f 6e61 6d65 735b  or_policy_names[
+00036060: 305d 2c20 6461 7461 7365 745f 6964 3d30  0], dataset_id=0
+00036070: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+00036080: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00036090: 2020 2020 2020 2020 2069 6e70 7574 5f64           input_d
+000360a0: 6963 745f 3020 3d20 696e 7075 745f 6469  ict_0 = input_di
+000360b0: 6374 2e67 6574 280a 2020 2020 2020 2020  ct.get(.        
+000360c0: 2020 2020 2020 2020 6265 6861 7669 6f72          behavior
+000360d0: 5f70 6f6c 6963 795f 6e61 6d65 3d62 6568  _policy_name=beh
+000360e0: 6176 696f 725f 706f 6c69 6379 5f6e 616d  avior_policy_nam
+000360f0: 652c 2064 6174 6173 6574 5f69 643d 300a  e, dataset_id=0.
+00036100: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+00036110: 2020 2020 2020 206e 5f65 7661 6c5f 706f         n_eval_po
+00036120: 6c69 6369 6573 203d 206c 656e 2869 6e70  licies = len(inp
+00036130: 7574 5f64 6963 745f 3029 0a20 2020 2020  ut_dict_0).     
+00036140: 2020 206e 5f65 7374 696d 6174 6f72 7320     n_estimators 
+00036150: 3d20 6c65 6e28 636f 6d70 6172 6564 5f65  = len(compared_e
+00036160: 7374 696d 6174 6f72 7329 0a0a 2020 2020  stimators)..    
+00036170: 2020 2020 6966 2062 6568 6176 696f 725f      if behavior_
+00036180: 706f 6c69 6379 5f6e 616d 6520 6973 204e  policy_name is N
+00036190: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+000361a0: 2070 616c 6574 7465 203d 207b 7d0a 2020   palette = {}.  
+000361b0: 2020 2020 2020 2020 2020 666f 7220 6a2c            for j,
+000361c0: 2062 6568 6176 696f 725f 706f 6c69 6379   behavior_policy
+000361d0: 2069 6e20 656e 756d 6572 6174 6528 6265   in enumerate(be
+000361e0: 6861 7669 6f72 5f70 6f6c 6963 795f 6e61  havior_policy_na
+000361f0: 6d65 7329 3a0a 2020 2020 2020 2020 2020  mes):.          
+00036200: 2020 2020 2020 7061 6c65 7474 655b 6265        palette[be
+00036210: 6861 7669 6f72 5f70 6f6c 6963 795d 203d  havior_policy] =
+00036220: 2063 6f6c 6f72 5b6a 2025 206e 5f63 6f6c   color[j % n_col
+00036230: 6f72 735d 0a0a 2020 2020 2020 2020 2020  ors]..          
+00036240: 2020 6966 2068 7565 203d 3d20 2265 7374    if hue == "est
+00036250: 696d 6174 6f72 223a 0a20 2020 2020 2020  imator":.       
+00036260: 2020 2020 2020 2020 2066 6967 203d 2070           fig = p
+00036270: 6c74 2e66 6967 7572 6528 6669 6773 697a  lt.figure(figsiz
+00036280: 653d 2832 202a 206e 5f65 7374 696d 6174  e=(2 * n_estimat
+00036290: 6f72 732c 2034 202a 206e 5f65 7661 6c5f  ors, 4 * n_eval_
+000362a0: 706f 6c69 6369 6573 2929 0a0a 2020 2020  policies))..    
+000362b0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+000362c0: 692c 2065 7661 6c5f 706f 6c69 6379 2069  i, eval_policy i
+000362d0: 6e20 656e 756d 6572 6174 6528 696e 7075  n enumerate(inpu
+000362e0: 745f 6469 6374 5f30 2e6b 6579 7328 2929  t_dict_0.keys())
+000362f0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00036300: 2020 2020 2020 6966 2069 203d 3d20 303a        if i == 0:
+00036310: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00036320: 2020 2020 2020 2020 2061 7820 3d20 6178           ax = ax
+00036330: 3020 3d20 6669 672e 6164 645f 7375 6270  0 = fig.add_subp
+00036340: 6c6f 7428 6e5f 6576 616c 5f70 6f6c 6963  lot(n_eval_polic
+00036350: 6965 732c 2031 2c20 6920 2b20 3129 0a20  ies, 1, i + 1). 
+00036360: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036370: 2020 2065 6c69 6620 7368 6172 6579 3a0a     elif sharey:.
 00036380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036390: 666f 7220 692c 2065 7661 6c5f 706f 6c69  for i, eval_poli
-000363a0: 6379 2069 6e20 656e 756d 6572 6174 6528  cy in enumerate(
-000363b0: 696e 7075 745f 6469 6374 5f30 2e6b 6579  input_dict_0.key
-000363c0: 7328 2929 3a0a 2020 2020 2020 2020 2020  s()):.          
-000363d0: 2020 2020 2020 2020 2020 6966 2069 203d            if i =
-000363e0: 3d20 303a 0a20 2020 2020 2020 2020 2020  = 0:.           
-000363f0: 2020 2020 2020 2020 2020 2020 2061 7820               ax 
-00036400: 3d20 6178 3020 3d20 6669 672e 6164 645f  = ax0 = fig.add_
-00036410: 7375 6270 6c6f 7428 6e5f 6576 616c 5f70  subplot(n_eval_p
-00036420: 6f6c 6963 6965 732c 2031 2c20 6920 2b20  olicies, 1, i + 
-00036430: 3129 0a20 2020 2020 2020 2020 2020 2020  1).             
-00036440: 2020 2020 2020 2065 6c69 6620 7368 6172         elif shar
-00036450: 6579 3a0a 2020 2020 2020 2020 2020 2020  ey:.            
-00036460: 2020 2020 2020 2020 2020 2020 6178 203d              ax =
-00036470: 2066 6967 2e61 6464 5f73 7562 706c 6f74   fig.add_subplot
-00036480: 286e 5f65 7661 6c5f 706f 6c69 6369 6573  (n_eval_policies
-00036490: 2c20 312c 2069 202b 2031 2c20 7368 6172  , 1, i + 1, shar
-000364a0: 6579 3d61 7830 290a 2020 2020 2020 2020  ey=ax0).        
-000364b0: 2020 2020 2020 2020 2020 2020 656c 7365              else
-000364c0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000364d0: 2020 2020 2020 2020 2020 6178 203d 2066            ax = f
-000364e0: 6967 2e61 6464 5f73 7562 706c 6f74 286e  ig.add_subplot(n
-000364f0: 5f65 7661 6c5f 706f 6c69 6369 6573 2c20  _eval_policies, 
-00036500: 312c 2069 202b 2031 290a 0a20 2020 2020  1, i + 1)..     
-00036510: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-00036520: 6620 3d20 5b5d 0a20 2020 2020 2020 2020  f = [].         
-00036530: 2020 2020 2020 2020 2020 2066 6f72 2062             for b
-00036540: 6568 6176 696f 725f 706f 6c69 6379 2069  ehavior_policy i
-00036550: 6e20 6265 6861 7669 6f72 5f70 6f6c 6963  n behavior_polic
-00036560: 795f 6e61 6d65 733a 0a20 2020 2020 2020  y_names:.       
-00036570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036580: 206e 5f64 6174 6173 6574 7320 3d20 696e   n_datasets = in
-00036590: 7075 745f 6469 6374 2e6e 5f64 6174 6173  put_dict.n_datas
-000365a0: 6574 735b 6265 6861 7669 6f72 5f70 6f6c  ets[behavior_pol
-000365b0: 6963 795d 0a0a 2020 2020 2020 2020 2020  icy]..          
-000365c0: 2020 2020 2020 2020 2020 2020 2020 6466                df
-000365d0: 5f20 3d20 4461 7461 4672 616d 6528 290a  _ = DataFrame().
-000365e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000365f0: 2020 2020 2020 2020 666f 7220 6a2c 2065          for j, e
-00036600: 7374 696d 6174 6f72 2069 6e20 656e 756d  stimator in enum
-00036610: 6572 6174 6528 636f 6d70 6172 6564 5f65  erate(compared_e
-00036620: 7374 696d 6174 6f72 7329 3a0a 2020 2020  stimators):.    
-00036630: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036640: 2020 2020 2020 2020 6466 5f5b 6573 7469          df_[esti
-00036650: 6d61 746f 725d 203d 2065 7374 696d 6174  mator] = estimat
-00036660: 696f 6e5f 6469 6374 5b62 6568 6176 696f  ion_dict[behavio
-00036670: 725f 706f 6c69 6379 5d5b 0a20 2020 2020  r_policy][.     
-00036680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036690: 2020 2020 2020 2020 2020 2065 7661 6c5f             eval_
-000366a0: 706f 6c69 6379 0a20 2020 2020 2020 2020  policy.         
-000366b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000366c0: 2020 205d 5b65 7374 696d 6174 6f72 5d0a     ][estimator].
-000366d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000366e0: 2020 2020 2020 2020 2064 665f 5b22 6461           df_["da
-000366f0: 7461 7365 745f 6964 225d 203d 206e 702e  taset_id"] = np.
-00036700: 6172 616e 6765 286e 5f64 6174 6173 6574  arange(n_dataset
-00036710: 7329 0a20 2020 2020 2020 2020 2020 2020  s).             
-00036720: 2020 2020 2020 2020 2020 2064 665f 203d             df_ =
-00036730: 2070 642e 6d65 6c74 280a 2020 2020 2020   pd.melt(.      
+00036390: 2020 2020 2020 2020 6178 203d 2066 6967          ax = fig
+000363a0: 2e61 6464 5f73 7562 706c 6f74 286e 5f65  .add_subplot(n_e
+000363b0: 7661 6c5f 706f 6c69 6369 6573 2c20 312c  val_policies, 1,
+000363c0: 2069 202b 2031 2c20 7368 6172 6579 3d61   i + 1, sharey=a
+000363d0: 7830 290a 2020 2020 2020 2020 2020 2020  x0).            
+000363e0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+000363f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036400: 2020 2020 2020 6178 203d 2066 6967 2e61        ax = fig.a
+00036410: 6464 5f73 7562 706c 6f74 286e 5f65 7661  dd_subplot(n_eva
+00036420: 6c5f 706f 6c69 6369 6573 2c20 312c 2069  l_policies, 1, i
+00036430: 202b 2031 290a 0a20 2020 2020 2020 2020   + 1)..         
+00036440: 2020 2020 2020 2020 2020 2064 6620 3d20             df = 
+00036450: 5b5d 0a20 2020 2020 2020 2020 2020 2020  [].             
+00036460: 2020 2020 2020 2066 6f72 2062 6568 6176         for behav
+00036470: 696f 725f 706f 6c69 6379 2069 6e20 6265  ior_policy in be
+00036480: 6861 7669 6f72 5f70 6f6c 6963 795f 6e61  havior_policy_na
+00036490: 6d65 733a 0a20 2020 2020 2020 2020 2020  mes:.           
+000364a0: 2020 2020 2020 2020 2020 2020 206e 5f64               n_d
+000364b0: 6174 6173 6574 7320 3d20 696e 7075 745f  atasets = input_
+000364c0: 6469 6374 2e6e 5f64 6174 6173 6574 735b  dict.n_datasets[
+000364d0: 6265 6861 7669 6f72 5f70 6f6c 6963 795d  behavior_policy]
+000364e0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000364f0: 2020 2020 2020 2020 2020 6466 5f20 3d20            df_ = 
+00036500: 4461 7461 4672 616d 6528 290a 2020 2020  DataFrame().    
+00036510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036520: 2020 2020 666f 7220 6a2c 2065 7374 696d      for j, estim
+00036530: 6174 6f72 2069 6e20 656e 756d 6572 6174  ator in enumerat
+00036540: 6528 636f 6d70 6172 6564 5f65 7374 696d  e(compared_estim
+00036550: 6174 6f72 7329 3a0a 2020 2020 2020 2020  ators):.        
+00036560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036570: 2020 2020 6466 5f5b 6573 7469 6d61 746f      df_[estimato
+00036580: 725d 203d 2065 7374 696d 6174 696f 6e5f  r] = estimation_
+00036590: 6469 6374 5b62 6568 6176 696f 725f 706f  dict[behavior_po
+000365a0: 6c69 6379 5d5b 0a20 2020 2020 2020 2020  licy][.         
+000365b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000365c0: 2020 2020 2020 2065 7661 6c5f 706f 6c69         eval_poli
+000365d0: 6379 0a20 2020 2020 2020 2020 2020 2020  cy.             
+000365e0: 2020 2020 2020 2020 2020 2020 2020 205d                 ]
+000365f0: 5b65 7374 696d 6174 6f72 5d0a 0a20 2020  [estimator]..   
+00036600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036610: 2020 2020 2064 665f 5b22 6461 7461 7365       df_["datase
+00036620: 745f 6964 225d 203d 206e 702e 6172 616e  t_id"] = np.aran
+00036630: 6765 286e 5f64 6174 6173 6574 7329 0a20  ge(n_datasets). 
+00036640: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036650: 2020 2020 2020 2064 665f 203d 2070 642e         df_ = pd.
+00036660: 6d65 6c74 280a 2020 2020 2020 2020 2020  melt(.          
+00036670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036680: 2020 6466 5f2c 0a20 2020 2020 2020 2020    df_,.         
+00036690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000366a0: 2020 2069 645f 7661 7273 3d5b 2264 6174     id_vars=["dat
+000366b0: 6173 6574 5f69 6422 5d2c 0a20 2020 2020  aset_id"],.     
+000366c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000366d0: 2020 2020 2020 2076 6172 5f6e 616d 653d         var_name=
+000366e0: 2265 7374 696d 6174 6f72 222c 0a20 2020  "estimator",.   
+000366f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036700: 2020 2020 2020 2020 2076 616c 7565 5f6e           value_n
+00036710: 616d 653d 2270 6f6c 6963 795f 7661 6c75  ame="policy_valu
+00036720: 6522 2c0a 2020 2020 2020 2020 2020 2020  e",.            
+00036730: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
 00036740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036750: 2020 2020 2020 6466 5f2c 0a20 2020 2020        df_,.     
-00036760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036770: 2020 2020 2020 2069 645f 7661 7273 3d5b         id_vars=[
-00036780: 2264 6174 6173 6574 5f69 6422 5d2c 0a20  "dataset_id"],. 
-00036790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000367a0: 2020 2020 2020 2020 2020 2076 6172 5f6e             var_n
-000367b0: 616d 653d 2265 7374 696d 6174 6f72 222c  ame="estimator",
-000367c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000367d0: 2020 2020 2020 2020 2020 2020 2076 616c               val
-000367e0: 7565 5f6e 616d 653d 2270 6f6c 6963 795f  ue_name="policy_
-000367f0: 7661 6c75 6522 2c0a 2020 2020 2020 2020  value",.        
-00036800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036810: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00036820: 2020 2020 2020 2020 2020 6466 5f5b 2262            df_["b
-00036830: 6568 6176 696f 725f 706f 6c69 6379 225d  ehavior_policy"]
-00036840: 203d 2062 6568 6176 696f 725f 706f 6c69   = behavior_poli
-00036850: 6379 0a20 2020 2020 2020 2020 2020 2020  cy.             
-00036860: 2020 2020 2020 2020 2020 2064 662e 6170             df.ap
-00036870: 7065 6e64 2864 665f 290a 0a20 2020 2020  pend(df_)..     
-00036880: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-00036890: 6620 3d20 7064 2e63 6f6e 6361 7428 6466  f = pd.concat(df
-000368a0: 2c20 6178 6973 3d30 290a 2020 2020 2020  , axis=0).      
-000368b0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-000368c0: 2028 6466 5b22 706f 6c69 6379 5f76 616c   (df["policy_val
-000368d0: 7565 225d 203e 2031 6531 3029 2e73 756d  ue"] > 1e10).sum
-000368e0: 2829 202b 2028 0a20 2020 2020 2020 2020  () + (.         
-000368f0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-00036900: 665b 2270 6f6c 6963 795f 7661 6c75 6522  f["policy_value"
-00036910: 5d20 3c20 2d31 6531 300a 2020 2020 2020  ] < -1e10.      
-00036920: 2020 2020 2020 2020 2020 2020 2020 292e                ).
-00036930: 7375 6d28 2920 3e20 303a 0a20 2020 2020  sum() > 0:.     
-00036940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036950: 2020 2077 6172 6e28 0a20 2020 2020 2020     warn(.       
-00036960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036970: 2020 2020 2022 466f 756e 6420 6120 6c61       "Found a la
-00036980: 7267 6520 6162 736f 6c75 7465 2076 616c  rge absolute val
-00036990: 7565 2069 6e20 7468 6520 706f 6c69 6379  ue in the policy
-000369a0: 2076 616c 7565 2065 7374 696d 6174 652e   value estimate.
-000369b0: 2054 6865 2076 616c 7565 206d 6f72 6520   The value more 
-000369c0: 7468 616e 2031 6531 3020 616e 6420 6c65  than 1e10 and le
-000369d0: 7373 2074 6861 6e20 2d31 6531 3020 7769  ss than -1e10 wi
-000369e0: 6c6c 2062 6520 7265 706c 6163 6564 2074  ll be replaced t
-000369f0: 6f20 6e70 2e6e 616e 2e22 0a20 2020 2020  o np.nan.".     
-00036a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036a10: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-00036a20: 2020 2020 2020 2020 2020 2020 2064 665b               df[
-00036a30: 2270 6f6c 6963 795f 7661 6c75 6522 5d20  "policy_value"] 
-00036a40: 3d20 6466 5b22 706f 6c69 6379 5f76 616c  = df["policy_val
-00036a50: 7565 225d 2e6d 6173 6b28 0a20 2020 2020  ue"].mask(.     
-00036a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036a70: 2020 2020 2020 2064 665b 2270 6f6c 6963         df["polic
-00036a80: 795f 7661 6c75 6522 5d20 3e20 3165 2d31  y_value"] > 1e-1
-00036a90: 302c 206e 702e 6e61 6e0a 2020 2020 2020  0, np.nan.      
-00036aa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036ab0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-00036ac0: 2020 2020 2020 2020 2020 2020 6466 5b22              df["
-00036ad0: 706f 6c69 6379 5f76 616c 7565 225d 203d  policy_value"] =
-00036ae0: 2064 665b 2270 6f6c 6963 795f 7661 6c75   df["policy_valu
-00036af0: 6522 5d2e 6d61 736b 280a 2020 2020 2020  e"].mask(.      
+00036750: 2020 2020 2020 6466 5f5b 2262 6568 6176        df_["behav
+00036760: 696f 725f 706f 6c69 6379 225d 203d 2062  ior_policy"] = b
+00036770: 6568 6176 696f 725f 706f 6c69 6379 0a20  ehavior_policy. 
+00036780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036790: 2020 2020 2020 2064 662e 6170 7065 6e64         df.append
+000367a0: 2864 665f 290a 0a20 2020 2020 2020 2020  (df_)..         
+000367b0: 2020 2020 2020 2020 2020 2064 6620 3d20             df = 
+000367c0: 7064 2e63 6f6e 6361 7428 6466 2c20 6178  pd.concat(df, ax
+000367d0: 6973 3d30 290a 2020 2020 2020 2020 2020  is=0).          
+000367e0: 2020 2020 2020 2020 2020 6966 2028 6466            if (df
+000367f0: 5b22 706f 6c69 6379 5f76 616c 7565 225d  ["policy_value"]
+00036800: 203e 2031 6531 3029 2e73 756d 2829 202b   > 1e10).sum() +
+00036810: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
+00036820: 2020 2020 2020 2020 2020 2064 665b 2270             df["p
+00036830: 6f6c 6963 795f 7661 6c75 6522 5d20 3c20  olicy_value"] < 
+00036840: 2d31 6531 300a 2020 2020 2020 2020 2020  -1e10.          
+00036850: 2020 2020 2020 2020 2020 292e 7375 6d28            ).sum(
+00036860: 2920 3e20 303a 0a20 2020 2020 2020 2020  ) > 0:.         
+00036870: 2020 2020 2020 2020 2020 2020 2020 2077                 w
+00036880: 6172 6e28 0a20 2020 2020 2020 2020 2020  arn(.           
+00036890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000368a0: 2022 466f 756e 6420 6120 6c61 7267 6520   "Found a large 
+000368b0: 6162 736f 6c75 7465 2076 616c 7565 2069  absolute value i
+000368c0: 6e20 7468 6520 706f 6c69 6379 2076 616c  n the policy val
+000368d0: 7565 2065 7374 696d 6174 652e 2054 6865  ue estimate. The
+000368e0: 2076 616c 7565 206d 6f72 6520 7468 616e   value more than
+000368f0: 2031 6531 3020 616e 6420 6c65 7373 2074   1e10 and less t
+00036900: 6861 6e20 2d31 6531 3020 7769 6c6c 2062  han -1e10 will b
+00036910: 6520 7265 706c 6163 6564 2074 6f20 6e70  e replaced to np
+00036920: 2e6e 616e 2e22 0a20 2020 2020 2020 2020  .nan.".         
+00036930: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+00036940: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00036950: 2020 2020 2020 2020 2064 665b 2270 6f6c           df["pol
+00036960: 6963 795f 7661 6c75 6522 5d20 3d20 6466  icy_value"] = df
+00036970: 5b22 706f 6c69 6379 5f76 616c 7565 225d  ["policy_value"]
+00036980: 2e6d 6173 6b28 0a20 2020 2020 2020 2020  .mask(.         
+00036990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000369a0: 2020 2064 665b 2270 6f6c 6963 795f 7661     df["policy_va
+000369b0: 6c75 6522 5d20 3e20 3165 2d31 302c 206e  lue"] > 1e-10, n
+000369c0: 702e 6e61 6e0a 2020 2020 2020 2020 2020  p.nan.          
+000369d0: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+000369e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000369f0: 2020 2020 2020 2020 6466 5b22 706f 6c69          df["poli
+00036a00: 6379 5f76 616c 7565 225d 203d 2064 665b  cy_value"] = df[
+00036a10: 2270 6f6c 6963 795f 7661 6c75 6522 5d2e  "policy_value"].
+00036a20: 6d61 736b 280a 2020 2020 2020 2020 2020  mask(.          
+00036a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036a40: 2020 6466 5b22 706f 6c69 6379 5f76 616c    df["policy_val
+00036a50: 7565 225d 203c 202d 3165 2d31 302c 206e  ue"] < -1e-10, n
+00036a60: 702e 6e61 6e0a 2020 2020 2020 2020 2020  p.nan.          
+00036a70: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+00036a80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00036a90: 2020 2020 2069 6620 706c 6f74 5f74 7970       if plot_typ
+00036aa0: 6520 3d3d 2022 6369 223a 0a20 2020 2020  e == "ci":.     
+00036ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036ac0: 2020 2073 6e73 2e62 6172 706c 6f74 280a     sns.barplot(.
+00036ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036ae0: 2020 2020 2020 2020 2020 2020 6461 7461              data
+00036af0: 3d64 662c 0a20 2020 2020 2020 2020 2020  =df,.           
 00036b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036b10: 2020 2020 2020 6466 5b22 706f 6c69 6379        df["policy
-00036b20: 5f76 616c 7565 225d 203c 202d 3165 2d31  _value"] < -1e-1
-00036b30: 302c 206e 702e 6e61 6e0a 2020 2020 2020  0, np.nan.      
-00036b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036b50: 2020 290a 0a20 2020 2020 2020 2020 2020    )..           
-00036b60: 2020 2020 2020 2020 2069 6620 706c 6f74           if plot
-00036b70: 5f74 7970 6520 3d3d 2022 6369 223a 0a20  _type == "ci":. 
-00036b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036b90: 2020 2020 2020 2073 6e73 2e62 6172 706c         sns.barpl
-00036ba0: 6f74 280a 2020 2020 2020 2020 2020 2020  ot(.            
+00036b10: 2078 3d22 6573 7469 6d61 746f 7222 2c0a   x="estimator",.
+00036b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036b30: 2020 2020 2020 2020 2020 2020 793d 2270              y="p
+00036b40: 6f6c 6963 795f 7661 6c75 6522 2c0a 2020  olicy_value",.  
+00036b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036b60: 2020 2020 2020 2020 2020 6875 653d 2262            hue="b
+00036b70: 6568 6176 696f 725f 706f 6c69 6379 222c  ehavior_policy",
+00036b80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00036b90: 2020 2020 2020 2020 2020 2020 2070 616c               pal
+00036ba0: 6574 7465 3d70 616c 6574 7465 2c0a 2020  ette=palette,.  
 00036bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036bc0: 6461 7461 3d64 662c 0a20 2020 2020 2020  data=df,.       
-00036bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036be0: 2020 2020 2078 3d22 6573 7469 6d61 746f       x="estimato
-00036bf0: 7222 2c0a 2020 2020 2020 2020 2020 2020  r",.            
-00036c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036c10: 793d 2270 6f6c 6963 795f 7661 6c75 6522  y="policy_value"
-00036c20: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00036c30: 2020 2020 2020 2020 2020 2020 2020 6875                hu
-00036c40: 653d 2262 6568 6176 696f 725f 706f 6c69  e="behavior_poli
-00036c50: 6379 222c 0a20 2020 2020 2020 2020 2020  cy",.           
-00036c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036c70: 2070 616c 6574 7465 3d70 616c 6574 7465   palette=palette
-00036c80: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00036c90: 2020 2020 2020 2020 2020 2020 2020 6178                ax
-00036ca0: 3d61 782c 0a20 2020 2020 2020 2020 2020  =ax,.           
-00036cb0: 2020 2020 2020 2020 2020 2020 2029 0a0a               )..
-00036cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036cd0: 2020 2020 656c 6966 2070 6c6f 745f 7479      elif plot_ty
-00036ce0: 7065 203d 3d20 2276 696f 6c69 6e22 3a0a  pe == "violin":.
-00036cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036d00: 2020 2020 2020 2020 736e 732e 7669 6f6c          sns.viol
-00036d10: 696e 706c 6f74 280a 2020 2020 2020 2020  inplot(.        
+00036bc0: 2020 2020 2020 2020 2020 6178 3d61 782c            ax=ax,
+00036bd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00036be0: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
+00036bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036c00: 656c 6966 2070 6c6f 745f 7479 7065 203d  elif plot_type =
+00036c10: 3d20 2276 696f 6c69 6e22 3a0a 2020 2020  = "violin":.    
+00036c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036c30: 2020 2020 736e 732e 7669 6f6c 696e 706c      sns.violinpl
+00036c40: 6f74 280a 2020 2020 2020 2020 2020 2020  ot(.            
+00036c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036c60: 6461 7461 3d64 662c 0a20 2020 2020 2020  data=df,.       
+00036c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036c80: 2020 2020 2078 3d22 6573 7469 6d61 746f       x="estimato
+00036c90: 7222 2c0a 2020 2020 2020 2020 2020 2020  r",.            
+00036ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036cb0: 793d 2270 6f6c 6963 795f 7661 6c75 6522  y="policy_value"
+00036cc0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00036cd0: 2020 2020 2020 2020 2020 2020 2020 6875                hu
+00036ce0: 653d 2262 6568 6176 696f 725f 706f 6c69  e="behavior_poli
+00036cf0: 6379 222c 0a20 2020 2020 2020 2020 2020  cy",.           
+00036d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036d10: 2073 6361 6c65 3d22 7769 6474 6822 2c0a   scale="width",.
 00036d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036d30: 2020 2020 6461 7461 3d64 662c 0a20 2020      data=df,.   
-00036d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036d50: 2020 2020 2020 2020 2078 3d22 6573 7469           x="esti
-00036d60: 6d61 746f 7222 2c0a 2020 2020 2020 2020  mator",.        
-00036d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036d80: 2020 2020 793d 2270 6f6c 6963 795f 7661      y="policy_va
-00036d90: 6c75 6522 2c0a 2020 2020 2020 2020 2020  lue",.          
-00036da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036db0: 2020 6875 653d 2262 6568 6176 696f 725f    hue="behavior_
-00036dc0: 706f 6c69 6379 222c 0a20 2020 2020 2020  policy",.       
+00036d30: 2020 2020 2020 2020 2020 2020 7769 6474              widt
+00036d40: 683d 302e 382c 0a20 2020 2020 2020 2020  h=0.8,.         
+00036d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036d60: 2020 2070 616c 6574 7465 3d70 616c 6574     palette=palet
+00036d70: 7465 2c0a 2020 2020 2020 2020 2020 2020  te,.            
+00036d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036d90: 6178 3d61 782c 0a20 2020 2020 2020 2020  ax=ax,.         
+00036da0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+00036db0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00036dc0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
 00036dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036de0: 2020 2020 2073 6361 6c65 3d22 7769 6474       scale="widt
-00036df0: 6822 2c0a 2020 2020 2020 2020 2020 2020  h",.            
-00036e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036e10: 7769 6474 683d 302e 382c 0a20 2020 2020  width=0.8,.     
+00036de0: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
+00036df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036e00: 2020 2020 2073 6e73 2e73 7761 726d 706c       sns.swarmpl
+00036e10: 6f74 280a 2020 2020 2020 2020 2020 2020  ot(.            
 00036e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036e30: 2020 2020 2020 2070 616c 6574 7465 3d70         palette=p
-00036e40: 616c 6574 7465 2c0a 2020 2020 2020 2020  alette,.        
-00036e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036e60: 2020 2020 6178 3d61 782c 0a20 2020 2020      ax=ax,.     
+00036e30: 2020 2020 6461 7461 3d64 662c 0a20 2020      data=df,.   
+00036e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036e50: 2020 2020 2020 2020 2020 2020 2078 3d22               x="
+00036e60: 6573 7469 6d61 746f 7222 2c0a 2020 2020  estimator",.    
 00036e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036e80: 2020 2029 0a0a 2020 2020 2020 2020 2020     )..          
-00036e90: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+00036e80: 2020 2020 2020 2020 2020 2020 793d 2270              y="p
+00036e90: 6f6c 6963 795f 7661 6c75 6522 2c0a 2020  olicy_value",.  
 00036ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036eb0: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
-00036ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036ed0: 2020 2020 2020 2020 2073 6e73 2e73 7761           sns.swa
-00036ee0: 726d 706c 6f74 280a 2020 2020 2020 2020  rmplot(.        
-00036ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036f00: 2020 2020 2020 2020 6461 7461 3d64 662c          data=df,
-00036f10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00036f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036f30: 2078 3d22 6573 7469 6d61 746f 7222 2c0a   x="estimator",.
-00036f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036eb0: 2020 2020 2020 2020 2020 2020 2020 6875                hu
+00036ec0: 653d 2262 6568 6176 696f 725f 706f 6c69  e="behavior_poli
+00036ed0: 6379 222c 0a20 2020 2020 2020 2020 2020  cy",.           
+00036ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036ef0: 2020 2020 2070 616c 6574 7465 3d70 616c       palette=pal
+00036f00: 6574 7465 2c0a 2020 2020 2020 2020 2020  ette,.          
+00036f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036f20: 2020 2020 2020 6178 3d61 782c 0a20 2020        ax=ax,.   
+00036f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036f40: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
 00036f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036f60: 793d 2270 6f6c 6963 795f 7661 6c75 6522  y="policy_value"
-00036f70: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00036f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036f90: 2020 6875 653d 2262 6568 6176 696f 725f    hue="behavior_
-00036fa0: 706f 6c69 6379 222c 0a20 2020 2020 2020  policy",.       
-00036fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036fc0: 2020 2020 2020 2020 2070 616c 6574 7465           palette
-00036fd0: 3d70 616c 6574 7465 2c0a 2020 2020 2020  =palette,.      
-00036fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036ff0: 2020 2020 2020 2020 2020 6178 3d61 782c            ax=ax,
-00037000: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00037010: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
-00037020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037030: 2020 2020 2020 2065 7863 6570 743a 0a20         except:. 
+00036f60: 2020 2065 7863 6570 743a 0a20 2020 2020     except:.     
+00036f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00036f80: 2020 2020 2020 2077 6172 6e28 2245 6e63         warn("Enc
+00036f90: 6f75 6e74 6572 6564 204e 614e 2076 616c  ountered NaN val
+00036fa0: 7565 7320 6475 7269 6e67 2070 6c6f 742e  ues during plot.
+00036fb0: 2229 0a0a 2020 2020 2020 2020 2020 2020  ")..            
+00036fc0: 2020 2020 2020 2020 6f6e 5f70 6f6c 6963          on_polic
+00036fd0: 7920 3d20 6573 7469 6d61 7469 6f6e 5f64  y = estimation_d
+00036fe0: 6963 745b 6265 6861 7669 6f72 5f70 6f6c  ict[behavior_pol
+00036ff0: 6963 795d 5b65 7661 6c5f 706f 6c69 6379  icy][eval_policy
+00037000: 5d5b 0a20 2020 2020 2020 2020 2020 2020  ][.             
+00037010: 2020 2020 2020 2020 2020 2022 6f6e 5f70             "on_p
+00037020: 6f6c 6963 7922 0a20 2020 2020 2020 2020  olicy".         
+00037030: 2020 2020 2020 2020 2020 205d 0a20 2020             ].   
 00037040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037050: 2020 2020 2020 2020 2020 2077 6172 6e28             warn(
-00037060: 2245 6e63 6f75 6e74 6572 6564 204e 614e  "Encountered NaN
-00037070: 2076 616c 7565 7320 6475 7269 6e67 2070   values during p
-00037080: 6c6f 742e 2229 0a0a 2020 2020 2020 2020  lot.")..        
-00037090: 2020 2020 2020 2020 2020 2020 6f6e 5f70              on_p
-000370a0: 6f6c 6963 7920 3d20 6573 7469 6d61 7469  olicy = estimati
-000370b0: 6f6e 5f64 6963 745b 6265 6861 7669 6f72  on_dict[behavior
-000370c0: 5f70 6f6c 6963 795d 5b65 7661 6c5f 706f  _policy][eval_po
-000370d0: 6c69 6379 5d5b 0a20 2020 2020 2020 2020  licy][.         
-000370e0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-000370f0: 6f6e 5f70 6f6c 6963 7922 0a20 2020 2020  on_policy".     
-00037100: 2020 2020 2020 2020 2020 2020 2020 205d                 ]
-00037110: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00037120: 2020 2020 2069 6620 6f6e 5f70 6f6c 6963       if on_polic
-00037130: 7920 6973 206e 6f74 204e 6f6e 653a 0a20  y is not None:. 
-00037140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037150: 2020 2020 2020 2061 782e 7363 6174 7465         ax.scatte
-00037160: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
-00037170: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-00037180: 702e 6172 616e 6765 286e 5f65 7374 696d  p.arange(n_estim
-00037190: 6174 6f72 7329 2c0a 2020 2020 2020 2020  ators),.        
-000371a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000371b0: 2020 2020 6e70 2e66 756c 6c28 286e 5f65      np.full((n_e
-000371c0: 7374 696d 6174 6f72 7329 2c20 6f6e 5f70  stimators), on_p
-000371d0: 6f6c 6963 7929 2c0a 2020 2020 2020 2020  olicy),.        
-000371e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000371f0: 2020 2020 636f 6c6f 723d 2262 6c61 636b      color="black
-00037200: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-00037210: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-00037220: 6172 6b65 723d 222a 222c 0a20 2020 2020  arker="*",.     
-00037230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037240: 2020 2020 2020 2073 3d31 3530 2c0a 2020         s=150,.  
-00037250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037260: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-00037270: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00037280: 6c65 6765 6e64 3a0a 2020 2020 2020 2020  legend:.        
-00037290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000372a0: 6178 2e6c 6567 656e 6428 6c6f 633d 226c  ax.legend(loc="l
-000372b0: 6f77 6572 2072 6967 6874 2229 0a20 2020  ower right").   
+00037050: 2069 6620 6f6e 5f70 6f6c 6963 7920 6973   if on_policy is
+00037060: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
+00037070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037080: 2020 2061 782e 7363 6174 7465 7228 0a20     ax.scatter(. 
+00037090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000370a0: 2020 2020 2020 2020 2020 206e 702e 6172             np.ar
+000370b0: 616e 6765 286e 5f65 7374 696d 6174 6f72  ange(n_estimator
+000370c0: 7329 2c0a 2020 2020 2020 2020 2020 2020  s),.            
+000370d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000370e0: 6e70 2e66 756c 6c28 286e 5f65 7374 696d  np.full((n_estim
+000370f0: 6174 6f72 7329 2c20 6f6e 5f70 6f6c 6963  ators), on_polic
+00037100: 7929 2c0a 2020 2020 2020 2020 2020 2020  y),.            
+00037110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037120: 636f 6c6f 723d 2262 6c61 636b 222c 0a20  color="black",. 
+00037130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037140: 2020 2020 2020 2020 2020 206d 6172 6b65             marke
+00037150: 723d 222a 222c 0a20 2020 2020 2020 2020  r="*",.         
+00037160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037170: 2020 2073 3d31 3530 2c0a 2020 2020 2020     s=150,.      
+00037180: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037190: 2020 290a 0a20 2020 2020 2020 2020 2020    )..           
+000371a0: 2020 2020 2020 2020 2069 6620 6c65 6765           if lege
+000371b0: 6e64 3a0a 2020 2020 2020 2020 2020 2020  nd:.            
+000371c0: 2020 2020 2020 2020 2020 2020 6178 2e6c              ax.l
+000371d0: 6567 656e 6428 6c6f 633d 226c 6f77 6572  egend(loc="lower
+000371e0: 2072 6967 6874 2229 0a20 2020 2020 2020   right").       
+000371f0: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+00037200: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00037210: 2020 2020 2020 2020 2020 2061 782e 6765             ax.ge
+00037220: 745f 6c65 6765 6e64 2829 2e72 656d 6f76  t_legend().remov
+00037230: 6528 290a 0a20 2020 2020 2020 2020 2020  e()..           
+00037240: 2020 2020 2020 2020 2061 782e 7365 745f           ax.set_
+00037250: 7469 746c 6528 6576 616c 5f70 6f6c 6963  title(eval_polic
+00037260: 792c 2066 6f6e 7473 697a 653d 3136 290a  y, fontsize=16).
+00037270: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037280: 2020 2020 6178 2e73 6574 5f78 6c61 6265      ax.set_xlabe
+00037290: 6c28 2222 290a 2020 2020 2020 2020 2020  l("").          
+000372a0: 2020 2020 2020 2020 2020 6178 2e73 6574            ax.set
+000372b0: 5f79 6c61 6265 6c28 0a20 2020 2020 2020  _ylabel(.       
 000372c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000372d0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-000372e0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-000372f0: 782e 6765 745f 6c65 6765 6e64 2829 2e72  x.get_legend().r
-00037300: 656d 6f76 6528 290a 0a20 2020 2020 2020  emove()..       
-00037310: 2020 2020 2020 2020 2020 2020 2061 782e               ax.
-00037320: 7365 745f 7469 746c 6528 6576 616c 5f70  set_title(eval_p
-00037330: 6f6c 6963 792c 2066 6f6e 7473 697a 653d  olicy, fontsize=
-00037340: 3136 290a 2020 2020 2020 2020 2020 2020  16).            
-00037350: 2020 2020 2020 2020 6178 2e73 6574 5f78          ax.set_x
-00037360: 6c61 6265 6c28 2222 290a 2020 2020 2020  label("").      
-00037370: 2020 2020 2020 2020 2020 2020 2020 6178                ax
-00037380: 2e73 6574 5f79 6c61 6265 6c28 0a20 2020  .set_ylabel(.   
+000372d0: 2079 6c61 6265 6c2c 0a20 2020 2020 2020   ylabel,.       
+000372e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000372f0: 2066 6f6e 7473 697a 653d 3132 2c0a 2020   fontsize=12,.  
+00037300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037310: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+00037320: 2020 2020 2020 2020 6178 2e73 6574 5f78          ax.set_x
+00037330: 7469 636b 7328 6e70 2e61 7261 6e67 6528  ticks(np.arange(
+00037340: 6e5f 6573 7469 6d61 746f 7273 292c 2063  n_estimators), c
+00037350: 6f6d 7061 7265 645f 6573 7469 6d61 746f  ompared_estimato
+00037360: 7273 290a 2020 2020 2020 2020 2020 2020  rs).            
+00037370: 2020 2020 2020 2020 706c 742e 7974 6963          plt.ytic
+00037380: 6b73 2866 6f6e 7473 697a 653d 3132 290a  ks(fontsize=12).
 00037390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000373a0: 2020 2020 2079 6c61 6265 6c2c 0a20 2020       ylabel,.   
-000373b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000373c0: 2020 2020 2066 6f6e 7473 697a 653d 3132       fontsize=12
-000373d0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000373e0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-000373f0: 2020 2020 2020 2020 2020 2020 6178 2e73              ax.s
-00037400: 6574 5f78 7469 636b 7328 6e70 2e61 7261  et_xticks(np.ara
-00037410: 6e67 6528 6e5f 6573 7469 6d61 746f 7273  nge(n_estimators
-00037420: 292c 2063 6f6d 7061 7265 645f 6573 7469  ), compared_esti
-00037430: 6d61 746f 7273 290a 2020 2020 2020 2020  mators).        
-00037440: 2020 2020 2020 2020 2020 2020 706c 742e              plt.
-00037450: 7974 6963 6b73 2866 6f6e 7473 697a 653d  yticks(fontsize=
-00037460: 3132 290a 2020 2020 2020 2020 2020 2020  12).            
-00037470: 2020 2020 2020 2020 706c 742e 7874 6963          plt.xtic
-00037480: 6b73 2866 6f6e 7473 697a 653d 3132 290a  ks(fontsize=12).
-00037490: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
-000374a0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-000374b0: 2020 2076 6973 7561 6c69 7a65 5f6f 6e5f     visualize_on_
-000374c0: 706f 6c69 6379 203d 2054 7275 650a 2020  policy = True.  
-000374d0: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-000374e0: 7220 6576 616c 5f70 6f6c 6963 7920 696e  r eval_policy in
-000374f0: 2069 6e70 7574 5f64 6963 745f 302e 6b65   input_dict_0.ke
-00037500: 7973 2829 3a0a 2020 2020 2020 2020 2020  ys():.          
-00037510: 2020 2020 2020 2020 2020 6966 2069 6e70            if inp
-00037520: 7574 5f64 6963 745f 305b 6576 616c 5f70  ut_dict_0[eval_p
-00037530: 6f6c 6963 795d 5b22 6f6e 5f70 6f6c 6963  olicy]["on_polic
-00037540: 795f 706f 6c69 6379 5f76 616c 7565 225d  y_policy_value"]
-00037550: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
-00037560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037570: 2020 7669 7375 616c 697a 655f 6f6e 5f70    visualize_on_p
-00037580: 6f6c 6963 7920 3d20 4661 6c73 650a 0a20  olicy = False.. 
-00037590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000375a0: 2020 206f 6e5f 706f 6c69 6379 203d 206e     on_policy = n
-000375b0: 702e 7a65 726f 7328 6e5f 6576 616c 5f70  p.zeros(n_eval_p
-000375c0: 6f6c 6963 6965 7329 0a20 2020 2020 2020  olicies).       
-000375d0: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-000375e0: 206a 2c20 6576 616c 5f70 6f6c 6963 7920   j, eval_policy 
-000375f0: 696e 2065 6e75 6d65 7261 7465 2869 6e70  in enumerate(inp
-00037600: 7574 5f64 6963 745f 302e 6b65 7973 2829  ut_dict_0.keys()
-00037610: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-00037620: 2020 2020 2020 2020 2020 206f 6e5f 706f             on_po
-00037630: 6c69 6379 5b6a 5d20 3d20 6573 7469 6d61  licy[j] = estima
-00037640: 7469 6f6e 5f64 6963 745b 6265 6861 7669  tion_dict[behavi
-00037650: 6f72 5f70 6f6c 6963 795f 6e61 6d65 735b  or_policy_names[
-00037660: 305d 5d5b 0a20 2020 2020 2020 2020 2020  0]][.           
-00037670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037680: 2065 7661 6c5f 706f 6c69 6379 0a20 2020   eval_policy.   
-00037690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000376a0: 2020 2020 205d 5b22 6f6e 5f70 6f6c 6963       ]["on_polic
-000376b0: 7922 5d0a 0a20 2020 2020 2020 2020 2020  y"]..           
-000376c0: 2020 2020 2066 6967 203d 2070 6c74 2e66       fig = plt.f
-000376d0: 6967 7572 6528 6669 6773 697a 653d 2832  igure(figsize=(2
-000376e0: 202a 206e 5f65 7661 6c5f 706f 6c69 6369   * n_eval_polici
-000376f0: 6573 2c20 3420 2a20 6e5f 6573 7469 6d61  es, 4 * n_estima
-00037700: 746f 7273 2929 0a0a 2020 2020 2020 2020  tors))..        
-00037710: 2020 2020 2020 2020 666f 7220 692c 2065          for i, e
-00037720: 7374 696d 6174 6f72 2069 6e20 656e 756d  stimator in enum
-00037730: 6572 6174 6528 636f 6d70 6172 6564 5f65  erate(compared_e
-00037740: 7374 696d 6174 6f72 7329 3a0a 2020 2020  stimators):.    
-00037750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037760: 6966 2069 203d 3d20 303a 0a20 2020 2020  if i == 0:.     
+000373a0: 2020 2020 706c 742e 7874 6963 6b73 2866      plt.xticks(f
+000373b0: 6f6e 7473 697a 653d 3132 290a 0a20 2020  ontsize=12)..   
+000373c0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+000373d0: 2020 2020 2020 2020 2020 2020 2020 2076                 v
+000373e0: 6973 7561 6c69 7a65 5f6f 6e5f 706f 6c69  isualize_on_poli
+000373f0: 6379 203d 2054 7275 650a 2020 2020 2020  cy = True.      
+00037400: 2020 2020 2020 2020 2020 666f 7220 6576            for ev
+00037410: 616c 5f70 6f6c 6963 7920 696e 2069 6e70  al_policy in inp
+00037420: 7574 5f64 6963 745f 302e 6b65 7973 2829  ut_dict_0.keys()
+00037430: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00037440: 2020 2020 2020 6966 2069 6e70 7574 5f64        if input_d
+00037450: 6963 745f 305b 6576 616c 5f70 6f6c 6963  ict_0[eval_polic
+00037460: 795d 5b22 6f6e 5f70 6f6c 6963 795f 706f  y]["on_policy_po
+00037470: 6c69 6379 5f76 616c 7565 225d 2069 7320  licy_value"] is 
+00037480: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+00037490: 2020 2020 2020 2020 2020 2020 2020 7669                vi
+000374a0: 7375 616c 697a 655f 6f6e 5f70 6f6c 6963  sualize_on_polic
+000374b0: 7920 3d20 4661 6c73 650a 0a20 2020 2020  y = False..     
+000374c0: 2020 2020 2020 2020 2020 2020 2020 206f                 o
+000374d0: 6e5f 706f 6c69 6379 203d 206e 702e 7a65  n_policy = np.ze
+000374e0: 726f 7328 6e5f 6576 616c 5f70 6f6c 6963  ros(n_eval_polic
+000374f0: 6965 7329 0a20 2020 2020 2020 2020 2020  ies).           
+00037500: 2020 2020 2020 2020 2066 6f72 206a 2c20           for j, 
+00037510: 6576 616c 5f70 6f6c 6963 7920 696e 2065  eval_policy in e
+00037520: 6e75 6d65 7261 7465 2869 6e70 7574 5f64  numerate(input_d
+00037530: 6963 745f 302e 6b65 7973 2829 293a 0a20  ict_0.keys()):. 
+00037540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037550: 2020 2020 2020 206f 6e5f 706f 6c69 6379         on_policy
+00037560: 5b6a 5d20 3d20 6573 7469 6d61 7469 6f6e  [j] = estimation
+00037570: 5f64 6963 745b 6265 6861 7669 6f72 5f70  _dict[behavior_p
+00037580: 6f6c 6963 795f 6e61 6d65 735b 305d 5d5b  olicy_names[0]][
+00037590: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000375a0: 2020 2020 2020 2020 2020 2020 2065 7661               eva
+000375b0: 6c5f 706f 6c69 6379 0a20 2020 2020 2020  l_policy.       
+000375c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000375d0: 205d 5b22 6f6e 5f70 6f6c 6963 7922 5d0a   ]["on_policy"].
+000375e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000375f0: 2066 6967 203d 2070 6c74 2e66 6967 7572   fig = plt.figur
+00037600: 6528 6669 6773 697a 653d 2832 202a 206e  e(figsize=(2 * n
+00037610: 5f65 7661 6c5f 706f 6c69 6369 6573 2c20  _eval_policies, 
+00037620: 3420 2a20 6e5f 6573 7469 6d61 746f 7273  4 * n_estimators
+00037630: 2929 0a0a 2020 2020 2020 2020 2020 2020  ))..            
+00037640: 2020 2020 666f 7220 692c 2065 7374 696d      for i, estim
+00037650: 6174 6f72 2069 6e20 656e 756d 6572 6174  ator in enumerat
+00037660: 6528 636f 6d70 6172 6564 5f65 7374 696d  e(compared_estim
+00037670: 6174 6f72 7329 3a0a 2020 2020 2020 2020  ators):.        
+00037680: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+00037690: 203d 3d20 303a 0a20 2020 2020 2020 2020   == 0:.         
+000376a0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+000376b0: 7820 3d20 6178 3020 3d20 6669 672e 6164  x = ax0 = fig.ad
+000376c0: 645f 7375 6270 6c6f 7428 6e5f 6573 7469  d_subplot(n_esti
+000376d0: 6d61 746f 7273 2c20 312c 2069 202b 2031  mators, 1, i + 1
+000376e0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+000376f0: 2020 2020 2020 656c 6966 2073 6861 7265        elif share
+00037700: 793a 0a20 2020 2020 2020 2020 2020 2020  y:.             
+00037710: 2020 2020 2020 2020 2020 2061 7820 3d20             ax = 
+00037720: 6669 672e 6164 645f 7375 6270 6c6f 7428  fig.add_subplot(
+00037730: 6e5f 6573 7469 6d61 746f 7273 2c20 312c  n_estimators, 1,
+00037740: 2069 202b 2031 2c20 7368 6172 6579 3d61   i + 1, sharey=a
+00037750: 7830 290a 2020 2020 2020 2020 2020 2020  x0).            
+00037760: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
 00037770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037780: 2020 2061 7820 3d20 6178 3020 3d20 6669     ax = ax0 = fi
-00037790: 672e 6164 645f 7375 6270 6c6f 7428 6e5f  g.add_subplot(n_
-000377a0: 6573 7469 6d61 746f 7273 2c20 312c 2069  estimators, 1, i
-000377b0: 202b 2031 290a 2020 2020 2020 2020 2020   + 1).          
-000377c0: 2020 2020 2020 2020 2020 656c 6966 2073            elif s
-000377d0: 6861 7265 793a 0a20 2020 2020 2020 2020  harey:.         
-000377e0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-000377f0: 7820 3d20 6669 672e 6164 645f 7375 6270  x = fig.add_subp
-00037800: 6c6f 7428 6e5f 6573 7469 6d61 746f 7273  lot(n_estimators
-00037810: 2c20 312c 2069 202b 2031 2c20 7368 6172  , 1, i + 1, shar
-00037820: 6579 3d61 7830 290a 2020 2020 2020 2020  ey=ax0).        
-00037830: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00037840: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00037850: 2020 2020 2020 2020 2020 6178 203d 2066            ax = f
-00037860: 6967 2e61 6464 5f73 7562 706c 6f74 286e  ig.add_subplot(n
-00037870: 5f65 7374 696d 6174 6f72 732c 2031 2c20  _estimators, 1, 
-00037880: 6920 2b20 3129 0a0a 2020 2020 2020 2020  i + 1)..        
-00037890: 2020 2020 2020 2020 2020 2020 6466 203d              df =
-000378a0: 205b 5d0a 2020 2020 2020 2020 2020 2020   [].            
-000378b0: 2020 2020 2020 2020 666f 7220 6265 6861          for beha
-000378c0: 7669 6f72 5f70 6f6c 6963 7920 696e 2062  vior_policy in b
-000378d0: 6568 6176 696f 725f 706f 6c69 6379 5f6e  ehavior_policy_n
-000378e0: 616d 6573 3a0a 2020 2020 2020 2020 2020  ames:.          
-000378f0: 2020 2020 2020 2020 2020 2020 2020 6e5f                n_
-00037900: 6461 7461 7365 7473 203d 2069 6e70 7574  datasets = input
-00037910: 5f64 6963 742e 6e5f 6461 7461 7365 7473  _dict.n_datasets
-00037920: 5b62 6568 6176 696f 725f 706f 6c69 6379  [behavior_policy
-00037930: 5d0a 0a20 2020 2020 2020 2020 2020 2020  ]..             
-00037940: 2020 2020 2020 2020 2020 2064 665f 203d             df_ =
-00037950: 2044 6174 6146 7261 6d65 2829 0a20 2020   DataFrame().   
+00037780: 2020 2020 2020 6178 203d 2066 6967 2e61        ax = fig.a
+00037790: 6464 5f73 7562 706c 6f74 286e 5f65 7374  dd_subplot(n_est
+000377a0: 696d 6174 6f72 732c 2031 2c20 6920 2b20  imators, 1, i + 
+000377b0: 3129 0a0a 2020 2020 2020 2020 2020 2020  1)..            
+000377c0: 2020 2020 2020 2020 6466 203d 205b 5d0a          df = [].
+000377d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000377e0: 2020 2020 666f 7220 6265 6861 7669 6f72      for behavior
+000377f0: 5f70 6f6c 6963 7920 696e 2062 6568 6176  _policy in behav
+00037800: 696f 725f 706f 6c69 6379 5f6e 616d 6573  ior_policy_names
+00037810: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00037820: 2020 2020 2020 2020 2020 6e5f 6461 7461            n_data
+00037830: 7365 7473 203d 2069 6e70 7574 5f64 6963  sets = input_dic
+00037840: 742e 6e5f 6461 7461 7365 7473 5b62 6568  t.n_datasets[beh
+00037850: 6176 696f 725f 706f 6c69 6379 5d0a 0a20  avior_policy].. 
+00037860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037870: 2020 2020 2020 2064 665f 203d 2044 6174         df_ = Dat
+00037880: 6146 7261 6d65 2829 0a20 2020 2020 2020  aFrame().       
+00037890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000378a0: 2066 6f72 206a 2c20 6576 616c 5f70 6f6c   for j, eval_pol
+000378b0: 6963 7920 696e 2065 6e75 6d65 7261 7465  icy in enumerate
+000378c0: 2869 6e70 7574 5f64 6963 745f 302e 6b65  (input_dict_0.ke
+000378d0: 7973 2829 293a 0a20 2020 2020 2020 2020  ys()):.         
+000378e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000378f0: 2020 2064 665f 5b65 7661 6c5f 706f 6c69     df_[eval_poli
+00037900: 6379 5d20 3d20 6573 7469 6d61 7469 6f6e  cy] = estimation
+00037910: 5f64 6963 745b 6265 6861 7669 6f72 5f70  _dict[behavior_p
+00037920: 6f6c 6963 795d 5b0a 2020 2020 2020 2020  olicy][.        
+00037930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037940: 2020 2020 2020 2020 6576 616c 5f70 6f6c          eval_pol
+00037950: 6963 790a 2020 2020 2020 2020 2020 2020  icy.            
 00037960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037970: 2020 2020 2066 6f72 206a 2c20 6576 616c       for j, eval
-00037980: 5f70 6f6c 6963 7920 696e 2065 6e75 6d65  _policy in enume
-00037990: 7261 7465 2869 6e70 7574 5f64 6963 745f  rate(input_dict_
-000379a0: 302e 6b65 7973 2829 293a 0a20 2020 2020  0.keys()):.     
-000379b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000379c0: 2020 2020 2020 2064 665f 5b65 7661 6c5f         df_[eval_
-000379d0: 706f 6c69 6379 5d20 3d20 6573 7469 6d61  policy] = estima
-000379e0: 7469 6f6e 5f64 6963 745b 6265 6861 7669  tion_dict[behavi
-000379f0: 6f72 5f70 6f6c 6963 795d 5b0a 2020 2020  or_policy][.    
-00037a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037a10: 2020 2020 2020 2020 2020 2020 6576 616c              eval
-00037a20: 5f70 6f6c 6963 790a 2020 2020 2020 2020  _policy.        
-00037a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037a40: 2020 2020 5d5b 6573 7469 6d61 746f 725d      ][estimator]
-00037a50: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00037a60: 2020 2020 2020 2020 2020 6466 5f5b 2264            df_["d
-00037a70: 6174 6173 6574 5f69 6422 5d20 3d20 6e70  ataset_id"] = np
-00037a80: 2e61 7261 6e67 6528 6e5f 6461 7461 7365  .arange(n_datase
-00037a90: 7473 290a 2020 2020 2020 2020 2020 2020  ts).            
-00037aa0: 2020 2020 2020 2020 2020 2020 6466 5f20              df_ 
-00037ab0: 3d20 7064 2e6d 656c 7428 0a20 2020 2020  = pd.melt(.     
-00037ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037ad0: 2020 2020 2020 2064 665f 2c0a 2020 2020         df_,.    
-00037ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037af0: 2020 2020 2020 2020 6964 5f76 6172 733d          id_vars=
-00037b00: 5b22 6461 7461 7365 745f 6964 225d 2c0a  ["dataset_id"],.
-00037b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037b20: 2020 2020 2020 2020 2020 2020 7661 725f              var_
-00037b30: 6e61 6d65 3d22 6576 616c 5f70 6f6c 6963  name="eval_polic
-00037b40: 7922 2c0a 2020 2020 2020 2020 2020 2020  y",.            
-00037b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037b60: 7661 6c75 655f 6e61 6d65 3d22 706f 6c69  value_name="poli
-00037b70: 6379 5f76 616c 7565 222c 0a20 2020 2020  cy_value",.     
-00037b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037b90: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-00037ba0: 2020 2020 2020 2020 2020 2020 2064 665f               df_
-00037bb0: 5b22 6265 6861 7669 6f72 5f70 6f6c 6963  ["behavior_polic
-00037bc0: 7922 5d20 3d20 6265 6861 7669 6f72 5f70  y"] = behavior_p
-00037bd0: 6f6c 6963 790a 2020 2020 2020 2020 2020  olicy.          
-00037be0: 2020 2020 2020 2020 2020 2020 2020 6466                df
-00037bf0: 2e61 7070 656e 6428 6466 5f29 0a0a 2020  .append(df_)..  
-00037c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037c10: 2020 6466 203d 2070 642e 636f 6e63 6174    df = pd.concat
-00037c20: 2864 662c 2061 7869 733d 3029 0a20 2020  (df, axis=0).   
-00037c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037c40: 2069 6620 2864 665b 2270 6f6c 6963 795f   if (df["policy_
-00037c50: 7661 6c75 6522 5d20 3e20 3165 3130 292e  value"] > 1e10).
-00037c60: 7375 6d28 2920 2b20 280a 2020 2020 2020  sum() + (.      
-00037c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037c80: 2020 6466 5b22 706f 6c69 6379 5f76 616c    df["policy_val
-00037c90: 7565 225d 203c 202d 3165 3130 0a20 2020  ue"] < -1e10.   
-00037ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037cb0: 2029 2e73 756d 2829 203e 2030 3a0a 2020   ).sum() > 0:.  
-00037cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037cd0: 2020 2020 2020 7761 726e 280a 2020 2020        warn(.    
-00037ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037cf0: 2020 2020 2020 2020 2246 6f75 6e64 2061          "Found a
-00037d00: 206c 6172 6765 2061 6273 6f6c 7574 6520   large absolute 
-00037d10: 7661 6c75 6520 696e 2074 6865 2070 6f6c  value in the pol
-00037d20: 6963 7920 7661 6c75 6520 6573 7469 6d61  icy value estima
-00037d30: 7465 2e20 5468 6520 7661 6c75 6520 6d6f  te. The value mo
-00037d40: 7265 2074 6861 6e20 3165 3130 2061 6e64  re than 1e10 and
-00037d50: 206c 6573 7320 7468 616e 202d 3165 3130   less than -1e10
-00037d60: 2077 696c 6c20 6265 2072 6570 6c61 6365   will be replace
-00037d70: 6420 746f 206e 702e 6e61 6e2e 220a 2020  d to np.nan.".  
-00037d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037d90: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00037da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037db0: 6466 5b22 706f 6c69 6379 5f76 616c 7565  df["policy_value
-00037dc0: 225d 203d 2064 665b 2270 6f6c 6963 795f  "] = df["policy_
-00037dd0: 7661 6c75 6522 5d2e 6d61 736b 280a 2020  value"].mask(.  
-00037de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037df0: 2020 2020 2020 2020 2020 6466 5b22 706f            df["po
-00037e00: 6c69 6379 5f76 616c 7565 225d 203e 2031  licy_value"] > 1
-00037e10: 652d 3130 2c20 6e70 2e6e 616e 0a20 2020  e-10, np.nan.   
-00037e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037e30: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-00037e40: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-00037e50: 665b 2270 6f6c 6963 795f 7661 6c75 6522  f["policy_value"
-00037e60: 5d20 3d20 6466 5b22 706f 6c69 6379 5f76  ] = df["policy_v
-00037e70: 616c 7565 225d 2e6d 6173 6b28 0a20 2020  alue"].mask(.   
+00037970: 5d5b 6573 7469 6d61 746f 725d 0a0a 2020  ][estimator]..  
+00037980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037990: 2020 2020 2020 6466 5f5b 2264 6174 6173        df_["datas
+000379a0: 6574 5f69 6422 5d20 3d20 6e70 2e61 7261  et_id"] = np.ara
+000379b0: 6e67 6528 6e5f 6461 7461 7365 7473 290a  nge(n_datasets).
+000379c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000379d0: 2020 2020 2020 2020 6466 5f20 3d20 7064          df_ = pd
+000379e0: 2e6d 656c 7428 0a20 2020 2020 2020 2020  .melt(.         
+000379f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037a00: 2020 2064 665f 2c0a 2020 2020 2020 2020     df_,.        
+00037a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037a20: 2020 2020 6964 5f76 6172 733d 5b22 6461      id_vars=["da
+00037a30: 7461 7365 745f 6964 225d 2c0a 2020 2020  taset_id"],.    
+00037a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037a50: 2020 2020 2020 2020 7661 725f 6e61 6d65          var_name
+00037a60: 3d22 6576 616c 5f70 6f6c 6963 7922 2c0a  ="eval_policy",.
+00037a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037a80: 2020 2020 2020 2020 2020 2020 7661 6c75              valu
+00037a90: 655f 6e61 6d65 3d22 706f 6c69 6379 5f76  e_name="policy_v
+00037aa0: 616c 7565 222c 0a20 2020 2020 2020 2020  alue",.         
+00037ab0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+00037ac0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00037ad0: 2020 2020 2020 2020 2064 665f 5b22 6265           df_["be
+00037ae0: 6861 7669 6f72 5f70 6f6c 6963 7922 5d20  havior_policy"] 
+00037af0: 3d20 6265 6861 7669 6f72 5f70 6f6c 6963  = behavior_polic
+00037b00: 790a 2020 2020 2020 2020 2020 2020 2020  y.              
+00037b10: 2020 2020 2020 2020 2020 6466 2e61 7070            df.app
+00037b20: 656e 6428 6466 5f29 0a0a 2020 2020 2020  end(df_)..      
+00037b30: 2020 2020 2020 2020 2020 2020 2020 6466                df
+00037b40: 203d 2070 642e 636f 6e63 6174 2864 662c   = pd.concat(df,
+00037b50: 2061 7869 733d 3029 0a20 2020 2020 2020   axis=0).       
+00037b60: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00037b70: 2864 665b 2270 6f6c 6963 795f 7661 6c75  (df["policy_valu
+00037b80: 6522 5d20 3e20 3165 3130 292e 7375 6d28  e"] > 1e10).sum(
+00037b90: 2920 2b20 280a 2020 2020 2020 2020 2020  ) + (.          
+00037ba0: 2020 2020 2020 2020 2020 2020 2020 6466                df
+00037bb0: 5b22 706f 6c69 6379 5f76 616c 7565 225d  ["policy_value"]
+00037bc0: 203c 202d 3165 3130 0a20 2020 2020 2020   < -1e10.       
+00037bd0: 2020 2020 2020 2020 2020 2020 2029 2e73               ).s
+00037be0: 756d 2829 203e 2030 3a0a 2020 2020 2020  um() > 0:.      
+00037bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037c00: 2020 7761 726e 280a 2020 2020 2020 2020    warn(.        
+00037c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037c20: 2020 2020 2246 6f75 6e64 2061 206c 6172      "Found a lar
+00037c30: 6765 2061 6273 6f6c 7574 6520 7661 6c75  ge absolute valu
+00037c40: 6520 696e 2074 6865 2070 6f6c 6963 7920  e in the policy 
+00037c50: 7661 6c75 6520 6573 7469 6d61 7465 2e20  value estimate. 
+00037c60: 5468 6520 7661 6c75 6520 6d6f 7265 2074  The value more t
+00037c70: 6861 6e20 3165 3130 2061 6e64 206c 6573  han 1e10 and les
+00037c80: 7320 7468 616e 202d 3165 3130 2077 696c  s than -1e10 wil
+00037c90: 6c20 6265 2072 6570 6c61 6365 6420 746f  l be replaced to
+00037ca0: 206e 702e 6e61 6e2e 220a 2020 2020 2020   np.nan.".      
+00037cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037cc0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+00037cd0: 2020 2020 2020 2020 2020 2020 6466 5b22              df["
+00037ce0: 706f 6c69 6379 5f76 616c 7565 225d 203d  policy_value"] =
+00037cf0: 2064 665b 2270 6f6c 6963 795f 7661 6c75   df["policy_valu
+00037d00: 6522 5d2e 6d61 736b 280a 2020 2020 2020  e"].mask(.      
+00037d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037d20: 2020 2020 2020 6466 5b22 706f 6c69 6379        df["policy
+00037d30: 5f76 616c 7565 225d 203e 2031 652d 3130  _value"] > 1e-10
+00037d40: 2c20 6e70 2e6e 616e 0a20 2020 2020 2020  , np.nan.       
+00037d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037d60: 2029 0a20 2020 2020 2020 2020 2020 2020   ).             
+00037d70: 2020 2020 2020 2020 2020 2064 665b 2270             df["p
+00037d80: 6f6c 6963 795f 7661 6c75 6522 5d20 3d20  olicy_value"] = 
+00037d90: 6466 5b22 706f 6c69 6379 5f76 616c 7565  df["policy_value
+00037da0: 225d 2e6d 6173 6b28 0a20 2020 2020 2020  "].mask(.       
+00037db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037dc0: 2020 2020 2064 665b 2270 6f6c 6963 795f       df["policy_
+00037dd0: 7661 6c75 6522 5d20 3c20 2d31 652d 3130  value"] < -1e-10
+00037de0: 2c20 6e70 2e6e 616e 0a20 2020 2020 2020  , np.nan.       
+00037df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037e00: 2029 0a0a 2020 2020 2020 2020 2020 2020   )..            
+00037e10: 2020 2020 2020 2020 6966 2070 6c6f 745f          if plot_
+00037e20: 7479 7065 203d 3d20 2263 6922 3a0a 2020  type == "ci":.  
+00037e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037e40: 2020 2020 2020 736e 732e 6261 7270 6c6f        sns.barplo
+00037e50: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
+00037e60: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+00037e70: 6174 613d 6466 2c0a 2020 2020 2020 2020  ata=df,.        
 00037e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037e90: 2020 2020 2020 2020 2064 665b 2270 6f6c           df["pol
-00037ea0: 6963 795f 7661 6c75 6522 5d20 3c20 2d31  icy_value"] < -1
-00037eb0: 652d 3130 2c20 6e70 2e6e 616e 0a20 2020  e-10, np.nan.   
-00037ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037ed0: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
-00037ee0: 2020 2020 2020 2020 2020 2020 6966 2070              if p
-00037ef0: 6c6f 745f 7479 7065 203d 3d20 2263 6922  lot_type == "ci"
-00037f00: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00037f10: 2020 2020 2020 2020 2020 736e 732e 6261            sns.ba
-00037f20: 7270 6c6f 7428 0a20 2020 2020 2020 2020  rplot(.         
-00037f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037f40: 2020 2064 6174 613d 6466 2c0a 2020 2020     data=df,.    
-00037f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037f60: 2020 2020 2020 2020 783d 2265 7661 6c5f          x="eval_
-00037f70: 706f 6c69 6379 222c 0a20 2020 2020 2020  policy",.       
-00037f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037f90: 2020 2020 2079 3d22 706f 6c69 6379 5f76       y="policy_v
-00037fa0: 616c 7565 222c 0a20 2020 2020 2020 2020  alue",.         
-00037fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037fc0: 2020 2068 7565 3d22 6265 6861 7669 6f72     hue="behavior
-00037fd0: 5f70 6f6c 6963 7922 2c0a 2020 2020 2020  _policy",.      
-00037fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037ff0: 2020 2020 2020 7061 6c65 7474 653d 7061        palette=pa
-00038000: 6c65 7474 652c 0a20 2020 2020 2020 2020  lette,.         
-00038010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038020: 2020 2061 783d 6178 2c0a 2020 2020 2020     ax=ax,.      
-00038030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038040: 2020 290a 0a20 2020 2020 2020 2020 2020    )..           
-00038050: 2020 2020 2020 2020 2065 6c69 6620 706c           elif pl
-00038060: 6f74 5f74 7970 6520 3d3d 2022 7669 6f6c  ot_type == "viol
-00038070: 696e 223a 0a20 2020 2020 2020 2020 2020  in":.           
-00038080: 2020 2020 2020 2020 2020 2020 2073 6e73               sns
-00038090: 2e76 696f 6c69 6e70 6c6f 7428 0a20 2020  .violinplot(.   
-000380a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000380b0: 2020 2020 2020 2020 2064 6174 613d 6466           data=df
-000380c0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000380d0: 2020 2020 2020 2020 2020 2020 2020 783d                x=
-000380e0: 2265 7661 6c5f 706f 6c69 6379 222c 0a20  "eval_policy",. 
-000380f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038100: 2020 2020 2020 2020 2020 2079 3d22 706f             y="po
-00038110: 6c69 6379 5f76 616c 7565 222c 0a20 2020  licy_value",.   
+00037e90: 2020 2020 783d 2265 7661 6c5f 706f 6c69      x="eval_poli
+00037ea0: 6379 222c 0a20 2020 2020 2020 2020 2020  cy",.           
+00037eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037ec0: 2079 3d22 706f 6c69 6379 5f76 616c 7565   y="policy_value
+00037ed0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00037ee0: 2020 2020 2020 2020 2020 2020 2020 2068                 h
+00037ef0: 7565 3d22 6265 6861 7669 6f72 5f70 6f6c  ue="behavior_pol
+00037f00: 6963 7922 2c0a 2020 2020 2020 2020 2020  icy",.          
+00037f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037f20: 2020 7061 6c65 7474 653d 7061 6c65 7474    palette=palett
+00037f30: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+00037f40: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+00037f50: 783d 6178 2c0a 2020 2020 2020 2020 2020  x=ax,.          
+00037f60: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+00037f70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00037f80: 2020 2020 2065 6c69 6620 706c 6f74 5f74       elif plot_t
+00037f90: 7970 6520 3d3d 2022 7669 6f6c 696e 223a  ype == "violin":
+00037fa0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00037fb0: 2020 2020 2020 2020 2073 6e73 2e76 696f           sns.vio
+00037fc0: 6c69 6e70 6c6f 7428 0a20 2020 2020 2020  linplot(.       
+00037fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037fe0: 2020 2020 2064 6174 613d 6466 2c0a 2020       data=df,.  
+00037ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038000: 2020 2020 2020 2020 2020 783d 2265 7661            x="eva
+00038010: 6c5f 706f 6c69 6379 222c 0a20 2020 2020  l_policy",.     
+00038020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038030: 2020 2020 2020 2079 3d22 706f 6c69 6379         y="policy
+00038040: 5f76 616c 7565 222c 0a20 2020 2020 2020  _value",.       
+00038050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038060: 2020 2020 2068 7565 3d22 6265 6861 7669       hue="behavi
+00038070: 6f72 5f70 6f6c 6963 7922 2c0a 2020 2020  or_policy",.    
+00038080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038090: 2020 2020 2020 2020 7363 616c 653d 2277          scale="w
+000380a0: 6964 7468 222c 0a20 2020 2020 2020 2020  idth",.         
+000380b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000380c0: 2020 2077 6964 7468 3d30 2e38 2c0a 2020     width=0.8,.  
+000380d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000380e0: 2020 2020 2020 2020 2020 7061 6c65 7474            palett
+000380f0: 653d 7061 6c65 7474 652c 0a20 2020 2020  e=palette,.     
+00038100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038110: 2020 2020 2020 2061 783d 6178 2c0a 2020         ax=ax,.  
 00038120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038130: 2020 2020 2020 2020 2068 7565 3d22 6265           hue="be
-00038140: 6861 7669 6f72 5f70 6f6c 6963 7922 2c0a  havior_policy",.
-00038150: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038160: 2020 2020 2020 2020 2020 2020 7363 616c              scal
-00038170: 653d 2277 6964 7468 222c 0a20 2020 2020  e="width",.     
-00038180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038190: 2020 2020 2020 2077 6964 7468 3d30 2e38         width=0.8
-000381a0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000381b0: 2020 2020 2020 2020 2020 2020 2020 7061                pa
-000381c0: 6c65 7474 653d 7061 6c65 7474 652c 0a20  lette=palette,. 
+00038130: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+00038140: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+00038150: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00038160: 2020 2020 2020 2020 2020 2074 7279 3a0a             try:.
+00038170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038180: 2020 2020 2020 2020 2020 2020 736e 732e              sns.
+00038190: 7377 6172 6d70 6c6f 7428 0a20 2020 2020  swarmplot(.     
+000381a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000381b0: 2020 2020 2020 2020 2020 2064 6174 613d             data=
+000381c0: 6466 2c0a 2020 2020 2020 2020 2020 2020  df,.            
 000381d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000381e0: 2020 2020 2020 2020 2020 2061 783d 6178             ax=ax
-000381f0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00038200: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
-00038210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038220: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00038230: 2020 2020 2020 2020 2020 2020 2020 2074                 t
-00038240: 7279 3a0a 2020 2020 2020 2020 2020 2020  ry:.            
-00038250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038260: 736e 732e 7377 6172 6d70 6c6f 7428 0a20  sns.swarmplot(. 
-00038270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038280: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-00038290: 6174 613d 6466 2c0a 2020 2020 2020 2020  ata=df,.        
-000382a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000382b0: 2020 2020 2020 2020 783d 2265 7661 6c5f          x="eval_
-000382c0: 706f 6c69 6379 222c 0a20 2020 2020 2020  policy",.       
-000382d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000382e0: 2020 2020 2020 2020 2079 3d22 706f 6c69           y="poli
-000382f0: 6379 5f76 616c 7565 222c 0a20 2020 2020  cy_value",.     
+000381e0: 2020 2020 783d 2265 7661 6c5f 706f 6c69      x="eval_poli
+000381f0: 6379 222c 0a20 2020 2020 2020 2020 2020  cy",.           
+00038200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038210: 2020 2020 2079 3d22 706f 6c69 6379 5f76       y="policy_v
+00038220: 616c 7565 222c 0a20 2020 2020 2020 2020  alue",.         
+00038230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038240: 2020 2020 2020 2068 7565 3d22 6265 6861         hue="beha
+00038250: 7669 6f72 5f70 6f6c 6963 7922 2c0a 2020  vior_policy",.  
+00038260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038270: 2020 2020 2020 2020 2020 2020 2020 7061                pa
+00038280: 6c65 7474 653d 7061 6c65 7474 652c 0a20  lette=palette,. 
+00038290: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000382a0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+000382b0: 783d 6178 2c0a 2020 2020 2020 2020 2020  x=ax,.          
+000382c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000382d0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+000382e0: 2020 2020 2020 2020 2020 2020 6578 6365              exce
+000382f0: 7074 3a0a 2020 2020 2020 2020 2020 2020  pt:.            
 00038300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038310: 2020 2020 2020 2020 2020 2068 7565 3d22             hue="
-00038320: 6265 6861 7669 6f72 5f70 6f6c 6963 7922  behavior_policy"
-00038330: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00038310: 7761 726e 2822 456e 636f 756e 7465 7265  warn("Encountere
+00038320: 6420 4e61 4e20 7661 6c75 6573 2064 7572  d NaN values dur
+00038330: 696e 6720 706c 6f74 2e22 290a 0a20 2020  ing plot.")..   
 00038340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038350: 2020 7061 6c65 7474 653d 7061 6c65 7474    palette=palett
-00038360: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+00038350: 2069 6620 7669 7375 616c 697a 655f 6f6e   if visualize_on
+00038360: 5f70 6f6c 6963 793a 0a20 2020 2020 2020  _policy:.       
 00038370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038380: 2020 2061 783d 6178 2c0a 2020 2020 2020     ax=ax,.      
+00038380: 2061 782e 7363 6174 7465 7228 0a20 2020   ax.scatter(.   
 00038390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000383a0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-000383b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000383c0: 6578 6365 7074 3a0a 2020 2020 2020 2020  except:.        
+000383a0: 2020 2020 2020 2020 206e 702e 6172 616e           np.aran
+000383b0: 6765 286e 5f65 7661 6c5f 706f 6c69 6369  ge(n_eval_polici
+000383c0: 6573 292c 0a20 2020 2020 2020 2020 2020  es),.           
 000383d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000383e0: 2020 2020 7761 726e 2822 456e 636f 756e      warn("Encoun
-000383f0: 7465 7265 6420 4e61 4e20 7661 6c75 6573  tered NaN values
-00038400: 2064 7572 696e 6720 706c 6f74 2e22 290a   during plot.").
-00038410: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00038420: 2020 2020 2069 6620 7669 7375 616c 697a       if visualiz
-00038430: 655f 6f6e 5f70 6f6c 6963 793a 0a20 2020  e_on_policy:.   
+000383e0: 206f 6e5f 706f 6c69 6379 2c0a 2020 2020   on_policy,.    
+000383f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038400: 2020 2020 2020 2020 636f 6c6f 723d 2262          color="b
+00038410: 6c61 636b 222c 0a20 2020 2020 2020 2020  lack",.         
+00038420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038430: 2020 206d 6172 6b65 723d 222a 222c 0a20     marker="*",. 
 00038440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038450: 2020 2020 2061 782e 7363 6174 7465 7228       ax.scatter(
-00038460: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00038470: 2020 2020 2020 2020 2020 2020 206e 702e               np.
-00038480: 6172 616e 6765 286e 5f65 7661 6c5f 706f  arange(n_eval_po
-00038490: 6c69 6369 6573 292c 0a20 2020 2020 2020  licies),.       
+00038450: 2020 2020 2020 2020 2020 2073 3d31 3530             s=150
+00038460: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00038470: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+00038480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038490: 2069 6620 6c65 6765 6e64 3a0a 2020 2020   if legend:.    
 000384a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000384b0: 2020 2020 206f 6e5f 706f 6c69 6379 2c0a       on_policy,.
-000384c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000384d0: 2020 2020 2020 2020 2020 2020 636f 6c6f              colo
-000384e0: 723d 2262 6c61 636b 222c 0a20 2020 2020  r="black",.     
+000384b0: 2020 2020 6178 2e6c 6567 656e 6428 6c6f      ax.legend(lo
+000384c0: 633d 226c 6f77 6572 2072 6967 6874 2229  c="lower right")
+000384d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000384e0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
 000384f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038500: 2020 2020 2020 206d 6172 6b65 723d 222a         marker="*
-00038510: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-00038520: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00038530: 3d31 3530 2c0a 2020 2020 2020 2020 2020  =150,.          
-00038540: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-00038550: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00038560: 2020 2020 2069 6620 6c65 6765 6e64 3a0a       if legend:.
-00038570: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038580: 2020 2020 2020 2020 6178 2e6c 6567 656e          ax.legen
-00038590: 6428 6c6f 633d 226c 6f77 6572 2072 6967  d(loc="lower rig
-000385a0: 6874 2229 0a20 2020 2020 2020 2020 2020  ht").           
-000385b0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+00038500: 2020 2061 782e 6765 745f 6c65 6765 6e64     ax.get_legend
+00038510: 2829 2e72 656d 6f76 6528 290a 0a20 2020  ().remove()..   
+00038520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038530: 2061 782e 7365 745f 7469 746c 6528 6573   ax.set_title(es
+00038540: 7469 6d61 746f 722c 2066 6f6e 7473 697a  timator, fontsiz
+00038550: 653d 3136 290a 2020 2020 2020 2020 2020  e=16).          
+00038560: 2020 2020 2020 2020 2020 6178 2e73 6574            ax.set
+00038570: 5f78 6c61 6265 6c28 2222 290a 2020 2020  _xlabel("").    
+00038580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038590: 6178 2e73 6574 5f79 6c61 6265 6c28 0a20  ax.set_ylabel(. 
+000385a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000385b0: 2020 2020 2020 2079 6c61 6265 6c2c 0a20         ylabel,. 
 000385c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000385d0: 2020 2020 2020 2061 782e 6765 745f 6c65         ax.get_le
-000385e0: 6765 6e64 2829 2e72 656d 6f76 6528 290a  gend().remove().
-000385f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00038600: 2020 2020 2061 782e 7365 745f 7469 746c       ax.set_titl
-00038610: 6528 6573 7469 6d61 746f 722c 2066 6f6e  e(estimator, fon
-00038620: 7473 697a 653d 3136 290a 2020 2020 2020  tsize=16).      
-00038630: 2020 2020 2020 2020 2020 2020 2020 6178                ax
-00038640: 2e73 6574 5f78 6c61 6265 6c28 2222 290a  .set_xlabel("").
-00038650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038660: 2020 2020 6178 2e73 6574 5f79 6c61 6265      ax.set_ylabe
-00038670: 6c28 0a20 2020 2020 2020 2020 2020 2020  l(.             
-00038680: 2020 2020 2020 2020 2020 2079 6c61 6265             ylabe
-00038690: 6c2c 0a20 2020 2020 2020 2020 2020 2020  l,.             
-000386a0: 2020 2020 2020 2020 2020 2066 6f6e 7473             fonts
-000386b0: 697a 653d 3132 2c0a 2020 2020 2020 2020  ize=12,.        
-000386c0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-000386d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000386e0: 2020 6178 2e73 6574 5f78 7469 636b 7328    ax.set_xticks(
-000386f0: 6e70 2e61 7261 6e67 6528 6e5f 6576 616c  np.arange(n_eval
-00038700: 5f70 6f6c 6963 6965 7329 2c20 6c69 7374  _policies), list
-00038710: 2869 6e70 7574 5f64 6963 745f 302e 6b65  (input_dict_0.ke
-00038720: 7973 2829 2929 0a20 2020 2020 2020 2020  ys())).         
-00038730: 2020 2020 2020 2020 2020 2070 6c74 2e79             plt.y
-00038740: 7469 636b 7328 666f 6e74 7369 7a65 3d31  ticks(fontsize=1
-00038750: 3229 0a20 2020 2020 2020 2020 2020 2020  2).             
-00038760: 2020 2020 2020 2070 6c74 2e78 7469 636b         plt.xtick
-00038770: 7328 666f 6e74 7369 7a65 3d31 3229 0a0a  s(fontsize=12)..
-00038780: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00038790: 2020 2020 2020 2020 2020 6e5f 6461 7461            n_data
-000387a0: 7365 7473 203d 2069 6e70 7574 5f64 6963  sets = input_dic
-000387b0: 742e 6e5f 6461 7461 7365 7473 5b62 6568  t.n_datasets[beh
-000387c0: 6176 696f 725f 706f 6c69 6379 5f6e 616d  avior_policy_nam
-000387d0: 655d 0a0a 2020 2020 2020 2020 2020 2020  e]..            
-000387e0: 6966 2068 7565 203d 3d20 2265 7374 696d  if hue == "estim
-000387f0: 6174 6f72 223a 0a20 2020 2020 2020 2020  ator":.         
-00038800: 2020 2020 2020 2066 6967 203d 2070 6c74         fig = plt
-00038810: 2e66 6967 7572 6528 6669 6773 697a 653d  .figure(figsize=
-00038820: 2832 202a 206e 5f65 7374 696d 6174 6f72  (2 * n_estimator
-00038830: 732c 2034 202a 206e 5f65 7661 6c5f 706f  s, 4 * n_eval_po
-00038840: 6c69 6369 6573 2929 0a0a 2020 2020 2020  licies))..      
-00038850: 2020 2020 2020 2020 2020 7061 6c65 7474            palett
-00038860: 6520 3d20 7b7d 0a20 2020 2020 2020 2020  e = {}.         
-00038870: 2020 2020 2020 2066 6f72 206a 2c20 6573         for j, es
-00038880: 7469 6d61 746f 7220 696e 2065 6e75 6d65  timator in enume
-00038890: 7261 7465 2863 6f6d 7061 7265 645f 6573  rate(compared_es
-000388a0: 7469 6d61 746f 7273 293a 0a20 2020 2020  timators):.     
-000388b0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-000388c0: 616c 6574 7465 5b65 7374 696d 6174 6f72  alette[estimator
-000388d0: 5d20 3d20 636f 6c6f 725b 6a20 2520 6e5f  ] = color[j % n_
-000388e0: 636f 6c6f 7273 5d0a 0a20 2020 2020 2020  colors]..       
-000388f0: 2020 2020 2020 2020 2066 6f72 2069 2c20           for i, 
-00038900: 6576 616c 5f70 6f6c 6963 7920 696e 2065  eval_policy in e
-00038910: 6e75 6d65 7261 7465 2869 6e70 7574 5f64  numerate(input_d
-00038920: 6963 745f 302e 6b65 7973 2829 293a 0a20  ict_0.keys()):. 
-00038930: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038940: 2020 2069 6620 6920 3d3d 2030 3a0a 2020     if i == 0:.  
-00038950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038960: 2020 2020 2020 6178 203d 2061 7830 203d        ax = ax0 =
-00038970: 2066 6967 2e61 6464 5f73 7562 706c 6f74   fig.add_subplot
-00038980: 286e 5f65 7661 6c5f 706f 6c69 6369 6573  (n_eval_policies
-00038990: 2c20 312c 2069 202b 2031 290a 2020 2020  , 1, i + 1).    
+000385d0: 2020 2020 2020 2066 6f6e 7473 697a 653d         fontsize=
+000385e0: 3132 2c0a 2020 2020 2020 2020 2020 2020  12,.            
+000385f0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00038600: 2020 2020 2020 2020 2020 2020 2020 6178                ax
+00038610: 2e73 6574 5f78 7469 636b 7328 6e70 2e61  .set_xticks(np.a
+00038620: 7261 6e67 6528 6e5f 6576 616c 5f70 6f6c  range(n_eval_pol
+00038630: 6963 6965 7329 2c20 6c69 7374 2869 6e70  icies), list(inp
+00038640: 7574 5f64 6963 745f 302e 6b65 7973 2829  ut_dict_0.keys()
+00038650: 2929 0a20 2020 2020 2020 2020 2020 2020  )).             
+00038660: 2020 2020 2020 2070 6c74 2e79 7469 636b         plt.ytick
+00038670: 7328 666f 6e74 7369 7a65 3d31 3229 0a20  s(fontsize=12). 
+00038680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038690: 2020 2070 6c74 2e78 7469 636b 7328 666f     plt.xticks(fo
+000386a0: 6e74 7369 7a65 3d31 3229 0a0a 2020 2020  ntsize=12)..    
+000386b0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+000386c0: 2020 2020 2020 6e5f 6461 7461 7365 7473        n_datasets
+000386d0: 203d 2069 6e70 7574 5f64 6963 742e 6e5f   = input_dict.n_
+000386e0: 6461 7461 7365 7473 5b62 6568 6176 696f  datasets[behavio
+000386f0: 725f 706f 6c69 6379 5f6e 616d 655d 0a0a  r_policy_name]..
+00038700: 2020 2020 2020 2020 2020 2020 6966 2068              if h
+00038710: 7565 203d 3d20 2265 7374 696d 6174 6f72  ue == "estimator
+00038720: 223a 0a20 2020 2020 2020 2020 2020 2020  ":.             
+00038730: 2020 2066 6967 203d 2070 6c74 2e66 6967     fig = plt.fig
+00038740: 7572 6528 6669 6773 697a 653d 2832 202a  ure(figsize=(2 *
+00038750: 206e 5f65 7374 696d 6174 6f72 732c 2034   n_estimators, 4
+00038760: 202a 206e 5f65 7661 6c5f 706f 6c69 6369   * n_eval_polici
+00038770: 6573 2929 0a0a 2020 2020 2020 2020 2020  es))..          
+00038780: 2020 2020 2020 7061 6c65 7474 6520 3d20        palette = 
+00038790: 7b7d 0a20 2020 2020 2020 2020 2020 2020  {}.             
+000387a0: 2020 2066 6f72 206a 2c20 6573 7469 6d61     for j, estima
+000387b0: 746f 7220 696e 2065 6e75 6d65 7261 7465  tor in enumerate
+000387c0: 2863 6f6d 7061 7265 645f 6573 7469 6d61  (compared_estima
+000387d0: 746f 7273 293a 0a20 2020 2020 2020 2020  tors):.         
+000387e0: 2020 2020 2020 2020 2020 2070 616c 6574             palet
+000387f0: 7465 5b65 7374 696d 6174 6f72 5d20 3d20  te[estimator] = 
+00038800: 636f 6c6f 725b 6a20 2520 6e5f 636f 6c6f  color[j % n_colo
+00038810: 7273 5d0a 0a20 2020 2020 2020 2020 2020  rs]..           
+00038820: 2020 2020 2066 6f72 2069 2c20 6576 616c       for i, eval
+00038830: 5f70 6f6c 6963 7920 696e 2065 6e75 6d65  _policy in enume
+00038840: 7261 7465 2869 6e70 7574 5f64 6963 745f  rate(input_dict_
+00038850: 302e 6b65 7973 2829 293a 0a20 2020 2020  0.keys()):.     
+00038860: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00038870: 6620 6920 3d3d 2030 3a0a 2020 2020 2020  f i == 0:.      
+00038880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038890: 2020 6178 203d 2061 7830 203d 2066 6967    ax = ax0 = fig
+000388a0: 2e61 6464 5f73 7562 706c 6f74 286e 5f65  .add_subplot(n_e
+000388b0: 7661 6c5f 706f 6c69 6369 6573 2c20 312c  val_policies, 1,
+000388c0: 2069 202b 2031 290a 2020 2020 2020 2020   i + 1).        
+000388d0: 2020 2020 2020 2020 2020 2020 656c 6966              elif
+000388e0: 2073 6861 7265 793a 0a20 2020 2020 2020   sharey:.       
+000388f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038900: 2061 7820 3d20 6669 672e 6164 645f 7375   ax = fig.add_su
+00038910: 6270 6c6f 7428 6e5f 6576 616c 5f70 6f6c  bplot(n_eval_pol
+00038920: 6963 6965 732c 2031 2c20 6920 2b20 312c  icies, 1, i + 1,
+00038930: 2073 6861 7265 793d 6178 3029 0a20 2020   sharey=ax0).   
+00038940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038950: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00038960: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+00038970: 7820 3d20 6669 672e 6164 645f 7375 6270  x = fig.add_subp
+00038980: 6c6f 7428 6e5f 6576 616c 5f70 6f6c 6963  lot(n_eval_polic
+00038990: 6965 732c 2031 2c20 6920 2b20 3129 0a0a  ies, 1, i + 1)..
 000389a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000389b0: 656c 6966 2073 6861 7265 793a 0a20 2020  elif sharey:.   
-000389c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000389d0: 2020 2020 2061 7820 3d20 6669 672e 6164       ax = fig.ad
-000389e0: 645f 7375 6270 6c6f 7428 6e5f 6576 616c  d_subplot(n_eval
-000389f0: 5f70 6f6c 6963 6965 732c 2031 2c20 6920  _policies, 1, i 
-00038a00: 2b20 312c 2073 6861 7265 793d 6178 3029  + 1, sharey=ax0)
-00038a10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00038a20: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00038a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038a40: 2020 2061 7820 3d20 6669 672e 6164 645f     ax = fig.add_
-00038a50: 7375 6270 6c6f 7428 6e5f 6576 616c 5f70  subplot(n_eval_p
-00038a60: 6f6c 6963 6965 732c 2031 2c20 6920 2b20  olicies, 1, i + 
-00038a70: 3129 0a0a 2020 2020 2020 2020 2020 2020  1)..            
-00038a80: 2020 2020 2020 2020 6466 203d 2044 6174          df = Dat
-00038a90: 6146 7261 6d65 2829 0a20 2020 2020 2020  aFrame().       
-00038aa0: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-00038ab0: 206a 2c20 6573 7469 6d61 746f 7220 696e   j, estimator in
-00038ac0: 2065 6e75 6d65 7261 7465 2863 6f6d 7061   enumerate(compa
-00038ad0: 7265 645f 6573 7469 6d61 746f 7273 293a  red_estimators):
-00038ae0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00038af0: 2020 2020 2020 2020 2064 665b 6573 7469           df[esti
-00038b00: 6d61 746f 725d 203d 2065 7374 696d 6174  mator] = estimat
-00038b10: 696f 6e5f 6469 6374 5b65 7661 6c5f 706f  ion_dict[eval_po
-00038b20: 6c69 6379 5d5b 6573 7469 6d61 746f 725d  licy][estimator]
-00038b30: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00038b40: 2020 2020 2020 6466 5b22 6461 7461 7365        df["datase
-00038b50: 745f 6964 225d 203d 206e 702e 6172 616e  t_id"] = np.aran
-00038b60: 6765 286e 5f64 6174 6173 6574 7329 0a20  ge(n_datasets). 
-00038b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038b80: 2020 2064 6620 3d20 7064 2e6d 656c 7428     df = pd.melt(
-00038b90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00038ba0: 2020 2020 2020 2020 2064 662c 0a20 2020           df,.   
-00038bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038bc0: 2020 2020 2069 645f 7661 7273 3d5b 2264       id_vars=["d
-00038bd0: 6174 6173 6574 5f69 6422 5d2c 0a20 2020  ataset_id"],.   
-00038be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038bf0: 2020 2020 2076 6172 5f6e 616d 653d 2265       var_name="e
-00038c00: 7374 696d 6174 6f72 222c 0a20 2020 2020  stimator",.     
-00038c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038c20: 2020 2076 616c 7565 5f6e 616d 653d 2270     value_name="p
-00038c30: 6f6c 6963 795f 7661 6c75 6522 2c0a 2020  olicy_value",.  
-00038c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038c50: 2020 290a 0a20 2020 2020 2020 2020 2020    )..           
-00038c60: 2020 2020 2020 2020 2069 6620 2864 665b           if (df[
-00038c70: 2270 6f6c 6963 795f 7661 6c75 6522 5d20  "policy_value"] 
-00038c80: 3e20 3165 3130 292e 7375 6d28 2920 2b20  > 1e10).sum() + 
-00038c90: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00038ca0: 2020 2020 2020 2020 2020 6466 5b22 706f            df["po
-00038cb0: 6c69 6379 5f76 616c 7565 225d 203c 202d  licy_value"] < -
-00038cc0: 3165 3130 0a20 2020 2020 2020 2020 2020  1e10.           
-00038cd0: 2020 2020 2020 2020 2029 2e73 756d 2829           ).sum()
-00038ce0: 203e 2030 3a0a 2020 2020 2020 2020 2020   > 0:.          
-00038cf0: 2020 2020 2020 2020 2020 2020 2020 7761                wa
-00038d00: 726e 280a 2020 2020 2020 2020 2020 2020  rn(.            
-00038d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038d20: 2246 6f75 6e64 2061 206c 6172 6765 2061  "Found a large a
-00038d30: 6273 6f6c 7574 6520 7661 6c75 6520 696e  bsolute value in
-00038d40: 2074 6865 2070 6f6c 6963 7920 7661 6c75   the policy valu
-00038d50: 6520 6573 7469 6d61 7465 2e20 5468 6520  e estimate. The 
-00038d60: 7661 6c75 6520 6d6f 7265 2074 6861 6e20  value more than 
-00038d70: 3165 3130 2061 6e64 206c 6573 7320 7468  1e10 and less th
-00038d80: 616e 202d 3165 3130 2077 696c 6c20 6265  an -1e10 will be
-00038d90: 2072 6570 6c61 6365 6420 746f 206e 702e   replaced to np.
-00038da0: 6e61 6e2e 220a 2020 2020 2020 2020 2020  nan.".          
-00038db0: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-00038dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038dd0: 2020 2020 2020 2020 6466 5b22 706f 6c69          df["poli
-00038de0: 6379 5f76 616c 7565 225d 203d 2064 665b  cy_value"] = df[
-00038df0: 2270 6f6c 6963 795f 7661 6c75 6522 5d2e  "policy_value"].
-00038e00: 6d61 736b 280a 2020 2020 2020 2020 2020  mask(.          
-00038e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038e20: 2020 6466 5b22 706f 6c69 6379 5f76 616c    df["policy_val
-00038e30: 7565 225d 203e 2031 652d 3130 2c20 6e70  ue"] > 1e-10, np
-00038e40: 2e6e 616e 0a20 2020 2020 2020 2020 2020  .nan.           
-00038e50: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
-00038e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038e70: 2020 2020 2020 2064 665b 2270 6f6c 6963         df["polic
-00038e80: 795f 7661 6c75 6522 5d20 3d20 6466 5b22  y_value"] = df["
-00038e90: 706f 6c69 6379 5f76 616c 7565 225d 2e6d  policy_value"].m
-00038ea0: 6173 6b28 0a20 2020 2020 2020 2020 2020  ask(.           
-00038eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038ec0: 2064 665b 2270 6f6c 6963 795f 7661 6c75   df["policy_valu
-00038ed0: 6522 5d20 3c20 2d31 652d 3130 2c20 6e70  e"] < -1e-10, np
-00038ee0: 2e6e 616e 0a20 2020 2020 2020 2020 2020  .nan.           
-00038ef0: 2020 2020 2020 2020 2020 2020 2029 0a0a               )..
+000389b0: 2020 2020 6466 203d 2044 6174 6146 7261      df = DataFra
+000389c0: 6d65 2829 0a20 2020 2020 2020 2020 2020  me().           
+000389d0: 2020 2020 2020 2020 2066 6f72 206a 2c20           for j, 
+000389e0: 6573 7469 6d61 746f 7220 696e 2065 6e75  estimator in enu
+000389f0: 6d65 7261 7465 2863 6f6d 7061 7265 645f  merate(compared_
+00038a00: 6573 7469 6d61 746f 7273 293a 0a20 2020  estimators):.   
+00038a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038a20: 2020 2020 2064 665b 6573 7469 6d61 746f       df[estimato
+00038a30: 725d 203d 2065 7374 696d 6174 696f 6e5f  r] = estimation_
+00038a40: 6469 6374 5b65 7661 6c5f 706f 6c69 6379  dict[eval_policy
+00038a50: 5d5b 6573 7469 6d61 746f 725d 0a0a 2020  ][estimator]..  
+00038a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038a70: 2020 6466 5b22 6461 7461 7365 745f 6964    df["dataset_id
+00038a80: 225d 203d 206e 702e 6172 616e 6765 286e  "] = np.arange(n
+00038a90: 5f64 6174 6173 6574 7329 0a20 2020 2020  _datasets).     
+00038aa0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+00038ab0: 6620 3d20 7064 2e6d 656c 7428 0a20 2020  f = pd.melt(.   
+00038ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038ad0: 2020 2020 2064 662c 0a20 2020 2020 2020       df,.       
+00038ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038af0: 2069 645f 7661 7273 3d5b 2264 6174 6173   id_vars=["datas
+00038b00: 6574 5f69 6422 5d2c 0a20 2020 2020 2020  et_id"],.       
+00038b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038b20: 2076 6172 5f6e 616d 653d 2265 7374 696d   var_name="estim
+00038b30: 6174 6f72 222c 0a20 2020 2020 2020 2020  ator",.         
+00038b40: 2020 2020 2020 2020 2020 2020 2020 2076                 v
+00038b50: 616c 7565 5f6e 616d 653d 2270 6f6c 6963  alue_name="polic
+00038b60: 795f 7661 6c75 6522 2c0a 2020 2020 2020  y_value",.      
+00038b70: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+00038b80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00038b90: 2020 2020 2069 6620 2864 665b 2270 6f6c       if (df["pol
+00038ba0: 6963 795f 7661 6c75 6522 5d20 3e20 3165  icy_value"] > 1e
+00038bb0: 3130 292e 7375 6d28 2920 2b20 280a 2020  10).sum() + (.  
+00038bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038bd0: 2020 2020 2020 6466 5b22 706f 6c69 6379        df["policy
+00038be0: 5f76 616c 7565 225d 203c 202d 3165 3130  _value"] < -1e10
+00038bf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00038c00: 2020 2020 2029 2e73 756d 2829 203e 2030       ).sum() > 0
+00038c10: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00038c20: 2020 2020 2020 2020 2020 7761 726e 280a            warn(.
+00038c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038c40: 2020 2020 2020 2020 2020 2020 2246 6f75              "Fou
+00038c50: 6e64 2061 206c 6172 6765 2061 6273 6f6c  nd a large absol
+00038c60: 7574 6520 7661 6c75 6520 696e 2074 6865  ute value in the
+00038c70: 2070 6f6c 6963 7920 7661 6c75 6520 6573   policy value es
+00038c80: 7469 6d61 7465 2e20 5468 6520 7661 6c75  timate. The valu
+00038c90: 6520 6d6f 7265 2074 6861 6e20 3165 3130  e more than 1e10
+00038ca0: 2061 6e64 206c 6573 7320 7468 616e 202d   and less than -
+00038cb0: 3165 3130 2077 696c 6c20 6265 2072 6570  1e10 will be rep
+00038cc0: 6c61 6365 6420 746f 206e 702e 6e61 6e2e  laced to np.nan.
+00038cd0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+00038ce0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00038cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038d00: 2020 2020 6466 5b22 706f 6c69 6379 5f76      df["policy_v
+00038d10: 616c 7565 225d 203d 2064 665b 2270 6f6c  alue"] = df["pol
+00038d20: 6963 795f 7661 6c75 6522 5d2e 6d61 736b  icy_value"].mask
+00038d30: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00038d40: 2020 2020 2020 2020 2020 2020 2020 6466                df
+00038d50: 5b22 706f 6c69 6379 5f76 616c 7565 225d  ["policy_value"]
+00038d60: 203e 2031 652d 3130 2c20 6e70 2e6e 616e   > 1e-10, np.nan
+00038d70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00038d80: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00038d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038da0: 2020 2064 665b 2270 6f6c 6963 795f 7661     df["policy_va
+00038db0: 6c75 6522 5d20 3d20 6466 5b22 706f 6c69  lue"] = df["poli
+00038dc0: 6379 5f76 616c 7565 225d 2e6d 6173 6b28  cy_value"].mask(
+00038dd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00038de0: 2020 2020 2020 2020 2020 2020 2064 665b               df[
+00038df0: 2270 6f6c 6963 795f 7661 6c75 6522 5d20  "policy_value"] 
+00038e00: 3c20 2d31 652d 3130 2c20 6e70 2e6e 616e  < -1e-10, np.nan
+00038e10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00038e20: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
+00038e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038e40: 6966 2070 6c6f 745f 7479 7065 203d 3d20  if plot_type == 
+00038e50: 2263 6922 3a0a 2020 2020 2020 2020 2020  "ci":.          
+00038e60: 2020 2020 2020 2020 2020 2020 2020 736e                sn
+00038e70: 732e 6261 7270 6c6f 7428 0a20 2020 2020  s.barplot(.     
+00038e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038e90: 2020 2020 2020 2064 6174 613d 6466 2c0a         data=df,.
+00038ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038eb0: 2020 2020 2020 2020 2020 2020 783d 2265              x="e
+00038ec0: 7374 696d 6174 6f72 222c 0a20 2020 2020  stimator",.     
+00038ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038ee0: 2020 2020 2020 2079 3d22 706f 6c69 6379         y="policy
+00038ef0: 5f76 616c 7565 222c 0a20 2020 2020 2020  _value",.       
 00038f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038f10: 2020 2020 6966 2070 6c6f 745f 7479 7065      if plot_type
-00038f20: 203d 3d20 2263 6922 3a0a 2020 2020 2020   == "ci":.      
+00038f10: 2020 2020 2070 616c 6574 7465 3d70 616c       palette=pal
+00038f20: 6574 7465 2c0a 2020 2020 2020 2020 2020  ette,.          
 00038f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038f40: 2020 736e 732e 6261 7270 6c6f 7428 0a20    sns.barplot(. 
+00038f40: 2020 6178 3d61 782c 0a20 2020 2020 2020    ax=ax,.       
 00038f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038f60: 2020 2020 2020 2020 2020 2064 6174 613d             data=
-00038f70: 6466 2c0a 2020 2020 2020 2020 2020 2020  df,.            
-00038f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038f90: 783d 2265 7374 696d 6174 6f72 222c 0a20  x="estimator",. 
-00038fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038fb0: 2020 2020 2020 2020 2020 2079 3d22 706f             y="po
-00038fc0: 6c69 6379 5f76 616c 7565 222c 0a20 2020  licy_value",.   
-00038fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00038fe0: 2020 2020 2020 2020 2070 616c 6574 7465           palette
-00038ff0: 3d70 616c 6574 7465 2c0a 2020 2020 2020  =palette,.      
-00039000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039010: 2020 2020 2020 6178 3d61 782c 0a20 2020        ax=ax,.   
-00039020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039030: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-00039040: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
-00039050: 706c 6f74 5f74 7970 6520 3d3d 2022 7669  plot_type == "vi
-00039060: 6f6c 696e 223a 0a20 2020 2020 2020 2020  olin":.         
-00039070: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00039080: 6e73 2e76 696f 6c69 6e70 6c6f 7428 0a20  ns.violinplot(. 
+00038f60: 2029 0a20 2020 2020 2020 2020 2020 2020   ).             
+00038f70: 2020 2020 2020 2065 6c69 6620 706c 6f74         elif plot
+00038f80: 5f74 7970 6520 3d3d 2022 7669 6f6c 696e  _type == "violin
+00038f90: 223a 0a20 2020 2020 2020 2020 2020 2020  ":.             
+00038fa0: 2020 2020 2020 2020 2020 2073 6e73 2e76             sns.v
+00038fb0: 696f 6c69 6e70 6c6f 7428 0a20 2020 2020  iolinplot(.     
+00038fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038fd0: 2020 2020 2020 2064 6174 613d 6466 2c0a         data=df,.
+00038fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00038ff0: 2020 2020 2020 2020 2020 2020 783d 2265              x="e
+00039000: 7374 696d 6174 6f72 222c 0a20 2020 2020  stimator",.     
+00039010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039020: 2020 2020 2020 2079 3d22 706f 6c69 6379         y="policy
+00039030: 5f76 616c 7565 222c 0a20 2020 2020 2020  _value",.       
+00039040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039050: 2020 2020 2073 6361 6c65 3d22 7769 6474       scale="widt
+00039060: 6822 2c0a 2020 2020 2020 2020 2020 2020  h",.            
+00039070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039080: 7769 6474 683d 302e 382c 0a20 2020 2020  width=0.8,.     
 00039090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000390a0: 2020 2020 2020 2020 2020 2064 6174 613d             data=
-000390b0: 6466 2c0a 2020 2020 2020 2020 2020 2020  df,.            
+000390a0: 2020 2020 2020 2070 616c 6574 7465 3d70         palette=p
+000390b0: 616c 6574 7465 2c0a 2020 2020 2020 2020  alette,.        
 000390c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000390d0: 783d 2265 7374 696d 6174 6f72 222c 0a20  x="estimator",. 
+000390d0: 2020 2020 6178 3d61 782c 0a20 2020 2020      ax=ax,.     
 000390e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000390f0: 2020 2020 2020 2020 2020 2079 3d22 706f             y="po
-00039100: 6c69 6379 5f76 616c 7565 222c 0a20 2020  licy_value",.   
+000390f0: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+00039100: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
 00039110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039120: 2020 2020 2020 2020 2073 6361 6c65 3d22           scale="
-00039130: 7769 6474 6822 2c0a 2020 2020 2020 2020  width",.        
-00039140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039150: 2020 2020 7769 6474 683d 302e 382c 0a20      width=0.8,. 
+00039120: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
+00039130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039140: 2020 2020 2020 2020 736e 732e 7377 6172          sns.swar
+00039150: 6d70 6c6f 7428 0a20 2020 2020 2020 2020  mplot(.         
 00039160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039170: 2020 2020 2020 2020 2020 2070 616c 6574             palet
-00039180: 7465 3d70 616c 6574 7465 2c0a 2020 2020  te=palette,.    
+00039170: 2020 2020 2020 2064 6174 613d 6466 2c0a         data=df,.
+00039180: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00039190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000391a0: 2020 2020 2020 2020 6178 3d61 782c 0a20          ax=ax,. 
+000391a0: 783d 2265 7374 696d 6174 6f72 222c 0a20  x="estimator",. 
 000391b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000391c0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-000391d0: 2020 2020 2020 2020 2020 2020 2065 6c73               els
-000391e0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-000391f0: 2020 2020 2020 2020 2020 2074 7279 3a0a             try:.
-00039200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039210: 2020 2020 2020 2020 2020 2020 736e 732e              sns.
-00039220: 7377 6172 6d70 6c6f 7428 0a20 2020 2020  swarmplot(.     
-00039230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039240: 2020 2020 2020 2020 2020 2064 6174 613d             data=
-00039250: 6466 2c0a 2020 2020 2020 2020 2020 2020  df,.            
-00039260: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039270: 2020 2020 783d 2265 7374 696d 6174 6f72      x="estimator
-00039280: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-00039290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000392a0: 2020 2079 3d22 706f 6c69 6379 5f76 616c     y="policy_val
-000392b0: 7565 222c 0a20 2020 2020 2020 2020 2020  ue",.           
+000391c0: 2020 2020 2020 2020 2020 2020 2020 2079                 y
+000391d0: 3d22 706f 6c69 6379 5f76 616c 7565 222c  ="policy_value",
+000391e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000391f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039200: 2070 616c 6574 7465 3d70 616c 6574 7465   palette=palette
+00039210: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00039220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039230: 2020 6178 3d61 782c 0a20 2020 2020 2020    ax=ax,.       
+00039240: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039250: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+00039260: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00039270: 7863 6570 743a 0a20 2020 2020 2020 2020  xcept:.         
+00039280: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039290: 2020 2077 6172 6e28 2245 6e63 6f75 6e74     warn("Encount
+000392a0: 6572 6564 204e 614e 2076 616c 7565 7320  ered NaN values 
+000392b0: 6475 7269 6e67 2070 6c6f 742e 2229 0a0a  during plot.")..
 000392c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000392d0: 2020 2020 2070 616c 6574 7465 3d70 616c       palette=pal
-000392e0: 6574 7465 2c0a 2020 2020 2020 2020 2020  ette,.          
-000392f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039300: 2020 2020 2020 6178 3d61 782c 0a20 2020        ax=ax,.   
-00039310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039320: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-00039330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039340: 2020 2065 7863 6570 743a 0a20 2020 2020     except:.     
-00039350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039360: 2020 2020 2020 2077 6172 6e28 2245 6e63         warn("Enc
-00039370: 6f75 6e74 6572 6564 204e 614e 2076 616c  ountered NaN val
-00039380: 7565 7320 6475 7269 6e67 2070 6c6f 742e  ues during plot.
-00039390: 2229 0a0a 2020 2020 2020 2020 2020 2020  ")..            
-000393a0: 2020 2020 2020 2020 6f6e 5f70 6f6c 6963          on_polic
-000393b0: 7920 3d20 6573 7469 6d61 7469 6f6e 5f64  y = estimation_d
-000393c0: 6963 745b 6576 616c 5f70 6f6c 6963 795d  ict[eval_policy]
-000393d0: 5b22 6f6e 5f70 6f6c 6963 7922 5d0a 2020  ["on_policy"].  
-000393e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000393f0: 2020 6966 206f 6e5f 706f 6c69 6379 2069    if on_policy i
-00039400: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
-00039410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039420: 2020 2020 6178 2e73 6361 7474 6572 280a      ax.scatter(.
+000392d0: 2020 2020 6f6e 5f70 6f6c 6963 7920 3d20      on_policy = 
+000392e0: 6573 7469 6d61 7469 6f6e 5f64 6963 745b  estimation_dict[
+000392f0: 6576 616c 5f70 6f6c 6963 795d 5b22 6f6e  eval_policy]["on
+00039300: 5f70 6f6c 6963 7922 5d0a 2020 2020 2020  _policy"].      
+00039310: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00039320: 206f 6e5f 706f 6c69 6379 2069 7320 6e6f   on_policy is no
+00039330: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
+00039340: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039350: 6178 2e73 6361 7474 6572 280a 2020 2020  ax.scatter(.    
+00039360: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039370: 2020 2020 2020 2020 6e70 2e61 7261 6e67          np.arang
+00039380: 6528 6e5f 6573 7469 6d61 746f 7273 292c  e(n_estimators),
+00039390: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000393a0: 2020 2020 2020 2020 2020 2020 206e 702e               np.
+000393b0: 6675 6c6c 2828 6e5f 6573 7469 6d61 746f  full((n_estimato
+000393c0: 7273 292c 206f 6e5f 706f 6c69 6379 292c  rs), on_policy),
+000393d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000393e0: 2020 2020 2020 2020 2020 2020 2063 6f6c               col
+000393f0: 6f72 3d22 626c 6163 6b22 2c0a 2020 2020  or="black",.    
+00039400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039410: 2020 2020 2020 2020 6d61 726b 6572 3d22          marker="
+00039420: 2a22 2c0a 2020 2020 2020 2020 2020 2020  *",.            
 00039430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039440: 2020 2020 2020 2020 2020 2020 6e70 2e61              np.a
-00039450: 7261 6e67 6528 6e5f 6573 7469 6d61 746f  range(n_estimato
-00039460: 7273 292c 0a20 2020 2020 2020 2020 2020  rs),.           
-00039470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039480: 206e 702e 6675 6c6c 2828 6e5f 6573 7469   np.full((n_esti
-00039490: 6d61 746f 7273 292c 206f 6e5f 706f 6c69  mators), on_poli
-000394a0: 6379 292c 0a20 2020 2020 2020 2020 2020  cy),.           
-000394b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000394c0: 2063 6f6c 6f72 3d22 626c 6163 6b22 2c0a   color="black",.
-000394d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000394e0: 2020 2020 2020 2020 2020 2020 6d61 726b              mark
-000394f0: 6572 3d22 2a22 2c0a 2020 2020 2020 2020  er="*",.        
-00039500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039510: 2020 2020 733d 3135 302c 0a20 2020 2020      s=150,.     
-00039520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039530: 2020 2029 0a0a 2020 2020 2020 2020 2020     )..          
-00039540: 2020 2020 2020 2020 2020 6178 2e73 6574            ax.set
-00039550: 5f74 6974 6c65 2865 7661 6c5f 706f 6c69  _title(eval_poli
-00039560: 6379 2c20 666f 6e74 7369 7a65 3d31 3629  cy, fontsize=16)
-00039570: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00039580: 2020 2020 2061 782e 7365 745f 786c 6162       ax.set_xlab
-00039590: 656c 2822 2229 0a20 2020 2020 2020 2020  el("").         
-000395a0: 2020 2020 2020 2020 2020 2061 782e 7365             ax.se
-000395b0: 745f 796c 6162 656c 280a 2020 2020 2020  t_ylabel(.      
+00039440: 733d 3135 302c 0a20 2020 2020 2020 2020  s=150,.         
+00039450: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+00039460: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00039470: 2020 2020 2020 6178 2e73 6574 5f74 6974        ax.set_tit
+00039480: 6c65 2865 7661 6c5f 706f 6c69 6379 2c20  le(eval_policy, 
+00039490: 666f 6e74 7369 7a65 3d31 3629 0a20 2020  fontsize=16).   
+000394a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000394b0: 2061 782e 7365 745f 786c 6162 656c 2822   ax.set_xlabel("
+000394c0: 2229 0a20 2020 2020 2020 2020 2020 2020  ").             
+000394d0: 2020 2020 2020 2061 782e 7365 745f 796c         ax.set_yl
+000394e0: 6162 656c 280a 2020 2020 2020 2020 2020  abel(.          
+000394f0: 2020 2020 2020 2020 2020 2020 2020 796c                yl
+00039500: 6162 656c 2c0a 2020 2020 2020 2020 2020  abel,.          
+00039510: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+00039520: 6e74 7369 7a65 3d31 322c 0a20 2020 2020  ntsize=12,.     
+00039530: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+00039540: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00039550: 2020 2020 2061 782e 7365 745f 7874 6963       ax.set_xtic
+00039560: 6b73 286e 702e 6172 616e 6765 286e 5f65  ks(np.arange(n_e
+00039570: 7374 696d 6174 6f72 7329 2c20 636f 6d70  stimators), comp
+00039580: 6172 6564 5f65 7374 696d 6174 6f72 7329  ared_estimators)
+00039590: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000395a0: 2020 2020 2070 6c74 2e79 7469 636b 7328       plt.yticks(
+000395b0: 666f 6e74 7369 7a65 3d31 3229 0a20 2020  fontsize=12).   
 000395c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000395d0: 2020 796c 6162 656c 2c0a 2020 2020 2020    ylabel,.      
-000395e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000395f0: 2020 666f 6e74 7369 7a65 3d31 322c 0a20    fontsize=12,. 
-00039600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039610: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-00039620: 2020 2020 2020 2020 2061 782e 7365 745f           ax.set_
-00039630: 7874 6963 6b73 286e 702e 6172 616e 6765  xticks(np.arange
-00039640: 286e 5f65 7374 696d 6174 6f72 7329 2c20  (n_estimators), 
-00039650: 636f 6d70 6172 6564 5f65 7374 696d 6174  compared_estimat
-00039660: 6f72 7329 0a20 2020 2020 2020 2020 2020  ors).           
-00039670: 2020 2020 2020 2020 2070 6c74 2e79 7469           plt.yti
-00039680: 636b 7328 666f 6e74 7369 7a65 3d31 3229  cks(fontsize=12)
-00039690: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000396a0: 2020 2020 2070 6c74 2e78 7469 636b 7328       plt.xticks(
-000396b0: 666f 6e74 7369 7a65 3d31 3229 0a0a 2020  fontsize=12)..  
-000396c0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-000396d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000396e0: 7669 7375 616c 697a 655f 6f6e 5f70 6f6c  visualize_on_pol
-000396f0: 6963 7920 3d20 5472 7565 0a20 2020 2020  icy = True.     
-00039700: 2020 2020 2020 2020 2020 2066 6f72 2065             for e
-00039710: 7661 6c5f 706f 6c69 6379 2069 6e20 696e  val_policy in in
-00039720: 7075 745f 6469 6374 5f30 2e6b 6579 7328  put_dict_0.keys(
-00039730: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-00039740: 2020 2020 2020 2069 6620 696e 7075 745f         if input_
-00039750: 6469 6374 5f30 5b65 7661 6c5f 706f 6c69  dict_0[eval_poli
-00039760: 6379 5d5b 226f 6e5f 706f 6c69 6379 5f70  cy]["on_policy_p
-00039770: 6f6c 6963 795f 7661 6c75 6522 5d20 6973  olicy_value"] is
-00039780: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-00039790: 2020 2020 2020 2020 2020 2020 2020 2076                 v
-000397a0: 6973 7561 6c69 7a65 5f6f 6e5f 706f 6c69  isualize_on_poli
-000397b0: 6379 203d 2046 616c 7365 0a0a 2020 2020  cy = False..    
-000397c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000397d0: 6f6e 5f70 6f6c 6963 7920 3d20 6e70 2e7a  on_policy = np.z
-000397e0: 6572 6f73 286e 5f65 7661 6c5f 706f 6c69  eros(n_eval_poli
-000397f0: 6369 6573 290a 2020 2020 2020 2020 2020  cies).          
-00039800: 2020 2020 2020 2020 2020 666f 7220 6a2c            for j,
-00039810: 2065 7661 6c5f 706f 6c69 6379 2069 6e20   eval_policy in 
-00039820: 656e 756d 6572 6174 6528 696e 7075 745f  enumerate(input_
-00039830: 6469 6374 5f30 2e6b 6579 7328 2929 3a0a  dict_0.keys()):.
-00039840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039850: 2020 2020 2020 2020 6f6e 5f70 6f6c 6963          on_polic
-00039860: 795b 6a5d 203d 2065 7374 696d 6174 696f  y[j] = estimatio
-00039870: 6e5f 6469 6374 5b65 7661 6c5f 706f 6c69  n_dict[eval_poli
-00039880: 6379 5d5b 226f 6e5f 706f 6c69 6379 225d  cy]["on_policy"]
-00039890: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000398a0: 2020 6669 6720 3d20 706c 742e 6669 6775    fig = plt.figu
-000398b0: 7265 2866 6967 7369 7a65 3d28 3220 2a20  re(figsize=(2 * 
-000398c0: 6e5f 6576 616c 5f70 6f6c 6963 6965 732c  n_eval_policies,
-000398d0: 2034 202a 206e 5f65 7374 696d 6174 6f72   4 * n_estimator
-000398e0: 7329 290a 0a20 2020 2020 2020 2020 2020  s))..           
-000398f0: 2020 2020 2070 616c 6574 7465 203d 207b       palette = {
-00039900: 7d0a 2020 2020 2020 2020 2020 2020 2020  }.              
-00039910: 2020 666f 7220 6a2c 2065 7661 6c5f 706f    for j, eval_po
-00039920: 6c69 6379 2069 6e20 656e 756d 6572 6174  licy in enumerat
-00039930: 6528 696e 7075 745f 6469 6374 5f30 2e6b  e(input_dict_0.k
-00039940: 6579 7328 2929 3a0a 2020 2020 2020 2020  eys()):.        
-00039950: 2020 2020 2020 2020 2020 2020 7061 6c65              pale
-00039960: 7474 655b 6576 616c 5f70 6f6c 6963 795d  tte[eval_policy]
-00039970: 203d 2063 6f6c 6f72 5b6a 2025 206e 5f63   = color[j % n_c
-00039980: 6f6c 6f72 735d 0a0a 2020 2020 2020 2020  olors]..        
-00039990: 2020 2020 2020 2020 666f 7220 692c 2065          for i, e
-000399a0: 7374 696d 6174 6f72 2069 6e20 656e 756d  stimator in enum
-000399b0: 6572 6174 6528 636f 6d70 6172 6564 5f65  erate(compared_e
-000399c0: 7374 696d 6174 6f72 7329 3a0a 2020 2020  stimators):.    
-000399d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000399e0: 6966 2069 203d 3d20 303a 0a20 2020 2020  if i == 0:.     
+000395d0: 2070 6c74 2e78 7469 636b 7328 666f 6e74   plt.xticks(font
+000395e0: 7369 7a65 3d31 3229 0a0a 2020 2020 2020  size=12)..      
+000395f0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00039600: 2020 2020 2020 2020 2020 2020 7669 7375              visu
+00039610: 616c 697a 655f 6f6e 5f70 6f6c 6963 7920  alize_on_policy 
+00039620: 3d20 5472 7565 0a20 2020 2020 2020 2020  = True.         
+00039630: 2020 2020 2020 2066 6f72 2065 7661 6c5f         for eval_
+00039640: 706f 6c69 6379 2069 6e20 696e 7075 745f  policy in input_
+00039650: 6469 6374 5f30 2e6b 6579 7328 293a 0a20  dict_0.keys():. 
+00039660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039670: 2020 2069 6620 696e 7075 745f 6469 6374     if input_dict
+00039680: 5f30 5b65 7661 6c5f 706f 6c69 6379 5d5b  _0[eval_policy][
+00039690: 226f 6e5f 706f 6c69 6379 5f70 6f6c 6963  "on_policy_polic
+000396a0: 795f 7661 6c75 6522 5d20 6973 204e 6f6e  y_value"] is Non
+000396b0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+000396c0: 2020 2020 2020 2020 2020 2076 6973 7561             visua
+000396d0: 6c69 7a65 5f6f 6e5f 706f 6c69 6379 203d  lize_on_policy =
+000396e0: 2046 616c 7365 0a0a 2020 2020 2020 2020   False..        
+000396f0: 2020 2020 2020 2020 2020 2020 6f6e 5f70              on_p
+00039700: 6f6c 6963 7920 3d20 6e70 2e7a 6572 6f73  olicy = np.zeros
+00039710: 286e 5f65 7661 6c5f 706f 6c69 6369 6573  (n_eval_policies
+00039720: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00039730: 2020 2020 2020 666f 7220 6a2c 2065 7661        for j, eva
+00039740: 6c5f 706f 6c69 6379 2069 6e20 656e 756d  l_policy in enum
+00039750: 6572 6174 6528 696e 7075 745f 6469 6374  erate(input_dict
+00039760: 5f30 2e6b 6579 7328 2929 3a0a 2020 2020  _0.keys()):.    
+00039770: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039780: 2020 2020 6f6e 5f70 6f6c 6963 795b 6a5d      on_policy[j]
+00039790: 203d 2065 7374 696d 6174 696f 6e5f 6469   = estimation_di
+000397a0: 6374 5b65 7661 6c5f 706f 6c69 6379 5d5b  ct[eval_policy][
+000397b0: 226f 6e5f 706f 6c69 6379 225d 0a0a 2020  "on_policy"]..  
+000397c0: 2020 2020 2020 2020 2020 2020 2020 6669                fi
+000397d0: 6720 3d20 706c 742e 6669 6775 7265 2866  g = plt.figure(f
+000397e0: 6967 7369 7a65 3d28 3220 2a20 6e5f 6576  igsize=(2 * n_ev
+000397f0: 616c 5f70 6f6c 6963 6965 732c 2034 202a  al_policies, 4 *
+00039800: 206e 5f65 7374 696d 6174 6f72 7329 290a   n_estimators)).
+00039810: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00039820: 2070 616c 6574 7465 203d 207b 7d0a 2020   palette = {}.  
+00039830: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+00039840: 7220 6a2c 2065 7661 6c5f 706f 6c69 6379  r j, eval_policy
+00039850: 2069 6e20 656e 756d 6572 6174 6528 696e   in enumerate(in
+00039860: 7075 745f 6469 6374 5f30 2e6b 6579 7328  put_dict_0.keys(
+00039870: 2929 3a0a 2020 2020 2020 2020 2020 2020  )):.            
+00039880: 2020 2020 2020 2020 7061 6c65 7474 655b          palette[
+00039890: 6576 616c 5f70 6f6c 6963 795d 203d 2063  eval_policy] = c
+000398a0: 6f6c 6f72 5b6a 2025 206e 5f63 6f6c 6f72  olor[j % n_color
+000398b0: 735d 0a0a 2020 2020 2020 2020 2020 2020  s]..            
+000398c0: 2020 2020 666f 7220 692c 2065 7374 696d      for i, estim
+000398d0: 6174 6f72 2069 6e20 656e 756d 6572 6174  ator in enumerat
+000398e0: 6528 636f 6d70 6172 6564 5f65 7374 696d  e(compared_estim
+000398f0: 6174 6f72 7329 3a0a 2020 2020 2020 2020  ators):.        
+00039900: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+00039910: 203d 3d20 303a 0a20 2020 2020 2020 2020   == 0:.         
+00039920: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+00039930: 7820 3d20 6178 3020 3d20 6669 672e 6164  x = ax0 = fig.ad
+00039940: 645f 7375 6270 6c6f 7428 6e5f 6573 7469  d_subplot(n_esti
+00039950: 6d61 746f 7273 2c20 312c 2069 202b 2031  mators, 1, i + 1
+00039960: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00039970: 2020 2020 2020 656c 6966 2073 6861 7265        elif share
+00039980: 793a 0a20 2020 2020 2020 2020 2020 2020  y:.             
+00039990: 2020 2020 2020 2020 2020 2061 7820 3d20             ax = 
+000399a0: 6669 672e 6164 645f 7375 6270 6c6f 7428  fig.add_subplot(
+000399b0: 6e5f 6573 7469 6d61 746f 7273 2c20 312c  n_estimators, 1,
+000399c0: 2069 202b 2031 2c20 7368 6172 6579 3d61   i + 1, sharey=a
+000399d0: 7830 290a 2020 2020 2020 2020 2020 2020  x0).            
+000399e0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
 000399f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039a00: 2020 2061 7820 3d20 6178 3020 3d20 6669     ax = ax0 = fi
-00039a10: 672e 6164 645f 7375 6270 6c6f 7428 6e5f  g.add_subplot(n_
-00039a20: 6573 7469 6d61 746f 7273 2c20 312c 2069  estimators, 1, i
-00039a30: 202b 2031 290a 2020 2020 2020 2020 2020   + 1).          
-00039a40: 2020 2020 2020 2020 2020 656c 6966 2073            elif s
-00039a50: 6861 7265 793a 0a20 2020 2020 2020 2020  harey:.         
-00039a60: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-00039a70: 7820 3d20 6669 672e 6164 645f 7375 6270  x = fig.add_subp
-00039a80: 6c6f 7428 6e5f 6573 7469 6d61 746f 7273  lot(n_estimators
-00039a90: 2c20 312c 2069 202b 2031 2c20 7368 6172  , 1, i + 1, shar
-00039aa0: 6579 3d61 7830 290a 2020 2020 2020 2020  ey=ax0).        
-00039ab0: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00039ac0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00039ad0: 2020 2020 2020 2020 2020 6178 203d 2066            ax = f
-00039ae0: 6967 2e61 6464 5f73 7562 706c 6f74 286e  ig.add_subplot(n
-00039af0: 5f65 7374 696d 6174 6f72 732c 2031 2c20  _estimators, 1, 
-00039b00: 6920 2b20 3129 0a0a 2020 2020 2020 2020  i + 1)..        
-00039b10: 2020 2020 2020 2020 2020 2020 6466 203d              df =
-00039b20: 2044 6174 6146 7261 6d65 2829 0a20 2020   DataFrame().   
-00039b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039b40: 2066 6f72 206a 2c20 6576 616c 5f70 6f6c   for j, eval_pol
-00039b50: 6963 7920 696e 2065 6e75 6d65 7261 7465  icy in enumerate
-00039b60: 2869 6e70 7574 5f64 6963 745f 302e 6b65  (input_dict_0.ke
-00039b70: 7973 2829 293a 0a20 2020 2020 2020 2020  ys()):.         
-00039b80: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-00039b90: 665b 6576 616c 5f70 6f6c 6963 795d 203d  f[eval_policy] =
-00039ba0: 2065 7374 696d 6174 696f 6e5f 6469 6374   estimation_dict
-00039bb0: 5b65 7661 6c5f 706f 6c69 6379 5d5b 6573  [eval_policy][es
-00039bc0: 7469 6d61 746f 725d 0a0a 2020 2020 2020  timator]..      
-00039bd0: 2020 2020 2020 2020 2020 2020 2020 6466                df
-00039be0: 5b22 6461 7461 7365 745f 6964 225d 203d  ["dataset_id"] =
-00039bf0: 206e 702e 6172 616e 6765 286e 5f64 6174   np.arange(n_dat
-00039c00: 6173 6574 7329 0a20 2020 2020 2020 2020  asets).         
-00039c10: 2020 2020 2020 2020 2020 2064 6620 3d20             df = 
-00039c20: 7064 2e6d 656c 7428 0a20 2020 2020 2020  pd.melt(.       
-00039c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039c40: 2064 662c 0a20 2020 2020 2020 2020 2020   df,.           
-00039c50: 2020 2020 2020 2020 2020 2020 2069 645f               id_
-00039c60: 7661 7273 3d5b 2264 6174 6173 6574 5f69  vars=["dataset_i
-00039c70: 6422 5d2c 0a20 2020 2020 2020 2020 2020  d"],.           
-00039c80: 2020 2020 2020 2020 2020 2020 2076 6172               var
-00039c90: 5f6e 616d 653d 2265 7661 6c5f 706f 6c69  _name="eval_poli
-00039ca0: 6379 222c 0a20 2020 2020 2020 2020 2020  cy",.           
-00039cb0: 2020 2020 2020 2020 2020 2020 2076 616c               val
-00039cc0: 7565 5f6e 616d 653d 2270 6f6c 6963 795f  ue_name="policy_
-00039cd0: 7661 6c75 6522 2c0a 2020 2020 2020 2020  value",.        
-00039ce0: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-00039cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039d00: 2020 2069 6620 2864 665b 2270 6f6c 6963     if (df["polic
-00039d10: 795f 7661 6c75 6522 5d20 3e20 3165 3130  y_value"] > 1e10
-00039d20: 292e 7375 6d28 2920 2b20 280a 2020 2020  ).sum() + (.    
-00039d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039d40: 2020 2020 6466 5b22 706f 6c69 6379 5f76      df["policy_v
-00039d50: 616c 7565 225d 203c 202d 3165 3130 0a20  alue"] < -1e10. 
-00039d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039d70: 2020 2029 2e73 756d 2829 203e 2030 3a0a     ).sum() > 0:.
-00039d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039d90: 2020 2020 2020 2020 7761 726e 280a 2020          warn(.  
-00039da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039db0: 2020 2020 2020 2020 2020 2246 6f75 6e64            "Found
-00039dc0: 2061 206c 6172 6765 2061 6273 6f6c 7574   a large absolut
-00039dd0: 6520 7661 6c75 6520 696e 2074 6865 2070  e value in the p
-00039de0: 6f6c 6963 7920 7661 6c75 6520 6573 7469  olicy value esti
-00039df0: 6d61 7465 2e20 5468 6520 7661 6c75 6520  mate. The value 
-00039e00: 6d6f 7265 2074 6861 6e20 3165 3130 2061  more than 1e10 a
-00039e10: 6e64 206c 6573 7320 7468 616e 202d 3165  nd less than -1e
-00039e20: 3130 2077 696c 6c20 6265 2072 6570 6c61  10 will be repla
-00039e30: 6365 6420 746f 206e 702e 6e61 6e2e 220a  ced to np.nan.".
-00039e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039e50: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00039e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039e70: 2020 6466 5b22 706f 6c69 6379 5f76 616c    df["policy_val
-00039e80: 7565 225d 203d 2064 665b 2270 6f6c 6963  ue"] = df["polic
-00039e90: 795f 7661 6c75 6522 5d2e 6d61 736b 280a  y_value"].mask(.
-00039ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039eb0: 2020 2020 2020 2020 2020 2020 6466 5b22              df["
-00039ec0: 706f 6c69 6379 5f76 616c 7565 225d 203e  policy_value"] >
-00039ed0: 2031 652d 3130 2c20 6e70 2e6e 616e 0a20   1e-10, np.nan. 
-00039ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039ef0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00039f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039f10: 2064 665b 2270 6f6c 6963 795f 7661 6c75   df["policy_valu
-00039f20: 6522 5d20 3d20 6466 5b22 706f 6c69 6379  e"] = df["policy
-00039f30: 5f76 616c 7565 225d 2e6d 6173 6b28 0a20  _value"].mask(. 
+00039a00: 2020 2020 2020 6178 203d 2066 6967 2e61        ax = fig.a
+00039a10: 6464 5f73 7562 706c 6f74 286e 5f65 7374  dd_subplot(n_est
+00039a20: 696d 6174 6f72 732c 2031 2c20 6920 2b20  imators, 1, i + 
+00039a30: 3129 0a0a 2020 2020 2020 2020 2020 2020  1)..            
+00039a40: 2020 2020 2020 2020 6466 203d 2044 6174          df = Dat
+00039a50: 6146 7261 6d65 2829 0a20 2020 2020 2020  aFrame().       
+00039a60: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+00039a70: 206a 2c20 6576 616c 5f70 6f6c 6963 7920   j, eval_policy 
+00039a80: 696e 2065 6e75 6d65 7261 7465 2869 6e70  in enumerate(inp
+00039a90: 7574 5f64 6963 745f 302e 6b65 7973 2829  ut_dict_0.keys()
+00039aa0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00039ab0: 2020 2020 2020 2020 2020 2064 665b 6576             df[ev
+00039ac0: 616c 5f70 6f6c 6963 795d 203d 2065 7374  al_policy] = est
+00039ad0: 696d 6174 696f 6e5f 6469 6374 5b65 7661  imation_dict[eva
+00039ae0: 6c5f 706f 6c69 6379 5d5b 6573 7469 6d61  l_policy][estima
+00039af0: 746f 725d 0a0a 2020 2020 2020 2020 2020  tor]..          
+00039b00: 2020 2020 2020 2020 2020 6466 5b22 6461            df["da
+00039b10: 7461 7365 745f 6964 225d 203d 206e 702e  taset_id"] = np.
+00039b20: 6172 616e 6765 286e 5f64 6174 6173 6574  arange(n_dataset
+00039b30: 7329 0a20 2020 2020 2020 2020 2020 2020  s).             
+00039b40: 2020 2020 2020 2064 6620 3d20 7064 2e6d         df = pd.m
+00039b50: 656c 7428 0a20 2020 2020 2020 2020 2020  elt(.           
+00039b60: 2020 2020 2020 2020 2020 2020 2064 662c               df,
+00039b70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00039b80: 2020 2020 2020 2020 2069 645f 7661 7273           id_vars
+00039b90: 3d5b 2264 6174 6173 6574 5f69 6422 5d2c  =["dataset_id"],
+00039ba0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00039bb0: 2020 2020 2020 2020 2076 6172 5f6e 616d           var_nam
+00039bc0: 653d 2265 7661 6c5f 706f 6c69 6379 222c  e="eval_policy",
+00039bd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00039be0: 2020 2020 2020 2020 2076 616c 7565 5f6e           value_n
+00039bf0: 616d 653d 2270 6f6c 6963 795f 7661 6c75  ame="policy_valu
+00039c00: 6522 2c0a 2020 2020 2020 2020 2020 2020  e",.            
+00039c10: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+00039c20: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00039c30: 6620 2864 665b 2270 6f6c 6963 795f 7661  f (df["policy_va
+00039c40: 6c75 6522 5d20 3e20 3165 3130 292e 7375  lue"] > 1e10).su
+00039c50: 6d28 2920 2b20 280a 2020 2020 2020 2020  m() + (.        
+00039c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039c70: 6466 5b22 706f 6c69 6379 5f76 616c 7565  df["policy_value
+00039c80: 225d 203c 202d 3165 3130 0a20 2020 2020  "] < -1e10.     
+00039c90: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+00039ca0: 2e73 756d 2829 203e 2030 3a0a 2020 2020  .sum() > 0:.    
+00039cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039cc0: 2020 2020 7761 726e 280a 2020 2020 2020      warn(.      
+00039cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039ce0: 2020 2020 2020 2246 6f75 6e64 2061 206c        "Found a l
+00039cf0: 6172 6765 2061 6273 6f6c 7574 6520 7661  arge absolute va
+00039d00: 6c75 6520 696e 2074 6865 2070 6f6c 6963  lue in the polic
+00039d10: 7920 7661 6c75 6520 6573 7469 6d61 7465  y value estimate
+00039d20: 2e20 5468 6520 7661 6c75 6520 6d6f 7265  . The value more
+00039d30: 2074 6861 6e20 3165 3130 2061 6e64 206c   than 1e10 and l
+00039d40: 6573 7320 7468 616e 202d 3165 3130 2077  ess than -1e10 w
+00039d50: 696c 6c20 6265 2072 6570 6c61 6365 6420  ill be replaced 
+00039d60: 746f 206e 702e 6e61 6e2e 220a 2020 2020  to np.nan.".    
+00039d70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039d80: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+00039d90: 2020 2020 2020 2020 2020 2020 2020 6466                df
+00039da0: 5b22 706f 6c69 6379 5f76 616c 7565 225d  ["policy_value"]
+00039db0: 203d 2064 665b 2270 6f6c 6963 795f 7661   = df["policy_va
+00039dc0: 6c75 6522 5d2e 6d61 736b 280a 2020 2020  lue"].mask(.    
+00039dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039de0: 2020 2020 2020 2020 6466 5b22 706f 6c69          df["poli
+00039df0: 6379 5f76 616c 7565 225d 203e 2031 652d  cy_value"] > 1e-
+00039e00: 3130 2c20 6e70 2e6e 616e 0a20 2020 2020  10, np.nan.     
+00039e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039e20: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+00039e30: 2020 2020 2020 2020 2020 2020 2064 665b               df[
+00039e40: 2270 6f6c 6963 795f 7661 6c75 6522 5d20  "policy_value"] 
+00039e50: 3d20 6466 5b22 706f 6c69 6379 5f76 616c  = df["policy_val
+00039e60: 7565 225d 2e6d 6173 6b28 0a20 2020 2020  ue"].mask(.     
+00039e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039e80: 2020 2020 2020 2064 665b 2270 6f6c 6963         df["polic
+00039e90: 795f 7661 6c75 6522 5d20 3c20 2d31 652d  y_value"] < -1e-
+00039ea0: 3130 2c20 6e70 2e6e 616e 0a20 2020 2020  10, np.nan.     
+00039eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039ec0: 2020 2029 0a0a 2020 2020 2020 2020 2020     )..          
+00039ed0: 2020 2020 2020 2020 2020 6966 2070 6c6f            if plo
+00039ee0: 745f 7479 7065 203d 3d20 2263 6922 3a0a  t_type == "ci":.
+00039ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039f00: 2020 2020 2020 2020 736e 732e 6261 7270          sns.barp
+00039f10: 6c6f 7428 0a20 2020 2020 2020 2020 2020  lot(.           
+00039f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039f30: 2064 6174 613d 6466 2c0a 2020 2020 2020   data=df,.      
 00039f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039f50: 2020 2020 2020 2020 2020 2064 665b 2270             df["p
-00039f60: 6f6c 6963 795f 7661 6c75 6522 5d20 3c20  olicy_value"] < 
-00039f70: 2d31 652d 3130 2c20 6e70 2e6e 616e 0a20  -1e-10, np.nan. 
-00039f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00039f90: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-00039fa0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00039fb0: 2070 6c6f 745f 7479 7065 203d 3d20 2263   plot_type == "c
-00039fc0: 6922 3a0a 2020 2020 2020 2020 2020 2020  i":.            
-00039fd0: 2020 2020 2020 2020 2020 2020 736e 732e              sns.
-00039fe0: 6261 7270 6c6f 7428 0a20 2020 2020 2020  barplot(.       
-00039ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a000: 2020 2020 2064 6174 613d 6466 2c0a 2020       data=df,.  
-0003a010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a020: 2020 2020 2020 2020 2020 783d 2265 7661            x="eva
-0003a030: 6c5f 706f 6c69 6379 222c 0a20 2020 2020  l_policy",.     
-0003a040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a050: 2020 2020 2020 2079 3d22 706f 6c69 6379         y="policy
-0003a060: 5f76 616c 7565 222c 0a20 2020 2020 2020  _value",.       
-0003a070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a080: 2020 2020 2070 616c 6574 7465 3d70 616c       palette=pal
-0003a090: 6574 7465 2c0a 2020 2020 2020 2020 2020  ette,.          
-0003a0a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a0b0: 2020 6178 3d61 782c 0a20 2020 2020 2020    ax=ax,.       
-0003a0c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a0d0: 2029 0a0a 2020 2020 2020 2020 2020 2020   )..            
-0003a0e0: 2020 2020 2020 2020 656c 6966 2070 6c6f          elif plo
-0003a0f0: 745f 7479 7065 203d 3d20 2276 696f 6c69  t_type == "violi
-0003a100: 6e22 3a0a 2020 2020 2020 2020 2020 2020  n":.            
-0003a110: 2020 2020 2020 2020 2020 2020 736e 732e              sns.
-0003a120: 7669 6f6c 696e 706c 6f74 280a 2020 2020  violinplot(.    
+00039f50: 2020 2020 2020 783d 2265 7661 6c5f 706f        x="eval_po
+00039f60: 6c69 6379 222c 0a20 2020 2020 2020 2020  licy",.         
+00039f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039f80: 2020 2079 3d22 706f 6c69 6379 5f76 616c     y="policy_val
+00039f90: 7565 222c 0a20 2020 2020 2020 2020 2020  ue",.           
+00039fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00039fb0: 2070 616c 6574 7465 3d70 616c 6574 7465   palette=palette
+00039fc0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00039fd0: 2020 2020 2020 2020 2020 2020 2020 6178                ax
+00039fe0: 3d61 782c 0a20 2020 2020 2020 2020 2020  =ax,.           
+00039ff0: 2020 2020 2020 2020 2020 2020 2029 0a0a               )..
+0003a000: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a010: 2020 2020 656c 6966 2070 6c6f 745f 7479      elif plot_ty
+0003a020: 7065 203d 3d20 2276 696f 6c69 6e22 3a0a  pe == "violin":.
+0003a030: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a040: 2020 2020 2020 2020 736e 732e 7669 6f6c          sns.viol
+0003a050: 696e 706c 6f74 280a 2020 2020 2020 2020  inplot(.        
+0003a060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a070: 2020 2020 6461 7461 3d64 662c 0a20 2020      data=df,.   
+0003a080: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a090: 2020 2020 2020 2020 2078 3d22 6576 616c           x="eval
+0003a0a0: 5f70 6f6c 6963 7922 2c0a 2020 2020 2020  _policy",.      
+0003a0b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a0c0: 2020 2020 2020 793d 2270 6f6c 6963 795f        y="policy_
+0003a0d0: 7661 6c75 6522 2c0a 2020 2020 2020 2020  value",.        
+0003a0e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a0f0: 2020 2020 7363 616c 653d 2277 6964 7468      scale="width
+0003a100: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+0003a110: 2020 2020 2020 2020 2020 2020 2020 2077                 w
+0003a120: 6964 7468 3d30 2e38 2c0a 2020 2020 2020  idth=0.8,.      
 0003a130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a140: 2020 2020 2020 2020 6461 7461 3d64 662c          data=df,
-0003a150: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003a160: 2020 2020 2020 2020 2020 2020 2078 3d22               x="
-0003a170: 6576 616c 5f70 6f6c 6963 7922 2c0a 2020  eval_policy",.  
+0003a140: 2020 2020 2020 7061 6c65 7474 653d 7061        palette=pa
+0003a150: 6c65 7474 652c 0a20 2020 2020 2020 2020  lette,.         
+0003a160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a170: 2020 2061 783d 6178 2c0a 2020 2020 2020     ax=ax,.      
 0003a180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a190: 2020 2020 2020 2020 2020 793d 2270 6f6c            y="pol
-0003a1a0: 6963 795f 7661 6c75 6522 2c0a 2020 2020  icy_value",.    
+0003a190: 2020 290a 0a20 2020 2020 2020 2020 2020    )..           
+0003a1a0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
 0003a1b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a1c0: 2020 2020 2020 2020 7363 616c 653d 2277          scale="w
-0003a1d0: 6964 7468 222c 0a20 2020 2020 2020 2020  idth",.         
-0003a1e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a1f0: 2020 2077 6964 7468 3d30 2e38 2c0a 2020     width=0.8,.  
+0003a1c0: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
+0003a1d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a1e0: 2020 2020 2020 2020 736e 732e 7377 6172          sns.swar
+0003a1f0: 6d70 6c6f 7428 0a20 2020 2020 2020 2020  mplot(.         
 0003a200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a210: 2020 2020 2020 2020 2020 7061 6c65 7474            palett
-0003a220: 653d 7061 6c65 7474 652c 0a20 2020 2020  e=palette,.     
+0003a210: 2020 2020 2020 2064 6174 613d 6466 2c0a         data=df,.
+0003a220: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0003a230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a240: 2020 2020 2020 2061 783d 6178 2c0a 2020         ax=ax,.  
-0003a250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a260: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-0003a270: 2020 2020 2020 2020 2020 2020 2065 6c73               els
-0003a280: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-0003a290: 2020 2020 2020 2020 2020 2074 7279 3a0a             try:.
-0003a2a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a2b0: 2020 2020 2020 2020 2020 2020 736e 732e              sns.
-0003a2c0: 7377 6172 6d70 6c6f 7428 0a20 2020 2020  swarmplot(.     
-0003a2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a2e0: 2020 2020 2020 2020 2020 2064 6174 613d             data=
-0003a2f0: 6466 2c0a 2020 2020 2020 2020 2020 2020  df,.            
+0003a240: 783d 2265 7661 6c5f 706f 6c69 6379 222c  x="eval_policy",
+0003a250: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003a260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a270: 2079 3d22 706f 6c69 6379 5f76 616c 7565   y="policy_value
+0003a280: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+0003a290: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a2a0: 2020 2070 616c 6574 7465 3d70 616c 6574     palette=palet
+0003a2b0: 7465 2c0a 2020 2020 2020 2020 2020 2020  te,.            
+0003a2c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a2d0: 2020 2020 6178 3d61 782c 0a20 2020 2020      ax=ax,.     
+0003a2e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a2f0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
 0003a300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a310: 2020 2020 783d 2265 7661 6c5f 706f 6c69      x="eval_poli
-0003a320: 6379 222c 0a20 2020 2020 2020 2020 2020  cy",.           
-0003a330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a340: 2020 2020 2079 3d22 706f 6c69 6379 5f76       y="policy_v
-0003a350: 616c 7565 222c 0a20 2020 2020 2020 2020  alue",.         
-0003a360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a370: 2020 2020 2020 2070 616c 6574 7465 3d70         palette=p
-0003a380: 616c 6574 7465 2c0a 2020 2020 2020 2020  alette,.        
+0003a310: 2065 7863 6570 743a 0a20 2020 2020 2020   except:.       
+0003a320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a330: 2020 2020 2077 6172 6e28 2245 6e63 6f75       warn("Encou
+0003a340: 6e74 6572 6564 204e 614e 2076 616c 7565  ntered NaN value
+0003a350: 7320 6475 7269 6e67 2070 6c6f 742e 2229  s during plot.")
+0003a360: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0003a370: 2020 2020 2020 6966 2076 6973 7561 6c69        if visuali
+0003a380: 7a65 5f6f 6e5f 706f 6c69 6379 3a0a 2020  ze_on_policy:.  
 0003a390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a3a0: 2020 2020 2020 2020 6178 3d61 782c 0a20          ax=ax,. 
-0003a3b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a3c0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-0003a3d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a3e0: 2020 2020 2065 7863 6570 743a 0a20 2020       except:.   
+0003a3a0: 2020 2020 2020 6178 2e73 6361 7474 6572        ax.scatter
+0003a3b0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0003a3c0: 2020 2020 2020 2020 2020 2020 2020 6e70                np
+0003a3d0: 2e61 7261 6e67 6528 6e5f 6576 616c 5f70  .arange(n_eval_p
+0003a3e0: 6f6c 6963 6965 7329 2c0a 2020 2020 2020  olicies),.      
 0003a3f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a400: 2020 2020 2020 2020 2077 6172 6e28 2245           warn("E
-0003a410: 6e63 6f75 6e74 6572 6564 204e 614e 2076  ncountered NaN v
-0003a420: 616c 7565 7320 6475 7269 6e67 2070 6c6f  alues during plo
-0003a430: 742e 2229 0a0a 2020 2020 2020 2020 2020  t.")..          
-0003a440: 2020 2020 2020 2020 2020 6966 2076 6973            if vis
-0003a450: 7561 6c69 7a65 5f6f 6e5f 706f 6c69 6379  ualize_on_policy
-0003a460: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0003a470: 2020 2020 2020 2020 2020 6178 2e73 6361            ax.sca
-0003a480: 7474 6572 280a 2020 2020 2020 2020 2020  tter(.          
-0003a490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a4a0: 2020 6e70 2e61 7261 6e67 6528 6e5f 6576    np.arange(n_ev
-0003a4b0: 616c 5f70 6f6c 6963 6965 7329 2c0a 2020  al_policies),.  
-0003a4c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a4d0: 2020 2020 2020 2020 2020 6f6e 5f70 6f6c            on_pol
-0003a4e0: 6963 792c 0a20 2020 2020 2020 2020 2020  icy,.           
-0003a4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a500: 2063 6f6c 6f72 3d22 626c 6163 6b22 2c0a   color="black",.
-0003a510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a520: 2020 2020 2020 2020 2020 2020 6d61 726b              mark
-0003a530: 6572 3d22 2a22 2c0a 2020 2020 2020 2020  er="*",.        
-0003a540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a550: 2020 2020 733d 3135 302c 0a20 2020 2020      s=150,.     
-0003a560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a570: 2020 2029 0a0a 2020 2020 2020 2020 2020     )..          
-0003a580: 2020 2020 2020 2020 2020 6178 2e73 6574            ax.set
-0003a590: 5f74 6974 6c65 2865 7374 696d 6174 6f72  _title(estimator
-0003a5a0: 2c20 666f 6e74 7369 7a65 3d31 3629 0a20  , fontsize=16). 
-0003a5b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a5c0: 2020 2061 782e 7365 745f 786c 6162 656c     ax.set_xlabel
-0003a5d0: 2822 2229 0a20 2020 2020 2020 2020 2020  ("").           
-0003a5e0: 2020 2020 2020 2020 2061 782e 7365 745f           ax.set_
-0003a5f0: 796c 6162 656c 280a 2020 2020 2020 2020  ylabel(.        
-0003a600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a610: 796c 6162 656c 2c0a 2020 2020 2020 2020  ylabel,.        
-0003a620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a630: 666f 6e74 7369 7a65 3d31 322c 0a20 2020  fontsize=12,.   
-0003a640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a650: 2029 0a20 2020 2020 2020 2020 2020 2020   ).             
-0003a660: 2020 2020 2020 2061 782e 7365 745f 7874         ax.set_xt
-0003a670: 6963 6b73 286e 702e 6172 616e 6765 286e  icks(np.arange(n
-0003a680: 5f65 7661 6c5f 706f 6c69 6369 6573 292c  _eval_policies),
-0003a690: 206c 6973 7428 696e 7075 745f 6469 6374   list(input_dict
-0003a6a0: 5f30 2e6b 6579 7328 2929 290a 2020 2020  _0.keys())).    
-0003a6b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a6c0: 706c 742e 7974 6963 6b73 2866 6f6e 7473  plt.yticks(fonts
-0003a6d0: 697a 653d 3132 290a 2020 2020 2020 2020  ize=12).        
-0003a6e0: 2020 2020 2020 2020 2020 2020 706c 742e              plt.
-0003a6f0: 7874 6963 6b73 2866 6f6e 7473 697a 653d  xticks(fontsize=
-0003a700: 3132 290a 0a20 2020 2020 2020 2066 6967  12)..        fig
-0003a710: 2e73 7562 706c 6f74 735f 6164 6a75 7374  .subplots_adjust
-0003a720: 2874 6f70 3d31 2e30 290a 2020 2020 2020  (top=1.0).      
-0003a730: 2020 706c 742e 7368 6f77 2829 0a0a 2020    plt.show()..  
-0003a740: 2020 2020 2020 6966 2066 6967 5f64 6972        if fig_dir
-0003a750: 3a0a 2020 2020 2020 2020 2020 2020 6669  :.            fi
-0003a760: 672e 7361 7665 6669 6728 7374 7228 6669  g.savefig(str(fi
-0003a770: 675f 6469 7220 2f20 6669 675f 6e61 6d65  g_dir / fig_name
-0003a780: 292c 2064 7069 3d33 3030 2c20 6262 6f78  ), dpi=300, bbox
-0003a790: 5f69 6e63 6865 733d 2274 6967 6874 2229  _inches="tight")
-0003a7a0: 0a0a 2020 2020 6465 6620 7669 7375 616c  ..    def visual
-0003a7b0: 697a 655f 6375 6d75 6c61 7469 7665 5f64  ize_cumulative_d
-0003a7c0: 6973 7472 6962 7574 696f 6e5f 6675 6e63  istribution_func
-0003a7d0: 7469 6f6e 5f77 6974 685f 6d75 6c74 6970  tion_with_multip
-0003a7e0: 6c65 5f65 7374 696d 6174 6573 280a 2020  le_estimates(.  
-0003a7f0: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
-0003a800: 2020 2020 696e 7075 745f 6469 6374 3a20      input_dict: 
-0003a810: 4d75 6c74 6970 6c65 496e 7075 7444 6963  MultipleInputDic
-0003a820: 742c 0a20 2020 2020 2020 2063 6f6d 7061  t,.        compa
-0003a830: 7265 645f 6573 7469 6d61 746f 7273 3a20  red_estimators: 
-0003a840: 4f70 7469 6f6e 616c 5b4c 6973 745b 7374  Optional[List[st
-0003a850: 725d 5d20 3d20 4e6f 6e65 2c0a 2020 2020  r]] = None,.    
-0003a860: 2020 2020 6265 6861 7669 6f72 5f70 6f6c      behavior_pol
-0003a870: 6963 795f 6e61 6d65 3a20 4f70 7469 6f6e  icy_name: Option
-0003a880: 616c 5b73 7472 5d20 3d20 4e6f 6e65 2c0a  al[str] = None,.
-0003a890: 2020 2020 2020 2020 7363 616c 655f 6d69          scale_mi
-0003a8a0: 6e3a 204f 7074 696f 6e61 6c5b 666c 6f61  n: Optional[floa
-0003a8b0: 745d 203d 204e 6f6e 652c 0a20 2020 2020  t] = None,.     
-0003a8c0: 2020 2073 6361 6c65 5f6d 6178 3a20 4f70     scale_max: Op
-0003a8d0: 7469 6f6e 616c 5b66 6c6f 6174 5d20 3d20  tional[float] = 
-0003a8e0: 4e6f 6e65 2c0a 2020 2020 2020 2020 6e5f  None,.        n_
-0003a8f0: 7061 7274 6974 696f 6e3a 204f 7074 696f  partition: Optio
-0003a900: 6e61 6c5b 696e 745d 203d 204e 6f6e 652c  nal[int] = None,
-0003a910: 0a20 2020 2020 2020 2070 6c6f 745f 7479  .        plot_ty
-0003a920: 7065 3a20 7374 7220 3d20 2263 695f 6875  pe: str = "ci_hu
-0003a930: 6522 2c0a 2020 2020 2020 2020 6875 653a  e",.        hue:
-0003a940: 2073 7472 203d 2022 6573 7469 6d61 746f   str = "estimato
-0003a950: 7222 2c0a 2020 2020 2020 2020 6c65 6765  r",.        lege
-0003a960: 6e64 3a20 626f 6f6c 203d 2054 7275 652c  nd: bool = True,
-0003a970: 0a20 2020 2020 2020 206e 5f63 6f6c 733a  .        n_cols:
-0003a980: 204f 7074 696f 6e61 6c5b 696e 745d 203d   Optional[int] =
-0003a990: 204e 6f6e 652c 0a20 2020 2020 2020 2073   None,.        s
-0003a9a0: 6861 7265 793a 2062 6f6f 6c20 3d20 4661  harey: bool = Fa
-0003a9b0: 6c73 652c 0a20 2020 2020 2020 2066 6967  lse,.        fig
-0003a9c0: 5f64 6972 3a20 4f70 7469 6f6e 616c 5b50  _dir: Optional[P
-0003a9d0: 6174 685d 203d 204e 6f6e 652c 0a20 2020  ath] = None,.   
-0003a9e0: 2020 2020 2066 6967 5f6e 616d 653a 2073       fig_name: s
-0003a9f0: 7472 203d 2022 6573 7469 6d61 7465 645f  tr = "estimated_
-0003aa00: 706f 6c69 6379 5f76 616c 7565 5f6d 756c  policy_value_mul
-0003aa10: 7469 706c 652e 706e 6722 2c0a 2020 2020  tiple.png",.    
-0003aa20: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
-0003aa30: 2020 2022 2222 5669 7375 616c 697a 6520     """Visualize 
-0003aa40: 7468 6520 706f 6c69 6379 2076 616c 7565  the policy value
-0003aa50: 2065 7374 696d 6174 6564 2062 7920 4f50   estimated by OP
-0003aa60: 4520 6573 7469 6d61 746f 7273 2061 6372  E estimators acr
-0003aa70: 6f73 7320 6d75 6c74 6970 6c65 206c 6f67  oss multiple log
-0003aa80: 6765 6420 6461 7461 7365 742e 0a0a 2020  ged dataset...  
-0003aa90: 2020 2020 2020 4e6f 7465 0a20 2020 2020        Note.     
-0003aaa0: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 2020     -------.     
-0003aab0: 2020 2054 6869 7320 6675 6e63 7469 6f6e     This function
-0003aac0: 2069 7320 6170 706c 6963 6162 6c65 206f   is applicable o
-0003aad0: 6e6c 7920 7768 656e 204d 756c 7469 706c  nly when Multipl
-0003aae0: 654c 6f67 6765 6444 6174 6173 6574 2069  eLoggedDataset i
-0003aaf0: 7320 7573 6564 2061 6e64 0a20 2020 2020  s used and.     
-0003ab00: 2020 204d 756c 7469 706c 6549 6e70 7574     MultipleInput
-0003ab10: 4469 6374 2069 7320 636f 6c6c 6563 7465  Dict is collecte
-0003ab20: 6420 6279 2074 6865 2073 616d 6520 6576  d by the same ev
-0003ab30: 616c 7561 7469 6f6e 2070 6f6c 6963 7920  aluation policy 
-0003ab40: 6163 726f 7373 206c 6f67 6765 6420 6461  across logged da
-0003ab50: 7461 7365 7473 2e0a 0a20 2020 2020 2020  tasets...       
-0003ab60: 2054 6869 7320 6675 6e63 7469 6f6e 2069   This function i
-0003ab70: 7320 6e6f 7420 6170 706c 6963 6162 6c65  s not applicable
-0003ab80: 2077 6865 6e20 7468 6520 6461 7461 2d64   when the data-d
-0003ab90: 7269 7665 6e20 7265 7761 7264 2073 6361  riven reward sca
-0003aba0: 6c65 7220 6973 2075 7365 642e 0a20 2020  ler is used..   
-0003abb0: 2020 2020 2050 6c65 6173 6520 7365 7420       Please set 
-0003abc0: 6060 7363 616c 655f 6d69 6e60 602c 2060  ``scale_min``, `
-0003abd0: 6073 6361 6c65 5f6d 6178 6060 2c20 616e  `scale_max``, an
-0003abe0: 6420 6060 6e5f 7061 7274 6974 696f 6e60  d ``n_partition`
-0003abf0: 6020 746f 2075 7365 2e0a 0a20 2020 2020  ` to use...     
-0003ac00: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
-0003ac10: 2020 2020 2020 2d2d 2d2d 2d2d 2d0a 2020        -------.  
-0003ac20: 2020 2020 2020 696e 7075 745f 6469 6374        input_dict
-0003ac30: 3a20 4d75 6c74 6970 6c65 496e 7075 7444  : MultipleInputD
-0003ac40: 6963 740a 2020 2020 2020 2020 2020 2020  ict.            
-0003ac50: 4469 6374 696f 6e61 7279 206f 6620 7468  Dictionary of th
-0003ac60: 6520 4f50 4520 696e 7075 7473 2066 6f72  e OPE inputs for
-0003ac70: 2065 6163 6820 6576 616c 7561 7469 6f6e   each evaluation
-0003ac80: 2070 6f6c 6963 792e 0a0a 2020 2020 2020   policy...      
-0003ac90: 2020 2020 2020 2e2e 2063 6f64 652d 626c        .. code-bl
-0003aca0: 6f63 6b3a 3a20 7079 7468 6f6e 0a0a 2020  ock:: python..  
-0003acb0: 2020 2020 2020 2020 2020 2020 2020 6b65                ke
-0003acc0: 793a 205b 6576 616c 7561 7469 6f6e 5f70  y: [evaluation_p
-0003acd0: 6f6c 6963 795d 5b0a 2020 2020 2020 2020  olicy][.        
-0003ace0: 2020 2020 2020 2020 2020 2020 6576 616c              eval
-0003acf0: 7561 7469 6f6e 5f70 6f6c 6963 795f 6163  uation_policy_ac
-0003ad00: 7469 6f6e 2c0a 2020 2020 2020 2020 2020  tion,.          
-0003ad10: 2020 2020 2020 2020 2020 6576 616c 7561            evalua
-0003ad20: 7469 6f6e 5f70 6f6c 6963 795f 6163 7469  tion_policy_acti
-0003ad30: 6f6e 5f64 6973 742c 0a20 2020 2020 2020  on_dist,.       
-0003ad40: 2020 2020 2020 2020 2020 2020 2073 7461               sta
-0003ad50: 7465 5f61 6374 696f 6e5f 7661 6c75 655f  te_action_value_
-0003ad60: 7072 6564 6963 7469 6f6e 2c0a 2020 2020  prediction,.    
-0003ad70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ad80: 696e 6974 6961 6c5f 7374 6174 655f 7661  initial_state_va
-0003ad90: 6c75 655f 7072 6564 6963 7469 6f6e 2c0a  lue_prediction,.
-0003ada0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003adb0: 2020 2020 7374 6174 655f 6163 7469 6f6e      state_action
-0003adc0: 5f6d 6172 6769 6e61 6c5f 696d 706f 7274  _marginal_import
-0003add0: 616e 6365 5f77 6569 6768 742c 0a20 2020  ance_weight,.   
-0003ade0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003adf0: 2073 7461 7465 5f6d 6172 6769 6e61 6c5f   state_marginal_
-0003ae00: 696d 706f 7274 616e 6365 5f77 6569 6768  importance_weigh
-0003ae10: 742c 0a20 2020 2020 2020 2020 2020 2020  t,.             
-0003ae20: 2020 2020 2020 206f 6e5f 706f 6c69 6379         on_policy
-0003ae30: 5f70 6f6c 6963 795f 7661 6c75 652c 0a20  _policy_value,. 
-0003ae40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ae50: 2020 2067 616d 6d61 2c0a 2020 2020 2020     gamma,.      
-0003ae60: 2020 2020 2020 2020 2020 2020 2020 6265                be
-0003ae70: 6861 7669 6f72 5f70 6f6c 6963 792c 0a20  havior_policy,. 
-0003ae80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ae90: 2020 2065 7661 6c75 6174 696f 6e5f 706f     evaluation_po
-0003aea0: 6c69 6379 2c0a 2020 2020 2020 2020 2020  licy,.          
-0003aeb0: 2020 2020 2020 2020 2020 6461 7461 7365            datase
-0003aec0: 745f 6964 2c0a 2020 2020 2020 2020 2020  t_id,.          
-0003aed0: 2020 2020 2020 5d0a 0a20 2020 2020 2020        ]..       
-0003aee0: 2020 2020 202e 2e20 7365 6561 6c73 6f3a       .. seealso:
-0003aef0: 3a0a 0a20 2020 2020 2020 2020 2020 2020  :..             
-0003af00: 2020 203a 636c 6173 733a 6073 636f 7065     :class:`scope
-0003af10: 5f72 6c2e 6f70 652e 696e 7075 742e 4372  _rl.ope.input.Cr
-0003af20: 6561 7465 4f50 4549 6e70 7574 6020 6465  eateOPEInput` de
-0003af30: 7363 7269 6265 7320 7468 6520 636f 6d70  scribes the comp
-0003af40: 6f6e 656e 7473 206f 6620 3a63 6c61 7373  onents of :class
-0003af50: 3a60 696e 7075 745f 6469 6374 602e 0a0a  :`input_dict`...
-0003af60: 2020 2020 2020 2020 636f 6d70 6172 6564          compared
-0003af70: 5f65 7374 696d 6174 6f72 733a 206c 6973  _estimators: lis
-0003af80: 7420 6f66 2073 7472 2c20 6465 6661 756c  t of str, defaul
-0003af90: 743d 4e6f 6e65 0a20 2020 2020 2020 2020  t=None.         
-0003afa0: 2020 204e 616d 6520 6f66 2063 6f6d 7061     Name of compa
-0003afb0: 7265 6420 6573 7469 6d61 746f 7273 2e0a  red estimators..
-0003afc0: 2020 2020 2020 2020 2020 2020 4966 2060              If `
-0003afd0: 4e6f 6e65 6020 6973 2067 6976 656e 2c20  None` is given, 
-0003afe0: 616c 6c20 7468 6520 6573 7469 6d61 746f  all the estimato
-0003aff0: 7273 2061 7265 2063 6f6d 7061 7265 642e  rs are compared.
-0003b000: 0a0a 2020 2020 2020 2020 6265 6861 7669  ..        behavi
-0003b010: 6f72 5f70 6f6c 6963 795f 6e61 6d65 3a20  or_policy_name: 
-0003b020: 7374 722c 2064 6566 6175 6c74 3d4e 6f6e  str, default=Non
-0003b030: 650a 2020 2020 2020 2020 2020 2020 4e61  e.            Na
-0003b040: 6d65 206f 6620 7468 6520 6265 6861 7669  me of the behavi
-0003b050: 6f72 2070 6f6c 6963 792e 0a0a 2020 2020  or policy...    
-0003b060: 2020 2020 706c 6f74 5f74 7970 653a 207b      plot_type: {
-0003b070: 2263 695f 6875 6522 2c20 2263 695f 6265  "ci_hue", "ci_be
-0003b080: 6861 7669 6f72 5f70 6f6c 6963 7922 2c20  havior_policy", 
-0003b090: 2265 6e75 6d65 7261 7465 227d 2c20 6465  "enumerate"}, de
-0003b0a0: 6661 756c 743d 2263 695f 6875 6522 0a20  fault="ci_hue". 
-0003b0b0: 2020 2020 2020 2020 2020 2054 7970 6520             Type 
-0003b0c0: 6f66 2070 6c6f 742e 0a20 2020 2020 2020  of plot..       
-0003b0d0: 2020 2020 2049 6620 2263 6922 2069 7320       If "ci" is 
-0003b0e0: 6769 7665 6e2c 2074 6865 206d 6574 686f  given, the metho
-0003b0f0: 6420 7669 7375 616c 697a 6573 2074 6865  d visualizes the
-0003b100: 2061 7665 7261 6765 2070 6f6c 6963 7920   average policy 
-0003b110: 7661 6c75 6520 616e 6420 6974 7320 3935  value and its 95
-0003b120: 2520 636f 6e66 6964 656e 6365 2069 6e74  % confidence int
-0003b130: 6572 7661 6c73 2062 6173 6564 206f 6e20  ervals based on 
-0003b140: 7468 6520 6d75 6c74 6970 6c65 2065 7374  the multiple est
-0003b150: 696d 6174 652e 0a20 2020 2020 2020 2020  imate..         
-0003b160: 2020 2049 6620 2265 6e75 6d65 7261 7465     If "enumerate
-0003b170: 2220 6973 2067 6976 656e 2c20 7765 2067  " is given, we g
-0003b180: 6574 2061 2073 6361 7474 6572 2070 6c6f  et a scatter plo
-0003b190: 7420 6f66 2065 7374 696d 6174 6564 2076  t of estimated v
-0003b1a0: 616c 7565 732e 0a0a 2020 2020 2020 2020  alues...        
-0003b1b0: 6875 653a 207b 2265 7374 696d 6174 6f72  hue: {"estimator
-0003b1c0: 222c 2022 706f 6c69 6379 227d 2c20 6465  ", "policy"}, de
-0003b1d0: 6661 756c 743d 2265 7374 696d 6174 6f72  fault="estimator
-0003b1e0: 220a 2020 2020 2020 2020 2020 2020 4875  ".            Hu
-0003b1f0: 6520 6f66 2074 6865 2070 6c6f 742e 0a0a  e of the plot...
-0003b200: 2020 2020 2020 2020 6c65 6765 6e64 3a20          legend: 
-0003b210: 626f 6f6c 2c20 6465 6661 756c 743d 5472  bool, default=Tr
-0003b220: 7565 0a20 2020 2020 2020 2020 2020 2057  ue.            W
-0003b230: 6865 7468 6572 2074 6f20 696e 636c 7564  hether to includ
-0003b240: 6520 6120 6c65 6765 6e64 2069 6e20 7468  e a legend in th
-0003b250: 6520 7363 6174 7465 7220 706c 6f74 2e0a  e scatter plot..
-0003b260: 0a20 2020 2020 2020 2073 6861 7265 793a  .        sharey:
-0003b270: 2062 6f6f 6c2c 2064 6566 6175 6c74 3d46   bool, default=F
-0003b280: 616c 7365 0a20 2020 2020 2020 2020 2020  alse.           
-0003b290: 2049 6620 6054 7275 6560 2c20 7468 6520   If `True`, the 
-0003b2a0: 792d 6178 6973 2077 696c 6c20 6265 2073  y-axis will be s
-0003b2b0: 6861 7265 6420 616d 6f6e 6720 6469 6666  hared among diff
-0003b2c0: 6572 656e 7420 6573 7469 6d61 746f 7273  erent estimators
-0003b2d0: 206f 7220 6576 616c 7561 7469 6f6e 2070   or evaluation p
-0003b2e0: 6f6c 6963 6965 732e 0a0a 2020 2020 2020  olicies...      
-0003b2f0: 2020 6669 675f 6469 723a 2050 6174 682c    fig_dir: Path,
-0003b300: 2064 6566 6175 6c74 3d4e 6f6e 650a 2020   default=None.  
-0003b310: 2020 2020 2020 2020 2020 5061 7468 2074            Path t
-0003b320: 6f20 7374 6f72 6520 7468 6520 6261 7220  o store the bar 
-0003b330: 6669 6775 7265 2e0a 2020 2020 2020 2020  figure..        
-0003b340: 2020 2020 4966 2060 4e6f 6e65 6020 6973      If `None` is
-0003b350: 2067 6976 656e 2c20 7468 6520 6669 6775   given, the figu
-0003b360: 7265 2077 696c 6c20 6e6f 7420 6265 2073  re will not be s
-0003b370: 6176 6564 2e0a 0a20 2020 2020 2020 2066  aved...        f
-0003b380: 6967 5f6e 616d 653a 2073 7472 2c20 6465  ig_name: str, de
-0003b390: 6661 756c 743d 2265 7374 696d 6174 6564  fault="estimated
-0003b3a0: 5f70 6f6c 6963 795f 7661 6c75 655f 6d75  _policy_value_mu
-0003b3b0: 6c74 6970 6c65 2e70 6e67 220a 2020 2020  ltiple.png".    
-0003b3c0: 2020 2020 2020 2020 4e61 6d65 206f 6620          Name of 
-0003b3d0: 7468 6520 6261 7220 6669 6775 7265 2e0a  the bar figure..
-0003b3e0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0003b3f0: 2020 2020 2063 6f6d 7061 7265 645f 6573       compared_es
-0003b400: 7469 6d61 746f 7273 203d 2073 656c 662e  timators = self.
-0003b410: 5f63 6865 636b 5f63 6f6d 7061 7265 645f  _check_compared_
-0003b420: 6573 7469 6d61 746f 7273 2863 6f6d 7061  estimators(compa
-0003b430: 7265 645f 6573 7469 6d61 746f 7273 290a  red_estimators).
-0003b440: 2020 2020 2020 2020 7265 7761 7264 5f73          reward_s
-0003b450: 6361 6c65 203d 2073 656c 662e 5f63 7573  cale = self._cus
-0003b460: 746f 6d5f 7265 7761 7264 5f73 6361 6c65  tom_reward_scale
-0003b470: 280a 2020 2020 2020 2020 2020 2020 7363  (.            sc
-0003b480: 616c 655f 6d69 6e3d 7363 616c 655f 6d69  ale_min=scale_mi
-0003b490: 6e2c 2073 6361 6c65 5f6d 6178 3d73 6361  n, scale_max=sca
-0003b4a0: 6c65 5f6d 6178 2c20 6e5f 7061 7274 6974  le_max, n_partit
-0003b4b0: 696f 6e3d 6e5f 7061 7274 6974 696f 6e0a  ion=n_partition.
-0003b4c0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0003b4d0: 2020 7365 6c66 2e5f 6368 6563 6b5f 6261    self._check_ba
-0003b4e0: 7369 635f 7669 7375 616c 697a 6174 696f  sic_visualizatio
-0003b4f0: 6e5f 696e 7075 7473 280a 2020 2020 2020  n_inputs(.      
-0003b500: 2020 2020 2020 6875 653d 6875 652c 2066        hue=hue, f
-0003b510: 6967 5f64 6972 3d66 6967 5f64 6972 2c20  ig_dir=fig_dir, 
-0003b520: 6669 675f 6e61 6d65 3d66 6967 5f6e 616d  fig_name=fig_nam
-0003b530: 650a 2020 2020 2020 2020 290a 2020 2020  e.        ).    
-0003b540: 2020 2020 7365 6c66 2e5f 6368 6563 6b5f      self._check_
-0003b550: 696e 7075 745f 6469 6374 5f66 6f72 5f76  input_dict_for_v
-0003b560: 6973 7561 6c69 7a65 5f6d 756c 7469 706c  isualize_multipl
-0003b570: 655f 6573 7469 6d61 7465 7328 696e 7075  e_estimates(inpu
-0003b580: 745f 6469 6374 290a 0a20 2020 2020 2020  t_dict)..       
-0003b590: 2069 6620 706c 6f74 5f74 7970 6520 6e6f   if plot_type no
-0003b5a0: 7420 696e 205b 2263 695f 6875 6522 2c20  t in ["ci_hue", 
-0003b5b0: 2263 695f 6265 6861 7669 6f72 5f70 6f6c  "ci_behavior_pol
-0003b5c0: 6963 7922 2c20 2265 6e75 6d65 7261 7465  icy", "enumerate
+0003a400: 2020 2020 2020 6f6e 5f70 6f6c 6963 792c        on_policy,
+0003a410: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003a420: 2020 2020 2020 2020 2020 2020 2063 6f6c               col
+0003a430: 6f72 3d22 626c 6163 6b22 2c0a 2020 2020  or="black",.    
+0003a440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a450: 2020 2020 2020 2020 6d61 726b 6572 3d22          marker="
+0003a460: 2a22 2c0a 2020 2020 2020 2020 2020 2020  *",.            
+0003a470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a480: 733d 3135 302c 0a20 2020 2020 2020 2020  s=150,.         
+0003a490: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+0003a4a0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0003a4b0: 2020 2020 2020 6178 2e73 6574 5f74 6974        ax.set_tit
+0003a4c0: 6c65 2865 7374 696d 6174 6f72 2c20 666f  le(estimator, fo
+0003a4d0: 6e74 7369 7a65 3d31 3629 0a20 2020 2020  ntsize=16).     
+0003a4e0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+0003a4f0: 782e 7365 745f 786c 6162 656c 2822 2229  x.set_xlabel("")
+0003a500: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003a510: 2020 2020 2061 782e 7365 745f 796c 6162       ax.set_ylab
+0003a520: 656c 280a 2020 2020 2020 2020 2020 2020  el(.            
+0003a530: 2020 2020 2020 2020 2020 2020 796c 6162              ylab
+0003a540: 656c 2c0a 2020 2020 2020 2020 2020 2020  el,.            
+0003a550: 2020 2020 2020 2020 2020 2020 666f 6e74              font
+0003a560: 7369 7a65 3d31 322c 0a20 2020 2020 2020  size=12,.       
+0003a570: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
+0003a580: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003a590: 2020 2061 782e 7365 745f 7874 6963 6b73     ax.set_xticks
+0003a5a0: 286e 702e 6172 616e 6765 286e 5f65 7661  (np.arange(n_eva
+0003a5b0: 6c5f 706f 6c69 6369 6573 292c 206c 6973  l_policies), lis
+0003a5c0: 7428 696e 7075 745f 6469 6374 5f30 2e6b  t(input_dict_0.k
+0003a5d0: 6579 7328 2929 290a 2020 2020 2020 2020  eys())).        
+0003a5e0: 2020 2020 2020 2020 2020 2020 706c 742e              plt.
+0003a5f0: 7974 6963 6b73 2866 6f6e 7473 697a 653d  yticks(fontsize=
+0003a600: 3132 290a 2020 2020 2020 2020 2020 2020  12).            
+0003a610: 2020 2020 2020 2020 706c 742e 7874 6963          plt.xtic
+0003a620: 6b73 2866 6f6e 7473 697a 653d 3132 290a  ks(fontsize=12).
+0003a630: 0a20 2020 2020 2020 2066 6967 2e73 7562  .        fig.sub
+0003a640: 706c 6f74 735f 6164 6a75 7374 2874 6f70  plots_adjust(top
+0003a650: 3d31 2e30 290a 2020 2020 2020 2020 706c  =1.0).        pl
+0003a660: 742e 7368 6f77 2829 0a0a 2020 2020 2020  t.show()..      
+0003a670: 2020 6966 2066 6967 5f64 6972 3a0a 2020    if fig_dir:.  
+0003a680: 2020 2020 2020 2020 2020 6669 672e 7361            fig.sa
+0003a690: 7665 6669 6728 7374 7228 6669 675f 6469  vefig(str(fig_di
+0003a6a0: 7220 2f20 6669 675f 6e61 6d65 292c 2064  r / fig_name), d
+0003a6b0: 7069 3d33 3030 2c20 6262 6f78 5f69 6e63  pi=300, bbox_inc
+0003a6c0: 6865 733d 2274 6967 6874 2229 0a0a 2020  hes="tight")..  
+0003a6d0: 2020 6465 6620 7669 7375 616c 697a 655f    def visualize_
+0003a6e0: 6375 6d75 6c61 7469 7665 5f64 6973 7472  cumulative_distr
+0003a6f0: 6962 7574 696f 6e5f 6675 6e63 7469 6f6e  ibution_function
+0003a700: 5f77 6974 685f 6d75 6c74 6970 6c65 5f65  _with_multiple_e
+0003a710: 7374 696d 6174 6573 280a 2020 2020 2020  stimates(.      
+0003a720: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
+0003a730: 696e 7075 745f 6469 6374 3a20 4d75 6c74  input_dict: Mult
+0003a740: 6970 6c65 496e 7075 7444 6963 742c 0a20  ipleInputDict,. 
+0003a750: 2020 2020 2020 2063 6f6d 7061 7265 645f         compared_
+0003a760: 6573 7469 6d61 746f 7273 3a20 4f70 7469  estimators: Opti
+0003a770: 6f6e 616c 5b4c 6973 745b 7374 725d 5d20  onal[List[str]] 
+0003a780: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
+0003a790: 6265 6861 7669 6f72 5f70 6f6c 6963 795f  behavior_policy_
+0003a7a0: 6e61 6d65 3a20 4f70 7469 6f6e 616c 5b73  name: Optional[s
+0003a7b0: 7472 5d20 3d20 4e6f 6e65 2c0a 2020 2020  tr] = None,.    
+0003a7c0: 2020 2020 7363 616c 655f 6d69 6e3a 204f      scale_min: O
+0003a7d0: 7074 696f 6e61 6c5b 666c 6f61 745d 203d  ptional[float] =
+0003a7e0: 204e 6f6e 652c 0a20 2020 2020 2020 2073   None,.        s
+0003a7f0: 6361 6c65 5f6d 6178 3a20 4f70 7469 6f6e  cale_max: Option
+0003a800: 616c 5b66 6c6f 6174 5d20 3d20 4e6f 6e65  al[float] = None
+0003a810: 2c0a 2020 2020 2020 2020 6e5f 7061 7274  ,.        n_part
+0003a820: 6974 696f 6e3a 204f 7074 696f 6e61 6c5b  ition: Optional[
+0003a830: 696e 745d 203d 204e 6f6e 652c 0a20 2020  int] = None,.   
+0003a840: 2020 2020 2070 6c6f 745f 7479 7065 3a20       plot_type: 
+0003a850: 7374 7220 3d20 2263 695f 6875 6522 2c0a  str = "ci_hue",.
+0003a860: 2020 2020 2020 2020 6875 653a 2073 7472          hue: str
+0003a870: 203d 2022 6573 7469 6d61 746f 7222 2c0a   = "estimator",.
+0003a880: 2020 2020 2020 2020 6c65 6765 6e64 3a20          legend: 
+0003a890: 626f 6f6c 203d 2054 7275 652c 0a20 2020  bool = True,.   
+0003a8a0: 2020 2020 206e 5f63 6f6c 733a 204f 7074       n_cols: Opt
+0003a8b0: 696f 6e61 6c5b 696e 745d 203d 204e 6f6e  ional[int] = Non
+0003a8c0: 652c 0a20 2020 2020 2020 2073 6861 7265  e,.        share
+0003a8d0: 793a 2062 6f6f 6c20 3d20 4661 6c73 652c  y: bool = False,
+0003a8e0: 0a20 2020 2020 2020 2066 6967 5f64 6972  .        fig_dir
+0003a8f0: 3a20 4f70 7469 6f6e 616c 5b50 6174 685d  : Optional[Path]
+0003a900: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
+0003a910: 2066 6967 5f6e 616d 653a 2073 7472 203d   fig_name: str =
+0003a920: 2022 6573 7469 6d61 7465 645f 706f 6c69   "estimated_poli
+0003a930: 6379 5f76 616c 7565 5f6d 756c 7469 706c  cy_value_multipl
+0003a940: 652e 706e 6722 2c0a 2020 2020 2920 2d3e  e.png",.    ) ->
+0003a950: 204e 6f6e 653a 0a20 2020 2020 2020 2022   None:.        "
+0003a960: 2222 5669 7375 616c 697a 6520 7468 6520  ""Visualize the 
+0003a970: 706f 6c69 6379 2076 616c 7565 2065 7374  policy value est
+0003a980: 696d 6174 6564 2062 7920 4f50 4520 6573  imated by OPE es
+0003a990: 7469 6d61 746f 7273 2061 6372 6f73 7320  timators across 
+0003a9a0: 6d75 6c74 6970 6c65 206c 6f67 6765 6420  multiple logged 
+0003a9b0: 6461 7461 7365 742e 0a0a 2020 2020 2020  dataset...      
+0003a9c0: 2020 4e6f 7465 0a20 2020 2020 2020 202d    Note.        -
+0003a9d0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2054  ------.        T
+0003a9e0: 6869 7320 6675 6e63 7469 6f6e 2069 7320  his function is 
+0003a9f0: 6170 706c 6963 6162 6c65 206f 6e6c 7920  applicable only 
+0003aa00: 7768 656e 204d 756c 7469 706c 654c 6f67  when MultipleLog
+0003aa10: 6765 6444 6174 6173 6574 2069 7320 7573  gedDataset is us
+0003aa20: 6564 2061 6e64 0a20 2020 2020 2020 204d  ed and.        M
+0003aa30: 756c 7469 706c 6549 6e70 7574 4469 6374  ultipleInputDict
+0003aa40: 2069 7320 636f 6c6c 6563 7465 6420 6279   is collected by
+0003aa50: 2074 6865 2073 616d 6520 6576 616c 7561   the same evalua
+0003aa60: 7469 6f6e 2070 6f6c 6963 7920 6163 726f  tion policy acro
+0003aa70: 7373 206c 6f67 6765 6420 6461 7461 7365  ss logged datase
+0003aa80: 7473 2e0a 0a20 2020 2020 2020 2054 6869  ts...        Thi
+0003aa90: 7320 6675 6e63 7469 6f6e 2069 7320 6e6f  s function is no
+0003aaa0: 7420 6170 706c 6963 6162 6c65 2077 6865  t applicable whe
+0003aab0: 6e20 7468 6520 6461 7461 2d64 7269 7665  n the data-drive
+0003aac0: 6e20 7265 7761 7264 2073 6361 6c65 7220  n reward scaler 
+0003aad0: 6973 2075 7365 642e 0a20 2020 2020 2020  is used..       
+0003aae0: 2050 6c65 6173 6520 7365 7420 6060 7363   Please set ``sc
+0003aaf0: 616c 655f 6d69 6e60 602c 2060 6073 6361  ale_min``, ``sca
+0003ab00: 6c65 5f6d 6178 6060 2c20 616e 6420 6060  le_max``, and ``
+0003ab10: 6e5f 7061 7274 6974 696f 6e60 6020 746f  n_partition`` to
+0003ab20: 2075 7365 2e0a 0a20 2020 2020 2020 2050   use...        P
+0003ab30: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
+0003ab40: 2020 2d2d 2d2d 2d2d 2d0a 2020 2020 2020    -------.      
+0003ab50: 2020 696e 7075 745f 6469 6374 3a20 4d75    input_dict: Mu
+0003ab60: 6c74 6970 6c65 496e 7075 7444 6963 740a  ltipleInputDict.
+0003ab70: 2020 2020 2020 2020 2020 2020 4469 6374              Dict
+0003ab80: 696f 6e61 7279 206f 6620 7468 6520 4f50  ionary of the OP
+0003ab90: 4520 696e 7075 7473 2066 6f72 2065 6163  E inputs for eac
+0003aba0: 6820 6576 616c 7561 7469 6f6e 2070 6f6c  h evaluation pol
+0003abb0: 6963 792e 0a0a 2020 2020 2020 2020 2020  icy...          
+0003abc0: 2020 2e2e 2063 6f64 652d 626c 6f63 6b3a    .. code-block:
+0003abd0: 3a20 7079 7468 6f6e 0a0a 2020 2020 2020  : python..      
+0003abe0: 2020 2020 2020 2020 2020 6b65 793a 205b            key: [
+0003abf0: 6576 616c 7561 7469 6f6e 5f70 6f6c 6963  evaluation_polic
+0003ac00: 795d 5b0a 2020 2020 2020 2020 2020 2020  y][.            
+0003ac10: 2020 2020 2020 2020 6576 616c 7561 7469          evaluati
+0003ac20: 6f6e 5f70 6f6c 6963 795f 6163 7469 6f6e  on_policy_action
+0003ac30: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0003ac40: 2020 2020 2020 6576 616c 7561 7469 6f6e        evaluation
+0003ac50: 5f70 6f6c 6963 795f 6163 7469 6f6e 5f64  _policy_action_d
+0003ac60: 6973 742c 0a20 2020 2020 2020 2020 2020  ist,.           
+0003ac70: 2020 2020 2020 2020 2073 7461 7465 5f61           state_a
+0003ac80: 6374 696f 6e5f 7661 6c75 655f 7072 6564  ction_value_pred
+0003ac90: 6963 7469 6f6e 2c0a 2020 2020 2020 2020  iction,.        
+0003aca0: 2020 2020 2020 2020 2020 2020 696e 6974              init
+0003acb0: 6961 6c5f 7374 6174 655f 7661 6c75 655f  ial_state_value_
+0003acc0: 7072 6564 6963 7469 6f6e 2c0a 2020 2020  prediction,.    
+0003acd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ace0: 7374 6174 655f 6163 7469 6f6e 5f6d 6172  state_action_mar
+0003acf0: 6769 6e61 6c5f 696d 706f 7274 616e 6365  ginal_importance
+0003ad00: 5f77 6569 6768 742c 0a20 2020 2020 2020  _weight,.       
+0003ad10: 2020 2020 2020 2020 2020 2020 2073 7461               sta
+0003ad20: 7465 5f6d 6172 6769 6e61 6c5f 696d 706f  te_marginal_impo
+0003ad30: 7274 616e 6365 5f77 6569 6768 742c 0a20  rtance_weight,. 
+0003ad40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ad50: 2020 206f 6e5f 706f 6c69 6379 5f70 6f6c     on_policy_pol
+0003ad60: 6963 795f 7661 6c75 652c 0a20 2020 2020  icy_value,.     
+0003ad70: 2020 2020 2020 2020 2020 2020 2020 2067                 g
+0003ad80: 616d 6d61 2c0a 2020 2020 2020 2020 2020  amma,.          
+0003ad90: 2020 2020 2020 2020 2020 6265 6861 7669            behavi
+0003ada0: 6f72 5f70 6f6c 6963 792c 0a20 2020 2020  or_policy,.     
+0003adb0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0003adc0: 7661 6c75 6174 696f 6e5f 706f 6c69 6379  valuation_policy
+0003add0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0003ade0: 2020 2020 2020 6461 7461 7365 745f 6964        dataset_id
+0003adf0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0003ae00: 2020 5d0a 0a20 2020 2020 2020 2020 2020    ]..           
+0003ae10: 202e 2e20 7365 6561 6c73 6f3a 3a0a 0a20   .. seealso::.. 
+0003ae20: 2020 2020 2020 2020 2020 2020 2020 203a                 :
+0003ae30: 636c 6173 733a 6073 636f 7065 5f72 6c2e  class:`scope_rl.
+0003ae40: 6f70 652e 696e 7075 742e 4372 6561 7465  ope.input.Create
+0003ae50: 4f50 4549 6e70 7574 6020 6465 7363 7269  OPEInput` descri
+0003ae60: 6265 7320 7468 6520 636f 6d70 6f6e 656e  bes the componen
+0003ae70: 7473 206f 6620 3a63 6c61 7373 3a60 696e  ts of :class:`in
+0003ae80: 7075 745f 6469 6374 602e 0a0a 2020 2020  put_dict`...    
+0003ae90: 2020 2020 636f 6d70 6172 6564 5f65 7374      compared_est
+0003aea0: 696d 6174 6f72 733a 206c 6973 7420 6f66  imators: list of
+0003aeb0: 2073 7472 2c20 6465 6661 756c 743d 4e6f   str, default=No
+0003aec0: 6e65 0a20 2020 2020 2020 2020 2020 204e  ne.            N
+0003aed0: 616d 6520 6f66 2063 6f6d 7061 7265 6420  ame of compared 
+0003aee0: 6573 7469 6d61 746f 7273 2e0a 2020 2020  estimators..    
+0003aef0: 2020 2020 2020 2020 4966 2060 4e6f 6e65          If `None
+0003af00: 6020 6973 2067 6976 656e 2c20 616c 6c20  ` is given, all 
+0003af10: 7468 6520 6573 7469 6d61 746f 7273 2061  the estimators a
+0003af20: 7265 2063 6f6d 7061 7265 642e 0a0a 2020  re compared...  
+0003af30: 2020 2020 2020 6265 6861 7669 6f72 5f70        behavior_p
+0003af40: 6f6c 6963 795f 6e61 6d65 3a20 7374 722c  olicy_name: str,
+0003af50: 2064 6566 6175 6c74 3d4e 6f6e 650a 2020   default=None.  
+0003af60: 2020 2020 2020 2020 2020 4e61 6d65 206f            Name o
+0003af70: 6620 7468 6520 6265 6861 7669 6f72 2070  f the behavior p
+0003af80: 6f6c 6963 792e 0a0a 2020 2020 2020 2020  olicy...        
+0003af90: 706c 6f74 5f74 7970 653a 207b 2263 695f  plot_type: {"ci_
+0003afa0: 6875 6522 2c20 2263 695f 6265 6861 7669  hue", "ci_behavi
+0003afb0: 6f72 5f70 6f6c 6963 7922 2c20 2265 6e75  or_policy", "enu
+0003afc0: 6d65 7261 7465 227d 2c20 6465 6661 756c  merate"}, defaul
+0003afd0: 743d 2263 695f 6875 6522 0a20 2020 2020  t="ci_hue".     
+0003afe0: 2020 2020 2020 2054 7970 6520 6f66 2070         Type of p
+0003aff0: 6c6f 742e 0a20 2020 2020 2020 2020 2020  lot..           
+0003b000: 2049 6620 2263 6922 2069 7320 6769 7665   If "ci" is give
+0003b010: 6e2c 2074 6865 206d 6574 686f 6420 7669  n, the method vi
+0003b020: 7375 616c 697a 6573 2074 6865 2061 7665  sualizes the ave
+0003b030: 7261 6765 2070 6f6c 6963 7920 7661 6c75  rage policy valu
+0003b040: 6520 616e 6420 6974 7320 3935 2520 636f  e and its 95% co
+0003b050: 6e66 6964 656e 6365 2069 6e74 6572 7661  nfidence interva
+0003b060: 6c73 2062 6173 6564 206f 6e20 7468 6520  ls based on the 
+0003b070: 6d75 6c74 6970 6c65 2065 7374 696d 6174  multiple estimat
+0003b080: 652e 0a20 2020 2020 2020 2020 2020 2049  e..            I
+0003b090: 6620 2265 6e75 6d65 7261 7465 2220 6973  f "enumerate" is
+0003b0a0: 2067 6976 656e 2c20 7765 2067 6574 2061   given, we get a
+0003b0b0: 2073 6361 7474 6572 2070 6c6f 7420 6f66   scatter plot of
+0003b0c0: 2065 7374 696d 6174 6564 2076 616c 7565   estimated value
+0003b0d0: 732e 0a0a 2020 2020 2020 2020 6875 653a  s...        hue:
+0003b0e0: 207b 2265 7374 696d 6174 6f72 222c 2022   {"estimator", "
+0003b0f0: 706f 6c69 6379 227d 2c20 6465 6661 756c  policy"}, defaul
+0003b100: 743d 2265 7374 696d 6174 6f72 220a 2020  t="estimator".  
+0003b110: 2020 2020 2020 2020 2020 4875 6520 6f66            Hue of
+0003b120: 2074 6865 2070 6c6f 742e 0a0a 2020 2020   the plot...    
+0003b130: 2020 2020 6c65 6765 6e64 3a20 626f 6f6c      legend: bool
+0003b140: 2c20 6465 6661 756c 743d 5472 7565 0a20  , default=True. 
+0003b150: 2020 2020 2020 2020 2020 2057 6865 7468             Wheth
+0003b160: 6572 2074 6f20 696e 636c 7564 6520 6120  er to include a 
+0003b170: 6c65 6765 6e64 2069 6e20 7468 6520 7363  legend in the sc
+0003b180: 6174 7465 7220 706c 6f74 2e0a 0a20 2020  atter plot...   
+0003b190: 2020 2020 2073 6861 7265 793a 2062 6f6f       sharey: boo
+0003b1a0: 6c2c 2064 6566 6175 6c74 3d46 616c 7365  l, default=False
+0003b1b0: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
+0003b1c0: 6054 7275 6560 2c20 7468 6520 792d 6178  `True`, the y-ax
+0003b1d0: 6973 2077 696c 6c20 6265 2073 6861 7265  is will be share
+0003b1e0: 6420 616d 6f6e 6720 6469 6666 6572 656e  d among differen
+0003b1f0: 7420 6573 7469 6d61 746f 7273 206f 7220  t estimators or 
+0003b200: 6576 616c 7561 7469 6f6e 2070 6f6c 6963  evaluation polic
+0003b210: 6965 732e 0a0a 2020 2020 2020 2020 6669  ies...        fi
+0003b220: 675f 6469 723a 2050 6174 682c 2064 6566  g_dir: Path, def
+0003b230: 6175 6c74 3d4e 6f6e 650a 2020 2020 2020  ault=None.      
+0003b240: 2020 2020 2020 5061 7468 2074 6f20 7374        Path to st
+0003b250: 6f72 6520 7468 6520 6261 7220 6669 6775  ore the bar figu
+0003b260: 7265 2e0a 2020 2020 2020 2020 2020 2020  re..            
+0003b270: 4966 2060 4e6f 6e65 6020 6973 2067 6976  If `None` is giv
+0003b280: 656e 2c20 7468 6520 6669 6775 7265 2077  en, the figure w
+0003b290: 696c 6c20 6e6f 7420 6265 2073 6176 6564  ill not be saved
+0003b2a0: 2e0a 0a20 2020 2020 2020 2066 6967 5f6e  ...        fig_n
+0003b2b0: 616d 653a 2073 7472 2c20 6465 6661 756c  ame: str, defaul
+0003b2c0: 743d 2265 7374 696d 6174 6564 5f70 6f6c  t="estimated_pol
+0003b2d0: 6963 795f 7661 6c75 655f 6d75 6c74 6970  icy_value_multip
+0003b2e0: 6c65 2e70 6e67 220a 2020 2020 2020 2020  le.png".        
+0003b2f0: 2020 2020 4e61 6d65 206f 6620 7468 6520      Name of the 
+0003b300: 6261 7220 6669 6775 7265 2e0a 0a20 2020  bar figure...   
+0003b310: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0003b320: 2063 6f6d 7061 7265 645f 6573 7469 6d61   compared_estima
+0003b330: 746f 7273 203d 2073 656c 662e 5f63 6865  tors = self._che
+0003b340: 636b 5f63 6f6d 7061 7265 645f 6573 7469  ck_compared_esti
+0003b350: 6d61 746f 7273 2863 6f6d 7061 7265 645f  mators(compared_
+0003b360: 6573 7469 6d61 746f 7273 290a 2020 2020  estimators).    
+0003b370: 2020 2020 7265 7761 7264 5f73 6361 6c65      reward_scale
+0003b380: 203d 2073 656c 662e 5f63 7573 746f 6d5f   = self._custom_
+0003b390: 7265 7761 7264 5f73 6361 6c65 280a 2020  reward_scale(.  
+0003b3a0: 2020 2020 2020 2020 2020 7363 616c 655f            scale_
+0003b3b0: 6d69 6e3d 7363 616c 655f 6d69 6e2c 2073  min=scale_min, s
+0003b3c0: 6361 6c65 5f6d 6178 3d73 6361 6c65 5f6d  cale_max=scale_m
+0003b3d0: 6178 2c20 6e5f 7061 7274 6974 696f 6e3d  ax, n_partition=
+0003b3e0: 6e5f 7061 7274 6974 696f 6e0a 2020 2020  n_partition.    
+0003b3f0: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
+0003b400: 6c66 2e5f 6368 6563 6b5f 6261 7369 635f  lf._check_basic_
+0003b410: 7669 7375 616c 697a 6174 696f 6e5f 696e  visualization_in
+0003b420: 7075 7473 280a 2020 2020 2020 2020 2020  puts(.          
+0003b430: 2020 6875 653d 6875 652c 2066 6967 5f64    hue=hue, fig_d
+0003b440: 6972 3d66 6967 5f64 6972 2c20 6669 675f  ir=fig_dir, fig_
+0003b450: 6e61 6d65 3d66 6967 5f6e 616d 650a 2020  name=fig_name.  
+0003b460: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0003b470: 7365 6c66 2e5f 6368 6563 6b5f 696e 7075  self._check_inpu
+0003b480: 745f 6469 6374 5f66 6f72 5f76 6973 7561  t_dict_for_visua
+0003b490: 6c69 7a65 5f6d 756c 7469 706c 655f 6573  lize_multiple_es
+0003b4a0: 7469 6d61 7465 7328 696e 7075 745f 6469  timates(input_di
+0003b4b0: 6374 290a 0a20 2020 2020 2020 2069 6620  ct)..        if 
+0003b4c0: 706c 6f74 5f74 7970 6520 6e6f 7420 696e  plot_type not in
+0003b4d0: 205b 2263 695f 6875 6522 2c20 2263 695f   ["ci_hue", "ci_
+0003b4e0: 6265 6861 7669 6f72 5f70 6f6c 6963 7922  behavior_policy"
+0003b4f0: 2c20 2265 6e75 6d65 7261 7465 225d 3a0a  , "enumerate"]:.
+0003b500: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+0003b510: 6520 5661 6c75 6545 7272 6f72 280a 2020  e ValueError(.  
+0003b520: 2020 2020 2020 2020 2020 2020 2020 6622                f"
+0003b530: 706c 6f74 5f74 7970 6520 6d75 7374 2062  plot_type must b
+0003b540: 6520 6f6e 6520 6f66 2027 6369 5f68 7565  e one of 'ci_hue
+0003b550: 272c 2027 6369 5f62 6568 6176 696f 725f  ', 'ci_behavior_
+0003b560: 706f 6c69 6379 272c 2061 6e64 2027 656e  policy', and 'en
+0003b570: 756d 6572 6174 6527 2c20 6275 7420 7b70  umerate', but {p
+0003b580: 6c6f 745f 7479 7065 7d20 6973 2067 6976  lot_type} is giv
+0003b590: 656e 220a 2020 2020 2020 2020 2020 2020  en".            
+0003b5a0: 290a 0a20 2020 2020 2020 2069 6620 706c  )..        if pl
+0003b5b0: 6f74 5f74 7970 6520 696e 205b 2263 695f  ot_type in ["ci_
+0003b5c0: 6875 6522 2c20 2265 6e75 6d65 7261 7465  hue", "enumerate
 0003b5d0: 225d 3a0a 2020 2020 2020 2020 2020 2020  "]:.            
-0003b5e0: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
-0003b5f0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0003b600: 2020 6622 706c 6f74 5f74 7970 6520 6d75    f"plot_type mu
-0003b610: 7374 2062 6520 6f6e 6520 6f66 2027 6369  st be one of 'ci
-0003b620: 5f68 7565 272c 2027 6369 5f62 6568 6176  _hue', 'ci_behav
-0003b630: 696f 725f 706f 6c69 6379 272c 2061 6e64  ior_policy', and
-0003b640: 2027 656e 756d 6572 6174 6527 2c20 6275   'enumerate', bu
-0003b650: 7420 7b70 6c6f 745f 7479 7065 7d20 6973  t {plot_type} is
-0003b660: 2067 6976 656e 220a 2020 2020 2020 2020   given".        
-0003b670: 2020 2020 290a 0a20 2020 2020 2020 2069      )..        i
-0003b680: 6620 706c 6f74 5f74 7970 6520 696e 205b  f plot_type in [
-0003b690: 2263 695f 6875 6522 2c20 2265 6e75 6d65  "ci_hue", "enume
-0003b6a0: 7261 7465 225d 3a0a 2020 2020 2020 2020  rate"]:.        
-0003b6b0: 2020 2020 6966 2062 6568 6176 696f 725f      if behavior_
-0003b6c0: 706f 6c69 6379 5f6e 616d 6520 6973 204e  policy_name is N
-0003b6d0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-0003b6e0: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-0003b6f0: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
-0003b700: 2020 2020 2020 2020 2020 2066 2262 6568             f"beh
-0003b710: 6176 696f 725f 706f 6c69 6379 5f6e 616d  avior_policy_nam
-0003b720: 6520 6d75 7374 2062 6520 7370 6563 6966  e must be specif
-0003b730: 6965 6420 7768 656e 2070 6c6f 745f 7479  ied when plot_ty
-0003b740: 7065 2069 7320 277b 706c 6f74 5f74 7970  pe is '{plot_typ
-0003b750: 657d 2722 0a20 2020 2020 2020 2020 2020  e}'".           
-0003b760: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
-0003b770: 6966 206c 656e 2869 6e70 7574 5f64 6963  if len(input_dic
-0003b780: 742e 6265 6861 7669 6f72 5f70 6f6c 6963  t.behavior_polic
-0003b790: 795f 6e61 6d65 7329 203d 3d20 313a 0a20  y_names) == 1:. 
-0003b7a0: 2020 2020 2020 2020 2020 2062 6568 6176             behav
-0003b7b0: 696f 725f 706f 6c69 6379 5f6e 616d 6520  ior_policy_name 
-0003b7c0: 3d20 696e 7075 745f 6469 6374 2e62 6568  = input_dict.beh
-0003b7d0: 6176 696f 725f 706f 6c69 6379 5f6e 616d  avior_policy_nam
-0003b7e0: 6573 5b30 5d0a 0a20 2020 2020 2020 2063  es[0]..        c
-0003b7f0: 6466 5f64 6963 745f 203d 2073 656c 662e  df_dict_ = self.
-0003b800: 6573 7469 6d61 7465 5f63 756d 756c 6174  estimate_cumulat
-0003b810: 6976 655f 6469 7374 7269 6275 7469 6f6e  ive_distribution
-0003b820: 5f66 756e 6374 696f 6e28 0a20 2020 2020  _function(.     
-0003b830: 2020 2020 2020 2069 6e70 7574 5f64 6963         input_dic
-0003b840: 743d 696e 7075 745f 6469 6374 2c0a 2020  t=input_dict,.  
-0003b850: 2020 2020 2020 2020 2020 636f 6d70 6172            compar
-0003b860: 6564 5f65 7374 696d 6174 6f72 733d 636f  ed_estimators=co
-0003b870: 6d70 6172 6564 5f65 7374 696d 6174 6f72  mpared_estimator
-0003b880: 732c 0a20 2020 2020 2020 2020 2020 2062  s,.            b
-0003b890: 6568 6176 696f 725f 706f 6c69 6379 5f6e  ehavior_policy_n
-0003b8a0: 616d 653d 6265 6861 7669 6f72 5f70 6f6c  ame=behavior_pol
-0003b8b0: 6963 795f 6e61 6d65 2c0a 2020 2020 2020  icy_name,.      
-0003b8c0: 2020 2020 2020 7265 7761 7264 5f73 6361        reward_sca
-0003b8d0: 6c65 3d72 6577 6172 645f 7363 616c 652c  le=reward_scale,
-0003b8e0: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-0003b8f0: 2020 2020 6966 2062 6568 6176 696f 725f      if behavior_
-0003b900: 706f 6c69 6379 5f6e 616d 6520 6973 204e  policy_name is N
-0003b910: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-0003b920: 2069 6e70 7574 5f64 6963 745f 3020 3d20   input_dict_0 = 
-0003b930: 696e 7075 745f 6469 6374 2e67 6574 280a  input_dict.get(.
-0003b940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003b950: 6265 6861 7669 6f72 5f70 6f6c 6963 795f  behavior_policy_
-0003b960: 6e61 6d65 3d69 6e70 7574 5f64 6963 742e  name=input_dict.
-0003b970: 6265 6861 7669 6f72 5f70 6f6c 6963 795f  behavior_policy_
-0003b980: 6e61 6d65 735b 305d 2c20 6461 7461 7365  names[0], datase
-0003b990: 745f 6964 3d30 0a20 2020 2020 2020 2020  t_id=0.         
-0003b9a0: 2020 2029 0a20 2020 2020 2020 2065 6c73     ).        els
-0003b9b0: 653a 0a20 2020 2020 2020 2020 2020 2069  e:.            i
-0003b9c0: 6e70 7574 5f64 6963 745f 3020 3d20 696e  nput_dict_0 = in
-0003b9d0: 7075 745f 6469 6374 2e67 6574 280a 2020  put_dict.get(.  
-0003b9e0: 2020 2020 2020 2020 2020 2020 2020 6265                be
-0003b9f0: 6861 7669 6f72 5f70 6f6c 6963 795f 6e61  havior_policy_na
-0003ba00: 6d65 3d62 6568 6176 696f 725f 706f 6c69  me=behavior_poli
-0003ba10: 6379 5f6e 616d 652c 2064 6174 6173 6574  cy_name, dataset
-0003ba20: 5f69 643d 300a 2020 2020 2020 2020 2020  _id=0.          
-0003ba30: 2020 290a 0a20 2020 2020 2020 2069 6620    )..        if 
-0003ba40: 6265 6861 7669 6f72 5f70 6f6c 6963 795f  behavior_policy_
-0003ba50: 6e61 6d65 2069 7320 4e6f 6e65 3a0a 2020  name is None:.  
-0003ba60: 2020 2020 2020 2020 2020 6364 665f 6469            cdf_di
-0003ba70: 6374 203d 2064 6566 6175 6c74 6469 6374  ct = defaultdict
-0003ba80: 286c 616d 6264 613a 2064 6566 6175 6c74  (lambda: default
-0003ba90: 6469 6374 2864 6963 7429 290a 0a20 2020  dict(dict))..   
-0003baa0: 2020 2020 2020 2020 2066 6f72 2062 6568           for beh
-0003bab0: 6176 696f 725f 706f 6c69 6379 2c20 6e5f  avior_policy, n_
-0003bac0: 6461 7461 7365 7473 2069 6e20 696e 7075  datasets in inpu
-0003bad0: 745f 6469 6374 2e6e 5f64 6174 6173 6574  t_dict.n_dataset
-0003bae0: 732e 6974 656d 7328 293a 0a20 2020 2020  s.items():.     
-0003baf0: 2020 2020 2020 2020 2020 2066 6f72 2065             for e
-0003bb00: 7661 6c5f 706f 6c69 6379 2069 6e20 696e  val_policy in in
-0003bb10: 7075 745f 6469 6374 5f30 2e6b 6579 7328  put_dict_0.keys(
-0003bb20: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-0003bb30: 2020 2020 2020 2066 6f72 2065 7374 696d         for estim
-0003bb40: 6174 6f72 2069 6e20 636f 6d70 6172 6564  ator in compared
-0003bb50: 5f65 7374 696d 6174 6f72 733a 0a20 2020  _estimators:.   
-0003bb60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003bb70: 2020 2020 2063 6466 203d 206e 702e 7a65       cdf = np.ze
-0003bb80: 726f 7328 286e 5f64 6174 6173 6574 732c  ros((n_datasets,
-0003bb90: 206e 5f70 6172 7469 7469 6f6e 2929 0a20   n_partition)). 
-0003bba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003bbb0: 2020 2020 2020 2066 6f72 2064 6174 6173         for datas
-0003bbc0: 6574 5f69 645f 2069 6e20 7261 6e67 6528  et_id_ in range(
-0003bbd0: 6e5f 6461 7461 7365 7473 293a 0a20 2020  n_datasets):.   
-0003bbe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003bbf0: 2020 2020 2020 2020 2063 6466 5b64 6174           cdf[dat
-0003bc00: 6173 6574 5f69 645f 5d20 3d20 6364 665f  aset_id_] = cdf_
-0003bc10: 6469 6374 5f5b 6265 6861 7669 6f72 5f70  dict_[behavior_p
-0003bc20: 6f6c 6963 795d 5b64 6174 6173 6574 5f69  olicy][dataset_i
-0003bc30: 645f 5d5b 0a20 2020 2020 2020 2020 2020  d_][.           
-0003bc40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003bc50: 2020 2020 2065 7661 6c5f 706f 6c69 6379       eval_policy
-0003bc60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003bc70: 2020 2020 2020 2020 2020 2020 205d 5b65               ][e
-0003bc80: 7374 696d 6174 6f72 5d0a 0a20 2020 2020  stimator]..     
-0003bc90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003bca0: 2020 2063 6466 5f64 6963 745b 6265 6861     cdf_dict[beha
-0003bcb0: 7669 6f72 5f70 6f6c 6963 795d 5b65 7661  vior_policy][eva
-0003bcc0: 6c5f 706f 6c69 6379 5d5b 6573 7469 6d61  l_policy][estima
-0003bcd0: 746f 725d 203d 2063 6466 0a0a 2020 2020  tor] = cdf..    
-0003bce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003bcf0: 6364 665f 6469 6374 5b65 7661 6c5f 706f  cdf_dict[eval_po
-0003bd00: 6c69 6379 5d5b 226f 6e5f 706f 6c69 6379  licy]["on_policy
-0003bd10: 225d 203d 2063 6466 5f64 6963 745f 5b62  "] = cdf_dict_[b
-0003bd20: 6568 6176 696f 725f 706f 6c69 6379 5d5b  ehavior_policy][
-0003bd30: 305d 5b0a 2020 2020 2020 2020 2020 2020  0][.            
-0003bd40: 2020 2020 2020 2020 2020 2020 6576 616c              eval
-0003bd50: 5f70 6f6c 6963 790a 2020 2020 2020 2020  _policy.        
-0003bd60: 2020 2020 2020 2020 2020 2020 5d5b 226f              ]["o
-0003bd70: 6e5f 706f 6c69 6379 225d 0a0a 2020 2020  n_policy"]..    
-0003bd80: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-0003bd90: 2020 2020 2020 6364 665f 6469 6374 203d        cdf_dict =
-0003bda0: 2064 6566 6175 6c74 6469 6374 2864 6963   defaultdict(dic
-0003bdb0: 7429 0a20 2020 2020 2020 2020 2020 206e  t).            n
-0003bdc0: 5f64 6174 6173 6574 7320 3d20 696e 7075  _datasets = inpu
-0003bdd0: 745f 6469 6374 2e6e 5f64 6174 6173 6574  t_dict.n_dataset
-0003bde0: 735b 6265 6861 7669 6f72 5f70 6f6c 6963  s[behavior_polic
-0003bdf0: 795f 6e61 6d65 5d0a 0a20 2020 2020 2020  y_name]..       
-0003be00: 2020 2020 2066 6f72 2065 7661 6c5f 706f       for eval_po
-0003be10: 6c69 6379 2069 6e20 696e 7075 745f 6469  licy in input_di
-0003be20: 6374 5f30 2e6b 6579 7328 293a 0a20 2020  ct_0.keys():.   
-0003be30: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-0003be40: 2065 7374 696d 6174 6f72 2069 6e20 636f   estimator in co
-0003be50: 6d70 6172 6564 5f65 7374 696d 6174 6f72  mpared_estimator
-0003be60: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
-0003be70: 2020 2020 2020 2063 6466 203d 206e 702e         cdf = np.
-0003be80: 7a65 726f 7328 286e 5f64 6174 6173 6574  zeros((n_dataset
-0003be90: 732c 206e 5f70 6172 7469 7469 6f6e 2929  s, n_partition))
-0003bea0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003beb0: 2020 2020 2066 6f72 2064 6174 6173 6574       for dataset
-0003bec0: 5f69 645f 2069 6e20 7261 6e67 6528 6e5f  _id_ in range(n_
-0003bed0: 6461 7461 7365 7473 293a 0a20 2020 2020  datasets):.     
-0003bee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003bef0: 2020 2063 6466 5b64 6174 6173 6574 5f69     cdf[dataset_i
-0003bf00: 645f 5d20 3d20 6364 665f 6469 6374 5f5b  d_] = cdf_dict_[
-0003bf10: 6461 7461 7365 745f 6964 5f5d 5b65 7661  dataset_id_][eva
-0003bf20: 6c5f 706f 6c69 6379 5d5b 0a20 2020 2020  l_policy][.     
-0003bf30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003bf40: 2020 2020 2020 2065 7374 696d 6174 6f72         estimator
-0003bf50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003bf60: 2020 2020 2020 2020 205d 0a0a 2020 2020           ]..    
-0003bf70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003bf80: 6364 665f 6469 6374 5b65 7661 6c5f 706f  cdf_dict[eval_po
-0003bf90: 6c69 6379 5d5b 6573 7469 6d61 746f 725d  licy][estimator]
-0003bfa0: 203d 2063 6466 0a0a 2020 2020 2020 2020   = cdf..        
-0003bfb0: 2020 2020 2020 2020 6364 665f 6469 6374          cdf_dict
-0003bfc0: 5b65 7661 6c5f 706f 6c69 6379 5d5b 226f  [eval_policy]["o
-0003bfd0: 6e5f 706f 6c69 6379 225d 203d 2063 6466  n_policy"] = cdf
-0003bfe0: 5f64 6963 745f 5b30 5d5b 6576 616c 5f70  _dict_[0][eval_p
-0003bff0: 6f6c 6963 795d 5b0a 2020 2020 2020 2020  olicy][.        
-0003c000: 2020 2020 2020 2020 2020 2020 226f 6e5f              "on_
-0003c010: 706f 6c69 6379 220a 2020 2020 2020 2020  policy".        
-0003c020: 2020 2020 2020 2020 5d0a 0a20 2020 2020          ]..     
-0003c030: 2020 2070 6c74 2e73 7479 6c65 2e75 7365     plt.style.use
-0003c040: 2822 6767 706c 6f74 2229 0a20 2020 2020  ("ggplot").     
-0003c050: 2020 2063 6f6c 6f72 203d 2070 6c74 2e72     color = plt.r
-0003c060: 6350 6172 616d 735b 2261 7865 732e 7072  cParams["axes.pr
-0003c070: 6f70 5f63 7963 6c65 225d 2e62 795f 6b65  op_cycle"].by_ke
-0003c080: 7928 295b 2263 6f6c 6f72 225d 0a20 2020  y()["color"].   
-0003c090: 2020 2020 206e 5f63 6f6c 6f72 7320 3d20       n_colors = 
-0003c0a0: 6c65 6e28 636f 6c6f 7229 0a0a 2020 2020  len(color)..    
-0003c0b0: 2020 2020 6966 2070 6c6f 745f 7479 7065      if plot_type
-0003c0c0: 203d 3d20 2263 695f 6875 6522 3a0a 2020   == "ci_hue":.  
-0003c0d0: 2020 2020 2020 2020 2020 6966 2068 7565            if hue
-0003c0e0: 203d 3d20 2265 7374 696d 6174 6f72 223a   == "estimator":
-0003c0f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003c100: 206e 5f66 6967 7320 3d20 6c65 6e28 696e   n_figs = len(in
-0003c110: 7075 745f 6469 6374 5f30 290a 2020 2020  put_dict_0).    
-0003c120: 2020 2020 2020 2020 2020 2020 6e5f 636f              n_co
-0003c130: 6c73 203d 206d 696e 2833 2c20 6e5f 6669  ls = min(3, n_fi
-0003c140: 6773 2920 6966 206e 5f63 6f6c 7320 6973  gs) if n_cols is
-0003c150: 204e 6f6e 6520 656c 7365 206e 5f63 6f6c   None else n_col
-0003c160: 730a 2020 2020 2020 2020 2020 2020 2020  s.              
-0003c170: 2020 6e5f 726f 7773 203d 2028 6e5f 6669    n_rows = (n_fi
-0003c180: 6773 202d 2031 2920 2f2f 206e 5f63 6f6c  gs - 1) // n_col
-0003c190: 7320 2b20 310a 0a20 2020 2020 2020 2020  s + 1..         
-0003c1a0: 2020 2020 2020 2066 6967 2c20 6178 6573         fig, axes
-0003c1b0: 203d 2070 6c74 2e73 7562 706c 6f74 7328   = plt.subplots(
-0003c1c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003c1d0: 2020 2020 206e 726f 7773 3d6e 5f72 6f77       nrows=n_row
-0003c1e0: 732c 206e 636f 6c73 3d6e 5f63 6f6c 732c  s, ncols=n_cols,
-0003c1f0: 2066 6967 7369 7a65 3d28 3620 2a20 6e5f   figsize=(6 * n_
-0003c200: 636f 6c73 2c20 3420 2a20 6e5f 726f 7773  cols, 4 * n_rows
-0003c210: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0003c220: 2020 290a 0a20 2020 2020 2020 2020 2020    )..           
-0003c230: 2020 2020 2069 6620 6e5f 726f 7773 203d       if n_rows =
-0003c240: 3d20 313a 0a20 2020 2020 2020 2020 2020  = 1:.           
-0003c250: 2020 2020 2020 2020 2066 6f72 2069 2c20           for i, 
-0003c260: 6576 616c 5f70 6f6c 6963 7920 696e 2065  eval_policy in e
-0003c270: 6e75 6d65 7261 7465 2869 6e70 7574 5f64  numerate(input_d
-0003c280: 6963 745f 302e 6b65 7973 2829 293a 0a20  ict_0.keys()):. 
+0003b5e0: 6966 2062 6568 6176 696f 725f 706f 6c69  if behavior_poli
+0003b5f0: 6379 5f6e 616d 6520 6973 204e 6f6e 653a  cy_name is None:
+0003b600: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003b610: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+0003b620: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
+0003b630: 2020 2020 2020 2066 2262 6568 6176 696f         f"behavio
+0003b640: 725f 706f 6c69 6379 5f6e 616d 6520 6d75  r_policy_name mu
+0003b650: 7374 2062 6520 7370 6563 6966 6965 6420  st be specified 
+0003b660: 7768 656e 2070 6c6f 745f 7479 7065 2069  when plot_type i
+0003b670: 7320 277b 706c 6f74 5f74 7970 657d 2722  s '{plot_type}'"
+0003b680: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003b690: 2029 0a0a 2020 2020 2020 2020 6966 206c   )..        if l
+0003b6a0: 656e 2869 6e70 7574 5f64 6963 742e 6265  en(input_dict.be
+0003b6b0: 6861 7669 6f72 5f70 6f6c 6963 795f 6e61  havior_policy_na
+0003b6c0: 6d65 7329 203d 3d20 313a 0a20 2020 2020  mes) == 1:.     
+0003b6d0: 2020 2020 2020 2062 6568 6176 696f 725f         behavior_
+0003b6e0: 706f 6c69 6379 5f6e 616d 6520 3d20 696e  policy_name = in
+0003b6f0: 7075 745f 6469 6374 2e62 6568 6176 696f  put_dict.behavio
+0003b700: 725f 706f 6c69 6379 5f6e 616d 6573 5b30  r_policy_names[0
+0003b710: 5d0a 0a20 2020 2020 2020 2063 6466 5f64  ]..        cdf_d
+0003b720: 6963 745f 203d 2073 656c 662e 6573 7469  ict_ = self.esti
+0003b730: 6d61 7465 5f63 756d 756c 6174 6976 655f  mate_cumulative_
+0003b740: 6469 7374 7269 6275 7469 6f6e 5f66 756e  distribution_fun
+0003b750: 6374 696f 6e28 0a20 2020 2020 2020 2020  ction(.         
+0003b760: 2020 2069 6e70 7574 5f64 6963 743d 696e     input_dict=in
+0003b770: 7075 745f 6469 6374 2c0a 2020 2020 2020  put_dict,.      
+0003b780: 2020 2020 2020 636f 6d70 6172 6564 5f65        compared_e
+0003b790: 7374 696d 6174 6f72 733d 636f 6d70 6172  stimators=compar
+0003b7a0: 6564 5f65 7374 696d 6174 6f72 732c 0a20  ed_estimators,. 
+0003b7b0: 2020 2020 2020 2020 2020 2062 6568 6176             behav
+0003b7c0: 696f 725f 706f 6c69 6379 5f6e 616d 653d  ior_policy_name=
+0003b7d0: 6265 6861 7669 6f72 5f70 6f6c 6963 795f  behavior_policy_
+0003b7e0: 6e61 6d65 2c0a 2020 2020 2020 2020 2020  name,.          
+0003b7f0: 2020 7265 7761 7264 5f73 6361 6c65 3d72    reward_scale=r
+0003b800: 6577 6172 645f 7363 616c 652c 0a20 2020  eward_scale,.   
+0003b810: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+0003b820: 6966 2062 6568 6176 696f 725f 706f 6c69  if behavior_poli
+0003b830: 6379 5f6e 616d 6520 6973 204e 6f6e 653a  cy_name is None:
+0003b840: 0a20 2020 2020 2020 2020 2020 2069 6e70  .            inp
+0003b850: 7574 5f64 6963 745f 3020 3d20 696e 7075  ut_dict_0 = inpu
+0003b860: 745f 6469 6374 2e67 6574 280a 2020 2020  t_dict.get(.    
+0003b870: 2020 2020 2020 2020 2020 2020 6265 6861              beha
+0003b880: 7669 6f72 5f70 6f6c 6963 795f 6e61 6d65  vior_policy_name
+0003b890: 3d69 6e70 7574 5f64 6963 742e 6265 6861  =input_dict.beha
+0003b8a0: 7669 6f72 5f70 6f6c 6963 795f 6e61 6d65  vior_policy_name
+0003b8b0: 735b 305d 2c20 6461 7461 7365 745f 6964  s[0], dataset_id
+0003b8c0: 3d30 0a20 2020 2020 2020 2020 2020 2029  =0.            )
+0003b8d0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+0003b8e0: 2020 2020 2020 2020 2020 2069 6e70 7574             input
+0003b8f0: 5f64 6963 745f 3020 3d20 696e 7075 745f  _dict_0 = input_
+0003b900: 6469 6374 2e67 6574 280a 2020 2020 2020  dict.get(.      
+0003b910: 2020 2020 2020 2020 2020 6265 6861 7669            behavi
+0003b920: 6f72 5f70 6f6c 6963 795f 6e61 6d65 3d62  or_policy_name=b
+0003b930: 6568 6176 696f 725f 706f 6c69 6379 5f6e  ehavior_policy_n
+0003b940: 616d 652c 2064 6174 6173 6574 5f69 643d  ame, dataset_id=
+0003b950: 300a 2020 2020 2020 2020 2020 2020 290a  0.            ).
+0003b960: 0a20 2020 2020 2020 2069 6620 6265 6861  .        if beha
+0003b970: 7669 6f72 5f70 6f6c 6963 795f 6e61 6d65  vior_policy_name
+0003b980: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
+0003b990: 2020 2020 2020 6364 665f 6469 6374 203d        cdf_dict =
+0003b9a0: 2064 6566 6175 6c74 6469 6374 286c 616d   defaultdict(lam
+0003b9b0: 6264 613a 2064 6566 6175 6c74 6469 6374  bda: defaultdict
+0003b9c0: 2864 6963 7429 290a 0a20 2020 2020 2020  (dict))..       
+0003b9d0: 2020 2020 2066 6f72 2062 6568 6176 696f       for behavio
+0003b9e0: 725f 706f 6c69 6379 2c20 6e5f 6461 7461  r_policy, n_data
+0003b9f0: 7365 7473 2069 6e20 696e 7075 745f 6469  sets in input_di
+0003ba00: 6374 2e6e 5f64 6174 6173 6574 732e 6974  ct.n_datasets.it
+0003ba10: 656d 7328 293a 0a20 2020 2020 2020 2020  ems():.         
+0003ba20: 2020 2020 2020 2066 6f72 2065 7661 6c5f         for eval_
+0003ba30: 706f 6c69 6379 2069 6e20 696e 7075 745f  policy in input_
+0003ba40: 6469 6374 5f30 2e6b 6579 7328 293a 0a20  dict_0.keys():. 
+0003ba50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ba60: 2020 2066 6f72 2065 7374 696d 6174 6f72     for estimator
+0003ba70: 2069 6e20 636f 6d70 6172 6564 5f65 7374   in compared_est
+0003ba80: 696d 6174 6f72 733a 0a20 2020 2020 2020  imators:.       
+0003ba90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003baa0: 2063 6466 203d 206e 702e 7a65 726f 7328   cdf = np.zeros(
+0003bab0: 286e 5f64 6174 6173 6574 732c 206e 5f70  (n_datasets, n_p
+0003bac0: 6172 7469 7469 6f6e 2929 0a20 2020 2020  artition)).     
+0003bad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003bae0: 2020 2066 6f72 2064 6174 6173 6574 5f69     for dataset_i
+0003baf0: 645f 2069 6e20 7261 6e67 6528 6e5f 6461  d_ in range(n_da
+0003bb00: 7461 7365 7473 293a 0a20 2020 2020 2020  tasets):.       
+0003bb10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003bb20: 2020 2020 2063 6466 5b64 6174 6173 6574       cdf[dataset
+0003bb30: 5f69 645f 5d20 3d20 6364 665f 6469 6374  _id_] = cdf_dict
+0003bb40: 5f5b 6265 6861 7669 6f72 5f70 6f6c 6963  _[behavior_polic
+0003bb50: 795d 5b64 6174 6173 6574 5f69 645f 5d5b  y][dataset_id_][
+0003bb60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003bb70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003bb80: 2065 7661 6c5f 706f 6c69 6379 0a20 2020   eval_policy.   
+0003bb90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003bba0: 2020 2020 2020 2020 205d 5b65 7374 696d           ][estim
+0003bbb0: 6174 6f72 5d0a 0a20 2020 2020 2020 2020  ator]..         
+0003bbc0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+0003bbd0: 6466 5f64 6963 745b 6265 6861 7669 6f72  df_dict[behavior
+0003bbe0: 5f70 6f6c 6963 795d 5b65 7661 6c5f 706f  _policy][eval_po
+0003bbf0: 6c69 6379 5d5b 6573 7469 6d61 746f 725d  licy][estimator]
+0003bc00: 203d 2063 6466 0a0a 2020 2020 2020 2020   = cdf..        
+0003bc10: 2020 2020 2020 2020 2020 2020 6364 665f              cdf_
+0003bc20: 6469 6374 5b65 7661 6c5f 706f 6c69 6379  dict[eval_policy
+0003bc30: 5d5b 226f 6e5f 706f 6c69 6379 225d 203d  ]["on_policy"] =
+0003bc40: 2063 6466 5f64 6963 745f 5b62 6568 6176   cdf_dict_[behav
+0003bc50: 696f 725f 706f 6c69 6379 5d5b 305d 5b0a  ior_policy][0][.
+0003bc60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003bc70: 2020 2020 2020 2020 6576 616c 5f70 6f6c          eval_pol
+0003bc80: 6963 790a 2020 2020 2020 2020 2020 2020  icy.            
+0003bc90: 2020 2020 2020 2020 5d5b 226f 6e5f 706f          ]["on_po
+0003bca0: 6c69 6379 225d 0a0a 2020 2020 2020 2020  licy"]..        
+0003bcb0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0003bcc0: 2020 6364 665f 6469 6374 203d 2064 6566    cdf_dict = def
+0003bcd0: 6175 6c74 6469 6374 2864 6963 7429 0a20  aultdict(dict). 
+0003bce0: 2020 2020 2020 2020 2020 206e 5f64 6174             n_dat
+0003bcf0: 6173 6574 7320 3d20 696e 7075 745f 6469  asets = input_di
+0003bd00: 6374 2e6e 5f64 6174 6173 6574 735b 6265  ct.n_datasets[be
+0003bd10: 6861 7669 6f72 5f70 6f6c 6963 795f 6e61  havior_policy_na
+0003bd20: 6d65 5d0a 0a20 2020 2020 2020 2020 2020  me]..           
+0003bd30: 2066 6f72 2065 7661 6c5f 706f 6c69 6379   for eval_policy
+0003bd40: 2069 6e20 696e 7075 745f 6469 6374 5f30   in input_dict_0
+0003bd50: 2e6b 6579 7328 293a 0a20 2020 2020 2020  .keys():.       
+0003bd60: 2020 2020 2020 2020 2066 6f72 2065 7374           for est
+0003bd70: 696d 6174 6f72 2069 6e20 636f 6d70 6172  imator in compar
+0003bd80: 6564 5f65 7374 696d 6174 6f72 733a 0a20  ed_estimators:. 
+0003bd90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003bda0: 2020 2063 6466 203d 206e 702e 7a65 726f     cdf = np.zero
+0003bdb0: 7328 286e 5f64 6174 6173 6574 732c 206e  s((n_datasets, n
+0003bdc0: 5f70 6172 7469 7469 6f6e 2929 0a20 2020  _partition)).   
+0003bdd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003bde0: 2066 6f72 2064 6174 6173 6574 5f69 645f   for dataset_id_
+0003bdf0: 2069 6e20 7261 6e67 6528 6e5f 6461 7461   in range(n_data
+0003be00: 7365 7473 293a 0a20 2020 2020 2020 2020  sets):.         
+0003be10: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+0003be20: 6466 5b64 6174 6173 6574 5f69 645f 5d20  df[dataset_id_] 
+0003be30: 3d20 6364 665f 6469 6374 5f5b 6461 7461  = cdf_dict_[data
+0003be40: 7365 745f 6964 5f5d 5b65 7661 6c5f 706f  set_id_][eval_po
+0003be50: 6c69 6379 5d5b 0a20 2020 2020 2020 2020  licy][.         
+0003be60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003be70: 2020 2065 7374 696d 6174 6f72 0a20 2020     estimator.   
+0003be80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003be90: 2020 2020 205d 0a0a 2020 2020 2020 2020       ]..        
+0003bea0: 2020 2020 2020 2020 2020 2020 6364 665f              cdf_
+0003beb0: 6469 6374 5b65 7661 6c5f 706f 6c69 6379  dict[eval_policy
+0003bec0: 5d5b 6573 7469 6d61 746f 725d 203d 2063  ][estimator] = c
+0003bed0: 6466 0a0a 2020 2020 2020 2020 2020 2020  df..            
+0003bee0: 2020 2020 6364 665f 6469 6374 5b65 7661      cdf_dict[eva
+0003bef0: 6c5f 706f 6c69 6379 5d5b 226f 6e5f 706f  l_policy]["on_po
+0003bf00: 6c69 6379 225d 203d 2063 6466 5f64 6963  licy"] = cdf_dic
+0003bf10: 745f 5b30 5d5b 6576 616c 5f70 6f6c 6963  t_[0][eval_polic
+0003bf20: 795d 5b0a 2020 2020 2020 2020 2020 2020  y][.            
+0003bf30: 2020 2020 2020 2020 226f 6e5f 706f 6c69          "on_poli
+0003bf40: 6379 220a 2020 2020 2020 2020 2020 2020  cy".            
+0003bf50: 2020 2020 5d0a 0a20 2020 2020 2020 2070      ]..        p
+0003bf60: 6c74 2e73 7479 6c65 2e75 7365 2822 6767  lt.style.use("gg
+0003bf70: 706c 6f74 2229 0a20 2020 2020 2020 2063  plot").        c
+0003bf80: 6f6c 6f72 203d 2070 6c74 2e72 6350 6172  olor = plt.rcPar
+0003bf90: 616d 735b 2261 7865 732e 7072 6f70 5f63  ams["axes.prop_c
+0003bfa0: 7963 6c65 225d 2e62 795f 6b65 7928 295b  ycle"].by_key()[
+0003bfb0: 2263 6f6c 6f72 225d 0a20 2020 2020 2020  "color"].       
+0003bfc0: 206e 5f63 6f6c 6f72 7320 3d20 6c65 6e28   n_colors = len(
+0003bfd0: 636f 6c6f 7229 0a0a 2020 2020 2020 2020  color)..        
+0003bfe0: 6966 2070 6c6f 745f 7479 7065 203d 3d20  if plot_type == 
+0003bff0: 2263 695f 6875 6522 3a0a 2020 2020 2020  "ci_hue":.      
+0003c000: 2020 2020 2020 6966 2068 7565 203d 3d20        if hue == 
+0003c010: 2265 7374 696d 6174 6f72 223a 0a20 2020  "estimator":.   
+0003c020: 2020 2020 2020 2020 2020 2020 206e 5f66               n_f
+0003c030: 6967 7320 3d20 6c65 6e28 696e 7075 745f  igs = len(input_
+0003c040: 6469 6374 5f30 290a 2020 2020 2020 2020  dict_0).        
+0003c050: 2020 2020 2020 2020 6e5f 636f 6c73 203d          n_cols =
+0003c060: 206d 696e 2833 2c20 6e5f 6669 6773 2920   min(3, n_figs) 
+0003c070: 6966 206e 5f63 6f6c 7320 6973 204e 6f6e  if n_cols is Non
+0003c080: 6520 656c 7365 206e 5f63 6f6c 730a 2020  e else n_cols.  
+0003c090: 2020 2020 2020 2020 2020 2020 2020 6e5f                n_
+0003c0a0: 726f 7773 203d 2028 6e5f 6669 6773 202d  rows = (n_figs -
+0003c0b0: 2031 2920 2f2f 206e 5f63 6f6c 7320 2b20   1) // n_cols + 
+0003c0c0: 310a 0a20 2020 2020 2020 2020 2020 2020  1..             
+0003c0d0: 2020 2066 6967 2c20 6178 6573 203d 2070     fig, axes = p
+0003c0e0: 6c74 2e73 7562 706c 6f74 7328 0a20 2020  lt.subplots(.   
+0003c0f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c100: 206e 726f 7773 3d6e 5f72 6f77 732c 206e   nrows=n_rows, n
+0003c110: 636f 6c73 3d6e 5f63 6f6c 732c 2066 6967  cols=n_cols, fig
+0003c120: 7369 7a65 3d28 3620 2a20 6e5f 636f 6c73  size=(6 * n_cols
+0003c130: 2c20 3420 2a20 6e5f 726f 7773 290a 2020  , 4 * n_rows).  
+0003c140: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+0003c150: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003c160: 2069 6620 6e5f 726f 7773 203d 3d20 313a   if n_rows == 1:
+0003c170: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003c180: 2020 2020 2066 6f72 2069 2c20 6576 616c       for i, eval
+0003c190: 5f70 6f6c 6963 7920 696e 2065 6e75 6d65  _policy in enume
+0003c1a0: 7261 7465 2869 6e70 7574 5f64 6963 745f  rate(input_dict_
+0003c1b0: 302e 6b65 7973 2829 293a 0a20 2020 2020  0.keys()):.     
+0003c1c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c1d0: 2020 2066 6f72 206a 2c20 6573 7469 6d61     for j, estima
+0003c1e0: 746f 7220 696e 2065 6e75 6d65 7261 7465  tor in enumerate
+0003c1f0: 2863 6f6d 7061 7265 645f 6573 7469 6d61  (compared_estima
+0003c200: 746f 7273 293a 0a20 2020 2020 2020 2020  tors):.         
+0003c210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c220: 2020 2064 6620 3d20 4461 7461 4672 616d     df = DataFram
+0003c230: 6528 290a 2020 2020 2020 2020 2020 2020  e().            
+0003c240: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c250: 666f 7220 6c20 696e 2072 616e 6765 2869  for l in range(i
+0003c260: 6e70 7574 5f64 6963 742e 6e5f 6461 7461  nput_dict.n_data
+0003c270: 7365 7473 5b62 6568 6176 696f 725f 706f  sets[behavior_po
+0003c280: 6c69 6379 5f6e 616d 655d 293a 0a20 2020  licy_name]):.   
 0003c290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c2a0: 2020 2020 2020 2066 6f72 206a 2c20 6573         for j, es
-0003c2b0: 7469 6d61 746f 7220 696e 2065 6e75 6d65  timator in enume
-0003c2c0: 7261 7465 2863 6f6d 7061 7265 645f 6573  rate(compared_es
-0003c2d0: 7469 6d61 746f 7273 293a 0a20 2020 2020  timators):.     
-0003c2e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c2f0: 2020 2020 2020 2064 6620 3d20 4461 7461         df = Data
-0003c300: 4672 616d 6528 290a 2020 2020 2020 2020  Frame().        
-0003c310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c320: 2020 2020 666f 7220 6c20 696e 2072 616e      for l in ran
-0003c330: 6765 2869 6e70 7574 5f64 6963 742e 6e5f  ge(input_dict.n_
-0003c340: 6461 7461 7365 7473 5b62 6568 6176 696f  datasets[behavio
-0003c350: 725f 706f 6c69 6379 5f6e 616d 655d 293a  r_policy_name]):
-0003c360: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003c2a0: 2020 2020 2020 2020 2020 2020 2064 665b               df[
+0003c2b0: 2278 7363 616c 6522 5d20 3d20 7265 7761  "xscale"] = rewa
+0003c2c0: 7264 5f73 6361 6c65 0a20 2020 2020 2020  rd_scale.       
+0003c2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c2e0: 2020 2020 2020 2020 2064 665b 6c5d 203d           df[l] =
+0003c2f0: 2063 6466 5f64 6963 745b 6576 616c 5f70   cdf_dict[eval_p
+0003c300: 6f6c 6963 795d 5b65 7374 696d 6174 6f72  olicy][estimator
+0003c310: 5d5b 6c5d 0a0a 2020 2020 2020 2020 2020  ][l]..          
+0003c320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c330: 2020 6466 203d 2070 642e 6d65 6c74 280a    df = pd.melt(.
+0003c340: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c350: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c360: 6466 2c0a 2020 2020 2020 2020 2020 2020  df,.            
 0003c370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c380: 2064 665b 2278 7363 616c 6522 5d20 3d20   df["xscale"] = 
-0003c390: 7265 7761 7264 5f73 6361 6c65 0a20 2020  reward_scale.   
+0003c380: 2020 2020 6964 5f76 6172 733d 5b22 7873      id_vars=["xs
+0003c390: 6361 6c65 225d 2c0a 2020 2020 2020 2020  cale"],.        
 0003c3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c3b0: 2020 2020 2020 2020 2020 2020 2064 665b               df[
-0003c3c0: 6c5d 203d 2063 6466 5f64 6963 745b 6576  l] = cdf_dict[ev
-0003c3d0: 616c 5f70 6f6c 6963 795d 5b65 7374 696d  al_policy][estim
-0003c3e0: 6174 6f72 5d5b 6c5d 0a0a 2020 2020 2020  ator][l]..      
-0003c3f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c400: 2020 2020 2020 6466 203d 2070 642e 6d65        df = pd.me
-0003c410: 6c74 280a 2020 2020 2020 2020 2020 2020  lt(.            
+0003c3b0: 2020 2020 2020 2020 7661 725f 6e61 6d65          var_name
+0003c3c0: 3d22 6461 7461 7365 745f 6964 222c 0a20  ="dataset_id",. 
+0003c3d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c3e0: 2020 2020 2020 2020 2020 2020 2020 2076                 v
+0003c3f0: 616c 7565 5f6e 616d 653d 2263 6466 222c  alue_name="cdf",
+0003c400: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003c410: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
 0003c420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c430: 2020 2020 6466 2c0a 2020 2020 2020 2020      df,.        
-0003c440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c450: 2020 2020 2020 2020 6964 5f76 6172 733d          id_vars=
-0003c460: 5b22 7873 6361 6c65 225d 2c0a 2020 2020  ["xscale"],.    
-0003c470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c480: 2020 2020 2020 2020 2020 2020 7661 725f              var_
-0003c490: 6e61 6d65 3d22 6461 7461 7365 745f 6964  name="dataset_id
-0003c4a0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-0003c4b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c4c0: 2020 2076 616c 7565 5f6e 616d 653d 2263     value_name="c
-0003c4d0: 6466 222c 0a20 2020 2020 2020 2020 2020  df",.           
-0003c4e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c4f0: 2029 0a20 2020 2020 2020 2020 2020 2020   ).             
-0003c500: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-0003c510: 6e73 2e6c 696e 6570 6c6f 7428 0a20 2020  ns.lineplot(.   
-0003c520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c530: 2020 2020 2020 2020 2020 2020 2064 6174               dat
-0003c540: 613d 6466 2c0a 2020 2020 2020 2020 2020  a=df,.          
-0003c550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c560: 2020 2020 2020 783d 2278 7363 616c 6522        x="xscale"
-0003c570: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0003c580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c590: 2020 793d 2263 6466 222c 0a20 2020 2020    y="cdf",.     
-0003c5a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c5b0: 2020 2020 2020 2020 2020 2061 783d 6178             ax=ax
-0003c5c0: 6573 5b69 5d2c 0a20 2020 2020 2020 2020  es[i],.         
+0003c430: 2020 2020 2020 2020 2020 2073 6e73 2e6c             sns.l
+0003c440: 696e 6570 6c6f 7428 0a20 2020 2020 2020  ineplot(.       
+0003c450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c460: 2020 2020 2020 2020 2064 6174 613d 6466           data=df
+0003c470: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0003c480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c490: 2020 783d 2278 7363 616c 6522 2c0a 2020    x="xscale",.  
+0003c4a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c4b0: 2020 2020 2020 2020 2020 2020 2020 793d                y=
+0003c4c0: 2263 6466 222c 0a20 2020 2020 2020 2020  "cdf",.         
+0003c4d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c4e0: 2020 2020 2020 2061 783d 6178 6573 5b69         ax=axes[i
+0003c4f0: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
+0003c500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c510: 2020 2070 616c 6574 7465 3d5b 636f 6c6f     palette=[colo
+0003c520: 725b 6a20 2520 6e5f 636f 6c6f 7273 5d5d  r[j % n_colors]]
+0003c530: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0003c540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c550: 2020 6c61 6265 6c3d 2265 7374 696d 6174    label="estimat
+0003c560: 6f72 222c 0a20 2020 2020 2020 2020 2020  or",.           
+0003c570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c580: 2029 0a0a 2020 2020 2020 2020 2020 2020   )..            
+0003c590: 2020 2020 2020 2020 2020 2020 6f6e 5f70              on_p
+0003c5a0: 6f6c 6963 7920 3d20 6364 665f 6469 6374  olicy = cdf_dict
+0003c5b0: 5b65 7661 6c5f 706f 6c69 6379 5d5b 226f  [eval_policy]["o
+0003c5c0: 6e5f 706f 6c69 6379 225d 0a20 2020 2020  n_policy"].     
 0003c5d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c5e0: 2020 2020 2020 2070 616c 6574 7465 3d5b         palette=[
-0003c5f0: 636f 6c6f 725b 6a20 2520 6e5f 636f 6c6f  color[j % n_colo
-0003c600: 7273 5d5d 2c0a 2020 2020 2020 2020 2020  rs]],.          
-0003c610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c620: 2020 2020 2020 6c61 6265 6c3d 2265 7374        label="est
-0003c630: 696d 6174 6f72 222c 0a20 2020 2020 2020  imator",.       
-0003c640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c650: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+0003c5e0: 2020 2069 6620 6f6e 5f70 6f6c 6963 7920     if on_policy 
+0003c5f0: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+0003c600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c610: 2020 2020 2020 2020 2061 7865 735b 695d           axes[i]
+0003c620: 2e70 6c6f 7428 0a20 2020 2020 2020 2020  .plot(.         
+0003c630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c640: 2020 2020 2020 2072 6577 6172 645f 7363         reward_sc
+0003c650: 616c 652c 0a20 2020 2020 2020 2020 2020  ale,.           
 0003c660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c670: 6f6e 5f70 6f6c 6963 7920 3d20 6364 665f  on_policy = cdf_
-0003c680: 6469 6374 5b65 7661 6c5f 706f 6c69 6379  dict[eval_policy
-0003c690: 5d5b 226f 6e5f 706f 6c69 6379 225d 0a20  ]["on_policy"]. 
-0003c6a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c6b0: 2020 2020 2020 2069 6620 6f6e 5f70 6f6c         if on_pol
-0003c6c0: 6963 7920 6973 206e 6f74 204e 6f6e 653a  icy is not None:
-0003c6d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003c6e0: 2020 2020 2020 2020 2020 2020 2061 7865               axe
-0003c6f0: 735b 695d 2e70 6c6f 7428 0a20 2020 2020  s[i].plot(.     
-0003c700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c710: 2020 2020 2020 2020 2020 2072 6577 6172             rewar
-0003c720: 645f 7363 616c 652c 0a20 2020 2020 2020  d_scale,.       
-0003c730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c740: 2020 2020 2020 2020 206f 6e5f 706f 6c69           on_poli
-0003c750: 6379 2c0a 2020 2020 2020 2020 2020 2020  cy,.            
-0003c760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c770: 2020 2020 6c61 6265 6c3d 226f 6e5f 706f      label="on_po
-0003c780: 6c69 6379 222c 0a20 2020 2020 2020 2020  licy",.         
-0003c790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c7a0: 2020 2020 2020 2063 6f6c 6f72 3d22 626c         color="bl
-0003c7b0: 6163 6b22 2c0a 2020 2020 2020 2020 2020  ack",.          
-0003c7c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c7d0: 2020 290a 0a20 2020 2020 2020 2020 2020    )..           
-0003c7e0: 2020 2020 2020 2020 2020 2020 2061 7865               axe
-0003c7f0: 735b 695d 2e73 6574 5f74 6974 6c65 2865  s[i].set_title(e
-0003c800: 7661 6c5f 706f 6c69 6379 290a 2020 2020  val_policy).    
-0003c810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c820: 2020 2020 6178 6573 5b69 5d2e 7365 745f      axes[i].set_
-0003c830: 786c 6162 656c 2822 7472 616a 6563 746f  xlabel("trajecto
-0003c840: 7279 2d77 6973 6520 7265 7761 7264 2229  ry-wise reward")
-0003c850: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003c860: 2020 2020 2020 2020 2061 7865 735b 695d           axes[i]
-0003c870: 2e73 6574 5f79 6c61 6265 6c28 2263 756d  .set_ylabel("cum
-0003c880: 756c 6174 6976 6520 7072 6f62 6162 696c  ulative probabil
-0003c890: 6974 7922 290a 2020 2020 2020 2020 2020  ity").          
-0003c8a0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0003c8b0: 206c 6567 656e 643a 0a20 2020 2020 2020   legend:.       
-0003c8c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c8d0: 2020 2020 2061 7865 735b 695d 2e6c 6567       axes[i].leg
-0003c8e0: 656e 6428 290a 0a20 2020 2020 2020 2020  end()..         
-0003c8f0: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
-0003c900: 6765 6e64 3a0a 2020 2020 2020 2020 2020  gend:.          
-0003c910: 2020 2020 2020 2020 2020 2020 2020 6861                ha
-0003c920: 6e64 6c65 732c 206c 6162 656c 7320 3d20  ndles, labels = 
-0003c930: 6178 6573 5b30 5d2e 6765 745f 6c65 6765  axes[0].get_lege
-0003c940: 6e64 5f68 616e 646c 6573 5f6c 6162 656c  nd_handles_label
-0003c950: 7328 290a 2020 2020 2020 2020 2020 2020  s().            
-0003c960: 2020 2020 2020 2020 2020 2020 2320 6e5f              # n_
-0003c970: 636f 6c73 2073 686f 7773 2065 7272 0a20  cols shows err. 
-0003c980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003c990: 2020 2020 2020 2023 2066 6967 2e6c 6567         # fig.leg
-0003c9a0: 656e 6428 6861 6e64 6c65 732c 206c 6162  end(handles, lab
-0003c9b0: 656c 732c 206c 6f63 3d27 7570 7065 7220  els, loc='upper 
-0003c9c0: 6365 6e74 6572 272c 2062 626f 785f 746f  center', bbox_to
-0003c9d0: 5f61 6e63 686f 723d 2830 2e35 2c20 2d30  _anchor=(0.5, -0
-0003c9e0: 2e31 292c 206e 5f63 6f6c 733d 6d69 6e28  .1), n_cols=min(
-0003c9f0: 6c65 6e28 6c61 6265 6c73 292c 2036 2929  len(labels), 6))
-0003ca00: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0003ca10: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-0003ca20: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-0003ca30: 692c 2065 7661 6c5f 706f 6c69 6379 2069  i, eval_policy i
-0003ca40: 6e20 656e 756d 6572 6174 6528 696e 7075  n enumerate(inpu
-0003ca50: 745f 6469 6374 5f30 2e6b 6579 7328 2929  t_dict_0.keys())
-0003ca60: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0003ca70: 2020 2020 2020 2020 2020 666f 7220 6a2c            for j,
-0003ca80: 2065 7374 696d 6174 6f72 2069 6e20 656e   estimator in en
-0003ca90: 756d 6572 6174 6528 636f 6d70 6172 6564  umerate(compared
-0003caa0: 5f65 7374 696d 6174 6f72 7329 3a0a 2020  _estimators):.  
-0003cab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003cac0: 2020 2020 2020 2020 2020 6466 203d 2044            df = D
-0003cad0: 6174 6146 7261 6d65 2829 0a20 2020 2020  ataFrame().     
-0003cae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003caf0: 2020 2020 2020 2066 6f72 206c 2069 6e20         for l in 
-0003cb00: 7261 6e67 6528 696e 7075 745f 6469 6374  range(input_dict
-0003cb10: 2e6e 5f64 6174 6173 6574 735b 6265 6861  .n_datasets[beha
-0003cb20: 7669 6f72 5f70 6f6c 6963 795f 6e61 6d65  vior_policy_name
-0003cb30: 5d29 3a0a 2020 2020 2020 2020 2020 2020  ]):.            
+0003c670: 2020 2020 206f 6e5f 706f 6c69 6379 2c0a       on_policy,.
+0003c680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c690: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c6a0: 6c61 6265 6c3d 226f 6e5f 706f 6c69 6379  label="on_policy
+0003c6b0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+0003c6c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c6d0: 2020 2063 6f6c 6f72 3d22 626c 6163 6b22     color="black"
+0003c6e0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0003c6f0: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+0003c700: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003c710: 2020 2020 2020 2020 2061 7865 735b 695d           axes[i]
+0003c720: 2e73 6574 5f74 6974 6c65 2865 7661 6c5f  .set_title(eval_
+0003c730: 706f 6c69 6379 290a 2020 2020 2020 2020  policy).        
+0003c740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c750: 6178 6573 5b69 5d2e 7365 745f 786c 6162  axes[i].set_xlab
+0003c760: 656c 2822 7472 616a 6563 746f 7279 2d77  el("trajectory-w
+0003c770: 6973 6520 7265 7761 7264 2229 0a20 2020  ise reward").   
+0003c780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c790: 2020 2020 2061 7865 735b 695d 2e73 6574       axes[i].set
+0003c7a0: 5f79 6c61 6265 6c28 2263 756d 756c 6174  _ylabel("cumulat
+0003c7b0: 6976 6520 7072 6f62 6162 696c 6974 7922  ive probability"
+0003c7c0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0003c7d0: 2020 2020 2020 2020 2020 6966 206c 6567            if leg
+0003c7e0: 656e 643a 0a20 2020 2020 2020 2020 2020  end:.           
+0003c7f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c800: 2061 7865 735b 695d 2e6c 6567 656e 6428   axes[i].legend(
+0003c810: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
+0003c820: 2020 2020 2020 2069 6620 6c65 6765 6e64         if legend
+0003c830: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0003c840: 2020 2020 2020 2020 2020 6861 6e64 6c65            handle
+0003c850: 732c 206c 6162 656c 7320 3d20 6178 6573  s, labels = axes
+0003c860: 5b30 5d2e 6765 745f 6c65 6765 6e64 5f68  [0].get_legend_h
+0003c870: 616e 646c 6573 5f6c 6162 656c 7328 290a  andles_labels().
+0003c880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c890: 2020 2020 2020 2020 2320 6e5f 636f 6c73          # n_cols
+0003c8a0: 2073 686f 7773 2065 7272 0a20 2020 2020   shows err.     
+0003c8b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c8c0: 2020 2023 2066 6967 2e6c 6567 656e 6428     # fig.legend(
+0003c8d0: 6861 6e64 6c65 732c 206c 6162 656c 732c  handles, labels,
+0003c8e0: 206c 6f63 3d27 7570 7065 7220 6365 6e74   loc='upper cent
+0003c8f0: 6572 272c 2062 626f 785f 746f 5f61 6e63  er', bbox_to_anc
+0003c900: 686f 723d 2830 2e35 2c20 2d30 2e31 292c  hor=(0.5, -0.1),
+0003c910: 206e 5f63 6f6c 733d 6d69 6e28 6c65 6e28   n_cols=min(len(
+0003c920: 6c61 6265 6c73 292c 2036 2929 0a0a 2020  labels), 6))..  
+0003c930: 2020 2020 2020 2020 2020 2020 2020 656c                el
+0003c940: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+0003c950: 2020 2020 2020 2020 666f 7220 692c 2065          for i, e
+0003c960: 7661 6c5f 706f 6c69 6379 2069 6e20 656e  val_policy in en
+0003c970: 756d 6572 6174 6528 696e 7075 745f 6469  umerate(input_di
+0003c980: 6374 5f30 2e6b 6579 7328 2929 3a0a 2020  ct_0.keys()):.  
+0003c990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c9a0: 2020 2020 2020 666f 7220 6a2c 2065 7374        for j, est
+0003c9b0: 696d 6174 6f72 2069 6e20 656e 756d 6572  imator in enumer
+0003c9c0: 6174 6528 636f 6d70 6172 6564 5f65 7374  ate(compared_est
+0003c9d0: 696d 6174 6f72 7329 3a0a 2020 2020 2020  imators):.      
+0003c9e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003c9f0: 2020 2020 2020 6466 203d 2044 6174 6146        df = DataF
+0003ca00: 7261 6d65 2829 0a20 2020 2020 2020 2020  rame().         
+0003ca10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ca20: 2020 2066 6f72 206c 2069 6e20 7261 6e67     for l in rang
+0003ca30: 6528 696e 7075 745f 6469 6374 2e6e 5f64  e(input_dict.n_d
+0003ca40: 6174 6173 6574 735b 6265 6861 7669 6f72  atasets[behavior
+0003ca50: 5f70 6f6c 6963 795f 6e61 6d65 5d29 3a0a  _policy_name]):.
+0003ca60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ca70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ca80: 6466 5b22 7873 6361 6c65 225d 203d 2072  df["xscale"] = r
+0003ca90: 6577 6172 645f 7363 616c 650a 2020 2020  eward_scale.    
+0003caa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003cab0: 2020 2020 2020 2020 2020 2020 6466 5b6c              df[l
+0003cac0: 5d20 3d20 6364 665f 6469 6374 5b65 7661  ] = cdf_dict[eva
+0003cad0: 6c5f 706f 6c69 6379 5d5b 6573 7469 6d61  l_policy][estima
+0003cae0: 746f 725d 5b6c 5d0a 0a20 2020 2020 2020  tor][l]..       
+0003caf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003cb00: 2020 2020 2064 6620 3d20 7064 2e6d 656c       df = pd.mel
+0003cb10: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
+0003cb20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003cb30: 2020 2064 662c 0a20 2020 2020 2020 2020     df,.         
 0003cb40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003cb50: 2020 2020 6466 5b22 7873 6361 6c65 225d      df["xscale"]
-0003cb60: 203d 2072 6577 6172 645f 7363 616c 650a   = reward_scale.
+0003cb50: 2020 2020 2020 2069 645f 7661 7273 3d5b         id_vars=[
+0003cb60: 2278 7363 616c 6522 5d2c 0a20 2020 2020  "xscale"],.     
 0003cb70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003cb80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003cb90: 6466 5b6c 5d20 3d20 6364 665f 6469 6374  df[l] = cdf_dict
-0003cba0: 5b65 7661 6c5f 706f 6c69 6379 5d5b 6573  [eval_policy][es
-0003cbb0: 7469 6d61 746f 725d 5b6c 5d0a 0a20 2020  timator][l]..   
-0003cbc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003cbd0: 2020 2020 2020 2020 2064 6620 3d20 7064           df = pd
-0003cbe0: 2e6d 656c 7428 0a20 2020 2020 2020 2020  .melt(.         
-0003cbf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003cc00: 2020 2020 2020 2064 662c 0a20 2020 2020         df,.     
-0003cc10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003cc20: 2020 2020 2020 2020 2020 2069 645f 7661             id_va
-0003cc30: 7273 3d5b 2278 7363 616c 6522 5d2c 0a20  rs=["xscale"],. 
-0003cc40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003cc50: 2020 2020 2020 2020 2020 2020 2020 2076                 v
-0003cc60: 6172 5f6e 616d 653d 2264 6174 6173 6574  ar_name="dataset
-0003cc70: 5f69 6422 2c0a 2020 2020 2020 2020 2020  _id",.          
+0003cb80: 2020 2020 2020 2020 2020 2076 6172 5f6e             var_n
+0003cb90: 616d 653d 2264 6174 6173 6574 5f69 6422  ame="dataset_id"
+0003cba0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0003cbb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003cbc0: 2020 7661 6c75 655f 6e61 6d65 3d22 6364    value_name="cd
+0003cbd0: 6622 2c0a 2020 2020 2020 2020 2020 2020  f",.            
+0003cbe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003cbf0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0003cc00: 2020 2020 2020 2020 2020 2020 2020 736e                sn
+0003cc10: 732e 6c69 6e65 706c 6f74 280a 2020 2020  s.lineplot(.    
+0003cc20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003cc30: 2020 2020 2020 2020 2020 2020 6461 7461              data
+0003cc40: 3d64 662c 0a20 2020 2020 2020 2020 2020  =df,.           
+0003cc50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003cc60: 2020 2020 2078 3d22 7873 6361 6c65 222c       x="xscale",
+0003cc70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 0003cc80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003cc90: 2020 2020 2020 7661 6c75 655f 6e61 6d65        value_name
-0003cca0: 3d22 6364 6622 2c0a 2020 2020 2020 2020  ="cdf",.        
-0003ccb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ccc0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-0003ccd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003cce0: 2020 736e 732e 6c69 6e65 706c 6f74 280a    sns.lineplot(.
-0003ccf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003cd00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003cd10: 6461 7461 3d64 662c 0a20 2020 2020 2020  data=df,.       
+0003cc90: 2079 3d22 6364 6622 2c0a 2020 2020 2020   y="cdf",.      
+0003cca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ccb0: 2020 2020 2020 2020 2020 6178 3d61 7865            ax=axe
+0003ccc0: 735b 6920 2f2f 206e 5f63 6f6c 732c 2069  s[i // n_cols, i
+0003ccd0: 2025 206e 5f63 6f6c 735d 2c0a 2020 2020   % n_cols],.    
+0003cce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ccf0: 2020 2020 2020 2020 2020 2020 7061 6c65              pale
+0003cd00: 7474 653d 5b63 6f6c 6f72 5b6a 2025 206e  tte=[color[j % n
+0003cd10: 5f63 6f6c 6f72 735d 5d2c 0a20 2020 2020  _colors]],.     
 0003cd20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003cd30: 2020 2020 2020 2020 2078 3d22 7873 6361           x="xsca
-0003cd40: 6c65 222c 0a20 2020 2020 2020 2020 2020  le",.           
+0003cd30: 2020 2020 2020 2020 2020 206c 6162 656c             label
+0003cd40: 3d65 7374 696d 6174 6f72 2c0a 2020 2020  =estimator,.    
 0003cd50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003cd60: 2020 2020 2079 3d22 6364 6622 2c0a 2020       y="cdf",.  
+0003cd60: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
 0003cd70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003cd80: 2020 2020 2020 2020 2020 2020 2020 6178                ax
-0003cd90: 3d61 7865 735b 6920 2f2f 206e 5f63 6f6c  =axes[i // n_col
-0003cda0: 732c 2069 2025 206e 5f63 6f6c 735d 2c0a  s, i % n_cols],.
-0003cdb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003cdc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003cdd0: 7061 6c65 7474 653d 5b63 6f6c 6f72 5b6a  palette=[color[j
-0003cde0: 2025 206e 5f63 6f6c 6f72 735d 5d2c 0a20   % n_colors]],. 
+0003cd80: 2020 206f 6e5f 706f 6c69 6379 203d 2063     on_policy = c
+0003cd90: 6466 5f64 6963 745b 6576 616c 5f70 6f6c  df_dict[eval_pol
+0003cda0: 6963 795d 5b22 6f6e 5f70 6f6c 6963 7922  icy]["on_policy"
+0003cdb0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+0003cdc0: 2020 2020 2020 2020 2020 6966 206f 6e5f            if on_
+0003cdd0: 706f 6c69 6379 2069 7320 6e6f 7420 4e6f  policy is not No
+0003cde0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
 0003cdf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ce00: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-0003ce10: 6162 656c 3d65 7374 696d 6174 6f72 2c0a  abel=estimator,.
-0003ce20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ce30: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-0003ce40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ce50: 2020 2020 2020 206f 6e5f 706f 6c69 6379         on_policy
-0003ce60: 203d 2063 6466 5f64 6963 745b 6576 616c   = cdf_dict[eval
-0003ce70: 5f70 6f6c 6963 795d 5b22 6f6e 5f70 6f6c  _policy]["on_pol
-0003ce80: 6963 7922 5d0a 2020 2020 2020 2020 2020  icy"].          
-0003ce90: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0003cea0: 206f 6e5f 706f 6c69 6379 2069 7320 6e6f   on_policy is no
-0003ceb0: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
+0003ce00: 6178 6573 5b69 202f 2f20 6e5f 636f 6c73  axes[i // n_cols
+0003ce10: 2c20 6920 2520 6e5f 636f 6c73 5d2e 706c  , i % n_cols].pl
+0003ce20: 6f74 280a 2020 2020 2020 2020 2020 2020  ot(.            
+0003ce30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ce40: 2020 2020 7265 7761 7264 5f73 6361 6c65      reward_scale
+0003ce50: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0003ce60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ce70: 2020 6f6e 5f70 6f6c 6963 792c 0a20 2020    on_policy,.   
+0003ce80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ce90: 2020 2020 2020 2020 2020 2020 206c 6162               lab
+0003cea0: 656c 3d22 6f6e 5f70 6f6c 6963 7922 2c0a  el="on_policy",.
+0003ceb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0003cec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ced0: 2020 2020 6178 6573 5b69 202f 2f20 6e5f      axes[i // n_
-0003cee0: 636f 6c73 2c20 6920 2520 6e5f 636f 6c73  cols, i % n_cols
-0003cef0: 5d2e 706c 6f74 280a 2020 2020 2020 2020  ].plot(.        
+0003ced0: 636f 6c6f 723d 2262 6c61 636b 222c 0a20  color="black",. 
+0003cee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003cef0: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
 0003cf00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003cf10: 2020 2020 2020 2020 7265 7761 7264 5f73          reward_s
-0003cf20: 6361 6c65 2c0a 2020 2020 2020 2020 2020  cale,.          
-0003cf30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003cf40: 2020 2020 2020 6f6e 5f70 6f6c 6963 792c        on_policy,
-0003cf50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003cf60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003cf70: 206c 6162 656c 3d22 6f6e 5f70 6f6c 6963   label="on_polic
-0003cf80: 7922 2c0a 2020 2020 2020 2020 2020 2020  y",.            
+0003cf10: 2020 2020 2020 6178 6573 5b69 202f 2f20        axes[i // 
+0003cf20: 6e5f 636f 6c73 2c20 6920 2520 6e5f 636f  n_cols, i % n_co
+0003cf30: 6c73 5d2e 7365 745f 7469 746c 6528 6576  ls].set_title(ev
+0003cf40: 616c 5f70 6f6c 6963 7929 0a20 2020 2020  al_policy).     
+0003cf50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003cf60: 2020 2061 7865 735b 6920 2f2f 206e 5f63     axes[i // n_c
+0003cf70: 6f6c 732c 2069 2025 206e 5f63 6f6c 735d  ols, i % n_cols]
+0003cf80: 2e73 6574 5f78 6c61 6265 6c28 0a20 2020  .set_xlabel(.   
 0003cf90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003cfa0: 2020 2020 636f 6c6f 723d 2262 6c61 636b      color="black
-0003cfb0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-0003cfc0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-0003cfd0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0003cfe0: 2020 2020 2020 2020 2020 6178 6573 5b69            axes[i
-0003cff0: 202f 2f20 6e5f 636f 6c73 2c20 6920 2520   // n_cols, i % 
-0003d000: 6e5f 636f 6c73 5d2e 7365 745f 7469 746c  n_cols].set_titl
-0003d010: 6528 6576 616c 5f70 6f6c 6963 7929 0a20  e(eval_policy). 
+0003cfa0: 2020 2020 2020 2020 2022 7472 616a 6563           "trajec
+0003cfb0: 746f 7279 2d77 6973 6520 7265 7761 7264  tory-wise reward
+0003cfc0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+0003cfd0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+0003cfe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003cff0: 2020 2020 6178 6573 5b69 202f 2f20 6e5f      axes[i // n_
+0003d000: 636f 6c73 2c20 6920 2520 6e5f 636f 6c73  cols, i % n_cols
+0003d010: 5d2e 7365 745f 796c 6162 656c 280a 2020  ].set_ylabel(.  
 0003d020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d030: 2020 2020 2020 2061 7865 735b 6920 2f2f         axes[i //
-0003d040: 206e 5f63 6f6c 732c 2069 2025 206e 5f63   n_cols, i % n_c
-0003d050: 6f6c 735d 2e73 6574 5f78 6c61 6265 6c28  ols].set_xlabel(
-0003d060: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003d070: 2020 2020 2020 2020 2020 2020 2022 7472               "tr
-0003d080: 616a 6563 746f 7279 2d77 6973 6520 7265  ajectory-wise re
-0003d090: 7761 7264 220a 2020 2020 2020 2020 2020  ward".          
-0003d0a0: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-0003d0b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d0c0: 2020 2020 2020 2020 6178 6573 5b69 202f          axes[i /
-0003d0d0: 2f20 6e5f 636f 6c73 2c20 6920 2520 6e5f  / n_cols, i % n_
-0003d0e0: 636f 6c73 5d2e 7365 745f 796c 6162 656c  cols].set_ylabel
-0003d0f0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0003d100: 2020 2020 2020 2020 2020 2020 2020 2263                "c
-0003d110: 756d 756c 6174 6976 6520 7072 6f62 6162  umulative probab
-0003d120: 696c 6974 7922 0a20 2020 2020 2020 2020  ility".         
-0003d130: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-0003d140: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003d150: 2020 2020 2020 2020 2069 6620 6c65 6765           if lege
-0003d160: 6e64 3a0a 2020 2020 2020 2020 2020 2020  nd:.            
+0003d030: 2020 2020 2020 2020 2020 2263 756d 756c            "cumul
+0003d040: 6174 6976 6520 7072 6f62 6162 696c 6974  ative probabilit
+0003d050: 7922 0a20 2020 2020 2020 2020 2020 2020  y".             
+0003d060: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+0003d070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d080: 2020 2020 2069 6620 6c65 6765 6e64 3a0a       if legend:.
+0003d090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d0a0: 2020 2020 2020 2020 2020 2020 6178 6573              axes
+0003d0b0: 5b69 202f 2f20 6e5f 636f 6c73 2c20 6920  [i // n_cols, i 
+0003d0c0: 2520 6e5f 636f 6c73 5d2e 6c65 6765 6e64  % n_cols].legend
+0003d0d0: 2829 0a0a 2020 2020 2020 2020 2020 2020  ()..            
+0003d0e0: 2020 2020 2020 2020 6966 206c 6567 656e          if legen
+0003d0f0: 643a 0a20 2020 2020 2020 2020 2020 2020  d:.             
+0003d100: 2020 2020 2020 2020 2020 2068 616e 646c             handl
+0003d110: 6573 2c20 6c61 6265 6c73 203d 2061 7865  es, labels = axe
+0003d120: 735b 302c 2030 5d2e 6765 745f 6c65 6765  s[0, 0].get_lege
+0003d130: 6e64 5f68 616e 646c 6573 5f6c 6162 656c  nd_handles_label
+0003d140: 7328 290a 2020 2020 2020 2020 2020 2020  s().            
+0003d150: 2020 2020 2020 2020 2020 2020 2320 6e5f              # n_
+0003d160: 636f 6c73 2073 686f 7773 2065 7272 0a20  cols shows err. 
 0003d170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d180: 6178 6573 5b69 202f 2f20 6e5f 636f 6c73  axes[i // n_cols
-0003d190: 2c20 6920 2520 6e5f 636f 6c73 5d2e 6c65  , i % n_cols].le
-0003d1a0: 6765 6e64 2829 0a0a 2020 2020 2020 2020  gend()..        
-0003d1b0: 2020 2020 2020 2020 2020 2020 6966 206c              if l
-0003d1c0: 6567 656e 643a 0a20 2020 2020 2020 2020  egend:.         
-0003d1d0: 2020 2020 2020 2020 2020 2020 2020 2068                 h
-0003d1e0: 616e 646c 6573 2c20 6c61 6265 6c73 203d  andles, labels =
-0003d1f0: 2061 7865 735b 302c 2030 5d2e 6765 745f   axes[0, 0].get_
-0003d200: 6c65 6765 6e64 5f68 616e 646c 6573 5f6c  legend_handles_l
-0003d210: 6162 656c 7328 290a 2020 2020 2020 2020  abels().        
-0003d220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d230: 2320 6e5f 636f 6c73 2073 686f 7773 2065  # n_cols shows e
-0003d240: 7272 0a20 2020 2020 2020 2020 2020 2020  rr.             
-0003d250: 2020 2020 2020 2020 2020 2023 2066 6967             # fig
-0003d260: 2e6c 6567 656e 6428 6861 6e64 6c65 732c  .legend(handles,
-0003d270: 206c 6162 656c 732c 206c 6f63 3d27 7570   labels, loc='up
-0003d280: 7065 7220 6365 6e74 6572 272c 2062 626f  per center', bbo
-0003d290: 785f 746f 5f61 6e63 686f 723d 2830 2e35  x_to_anchor=(0.5
-0003d2a0: 2c20 2d30 2e31 292c 206e 5f63 6f6c 733d  , -0.1), n_cols=
-0003d2b0: 6d69 6e28 6c65 6e28 6c61 6265 6c73 292c  min(len(labels),
-0003d2c0: 2036 2929 0a0a 2020 2020 2020 2020 2020   6))..          
-0003d2d0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-0003d2e0: 2020 2020 2020 2020 7669 7375 616c 697a          visualiz
-0003d2f0: 655f 6f6e 5f70 6f6c 6963 7920 3d20 5472  e_on_policy = Tr
-0003d300: 7565 0a20 2020 2020 2020 2020 2020 2020  ue.             
-0003d310: 2020 2066 6f72 2065 7661 6c5f 706f 6c69     for eval_poli
-0003d320: 6379 2069 6e20 696e 7075 745f 6469 6374  cy in input_dict
-0003d330: 5f30 2e6b 6579 7328 293a 0a20 2020 2020  _0.keys():.     
-0003d340: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0003d350: 6620 696e 7075 745f 6469 6374 5f30 5b65  f input_dict_0[e
-0003d360: 7661 6c5f 706f 6c69 6379 5d5b 226f 6e5f  val_policy]["on_
-0003d370: 706f 6c69 6379 5f70 6f6c 6963 795f 7661  policy_policy_va
-0003d380: 6c75 6522 5d20 6973 204e 6f6e 653a 0a20  lue"] is None:. 
-0003d390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d3a0: 2020 2020 2020 2076 6973 7561 6c69 7a65         visualize
-0003d3b0: 5f6f 6e5f 706f 6c69 6379 203d 2046 616c  _on_policy = Fal
-0003d3c0: 7365 0a0a 2020 2020 2020 2020 2020 2020  se..            
-0003d3d0: 2020 2020 6e5f 6669 6773 203d 2028 0a20      n_figs = (. 
-0003d3e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d3f0: 2020 206c 656e 2863 6f6d 7061 7265 645f     len(compared_
-0003d400: 6573 7469 6d61 746f 7273 2920 2b20 310a  estimators) + 1.
-0003d410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d420: 2020 2020 6966 2076 6973 7561 6c69 7a65      if visualize
-0003d430: 5f6f 6e5f 706f 6c69 6379 0a20 2020 2020  _on_policy.     
-0003d440: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0003d450: 6c73 6520 6c65 6e28 636f 6d70 6172 6564  lse len(compared
-0003d460: 5f65 7374 696d 6174 6f72 7329 0a20 2020  _estimators).   
-0003d470: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
-0003d480: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-0003d490: 5f63 6f6c 7320 3d20 6d69 6e28 332c 206e  _cols = min(3, n
-0003d4a0: 5f66 6967 7329 2069 6620 6e5f 636f 6c73  _figs) if n_cols
-0003d4b0: 2069 7320 4e6f 6e65 2065 6c73 6520 6e5f   is None else n_
-0003d4c0: 636f 6c73 0a20 2020 2020 2020 2020 2020  cols.           
-0003d4d0: 2020 2020 206e 5f72 6f77 7320 3d20 286e       n_rows = (n
-0003d4e0: 5f66 6967 7320 2d20 3129 202f 2f20 6e5f  _figs - 1) // n_
-0003d4f0: 636f 6c73 202b 2031 0a0a 2020 2020 2020  cols + 1..      
-0003d500: 2020 2020 2020 2020 2020 6669 672c 2061            fig, a
-0003d510: 7865 7320 3d20 706c 742e 7375 6270 6c6f  xes = plt.subplo
-0003d520: 7473 280a 2020 2020 2020 2020 2020 2020  ts(.            
-0003d530: 2020 2020 2020 2020 6e72 6f77 733d 6e5f          nrows=n_
-0003d540: 726f 7773 2c20 6e63 6f6c 733d 6e5f 636f  rows, ncols=n_co
-0003d550: 6c73 2c20 6669 6773 697a 653d 2836 202a  ls, figsize=(6 *
-0003d560: 206e 5f63 6f6c 732c 2034 202a 206e 5f72   n_cols, 4 * n_r
-0003d570: 6f77 7329 0a20 2020 2020 2020 2020 2020  ows).           
-0003d580: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
-0003d590: 2020 2020 2020 2020 6966 206e 5f72 6f77          if n_row
-0003d5a0: 7320 3d3d 2031 3a0a 2020 2020 2020 2020  s == 1:.        
-0003d5b0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-0003d5c0: 692c 2065 7374 696d 6174 6f72 2069 6e20  i, estimator in 
-0003d5d0: 656e 756d 6572 6174 6528 636f 6d70 6172  enumerate(compar
-0003d5e0: 6564 5f65 7374 696d 6174 6f72 7329 3a0a  ed_estimators):.
+0003d180: 2020 2020 2020 2023 2066 6967 2e6c 6567         # fig.leg
+0003d190: 656e 6428 6861 6e64 6c65 732c 206c 6162  end(handles, lab
+0003d1a0: 656c 732c 206c 6f63 3d27 7570 7065 7220  els, loc='upper 
+0003d1b0: 6365 6e74 6572 272c 2062 626f 785f 746f  center', bbox_to
+0003d1c0: 5f61 6e63 686f 723d 2830 2e35 2c20 2d30  _anchor=(0.5, -0
+0003d1d0: 2e31 292c 206e 5f63 6f6c 733d 6d69 6e28  .1), n_cols=min(
+0003d1e0: 6c65 6e28 6c61 6265 6c73 292c 2036 2929  len(labels), 6))
+0003d1f0: 0a0a 2020 2020 2020 2020 2020 2020 656c  ..            el
+0003d200: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+0003d210: 2020 2020 7669 7375 616c 697a 655f 6f6e      visualize_on
+0003d220: 5f70 6f6c 6963 7920 3d20 5472 7565 0a20  _policy = True. 
+0003d230: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0003d240: 6f72 2065 7661 6c5f 706f 6c69 6379 2069  or eval_policy i
+0003d250: 6e20 696e 7075 745f 6469 6374 5f30 2e6b  n input_dict_0.k
+0003d260: 6579 7328 293a 0a20 2020 2020 2020 2020  eys():.         
+0003d270: 2020 2020 2020 2020 2020 2069 6620 696e             if in
+0003d280: 7075 745f 6469 6374 5f30 5b65 7661 6c5f  put_dict_0[eval_
+0003d290: 706f 6c69 6379 5d5b 226f 6e5f 706f 6c69  policy]["on_poli
+0003d2a0: 6379 5f70 6f6c 6963 795f 7661 6c75 6522  cy_policy_value"
+0003d2b0: 5d20 6973 204e 6f6e 653a 0a20 2020 2020  ] is None:.     
+0003d2c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d2d0: 2020 2076 6973 7561 6c69 7a65 5f6f 6e5f     visualize_on_
+0003d2e0: 706f 6c69 6379 203d 2046 616c 7365 0a0a  policy = False..
+0003d2f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d300: 6e5f 6669 6773 203d 2028 0a20 2020 2020  n_figs = (.     
+0003d310: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+0003d320: 656e 2863 6f6d 7061 7265 645f 6573 7469  en(compared_esti
+0003d330: 6d61 746f 7273 2920 2b20 310a 2020 2020  mators) + 1.    
+0003d340: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d350: 6966 2076 6973 7561 6c69 7a65 5f6f 6e5f  if visualize_on_
+0003d360: 706f 6c69 6379 0a20 2020 2020 2020 2020  policy.         
+0003d370: 2020 2020 2020 2020 2020 2065 6c73 6520             else 
+0003d380: 6c65 6e28 636f 6d70 6172 6564 5f65 7374  len(compared_est
+0003d390: 696d 6174 6f72 7329 0a20 2020 2020 2020  imators).       
+0003d3a0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+0003d3b0: 2020 2020 2020 2020 2020 206e 5f63 6f6c             n_col
+0003d3c0: 7320 3d20 6d69 6e28 332c 206e 5f66 6967  s = min(3, n_fig
+0003d3d0: 7329 2069 6620 6e5f 636f 6c73 2069 7320  s) if n_cols is 
+0003d3e0: 4e6f 6e65 2065 6c73 6520 6e5f 636f 6c73  None else n_cols
+0003d3f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003d400: 206e 5f72 6f77 7320 3d20 286e 5f66 6967   n_rows = (n_fig
+0003d410: 7320 2d20 3129 202f 2f20 6e5f 636f 6c73  s - 1) // n_cols
+0003d420: 202b 2031 0a0a 2020 2020 2020 2020 2020   + 1..          
+0003d430: 2020 2020 2020 6669 672c 2061 7865 7320        fig, axes 
+0003d440: 3d20 706c 742e 7375 6270 6c6f 7473 280a  = plt.subplots(.
+0003d450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d460: 2020 2020 6e72 6f77 733d 6e5f 726f 7773      nrows=n_rows
+0003d470: 2c20 6e63 6f6c 733d 6e5f 636f 6c73 2c20  , ncols=n_cols, 
+0003d480: 6669 6773 697a 653d 2836 202a 206e 5f63  figsize=(6 * n_c
+0003d490: 6f6c 732c 2034 202a 206e 5f72 6f77 7329  ols, 4 * n_rows)
+0003d4a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003d4b0: 2029 0a0a 2020 2020 2020 2020 2020 2020   )..            
+0003d4c0: 2020 2020 6966 206e 5f72 6f77 7320 3d3d      if n_rows ==
+0003d4d0: 2031 3a0a 2020 2020 2020 2020 2020 2020   1:.            
+0003d4e0: 2020 2020 2020 2020 666f 7220 692c 2065          for i, e
+0003d4f0: 7374 696d 6174 6f72 2069 6e20 656e 756d  stimator in enum
+0003d500: 6572 6174 6528 636f 6d70 6172 6564 5f65  erate(compared_e
+0003d510: 7374 696d 6174 6f72 7329 3a0a 2020 2020  stimators):.    
+0003d520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d530: 2020 2020 666f 7220 6a2c 2065 7661 6c5f      for j, eval_
+0003d540: 706f 6c69 6379 2069 6e20 656e 756d 6572  policy in enumer
+0003d550: 6174 6528 696e 7075 745f 6469 6374 5f30  ate(input_dict_0
+0003d560: 2e6b 6579 7328 2929 3a0a 2020 2020 2020  .keys()):.      
+0003d570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d580: 2020 2020 2020 6466 203d 2044 6174 6146        df = DataF
+0003d590: 7261 6d65 2829 0a20 2020 2020 2020 2020  rame().         
+0003d5a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d5b0: 2020 2066 6f72 206c 2069 6e20 7261 6e67     for l in rang
+0003d5c0: 6528 696e 7075 745f 6469 6374 2e6e 5f64  e(input_dict.n_d
+0003d5d0: 6174 6173 6574 735b 6265 6861 7669 6f72  atasets[behavior
+0003d5e0: 5f70 6f6c 6963 795f 6e61 6d65 5d29 3a0a  _policy_name]):.
 0003d5f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d600: 2020 2020 2020 2020 666f 7220 6a2c 2065          for j, e
-0003d610: 7661 6c5f 706f 6c69 6379 2069 6e20 656e  val_policy in en
-0003d620: 756d 6572 6174 6528 696e 7075 745f 6469  umerate(input_di
-0003d630: 6374 5f30 2e6b 6579 7328 2929 3a0a 2020  ct_0.keys()):.  
-0003d640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d650: 2020 2020 2020 2020 2020 6466 203d 2044            df = D
-0003d660: 6174 6146 7261 6d65 2829 0a20 2020 2020  ataFrame().     
-0003d670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d680: 2020 2020 2020 2066 6f72 206c 2069 6e20         for l in 
-0003d690: 7261 6e67 6528 696e 7075 745f 6469 6374  range(input_dict
-0003d6a0: 2e6e 5f64 6174 6173 6574 735b 6265 6861  .n_datasets[beha
-0003d6b0: 7669 6f72 5f70 6f6c 6963 795f 6e61 6d65  vior_policy_name
-0003d6c0: 5d29 3a0a 2020 2020 2020 2020 2020 2020  ]):.            
+0003d600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d610: 6466 5b22 7873 6361 6c65 225d 203d 2072  df["xscale"] = r
+0003d620: 6577 6172 645f 7363 616c 650a 2020 2020  eward_scale.    
+0003d630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d640: 2020 2020 2020 2020 2020 2020 6466 5b6c              df[l
+0003d650: 5d20 3d20 6364 665f 6469 6374 5b65 7661  ] = cdf_dict[eva
+0003d660: 6c5f 706f 6c69 6379 5d5b 6573 7469 6d61  l_policy][estima
+0003d670: 746f 725d 5b6c 5d0a 0a20 2020 2020 2020  tor][l]..       
+0003d680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d690: 2020 2020 2064 6620 3d20 7064 2e6d 656c       df = pd.mel
+0003d6a0: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
+0003d6b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d6c0: 2020 2064 662c 0a20 2020 2020 2020 2020     df,.         
 0003d6d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d6e0: 2020 2020 6466 5b22 7873 6361 6c65 225d      df["xscale"]
-0003d6f0: 203d 2072 6577 6172 645f 7363 616c 650a   = reward_scale.
+0003d6e0: 2020 2020 2020 2069 645f 7661 7273 3d5b         id_vars=[
+0003d6f0: 2278 7363 616c 6522 5d2c 0a20 2020 2020  "xscale"],.     
 0003d700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d720: 6466 5b6c 5d20 3d20 6364 665f 6469 6374  df[l] = cdf_dict
-0003d730: 5b65 7661 6c5f 706f 6c69 6379 5d5b 6573  [eval_policy][es
-0003d740: 7469 6d61 746f 725d 5b6c 5d0a 0a20 2020  timator][l]..   
-0003d750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d760: 2020 2020 2020 2020 2064 6620 3d20 7064           df = pd
-0003d770: 2e6d 656c 7428 0a20 2020 2020 2020 2020  .melt(.         
-0003d780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d790: 2020 2020 2020 2064 662c 0a20 2020 2020         df,.     
-0003d7a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d7b0: 2020 2020 2020 2020 2020 2069 645f 7661             id_va
-0003d7c0: 7273 3d5b 2278 7363 616c 6522 5d2c 0a20  rs=["xscale"],. 
-0003d7d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d7e0: 2020 2020 2020 2020 2020 2020 2020 2076                 v
-0003d7f0: 6172 5f6e 616d 653d 2264 6174 6173 6574  ar_name="dataset
-0003d800: 5f69 6422 2c0a 2020 2020 2020 2020 2020  _id",.          
+0003d710: 2020 2020 2020 2020 2020 2076 6172 5f6e             var_n
+0003d720: 616d 653d 2264 6174 6173 6574 5f69 6422  ame="dataset_id"
+0003d730: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0003d740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d750: 2020 7661 6c75 655f 6e61 6d65 3d22 6364    value_name="cd
+0003d760: 6622 2c0a 2020 2020 2020 2020 2020 2020  f",.            
+0003d770: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d780: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0003d790: 2020 2020 2020 2020 2020 2020 2020 736e                sn
+0003d7a0: 732e 6c69 6e65 706c 6f74 280a 2020 2020  s.lineplot(.    
+0003d7b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d7c0: 2020 2020 2020 2020 2020 2020 6461 7461              data
+0003d7d0: 3d64 662c 0a20 2020 2020 2020 2020 2020  =df,.           
+0003d7e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d7f0: 2020 2020 2078 3d22 7873 6361 6c65 222c       x="xscale",
+0003d800: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 0003d810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d820: 2020 2020 2020 7661 6c75 655f 6e61 6d65        value_name
-0003d830: 3d22 6364 6622 2c0a 2020 2020 2020 2020  ="cdf",.        
-0003d840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d850: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+0003d820: 2079 3d22 6364 6622 2c0a 2020 2020 2020   y="cdf",.      
+0003d830: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d840: 2020 2020 2020 2020 2020 6178 3d61 7865            ax=axe
+0003d850: 735b 695d 2c0a 2020 2020 2020 2020 2020  s[i],.          
 0003d860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d870: 2020 736e 732e 6c69 6e65 706c 6f74 280a    sns.lineplot(.
-0003d880: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d8a0: 6461 7461 3d64 662c 0a20 2020 2020 2020  data=df,.       
-0003d8b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d8c0: 2020 2020 2020 2020 2078 3d22 7873 6361           x="xsca
-0003d8d0: 6c65 222c 0a20 2020 2020 2020 2020 2020  le",.           
-0003d8e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d8f0: 2020 2020 2079 3d22 6364 6622 2c0a 2020       y="cdf",.  
-0003d900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d910: 2020 2020 2020 2020 2020 2020 2020 6178                ax
-0003d920: 3d61 7865 735b 695d 2c0a 2020 2020 2020  =axes[i],.      
-0003d930: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d940: 2020 2020 2020 2020 2020 7061 6c65 7474            palett
-0003d950: 653d 5b63 6f6c 6f72 5b6a 2025 206e 5f63  e=[color[j % n_c
-0003d960: 6f6c 6f72 735d 5d2c 0a20 2020 2020 2020  olors]],.       
-0003d970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d980: 2020 2020 2020 2020 206c 6162 656c 3d65           label=e
-0003d990: 7661 6c5f 706f 6c69 6379 2c0a 2020 2020  val_policy,.    
-0003d9a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d9b0: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
-0003d9c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003d9d0: 2020 2061 7865 735b 695d 2e73 6574 5f74     axes[i].set_t
-0003d9e0: 6974 6c65 2865 7374 696d 6174 6f72 290a  itle(estimator).
-0003d9f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003da00: 2020 2020 2020 2020 6178 6573 5b69 5d2e          axes[i].
-0003da10: 7365 745f 786c 6162 656c 2822 7472 616a  set_xlabel("traj
-0003da20: 6563 746f 7279 2d77 6973 6520 7265 7761  ectory-wise rewa
-0003da30: 7264 2229 0a20 2020 2020 2020 2020 2020  rd").           
-0003da40: 2020 2020 2020 2020 2020 2020 2061 7865               axe
-0003da50: 735b 695d 2e73 6574 5f79 6c61 6265 6c28  s[i].set_ylabel(
-0003da60: 2263 756d 756c 6174 6976 6520 7072 6f62  "cumulative prob
-0003da70: 6162 696c 6974 7922 290a 2020 2020 2020  ability").      
-0003da80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003da90: 2020 6966 206c 6567 656e 643a 0a20 2020    if legend:.   
+0003d870: 2020 2020 2020 7061 6c65 7474 653d 5b63        palette=[c
+0003d880: 6f6c 6f72 5b6a 2025 206e 5f63 6f6c 6f72  olor[j % n_color
+0003d890: 735d 5d2c 0a20 2020 2020 2020 2020 2020  s]],.           
+0003d8a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d8b0: 2020 2020 206c 6162 656c 3d65 7661 6c5f       label=eval_
+0003d8c0: 706f 6c69 6379 2c0a 2020 2020 2020 2020  policy,.        
+0003d8d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d8e0: 2020 2020 290a 0a20 2020 2020 2020 2020      )..         
+0003d8f0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+0003d900: 7865 735b 695d 2e73 6574 5f74 6974 6c65  xes[i].set_title
+0003d910: 2865 7374 696d 6174 6f72 290a 2020 2020  (estimator).    
+0003d920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d930: 2020 2020 6178 6573 5b69 5d2e 7365 745f      axes[i].set_
+0003d940: 786c 6162 656c 2822 7472 616a 6563 746f  xlabel("trajecto
+0003d950: 7279 2d77 6973 6520 7265 7761 7264 2229  ry-wise reward")
+0003d960: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003d970: 2020 2020 2020 2020 2061 7865 735b 695d           axes[i]
+0003d980: 2e73 6574 5f79 6c61 6265 6c28 2263 756d  .set_ylabel("cum
+0003d990: 756c 6174 6976 6520 7072 6f62 6162 696c  ulative probabil
+0003d9a0: 6974 7922 290a 2020 2020 2020 2020 2020  ity").          
+0003d9b0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0003d9c0: 206c 6567 656e 643a 0a20 2020 2020 2020   legend:.       
+0003d9d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d9e0: 2020 2020 2061 7865 735b 695d 2e6c 6567       axes[i].leg
+0003d9f0: 656e 6428 290a 0a20 2020 2020 2020 2020  end()..         
+0003da00: 2020 2020 2020 2020 2020 2069 6620 7669             if vi
+0003da10: 7375 616c 697a 655f 6f6e 5f70 6f6c 6963  sualize_on_polic
+0003da20: 793a 0a20 2020 2020 2020 2020 2020 2020  y:.             
+0003da30: 2020 2020 2020 2020 2020 2066 6f72 206a             for j
+0003da40: 2c20 6576 616c 5f70 6f6c 6963 7920 696e  , eval_policy in
+0003da50: 2065 6e75 6d65 7261 7465 2869 6e70 7574   enumerate(input
+0003da60: 5f64 6963 745f 302e 6b65 7973 2829 293a  _dict_0.keys()):
+0003da70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003da80: 2020 2020 2020 2020 2020 2020 2061 7865               axe
+0003da90: 735b 6920 2b20 315d 2e70 6c6f 7428 0a20  s[i + 1].plot(. 
 0003daa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003dab0: 2020 2020 2020 2020 2061 7865 735b 695d           axes[i]
-0003dac0: 2e6c 6567 656e 6428 290a 0a20 2020 2020  .legend()..     
-0003dad0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0003dae0: 6620 7669 7375 616c 697a 655f 6f6e 5f70  f visualize_on_p
-0003daf0: 6f6c 6963 793a 0a20 2020 2020 2020 2020  olicy:.         
-0003db00: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0003db10: 6f72 206a 2c20 6576 616c 5f70 6f6c 6963  or j, eval_polic
-0003db20: 7920 696e 2065 6e75 6d65 7261 7465 2869  y in enumerate(i
-0003db30: 6e70 7574 5f64 6963 745f 302e 6b65 7973  nput_dict_0.keys
-0003db40: 2829 293a 0a20 2020 2020 2020 2020 2020  ()):.           
+0003dab0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+0003dac0: 6577 6172 645f 7363 616c 652c 0a20 2020  eward_scale,.   
+0003dad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003dae0: 2020 2020 2020 2020 2020 2020 2063 6466               cdf
+0003daf0: 5f64 6963 745b 6576 616c 5f70 6f6c 6963  _dict[eval_polic
+0003db00: 795d 5b22 6f6e 5f70 6f6c 6963 7922 5d2c  y]["on_policy"],
+0003db10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003db20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003db30: 206c 6162 656c 3d65 7661 6c5f 706f 6c69   label=eval_poli
+0003db40: 6379 2c0a 2020 2020 2020 2020 2020 2020  cy,.            
 0003db50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003db60: 2061 7865 735b 6920 2b20 315d 2e70 6c6f   axes[i + 1].plo
-0003db70: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
-0003db80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003db90: 2020 2072 6577 6172 645f 7363 616c 652c     reward_scale,
-0003dba0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003dbb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003dbc0: 2063 6466 5f64 6963 745b 6576 616c 5f70   cdf_dict[eval_p
-0003dbd0: 6f6c 6963 795d 5b22 6f6e 5f70 6f6c 6963  olicy]["on_polic
-0003dbe0: 7922 5d2c 0a20 2020 2020 2020 2020 2020  y"],.           
-0003dbf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003dc00: 2020 2020 206c 6162 656c 3d65 7661 6c5f       label=eval_
-0003dc10: 706f 6c69 6379 2c0a 2020 2020 2020 2020  policy,.        
-0003dc20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003dc30: 2020 2020 290a 0a20 2020 2020 2020 2020      )..         
-0003dc40: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-0003dc50: 7865 735b 6920 2b20 315d 2e73 6574 5f74  xes[i + 1].set_t
-0003dc60: 6974 6c65 2822 6f6e 5f70 6f6c 6963 7922  itle("on_policy"
-0003dc70: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0003dc80: 2020 2020 2020 2020 2020 6178 6573 5b69            axes[i
-0003dc90: 202b 2031 5d2e 7365 745f 786c 6162 656c   + 1].set_xlabel
-0003dca0: 2822 7472 616a 6563 746f 7279 2d77 6973  ("trajectory-wis
-0003dcb0: 6520 7265 7761 7264 2229 0a20 2020 2020  e reward").     
-0003dcc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003dcd0: 2020 2061 7865 735b 6920 2b20 315d 2e73     axes[i + 1].s
-0003dce0: 6574 5f79 6c61 6265 6c28 2263 756d 756c  et_ylabel("cumul
-0003dcf0: 6174 6976 6520 7072 6f62 6162 696c 6974  ative probabilit
-0003dd00: 7922 290a 2020 2020 2020 2020 2020 2020  y").            
-0003dd10: 2020 2020 2020 2020 2020 2020 6966 206c              if l
-0003dd20: 6567 656e 643a 0a20 2020 2020 2020 2020  egend:.         
-0003dd30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003dd40: 2020 2061 7865 735b 6920 2b20 315d 2e6c     axes[i + 1].l
-0003dd50: 6567 656e 6428 290a 0a20 2020 2020 2020  egend()..       
-0003dd60: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-0003dd70: 6c65 6765 6e64 3a0a 2020 2020 2020 2020  legend:.        
-0003dd80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003dd90: 6861 6e64 6c65 732c 206c 6162 656c 7320  handles, labels 
-0003dda0: 3d20 6178 6573 5b30 5d2e 6765 745f 6c65  = axes[0].get_le
-0003ddb0: 6765 6e64 5f68 616e 646c 6573 5f6c 6162  gend_handles_lab
-0003ddc0: 656c 7328 290a 2020 2020 2020 2020 2020  els().          
-0003ddd0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-0003dde0: 6e5f 636f 6c73 2073 686f 7773 2065 7272  n_cols shows err
-0003ddf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003de00: 2020 2020 2020 2020 2023 2066 6967 2e6c           # fig.l
-0003de10: 6567 656e 6428 6861 6e64 6c65 732c 206c  egend(handles, l
-0003de20: 6162 656c 732c 206c 6f63 3d27 7570 7065  abels, loc='uppe
-0003de30: 7220 6365 6e74 6572 272c 2062 626f 785f  r center', bbox_
-0003de40: 746f 5f61 6e63 686f 723d 2830 2e35 2c20  to_anchor=(0.5, 
-0003de50: 2d30 2e31 292c 206e 5f63 6f6c 733d 6d69  -0.1), n_cols=mi
-0003de60: 6e28 6c65 6e28 6c61 6265 6c73 292c 2036  n(len(labels), 6
-0003de70: 2929 0a0a 2020 2020 2020 2020 2020 2020  ))..            
-0003de80: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-0003de90: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-0003dea0: 7220 692c 2065 7374 696d 6174 6f72 2069  r i, estimator i
-0003deb0: 6e20 656e 756d 6572 6174 6528 636f 6d70  n enumerate(comp
-0003dec0: 6172 6564 5f65 7374 696d 6174 6f72 7329  ared_estimators)
+0003db60: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
+0003db70: 2020 2020 2020 2020 2020 2061 7865 735b             axes[
+0003db80: 6920 2b20 315d 2e73 6574 5f74 6974 6c65  i + 1].set_title
+0003db90: 2822 6f6e 5f70 6f6c 6963 7922 290a 2020  ("on_policy").  
+0003dba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003dbb0: 2020 2020 2020 6178 6573 5b69 202b 2031        axes[i + 1
+0003dbc0: 5d2e 7365 745f 786c 6162 656c 2822 7472  ].set_xlabel("tr
+0003dbd0: 616a 6563 746f 7279 2d77 6973 6520 7265  ajectory-wise re
+0003dbe0: 7761 7264 2229 0a20 2020 2020 2020 2020  ward").         
+0003dbf0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+0003dc00: 7865 735b 6920 2b20 315d 2e73 6574 5f79  xes[i + 1].set_y
+0003dc10: 6c61 6265 6c28 2263 756d 756c 6174 6976  label("cumulativ
+0003dc20: 6520 7072 6f62 6162 696c 6974 7922 290a  e probability").
+0003dc30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003dc40: 2020 2020 2020 2020 6966 206c 6567 656e          if legen
+0003dc50: 643a 0a20 2020 2020 2020 2020 2020 2020  d:.             
+0003dc60: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+0003dc70: 7865 735b 6920 2b20 315d 2e6c 6567 656e  xes[i + 1].legen
+0003dc80: 6428 290a 0a20 2020 2020 2020 2020 2020  d()..           
+0003dc90: 2020 2020 2020 2020 2069 6620 6c65 6765           if lege
+0003dca0: 6e64 3a0a 2020 2020 2020 2020 2020 2020  nd:.            
+0003dcb0: 2020 2020 2020 2020 2020 2020 6861 6e64              hand
+0003dcc0: 6c65 732c 206c 6162 656c 7320 3d20 6178  les, labels = ax
+0003dcd0: 6573 5b30 5d2e 6765 745f 6c65 6765 6e64  es[0].get_legend
+0003dce0: 5f68 616e 646c 6573 5f6c 6162 656c 7328  _handles_labels(
+0003dcf0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0003dd00: 2020 2020 2020 2020 2020 2320 6e5f 636f            # n_co
+0003dd10: 6c73 2073 686f 7773 2065 7272 0a20 2020  ls shows err.   
+0003dd20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003dd30: 2020 2020 2023 2066 6967 2e6c 6567 656e       # fig.legen
+0003dd40: 6428 6861 6e64 6c65 732c 206c 6162 656c  d(handles, label
+0003dd50: 732c 206c 6f63 3d27 7570 7065 7220 6365  s, loc='upper ce
+0003dd60: 6e74 6572 272c 2062 626f 785f 746f 5f61  nter', bbox_to_a
+0003dd70: 6e63 686f 723d 2830 2e35 2c20 2d30 2e31  nchor=(0.5, -0.1
+0003dd80: 292c 206e 5f63 6f6c 733d 6d69 6e28 6c65  ), n_cols=min(le
+0003dd90: 6e28 6c61 6265 6c73 292c 2036 2929 0a0a  n(labels), 6))..
+0003dda0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ddb0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0003ddc0: 2020 2020 2020 2020 2020 666f 7220 692c            for i,
+0003ddd0: 2065 7374 696d 6174 6f72 2069 6e20 656e   estimator in en
+0003dde0: 756d 6572 6174 6528 636f 6d70 6172 6564  umerate(compared
+0003ddf0: 5f65 7374 696d 6174 6f72 7329 3a0a 2020  _estimators):.  
+0003de00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003de10: 2020 2020 2020 666f 7220 6a2c 2065 7661        for j, eva
+0003de20: 6c5f 706f 6c69 6379 2069 6e20 656e 756d  l_policy in enum
+0003de30: 6572 6174 6528 696e 7075 745f 6469 6374  erate(input_dict
+0003de40: 5f30 2e6b 6579 7328 2929 3a0a 2020 2020  _0.keys()):.    
+0003de50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003de60: 2020 2020 2020 2020 6466 203d 2044 6174          df = Dat
+0003de70: 6146 7261 6d65 2829 0a20 2020 2020 2020  aFrame().       
+0003de80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003de90: 2020 2020 2066 6f72 206c 2069 6e20 7261       for l in ra
+0003dea0: 6e67 6528 696e 7075 745f 6469 6374 2e6e  nge(input_dict.n
+0003deb0: 5f64 6174 6173 6574 735b 6265 6861 7669  _datasets[behavi
+0003dec0: 6f72 5f70 6f6c 6963 795f 6e61 6d65 5d29  or_policy_name])
 0003ded0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0003dee0: 2020 2020 2020 2020 2020 666f 7220 6a2c            for j,
-0003def0: 2065 7661 6c5f 706f 6c69 6379 2069 6e20   eval_policy in 
-0003df00: 656e 756d 6572 6174 6528 696e 7075 745f  enumerate(input_
-0003df10: 6469 6374 5f30 2e6b 6579 7328 2929 3a0a  dict_0.keys()):.
-0003df20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003df30: 2020 2020 2020 2020 2020 2020 6466 203d              df =
-0003df40: 2044 6174 6146 7261 6d65 2829 0a20 2020   DataFrame().   
-0003df50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003df60: 2020 2020 2020 2020 2066 6f72 206c 2069           for l i
-0003df70: 6e20 7261 6e67 6528 696e 7075 745f 6469  n range(input_di
-0003df80: 6374 2e6e 5f64 6174 6173 6574 735b 6265  ct.n_datasets[be
-0003df90: 6861 7669 6f72 5f70 6f6c 6963 795f 6e61  havior_policy_na
-0003dfa0: 6d65 5d29 3a0a 2020 2020 2020 2020 2020  me]):.          
+0003dee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003def0: 2020 6466 5b22 7873 6361 6c65 225d 203d    df["xscale"] =
+0003df00: 2072 6577 6172 645f 7363 616c 650a 2020   reward_scale.  
+0003df10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003df20: 2020 2020 2020 2020 2020 2020 2020 6466                df
+0003df30: 5b6c 5d20 3d20 6364 665f 6469 6374 5b65  [l] = cdf_dict[e
+0003df40: 7661 6c5f 706f 6c69 6379 5d5b 6573 7469  val_policy][esti
+0003df50: 6d61 746f 725d 5b6c 5d0a 0a20 2020 2020  mator][l]..     
+0003df60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003df70: 2020 2020 2020 2064 6620 3d20 7064 2e6d         df = pd.m
+0003df80: 656c 7428 0a20 2020 2020 2020 2020 2020  elt(.           
+0003df90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003dfa0: 2020 2020 2064 662c 0a20 2020 2020 2020       df,.       
 0003dfb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003dfc0: 2020 2020 2020 6466 5b22 7873 6361 6c65        df["xscale
-0003dfd0: 225d 203d 2072 6577 6172 645f 7363 616c  "] = reward_scal
-0003dfe0: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
-0003dff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e000: 2020 6466 5b6c 5d20 3d20 6364 665f 6469    df[l] = cdf_di
-0003e010: 6374 5b65 7661 6c5f 706f 6c69 6379 5d5b  ct[eval_policy][
-0003e020: 6573 7469 6d61 746f 725d 5b6c 5d0a 0a20  estimator][l].. 
-0003e030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e040: 2020 2020 2020 2020 2020 2064 6620 3d20             df = 
-0003e050: 7064 2e6d 656c 7428 0a20 2020 2020 2020  pd.melt(.       
-0003e060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e070: 2020 2020 2020 2020 2064 662c 0a20 2020           df,.   
-0003e080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e090: 2020 2020 2020 2020 2020 2020 2069 645f               id_
-0003e0a0: 7661 7273 3d5b 2278 7363 616c 6522 5d2c  vars=["xscale"],
-0003e0b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003dfc0: 2020 2020 2020 2020 2069 645f 7661 7273           id_vars
+0003dfd0: 3d5b 2278 7363 616c 6522 5d2c 0a20 2020  =["xscale"],.   
+0003dfe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003dff0: 2020 2020 2020 2020 2020 2020 2076 6172               var
+0003e000: 5f6e 616d 653d 2264 6174 6173 6574 5f69  _name="dataset_i
+0003e010: 6422 2c0a 2020 2020 2020 2020 2020 2020  d",.            
+0003e020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e030: 2020 2020 7661 6c75 655f 6e61 6d65 3d22      value_name="
+0003e040: 6364 6622 2c0a 2020 2020 2020 2020 2020  cdf",.          
+0003e050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e060: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+0003e070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e080: 736e 732e 6c69 6e65 706c 6f74 280a 2020  sns.lineplot(.  
+0003e090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e0a0: 2020 2020 2020 2020 2020 2020 2020 6461                da
+0003e0b0: 7461 3d64 662c 0a20 2020 2020 2020 2020  ta=df,.         
 0003e0c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e0d0: 2076 6172 5f6e 616d 653d 2264 6174 6173   var_name="datas
-0003e0e0: 6574 5f69 6422 2c0a 2020 2020 2020 2020  et_id",.        
+0003e0d0: 2020 2020 2020 2078 3d22 7873 6361 6c65         x="xscale
+0003e0e0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
 0003e0f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e100: 2020 2020 2020 2020 7661 6c75 655f 6e61          value_na
-0003e110: 6d65 3d22 6364 6622 2c0a 2020 2020 2020  me="cdf",.      
-0003e120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e130: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-0003e140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e150: 2020 2020 736e 732e 6c69 6e65 706c 6f74      sns.lineplot
-0003e160: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0003e170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e180: 2020 6461 7461 3d64 662c 0a20 2020 2020    data=df,.     
+0003e100: 2020 2079 3d22 6364 6622 2c0a 2020 2020     y="cdf",.    
+0003e110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e120: 2020 2020 2020 2020 2020 2020 6178 3d61              ax=a
+0003e130: 7865 735b 6920 2f2f 206e 5f63 6f6c 732c  xes[i // n_cols,
+0003e140: 2069 2025 206e 5f63 6f6c 735d 2c0a 2020   i % n_cols],.  
+0003e150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e160: 2020 2020 2020 2020 2020 2020 2020 7061                pa
+0003e170: 6c65 7474 653d 5b63 6f6c 6f72 5b6a 2025  lette=[color[j %
+0003e180: 206e 5f63 6f6c 6f72 735d 5d2c 0a20 2020   n_colors]],.   
 0003e190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e1a0: 2020 2020 2020 2020 2020 2078 3d22 7873             x="xs
-0003e1b0: 6361 6c65 222c 0a20 2020 2020 2020 2020  cale",.         
+0003e1a0: 2020 2020 2020 2020 2020 2020 206c 6162               lab
+0003e1b0: 656c 3d65 7661 6c5f 706f 6c69 6379 2c0a  el=eval_policy,.
 0003e1c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e1d0: 2020 2020 2020 2079 3d22 6364 6622 2c0a         y="cdf",.
+0003e1d0: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
 0003e1e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e1f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e200: 6178 3d61 7865 735b 6920 2f2f 206e 5f63  ax=axes[i // n_c
-0003e210: 6f6c 732c 2069 2025 206e 5f63 6f6c 735d  ols, i % n_cols]
-0003e220: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0003e1f0: 2020 2020 2020 2061 7865 735b 6920 2f2f         axes[i //
+0003e200: 206e 5f63 6f6c 732c 2069 2025 206e 5f63   n_cols, i % n_c
+0003e210: 6f6c 735d 2e73 6574 5f74 6974 6c65 2865  ols].set_title(e
+0003e220: 7374 696d 6174 6f72 290a 2020 2020 2020  stimator).      
 0003e230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e240: 2020 7061 6c65 7474 653d 5b63 6f6c 6f72    palette=[color
-0003e250: 5b6a 2025 206e 5f63 6f6c 6f72 735d 5d2c  [j % n_colors]],
-0003e260: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003e240: 2020 6178 6573 5b69 202f 2f20 6e5f 636f    axes[i // n_co
+0003e250: 6c73 2c20 6920 2520 6e5f 636f 6c73 5d2e  ls, i % n_cols].
+0003e260: 7365 745f 786c 6162 656c 280a 2020 2020  set_xlabel(.    
 0003e270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e280: 206c 6162 656c 3d65 7661 6c5f 706f 6c69   label=eval_poli
-0003e290: 6379 2c0a 2020 2020 2020 2020 2020 2020  cy,.            
-0003e2a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e2b0: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
-0003e2c0: 2020 2020 2020 2020 2020 2061 7865 735b             axes[
-0003e2d0: 6920 2f2f 206e 5f63 6f6c 732c 2069 2025  i // n_cols, i %
-0003e2e0: 206e 5f63 6f6c 735d 2e73 6574 5f74 6974   n_cols].set_tit
-0003e2f0: 6c65 2865 7374 696d 6174 6f72 290a 2020  le(estimator).  
+0003e280: 2020 2020 2020 2020 2274 7261 6a65 6374          "traject
+0003e290: 6f72 792d 7769 7365 2072 6577 6172 6422  ory-wise reward"
+0003e2a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003e2b0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+0003e2c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e2d0: 2020 2061 7865 735b 6920 2f2f 206e 5f63     axes[i // n_c
+0003e2e0: 6f6c 732c 2069 2025 206e 5f63 6f6c 735d  ols, i % n_cols]
+0003e2f0: 2e73 6574 5f79 6c61 6265 6c28 0a20 2020  .set_ylabel(.   
 0003e300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e310: 2020 2020 2020 6178 6573 5b69 202f 2f20        axes[i // 
-0003e320: 6e5f 636f 6c73 2c20 6920 2520 6e5f 636f  n_cols, i % n_co
-0003e330: 6c73 5d2e 7365 745f 786c 6162 656c 280a  ls].set_xlabel(.
-0003e340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e350: 2020 2020 2020 2020 2020 2020 2274 7261              "tra
-0003e360: 6a65 6374 6f72 792d 7769 7365 2072 6577  jectory-wise rew
-0003e370: 6172 6422 0a20 2020 2020 2020 2020 2020  ard".           
-0003e380: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
-0003e390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e3a0: 2020 2020 2020 2061 7865 735b 6920 2f2f         axes[i //
-0003e3b0: 206e 5f63 6f6c 732c 2069 2025 206e 5f63   n_cols, i % n_c
-0003e3c0: 6f6c 735d 2e73 6574 5f79 6c61 6265 6c28  ols].set_ylabel(
-0003e3d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003e3e0: 2020 2020 2020 2020 2020 2020 2022 6375               "cu
-0003e3f0: 6d75 6c61 7469 7665 2070 726f 6261 6269  mulative probabi
-0003e400: 6c69 7479 220a 2020 2020 2020 2020 2020  lity".          
-0003e410: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-0003e420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e430: 2020 2020 2020 2020 6966 206c 6567 656e          if legen
-0003e440: 643a 0a20 2020 2020 2020 2020 2020 2020  d:.             
-0003e450: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-0003e460: 7865 735b 6920 2f2f 206e 5f63 6f6c 732c  xes[i // n_cols,
-0003e470: 2069 2025 206e 5f63 6f6c 735d 2e6c 6567   i % n_cols].leg
-0003e480: 656e 6428 290a 0a20 2020 2020 2020 2020  end()..         
-0003e490: 2020 2020 2020 2020 2020 2069 6620 7669             if vi
-0003e4a0: 7375 616c 697a 655f 6f6e 5f70 6f6c 6963  sualize_on_polic
-0003e4b0: 793a 0a20 2020 2020 2020 2020 2020 2020  y:.             
-0003e4c0: 2020 2020 2020 2020 2020 2066 6f72 206a             for j
-0003e4d0: 2c20 6576 616c 5f70 6f6c 6963 7920 696e  , eval_policy in
-0003e4e0: 2065 6e75 6d65 7261 7465 2869 6e70 7574   enumerate(input
-0003e4f0: 5f64 6963 745f 302e 6b65 7973 2829 293a  _dict_0.keys()):
-0003e500: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003e510: 2020 2020 2020 2020 2020 2020 2061 7865               axe
-0003e520: 735b 2869 202b 2031 2920 2f2f 206e 5f63  s[(i + 1) // n_c
-0003e530: 6f6c 732c 2028 6920 2b20 3129 2025 206e  ols, (i + 1) % n
-0003e540: 5f63 6f6c 735d 2e70 6c6f 7428 0a20 2020  _cols].plot(.   
-0003e550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e560: 2020 2020 2020 2020 2020 2020 2072 6577               rew
-0003e570: 6172 645f 7363 616c 652c 0a20 2020 2020  ard_scale,.     
-0003e580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e590: 2020 2020 2020 2020 2020 2063 6466 5f64             cdf_d
-0003e5a0: 6963 745b 6576 616c 5f70 6f6c 6963 795d  ict[eval_policy]
-0003e5b0: 5b22 6f6e 5f70 6f6c 6963 7922 5d2c 0a20  ["on_policy"],. 
-0003e5c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e5d0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-0003e5e0: 6162 656c 3d65 7661 6c5f 706f 6c69 6379  abel=eval_policy
-0003e5f0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0003e600: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-0003e610: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003e620: 2020 2020 2020 2020 2061 7865 735b 2869           axes[(i
-0003e630: 202b 2031 2920 2f2f 206e 5f63 6f6c 732c   + 1) // n_cols,
-0003e640: 2028 6920 2b20 3129 2025 206e 5f63 6f6c   (i + 1) % n_col
-0003e650: 735d 2e73 6574 5f74 6974 6c65 2822 6f6e  s].set_title("on
-0003e660: 5f70 6f6c 6963 7922 290a 2020 2020 2020  _policy").      
-0003e670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e680: 2020 6178 6573 5b28 6920 2b20 3129 202f    axes[(i + 1) /
-0003e690: 2f20 6e5f 636f 6c73 2c20 2869 202b 2031  / n_cols, (i + 1
-0003e6a0: 2920 2520 6e5f 636f 6c73 5d2e 7365 745f  ) % n_cols].set_
-0003e6b0: 786c 6162 656c 280a 2020 2020 2020 2020  xlabel(.        
-0003e6c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e6d0: 2020 2020 2274 7261 6a65 6374 6f72 792d      "trajectory-
-0003e6e0: 7769 7365 2072 6577 6172 6422 0a20 2020  wise reward".   
-0003e6f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e700: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-0003e710: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-0003e720: 7865 735b 2869 202b 2031 2920 2f2f 206e  xes[(i + 1) // n
-0003e730: 5f63 6f6c 732c 2028 6920 2b20 3129 2025  _cols, (i + 1) %
-0003e740: 206e 5f63 6f6c 735d 2e73 6574 5f79 6c61   n_cols].set_yla
-0003e750: 6265 6c28 0a20 2020 2020 2020 2020 2020  bel(.           
-0003e760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e770: 2022 6375 6d75 6c61 7469 7665 2070 726f   "cumulative pro
-0003e780: 6261 6269 6c69 7479 220a 2020 2020 2020  bability".      
-0003e790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e7a0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-0003e7b0: 2020 2020 2020 2020 2020 2020 6966 206c              if l
-0003e7c0: 6567 656e 643a 0a20 2020 2020 2020 2020  egend:.         
-0003e7d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e7e0: 2020 2061 7865 735b 2869 202b 2031 2920     axes[(i + 1) 
-0003e7f0: 2f2f 206e 5f63 6f6c 732c 2028 6920 2b20  // n_cols, (i + 
-0003e800: 3129 2025 206e 5f63 6f6c 735d 2e6c 6567  1) % n_cols].leg
-0003e810: 656e 6428 290a 0a20 2020 2020 2020 2020  end()..         
-0003e820: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
-0003e830: 6765 6e64 3a0a 2020 2020 2020 2020 2020  gend:.          
-0003e840: 2020 2020 2020 2020 2020 2020 2020 6861                ha
-0003e850: 6e64 6c65 732c 206c 6162 656c 7320 3d20  ndles, labels = 
-0003e860: 6178 6573 5b30 2c20 305d 2e67 6574 5f6c  axes[0, 0].get_l
-0003e870: 6567 656e 645f 6861 6e64 6c65 735f 6c61  egend_handles_la
-0003e880: 6265 6c73 2829 0a20 2020 2020 2020 2020  bels().         
-0003e890: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-0003e8a0: 206e 5f63 6f6c 7320 7368 6f77 7320 6572   n_cols shows er
-0003e8b0: 720a 2020 2020 2020 2020 2020 2020 2020  r.              
-0003e8c0: 2020 2020 2020 2020 2020 2320 6669 672e            # fig.
-0003e8d0: 6c65 6765 6e64 2868 616e 646c 6573 2c20  legend(handles, 
-0003e8e0: 6c61 6265 6c73 2c20 6c6f 633d 2775 7070  labels, loc='upp
-0003e8f0: 6572 2063 656e 7465 7227 2c20 6262 6f78  er center', bbox
-0003e900: 5f74 6f5f 616e 6368 6f72 3d28 302e 352c  _to_anchor=(0.5,
-0003e910: 202d 302e 3129 2c20 6e5f 636f 6c73 3d6d   -0.1), n_cols=m
-0003e920: 696e 286c 656e 286c 6162 656c 7329 2c20  in(len(labels), 
-0003e930: 3629 290a 0a20 2020 2020 2020 2065 6c69  6))..        eli
-0003e940: 6620 706c 6f74 5f74 7970 6520 3d3d 2022  f plot_type == "
-0003e950: 6369 5f62 6568 6176 696f 725f 706f 6c69  ci_behavior_poli
-0003e960: 6379 223a 0a20 2020 2020 2020 2020 2020  cy":.           
-0003e970: 2069 6620 6875 6520 3d3d 2022 6573 7469   if hue == "esti
-0003e980: 6d61 746f 7222 3a0a 2020 2020 2020 2020  mator":.        
-0003e990: 2020 2020 2020 2020 6e5f 636f 6c73 203d          n_cols =
-0003e9a0: 206c 656e 2863 6f6d 7061 7265 645f 6573   len(compared_es
-0003e9b0: 7469 6d61 746f 7273 290a 2020 2020 2020  timators).      
-0003e9c0: 2020 2020 2020 2020 2020 6e5f 726f 7773            n_rows
-0003e9d0: 203d 206c 656e 2869 6e70 7574 5f64 6963   = len(input_dic
-0003e9e0: 745f 3029 0a0a 2020 2020 2020 2020 2020  t_0)..          
-0003e9f0: 2020 2020 2020 6669 672c 2061 7865 7320        fig, axes 
-0003ea00: 3d20 706c 742e 7375 6270 6c6f 7473 280a  = plt.subplots(.
-0003ea10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ea20: 2020 2020 6e72 6f77 733d 6e5f 726f 7773      nrows=n_rows
-0003ea30: 2c20 6e63 6f6c 733d 6e5f 636f 6c73 2c20  , ncols=n_cols, 
-0003ea40: 6669 6773 697a 653d 2836 202a 206e 5f63  figsize=(6 * n_c
-0003ea50: 6f6c 732c 2034 202a 206e 5f72 6f77 7329  ols, 4 * n_rows)
-0003ea60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003ea70: 2029 0a0a 2020 2020 2020 2020 2020 2020   )..            
-0003ea80: 2020 2020 666f 7220 692c 2065 7661 6c5f      for i, eval_
-0003ea90: 706f 6c69 6379 2069 6e20 656e 756d 6572  policy in enumer
-0003eaa0: 6174 6528 696e 7075 745f 6469 6374 5f30  ate(input_dict_0
-0003eab0: 2e6b 6579 7328 2929 3a0a 2020 2020 2020  .keys()):.      
-0003eac0: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-0003ead0: 7220 6a2c 2065 7374 696d 6174 6f72 2069  r j, estimator i
-0003eae0: 6e20 656e 756d 6572 6174 6528 636f 6d70  n enumerate(comp
-0003eaf0: 6172 6564 5f65 7374 696d 6174 6f72 7329  ared_estimators)
-0003eb00: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0003eb10: 2020 2020 2020 2020 2020 666f 7220 6c2c            for l,
-0003eb20: 2062 6568 6176 696f 725f 706f 6c69 6379   behavior_policy
-0003eb30: 2069 6e20 656e 756d 6572 6174 6528 0a20   in enumerate(. 
-0003eb40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003eb50: 2020 2020 2020 2020 2020 2069 6e70 7574             input
-0003eb60: 5f64 6963 742e 6265 6861 7669 6f72 5f70  _dict.behavior_p
-0003eb70: 6f6c 6963 795f 6e61 6d65 730a 2020 2020  olicy_names.    
-0003eb80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003eb90: 2020 2020 293a 0a20 2020 2020 2020 2020      ):.         
-0003eba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ebb0: 2020 206e 5f64 6174 6173 6574 7320 3d20     n_datasets = 
-0003ebc0: 696e 7075 745f 6469 6374 2e6e 5f64 6174  input_dict.n_dat
-0003ebd0: 6173 6574 735b 6265 6861 7669 6f72 5f70  asets[behavior_p
-0003ebe0: 6f6c 6963 795d 0a0a 2020 2020 2020 2020  olicy]..        
-0003ebf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ec00: 2020 2020 6466 203d 2044 6174 6146 7261      df = DataFra
-0003ec10: 6d65 2829 0a20 2020 2020 2020 2020 2020  me().           
+0003e310: 2020 2020 2020 2020 2022 6375 6d75 6c61           "cumula
+0003e320: 7469 7665 2070 726f 6261 6269 6c69 7479  tive probability
+0003e330: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+0003e340: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+0003e350: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e360: 2020 2020 6966 206c 6567 656e 643a 0a20      if legend:. 
+0003e370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e380: 2020 2020 2020 2020 2020 2061 7865 735b             axes[
+0003e390: 6920 2f2f 206e 5f63 6f6c 732c 2069 2025  i // n_cols, i %
+0003e3a0: 206e 5f63 6f6c 735d 2e6c 6567 656e 6428   n_cols].legend(
+0003e3b0: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
+0003e3c0: 2020 2020 2020 2069 6620 7669 7375 616c         if visual
+0003e3d0: 697a 655f 6f6e 5f70 6f6c 6963 793a 0a20  ize_on_policy:. 
+0003e3e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e3f0: 2020 2020 2020 2066 6f72 206a 2c20 6576         for j, ev
+0003e400: 616c 5f70 6f6c 6963 7920 696e 2065 6e75  al_policy in enu
+0003e410: 6d65 7261 7465 2869 6e70 7574 5f64 6963  merate(input_dic
+0003e420: 745f 302e 6b65 7973 2829 293a 0a20 2020  t_0.keys()):.   
+0003e430: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e440: 2020 2020 2020 2020 2061 7865 735b 2869           axes[(i
+0003e450: 202b 2031 2920 2f2f 206e 5f63 6f6c 732c   + 1) // n_cols,
+0003e460: 2028 6920 2b20 3129 2025 206e 5f63 6f6c   (i + 1) % n_col
+0003e470: 735d 2e70 6c6f 7428 0a20 2020 2020 2020  s].plot(.       
+0003e480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e490: 2020 2020 2020 2020 2072 6577 6172 645f           reward_
+0003e4a0: 7363 616c 652c 0a20 2020 2020 2020 2020  scale,.         
+0003e4b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e4c0: 2020 2020 2020 2063 6466 5f64 6963 745b         cdf_dict[
+0003e4d0: 6576 616c 5f70 6f6c 6963 795d 5b22 6f6e  eval_policy]["on
+0003e4e0: 5f70 6f6c 6963 7922 5d2c 0a20 2020 2020  _policy"],.     
+0003e4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e500: 2020 2020 2020 2020 2020 206c 6162 656c             label
+0003e510: 3d65 7661 6c5f 706f 6c69 6379 2c0a 2020  =eval_policy,.  
+0003e520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e530: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+0003e540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e550: 2020 2020 2061 7865 735b 2869 202b 2031       axes[(i + 1
+0003e560: 2920 2f2f 206e 5f63 6f6c 732c 2028 6920  ) // n_cols, (i 
+0003e570: 2b20 3129 2025 206e 5f63 6f6c 735d 2e73  + 1) % n_cols].s
+0003e580: 6574 5f74 6974 6c65 2822 6f6e 5f70 6f6c  et_title("on_pol
+0003e590: 6963 7922 290a 2020 2020 2020 2020 2020  icy").          
+0003e5a0: 2020 2020 2020 2020 2020 2020 2020 6178                ax
+0003e5b0: 6573 5b28 6920 2b20 3129 202f 2f20 6e5f  es[(i + 1) // n_
+0003e5c0: 636f 6c73 2c20 2869 202b 2031 2920 2520  cols, (i + 1) % 
+0003e5d0: 6e5f 636f 6c73 5d2e 7365 745f 786c 6162  n_cols].set_xlab
+0003e5e0: 656c 280a 2020 2020 2020 2020 2020 2020  el(.            
+0003e5f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e600: 2274 7261 6a65 6374 6f72 792d 7769 7365  "trajectory-wise
+0003e610: 2072 6577 6172 6422 0a20 2020 2020 2020   reward".       
+0003e620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e630: 2029 0a20 2020 2020 2020 2020 2020 2020   ).             
+0003e640: 2020 2020 2020 2020 2020 2061 7865 735b             axes[
+0003e650: 2869 202b 2031 2920 2f2f 206e 5f63 6f6c  (i + 1) // n_col
+0003e660: 732c 2028 6920 2b20 3129 2025 206e 5f63  s, (i + 1) % n_c
+0003e670: 6f6c 735d 2e73 6574 5f79 6c61 6265 6c28  ols].set_ylabel(
+0003e680: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003e690: 2020 2020 2020 2020 2020 2020 2022 6375               "cu
+0003e6a0: 6d75 6c61 7469 7665 2070 726f 6261 6269  mulative probabi
+0003e6b0: 6c69 7479 220a 2020 2020 2020 2020 2020  lity".          
+0003e6c0: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+0003e6d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e6e0: 2020 2020 2020 2020 6966 206c 6567 656e          if legen
+0003e6f0: 643a 0a20 2020 2020 2020 2020 2020 2020  d:.             
+0003e700: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+0003e710: 7865 735b 2869 202b 2031 2920 2f2f 206e  xes[(i + 1) // n
+0003e720: 5f63 6f6c 732c 2028 6920 2b20 3129 2025  _cols, (i + 1) %
+0003e730: 206e 5f63 6f6c 735d 2e6c 6567 656e 6428   n_cols].legend(
+0003e740: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
+0003e750: 2020 2020 2020 2069 6620 6c65 6765 6e64         if legend
+0003e760: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0003e770: 2020 2020 2020 2020 2020 6861 6e64 6c65            handle
+0003e780: 732c 206c 6162 656c 7320 3d20 6178 6573  s, labels = axes
+0003e790: 5b30 2c20 305d 2e67 6574 5f6c 6567 656e  [0, 0].get_legen
+0003e7a0: 645f 6861 6e64 6c65 735f 6c61 6265 6c73  d_handles_labels
+0003e7b0: 2829 0a20 2020 2020 2020 2020 2020 2020  ().             
+0003e7c0: 2020 2020 2020 2020 2020 2023 206e 5f63             # n_c
+0003e7d0: 6f6c 7320 7368 6f77 7320 6572 720a 2020  ols shows err.  
+0003e7e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e7f0: 2020 2020 2020 2320 6669 672e 6c65 6765        # fig.lege
+0003e800: 6e64 2868 616e 646c 6573 2c20 6c61 6265  nd(handles, labe
+0003e810: 6c73 2c20 6c6f 633d 2775 7070 6572 2063  ls, loc='upper c
+0003e820: 656e 7465 7227 2c20 6262 6f78 5f74 6f5f  enter', bbox_to_
+0003e830: 616e 6368 6f72 3d28 302e 352c 202d 302e  anchor=(0.5, -0.
+0003e840: 3129 2c20 6e5f 636f 6c73 3d6d 696e 286c  1), n_cols=min(l
+0003e850: 656e 286c 6162 656c 7329 2c20 3629 290a  en(labels), 6)).
+0003e860: 0a20 2020 2020 2020 2065 6c69 6620 706c  .        elif pl
+0003e870: 6f74 5f74 7970 6520 3d3d 2022 6369 5f62  ot_type == "ci_b
+0003e880: 6568 6176 696f 725f 706f 6c69 6379 223a  ehavior_policy":
+0003e890: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0003e8a0: 6875 6520 3d3d 2022 6573 7469 6d61 746f  hue == "estimato
+0003e8b0: 7222 3a0a 2020 2020 2020 2020 2020 2020  r":.            
+0003e8c0: 2020 2020 6e5f 636f 6c73 203d 206c 656e      n_cols = len
+0003e8d0: 2863 6f6d 7061 7265 645f 6573 7469 6d61  (compared_estima
+0003e8e0: 746f 7273 290a 2020 2020 2020 2020 2020  tors).          
+0003e8f0: 2020 2020 2020 6e5f 726f 7773 203d 206c        n_rows = l
+0003e900: 656e 2869 6e70 7574 5f64 6963 745f 3029  en(input_dict_0)
+0003e910: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0003e920: 2020 6669 672c 2061 7865 7320 3d20 706c    fig, axes = pl
+0003e930: 742e 7375 6270 6c6f 7473 280a 2020 2020  t.subplots(.    
+0003e940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e950: 6e72 6f77 733d 6e5f 726f 7773 2c20 6e63  nrows=n_rows, nc
+0003e960: 6f6c 733d 6e5f 636f 6c73 2c20 6669 6773  ols=n_cols, figs
+0003e970: 697a 653d 2836 202a 206e 5f63 6f6c 732c  ize=(6 * n_cols,
+0003e980: 2034 202a 206e 5f72 6f77 7329 0a20 2020   4 * n_rows).   
+0003e990: 2020 2020 2020 2020 2020 2020 2029 0a0a               )..
+0003e9a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e9b0: 666f 7220 692c 2065 7661 6c5f 706f 6c69  for i, eval_poli
+0003e9c0: 6379 2069 6e20 656e 756d 6572 6174 6528  cy in enumerate(
+0003e9d0: 696e 7075 745f 6469 6374 5f30 2e6b 6579  input_dict_0.key
+0003e9e0: 7328 2929 3a0a 2020 2020 2020 2020 2020  s()):.          
+0003e9f0: 2020 2020 2020 2020 2020 666f 7220 6a2c            for j,
+0003ea00: 2065 7374 696d 6174 6f72 2069 6e20 656e   estimator in en
+0003ea10: 756d 6572 6174 6528 636f 6d70 6172 6564  umerate(compared
+0003ea20: 5f65 7374 696d 6174 6f72 7329 3a0a 2020  _estimators):.  
+0003ea30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ea40: 2020 2020 2020 666f 7220 6c2c 2062 6568        for l, beh
+0003ea50: 6176 696f 725f 706f 6c69 6379 2069 6e20  avior_policy in 
+0003ea60: 656e 756d 6572 6174 6528 0a20 2020 2020  enumerate(.     
+0003ea70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ea80: 2020 2020 2020 2069 6e70 7574 5f64 6963         input_dic
+0003ea90: 742e 6265 6861 7669 6f72 5f70 6f6c 6963  t.behavior_polic
+0003eaa0: 795f 6e61 6d65 730a 2020 2020 2020 2020  y_names.        
+0003eab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003eac0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+0003ead0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+0003eae0: 5f64 6174 6173 6574 7320 3d20 696e 7075  _datasets = inpu
+0003eaf0: 745f 6469 6374 2e6e 5f64 6174 6173 6574  t_dict.n_dataset
+0003eb00: 735b 6265 6861 7669 6f72 5f70 6f6c 6963  s[behavior_polic
+0003eb10: 795d 0a0a 2020 2020 2020 2020 2020 2020  y]..            
+0003eb20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003eb30: 6466 203d 2044 6174 6146 7261 6d65 2829  df = DataFrame()
+0003eb40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003eb50: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+0003eb60: 2064 6174 6173 6574 5f69 645f 2069 6e20   dataset_id_ in 
+0003eb70: 7261 6e67 6528 6e5f 6461 7461 7365 7473  range(n_datasets
+0003eb80: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+0003eb90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003eba0: 2020 2064 665b 2278 7363 616c 6522 5d20     df["xscale"] 
+0003ebb0: 3d20 7265 7761 7264 5f73 6361 6c65 0a20  = reward_scale. 
+0003ebc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ebd0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+0003ebe0: 665b 6461 7461 7365 745f 6964 5f5d 203d  f[dataset_id_] =
+0003ebf0: 2063 6466 5f64 6963 745b 6265 6861 7669   cdf_dict[behavi
+0003ec00: 6f72 5f70 6f6c 6963 795d 5b0a 2020 2020  or_policy][.    
+0003ec10: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0003ec20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ec30: 2066 6f72 2064 6174 6173 6574 5f69 645f   for dataset_id_
-0003ec40: 2069 6e20 7261 6e67 6528 6e5f 6461 7461   in range(n_data
-0003ec50: 7365 7473 293a 0a20 2020 2020 2020 2020  sets):.         
-0003ec60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ec70: 2020 2020 2020 2064 665b 2278 7363 616c         df["xscal
-0003ec80: 6522 5d20 3d20 7265 7761 7264 5f73 6361  e"] = reward_sca
-0003ec90: 6c65 0a20 2020 2020 2020 2020 2020 2020  le.             
-0003eca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ecb0: 2020 2064 665b 6461 7461 7365 745f 6964     df[dataset_id
-0003ecc0: 5f5d 203d 2063 6466 5f64 6963 745b 6265  _] = cdf_dict[be
-0003ecd0: 6861 7669 6f72 5f70 6f6c 6963 795d 5b0a  havior_policy][.
-0003ece0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ecf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ed00: 2020 2020 6576 616c 5f70 6f6c 6963 790a      eval_policy.
-0003ed10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ed20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ed30: 5d5b 6573 7469 6d61 746f 725d 5b64 6174  ][estimator][dat
-0003ed40: 6173 6574 5f69 645f 5d0a 0a20 2020 2020  aset_id_]..     
-0003ed50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ed60: 2020 2020 2020 2064 6620 3d20 7064 2e6d         df = pd.m
-0003ed70: 656c 7428 0a20 2020 2020 2020 2020 2020  elt(.           
-0003ed80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ed90: 2020 2020 2064 662c 0a20 2020 2020 2020       df,.       
-0003eda0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003edb0: 2020 2020 2020 2020 2069 645f 7661 7273           id_vars
-0003edc0: 3d5b 2278 7363 616c 6522 5d2c 0a20 2020  =["xscale"],.   
-0003edd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ede0: 2020 2020 2020 2020 2020 2020 2076 6172               var
-0003edf0: 5f6e 616d 653d 2264 6174 6173 6574 5f69  _name="dataset_i
-0003ee00: 6422 2c0a 2020 2020 2020 2020 2020 2020  d",.            
+0003ec30: 6576 616c 5f70 6f6c 6963 790a 2020 2020  eval_policy.    
+0003ec40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ec50: 2020 2020 2020 2020 2020 2020 5d5b 6573              ][es
+0003ec60: 7469 6d61 746f 725d 5b64 6174 6173 6574  timator][dataset
+0003ec70: 5f69 645f 5d0a 0a20 2020 2020 2020 2020  _id_]..         
+0003ec80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ec90: 2020 2064 6620 3d20 7064 2e6d 656c 7428     df = pd.melt(
+0003eca0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003ecb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ecc0: 2064 662c 0a20 2020 2020 2020 2020 2020   df,.           
+0003ecd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ece0: 2020 2020 2069 645f 7661 7273 3d5b 2278       id_vars=["x
+0003ecf0: 7363 616c 6522 5d2c 0a20 2020 2020 2020  scale"],.       
+0003ed00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ed10: 2020 2020 2020 2020 2076 6172 5f6e 616d           var_nam
+0003ed20: 653d 2264 6174 6173 6574 5f69 6422 2c0a  e="dataset_id",.
+0003ed30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ed40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ed50: 7661 6c75 655f 6e61 6d65 3d22 6364 6622  value_name="cdf"
+0003ed60: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0003ed70: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+0003ed80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003ed90: 2020 2020 2020 2020 2020 2020 2073 6e73               sns
+0003eda0: 2e6c 696e 6570 6c6f 7428 0a20 2020 2020  .lineplot(.     
+0003edb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003edc0: 2020 2020 2020 2020 2020 2064 6174 613d             data=
+0003edd0: 6466 2c0a 2020 2020 2020 2020 2020 2020  df,.            
+0003ede0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003edf0: 2020 2020 783d 2278 7363 616c 6522 2c0a      x="xscale",.
+0003ee00: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0003ee10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ee20: 2020 2020 7661 6c75 655f 6e61 6d65 3d22      value_name="
-0003ee30: 6364 6622 2c0a 2020 2020 2020 2020 2020  cdf",.          
-0003ee40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ee50: 2020 290a 0a20 2020 2020 2020 2020 2020    )..           
+0003ee20: 793d 2263 6466 222c 0a20 2020 2020 2020  y="cdf",.       
+0003ee30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ee40: 2020 2020 2020 2020 2061 783d 6178 6573           ax=axes
+0003ee50: 5b69 2c20 6a5d 2c0a 2020 2020 2020 2020  [i, j],.        
 0003ee60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ee70: 2073 6e73 2e6c 696e 6570 6c6f 7428 0a20   sns.lineplot(. 
-0003ee80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ee90: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-0003eea0: 6174 613d 6466 2c0a 2020 2020 2020 2020  ata=df,.        
-0003eeb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003eec0: 2020 2020 2020 2020 783d 2278 7363 616c          x="xscal
-0003eed0: 6522 2c0a 2020 2020 2020 2020 2020 2020  e",.            
-0003eee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003eef0: 2020 2020 793d 2263 6466 222c 0a20 2020      y="cdf",.   
-0003ef00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ef10: 2020 2020 2020 2020 2020 2020 2061 783d               ax=
-0003ef20: 6178 6573 5b69 2c20 6a5d 2c0a 2020 2020  axes[i, j],.    
-0003ef30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ef40: 2020 2020 2020 2020 2020 2020 7061 6c65              pale
-0003ef50: 7474 653d 5b63 6f6c 6f72 5b6c 2025 206e  tte=[color[l % n
-0003ef60: 5f63 6f6c 6f72 735d 5d2c 0a20 2020 2020  _colors]],.     
+0003ee70: 2020 2020 2020 2020 7061 6c65 7474 653d          palette=
+0003ee80: 5b63 6f6c 6f72 5b6c 2025 206e 5f63 6f6c  [color[l % n_col
+0003ee90: 6f72 735d 5d2c 0a20 2020 2020 2020 2020  ors]],.         
+0003eea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003eeb0: 2020 2020 2020 206c 6162 656c 3d62 6568         label=beh
+0003eec0: 6176 696f 725f 706f 6c69 6379 2c0a 2020  avior_policy,.  
+0003eed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003eee0: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+0003eef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ef00: 2020 2020 206f 6e5f 706f 6c69 6379 203d       on_policy =
+0003ef10: 2063 6466 5f64 6963 745b 6576 616c 5f70   cdf_dict[eval_p
+0003ef20: 6f6c 6963 795d 5b22 6f6e 5f70 6f6c 6963  olicy]["on_polic
+0003ef30: 7922 5d0a 2020 2020 2020 2020 2020 2020  y"].            
+0003ef40: 2020 2020 2020 2020 2020 2020 6966 206f              if o
+0003ef50: 6e5f 706f 6c69 6379 2069 7320 6e6f 7420  n_policy is not 
+0003ef60: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
 0003ef70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ef80: 2020 2020 2020 2020 2020 206c 6162 656c             label
-0003ef90: 3d62 6568 6176 696f 725f 706f 6c69 6379  =behavior_policy
-0003efa0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0003efb0: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+0003ef80: 2020 6178 6573 5b69 2c20 6a5d 2e70 6c6f    axes[i, j].plo
+0003ef90: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
+0003efa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003efb0: 2020 2072 6577 6172 645f 7363 616c 652c     reward_scale,
 0003efc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003efd0: 2020 2020 2020 2020 206f 6e5f 706f 6c69           on_poli
-0003efe0: 6379 203d 2063 6466 5f64 6963 745b 6576  cy = cdf_dict[ev
-0003eff0: 616c 5f70 6f6c 6963 795d 5b22 6f6e 5f70  al_policy]["on_p
-0003f000: 6f6c 6963 7922 5d0a 2020 2020 2020 2020  olicy"].        
-0003f010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f020: 6966 206f 6e5f 706f 6c69 6379 2069 7320  if on_policy is 
-0003f030: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
+0003efd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003efe0: 206f 6e5f 706f 6c69 6379 2c0a 2020 2020   on_policy,.    
+0003eff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f000: 2020 2020 2020 2020 2020 2020 636f 6c6f              colo
+0003f010: 723d 2262 6c61 636b 222c 0a20 2020 2020  r="black",.     
+0003f020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f030: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
 0003f040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f050: 2020 2020 2020 6178 6573 5b69 2c20 6a5d        axes[i, j]
-0003f060: 2e70 6c6f 7428 0a20 2020 2020 2020 2020  .plot(.         
-0003f070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f080: 2020 2020 2020 2072 6577 6172 645f 7363         reward_sc
-0003f090: 616c 652c 0a20 2020 2020 2020 2020 2020  ale,.           
-0003f0a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f0b0: 2020 2020 206f 6e5f 706f 6c69 6379 2c0a       on_policy,.
-0003f0c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f050: 2020 6178 6573 5b69 2c20 6a5d 2e73 6574    axes[i, j].set
+0003f060: 5f74 6974 6c65 2866 227b 6576 616c 5f70  _title(f"{eval_p
+0003f070: 6f6c 6963 797d 2c20 7b65 7374 696d 6174  olicy}, {estimat
+0003f080: 6f72 7d22 290a 2020 2020 2020 2020 2020  or}").          
+0003f090: 2020 2020 2020 2020 2020 2020 2020 6178                ax
+0003f0a0: 6573 5b69 2c20 6a5d 2e73 6574 5f78 6c61  es[i, j].set_xla
+0003f0b0: 6265 6c28 2274 7261 6a65 6374 6f72 792d  bel("trajectory-
+0003f0c0: 7769 7365 2072 6577 6172 6422 290a 2020  wise reward").  
 0003f0d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f0e0: 636f 6c6f 723d 2262 6c61 636b 222c 0a20  color="black",. 
-0003f0f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f100: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
-0003f110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f120: 2020 2020 2020 6178 6573 5b69 2c20 6a5d        axes[i, j]
-0003f130: 2e73 6574 5f74 6974 6c65 2866 227b 6576  .set_title(f"{ev
-0003f140: 616c 5f70 6f6c 6963 797d 2c20 7b65 7374  al_policy}, {est
-0003f150: 696d 6174 6f72 7d22 290a 2020 2020 2020  imator}").      
-0003f160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f170: 2020 6178 6573 5b69 2c20 6a5d 2e73 6574    axes[i, j].set
-0003f180: 5f78 6c61 6265 6c28 2274 7261 6a65 6374  _xlabel("traject
-0003f190: 6f72 792d 7769 7365 2072 6577 6172 6422  ory-wise reward"
-0003f1a0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0003f1b0: 2020 2020 2020 2020 2020 6178 6573 5b69            axes[i
-0003f1c0: 2c20 6a5d 2e73 6574 5f79 6c61 6265 6c28  , j].set_ylabel(
-0003f1d0: 2263 756d 756c 6174 6976 6520 7072 6f62  "cumulative prob
-0003f1e0: 6162 696c 6974 7922 290a 2020 2020 2020  ability").      
-0003f1f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f200: 2020 6966 206c 6567 656e 643a 0a20 2020    if legend:.   
+0003f0e0: 2020 2020 2020 6178 6573 5b69 2c20 6a5d        axes[i, j]
+0003f0f0: 2e73 6574 5f79 6c61 6265 6c28 2263 756d  .set_ylabel("cum
+0003f100: 756c 6174 6976 6520 7072 6f62 6162 696c  ulative probabil
+0003f110: 6974 7922 290a 2020 2020 2020 2020 2020  ity").          
+0003f120: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0003f130: 206c 6567 656e 643a 0a20 2020 2020 2020   legend:.       
+0003f140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f150: 2020 2020 2061 7865 735b 692c 206a 5d2e       axes[i, j].
+0003f160: 6c65 6765 6e64 2874 6974 6c65 3d22 6265  legend(title="be
+0003f170: 6861 7669 6f72 5f70 6f6c 6963 7922 290a  havior_policy").
+0003f180: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003f190: 2069 6620 6c65 6765 6e64 3a0a 2020 2020   if legend:.    
+0003f1a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f1b0: 6861 6e64 6c65 732c 206c 6162 656c 7320  handles, labels 
+0003f1c0: 3d20 6178 6573 5b30 2c20 305d 2e67 6574  = axes[0, 0].get
+0003f1d0: 5f6c 6567 656e 645f 6861 6e64 6c65 735f  _legend_handles_
+0003f1e0: 6c61 6265 6c73 2829 0a20 2020 2020 2020  labels().       
+0003f1f0: 2020 2020 2020 2020 2020 2020 2023 206e               # n
+0003f200: 5f63 6f6c 7320 7368 6f77 7320 6572 720a  _cols shows err.
 0003f210: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f220: 2020 2020 2020 2020 2061 7865 735b 692c           axes[i,
-0003f230: 206a 5d2e 6c65 6765 6e64 2874 6974 6c65   j].legend(title
-0003f240: 3d22 6265 6861 7669 6f72 5f70 6f6c 6963  ="behavior_polic
-0003f250: 7922 290a 0a20 2020 2020 2020 2020 2020  y")..           
-0003f260: 2020 2020 2069 6620 6c65 6765 6e64 3a0a       if legend:.
-0003f270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f280: 2020 2020 6861 6e64 6c65 732c 206c 6162      handles, lab
-0003f290: 656c 7320 3d20 6178 6573 5b30 2c20 305d  els = axes[0, 0]
-0003f2a0: 2e67 6574 5f6c 6567 656e 645f 6861 6e64  .get_legend_hand
-0003f2b0: 6c65 735f 6c61 6265 6c73 2829 0a20 2020  les_labels().   
-0003f2c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f2d0: 2023 206e 5f63 6f6c 7320 7368 6f77 7320   # n_cols shows 
-0003f2e0: 6572 720a 2020 2020 2020 2020 2020 2020  err.            
-0003f2f0: 2020 2020 2020 2020 2320 6669 672e 6c65          # fig.le
-0003f300: 6765 6e64 2868 616e 646c 6573 2c20 6c61  gend(handles, la
-0003f310: 6265 6c73 2c20 6c6f 633d 2775 7070 6572  bels, loc='upper
-0003f320: 2063 656e 7465 7227 2c20 6262 6f78 5f74   center', bbox_t
-0003f330: 6f5f 616e 6368 6f72 3d28 302e 352c 202d  o_anchor=(0.5, -
-0003f340: 302e 3129 2c20 6e5f 636f 6c73 3d6d 696e  0.1), n_cols=min
-0003f350: 286c 656e 286c 6162 656c 7329 2c20 3629  (len(labels), 6)
-0003f360: 290a 0a20 2020 2020 2020 2020 2020 2065  )..            e
-0003f370: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0003f380: 2020 2020 206e 5f63 6f6c 7320 3d20 6c65       n_cols = le
-0003f390: 6e28 696e 7075 745f 6469 6374 5f30 290a  n(input_dict_0).
-0003f3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f3b0: 6e5f 726f 7773 203d 206c 656e 2863 6f6d  n_rows = len(com
-0003f3c0: 7061 7265 645f 6573 7469 6d61 746f 7273  pared_estimators
-0003f3d0: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
-0003f3e0: 2020 2066 6967 2c20 6178 6573 203d 2070     fig, axes = p
-0003f3f0: 6c74 2e73 7562 706c 6f74 7328 0a20 2020  lt.subplots(.   
-0003f400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f410: 206e 726f 7773 3d6e 5f72 6f77 732c 206e   nrows=n_rows, n
-0003f420: 636f 6c73 3d6e 5f63 6f6c 732c 2066 6967  cols=n_cols, fig
-0003f430: 7369 7a65 3d28 3620 2a20 6e5f 636f 6c73  size=(6 * n_cols
-0003f440: 2c20 3420 2a20 6e5f 726f 7773 290a 2020  , 4 * n_rows).  
-0003f450: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-0003f460: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003f470: 2069 6620 6e5f 726f 7773 203d 3d20 313a   if n_rows == 1:
-0003f480: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003f490: 2020 2020 2066 6f72 2069 2c20 6573 7469       for i, esti
-0003f4a0: 6d61 746f 7220 696e 2065 6e75 6d65 7261  mator in enumera
-0003f4b0: 7465 2863 6f6d 7061 7265 645f 6573 7469  te(compared_esti
-0003f4c0: 6d61 746f 7273 293a 0a20 2020 2020 2020  mators):.       
+0003f220: 2020 2020 2320 6669 672e 6c65 6765 6e64      # fig.legend
+0003f230: 2868 616e 646c 6573 2c20 6c61 6265 6c73  (handles, labels
+0003f240: 2c20 6c6f 633d 2775 7070 6572 2063 656e  , loc='upper cen
+0003f250: 7465 7227 2c20 6262 6f78 5f74 6f5f 616e  ter', bbox_to_an
+0003f260: 6368 6f72 3d28 302e 352c 202d 302e 3129  chor=(0.5, -0.1)
+0003f270: 2c20 6e5f 636f 6c73 3d6d 696e 286c 656e  , n_cols=min(len
+0003f280: 286c 6162 656c 7329 2c20 3629 290a 0a20  (labels), 6)).. 
+0003f290: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+0003f2a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003f2b0: 206e 5f63 6f6c 7320 3d20 6c65 6e28 696e   n_cols = len(in
+0003f2c0: 7075 745f 6469 6374 5f30 290a 2020 2020  put_dict_0).    
+0003f2d0: 2020 2020 2020 2020 2020 2020 6e5f 726f              n_ro
+0003f2e0: 7773 203d 206c 656e 2863 6f6d 7061 7265  ws = len(compare
+0003f2f0: 645f 6573 7469 6d61 746f 7273 290a 0a20  d_estimators).. 
+0003f300: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0003f310: 6967 2c20 6178 6573 203d 2070 6c74 2e73  ig, axes = plt.s
+0003f320: 7562 706c 6f74 7328 0a20 2020 2020 2020  ubplots(.       
+0003f330: 2020 2020 2020 2020 2020 2020 206e 726f               nro
+0003f340: 7773 3d6e 5f72 6f77 732c 206e 636f 6c73  ws=n_rows, ncols
+0003f350: 3d6e 5f63 6f6c 732c 2066 6967 7369 7a65  =n_cols, figsize
+0003f360: 3d28 3620 2a20 6e5f 636f 6c73 2c20 3420  =(6 * n_cols, 4 
+0003f370: 2a20 6e5f 726f 7773 290a 2020 2020 2020  * n_rows).      
+0003f380: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+0003f390: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+0003f3a0: 6e5f 726f 7773 203d 3d20 313a 0a20 2020  n_rows == 1:.   
+0003f3b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f3c0: 2066 6f72 2069 2c20 6573 7469 6d61 746f   for i, estimato
+0003f3d0: 7220 696e 2065 6e75 6d65 7261 7465 2863  r in enumerate(c
+0003f3e0: 6f6d 7061 7265 645f 6573 7469 6d61 746f  ompared_estimato
+0003f3f0: 7273 293a 0a20 2020 2020 2020 2020 2020  rs):.           
+0003f400: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+0003f410: 206a 2c20 6576 616c 5f70 6f6c 6963 7920   j, eval_policy 
+0003f420: 696e 2065 6e75 6d65 7261 7465 2869 6e70  in enumerate(inp
+0003f430: 7574 5f64 6963 745f 302e 6b65 7973 2829  ut_dict_0.keys()
+0003f440: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+0003f450: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0003f460: 6f72 206c 2c20 6265 6861 7669 6f72 5f70  or l, behavior_p
+0003f470: 6f6c 6963 7920 696e 2065 6e75 6d65 7261  olicy in enumera
+0003f480: 7465 280a 2020 2020 2020 2020 2020 2020  te(.            
+0003f490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f4a0: 2020 2020 696e 7075 745f 6469 6374 2e62      input_dict.b
+0003f4b0: 6568 6176 696f 725f 706f 6c69 6379 5f6e  ehavior_policy_n
+0003f4c0: 616d 6573 0a20 2020 2020 2020 2020 2020  ames.           
 0003f4d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f4e0: 2066 6f72 206a 2c20 6576 616c 5f70 6f6c   for j, eval_pol
-0003f4f0: 6963 7920 696e 2065 6e75 6d65 7261 7465  icy in enumerate
-0003f500: 2869 6e70 7574 5f64 6963 745f 302e 6b65  (input_dict_0.ke
-0003f510: 7973 2829 293a 0a20 2020 2020 2020 2020  ys()):.         
-0003f520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f530: 2020 2066 6f72 206c 2c20 6265 6861 7669     for l, behavi
-0003f540: 6f72 5f70 6f6c 6963 7920 696e 2065 6e75  or_policy in enu
-0003f550: 6d65 7261 7465 280a 2020 2020 2020 2020  merate(.        
-0003f560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f570: 2020 2020 2020 2020 696e 7075 745f 6469          input_di
-0003f580: 6374 2e62 6568 6176 696f 725f 706f 6c69  ct.behavior_poli
-0003f590: 6379 5f6e 616d 6573 0a20 2020 2020 2020  cy_names.       
-0003f5a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f5b0: 2020 2020 2029 3a0a 2020 2020 2020 2020       ):.        
+0003f4e0: 2029 3a0a 2020 2020 2020 2020 2020 2020   ):.            
+0003f4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f500: 2020 2020 6e5f 6461 7461 7365 7473 203d      n_datasets =
+0003f510: 2069 6e70 7574 5f64 6963 742e 6e5f 6461   input_dict.n_da
+0003f520: 7461 7365 7473 5b62 6568 6176 696f 725f  tasets[behavior_
+0003f530: 706f 6c69 6379 5d0a 0a20 2020 2020 2020  policy]..       
+0003f540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f550: 2020 2020 2020 2020 2064 6620 3d20 4461           df = Da
+0003f560: 7461 4672 616d 6528 290a 2020 2020 2020  taFrame().      
+0003f570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f580: 2020 2020 2020 2020 2020 666f 7220 6461            for da
+0003f590: 7461 7365 745f 6964 5f20 696e 2072 616e  taset_id_ in ran
+0003f5a0: 6765 286e 5f64 6174 6173 6574 7329 3a0a  ge(n_datasets):.
+0003f5b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0003f5c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f5d0: 2020 2020 2020 2020 6e5f 6461 7461 7365          n_datase
-0003f5e0: 7473 203d 2069 6e70 7574 5f64 6963 742e  ts = input_dict.
-0003f5f0: 6e5f 6461 7461 7365 7473 5b62 6568 6176  n_datasets[behav
-0003f600: 696f 725f 706f 6c69 6379 5d0a 0a20 2020  ior_policy]..   
-0003f610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f620: 2020 2020 2020 2020 2020 2020 2064 6620               df 
-0003f630: 3d20 4461 7461 4672 616d 6528 290a 2020  = DataFrame().  
-0003f640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f650: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-0003f660: 7220 6461 7461 7365 745f 6964 5f20 696e  r dataset_id_ in
-0003f670: 2072 616e 6765 286e 5f64 6174 6173 6574   range(n_dataset
-0003f680: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
-0003f690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f6a0: 2020 2020 2020 2020 6466 5b22 7873 6361          df["xsca
-0003f6b0: 6c65 225d 203d 2072 6577 6172 645f 7363  le"] = reward_sc
-0003f6c0: 616c 650a 2020 2020 2020 2020 2020 2020  ale.            
-0003f6d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f6e0: 2020 2020 2020 2020 6466 5b64 6174 6173          df[datas
-0003f6f0: 6574 5f69 645f 5d20 3d20 6364 665f 6469  et_id_] = cdf_di
-0003f700: 6374 5b62 6568 6176 696f 725f 706f 6c69  ct[behavior_poli
-0003f710: 6379 5d5b 0a20 2020 2020 2020 2020 2020  cy][.           
-0003f720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f730: 2020 2020 2020 2020 2020 2020 2065 7661               eva
-0003f740: 6c5f 706f 6c69 6379 0a20 2020 2020 2020  l_policy.       
+0003f5d0: 2020 2020 6466 5b22 7873 6361 6c65 225d      df["xscale"]
+0003f5e0: 203d 2072 6577 6172 645f 7363 616c 650a   = reward_scale.
+0003f5f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f610: 2020 2020 6466 5b64 6174 6173 6574 5f69      df[dataset_i
+0003f620: 645f 5d20 3d20 6364 665f 6469 6374 5b62  d_] = cdf_dict[b
+0003f630: 6568 6176 696f 725f 706f 6c69 6379 5d5b  ehavior_policy][
+0003f640: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003f650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f660: 2020 2020 2020 2020 2065 7661 6c5f 706f           eval_po
+0003f670: 6c69 6379 0a20 2020 2020 2020 2020 2020  licy.           
+0003f680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f690: 2020 2020 2020 2020 205d 5b65 7374 696d           ][estim
+0003f6a0: 6174 6f72 5d5b 6461 7461 7365 745f 6964  ator][dataset_id
+0003f6b0: 5f5d 0a0a 2020 2020 2020 2020 2020 2020  _]..            
+0003f6c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f6d0: 2020 2020 6466 203d 2070 642e 6d65 6c74      df = pd.melt
+0003f6e0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0003f6f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f700: 2020 2020 2020 6466 2c0a 2020 2020 2020        df,.      
+0003f710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f720: 2020 2020 2020 2020 2020 2020 2020 6964                id
+0003f730: 5f76 6172 733d 5b22 7873 6361 6c65 225d  _vars=["xscale"]
+0003f740: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
 0003f750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f760: 2020 2020 2020 2020 2020 2020 205d 5b65               ][e
-0003f770: 7374 696d 6174 6f72 5d5b 6461 7461 7365  stimator][datase
-0003f780: 745f 6964 5f5d 0a0a 2020 2020 2020 2020  t_id_]..        
+0003f760: 2020 2020 2020 7661 725f 6e61 6d65 3d22        var_name="
+0003f770: 6461 7461 7365 745f 6964 222c 0a20 2020  dataset_id",.   
+0003f780: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0003f790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f7a0: 2020 2020 2020 2020 6466 203d 2070 642e          df = pd.
-0003f7b0: 6d65 6c74 280a 2020 2020 2020 2020 2020  melt(.          
+0003f7a0: 2076 616c 7565 5f6e 616d 653d 2263 6466   value_name="cdf
+0003f7b0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
 0003f7c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f7d0: 2020 2020 2020 2020 2020 6466 2c0a 2020            df,.  
+0003f7d0: 2020 2029 0a0a 2020 2020 2020 2020 2020     )..          
 0003f7e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f7f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f800: 2020 6964 5f76 6172 733d 5b22 7873 6361    id_vars=["xsca
-0003f810: 6c65 225d 2c0a 2020 2020 2020 2020 2020  le"],.          
-0003f820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f830: 2020 2020 2020 2020 2020 7661 725f 6e61            var_na
-0003f840: 6d65 3d22 6461 7461 7365 745f 6964 222c  me="dataset_id",
-0003f850: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003f860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f870: 2020 2020 2076 616c 7565 5f6e 616d 653d       value_name=
-0003f880: 2263 6466 222c 0a20 2020 2020 2020 2020  "cdf",.         
+0003f7f0: 2020 2020 2020 736e 732e 6c69 6e65 706c        sns.linepl
+0003f800: 6f74 280a 2020 2020 2020 2020 2020 2020  ot(.            
+0003f810: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f820: 2020 2020 2020 2020 6461 7461 3d64 662c          data=df,
+0003f830: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003f840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f850: 2020 2020 2078 3d22 7873 6361 6c65 222c       x="xscale",
+0003f860: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003f870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f880: 2020 2020 2079 3d22 6364 6622 2c0a 2020       y="cdf",.  
 0003f890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f8a0: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-0003f8b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f8c0: 2020 2020 2020 2020 2020 736e 732e 6c69            sns.li
-0003f8d0: 6e65 706c 6f74 280a 2020 2020 2020 2020  neplot(.        
-0003f8e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f8f0: 2020 2020 2020 2020 2020 2020 6461 7461              data
-0003f900: 3d64 662c 0a20 2020 2020 2020 2020 2020  =df,.           
+0003f8a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f8b0: 2020 6178 3d61 7865 735b 695d 2c0a 2020    ax=axes[i],.  
+0003f8c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f8d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f8e0: 2020 7061 6c65 7474 653d 5b63 6f6c 6f72    palette=[color
+0003f8f0: 5b6c 2025 206e 5f63 6f6c 6f72 735d 5d2c  [l % n_colors]],
+0003f900: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
 0003f910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f920: 2020 2020 2020 2020 2078 3d22 7873 6361           x="xsca
-0003f930: 6c65 222c 0a20 2020 2020 2020 2020 2020  le",.           
+0003f920: 2020 2020 206c 6162 656c 3d62 6568 6176       label=behav
+0003f930: 696f 725f 706f 6c69 6379 2c0a 2020 2020  ior_policy,.    
 0003f940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f950: 2020 2020 2020 2020 2079 3d22 6364 6622           y="cdf"
-0003f960: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0003f970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f980: 2020 2020 2020 6178 3d61 7865 735b 695d        ax=axes[i]
-0003f990: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0003f9a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f9b0: 2020 2020 2020 7061 6c65 7474 653d 5b63        palette=[c
-0003f9c0: 6f6c 6f72 5b6c 2025 206e 5f63 6f6c 6f72  olor[l % n_color
-0003f9d0: 735d 5d2c 0a20 2020 2020 2020 2020 2020  s]],.           
+0003f950: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+0003f960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f970: 2020 2020 2020 206f 6e5f 706f 6c69 6379         on_policy
+0003f980: 203d 2063 6466 5f64 6963 745b 6576 616c   = cdf_dict[eval
+0003f990: 5f70 6f6c 6963 795d 5b22 6f6e 5f70 6f6c  _policy]["on_pol
+0003f9a0: 6963 7922 5d0a 2020 2020 2020 2020 2020  icy"].          
+0003f9b0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0003f9c0: 206f 6e5f 706f 6c69 6379 2069 7320 6e6f   on_policy is no
+0003f9d0: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
 0003f9e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f9f0: 2020 2020 2020 2020 206c 6162 656c 3d62           label=b
-0003fa00: 6568 6176 696f 725f 706f 6c69 6379 2c0a  ehavior_policy,.
+0003f9f0: 2020 2020 6178 6573 5b69 5d2e 706c 6f74      axes[i].plot
+0003fa00: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
 0003fa10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003fa20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003fa30: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
-0003fa40: 2020 2020 2020 2020 2020 206f 6e5f 706f             on_po
-0003fa50: 6c69 6379 203d 2063 6466 5f64 6963 745b  licy = cdf_dict[
-0003fa60: 6576 616c 5f70 6f6c 6963 795d 5b22 6f6e  eval_policy]["on
-0003fa70: 5f70 6f6c 6963 7922 5d0a 2020 2020 2020  _policy"].      
-0003fa80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003fa90: 2020 6966 206f 6e5f 706f 6c69 6379 2069    if on_policy i
-0003faa0: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
+0003fa20: 2020 7265 7761 7264 5f73 6361 6c65 2c0a    reward_scale,.
+0003fa30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003fa40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003fa50: 6f6e 5f70 6f6c 6963 792c 0a20 2020 2020  on_policy,.     
+0003fa60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003fa70: 2020 2020 2020 2020 2020 2063 6f6c 6f72             color
+0003fa80: 3d22 626c 6163 6b22 2c0a 2020 2020 2020  ="black",.      
+0003fa90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003faa0: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
 0003fab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003fac0: 2020 2020 2020 2020 6178 6573 5b69 5d2e          axes[i].
-0003fad0: 706c 6f74 280a 2020 2020 2020 2020 2020  plot(.          
-0003fae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003faf0: 2020 2020 2020 7265 7761 7264 5f73 6361        reward_sca
-0003fb00: 6c65 2c0a 2020 2020 2020 2020 2020 2020  le,.            
-0003fb10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003fb20: 2020 2020 6f6e 5f70 6f6c 6963 792c 0a20      on_policy,. 
-0003fb30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003fb40: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-0003fb50: 6f6c 6f72 3d22 626c 6163 6b22 2c0a 2020  olor="black",.  
-0003fb60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003fb70: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+0003fac0: 2061 7865 735b 695d 2e73 6574 5f74 6974   axes[i].set_tit
+0003fad0: 6c65 2866 227b 6573 7469 6d61 746f 727d  le(f"{estimator}
+0003fae0: 2c20 7b65 7661 6c5f 706f 6c69 6379 7d22  , {eval_policy}"
+0003faf0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0003fb00: 2020 2020 2020 2020 2020 6178 6573 5b69            axes[i
+0003fb10: 5d2e 7365 745f 786c 6162 656c 2822 7472  ].set_xlabel("tr
+0003fb20: 616a 6563 746f 7279 2d77 6973 6520 7265  ajectory-wise re
+0003fb30: 7761 7264 2229 0a20 2020 2020 2020 2020  ward").         
+0003fb40: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+0003fb50: 7865 735b 695d 2e73 6574 5f79 6c61 6265  xes[i].set_ylabe
+0003fb60: 6c28 2263 756d 756c 6174 6976 6520 7072  l("cumulative pr
+0003fb70: 6f62 6162 696c 6974 7922 290a 2020 2020  obability").    
 0003fb80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003fb90: 2020 2020 2061 7865 735b 695d 2e73 6574       axes[i].set
-0003fba0: 5f74 6974 6c65 2866 227b 6573 7469 6d61  _title(f"{estima
-0003fbb0: 746f 727d 2c20 7b65 7661 6c5f 706f 6c69  tor}, {eval_poli
-0003fbc0: 6379 7d22 290a 2020 2020 2020 2020 2020  cy}").          
-0003fbd0: 2020 2020 2020 2020 2020 2020 2020 6178                ax
-0003fbe0: 6573 5b69 5d2e 7365 745f 786c 6162 656c  es[i].set_xlabel
-0003fbf0: 2822 7472 616a 6563 746f 7279 2d77 6973  ("trajectory-wis
-0003fc00: 6520 7265 7761 7264 2229 0a20 2020 2020  e reward").     
-0003fc10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003fc20: 2020 2061 7865 735b 695d 2e73 6574 5f79     axes[i].set_y
-0003fc30: 6c61 6265 6c28 2263 756d 756c 6174 6976  label("cumulativ
-0003fc40: 6520 7072 6f62 6162 696c 6974 7922 290a  e probability").
-0003fc50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003fc60: 2020 2020 2020 2020 6966 206c 6567 656e          if legen
-0003fc70: 643a 0a20 2020 2020 2020 2020 2020 2020  d:.             
-0003fc80: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-0003fc90: 7865 735b 695d 2e6c 6567 656e 6428 7469  xes[i].legend(ti
-0003fca0: 746c 653d 2262 6568 6176 696f 725f 706f  tle="behavior_po
-0003fcb0: 6c69 6379 2229 0a0a 2020 2020 2020 2020  licy")..        
-0003fcc0: 2020 2020 2020 2020 2020 2020 6966 206c              if l
-0003fcd0: 6567 656e 643a 0a20 2020 2020 2020 2020  egend:.         
-0003fce0: 2020 2020 2020 2020 2020 2020 2020 2068                 h
-0003fcf0: 616e 646c 6573 2c20 6c61 6265 6c73 203d  andles, labels =
-0003fd00: 2061 7865 735b 305d 2e67 6574 5f6c 6567   axes[0].get_leg
-0003fd10: 656e 645f 6861 6e64 6c65 735f 6c61 6265  end_handles_labe
-0003fd20: 6c73 2829 0a20 2020 2020 2020 2020 2020  ls().           
-0003fd30: 2020 2020 2020 2020 2020 2020 2023 206e               # n
-0003fd40: 5f63 6f6c 7320 7368 6f77 7320 6572 720a  _cols shows err.
-0003fd50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003fd60: 2020 2020 2020 2020 2320 6669 672e 6c65          # fig.le
-0003fd70: 6765 6e64 2868 616e 646c 6573 2c20 6c61  gend(handles, la
-0003fd80: 6265 6c73 2c20 6c6f 633d 2775 7070 6572  bels, loc='upper
-0003fd90: 2063 656e 7465 7227 2c20 6262 6f78 5f74   center', bbox_t
-0003fda0: 6f5f 616e 6368 6f72 3d28 302e 352c 202d  o_anchor=(0.5, -
-0003fdb0: 302e 3129 2c20 6e5f 636f 6c73 3d6d 696e  0.1), n_cols=min
-0003fdc0: 286c 656e 286c 6162 656c 7329 2c20 3629  (len(labels), 6)
-0003fdd0: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
-0003fde0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0003fdf0: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-0003fe00: 2069 2c20 6573 7469 6d61 746f 7220 696e   i, estimator in
-0003fe10: 2065 6e75 6d65 7261 7465 2863 6f6d 7061   enumerate(compa
-0003fe20: 7265 645f 6573 7469 6d61 746f 7273 293a  red_estimators):
-0003fe30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003fe40: 2020 2020 2020 2020 2066 6f72 206a 2c20           for j, 
-0003fe50: 6576 616c 5f70 6f6c 6963 7920 696e 2065  eval_policy in e
-0003fe60: 6e75 6d65 7261 7465 2869 6e70 7574 5f64  numerate(input_d
-0003fe70: 6963 745f 302e 6b65 7973 2829 293a 0a20  ict_0.keys()):. 
-0003fe80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003fe90: 2020 2020 2020 2020 2020 2066 6f72 206c             for l
-0003fea0: 2c20 6265 6861 7669 6f72 5f70 6f6c 6963  , behavior_polic
-0003feb0: 7920 696e 2065 6e75 6d65 7261 7465 280a  y in enumerate(.
-0003fec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003fed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003fee0: 696e 7075 745f 6469 6374 2e62 6568 6176  input_dict.behav
-0003fef0: 696f 725f 706f 6c69 6379 5f6e 616d 6573  ior_policy_names
-0003ff00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003ff10: 2020 2020 2020 2020 2020 2020 2029 3a0a               ):.
+0003fb90: 2020 2020 6966 206c 6567 656e 643a 0a20      if legend:. 
+0003fba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003fbb0: 2020 2020 2020 2020 2020 2061 7865 735b             axes[
+0003fbc0: 695d 2e6c 6567 656e 6428 7469 746c 653d  i].legend(title=
+0003fbd0: 2262 6568 6176 696f 725f 706f 6c69 6379  "behavior_policy
+0003fbe0: 2229 0a0a 2020 2020 2020 2020 2020 2020  ")..            
+0003fbf0: 2020 2020 2020 2020 6966 206c 6567 656e          if legen
+0003fc00: 643a 0a20 2020 2020 2020 2020 2020 2020  d:.             
+0003fc10: 2020 2020 2020 2020 2020 2068 616e 646c             handl
+0003fc20: 6573 2c20 6c61 6265 6c73 203d 2061 7865  es, labels = axe
+0003fc30: 735b 305d 2e67 6574 5f6c 6567 656e 645f  s[0].get_legend_
+0003fc40: 6861 6e64 6c65 735f 6c61 6265 6c73 2829  handles_labels()
+0003fc50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003fc60: 2020 2020 2020 2020 2023 206e 5f63 6f6c           # n_col
+0003fc70: 7320 7368 6f77 7320 6572 720a 2020 2020  s shows err.    
+0003fc80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003fc90: 2020 2020 2320 6669 672e 6c65 6765 6e64      # fig.legend
+0003fca0: 2868 616e 646c 6573 2c20 6c61 6265 6c73  (handles, labels
+0003fcb0: 2c20 6c6f 633d 2775 7070 6572 2063 656e  , loc='upper cen
+0003fcc0: 7465 7227 2c20 6262 6f78 5f74 6f5f 616e  ter', bbox_to_an
+0003fcd0: 6368 6f72 3d28 302e 352c 202d 302e 3129  chor=(0.5, -0.1)
+0003fce0: 2c20 6e5f 636f 6c73 3d6d 696e 286c 656e  , n_cols=min(len
+0003fcf0: 286c 6162 656c 7329 2c20 3629 290a 0a20  (labels), 6)).. 
+0003fd00: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0003fd10: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+0003fd20: 2020 2020 2020 2020 2066 6f72 2069 2c20           for i, 
+0003fd30: 6573 7469 6d61 746f 7220 696e 2065 6e75  estimator in enu
+0003fd40: 6d65 7261 7465 2863 6f6d 7061 7265 645f  merate(compared_
+0003fd50: 6573 7469 6d61 746f 7273 293a 0a20 2020  estimators):.   
+0003fd60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003fd70: 2020 2020 2066 6f72 206a 2c20 6576 616c       for j, eval
+0003fd80: 5f70 6f6c 6963 7920 696e 2065 6e75 6d65  _policy in enume
+0003fd90: 7261 7465 2869 6e70 7574 5f64 6963 745f  rate(input_dict_
+0003fda0: 302e 6b65 7973 2829 293a 0a20 2020 2020  0.keys()):.     
+0003fdb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003fdc0: 2020 2020 2020 2066 6f72 206c 2c20 6265         for l, be
+0003fdd0: 6861 7669 6f72 5f70 6f6c 6963 7920 696e  havior_policy in
+0003fde0: 2065 6e75 6d65 7261 7465 280a 2020 2020   enumerate(.    
+0003fdf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003fe00: 2020 2020 2020 2020 2020 2020 696e 7075              inpu
+0003fe10: 745f 6469 6374 2e62 6568 6176 696f 725f  t_dict.behavior_
+0003fe20: 706f 6c69 6379 5f6e 616d 6573 0a20 2020  policy_names.   
+0003fe30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003fe40: 2020 2020 2020 2020 2029 3a0a 2020 2020           ):.    
+0003fe50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003fe60: 2020 2020 2020 2020 2020 2020 6e5f 6461              n_da
+0003fe70: 7461 7365 7473 203d 2069 6e70 7574 5f64  tasets = input_d
+0003fe80: 6963 742e 6e5f 6461 7461 7365 7473 5b62  ict.n_datasets[b
+0003fe90: 6568 6176 696f 725f 706f 6c69 6379 5d0a  ehavior_policy].
+0003fea0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003feb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003fec0: 2064 6620 3d20 4461 7461 4672 616d 6528   df = DataFrame(
+0003fed0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0003fee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003fef0: 2020 666f 7220 6461 7461 7365 745f 6964    for dataset_id
+0003ff00: 5f20 696e 2072 616e 6765 286e 5f64 6174  _ in range(n_dat
+0003ff10: 6173 6574 7329 3a0a 2020 2020 2020 2020  asets):.        
 0003ff20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ff30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ff40: 6e5f 6461 7461 7365 7473 203d 2069 6e70  n_datasets = inp
-0003ff50: 7574 5f64 6963 742e 6e5f 6461 7461 7365  ut_dict.n_datase
-0003ff60: 7473 5b62 6568 6176 696f 725f 706f 6c69  ts[behavior_poli
-0003ff70: 6379 5d0a 0a20 2020 2020 2020 2020 2020  cy]..           
-0003ff80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ff90: 2020 2020 2064 6620 3d20 4461 7461 4672       df = DataFr
-0003ffa0: 616d 6528 290a 2020 2020 2020 2020 2020  ame().          
+0003ff30: 2020 2020 2020 2020 2020 2020 6466 5b22              df["
+0003ff40: 7873 6361 6c65 225d 203d 2072 6577 6172  xscale"] = rewar
+0003ff50: 645f 7363 616c 650a 2020 2020 2020 2020  d_scale.        
+0003ff60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ff70: 2020 2020 2020 2020 2020 2020 6466 5b64              df[d
+0003ff80: 6174 6173 6574 5f69 645f 5d20 3d20 6364  ataset_id_] = cd
+0003ff90: 665f 6469 6374 5b62 6568 6176 696f 725f  f_dict[behavior_
+0003ffa0: 706f 6c69 6379 5d5b 0a20 2020 2020 2020  policy][.       
 0003ffb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ffc0: 2020 2020 2020 666f 7220 6461 7461 7365        for datase
-0003ffd0: 745f 6964 5f20 696e 2072 616e 6765 286e  t_id_ in range(n
-0003ffe0: 5f64 6174 6173 6574 7329 3a0a 2020 2020  _datasets):.    
+0003ffc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003ffd0: 2065 7661 6c5f 706f 6c69 6379 0a20 2020   eval_policy.   
+0003ffe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 0003fff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040010: 6466 5b22 7873 6361 6c65 225d 203d 2072  df["xscale"] = r
-00040020: 6577 6172 645f 7363 616c 650a 2020 2020  eward_scale.    
-00040030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040050: 6466 5b64 6174 6173 6574 5f69 645f 5d20  df[dataset_id_] 
-00040060: 3d20 6364 665f 6469 6374 5b62 6568 6176  = cdf_dict[behav
-00040070: 696f 725f 706f 6c69 6379 5d5b 0a20 2020  ior_policy][.   
+00040000: 205d 5b65 7374 696d 6174 6f72 5d5b 6461   ][estimator][da
+00040010: 7461 7365 745f 6964 5f5d 0a0a 2020 2020  taset_id_]..    
+00040020: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040030: 2020 2020 2020 2020 2020 2020 6466 203d              df =
+00040040: 2070 642e 6d65 6c74 280a 2020 2020 2020   pd.melt(.      
+00040050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040060: 2020 2020 2020 2020 2020 2020 2020 6466                df
+00040070: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
 00040080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000400a0: 2020 2020 2065 7661 6c5f 706f 6c69 6379       eval_policy
-000400b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000400c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000400d0: 2020 2020 205d 5b65 7374 696d 6174 6f72       ][estimator
-000400e0: 5d5b 6461 7461 7365 745f 6964 5f5d 0a0a  ][dataset_id_]..
+00040090: 2020 2020 2020 6964 5f76 6172 733d 5b22        id_vars=["
+000400a0: 7873 6361 6c65 225d 2c0a 2020 2020 2020  xscale"],.      
+000400b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000400c0: 2020 2020 2020 2020 2020 2020 2020 7661                va
+000400d0: 725f 6e61 6d65 3d22 6461 7461 7365 745f  r_name="dataset_
+000400e0: 6964 222c 0a20 2020 2020 2020 2020 2020  id",.           
 000400f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040110: 6466 203d 2070 642e 6d65 6c74 280a 2020  df = pd.melt(.  
+00040100: 2020 2020 2020 2020 2076 616c 7565 5f6e           value_n
+00040110: 616d 653d 2263 6466 222c 0a20 2020 2020  ame="cdf",.     
 00040120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040140: 2020 6466 2c0a 2020 2020 2020 2020 2020    df,.          
-00040150: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040160: 2020 2020 2020 2020 2020 6964 5f76 6172            id_var
-00040170: 733d 5b22 7873 6361 6c65 225d 2c0a 2020  s=["xscale"],.  
+00040130: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
+00040140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040150: 2020 2020 2020 2020 2020 2020 2020 736e                sn
+00040160: 732e 6c69 6e65 706c 6f74 280a 2020 2020  s.lineplot(.    
+00040170: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00040180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000401a0: 2020 7661 725f 6e61 6d65 3d22 6461 7461    var_name="data
-000401b0: 7365 745f 6964 222c 0a20 2020 2020 2020  set_id",.       
-000401c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000401d0: 2020 2020 2020 2020 2020 2020 2076 616c               val
-000401e0: 7565 5f6e 616d 653d 2263 6466 222c 0a20  ue_name="cdf",. 
-000401f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040200: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-00040210: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00040220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040230: 2020 736e 732e 6c69 6e65 706c 6f74 280a    sns.lineplot(.
-00040240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040260: 2020 2020 6461 7461 3d64 662c 0a20 2020      data=df,.   
+00040190: 6461 7461 3d64 662c 0a20 2020 2020 2020  data=df,.       
+000401a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000401b0: 2020 2020 2020 2020 2020 2020 2078 3d22               x="
+000401c0: 7873 6361 6c65 222c 0a20 2020 2020 2020  xscale",.       
+000401d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000401e0: 2020 2020 2020 2020 2020 2020 2079 3d22               y="
+000401f0: 6364 6622 2c0a 2020 2020 2020 2020 2020  cdf",.          
+00040200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040210: 2020 2020 2020 2020 2020 6178 3d61 7865            ax=axe
+00040220: 735b 692c 206a 5d2c 0a20 2020 2020 2020  s[i, j],.       
+00040230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040240: 2020 2020 2020 2020 2020 2020 2070 616c               pal
+00040250: 6574 7465 3d5b 636f 6c6f 725b 6c20 2520  ette=[color[l % 
+00040260: 6e5f 636f 6c6f 7273 5d5d 2c0a 2020 2020  n_colors]],.    
 00040270: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00040280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040290: 2078 3d22 7873 6361 6c65 222c 0a20 2020   x="xscale",.   
-000402a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040290: 6c61 6265 6c3d 6265 6861 7669 6f72 5f70  label=behavior_p
+000402a0: 6f6c 6963 792c 0a20 2020 2020 2020 2020  olicy,.         
 000402b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000402c0: 2079 3d22 6364 6622 2c0a 2020 2020 2020   y="cdf",.      
+000402c0: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
 000402d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000402e0: 2020 2020 2020 2020 2020 2020 2020 6178                ax
-000402f0: 3d61 7865 735b 692c 206a 5d2c 0a20 2020  =axes[i, j],.   
-00040300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040320: 2070 616c 6574 7465 3d5b 636f 6c6f 725b   palette=[color[
-00040330: 6c20 2520 6e5f 636f 6c6f 7273 5d5d 2c0a  l % n_colors]],.
-00040340: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000402e0: 2020 2020 2020 6f6e 5f70 6f6c 6963 7920        on_policy 
+000402f0: 3d20 6364 665f 6469 6374 5b65 7661 6c5f  = cdf_dict[eval_
+00040300: 706f 6c69 6379 5d5b 226f 6e5f 706f 6c69  policy]["on_poli
+00040310: 6379 225d 0a20 2020 2020 2020 2020 2020  cy"].           
+00040320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040330: 2069 6620 6f6e 5f70 6f6c 6963 7920 6973   if on_policy is
+00040340: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
 00040350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040360: 2020 2020 6c61 6265 6c3d 6265 6861 7669      label=behavi
-00040370: 6f72 5f70 6f6c 6963 792c 0a20 2020 2020  or_policy,.     
+00040360: 2020 2020 2020 2020 2020 2061 7865 735b             axes[
+00040370: 692c 206a 5d2e 706c 6f74 280a 2020 2020  i, j].plot(.    
 00040380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040390: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
-000403a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000403b0: 2020 2020 2020 2020 2020 6f6e 5f70 6f6c            on_pol
-000403c0: 6963 7920 3d20 6364 665f 6469 6374 5b65  icy = cdf_dict[e
-000403d0: 7661 6c5f 706f 6c69 6379 5d5b 226f 6e5f  val_policy]["on_
-000403e0: 706f 6c69 6379 225d 0a20 2020 2020 2020  policy"].       
+00040390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000403a0: 7265 7761 7264 5f73 6361 6c65 2c0a 2020  reward_scale,.  
+000403b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000403c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000403d0: 2020 6f6e 5f70 6f6c 6963 792c 0a20 2020    on_policy,.   
+000403e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 000403f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040400: 2020 2020 2069 6620 6f6e 5f70 6f6c 6963       if on_polic
-00040410: 7920 6973 206e 6f74 204e 6f6e 653a 0a20  y is not None:. 
+00040400: 2063 6f6c 6f72 3d22 626c 6163 6b22 2c0a   color="black",.
+00040410: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00040420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040430: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-00040440: 7865 735b 692c 206a 5d2e 706c 6f74 280a  xes[i, j].plot(.
-00040450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040470: 2020 2020 7265 7761 7264 5f73 6361 6c65      reward_scale
-00040480: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00040490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000404a0: 2020 2020 2020 6f6e 5f70 6f6c 6963 792c        on_policy,
-000404b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000404c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000404d0: 2020 2020 2063 6f6c 6f72 3d22 626c 6163       color="blac
-000404e0: 6b22 2c0a 2020 2020 2020 2020 2020 2020  k",.            
-000404f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040500: 2020 2020 290a 0a20 2020 2020 2020 2020      )..         
-00040510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040520: 2020 2061 7865 735b 692c 206a 5d2e 7365     axes[i, j].se
-00040530: 745f 7469 746c 6528 6622 7b65 7374 696d  t_title(f"{estim
-00040540: 6174 6f72 7d2c 207b 6576 616c 5f70 6f6c  ator}, {eval_pol
-00040550: 6963 797d 2229 0a20 2020 2020 2020 2020  icy}").         
-00040560: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040570: 2020 2061 7865 735b 692c 206a 5d2e 7365     axes[i, j].se
-00040580: 745f 786c 6162 656c 2822 7472 616a 6563  t_xlabel("trajec
-00040590: 746f 7279 2d77 6973 6520 7265 7761 7264  tory-wise reward
-000405a0: 2229 0a20 2020 2020 2020 2020 2020 2020  ").             
-000405b0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-000405c0: 7865 735b 692c 206a 5d2e 7365 745f 796c  xes[i, j].set_yl
-000405d0: 6162 656c 2822 6375 6d75 6c61 7469 7665  abel("cumulative
-000405e0: 2070 726f 6261 6269 6c69 7479 2229 0a20   probability"). 
-000405f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040600: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
-00040610: 6765 6e64 3a0a 2020 2020 2020 2020 2020  gend:.          
-00040620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040630: 2020 2020 2020 6178 6573 5b69 2c20 6a5d        axes[i, j]
-00040640: 2e6c 6567 656e 6428 7469 746c 653d 2262  .legend(title="b
-00040650: 6568 6176 696f 725f 706f 6c69 6379 2229  ehavior_policy")
-00040660: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00040670: 2020 2020 2020 6966 206c 6567 656e 643a        if legend:
-00040680: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00040690: 2020 2020 2020 2020 2068 616e 646c 6573           handles
-000406a0: 2c20 6c61 6265 6c73 203d 2061 7865 735b  , labels = axes[
-000406b0: 302c 2030 5d2e 6765 745f 6c65 6765 6e64  0, 0].get_legend
-000406c0: 5f68 616e 646c 6573 5f6c 6162 656c 7328  _handles_labels(
-000406d0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-000406e0: 2020 2020 2020 2020 2020 2320 6e5f 636f            # n_co
-000406f0: 6c73 2073 686f 7773 2065 7272 0a20 2020  ls shows err.   
-00040700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040710: 2020 2020 2023 2066 6967 2e6c 6567 656e       # fig.legen
-00040720: 6428 6861 6e64 6c65 732c 206c 6162 656c  d(handles, label
-00040730: 732c 206c 6f63 3d27 7570 7065 7220 6365  s, loc='upper ce
-00040740: 6e74 6572 272c 2062 626f 785f 746f 5f61  nter', bbox_to_a
-00040750: 6e63 686f 723d 2830 2e35 2c20 2d30 2e31  nchor=(0.5, -0.1
-00040760: 292c 206e 5f63 6f6c 733d 6d69 6e28 6c65  ), n_cols=min(le
-00040770: 6e28 6c61 6265 6c73 292c 2036 2929 0a0a  n(labels), 6))..
-00040780: 2020 2020 2020 2020 656c 6966 2070 6c6f          elif plo
-00040790: 745f 7479 7065 203d 3d20 2265 6e75 6d65  t_type == "enume
-000407a0: 7261 7465 223a 0a20 2020 2020 2020 2020  rate":.         
-000407b0: 2020 2069 6620 6875 6520 3d3d 2022 6573     if hue == "es
-000407c0: 7469 6d61 746f 7222 3a0a 2020 2020 2020  timator":.      
-000407d0: 2020 2020 2020 2020 2020 6e5f 636f 6c73            n_cols
-000407e0: 203d 206c 656e 2863 6f6d 7061 7265 645f   = len(compared_
-000407f0: 6573 7469 6d61 746f 7273 290a 2020 2020  estimators).    
-00040800: 2020 2020 2020 2020 2020 2020 6e5f 726f              n_ro
-00040810: 7773 203d 206c 656e 2869 6e70 7574 5f64  ws = len(input_d
-00040820: 6963 745f 3029 0a0a 2020 2020 2020 2020  ict_0)..        
-00040830: 2020 2020 2020 2020 6669 672c 2061 7865          fig, axe
-00040840: 7320 3d20 706c 742e 7375 6270 6c6f 7473  s = plt.subplots
-00040850: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00040860: 2020 2020 2020 6e72 6f77 733d 6e5f 726f        nrows=n_ro
-00040870: 7773 2c20 6e63 6f6c 733d 6e5f 636f 6c73  ws, ncols=n_cols
-00040880: 2c20 6669 6773 697a 653d 2836 202a 206e  , figsize=(6 * n
-00040890: 5f63 6f6c 732c 2034 202a 206e 5f72 6f77  _cols, 4 * n_row
-000408a0: 7329 0a20 2020 2020 2020 2020 2020 2020  s).             
-000408b0: 2020 2029 0a0a 2020 2020 2020 2020 2020     )..          
-000408c0: 2020 2020 2020 666f 7220 692c 2065 7661        for i, eva
-000408d0: 6c5f 706f 6c69 6379 2069 6e20 656e 756d  l_policy in enum
-000408e0: 6572 6174 6528 696e 7075 745f 6469 6374  erate(input_dict
-000408f0: 5f30 2e6b 6579 7328 2929 3a0a 2020 2020  _0.keys()):.    
+00040430: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
+00040440: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+00040450: 7865 735b 692c 206a 5d2e 7365 745f 7469  xes[i, j].set_ti
+00040460: 746c 6528 6622 7b65 7374 696d 6174 6f72  tle(f"{estimator
+00040470: 7d2c 207b 6576 616c 5f70 6f6c 6963 797d  }, {eval_policy}
+00040480: 2229 0a20 2020 2020 2020 2020 2020 2020  ").             
+00040490: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+000404a0: 7865 735b 692c 206a 5d2e 7365 745f 786c  xes[i, j].set_xl
+000404b0: 6162 656c 2822 7472 616a 6563 746f 7279  abel("trajectory
+000404c0: 2d77 6973 6520 7265 7761 7264 2229 0a20  -wise reward"). 
+000404d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000404e0: 2020 2020 2020 2020 2020 2061 7865 735b             axes[
+000404f0: 692c 206a 5d2e 7365 745f 796c 6162 656c  i, j].set_ylabel
+00040500: 2822 6375 6d75 6c61 7469 7665 2070 726f  ("cumulative pro
+00040510: 6261 6269 6c69 7479 2229 0a20 2020 2020  bability").     
+00040520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040530: 2020 2020 2020 2069 6620 6c65 6765 6e64         if legend
+00040540: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00040550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040560: 2020 6178 6573 5b69 2c20 6a5d 2e6c 6567    axes[i, j].leg
+00040570: 656e 6428 7469 746c 653d 2262 6568 6176  end(title="behav
+00040580: 696f 725f 706f 6c69 6379 2229 0a0a 2020  ior_policy")..  
+00040590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000405a0: 2020 6966 206c 6567 656e 643a 0a20 2020    if legend:.   
+000405b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000405c0: 2020 2020 2068 616e 646c 6573 2c20 6c61       handles, la
+000405d0: 6265 6c73 203d 2061 7865 735b 302c 2030  bels = axes[0, 0
+000405e0: 5d2e 6765 745f 6c65 6765 6e64 5f68 616e  ].get_legend_han
+000405f0: 646c 6573 5f6c 6162 656c 7328 290a 2020  dles_labels().  
+00040600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040610: 2020 2020 2020 2320 6e5f 636f 6c73 2073        # n_cols s
+00040620: 686f 7773 2065 7272 0a20 2020 2020 2020  hows err.       
+00040630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040640: 2023 2066 6967 2e6c 6567 656e 6428 6861   # fig.legend(ha
+00040650: 6e64 6c65 732c 206c 6162 656c 732c 206c  ndles, labels, l
+00040660: 6f63 3d27 7570 7065 7220 6365 6e74 6572  oc='upper center
+00040670: 272c 2062 626f 785f 746f 5f61 6e63 686f  ', bbox_to_ancho
+00040680: 723d 2830 2e35 2c20 2d30 2e31 292c 206e  r=(0.5, -0.1), n
+00040690: 5f63 6f6c 733d 6d69 6e28 6c65 6e28 6c61  _cols=min(len(la
+000406a0: 6265 6c73 292c 2036 2929 0a0a 2020 2020  bels), 6))..    
+000406b0: 2020 2020 656c 6966 2070 6c6f 745f 7479      elif plot_ty
+000406c0: 7065 203d 3d20 2265 6e75 6d65 7261 7465  pe == "enumerate
+000406d0: 223a 0a20 2020 2020 2020 2020 2020 2069  ":.            i
+000406e0: 6620 6875 6520 3d3d 2022 6573 7469 6d61  f hue == "estima
+000406f0: 746f 7222 3a0a 2020 2020 2020 2020 2020  tor":.          
+00040700: 2020 2020 2020 6e5f 636f 6c73 203d 206c        n_cols = l
+00040710: 656e 2863 6f6d 7061 7265 645f 6573 7469  en(compared_esti
+00040720: 6d61 746f 7273 290a 2020 2020 2020 2020  mators).        
+00040730: 2020 2020 2020 2020 6e5f 726f 7773 203d          n_rows =
+00040740: 206c 656e 2869 6e70 7574 5f64 6963 745f   len(input_dict_
+00040750: 3029 0a0a 2020 2020 2020 2020 2020 2020  0)..            
+00040760: 2020 2020 6669 672c 2061 7865 7320 3d20      fig, axes = 
+00040770: 706c 742e 7375 6270 6c6f 7473 280a 2020  plt.subplots(.  
+00040780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040790: 2020 6e72 6f77 733d 6e5f 726f 7773 2c20    nrows=n_rows, 
+000407a0: 6e63 6f6c 733d 6e5f 636f 6c73 2c20 6669  ncols=n_cols, fi
+000407b0: 6773 697a 653d 2836 202a 206e 5f63 6f6c  gsize=(6 * n_col
+000407c0: 732c 2034 202a 206e 5f72 6f77 7329 0a20  s, 4 * n_rows). 
+000407d0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+000407e0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000407f0: 2020 666f 7220 692c 2065 7661 6c5f 706f    for i, eval_po
+00040800: 6c69 6379 2069 6e20 656e 756d 6572 6174  licy in enumerat
+00040810: 6528 696e 7075 745f 6469 6374 5f30 2e6b  e(input_dict_0.k
+00040820: 6579 7328 2929 3a0a 2020 2020 2020 2020  eys()):.        
+00040830: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00040840: 6a2c 2065 7374 696d 6174 6f72 2069 6e20  j, estimator in 
+00040850: 656e 756d 6572 6174 6528 636f 6d70 6172  enumerate(compar
+00040860: 6564 5f65 7374 696d 6174 6f72 7329 3a0a  ed_estimators):.
+00040870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040880: 2020 2020 2020 2020 666f 7220 6c20 696e          for l in
+00040890: 2072 616e 6765 2869 6e70 7574 5f64 6963   range(input_dic
+000408a0: 742e 6e5f 6461 7461 7365 7473 5b62 6568  t.n_datasets[beh
+000408b0: 6176 696f 725f 706f 6c69 6379 5f6e 616d  avior_policy_nam
+000408c0: 655d 293a 0a20 2020 2020 2020 2020 2020  e]):.           
+000408d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000408e0: 2061 7865 735b 692c 206a 5d2e 706c 6f74   axes[i, j].plot
+000408f0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
 00040900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040910: 666f 7220 6a2c 2065 7374 696d 6174 6f72  for j, estimator
-00040920: 2069 6e20 656e 756d 6572 6174 6528 636f   in enumerate(co
-00040930: 6d70 6172 6564 5f65 7374 696d 6174 6f72  mpared_estimator
-00040940: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
-00040950: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00040960: 6c20 696e 2072 616e 6765 2869 6e70 7574  l in range(input
-00040970: 5f64 6963 742e 6e5f 6461 7461 7365 7473  _dict.n_datasets
-00040980: 5b62 6568 6176 696f 725f 706f 6c69 6379  [behavior_policy
-00040990: 5f6e 616d 655d 293a 0a20 2020 2020 2020  _name]):.       
-000409a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000409b0: 2020 2020 2061 7865 735b 692c 206a 5d2e       axes[i, j].
-000409c0: 706c 6f74 280a 2020 2020 2020 2020 2020  plot(.          
-000409d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000409e0: 2020 2020 2020 7265 7761 7264 5f73 6361        reward_sca
-000409f0: 6c65 2c0a 2020 2020 2020 2020 2020 2020  le,.            
-00040a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040a10: 2020 2020 6364 665f 6469 6374 5b65 7661      cdf_dict[eva
-00040a20: 6c5f 706f 6c69 6379 5d5b 6573 7469 6d61  l_policy][estima
-00040a30: 746f 725d 5b6c 5d2c 0a20 2020 2020 2020  tor][l],.       
-00040a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040a50: 2020 2020 2020 2020 206c 6162 656c 3d6c           label=l
-00040a60: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00040a70: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+00040910: 2020 7265 7761 7264 5f73 6361 6c65 2c0a    reward_scale,.
+00040920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040940: 6364 665f 6469 6374 5b65 7661 6c5f 706f  cdf_dict[eval_po
+00040950: 6c69 6379 5d5b 6573 7469 6d61 746f 725d  licy][estimator]
+00040960: 5b6c 5d2c 0a20 2020 2020 2020 2020 2020  [l],.           
+00040970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040980: 2020 2020 206c 6162 656c 3d6c 2c0a 2020       label=l,.  
+00040990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000409a0: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+000409b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000409c0: 2020 2020 206f 6e5f 706f 6c69 6379 203d       on_policy =
+000409d0: 2063 6466 5f64 6963 745b 6576 616c 5f70   cdf_dict[eval_p
+000409e0: 6f6c 6963 795d 5b22 6f6e 5f70 6f6c 6963  olicy]["on_polic
+000409f0: 7922 5d0a 2020 2020 2020 2020 2020 2020  y"].            
+00040a00: 2020 2020 2020 2020 2020 2020 6966 206f              if o
+00040a10: 6e5f 706f 6c69 6379 2069 7320 6e6f 7420  n_policy is not 
+00040a20: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+00040a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040a40: 2020 6178 6573 5b69 2c20 6a5d 2e70 6c6f    axes[i, j].plo
+00040a50: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
+00040a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040a70: 2020 2072 6577 6172 645f 7363 616c 652c     reward_scale,
 00040a80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00040a90: 2020 2020 2020 2020 206f 6e5f 706f 6c69           on_poli
-00040aa0: 6379 203d 2063 6466 5f64 6963 745b 6576  cy = cdf_dict[ev
-00040ab0: 616c 5f70 6f6c 6963 795d 5b22 6f6e 5f70  al_policy]["on_p
-00040ac0: 6f6c 6963 7922 5d0a 2020 2020 2020 2020  olicy"].        
-00040ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040ae0: 6966 206f 6e5f 706f 6c69 6379 2069 7320  if on_policy is 
-00040af0: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
+00040a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040aa0: 206f 6e5f 706f 6c69 6379 2c0a 2020 2020   on_policy,.    
+00040ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040ac0: 2020 2020 2020 2020 2020 2020 636f 6c6f              colo
+00040ad0: 723d 2262 6c61 636b 222c 0a20 2020 2020  r="black",.     
+00040ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040af0: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
 00040b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040b10: 2020 2020 2020 6178 6573 5b69 2c20 6a5d        axes[i, j]
-00040b20: 2e70 6c6f 7428 0a20 2020 2020 2020 2020  .plot(.         
-00040b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040b40: 2020 2020 2020 2072 6577 6172 645f 7363         reward_sc
-00040b50: 616c 652c 0a20 2020 2020 2020 2020 2020  ale,.           
-00040b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040b70: 2020 2020 206f 6e5f 706f 6c69 6379 2c0a       on_policy,.
-00040b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040b10: 2020 6178 6573 5b69 2c20 6a5d 2e73 6574    axes[i, j].set
+00040b20: 5f74 6974 6c65 2866 227b 6576 616c 5f70  _title(f"{eval_p
+00040b30: 6f6c 6963 797d 2c20 7b65 7374 696d 6174  olicy}, {estimat
+00040b40: 6f72 7d22 290a 2020 2020 2020 2020 2020  or}").          
+00040b50: 2020 2020 2020 2020 2020 2020 2020 6178                ax
+00040b60: 6573 5b69 2c20 6a5d 2e73 6574 5f78 6c61  es[i, j].set_xla
+00040b70: 6265 6c28 2274 7261 6a65 6374 6f72 792d  bel("trajectory-
+00040b80: 7769 7365 2072 6577 6172 6422 290a 2020  wise reward").  
 00040b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040ba0: 636f 6c6f 723d 2262 6c61 636b 222c 0a20  color="black",. 
-00040bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040bc0: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
-00040bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040be0: 2020 2020 2020 6178 6573 5b69 2c20 6a5d        axes[i, j]
-00040bf0: 2e73 6574 5f74 6974 6c65 2866 227b 6576  .set_title(f"{ev
-00040c00: 616c 5f70 6f6c 6963 797d 2c20 7b65 7374  al_policy}, {est
-00040c10: 696d 6174 6f72 7d22 290a 2020 2020 2020  imator}").      
-00040c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040c30: 2020 6178 6573 5b69 2c20 6a5d 2e73 6574    axes[i, j].set
-00040c40: 5f78 6c61 6265 6c28 2274 7261 6a65 6374  _xlabel("traject
-00040c50: 6f72 792d 7769 7365 2072 6577 6172 6422  ory-wise reward"
-00040c60: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00040c70: 2020 2020 2020 2020 2020 6178 6573 5b69            axes[i
-00040c80: 2c20 6a5d 2e73 6574 5f79 6c61 6265 6c28  , j].set_ylabel(
-00040c90: 2263 756d 756c 6174 6976 6520 7072 6f62  "cumulative prob
-00040ca0: 6162 696c 6974 7922 290a 2020 2020 2020  ability").      
-00040cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040cc0: 2020 6966 206c 6567 656e 643a 0a20 2020    if legend:.   
-00040cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040ce0: 2020 2020 2020 2020 2061 7865 735b 692c           axes[i,
-00040cf0: 206a 5d2e 6c65 6765 6e64 2874 6974 6c65   j].legend(title
-00040d00: 3d22 6461 7461 7365 745f 6964 2229 0a0a  ="dataset_id")..
-00040d10: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00040d20: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00040d30: 2020 6e5f 636f 6c73 203d 206c 656e 2869    n_cols = len(i
-00040d40: 6e70 7574 5f64 6963 745f 3029 0a20 2020  nput_dict_0).   
-00040d50: 2020 2020 2020 2020 2020 2020 206e 5f72               n_r
-00040d60: 6f77 7320 3d20 6c65 6e28 636f 6d70 6172  ows = len(compar
-00040d70: 6564 5f65 7374 696d 6174 6f72 7329 0a0a  ed_estimators)..
+00040ba0: 2020 2020 2020 6178 6573 5b69 2c20 6a5d        axes[i, j]
+00040bb0: 2e73 6574 5f79 6c61 6265 6c28 2263 756d  .set_ylabel("cum
+00040bc0: 756c 6174 6976 6520 7072 6f62 6162 696c  ulative probabil
+00040bd0: 6974 7922 290a 2020 2020 2020 2020 2020  ity").          
+00040be0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00040bf0: 206c 6567 656e 643a 0a20 2020 2020 2020   legend:.       
+00040c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040c10: 2020 2020 2061 7865 735b 692c 206a 5d2e       axes[i, j].
+00040c20: 6c65 6765 6e64 2874 6974 6c65 3d22 6461  legend(title="da
+00040c30: 7461 7365 745f 6964 2229 0a0a 2020 2020  taset_id")..    
+00040c40: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00040c50: 2020 2020 2020 2020 2020 2020 2020 6e5f                n_
+00040c60: 636f 6c73 203d 206c 656e 2869 6e70 7574  cols = len(input
+00040c70: 5f64 6963 745f 3029 0a20 2020 2020 2020  _dict_0).       
+00040c80: 2020 2020 2020 2020 206e 5f72 6f77 7320           n_rows 
+00040c90: 3d20 6c65 6e28 636f 6d70 6172 6564 5f65  = len(compared_e
+00040ca0: 7374 696d 6174 6f72 7329 0a0a 2020 2020  stimators)..    
+00040cb0: 2020 2020 2020 2020 2020 2020 6669 672c              fig,
+00040cc0: 2061 7865 7320 3d20 706c 742e 7375 6270   axes = plt.subp
+00040cd0: 6c6f 7473 280a 2020 2020 2020 2020 2020  lots(.          
+00040ce0: 2020 2020 2020 2020 2020 6e72 6f77 733d            nrows=
+00040cf0: 6e5f 726f 7773 2c20 6e63 6f6c 733d 6e5f  n_rows, ncols=n_
+00040d00: 636f 6c73 2c20 6669 6773 697a 653d 2836  cols, figsize=(6
+00040d10: 202a 206e 5f63 6f6c 732c 2034 202a 206e   * n_cols, 4 * n
+00040d20: 5f72 6f77 7329 0a20 2020 2020 2020 2020  _rows).         
+00040d30: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+00040d40: 2020 2020 2020 2020 2020 666f 7220 692c            for i,
+00040d50: 2065 7374 696d 6174 6f72 2069 6e20 656e   estimator in en
+00040d60: 756d 6572 6174 6528 636f 6d70 6172 6564  umerate(compared
+00040d70: 5f65 7374 696d 6174 6f72 7329 3a0a 2020  _estimators):.  
 00040d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040d90: 6669 672c 2061 7865 7320 3d20 706c 742e  fig, axes = plt.
-00040da0: 7375 6270 6c6f 7473 280a 2020 2020 2020  subplots(.      
-00040db0: 2020 2020 2020 2020 2020 2020 2020 6e72                nr
-00040dc0: 6f77 733d 6e5f 726f 7773 2c20 6e63 6f6c  ows=n_rows, ncol
-00040dd0: 733d 6e5f 636f 6c73 2c20 6669 6773 697a  s=n_cols, figsiz
-00040de0: 653d 2836 202a 206e 5f63 6f6c 732c 2034  e=(6 * n_cols, 4
-00040df0: 202a 206e 5f72 6f77 7329 0a20 2020 2020   * n_rows).     
-00040e00: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
-00040e10: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-00040e20: 7220 692c 2065 7374 696d 6174 6f72 2069  r i, estimator i
-00040e30: 6e20 656e 756d 6572 6174 6528 636f 6d70  n enumerate(comp
-00040e40: 6172 6564 5f65 7374 696d 6174 6f72 7329  ared_estimators)
-00040e50: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00040e60: 2020 2020 2020 666f 7220 6a2c 2065 7661        for j, eva
-00040e70: 6c5f 706f 6c69 6379 2069 6e20 656e 756d  l_policy in enum
-00040e80: 6572 6174 6528 696e 7075 745f 6469 6374  erate(input_dict
-00040e90: 5f30 2e6b 6579 7328 2929 3a0a 2020 2020  _0.keys()):.    
-00040ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040eb0: 2020 2020 666f 7220 6c20 696e 2072 616e      for l in ran
-00040ec0: 6765 2869 6e70 7574 5f64 6963 742e 6e5f  ge(input_dict.n_
-00040ed0: 6461 7461 7365 7473 5b62 6568 6176 696f  datasets[behavio
-00040ee0: 725f 706f 6c69 6379 5f6e 616d 655d 293a  r_policy_name]):
-00040ef0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00040f00: 2020 2020 2020 2020 2020 2020 2061 7865               axe
-00040f10: 735b 692c 206a 5d2e 706c 6f74 280a 2020  s[i, j].plot(.  
-00040f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040f30: 2020 2020 2020 2020 2020 2020 2020 7265                re
-00040f40: 7761 7264 5f73 6361 6c65 2c0a 2020 2020  ward_scale,.    
+00040d90: 2020 666f 7220 6a2c 2065 7661 6c5f 706f    for j, eval_po
+00040da0: 6c69 6379 2069 6e20 656e 756d 6572 6174  licy in enumerat
+00040db0: 6528 696e 7075 745f 6469 6374 5f30 2e6b  e(input_dict_0.k
+00040dc0: 6579 7328 2929 3a0a 2020 2020 2020 2020  eys()):.        
+00040dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040de0: 666f 7220 6c20 696e 2072 616e 6765 2869  for l in range(i
+00040df0: 6e70 7574 5f64 6963 742e 6e5f 6461 7461  nput_dict.n_data
+00040e00: 7365 7473 5b62 6568 6176 696f 725f 706f  sets[behavior_po
+00040e10: 6c69 6379 5f6e 616d 655d 293a 0a20 2020  licy_name]):.   
+00040e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040e30: 2020 2020 2020 2020 2061 7865 735b 692c           axes[i,
+00040e40: 206a 5d2e 706c 6f74 280a 2020 2020 2020   j].plot(.      
+00040e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040e60: 2020 2020 2020 2020 2020 7265 7761 7264            reward
+00040e70: 5f73 6361 6c65 2c0a 2020 2020 2020 2020  _scale,.        
+00040e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040e90: 2020 2020 2020 2020 6364 665f 6469 6374          cdf_dict
+00040ea0: 5b65 7661 6c5f 706f 6c69 6379 5d5b 6573  [eval_policy][es
+00040eb0: 7469 6d61 746f 725d 5b6c 5d2c 0a20 2020  timator][l],.   
+00040ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040ed0: 2020 2020 2020 2020 2020 2020 206c 6162               lab
+00040ee0: 656c 3d6c 2c0a 2020 2020 2020 2020 2020  el=l,.          
+00040ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040f00: 2020 290a 0a20 2020 2020 2020 2020 2020    )..           
+00040f10: 2020 2020 2020 2020 2020 2020 206f 6e5f               on_
+00040f20: 706f 6c69 6379 203d 2063 6466 5f64 6963  policy = cdf_dic
+00040f30: 745b 6576 616c 5f70 6f6c 6963 795d 5b22  t[eval_policy]["
+00040f40: 6f6e 5f70 6f6c 6963 7922 5d0a 2020 2020  on_policy"].    
 00040f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040f60: 2020 2020 2020 2020 2020 2020 6364 665f              cdf_
-00040f70: 6469 6374 5b65 7661 6c5f 706f 6c69 6379  dict[eval_policy
-00040f80: 5d5b 6573 7469 6d61 746f 725d 5b6c 5d2c  ][estimator][l],
-00040f90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00040fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040fb0: 206c 6162 656c 3d6c 2c0a 2020 2020 2020   label=l,.      
-00040fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040fd0: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+00040f60: 2020 2020 6966 206f 6e5f 706f 6c69 6379      if on_policy
+00040f70: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
+00040f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040f90: 2020 2020 2020 2020 2020 6178 6573 5b69            axes[i
+00040fa0: 2c20 6a5d 2e70 6c6f 7428 0a20 2020 2020  , j].plot(.     
+00040fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040fc0: 2020 2020 2020 2020 2020 2072 6577 6172             rewar
+00040fd0: 645f 7363 616c 652c 0a20 2020 2020 2020  d_scale,.       
 00040fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00040ff0: 206f 6e5f 706f 6c69 6379 203d 2063 6466   on_policy = cdf
-00041000: 5f64 6963 745b 6576 616c 5f70 6f6c 6963  _dict[eval_polic
-00041010: 795d 5b22 6f6e 5f70 6f6c 6963 7922 5d0a  y]["on_policy"].
-00041020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041030: 2020 2020 2020 2020 6966 206f 6e5f 706f          if on_po
-00041040: 6c69 6379 2069 7320 6e6f 7420 4e6f 6e65  licy is not None
-00041050: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00041060: 2020 2020 2020 2020 2020 2020 2020 6178                ax
-00041070: 6573 5b69 2c20 6a5d 2e70 6c6f 7428 0a20  es[i, j].plot(. 
-00041080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041090: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-000410a0: 6577 6172 645f 7363 616c 652c 0a20 2020  eward_scale,.   
-000410b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000410c0: 2020 2020 2020 2020 2020 2020 206f 6e5f               on_
-000410d0: 706f 6c69 6379 2c0a 2020 2020 2020 2020  policy,.        
-000410e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000410f0: 2020 2020 2020 2020 636f 6c6f 723d 2262          color="b
-00041100: 6c61 636b 222c 0a20 2020 2020 2020 2020  lack",.         
-00041110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041120: 2020 2029 0a0a 2020 2020 2020 2020 2020     )..          
-00041130: 2020 2020 2020 2020 2020 2020 2020 6178                ax
-00041140: 6573 5b69 2c20 6a5d 2e73 6574 5f74 6974  es[i, j].set_tit
-00041150: 6c65 2866 227b 6573 7469 6d61 746f 727d  le(f"{estimator}
-00041160: 2c20 7b65 7661 6c5f 706f 6c69 6379 7d22  , {eval_policy}"
-00041170: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00041180: 2020 2020 2020 2020 2020 6178 6573 5b69            axes[i
-00041190: 2c20 6a5d 2e73 6574 5f78 6c61 6265 6c28  , j].set_xlabel(
-000411a0: 2274 7261 6a65 6374 6f72 792d 7769 7365  "trajectory-wise
-000411b0: 2072 6577 6172 6422 290a 2020 2020 2020   reward").      
-000411c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000411d0: 2020 6178 6573 5b69 2c20 6a5d 2e73 6574    axes[i, j].set
-000411e0: 5f79 6c61 6265 6c28 2263 756d 756c 6174  _ylabel("cumulat
-000411f0: 6976 6520 7072 6f62 6162 696c 6974 7922  ive probability"
-00041200: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00041210: 2020 2020 2020 2020 2020 6966 206c 6567            if leg
-00041220: 656e 643a 0a20 2020 2020 2020 2020 2020  end:.           
-00041230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041240: 2061 7865 735b 692c 206a 5d2e 6c65 6765   axes[i, j].lege
-00041250: 6e64 2874 6974 6c65 3d22 6461 7461 7365  nd(title="datase
-00041260: 745f 6964 2229 0a0a 2020 2020 2020 2020  t_id")..        
-00041270: 2020 2020 6966 206c 6567 656e 643a 0a20      if legend:. 
-00041280: 2020 2020 2020 2020 2020 2020 2020 2068                 h
-00041290: 616e 646c 6573 2c20 6c61 6265 6c73 203d  andles, labels =
-000412a0: 2061 7865 735b 302c 2030 5d2e 6765 745f   axes[0, 0].get_
-000412b0: 6c65 6765 6e64 5f68 616e 646c 6573 5f6c  legend_handles_l
-000412c0: 6162 656c 7328 290a 2020 2020 2020 2020  abels().        
-000412d0: 2020 2020 2020 2020 2320 6e5f 636f 6c73          # n_cols
-000412e0: 2073 686f 7773 2065 7272 0a20 2020 2020   shows err.     
-000412f0: 2020 2020 2020 2020 2020 2023 2066 6967             # fig
-00041300: 2e6c 6567 656e 6428 6861 6e64 6c65 732c  .legend(handles,
-00041310: 206c 6162 656c 732c 206c 6f63 3d27 7570   labels, loc='up
-00041320: 7065 7220 6365 6e74 6572 272c 2062 626f  per center', bbo
-00041330: 785f 746f 5f61 6e63 686f 723d 2830 2e35  x_to_anchor=(0.5
-00041340: 2c20 2d30 2e31 292c 206e 5f63 6f6c 733d  , -0.1), n_cols=
-00041350: 6d69 6e28 6c65 6e28 6c61 6265 6c73 292c  min(len(labels),
-00041360: 2036 2929 0a0a 2020 2020 2020 2020 6669   6))..        fi
-00041370: 672e 7375 6270 6c6f 7473 5f61 646a 7573  g.subplots_adjus
-00041380: 7428 6873 7061 6365 3d30 2e33 352c 2077  t(hspace=0.35, w
-00041390: 7370 6163 653d 302e 3229 0a20 2020 2020  space=0.2).     
-000413a0: 2020 2070 6c74 2e73 686f 7728 290a 0a20     plt.show().. 
-000413b0: 2020 2020 2020 2069 6620 6669 675f 6469         if fig_di
-000413c0: 723a 0a20 2020 2020 2020 2020 2020 2066  r:.            f
-000413d0: 6967 2e73 6176 6566 6967 2873 7472 2866  ig.savefig(str(f
-000413e0: 6967 5f64 6972 202f 2066 6967 5f6e 616d  ig_dir / fig_nam
-000413f0: 6529 2c20 6470 693d 3330 302c 2062 626f  e), dpi=300, bbo
-00041400: 785f 696e 6368 6573 3d22 7469 6768 7422  x_inches="tight"
-00041410: 290a 0a20 2020 2064 6566 2076 6973 7561  )..    def visua
-00041420: 6c69 7a65 5f70 6f6c 6963 795f 7661 6c75  lize_policy_valu
-00041430: 655f 7769 7468 5f6d 756c 7469 706c 655f  e_with_multiple_
-00041440: 6573 7469 6d61 7465 7328 0a20 2020 2020  estimates(.     
-00041450: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-00041460: 2069 6e70 7574 5f64 6963 743a 204d 756c   input_dict: Mul
-00041470: 7469 706c 6549 6e70 7574 4469 6374 2c0a  tipleInputDict,.
-00041480: 2020 2020 2020 2020 636f 6d70 6172 6564          compared
-00041490: 5f65 7374 696d 6174 6f72 733a 204f 7074  _estimators: Opt
-000414a0: 696f 6e61 6c5b 4c69 7374 5b73 7472 5d5d  ional[List[str]]
-000414b0: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
-000414c0: 2062 6568 6176 696f 725f 706f 6c69 6379   behavior_policy
-000414d0: 5f6e 616d 653a 204f 7074 696f 6e61 6c5b  _name: Optional[
-000414e0: 7374 725d 203d 204e 6f6e 652c 0a20 2020  str] = None,.   
-000414f0: 2020 2020 2070 6c6f 745f 7479 7065 3a20       plot_type: 
-00041500: 7374 7220 3d20 2263 6922 2c0a 2020 2020  str = "ci",.    
-00041510: 2020 2020 6875 653a 2073 7472 203d 2022      hue: str = "
-00041520: 6573 7469 6d61 746f 7222 2c0a 2020 2020  estimator",.    
-00041530: 2020 2020 6c65 6765 6e64 3a20 626f 6f6c      legend: bool
-00041540: 203d 2054 7275 652c 0a20 2020 2020 2020   = True,.       
-00041550: 2073 6861 7265 793a 2062 6f6f 6c20 3d20   sharey: bool = 
-00041560: 4661 6c73 652c 0a20 2020 2020 2020 2066  False,.        f
-00041570: 6967 5f64 6972 3a20 4f70 7469 6f6e 616c  ig_dir: Optional
-00041580: 5b50 6174 685d 203d 204e 6f6e 652c 0a20  [Path] = None,. 
-00041590: 2020 2020 2020 2066 6967 5f6e 616d 653a         fig_name:
-000415a0: 2073 7472 203d 2022 6573 7469 6d61 7465   str = "estimate
-000415b0: 645f 706f 6c69 6379 5f76 616c 7565 5f6d  d_policy_value_m
-000415c0: 756c 7469 706c 652e 706e 6722 2c0a 2020  ultiple.png",.  
-000415d0: 2020 2920 2d3e 204e 6f6e 653a 0a20 2020    ) -> None:.   
-000415e0: 2020 2020 2022 2222 5669 7375 616c 697a       """Visualiz
-000415f0: 6520 7468 6520 706f 6c69 6379 2076 616c  e the policy val
-00041600: 7565 2065 7374 696d 6174 6564 2062 7920  ue estimated by 
-00041610: 4f50 4520 6573 7469 6d61 746f 7273 2061  OPE estimators a
-00041620: 6372 6f73 7320 6d75 6c74 6970 6c65 206c  cross multiple l
-00041630: 6f67 6765 6420 6461 7461 7365 742e 0a0a  ogged dataset...
-00041640: 2020 2020 2020 2020 4e6f 7465 0a20 2020          Note.   
-00041650: 2020 2020 202d 2d2d 2d2d 2d2d 0a20 2020       -------.   
-00041660: 2020 2020 2054 6869 7320 6675 6e63 7469       This functi
-00041670: 6f6e 2069 7320 6170 706c 6963 6162 6c65  on is applicable
-00041680: 206f 6e6c 7920 7768 656e 204d 756c 7469   only when Multi
-00041690: 706c 654c 6f67 6765 6444 6174 6173 6574  pleLoggedDataset
-000416a0: 2069 7320 7573 6564 2061 6e64 0a20 2020   is used and.   
-000416b0: 2020 2020 204d 756c 7469 706c 6549 6e70       MultipleInp
-000416c0: 7574 4469 6374 2069 7320 636f 6c6c 6563  utDict is collec
-000416d0: 7465 6420 6279 2074 6865 2073 616d 6520  ted by the same 
-000416e0: 6576 616c 7561 7469 6f6e 2070 6f6c 6963  evaluation polic
-000416f0: 7920 6163 726f 7373 206c 6f67 6765 6420  y across logged 
-00041700: 6461 7461 7365 7473 2e0a 0a20 2020 2020  datasets...     
-00041710: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
-00041720: 2020 2020 2020 2d2d 2d2d 2d2d 2d0a 2020        -------.  
-00041730: 2020 2020 2020 696e 7075 745f 6469 6374        input_dict
-00041740: 3a20 4f50 4549 6e70 7574 4469 6374 206f  : OPEInputDict o
-00041750: 7220 4d75 6c74 6970 6c65 496e 7075 7444  r MultipleInputD
-00041760: 6963 740a 2020 2020 2020 2020 2020 2020  ict.            
-00041770: 4469 6374 696f 6e61 7279 206f 6620 7468  Dictionary of th
-00041780: 6520 4f50 4520 696e 7075 7473 2066 6f72  e OPE inputs for
-00041790: 2065 6163 6820 6576 616c 7561 7469 6f6e   each evaluation
-000417a0: 2070 6f6c 6963 792e 0a0a 2020 2020 2020   policy...      
-000417b0: 2020 2020 2020 2e2e 2063 6f64 652d 626c        .. code-bl
-000417c0: 6f63 6b3a 3a20 7079 7468 6f6e 0a0a 2020  ock:: python..  
-000417d0: 2020 2020 2020 2020 2020 2020 2020 6b65                ke
-000417e0: 793a 205b 6576 616c 7561 7469 6f6e 5f70  y: [evaluation_p
-000417f0: 6f6c 6963 795d 5b0a 2020 2020 2020 2020  olicy][.        
-00041800: 2020 2020 2020 2020 2020 2020 6576 616c              eval
-00041810: 7561 7469 6f6e 5f70 6f6c 6963 795f 6163  uation_policy_ac
-00041820: 7469 6f6e 2c0a 2020 2020 2020 2020 2020  tion,.          
-00041830: 2020 2020 2020 2020 2020 6576 616c 7561            evalua
-00041840: 7469 6f6e 5f70 6f6c 6963 795f 6163 7469  tion_policy_acti
-00041850: 6f6e 5f64 6973 742c 0a20 2020 2020 2020  on_dist,.       
-00041860: 2020 2020 2020 2020 2020 2020 2073 7461               sta
-00041870: 7465 5f61 6374 696f 6e5f 7661 6c75 655f  te_action_value_
-00041880: 7072 6564 6963 7469 6f6e 2c0a 2020 2020  prediction,.    
-00041890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000418a0: 696e 6974 6961 6c5f 7374 6174 655f 7661  initial_state_va
-000418b0: 6c75 655f 7072 6564 6963 7469 6f6e 2c0a  lue_prediction,.
-000418c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000418d0: 2020 2020 7374 6174 655f 6163 7469 6f6e      state_action
-000418e0: 5f6d 6172 6769 6e61 6c5f 696d 706f 7274  _marginal_import
-000418f0: 616e 6365 5f77 6569 6768 742c 0a20 2020  ance_weight,.   
-00041900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041910: 2073 7461 7465 5f6d 6172 6769 6e61 6c5f   state_marginal_
-00041920: 696d 706f 7274 616e 6365 5f77 6569 6768  importance_weigh
-00041930: 742c 0a20 2020 2020 2020 2020 2020 2020  t,.             
-00041940: 2020 2020 2020 206f 6e5f 706f 6c69 6379         on_policy
-00041950: 5f70 6f6c 6963 795f 7661 6c75 652c 0a20  _policy_value,. 
-00041960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00041970: 2020 2067 616d 6d61 2c0a 2020 2020 2020     gamma,.      
-00041980: 2020 2020 2020 2020 2020 2020 2020 6265                be
-00041990: 6861 7669 6f72 5f70 6f6c 6963 792c 0a20  havior_policy,. 
-000419a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000419b0: 2020 2065 7661 6c75 6174 696f 6e5f 706f     evaluation_po
-000419c0: 6c69 6379 2c0a 2020 2020 2020 2020 2020  licy,.          
-000419d0: 2020 2020 2020 2020 2020 6461 7461 7365            datase
-000419e0: 745f 6964 2c0a 2020 2020 2020 2020 2020  t_id,.          
-000419f0: 2020 2020 2020 5d0a 0a20 2020 2020 2020        ]..       
-00041a00: 2020 2020 202e 2e20 7365 6561 6c73 6f3a       .. seealso:
-00041a10: 3a0a 0a20 2020 2020 2020 2020 2020 2020  :..             
-00041a20: 2020 203a 636c 6173 733a 6073 636f 7065     :class:`scope
-00041a30: 5f72 6c2e 6f70 652e 696e 7075 742e 4372  _rl.ope.input.Cr
-00041a40: 6561 7465 4f50 4549 6e70 7574 6020 6465  eateOPEInput` de
-00041a50: 7363 7269 6265 7320 7468 6520 636f 6d70  scribes the comp
-00041a60: 6f6e 656e 7473 206f 6620 3a63 6c61 7373  onents of :class
-00041a70: 3a60 696e 7075 745f 6469 6374 602e 0a0a  :`input_dict`...
-00041a80: 2020 2020 2020 2020 636f 6d70 6172 6564          compared
-00041a90: 5f65 7374 696d 6174 6f72 733a 206c 6973  _estimators: lis
-00041aa0: 7420 6f66 2073 7472 2c20 6465 6661 756c  t of str, defaul
-00041ab0: 743d 4e6f 6e65 0a20 2020 2020 2020 2020  t=None.         
-00041ac0: 2020 204e 616d 6520 6f66 2063 6f6d 7061     Name of compa
-00041ad0: 7265 6420 6573 7469 6d61 746f 7273 2e0a  red estimators..
-00041ae0: 2020 2020 2020 2020 2020 2020 4966 2060              If `
-00041af0: 4e6f 6e65 6020 6973 2067 6976 656e 2c20  None` is given, 
-00041b00: 616c 6c20 7468 6520 6573 7469 6d61 746f  all the estimato
-00041b10: 7273 2061 7265 2063 6f6d 7061 7265 642e  rs are compared.
-00041b20: 0a0a 2020 2020 2020 2020 6265 6861 7669  ..        behavi
-00041b30: 6f72 5f70 6f6c 6963 795f 6e61 6d65 3a20  or_policy_name: 
-00041b40: 7374 722c 2064 6566 6175 6c74 3d4e 6f6e  str, default=Non
-00041b50: 650a 2020 2020 2020 2020 2020 2020 4e61  e.            Na
-00041b60: 6d65 206f 6620 7468 6520 6265 6861 7669  me of the behavi
-00041b70: 6f72 2070 6f6c 6963 792e 0a0a 2020 2020  or policy...    
-00041b80: 2020 2020 706c 6f74 5f74 7970 653a 207b      plot_type: {
-00041b90: 2263 6922 2c20 2273 6361 7474 6572 222c  "ci", "scatter",
-00041ba0: 2022 7669 6f6c 696e 227d 2c20 6465 6661   "violin"}, defa
-00041bb0: 756c 743d 2263 6922 0a20 2020 2020 2020  ult="ci".       
-00041bc0: 2020 2020 2054 7970 6520 6f66 2070 6c6f       Type of plo
-00041bd0: 742e 0a20 2020 2020 2020 2020 2020 2049  t..            I
-00041be0: 6620 2263 6922 2069 7320 6769 7665 6e2c  f "ci" is given,
-00041bf0: 2077 6520 6765 7420 7468 6520 656d 7069   we get the empi
-00041c00: 7269 6361 6c20 6176 6572 6167 6520 6f66  rical average of
-00041c10: 2074 6865 2065 7374 696d 6174 6564 2076   the estimated v
-00041c20: 616c 7565 7320 7769 7468 2074 6865 6972  alues with their
-00041c30: 2065 7374 696d 6174 6564 2063 6f6e 6669   estimated confi
-00041c40: 6465 6e63 6520 696e 7465 7276 616c 732e  dence intervals.
-00041c50: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
-00041c60: 2273 6361 7474 6572 2220 6973 2067 6976  "scatter" is giv
-00041c70: 656e 2c20 7765 2067 6574 2061 2073 6361  en, we get a sca
-00041c80: 7474 6572 2070 6c6f 7420 6f66 2065 7374  tter plot of est
-00041c90: 696d 6174 6564 2076 616c 7565 732e 0a0a  imated values...
-00041ca0: 2020 2020 2020 2020 6875 653a 207b 2265          hue: {"e
-00041cb0: 7374 696d 6174 6f72 222c 2022 706f 6c69  stimator", "poli
-00041cc0: 6379 227d 2c20 6465 6661 756c 743d 2265  cy"}, default="e
-00041cd0: 7374 696d 6174 6f72 220a 2020 2020 2020  stimator".      
-00041ce0: 2020 2020 2020 4875 6520 6f66 2074 6865        Hue of the
-00041cf0: 2070 6c6f 742e 0a0a 2020 2020 2020 2020   plot...        
-00041d00: 6c65 6765 6e64 3a20 626f 6f6c 2c20 6465  legend: bool, de
-00041d10: 6661 756c 743d 5472 7565 0a20 2020 2020  fault=True.     
-00041d20: 2020 2020 2020 2057 6865 7468 6572 2074         Whether t
-00041d30: 6f20 696e 636c 7564 6520 6120 6c65 6765  o include a lege
-00041d40: 6e64 2069 6e20 7468 6520 7363 6174 7465  nd in the scatte
-00041d50: 7220 706c 6f74 2e0a 0a20 2020 2020 2020  r plot...       
-00041d60: 2073 6861 7265 793a 2062 6f6f 6c2c 2064   sharey: bool, d
-00041d70: 6566 6175 6c74 3d46 616c 7365 0a20 2020  efault=False.   
-00041d80: 2020 2020 2020 2020 2049 6620 6054 7275           If `Tru
-00041d90: 6560 2c20 7468 6520 792d 6178 6973 2077  e`, the y-axis w
-00041da0: 696c 6c20 6265 2073 6861 7265 6420 616d  ill be shared am
-00041db0: 6f6e 6720 6469 6666 6572 656e 7420 6573  ong different es
-00041dc0: 7469 6d61 746f 7273 206f 7220 6576 616c  timators or eval
-00041dd0: 7561 7469 6f6e 2070 6f6c 6963 6965 732e  uation policies.
-00041de0: 0a0a 2020 2020 2020 2020 6669 675f 6469  ..        fig_di
-00041df0: 723a 2050 6174 682c 2064 6566 6175 6c74  r: Path, default
-00041e00: 3d4e 6f6e 650a 2020 2020 2020 2020 2020  =None.          
-00041e10: 2020 5061 7468 2074 6f20 7374 6f72 6520    Path to store 
-00041e20: 7468 6520 6261 7220 6669 6775 7265 2e0a  the bar figure..
-00041e30: 2020 2020 2020 2020 2020 2020 4966 2060              If `
-00041e40: 4e6f 6e65 6020 6973 2067 6976 656e 2c20  None` is given, 
-00041e50: 7468 6520 6669 6775 7265 2077 696c 6c20  the figure will 
-00041e60: 6e6f 7420 6265 2073 6176 6564 2e0a 0a20  not be saved... 
-00041e70: 2020 2020 2020 2066 6967 5f6e 616d 653a         fig_name:
-00041e80: 2073 7472 2c20 6465 6661 756c 743d 2265   str, default="e
-00041e90: 7374 696d 6174 6564 5f70 6f6c 6963 795f  stimated_policy_
-00041ea0: 7661 6c75 655f 6d75 6c74 6970 6c65 2e70  value_multiple.p
-00041eb0: 6e67 220a 2020 2020 2020 2020 2020 2020  ng".            
-00041ec0: 4e61 6d65 206f 6620 7468 6520 6261 7220  Name of the bar 
-00041ed0: 6669 6775 7265 2e0a 0a20 2020 2020 2020  figure...       
-00041ee0: 2022 2222 0a20 2020 2020 2020 2063 6f6d   """.        com
-00041ef0: 7061 7265 645f 6573 7469 6d61 746f 7273  pared_estimators
-00041f00: 203d 2073 656c 662e 5f63 6865 636b 5f63   = self._check_c
-00041f10: 6f6d 7061 7265 645f 6573 7469 6d61 746f  ompared_estimato
-00041f20: 7273 2863 6f6d 7061 7265 645f 6573 7469  rs(compared_esti
-00041f30: 6d61 746f 7273 290a 2020 2020 2020 2020  mators).        
-00041f40: 7365 6c66 2e5f 6368 6563 6b5f 6261 7369  self._check_basi
-00041f50: 635f 7669 7375 616c 697a 6174 696f 6e5f  c_visualization_
-00041f60: 696e 7075 7473 280a 2020 2020 2020 2020  inputs(.        
-00041f70: 2020 2020 6875 653d 6875 652c 2066 6967      hue=hue, fig
-00041f80: 5f64 6972 3d66 6967 5f64 6972 2c20 6669  _dir=fig_dir, fi
-00041f90: 675f 6e61 6d65 3d66 6967 5f6e 616d 650a  g_name=fig_name.
-00041fa0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00041fb0: 2020 7365 6c66 2e5f 6368 6563 6b5f 696e    self._check_in
-00041fc0: 7075 745f 6469 6374 5f66 6f72 5f76 6973  put_dict_for_vis
-00041fd0: 7561 6c69 7a65 5f6d 756c 7469 706c 655f  ualize_multiple_
-00041fe0: 6573 7469 6d61 7465 7328 696e 7075 745f  estimates(input_
-00041ff0: 6469 6374 290a 0a20 2020 2020 2020 2069  dict)..        i
-00042000: 6620 6c65 6e28 696e 7075 745f 6469 6374  f len(input_dict
-00042010: 2e62 6568 6176 696f 725f 706f 6c69 6379  .behavior_policy
-00042020: 5f6e 616d 6573 2920 3d3d 2031 3a0a 2020  _names) == 1:.  
-00042030: 2020 2020 2020 2020 2020 6265 6861 7669            behavi
-00042040: 6f72 5f70 6f6c 6963 795f 6e61 6d65 203d  or_policy_name =
-00042050: 2069 6e70 7574 5f64 6963 742e 6265 6861   input_dict.beha
-00042060: 7669 6f72 5f70 6f6c 6963 795f 6e61 6d65  vior_policy_name
-00042070: 735b 305d 0a0a 2020 2020 2020 2020 706f  s[0]..        po
-00042080: 6c69 6379 5f76 616c 7565 5f64 6963 745f  licy_value_dict_
-00042090: 203d 2073 656c 662e 6573 7469 6d61 7465   = self.estimate
-000420a0: 5f6d 6561 6e28 0a20 2020 2020 2020 2020  _mean(.         
-000420b0: 2020 2069 6e70 7574 5f64 6963 743d 696e     input_dict=in
-000420c0: 7075 745f 6469 6374 2c0a 2020 2020 2020  put_dict,.      
-000420d0: 2020 2020 2020 636f 6d70 6172 6564 5f65        compared_e
-000420e0: 7374 696d 6174 6f72 733d 636f 6d70 6172  stimators=compar
-000420f0: 6564 5f65 7374 696d 6174 6f72 732c 0a20  ed_estimators,. 
-00042100: 2020 2020 2020 2020 2020 2062 6568 6176             behav
-00042110: 696f 725f 706f 6c69 6379 5f6e 616d 653d  ior_policy_name=
-00042120: 6265 6861 7669 6f72 5f70 6f6c 6963 795f  behavior_policy_
-00042130: 6e61 6d65 2c0a 2020 2020 2020 2020 290a  name,.        ).
-00042140: 0a20 2020 2020 2020 2069 6620 6265 6861  .        if beha
-00042150: 7669 6f72 5f70 6f6c 6963 795f 6e61 6d65  vior_policy_name
-00042160: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
-00042170: 2020 2020 2020 706f 6c69 6379 5f76 616c        policy_val
-00042180: 7565 5f64 6963 7420 3d20 6465 6661 756c  ue_dict = defaul
-00042190: 7464 6963 7428 6c61 6d62 6461 3a20 6465  tdict(lambda: de
-000421a0: 6661 756c 7464 6963 7428 6469 6374 2929  faultdict(dict))
-000421b0: 0a0a 2020 2020 2020 2020 2020 2020 666f  ..            fo
-000421c0: 7220 6265 6861 7669 6f72 5f70 6f6c 6963  r behavior_polic
-000421d0: 792c 206e 5f64 6174 6173 6574 7320 696e  y, n_datasets in
-000421e0: 2069 6e70 7574 5f64 6963 742e 6e5f 6461   input_dict.n_da
-000421f0: 7461 7365 7473 2e69 7465 6d73 2829 3a0a  tasets.items():.
-00042200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042210: 696e 7075 745f 6469 6374 5f30 203d 2069  input_dict_0 = i
-00042220: 6e70 7574 5f64 6963 742e 6765 7428 0a20  nput_dict.get(. 
-00042230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042240: 2020 2062 6568 6176 696f 725f 706f 6c69     behavior_poli
-00042250: 6379 5f6e 616d 653d 6265 6861 7669 6f72  cy_name=behavior
-00042260: 5f70 6f6c 6963 792c 2064 6174 6173 6574  _policy, dataset
-00042270: 5f69 643d 300a 2020 2020 2020 2020 2020  _id=0.          
-00042280: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-00042290: 2020 2020 2020 2020 2066 6f72 2065 7661           for eva
-000422a0: 6c5f 706f 6c69 6379 2069 6e20 696e 7075  l_policy in inpu
-000422b0: 745f 6469 6374 5f30 2e6b 6579 7328 293a  t_dict_0.keys():
-000422c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000422d0: 2020 2020 2066 6f72 2065 7374 696d 6174       for estimat
-000422e0: 6f72 2069 6e20 636f 6d70 6172 6564 5f65  or in compared_e
-000422f0: 7374 696d 6174 6f72 733a 0a20 2020 2020  stimators:.     
+00040ff0: 2020 2020 2020 2020 206f 6e5f 706f 6c69           on_poli
+00041000: 6379 2c0a 2020 2020 2020 2020 2020 2020  cy,.            
+00041010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041020: 2020 2020 636f 6c6f 723d 2262 6c61 636b      color="black
+00041030: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
+00041040: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+00041050: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00041060: 2020 2020 2020 2020 2020 6178 6573 5b69            axes[i
+00041070: 2c20 6a5d 2e73 6574 5f74 6974 6c65 2866  , j].set_title(f
+00041080: 227b 6573 7469 6d61 746f 727d 2c20 7b65  "{estimator}, {e
+00041090: 7661 6c5f 706f 6c69 6379 7d22 290a 2020  val_policy}").  
+000410a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000410b0: 2020 2020 2020 6178 6573 5b69 2c20 6a5d        axes[i, j]
+000410c0: 2e73 6574 5f78 6c61 6265 6c28 2274 7261  .set_xlabel("tra
+000410d0: 6a65 6374 6f72 792d 7769 7365 2072 6577  jectory-wise rew
+000410e0: 6172 6422 290a 2020 2020 2020 2020 2020  ard").          
+000410f0: 2020 2020 2020 2020 2020 2020 2020 6178                ax
+00041100: 6573 5b69 2c20 6a5d 2e73 6574 5f79 6c61  es[i, j].set_yla
+00041110: 6265 6c28 2263 756d 756c 6174 6976 6520  bel("cumulative 
+00041120: 7072 6f62 6162 696c 6974 7922 290a 2020  probability").  
+00041130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041140: 2020 2020 2020 6966 206c 6567 656e 643a        if legend:
+00041150: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00041160: 2020 2020 2020 2020 2020 2020 2061 7865               axe
+00041170: 735b 692c 206a 5d2e 6c65 6765 6e64 2874  s[i, j].legend(t
+00041180: 6974 6c65 3d22 6461 7461 7365 745f 6964  itle="dataset_id
+00041190: 2229 0a0a 2020 2020 2020 2020 2020 2020  ")..            
+000411a0: 6966 206c 6567 656e 643a 0a20 2020 2020  if legend:.     
+000411b0: 2020 2020 2020 2020 2020 2068 616e 646c             handl
+000411c0: 6573 2c20 6c61 6265 6c73 203d 2061 7865  es, labels = axe
+000411d0: 735b 302c 2030 5d2e 6765 745f 6c65 6765  s[0, 0].get_lege
+000411e0: 6e64 5f68 616e 646c 6573 5f6c 6162 656c  nd_handles_label
+000411f0: 7328 290a 2020 2020 2020 2020 2020 2020  s().            
+00041200: 2020 2020 2320 6e5f 636f 6c73 2073 686f      # n_cols sho
+00041210: 7773 2065 7272 0a20 2020 2020 2020 2020  ws err.         
+00041220: 2020 2020 2020 2023 2066 6967 2e6c 6567         # fig.leg
+00041230: 656e 6428 6861 6e64 6c65 732c 206c 6162  end(handles, lab
+00041240: 656c 732c 206c 6f63 3d27 7570 7065 7220  els, loc='upper 
+00041250: 6365 6e74 6572 272c 2062 626f 785f 746f  center', bbox_to
+00041260: 5f61 6e63 686f 723d 2830 2e35 2c20 2d30  _anchor=(0.5, -0
+00041270: 2e31 292c 206e 5f63 6f6c 733d 6d69 6e28  .1), n_cols=min(
+00041280: 6c65 6e28 6c61 6265 6c73 292c 2036 2929  len(labels), 6))
+00041290: 0a0a 2020 2020 2020 2020 6669 672e 7375  ..        fig.su
+000412a0: 6270 6c6f 7473 5f61 646a 7573 7428 6873  bplots_adjust(hs
+000412b0: 7061 6365 3d30 2e33 352c 2077 7370 6163  pace=0.35, wspac
+000412c0: 653d 302e 3229 0a20 2020 2020 2020 2070  e=0.2).        p
+000412d0: 6c74 2e73 686f 7728 290a 0a20 2020 2020  lt.show()..     
+000412e0: 2020 2069 6620 6669 675f 6469 723a 0a20     if fig_dir:. 
+000412f0: 2020 2020 2020 2020 2020 2066 6967 2e73             fig.s
+00041300: 6176 6566 6967 2873 7472 2866 6967 5f64  avefig(str(fig_d
+00041310: 6972 202f 2066 6967 5f6e 616d 6529 2c20  ir / fig_name), 
+00041320: 6470 693d 3330 302c 2062 626f 785f 696e  dpi=300, bbox_in
+00041330: 6368 6573 3d22 7469 6768 7422 290a 0a20  ches="tight").. 
+00041340: 2020 2064 6566 2076 6973 7561 6c69 7a65     def visualize
+00041350: 5f70 6f6c 6963 795f 7661 6c75 655f 7769  _policy_value_wi
+00041360: 7468 5f6d 756c 7469 706c 655f 6573 7469  th_multiple_esti
+00041370: 6d61 7465 7328 0a20 2020 2020 2020 2073  mates(.        s
+00041380: 656c 662c 0a20 2020 2020 2020 2069 6e70  elf,.        inp
+00041390: 7574 5f64 6963 743a 204d 756c 7469 706c  ut_dict: Multipl
+000413a0: 6549 6e70 7574 4469 6374 2c0a 2020 2020  eInputDict,.    
+000413b0: 2020 2020 636f 6d70 6172 6564 5f65 7374      compared_est
+000413c0: 696d 6174 6f72 733a 204f 7074 696f 6e61  imators: Optiona
+000413d0: 6c5b 4c69 7374 5b73 7472 5d5d 203d 204e  l[List[str]] = N
+000413e0: 6f6e 652c 0a20 2020 2020 2020 2062 6568  one,.        beh
+000413f0: 6176 696f 725f 706f 6c69 6379 5f6e 616d  avior_policy_nam
+00041400: 653a 204f 7074 696f 6e61 6c5b 7374 725d  e: Optional[str]
+00041410: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
+00041420: 2070 6c6f 745f 7479 7065 3a20 7374 7220   plot_type: str 
+00041430: 3d20 2263 6922 2c0a 2020 2020 2020 2020  = "ci",.        
+00041440: 6875 653a 2073 7472 203d 2022 6573 7469  hue: str = "esti
+00041450: 6d61 746f 7222 2c0a 2020 2020 2020 2020  mator",.        
+00041460: 6c65 6765 6e64 3a20 626f 6f6c 203d 2054  legend: bool = T
+00041470: 7275 652c 0a20 2020 2020 2020 2073 6861  rue,.        sha
+00041480: 7265 793a 2062 6f6f 6c20 3d20 4661 6c73  rey: bool = Fals
+00041490: 652c 0a20 2020 2020 2020 2066 6967 5f64  e,.        fig_d
+000414a0: 6972 3a20 4f70 7469 6f6e 616c 5b50 6174  ir: Optional[Pat
+000414b0: 685d 203d 204e 6f6e 652c 0a20 2020 2020  h] = None,.     
+000414c0: 2020 2066 6967 5f6e 616d 653a 2073 7472     fig_name: str
+000414d0: 203d 2022 6573 7469 6d61 7465 645f 706f   = "estimated_po
+000414e0: 6c69 6379 5f76 616c 7565 5f6d 756c 7469  licy_value_multi
+000414f0: 706c 652e 706e 6722 2c0a 2020 2020 2920  ple.png",.    ) 
+00041500: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
+00041510: 2022 2222 5669 7375 616c 697a 6520 7468   """Visualize th
+00041520: 6520 706f 6c69 6379 2076 616c 7565 2065  e policy value e
+00041530: 7374 696d 6174 6564 2062 7920 4f50 4520  stimated by OPE 
+00041540: 6573 7469 6d61 746f 7273 2061 6372 6f73  estimators acros
+00041550: 7320 6d75 6c74 6970 6c65 206c 6f67 6765  s multiple logge
+00041560: 6420 6461 7461 7365 742e 0a0a 2020 2020  d dataset...    
+00041570: 2020 2020 4e6f 7465 0a20 2020 2020 2020      Note.       
+00041580: 202d 2d2d 2d2d 2d2d 0a20 2020 2020 2020   -------.       
+00041590: 2054 6869 7320 6675 6e63 7469 6f6e 2069   This function i
+000415a0: 7320 6170 706c 6963 6162 6c65 206f 6e6c  s applicable onl
+000415b0: 7920 7768 656e 204d 756c 7469 706c 654c  y when MultipleL
+000415c0: 6f67 6765 6444 6174 6173 6574 2069 7320  oggedDataset is 
+000415d0: 7573 6564 2061 6e64 0a20 2020 2020 2020  used and.       
+000415e0: 204d 756c 7469 706c 6549 6e70 7574 4469   MultipleInputDi
+000415f0: 6374 2069 7320 636f 6c6c 6563 7465 6420  ct is collected 
+00041600: 6279 2074 6865 2073 616d 6520 6576 616c  by the same eval
+00041610: 7561 7469 6f6e 2070 6f6c 6963 7920 6163  uation policy ac
+00041620: 726f 7373 206c 6f67 6765 6420 6461 7461  ross logged data
+00041630: 7365 7473 2e0a 0a20 2020 2020 2020 2050  sets...        P
+00041640: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
+00041650: 2020 2d2d 2d2d 2d2d 2d0a 2020 2020 2020    -------.      
+00041660: 2020 696e 7075 745f 6469 6374 3a20 4f50    input_dict: OP
+00041670: 4549 6e70 7574 4469 6374 206f 7220 4d75  EInputDict or Mu
+00041680: 6c74 6970 6c65 496e 7075 7444 6963 740a  ltipleInputDict.
+00041690: 2020 2020 2020 2020 2020 2020 4469 6374              Dict
+000416a0: 696f 6e61 7279 206f 6620 7468 6520 4f50  ionary of the OP
+000416b0: 4520 696e 7075 7473 2066 6f72 2065 6163  E inputs for eac
+000416c0: 6820 6576 616c 7561 7469 6f6e 2070 6f6c  h evaluation pol
+000416d0: 6963 792e 0a0a 2020 2020 2020 2020 2020  icy...          
+000416e0: 2020 2e2e 2063 6f64 652d 626c 6f63 6b3a    .. code-block:
+000416f0: 3a20 7079 7468 6f6e 0a0a 2020 2020 2020  : python..      
+00041700: 2020 2020 2020 2020 2020 6b65 793a 205b            key: [
+00041710: 6576 616c 7561 7469 6f6e 5f70 6f6c 6963  evaluation_polic
+00041720: 795d 5b0a 2020 2020 2020 2020 2020 2020  y][.            
+00041730: 2020 2020 2020 2020 6576 616c 7561 7469          evaluati
+00041740: 6f6e 5f70 6f6c 6963 795f 6163 7469 6f6e  on_policy_action
+00041750: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00041760: 2020 2020 2020 6576 616c 7561 7469 6f6e        evaluation
+00041770: 5f70 6f6c 6963 795f 6163 7469 6f6e 5f64  _policy_action_d
+00041780: 6973 742c 0a20 2020 2020 2020 2020 2020  ist,.           
+00041790: 2020 2020 2020 2020 2073 7461 7465 5f61           state_a
+000417a0: 6374 696f 6e5f 7661 6c75 655f 7072 6564  ction_value_pred
+000417b0: 6963 7469 6f6e 2c0a 2020 2020 2020 2020  iction,.        
+000417c0: 2020 2020 2020 2020 2020 2020 696e 6974              init
+000417d0: 6961 6c5f 7374 6174 655f 7661 6c75 655f  ial_state_value_
+000417e0: 7072 6564 6963 7469 6f6e 2c0a 2020 2020  prediction,.    
+000417f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041800: 7374 6174 655f 6163 7469 6f6e 5f6d 6172  state_action_mar
+00041810: 6769 6e61 6c5f 696d 706f 7274 616e 6365  ginal_importance
+00041820: 5f77 6569 6768 742c 0a20 2020 2020 2020  _weight,.       
+00041830: 2020 2020 2020 2020 2020 2020 2073 7461               sta
+00041840: 7465 5f6d 6172 6769 6e61 6c5f 696d 706f  te_marginal_impo
+00041850: 7274 616e 6365 5f77 6569 6768 742c 0a20  rtance_weight,. 
+00041860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00041870: 2020 206f 6e5f 706f 6c69 6379 5f70 6f6c     on_policy_pol
+00041880: 6963 795f 7661 6c75 652c 0a20 2020 2020  icy_value,.     
+00041890: 2020 2020 2020 2020 2020 2020 2020 2067                 g
+000418a0: 616d 6d61 2c0a 2020 2020 2020 2020 2020  amma,.          
+000418b0: 2020 2020 2020 2020 2020 6265 6861 7669            behavi
+000418c0: 6f72 5f70 6f6c 6963 792c 0a20 2020 2020  or_policy,.     
+000418d0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+000418e0: 7661 6c75 6174 696f 6e5f 706f 6c69 6379  valuation_policy
+000418f0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00041900: 2020 2020 2020 6461 7461 7365 745f 6964        dataset_id
+00041910: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00041920: 2020 5d0a 0a20 2020 2020 2020 2020 2020    ]..           
+00041930: 202e 2e20 7365 6561 6c73 6f3a 3a0a 0a20   .. seealso::.. 
+00041940: 2020 2020 2020 2020 2020 2020 2020 203a                 :
+00041950: 636c 6173 733a 6073 636f 7065 5f72 6c2e  class:`scope_rl.
+00041960: 6f70 652e 696e 7075 742e 4372 6561 7465  ope.input.Create
+00041970: 4f50 4549 6e70 7574 6020 6465 7363 7269  OPEInput` descri
+00041980: 6265 7320 7468 6520 636f 6d70 6f6e 656e  bes the componen
+00041990: 7473 206f 6620 3a63 6c61 7373 3a60 696e  ts of :class:`in
+000419a0: 7075 745f 6469 6374 602e 0a0a 2020 2020  put_dict`...    
+000419b0: 2020 2020 636f 6d70 6172 6564 5f65 7374      compared_est
+000419c0: 696d 6174 6f72 733a 206c 6973 7420 6f66  imators: list of
+000419d0: 2073 7472 2c20 6465 6661 756c 743d 4e6f   str, default=No
+000419e0: 6e65 0a20 2020 2020 2020 2020 2020 204e  ne.            N
+000419f0: 616d 6520 6f66 2063 6f6d 7061 7265 6420  ame of compared 
+00041a00: 6573 7469 6d61 746f 7273 2e0a 2020 2020  estimators..    
+00041a10: 2020 2020 2020 2020 4966 2060 4e6f 6e65          If `None
+00041a20: 6020 6973 2067 6976 656e 2c20 616c 6c20  ` is given, all 
+00041a30: 7468 6520 6573 7469 6d61 746f 7273 2061  the estimators a
+00041a40: 7265 2063 6f6d 7061 7265 642e 0a0a 2020  re compared...  
+00041a50: 2020 2020 2020 6265 6861 7669 6f72 5f70        behavior_p
+00041a60: 6f6c 6963 795f 6e61 6d65 3a20 7374 722c  olicy_name: str,
+00041a70: 2064 6566 6175 6c74 3d4e 6f6e 650a 2020   default=None.  
+00041a80: 2020 2020 2020 2020 2020 4e61 6d65 206f            Name o
+00041a90: 6620 7468 6520 6265 6861 7669 6f72 2070  f the behavior p
+00041aa0: 6f6c 6963 792e 0a0a 2020 2020 2020 2020  olicy...        
+00041ab0: 706c 6f74 5f74 7970 653a 207b 2263 6922  plot_type: {"ci"
+00041ac0: 2c20 2273 6361 7474 6572 222c 2022 7669  , "scatter", "vi
+00041ad0: 6f6c 696e 227d 2c20 6465 6661 756c 743d  olin"}, default=
+00041ae0: 2263 6922 0a20 2020 2020 2020 2020 2020  "ci".           
+00041af0: 2054 7970 6520 6f66 2070 6c6f 742e 0a20   Type of plot.. 
+00041b00: 2020 2020 2020 2020 2020 2049 6620 2263             If "c
+00041b10: 6922 2069 7320 6769 7665 6e2c 2077 6520  i" is given, we 
+00041b20: 6765 7420 7468 6520 656d 7069 7269 6361  get the empirica
+00041b30: 6c20 6176 6572 6167 6520 6f66 2074 6865  l average of the
+00041b40: 2065 7374 696d 6174 6564 2076 616c 7565   estimated value
+00041b50: 7320 7769 7468 2074 6865 6972 2065 7374  s with their est
+00041b60: 696d 6174 6564 2063 6f6e 6669 6465 6e63  imated confidenc
+00041b70: 6520 696e 7465 7276 616c 732e 0a20 2020  e intervals..   
+00041b80: 2020 2020 2020 2020 2049 6620 2273 6361           If "sca
+00041b90: 7474 6572 2220 6973 2067 6976 656e 2c20  tter" is given, 
+00041ba0: 7765 2067 6574 2061 2073 6361 7474 6572  we get a scatter
+00041bb0: 2070 6c6f 7420 6f66 2065 7374 696d 6174   plot of estimat
+00041bc0: 6564 2076 616c 7565 732e 0a0a 2020 2020  ed values...    
+00041bd0: 2020 2020 6875 653a 207b 2265 7374 696d      hue: {"estim
+00041be0: 6174 6f72 222c 2022 706f 6c69 6379 227d  ator", "policy"}
+00041bf0: 2c20 6465 6661 756c 743d 2265 7374 696d  , default="estim
+00041c00: 6174 6f72 220a 2020 2020 2020 2020 2020  ator".          
+00041c10: 2020 4875 6520 6f66 2074 6865 2070 6c6f    Hue of the plo
+00041c20: 742e 0a0a 2020 2020 2020 2020 6c65 6765  t...        lege
+00041c30: 6e64 3a20 626f 6f6c 2c20 6465 6661 756c  nd: bool, defaul
+00041c40: 743d 5472 7565 0a20 2020 2020 2020 2020  t=True.         
+00041c50: 2020 2057 6865 7468 6572 2074 6f20 696e     Whether to in
+00041c60: 636c 7564 6520 6120 6c65 6765 6e64 2069  clude a legend i
+00041c70: 6e20 7468 6520 7363 6174 7465 7220 706c  n the scatter pl
+00041c80: 6f74 2e0a 0a20 2020 2020 2020 2073 6861  ot...        sha
+00041c90: 7265 793a 2062 6f6f 6c2c 2064 6566 6175  rey: bool, defau
+00041ca0: 6c74 3d46 616c 7365 0a20 2020 2020 2020  lt=False.       
+00041cb0: 2020 2020 2049 6620 6054 7275 6560 2c20       If `True`, 
+00041cc0: 7468 6520 792d 6178 6973 2077 696c 6c20  the y-axis will 
+00041cd0: 6265 2073 6861 7265 6420 616d 6f6e 6720  be shared among 
+00041ce0: 6469 6666 6572 656e 7420 6573 7469 6d61  different estima
+00041cf0: 746f 7273 206f 7220 6576 616c 7561 7469  tors or evaluati
+00041d00: 6f6e 2070 6f6c 6963 6965 732e 0a0a 2020  on policies...  
+00041d10: 2020 2020 2020 6669 675f 6469 723a 2050        fig_dir: P
+00041d20: 6174 682c 2064 6566 6175 6c74 3d4e 6f6e  ath, default=Non
+00041d30: 650a 2020 2020 2020 2020 2020 2020 5061  e.            Pa
+00041d40: 7468 2074 6f20 7374 6f72 6520 7468 6520  th to store the 
+00041d50: 6261 7220 6669 6775 7265 2e0a 2020 2020  bar figure..    
+00041d60: 2020 2020 2020 2020 4966 2060 4e6f 6e65          If `None
+00041d70: 6020 6973 2067 6976 656e 2c20 7468 6520  ` is given, the 
+00041d80: 6669 6775 7265 2077 696c 6c20 6e6f 7420  figure will not 
+00041d90: 6265 2073 6176 6564 2e0a 0a20 2020 2020  be saved...     
+00041da0: 2020 2066 6967 5f6e 616d 653a 2073 7472     fig_name: str
+00041db0: 2c20 6465 6661 756c 743d 2265 7374 696d  , default="estim
+00041dc0: 6174 6564 5f70 6f6c 6963 795f 7661 6c75  ated_policy_valu
+00041dd0: 655f 6d75 6c74 6970 6c65 2e70 6e67 220a  e_multiple.png".
+00041de0: 2020 2020 2020 2020 2020 2020 4e61 6d65              Name
+00041df0: 206f 6620 7468 6520 6261 7220 6669 6775   of the bar figu
+00041e00: 7265 2e0a 0a20 2020 2020 2020 2022 2222  re...        """
+00041e10: 0a20 2020 2020 2020 2063 6f6d 7061 7265  .        compare
+00041e20: 645f 6573 7469 6d61 746f 7273 203d 2073  d_estimators = s
+00041e30: 656c 662e 5f63 6865 636b 5f63 6f6d 7061  elf._check_compa
+00041e40: 7265 645f 6573 7469 6d61 746f 7273 2863  red_estimators(c
+00041e50: 6f6d 7061 7265 645f 6573 7469 6d61 746f  ompared_estimato
+00041e60: 7273 290a 2020 2020 2020 2020 7365 6c66  rs).        self
+00041e70: 2e5f 6368 6563 6b5f 6261 7369 635f 7669  ._check_basic_vi
+00041e80: 7375 616c 697a 6174 696f 6e5f 696e 7075  sualization_inpu
+00041e90: 7473 280a 2020 2020 2020 2020 2020 2020  ts(.            
+00041ea0: 6875 653d 6875 652c 2066 6967 5f64 6972  hue=hue, fig_dir
+00041eb0: 3d66 6967 5f64 6972 2c20 6669 675f 6e61  =fig_dir, fig_na
+00041ec0: 6d65 3d66 6967 5f6e 616d 650a 2020 2020  me=fig_name.    
+00041ed0: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
+00041ee0: 6c66 2e5f 6368 6563 6b5f 696e 7075 745f  lf._check_input_
+00041ef0: 6469 6374 5f66 6f72 5f76 6973 7561 6c69  dict_for_visuali
+00041f00: 7a65 5f6d 756c 7469 706c 655f 6573 7469  ze_multiple_esti
+00041f10: 6d61 7465 7328 696e 7075 745f 6469 6374  mates(input_dict
+00041f20: 290a 0a20 2020 2020 2020 2069 6620 6c65  )..        if le
+00041f30: 6e28 696e 7075 745f 6469 6374 2e62 6568  n(input_dict.beh
+00041f40: 6176 696f 725f 706f 6c69 6379 5f6e 616d  avior_policy_nam
+00041f50: 6573 2920 3d3d 2031 3a0a 2020 2020 2020  es) == 1:.      
+00041f60: 2020 2020 2020 6265 6861 7669 6f72 5f70        behavior_p
+00041f70: 6f6c 6963 795f 6e61 6d65 203d 2069 6e70  olicy_name = inp
+00041f80: 7574 5f64 6963 742e 6265 6861 7669 6f72  ut_dict.behavior
+00041f90: 5f70 6f6c 6963 795f 6e61 6d65 735b 305d  _policy_names[0]
+00041fa0: 0a0a 2020 2020 2020 2020 706f 6c69 6379  ..        policy
+00041fb0: 5f76 616c 7565 5f64 6963 745f 203d 2073  _value_dict_ = s
+00041fc0: 656c 662e 6573 7469 6d61 7465 5f6d 6561  elf.estimate_mea
+00041fd0: 6e28 0a20 2020 2020 2020 2020 2020 2069  n(.            i
+00041fe0: 6e70 7574 5f64 6963 743d 696e 7075 745f  nput_dict=input_
+00041ff0: 6469 6374 2c0a 2020 2020 2020 2020 2020  dict,.          
+00042000: 2020 636f 6d70 6172 6564 5f65 7374 696d    compared_estim
+00042010: 6174 6f72 733d 636f 6d70 6172 6564 5f65  ators=compared_e
+00042020: 7374 696d 6174 6f72 732c 0a20 2020 2020  stimators,.     
+00042030: 2020 2020 2020 2062 6568 6176 696f 725f         behavior_
+00042040: 706f 6c69 6379 5f6e 616d 653d 6265 6861  policy_name=beha
+00042050: 7669 6f72 5f70 6f6c 6963 795f 6e61 6d65  vior_policy_name
+00042060: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
+00042070: 2020 2020 2069 6620 6265 6861 7669 6f72       if behavior
+00042080: 5f70 6f6c 6963 795f 6e61 6d65 2069 7320  _policy_name is 
+00042090: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+000420a0: 2020 706f 6c69 6379 5f76 616c 7565 5f64    policy_value_d
+000420b0: 6963 7420 3d20 6465 6661 756c 7464 6963  ict = defaultdic
+000420c0: 7428 6c61 6d62 6461 3a20 6465 6661 756c  t(lambda: defaul
+000420d0: 7464 6963 7428 6469 6374 2929 0a0a 2020  tdict(dict))..  
+000420e0: 2020 2020 2020 2020 2020 666f 7220 6265            for be
+000420f0: 6861 7669 6f72 5f70 6f6c 6963 792c 206e  havior_policy, n
+00042100: 5f64 6174 6173 6574 7320 696e 2069 6e70  _datasets in inp
+00042110: 7574 5f64 6963 742e 6e5f 6461 7461 7365  ut_dict.n_datase
+00042120: 7473 2e69 7465 6d73 2829 3a0a 2020 2020  ts.items():.    
+00042130: 2020 2020 2020 2020 2020 2020 696e 7075              inpu
+00042140: 745f 6469 6374 5f30 203d 2069 6e70 7574  t_dict_0 = input
+00042150: 5f64 6963 742e 6765 7428 0a20 2020 2020  _dict.get(.     
+00042160: 2020 2020 2020 2020 2020 2020 2020 2062                 b
+00042170: 6568 6176 696f 725f 706f 6c69 6379 5f6e  ehavior_policy_n
+00042180: 616d 653d 6265 6861 7669 6f72 5f70 6f6c  ame=behavior_pol
+00042190: 6963 792c 2064 6174 6173 6574 5f69 643d  icy, dataset_id=
+000421a0: 300a 2020 2020 2020 2020 2020 2020 2020  0.              
+000421b0: 2020 290a 0a20 2020 2020 2020 2020 2020    )..           
+000421c0: 2020 2020 2066 6f72 2065 7661 6c5f 706f       for eval_po
+000421d0: 6c69 6379 2069 6e20 696e 7075 745f 6469  licy in input_di
+000421e0: 6374 5f30 2e6b 6579 7328 293a 0a20 2020  ct_0.keys():.   
+000421f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00042200: 2066 6f72 2065 7374 696d 6174 6f72 2069   for estimator i
+00042210: 6e20 636f 6d70 6172 6564 5f65 7374 696d  n compared_estim
+00042220: 6174 6f72 733a 0a20 2020 2020 2020 2020  ators:.         
+00042230: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00042240: 6f6c 6963 795f 7661 6c75 6520 3d20 6e70  olicy_value = np
+00042250: 2e7a 6572 6f73 2828 6e5f 6461 7461 7365  .zeros((n_datase
+00042260: 7473 2c29 290a 2020 2020 2020 2020 2020  ts,)).          
+00042270: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+00042280: 7220 6461 7461 7365 745f 6964 5f20 696e  r dataset_id_ in
+00042290: 2072 616e 6765 286e 5f64 6174 6173 6574   range(n_dataset
+000422a0: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
+000422b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000422c0: 706f 6c69 6379 5f76 616c 7565 5b64 6174  policy_value[dat
+000422d0: 6173 6574 5f69 645f 5d20 3d20 706f 6c69  aset_id_] = poli
+000422e0: 6379 5f76 616c 7565 5f64 6963 745f 5b0a  cy_value_dict_[.
+000422f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
 00042300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042310: 2020 2070 6f6c 6963 795f 7661 6c75 6520     policy_value 
-00042320: 3d20 6e70 2e7a 6572 6f73 2828 6e5f 6461  = np.zeros((n_da
-00042330: 7461 7365 7473 2c29 290a 2020 2020 2020  tasets,)).      
-00042340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042350: 2020 666f 7220 6461 7461 7365 745f 6964    for dataset_id
-00042360: 5f20 696e 2072 616e 6765 286e 5f64 6174  _ in range(n_dat
-00042370: 6173 6574 7329 3a0a 2020 2020 2020 2020  asets):.        
-00042380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042390: 2020 2020 706f 6c69 6379 5f76 616c 7565      policy_value
-000423a0: 5b64 6174 6173 6574 5f69 645f 5d20 3d20  [dataset_id_] = 
-000423b0: 706f 6c69 6379 5f76 616c 7565 5f64 6963  policy_value_dic
-000423c0: 745f 5b0a 2020 2020 2020 2020 2020 2020  t_[.            
-000423d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000423e0: 2020 2020 6265 6861 7669 6f72 5f70 6f6c      behavior_pol
-000423f0: 6963 790a 2020 2020 2020 2020 2020 2020  icy.            
+00042310: 6265 6861 7669 6f72 5f70 6f6c 6963 790a  behavior_policy.
+00042320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00042330: 2020 2020 2020 2020 2020 2020 5d5b 6461              ][da
+00042340: 7461 7365 745f 6964 5f5d 5b65 7661 6c5f  taset_id_][eval_
+00042350: 706f 6c69 6379 5d5b 6573 7469 6d61 746f  policy][estimato
+00042360: 725d 0a0a 2020 2020 2020 2020 2020 2020  r]..            
+00042370: 2020 2020 2020 2020 2020 2020 706f 6c69              poli
+00042380: 6379 5f76 616c 7565 5f64 6963 745b 6265  cy_value_dict[be
+00042390: 6861 7669 6f72 5f70 6f6c 6963 795d 5b65  havior_policy][e
+000423a0: 7661 6c5f 706f 6c69 6379 5d5b 0a20 2020  val_policy][.   
+000423b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000423c0: 2020 2020 2020 2020 2065 7374 696d 6174           estimat
+000423d0: 6f72 0a20 2020 2020 2020 2020 2020 2020  or.             
+000423e0: 2020 2020 2020 2020 2020 205d 203d 2070             ] = p
+000423f0: 6f6c 6963 795f 7661 6c75 650a 0a20 2020  olicy_value..   
 00042400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042410: 5d5b 6461 7461 7365 745f 6964 5f5d 5b65  ][dataset_id_][e
-00042420: 7661 6c5f 706f 6c69 6379 5d5b 6573 7469  val_policy][esti
-00042430: 6d61 746f 725d 0a0a 2020 2020 2020 2020  mator]..        
-00042440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042450: 706f 6c69 6379 5f76 616c 7565 5f64 6963  policy_value_dic
-00042460: 745b 6265 6861 7669 6f72 5f70 6f6c 6963  t[behavior_polic
-00042470: 795d 5b65 7661 6c5f 706f 6c69 6379 5d5b  y][eval_policy][
-00042480: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00042490: 2020 2020 2020 2020 2020 2020 2065 7374               est
-000424a0: 696d 6174 6f72 0a20 2020 2020 2020 2020  imator.         
-000424b0: 2020 2020 2020 2020 2020 2020 2020 205d                 ]
-000424c0: 203d 2070 6f6c 6963 795f 7661 6c75 650a   = policy_value.
-000424d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000424e0: 2020 2020 206f 6e5f 706f 6c69 6379 203d       on_policy =
-000424f0: 2069 6e70 7574 5f64 6963 745f 305b 6576   input_dict_0[ev
-00042500: 616c 5f70 6f6c 6963 795d 5b22 6f6e 5f70  al_policy]["on_p
-00042510: 6f6c 6963 795f 706f 6c69 6379 5f76 616c  olicy_policy_val
-00042520: 7565 225d 0a0a 2020 2020 2020 2020 2020  ue"]..          
-00042530: 2020 2020 2020 2020 2020 6966 206f 6e5f            if on_
-00042540: 706f 6c69 6379 2069 7320 6e6f 7420 4e6f  policy is not No
-00042550: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-00042560: 2020 2020 2020 2020 2020 2020 706f 6c69              poli
-00042570: 6379 5f76 616c 7565 5f64 6963 745b 6265  cy_value_dict[be
-00042580: 6861 7669 6f72 5f70 6f6c 6963 795d 5b65  havior_policy][e
-00042590: 7661 6c5f 706f 6c69 6379 5d5b 0a20 2020  val_policy][.   
-000425a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000425b0: 2020 2020 2020 2020 2022 6f6e 5f70 6f6c           "on_pol
-000425c0: 6963 7922 0a20 2020 2020 2020 2020 2020  icy".           
-000425d0: 2020 2020 2020 2020 2020 2020 205d 203d               ] =
-000425e0: 206f 6e5f 706f 6c69 6379 2e6d 6561 6e28   on_policy.mean(
-000425f0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00042600: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-00042610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042620: 2020 2020 706f 6c69 6379 5f76 616c 7565      policy_value
-00042630: 5f64 6963 745b 6265 6861 7669 6f72 5f70  _dict[behavior_p
-00042640: 6f6c 6963 795d 5b65 7661 6c5f 706f 6c69  olicy][eval_poli
-00042650: 6379 5d5b 0a20 2020 2020 2020 2020 2020  cy][.           
-00042660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042670: 2022 6f6e 5f70 6f6c 6963 7922 0a20 2020   "on_policy".   
-00042680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042690: 2020 2020 205d 203d 204e 6f6e 650a 0a20       ] = None.. 
-000426a0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-000426b0: 2020 2020 2020 2020 2070 6f6c 6963 795f           policy_
-000426c0: 7661 6c75 655f 6469 6374 203d 2064 6566  value_dict = def
-000426d0: 6175 6c74 6469 6374 2864 6963 7429 0a0a  aultdict(dict)..
-000426e0: 2020 2020 2020 2020 2020 2020 696e 7075              inpu
-000426f0: 745f 6469 6374 5f30 203d 2069 6e70 7574  t_dict_0 = input
-00042700: 5f64 6963 742e 6765 7428 0a20 2020 2020  _dict.get(.     
-00042710: 2020 2020 2020 2020 2020 2062 6568 6176             behav
-00042720: 696f 725f 706f 6c69 6379 5f6e 616d 653d  ior_policy_name=
-00042730: 6265 6861 7669 6f72 5f70 6f6c 6963 795f  behavior_policy_
-00042740: 6e61 6d65 2c20 6461 7461 7365 745f 6964  name, dataset_id
-00042750: 3d30 0a20 2020 2020 2020 2020 2020 2029  =0.            )
-00042760: 0a20 2020 2020 2020 2020 2020 206e 5f64  .            n_d
-00042770: 6174 6173 6574 7320 3d20 696e 7075 745f  atasets = input_
-00042780: 6469 6374 2e6e 5f64 6174 6173 6574 735b  dict.n_datasets[
-00042790: 6265 6861 7669 6f72 5f70 6f6c 6963 795f  behavior_policy_
-000427a0: 6e61 6d65 5d0a 0a20 2020 2020 2020 2020  name]..         
-000427b0: 2020 2066 6f72 2065 7661 6c5f 706f 6c69     for eval_poli
-000427c0: 6379 2069 6e20 696e 7075 745f 6469 6374  cy in input_dict
-000427d0: 5f30 2e6b 6579 7328 293a 0a20 2020 2020  _0.keys():.     
-000427e0: 2020 2020 2020 2020 2020 2066 6f72 2065             for e
-000427f0: 7374 696d 6174 6f72 2069 6e20 636f 6d70  stimator in comp
-00042800: 6172 6564 5f65 7374 696d 6174 6f72 733a  ared_estimators:
-00042810: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00042820: 2020 2020 2070 6f6c 6963 795f 7661 6c75       policy_valu
-00042830: 6520 3d20 6e70 2e7a 6572 6f73 2828 6e5f  e = np.zeros((n_
-00042840: 6461 7461 7365 7473 2c29 290a 2020 2020  datasets,)).    
-00042850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042860: 666f 7220 6461 7461 7365 745f 6964 5f20  for dataset_id_ 
-00042870: 696e 2072 616e 6765 286e 5f64 6174 6173  in range(n_datas
-00042880: 6574 7329 3a0a 2020 2020 2020 2020 2020  ets):.          
-00042890: 2020 2020 2020 2020 2020 2020 2020 706f                po
-000428a0: 6c69 6379 5f76 616c 7565 5b64 6174 6173  licy_value[datas
-000428b0: 6574 5f69 645f 5d20 3d20 706f 6c69 6379  et_id_] = policy
-000428c0: 5f76 616c 7565 5f64 6963 745f 5b64 6174  _value_dict_[dat
-000428d0: 6173 6574 5f69 645f 5d5b 0a20 2020 2020  aset_id_][.     
-000428e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000428f0: 2020 2020 2020 2065 7661 6c5f 706f 6c69         eval_poli
-00042900: 6379 0a20 2020 2020 2020 2020 2020 2020  cy.             
-00042910: 2020 2020 2020 2020 2020 205d 5b65 7374             ][est
-00042920: 696d 6174 6f72 5d0a 0a20 2020 2020 2020  imator]..       
-00042930: 2020 2020 2020 2020 2020 2020 2070 6f6c               pol
-00042940: 6963 795f 7661 6c75 655f 6469 6374 5b65  icy_value_dict[e
-00042950: 7661 6c5f 706f 6c69 6379 5d5b 6573 7469  val_policy][esti
-00042960: 6d61 746f 725d 203d 2070 6f6c 6963 795f  mator] = policy_
-00042970: 7661 6c75 650a 0a20 2020 2020 2020 2020  value..         
-00042980: 2020 2020 2020 206f 6e5f 706f 6c69 6379         on_policy
-00042990: 203d 2069 6e70 7574 5f64 6963 745f 305b   = input_dict_0[
-000429a0: 6576 616c 5f70 6f6c 6963 795d 5b22 6f6e  eval_policy]["on
-000429b0: 5f70 6f6c 6963 795f 706f 6c69 6379 5f76  _policy_policy_v
-000429c0: 616c 7565 225d 0a0a 2020 2020 2020 2020  alue"]..        
-000429d0: 2020 2020 2020 2020 6966 206f 6e5f 706f          if on_po
-000429e0: 6c69 6379 2069 7320 6e6f 7420 4e6f 6e65  licy is not None
-000429f0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00042a00: 2020 2020 2020 706f 6c69 6379 5f76 616c        policy_val
-00042a10: 7565 5f64 6963 745b 6576 616c 5f70 6f6c  ue_dict[eval_pol
-00042a20: 6963 795d 5b22 6f6e 5f70 6f6c 6963 7922  icy]["on_policy"
-00042a30: 5d20 3d20 6f6e 5f70 6f6c 6963 792e 6d65  ] = on_policy.me
-00042a40: 616e 2829 0a20 2020 2020 2020 2020 2020  an().           
-00042a50: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00042a60: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00042a70: 6f6c 6963 795f 7661 6c75 655f 6469 6374  olicy_value_dict
-00042a80: 5b65 7661 6c5f 706f 6c69 6379 5d5b 226f  [eval_policy]["o
-00042a90: 6e5f 706f 6c69 6379 225d 203d 204e 6f6e  n_policy"] = Non
-00042aa0: 650a 0a20 2020 2020 2020 2070 6f6c 6963  e..        polic
-00042ab0: 795f 7661 6c75 655f 6469 6374 203d 2064  y_value_dict = d
-00042ac0: 6566 6175 6c74 6469 6374 5f74 6f5f 6469  efaultdict_to_di
-00042ad0: 6374 2870 6f6c 6963 795f 7661 6c75 655f  ct(policy_value_
-00042ae0: 6469 6374 290a 0a20 2020 2020 2020 2073  dict)..        s
-00042af0: 656c 662e 5f76 6973 7561 6c69 7a65 5f6f  elf._visualize_o
-00042b00: 6666 5f70 6f6c 6963 795f 6573 7469 6d61  ff_policy_estima
-00042b10: 7465 735f 7769 7468 5f6d 756c 7469 706c  tes_with_multipl
-00042b20: 655f 6573 7469 6d61 7465 7328 0a20 2020  e_estimates(.   
-00042b30: 2020 2020 2020 2020 2069 6e70 7574 5f64           input_d
-00042b40: 6963 743d 696e 7075 745f 6469 6374 2c0a  ict=input_dict,.
-00042b50: 2020 2020 2020 2020 2020 2020 6573 7469              esti
-00042b60: 6d61 7469 6f6e 5f64 6963 743d 706f 6c69  mation_dict=poli
-00042b70: 6379 5f76 616c 7565 5f64 6963 742c 0a20  cy_value_dict,. 
-00042b80: 2020 2020 2020 2020 2020 2063 6f6d 7061             compa
-00042b90: 7265 645f 6573 7469 6d61 746f 7273 3d63  red_estimators=c
-00042ba0: 6f6d 7061 7265 645f 6573 7469 6d61 746f  ompared_estimato
-00042bb0: 7273 2c0a 2020 2020 2020 2020 2020 2020  rs,.            
-00042bc0: 6265 6861 7669 6f72 5f70 6f6c 6963 795f  behavior_policy_
-00042bd0: 6e61 6d65 3d62 6568 6176 696f 725f 706f  name=behavior_po
-00042be0: 6c69 6379 5f6e 616d 652c 0a20 2020 2020  licy_name,.     
-00042bf0: 2020 2020 2020 2079 6c61 6265 6c3d 2245         ylabel="E
-00042c00: 7374 696d 6174 6564 2050 6f6c 6963 7920  stimated Policy 
-00042c10: 5661 6c75 6522 2c0a 2020 2020 2020 2020  Value",.        
-00042c20: 2020 2020 706c 6f74 5f74 7970 653d 706c      plot_type=pl
-00042c30: 6f74 5f74 7970 652c 0a20 2020 2020 2020  ot_type,.       
-00042c40: 2020 2020 2068 7565 3d68 7565 2c0a 2020       hue=hue,.  
-00042c50: 2020 2020 2020 2020 2020 6c65 6765 6e64            legend
-00042c60: 3d6c 6567 656e 642c 0a20 2020 2020 2020  =legend,.       
-00042c70: 2020 2020 2073 6861 7265 793d 7368 6172       sharey=shar
-00042c80: 6579 2c0a 2020 2020 2020 2020 2020 2020  ey,.            
-00042c90: 6669 675f 6469 723d 6669 675f 6469 722c  fig_dir=fig_dir,
-00042ca0: 0a20 2020 2020 2020 2020 2020 2066 6967  .            fig
-00042cb0: 5f6e 616d 653d 6669 675f 6e61 6d65 2c0a  _name=fig_name,.
-00042cc0: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
-00042cd0: 6566 2076 6973 7561 6c69 7a65 5f76 6172  ef visualize_var
-00042ce0: 6961 6e63 655f 7769 7468 5f6d 756c 7469  iance_with_multi
-00042cf0: 706c 655f 6573 7469 6d61 7465 7328 0a20  ple_estimates(. 
-00042d00: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-00042d10: 2020 2020 2069 6e70 7574 5f64 6963 743a       input_dict:
-00042d20: 204d 756c 7469 706c 6549 6e70 7574 4469   MultipleInputDi
-00042d30: 6374 2c0a 2020 2020 2020 2020 636f 6d70  ct,.        comp
-00042d40: 6172 6564 5f65 7374 696d 6174 6f72 733a  ared_estimators:
-00042d50: 204f 7074 696f 6e61 6c5b 4c69 7374 5b73   Optional[List[s
-00042d60: 7472 5d5d 203d 204e 6f6e 652c 0a20 2020  tr]] = None,.   
-00042d70: 2020 2020 2062 6568 6176 696f 725f 706f       behavior_po
-00042d80: 6c69 6379 5f6e 616d 653a 204f 7074 696f  licy_name: Optio
-00042d90: 6e61 6c5b 7374 725d 203d 204e 6f6e 652c  nal[str] = None,
-00042da0: 0a20 2020 2020 2020 2070 6c6f 745f 7479  .        plot_ty
-00042db0: 7065 3a20 7374 7220 3d20 2263 6922 2c0a  pe: str = "ci",.
-00042dc0: 2020 2020 2020 2020 6875 653a 2073 7472          hue: str
-00042dd0: 203d 2022 6573 7469 6d61 746f 7222 2c0a   = "estimator",.
-00042de0: 2020 2020 2020 2020 6c65 6765 6e64 3a20          legend: 
-00042df0: 626f 6f6c 203d 2054 7275 652c 0a20 2020  bool = True,.   
-00042e00: 2020 2020 2073 6861 7265 793a 2062 6f6f       sharey: boo
-00042e10: 6c20 3d20 4661 6c73 652c 0a20 2020 2020  l = False,.     
-00042e20: 2020 2066 6967 5f64 6972 3a20 4f70 7469     fig_dir: Opti
-00042e30: 6f6e 616c 5b50 6174 685d 203d 204e 6f6e  onal[Path] = Non
-00042e40: 652c 0a20 2020 2020 2020 2066 6967 5f6e  e,.        fig_n
-00042e50: 616d 653a 2073 7472 203d 2022 6573 7469  ame: str = "esti
-00042e60: 6d61 7465 645f 7661 7269 616e 6365 5f6d  mated_variance_m
-00042e70: 756c 7469 706c 652e 706e 6722 2c0a 2020  ultiple.png",.  
-00042e80: 2020 2920 2d3e 204e 6f6e 653a 0a20 2020    ) -> None:.   
-00042e90: 2020 2020 2022 2222 5669 7375 616c 697a       """Visualiz
-00042ea0: 6520 7468 6520 7661 7269 616e 6365 206f  e the variance o
-00042eb0: 6620 7468 6520 7472 616a 6563 746f 7279  f the trajectory
-00042ec0: 2d77 6973 6520 7265 7761 7264 2075 6e64  -wise reward und
-00042ed0: 6572 2074 6865 2065 7661 6c75 6174 696f  er the evaluatio
-00042ee0: 6e20 706f 6c69 6379 2065 7374 696d 6174  n policy estimat
-00042ef0: 6564 2062 7920 4f50 4520 6573 7469 6d61  ed by OPE estima
-00042f00: 746f 7273 2061 6372 6f73 7320 6d75 6c74  tors across mult
-00042f10: 6970 6c65 206c 6f67 6765 6420 6461 7461  iple logged data
-00042f20: 7365 742e 0a0a 2020 2020 2020 2020 4e6f  set...        No
-00042f30: 7465 0a20 2020 2020 2020 202d 2d2d 2d2d  te.        -----
-00042f40: 2d2d 0a20 2020 2020 2020 2054 6869 7320  --.        This 
-00042f50: 6675 6e63 7469 6f6e 2069 7320 6170 706c  function is appl
-00042f60: 6963 6162 6c65 206f 6e6c 7920 7768 656e  icable only when
-00042f70: 204d 756c 7469 706c 654c 6f67 6765 6444   MultipleLoggedD
-00042f80: 6174 6173 6574 2069 7320 7573 6564 2061  ataset is used a
-00042f90: 6e64 0a20 2020 2020 2020 204d 756c 7469  nd.        Multi
-00042fa0: 706c 6549 6e70 7574 4469 6374 2069 7320  pleInputDict is 
-00042fb0: 636f 6c6c 6563 7465 6420 6279 2074 6865  collected by the
-00042fc0: 2073 616d 6520 6576 616c 7561 7469 6f6e   same evaluation
-00042fd0: 2070 6f6c 6963 7920 6163 726f 7373 206c   policy across l
-00042fe0: 6f67 6765 6420 6461 7461 7365 7473 2e0a  ogged datasets..
-00042ff0: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
-00043000: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
-00043010: 2d2d 2d0a 2020 2020 2020 2020 696e 7075  ---.        inpu
-00043020: 745f 6469 6374 3a20 4f50 4549 6e70 7574  t_dict: OPEInput
-00043030: 4469 6374 206f 7220 4d75 6c74 6970 6c65  Dict or Multiple
-00043040: 496e 7075 7444 6963 740a 2020 2020 2020  InputDict.      
-00043050: 2020 2020 2020 4469 6374 696f 6e61 7279        Dictionary
-00043060: 206f 6620 7468 6520 4f50 4520 696e 7075   of the OPE inpu
-00043070: 7473 2066 6f72 2065 6163 6820 6576 616c  ts for each eval
-00043080: 7561 7469 6f6e 2070 6f6c 6963 792e 0a0a  uation policy...
-00043090: 2020 2020 2020 2020 2020 2020 2e2e 2063              .. c
-000430a0: 6f64 652d 626c 6f63 6b3a 3a20 7079 7468  ode-block:: pyth
-000430b0: 6f6e 0a0a 2020 2020 2020 2020 2020 2020  on..            
-000430c0: 2020 2020 6b65 793a 205b 6576 616c 7561      key: [evalua
-000430d0: 7469 6f6e 5f70 6f6c 6963 795d 5b0a 2020  tion_policy][.  
-000430e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000430f0: 2020 6576 616c 7561 7469 6f6e 5f70 6f6c    evaluation_pol
-00043100: 6963 795f 6163 7469 6f6e 2c0a 2020 2020  icy_action,.    
+00042410: 206f 6e5f 706f 6c69 6379 203d 2069 6e70   on_policy = inp
+00042420: 7574 5f64 6963 745f 305b 6576 616c 5f70  ut_dict_0[eval_p
+00042430: 6f6c 6963 795d 5b22 6f6e 5f70 6f6c 6963  olicy]["on_polic
+00042440: 795f 706f 6c69 6379 5f76 616c 7565 225d  y_policy_value"]
+00042450: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00042460: 2020 2020 2020 6966 206f 6e5f 706f 6c69        if on_poli
+00042470: 6379 2069 7320 6e6f 7420 4e6f 6e65 3a0a  cy is not None:.
+00042480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00042490: 2020 2020 2020 2020 706f 6c69 6379 5f76          policy_v
+000424a0: 616c 7565 5f64 6963 745b 6265 6861 7669  alue_dict[behavi
+000424b0: 6f72 5f70 6f6c 6963 795d 5b65 7661 6c5f  or_policy][eval_
+000424c0: 706f 6c69 6379 5d5b 0a20 2020 2020 2020  policy][.       
+000424d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000424e0: 2020 2020 2022 6f6e 5f70 6f6c 6963 7922       "on_policy"
+000424f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00042500: 2020 2020 2020 2020 205d 203d 206f 6e5f           ] = on_
+00042510: 706f 6c69 6379 2e6d 6561 6e28 290a 2020  policy.mean().  
+00042520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00042530: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00042540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00042550: 706f 6c69 6379 5f76 616c 7565 5f64 6963  policy_value_dic
+00042560: 745b 6265 6861 7669 6f72 5f70 6f6c 6963  t[behavior_polic
+00042570: 795d 5b65 7661 6c5f 706f 6c69 6379 5d5b  y][eval_policy][
+00042580: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00042590: 2020 2020 2020 2020 2020 2020 2022 6f6e               "on
+000425a0: 5f70 6f6c 6963 7922 0a20 2020 2020 2020  _policy".       
+000425b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000425c0: 205d 203d 204e 6f6e 650a 0a20 2020 2020   ] = None..     
+000425d0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+000425e0: 2020 2020 2070 6f6c 6963 795f 7661 6c75       policy_valu
+000425f0: 655f 6469 6374 203d 2064 6566 6175 6c74  e_dict = default
+00042600: 6469 6374 2864 6963 7429 0a0a 2020 2020  dict(dict)..    
+00042610: 2020 2020 2020 2020 696e 7075 745f 6469          input_di
+00042620: 6374 5f30 203d 2069 6e70 7574 5f64 6963  ct_0 = input_dic
+00042630: 742e 6765 7428 0a20 2020 2020 2020 2020  t.get(.         
+00042640: 2020 2020 2020 2062 6568 6176 696f 725f         behavior_
+00042650: 706f 6c69 6379 5f6e 616d 653d 6265 6861  policy_name=beha
+00042660: 7669 6f72 5f70 6f6c 6963 795f 6e61 6d65  vior_policy_name
+00042670: 2c20 6461 7461 7365 745f 6964 3d30 0a20  , dataset_id=0. 
+00042680: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00042690: 2020 2020 2020 2020 206e 5f64 6174 6173           n_datas
+000426a0: 6574 7320 3d20 696e 7075 745f 6469 6374  ets = input_dict
+000426b0: 2e6e 5f64 6174 6173 6574 735b 6265 6861  .n_datasets[beha
+000426c0: 7669 6f72 5f70 6f6c 6963 795f 6e61 6d65  vior_policy_name
+000426d0: 5d0a 0a20 2020 2020 2020 2020 2020 2066  ]..            f
+000426e0: 6f72 2065 7661 6c5f 706f 6c69 6379 2069  or eval_policy i
+000426f0: 6e20 696e 7075 745f 6469 6374 5f30 2e6b  n input_dict_0.k
+00042700: 6579 7328 293a 0a20 2020 2020 2020 2020  eys():.         
+00042710: 2020 2020 2020 2066 6f72 2065 7374 696d         for estim
+00042720: 6174 6f72 2069 6e20 636f 6d70 6172 6564  ator in compared
+00042730: 5f65 7374 696d 6174 6f72 733a 0a20 2020  _estimators:.   
+00042740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00042750: 2070 6f6c 6963 795f 7661 6c75 6520 3d20   policy_value = 
+00042760: 6e70 2e7a 6572 6f73 2828 6e5f 6461 7461  np.zeros((n_data
+00042770: 7365 7473 2c29 290a 2020 2020 2020 2020  sets,)).        
+00042780: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00042790: 6461 7461 7365 745f 6964 5f20 696e 2072  dataset_id_ in r
+000427a0: 616e 6765 286e 5f64 6174 6173 6574 7329  ange(n_datasets)
+000427b0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000427c0: 2020 2020 2020 2020 2020 706f 6c69 6379            policy
+000427d0: 5f76 616c 7565 5b64 6174 6173 6574 5f69  _value[dataset_i
+000427e0: 645f 5d20 3d20 706f 6c69 6379 5f76 616c  d_] = policy_val
+000427f0: 7565 5f64 6963 745f 5b64 6174 6173 6574  ue_dict_[dataset
+00042800: 5f69 645f 5d5b 0a20 2020 2020 2020 2020  _id_][.         
+00042810: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00042820: 2020 2065 7661 6c5f 706f 6c69 6379 0a20     eval_policy. 
+00042830: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00042840: 2020 2020 2020 205d 5b65 7374 696d 6174         ][estimat
+00042850: 6f72 5d0a 0a20 2020 2020 2020 2020 2020  or]..           
+00042860: 2020 2020 2020 2020 2070 6f6c 6963 795f           policy_
+00042870: 7661 6c75 655f 6469 6374 5b65 7661 6c5f  value_dict[eval_
+00042880: 706f 6c69 6379 5d5b 6573 7469 6d61 746f  policy][estimato
+00042890: 725d 203d 2070 6f6c 6963 795f 7661 6c75  r] = policy_valu
+000428a0: 650a 0a20 2020 2020 2020 2020 2020 2020  e..             
+000428b0: 2020 206f 6e5f 706f 6c69 6379 203d 2069     on_policy = i
+000428c0: 6e70 7574 5f64 6963 745f 305b 6576 616c  nput_dict_0[eval
+000428d0: 5f70 6f6c 6963 795d 5b22 6f6e 5f70 6f6c  _policy]["on_pol
+000428e0: 6963 795f 706f 6c69 6379 5f76 616c 7565  icy_policy_value
+000428f0: 225d 0a0a 2020 2020 2020 2020 2020 2020  "]..            
+00042900: 2020 2020 6966 206f 6e5f 706f 6c69 6379      if on_policy
+00042910: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
+00042920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00042930: 2020 706f 6c69 6379 5f76 616c 7565 5f64    policy_value_d
+00042940: 6963 745b 6576 616c 5f70 6f6c 6963 795d  ict[eval_policy]
+00042950: 5b22 6f6e 5f70 6f6c 6963 7922 5d20 3d20  ["on_policy"] = 
+00042960: 6f6e 5f70 6f6c 6963 792e 6d65 616e 2829  on_policy.mean()
+00042970: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00042980: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00042990: 2020 2020 2020 2020 2020 2070 6f6c 6963             polic
+000429a0: 795f 7661 6c75 655f 6469 6374 5b65 7661  y_value_dict[eva
+000429b0: 6c5f 706f 6c69 6379 5d5b 226f 6e5f 706f  l_policy]["on_po
+000429c0: 6c69 6379 225d 203d 204e 6f6e 650a 0a20  licy"] = None.. 
+000429d0: 2020 2020 2020 2070 6f6c 6963 795f 7661         policy_va
+000429e0: 6c75 655f 6469 6374 203d 2064 6566 6175  lue_dict = defau
+000429f0: 6c74 6469 6374 5f74 6f5f 6469 6374 2870  ltdict_to_dict(p
+00042a00: 6f6c 6963 795f 7661 6c75 655f 6469 6374  olicy_value_dict
+00042a10: 290a 0a20 2020 2020 2020 2073 656c 662e  )..        self.
+00042a20: 5f76 6973 7561 6c69 7a65 5f6f 6666 5f70  _visualize_off_p
+00042a30: 6f6c 6963 795f 6573 7469 6d61 7465 735f  olicy_estimates_
+00042a40: 7769 7468 5f6d 756c 7469 706c 655f 6573  with_multiple_es
+00042a50: 7469 6d61 7465 7328 0a20 2020 2020 2020  timates(.       
+00042a60: 2020 2020 2069 6e70 7574 5f64 6963 743d       input_dict=
+00042a70: 696e 7075 745f 6469 6374 2c0a 2020 2020  input_dict,.    
+00042a80: 2020 2020 2020 2020 6573 7469 6d61 7469          estimati
+00042a90: 6f6e 5f64 6963 743d 706f 6c69 6379 5f76  on_dict=policy_v
+00042aa0: 616c 7565 5f64 6963 742c 0a20 2020 2020  alue_dict,.     
+00042ab0: 2020 2020 2020 2063 6f6d 7061 7265 645f         compared_
+00042ac0: 6573 7469 6d61 746f 7273 3d63 6f6d 7061  estimators=compa
+00042ad0: 7265 645f 6573 7469 6d61 746f 7273 2c0a  red_estimators,.
+00042ae0: 2020 2020 2020 2020 2020 2020 6265 6861              beha
+00042af0: 7669 6f72 5f70 6f6c 6963 795f 6e61 6d65  vior_policy_name
+00042b00: 3d62 6568 6176 696f 725f 706f 6c69 6379  =behavior_policy
+00042b10: 5f6e 616d 652c 0a20 2020 2020 2020 2020  _name,.         
+00042b20: 2020 2079 6c61 6265 6c3d 2245 7374 696d     ylabel="Estim
+00042b30: 6174 6564 2050 6f6c 6963 7920 5661 6c75  ated Policy Valu
+00042b40: 6522 2c0a 2020 2020 2020 2020 2020 2020  e",.            
+00042b50: 706c 6f74 5f74 7970 653d 706c 6f74 5f74  plot_type=plot_t
+00042b60: 7970 652c 0a20 2020 2020 2020 2020 2020  ype,.           
+00042b70: 2068 7565 3d68 7565 2c0a 2020 2020 2020   hue=hue,.      
+00042b80: 2020 2020 2020 6c65 6765 6e64 3d6c 6567        legend=leg
+00042b90: 656e 642c 0a20 2020 2020 2020 2020 2020  end,.           
+00042ba0: 2073 6861 7265 793d 7368 6172 6579 2c0a   sharey=sharey,.
+00042bb0: 2020 2020 2020 2020 2020 2020 6669 675f              fig_
+00042bc0: 6469 723d 6669 675f 6469 722c 0a20 2020  dir=fig_dir,.   
+00042bd0: 2020 2020 2020 2020 2066 6967 5f6e 616d           fig_nam
+00042be0: 653d 6669 675f 6e61 6d65 2c0a 2020 2020  e=fig_name,.    
+00042bf0: 2020 2020 290a 0a20 2020 2064 6566 2076      )..    def v
+00042c00: 6973 7561 6c69 7a65 5f76 6172 6961 6e63  isualize_varianc
+00042c10: 655f 7769 7468 5f6d 756c 7469 706c 655f  e_with_multiple_
+00042c20: 6573 7469 6d61 7465 7328 0a20 2020 2020  estimates(.     
+00042c30: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+00042c40: 2069 6e70 7574 5f64 6963 743a 204d 756c   input_dict: Mul
+00042c50: 7469 706c 6549 6e70 7574 4469 6374 2c0a  tipleInputDict,.
+00042c60: 2020 2020 2020 2020 636f 6d70 6172 6564          compared
+00042c70: 5f65 7374 696d 6174 6f72 733a 204f 7074  _estimators: Opt
+00042c80: 696f 6e61 6c5b 4c69 7374 5b73 7472 5d5d  ional[List[str]]
+00042c90: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
+00042ca0: 2062 6568 6176 696f 725f 706f 6c69 6379   behavior_policy
+00042cb0: 5f6e 616d 653a 204f 7074 696f 6e61 6c5b  _name: Optional[
+00042cc0: 7374 725d 203d 204e 6f6e 652c 0a20 2020  str] = None,.   
+00042cd0: 2020 2020 2070 6c6f 745f 7479 7065 3a20       plot_type: 
+00042ce0: 7374 7220 3d20 2263 6922 2c0a 2020 2020  str = "ci",.    
+00042cf0: 2020 2020 6875 653a 2073 7472 203d 2022      hue: str = "
+00042d00: 6573 7469 6d61 746f 7222 2c0a 2020 2020  estimator",.    
+00042d10: 2020 2020 6c65 6765 6e64 3a20 626f 6f6c      legend: bool
+00042d20: 203d 2054 7275 652c 0a20 2020 2020 2020   = True,.       
+00042d30: 2073 6861 7265 793a 2062 6f6f 6c20 3d20   sharey: bool = 
+00042d40: 4661 6c73 652c 0a20 2020 2020 2020 2066  False,.        f
+00042d50: 6967 5f64 6972 3a20 4f70 7469 6f6e 616c  ig_dir: Optional
+00042d60: 5b50 6174 685d 203d 204e 6f6e 652c 0a20  [Path] = None,. 
+00042d70: 2020 2020 2020 2066 6967 5f6e 616d 653a         fig_name:
+00042d80: 2073 7472 203d 2022 6573 7469 6d61 7465   str = "estimate
+00042d90: 645f 7661 7269 616e 6365 5f6d 756c 7469  d_variance_multi
+00042da0: 706c 652e 706e 6722 2c0a 2020 2020 2920  ple.png",.    ) 
+00042db0: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
+00042dc0: 2022 2222 5669 7375 616c 697a 6520 7468   """Visualize th
+00042dd0: 6520 7661 7269 616e 6365 206f 6620 7468  e variance of th
+00042de0: 6520 7472 616a 6563 746f 7279 2d77 6973  e trajectory-wis
+00042df0: 6520 7265 7761 7264 2075 6e64 6572 2074  e reward under t
+00042e00: 6865 2065 7661 6c75 6174 696f 6e20 706f  he evaluation po
+00042e10: 6c69 6379 2065 7374 696d 6174 6564 2062  licy estimated b
+00042e20: 7920 4f50 4520 6573 7469 6d61 746f 7273  y OPE estimators
+00042e30: 2061 6372 6f73 7320 6d75 6c74 6970 6c65   across multiple
+00042e40: 206c 6f67 6765 6420 6461 7461 7365 742e   logged dataset.
+00042e50: 0a0a 2020 2020 2020 2020 4e6f 7465 0a20  ..        Note. 
+00042e60: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0a20         -------. 
+00042e70: 2020 2020 2020 2054 6869 7320 6675 6e63         This func
+00042e80: 7469 6f6e 2069 7320 6170 706c 6963 6162  tion is applicab
+00042e90: 6c65 206f 6e6c 7920 7768 656e 204d 756c  le only when Mul
+00042ea0: 7469 706c 654c 6f67 6765 6444 6174 6173  tipleLoggedDatas
+00042eb0: 6574 2069 7320 7573 6564 2061 6e64 0a20  et is used and. 
+00042ec0: 2020 2020 2020 204d 756c 7469 706c 6549         MultipleI
+00042ed0: 6e70 7574 4469 6374 2069 7320 636f 6c6c  nputDict is coll
+00042ee0: 6563 7465 6420 6279 2074 6865 2073 616d  ected by the sam
+00042ef0: 6520 6576 616c 7561 7469 6f6e 2070 6f6c  e evaluation pol
+00042f00: 6963 7920 6163 726f 7373 206c 6f67 6765  icy across logge
+00042f10: 6420 6461 7461 7365 7473 2e0a 0a20 2020  d datasets...   
+00042f20: 2020 2020 2050 6172 616d 6574 6572 730a       Parameters.
+00042f30: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0a          -------.
+00042f40: 2020 2020 2020 2020 696e 7075 745f 6469          input_di
+00042f50: 6374 3a20 4f50 4549 6e70 7574 4469 6374  ct: OPEInputDict
+00042f60: 206f 7220 4d75 6c74 6970 6c65 496e 7075   or MultipleInpu
+00042f70: 7444 6963 740a 2020 2020 2020 2020 2020  tDict.          
+00042f80: 2020 4469 6374 696f 6e61 7279 206f 6620    Dictionary of 
+00042f90: 7468 6520 4f50 4520 696e 7075 7473 2066  the OPE inputs f
+00042fa0: 6f72 2065 6163 6820 6576 616c 7561 7469  or each evaluati
+00042fb0: 6f6e 2070 6f6c 6963 792e 0a0a 2020 2020  on policy...    
+00042fc0: 2020 2020 2020 2020 2e2e 2063 6f64 652d          .. code-
+00042fd0: 626c 6f63 6b3a 3a20 7079 7468 6f6e 0a0a  block:: python..
+00042fe0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00042ff0: 6b65 793a 205b 6576 616c 7561 7469 6f6e  key: [evaluation
+00043000: 5f70 6f6c 6963 795d 5b0a 2020 2020 2020  _policy][.      
+00043010: 2020 2020 2020 2020 2020 2020 2020 6576                ev
+00043020: 616c 7561 7469 6f6e 5f70 6f6c 6963 795f  aluation_policy_
+00043030: 6163 7469 6f6e 2c0a 2020 2020 2020 2020  action,.        
+00043040: 2020 2020 2020 2020 2020 2020 6576 616c              eval
+00043050: 7561 7469 6f6e 5f70 6f6c 6963 795f 6163  uation_policy_ac
+00043060: 7469 6f6e 5f64 6973 742c 0a20 2020 2020  tion_dist,.     
+00043070: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+00043080: 7461 7465 5f61 6374 696f 6e5f 7661 6c75  tate_action_valu
+00043090: 655f 7072 6564 6963 7469 6f6e 2c0a 2020  e_prediction,.  
+000430a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000430b0: 2020 696e 6974 6961 6c5f 7374 6174 655f    initial_state_
+000430c0: 7661 6c75 655f 7072 6564 6963 7469 6f6e  value_prediction
+000430d0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000430e0: 2020 2020 2020 7374 6174 655f 6163 7469        state_acti
+000430f0: 6f6e 5f6d 6172 6769 6e61 6c5f 696d 706f  on_marginal_impo
+00043100: 7274 616e 6365 5f77 6569 6768 742c 0a20  rtance_weight,. 
 00043110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043120: 6576 616c 7561 7469 6f6e 5f70 6f6c 6963  evaluation_polic
-00043130: 795f 6163 7469 6f6e 5f64 6973 742c 0a20  y_action_dist,. 
-00043140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043150: 2020 2073 7461 7465 5f61 6374 696f 6e5f     state_action_
-00043160: 7661 6c75 655f 7072 6564 6963 7469 6f6e  value_prediction
-00043170: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00043180: 2020 2020 2020 696e 6974 6961 6c5f 7374        initial_st
-00043190: 6174 655f 7661 6c75 655f 7072 6564 6963  ate_value_predic
-000431a0: 7469 6f6e 2c0a 2020 2020 2020 2020 2020  tion,.          
-000431b0: 2020 2020 2020 2020 2020 7374 6174 655f            state_
-000431c0: 6163 7469 6f6e 5f6d 6172 6769 6e61 6c5f  action_marginal_
-000431d0: 696d 706f 7274 616e 6365 5f77 6569 6768  importance_weigh
-000431e0: 742c 0a20 2020 2020 2020 2020 2020 2020  t,.             
-000431f0: 2020 2020 2020 2073 7461 7465 5f6d 6172         state_mar
-00043200: 6769 6e61 6c5f 696d 706f 7274 616e 6365  ginal_importance
-00043210: 5f77 6569 6768 742c 0a20 2020 2020 2020  _weight,.       
-00043220: 2020 2020 2020 2020 2020 2020 206f 6e5f               on_
-00043230: 706f 6c69 6379 5f70 6f6c 6963 795f 7661  policy_policy_va
-00043240: 6c75 652c 0a20 2020 2020 2020 2020 2020  lue,.           
-00043250: 2020 2020 2020 2020 2067 616d 6d61 2c0a           gamma,.
-00043260: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043270: 2020 2020 6265 6861 7669 6f72 5f70 6f6c      behavior_pol
-00043280: 6963 792c 0a20 2020 2020 2020 2020 2020  icy,.           
-00043290: 2020 2020 2020 2020 2065 7661 6c75 6174           evaluat
-000432a0: 696f 6e5f 706f 6c69 6379 2c0a 2020 2020  ion_policy,.    
-000432b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000432c0: 6461 7461 7365 745f 6964 2c0a 2020 2020  dataset_id,.    
-000432d0: 2020 2020 2020 2020 2020 2020 5d0a 0a20              ].. 
-000432e0: 2020 2020 2020 2020 2020 202e 2e20 7365             .. se
-000432f0: 6561 6c73 6f3a 3a0a 0a20 2020 2020 2020  ealso::..       
-00043300: 2020 2020 2020 2020 203a 636c 6173 733a           :class:
-00043310: 6073 636f 7065 5f72 6c2e 6f70 652e 696e  `scope_rl.ope.in
-00043320: 7075 742e 4372 6561 7465 4f50 4549 6e70  put.CreateOPEInp
-00043330: 7574 6020 6465 7363 7269 6265 7320 7468  ut` describes th
-00043340: 6520 636f 6d70 6f6e 656e 7473 206f 6620  e components of 
-00043350: 3a63 6c61 7373 3a60 696e 7075 745f 6469  :class:`input_di
-00043360: 6374 602e 0a0a 2020 2020 2020 2020 636f  ct`...        co
-00043370: 6d70 6172 6564 5f65 7374 696d 6174 6f72  mpared_estimator
-00043380: 733a 206c 6973 7420 6f66 2073 7472 2c20  s: list of str, 
-00043390: 6465 6661 756c 743d 4e6f 6e65 0a20 2020  default=None.   
-000433a0: 2020 2020 2020 2020 204e 616d 6520 6f66           Name of
-000433b0: 2063 6f6d 7061 7265 6420 6573 7469 6d61   compared estima
-000433c0: 746f 7273 2e0a 2020 2020 2020 2020 2020  tors..          
-000433d0: 2020 4966 2060 4e6f 6e65 6020 6973 2067    If `None` is g
-000433e0: 6976 656e 2c20 616c 6c20 7468 6520 6573  iven, all the es
-000433f0: 7469 6d61 746f 7273 2061 7265 2063 6f6d  timators are com
-00043400: 7061 7265 642e 0a0a 2020 2020 2020 2020  pared...        
-00043410: 6265 6861 7669 6f72 5f70 6f6c 6963 795f  behavior_policy_
-00043420: 6e61 6d65 3a20 7374 722c 2064 6566 6175  name: str, defau
-00043430: 6c74 3d4e 6f6e 650a 2020 2020 2020 2020  lt=None.        
-00043440: 2020 2020 4e61 6d65 206f 6620 7468 6520      Name of the 
-00043450: 6265 6861 7669 6f72 2070 6f6c 6963 792e  behavior policy.
-00043460: 0a0a 2020 2020 2020 2020 706c 6f74 5f74  ..        plot_t
-00043470: 7970 653a 207b 2263 6922 2c20 2273 6361  ype: {"ci", "sca
-00043480: 7474 6572 222c 2022 7669 6f6c 696e 227d  tter", "violin"}
-00043490: 2c20 6465 6661 756c 743d 2263 6922 0a20  , default="ci". 
-000434a0: 2020 2020 2020 2020 2020 2054 7970 6520             Type 
-000434b0: 6f66 2070 6c6f 742e 0a20 2020 2020 2020  of plot..       
-000434c0: 2020 2020 2049 6620 2263 6922 2069 7320       If "ci" is 
-000434d0: 6769 7665 6e2c 2077 6520 6765 7420 7468  given, we get th
-000434e0: 6520 656d 7069 7269 6361 6c20 6176 6572  e empirical aver
-000434f0: 6167 6520 6f66 2074 6865 2065 7374 696d  age of the estim
-00043500: 6174 6564 2076 616c 7565 7320 7769 7468  ated values with
-00043510: 2074 6865 6972 2065 7374 696d 6174 6564   their estimated
-00043520: 2063 6f6e 6669 6465 6e63 6520 696e 7465   confidence inte
-00043530: 7276 616c 732e 0a20 2020 2020 2020 2020  rvals..         
-00043540: 2020 2049 6620 2273 6361 7474 6572 2220     If "scatter" 
-00043550: 6973 2067 6976 656e 2c20 7765 2067 6574  is given, we get
-00043560: 2061 2073 6361 7474 6572 2070 6c6f 7420   a scatter plot 
-00043570: 6f66 2065 7374 696d 6174 6564 2076 616c  of estimated val
-00043580: 7565 732e 0a0a 2020 2020 2020 2020 6875  ues...        hu
-00043590: 653a 207b 2265 7374 696d 6174 6f72 222c  e: {"estimator",
-000435a0: 2022 706f 6c69 6379 227d 2c20 6465 6661   "policy"}, defa
-000435b0: 756c 743d 2265 7374 696d 6174 6f72 220a  ult="estimator".
-000435c0: 2020 2020 2020 2020 2020 2020 4875 6520              Hue 
-000435d0: 6f66 2074 6865 2070 6c6f 742e 0a0a 2020  of the plot...  
-000435e0: 2020 2020 2020 6c65 6765 6e64 3a20 626f        legend: bo
-000435f0: 6f6c 2c20 6465 6661 756c 743d 5472 7565  ol, default=True
-00043600: 0a20 2020 2020 2020 2020 2020 2057 6865  .            Whe
-00043610: 7468 6572 2074 6f20 696e 636c 7564 6520  ther to include 
-00043620: 6120 6c65 6765 6e64 2069 6e20 7468 6520  a legend in the 
-00043630: 7363 6174 7465 7220 706c 6f74 2e0a 0a20  scatter plot... 
-00043640: 2020 2020 2020 2073 6861 7265 793a 2062         sharey: b
-00043650: 6f6f 6c2c 2064 6566 6175 6c74 3d46 616c  ool, default=Fal
-00043660: 7365 0a20 2020 2020 2020 2020 2020 2049  se.            I
-00043670: 6620 6054 7275 6560 2c20 7468 6520 792d  f `True`, the y-
-00043680: 6178 6973 2077 696c 6c20 6265 2073 6861  axis will be sha
-00043690: 7265 6420 616d 6f6e 6720 6469 6666 6572  red among differ
-000436a0: 656e 7420 6573 7469 6d61 746f 7273 206f  ent estimators o
-000436b0: 7220 6576 616c 7561 7469 6f6e 2070 6f6c  r evaluation pol
-000436c0: 6963 6965 732e 0a0a 2020 2020 2020 2020  icies...        
-000436d0: 6669 675f 6469 723a 2050 6174 682c 2064  fig_dir: Path, d
-000436e0: 6566 6175 6c74 3d4e 6f6e 650a 2020 2020  efault=None.    
-000436f0: 2020 2020 2020 2020 5061 7468 2074 6f20          Path to 
-00043700: 7374 6f72 6520 7468 6520 6261 7220 6669  store the bar fi
-00043710: 6775 7265 2e0a 2020 2020 2020 2020 2020  gure..          
-00043720: 2020 4966 2060 4e6f 6e65 6020 6973 2067    If `None` is g
-00043730: 6976 656e 2c20 7468 6520 6669 6775 7265  iven, the figure
-00043740: 2077 696c 6c20 6e6f 7420 6265 2073 6176   will not be sav
-00043750: 6564 2e0a 0a20 2020 2020 2020 2066 6967  ed...        fig
-00043760: 5f6e 616d 653a 2073 7472 2c20 6465 6661  _name: str, defa
-00043770: 756c 743d 2265 7374 696d 6174 6564 5f76  ult="estimated_v
-00043780: 6172 6961 6e63 655f 6d75 6c74 6970 6c65  ariance_multiple
-00043790: 2e70 6e67 220a 2020 2020 2020 2020 2020  .png".          
-000437a0: 2020 4e61 6d65 206f 6620 7468 6520 6261    Name of the ba
-000437b0: 7220 6669 6775 7265 2e0a 0a20 2020 2020  r figure...     
-000437c0: 2020 2022 2222 0a20 2020 2020 2020 2063     """.        c
-000437d0: 6f6d 7061 7265 645f 6573 7469 6d61 746f  ompared_estimato
-000437e0: 7273 203d 2073 656c 662e 5f63 6865 636b  rs = self._check
-000437f0: 5f63 6f6d 7061 7265 645f 6573 7469 6d61  _compared_estima
-00043800: 746f 7273 2863 6f6d 7061 7265 645f 6573  tors(compared_es
-00043810: 7469 6d61 746f 7273 290a 2020 2020 2020  timators).      
-00043820: 2020 7365 6c66 2e5f 6368 6563 6b5f 6261    self._check_ba
-00043830: 7369 635f 7669 7375 616c 697a 6174 696f  sic_visualizatio
-00043840: 6e5f 696e 7075 7473 280a 2020 2020 2020  n_inputs(.      
-00043850: 2020 2020 2020 6875 653d 6875 652c 2066        hue=hue, f
-00043860: 6967 5f64 6972 3d66 6967 5f64 6972 2c20  ig_dir=fig_dir, 
-00043870: 6669 675f 6e61 6d65 3d66 6967 5f6e 616d  fig_name=fig_nam
-00043880: 650a 2020 2020 2020 2020 290a 2020 2020  e.        ).    
-00043890: 2020 2020 7365 6c66 2e5f 6368 6563 6b5f      self._check_
-000438a0: 696e 7075 745f 6469 6374 5f66 6f72 5f76  input_dict_for_v
-000438b0: 6973 7561 6c69 7a65 5f6d 756c 7469 706c  isualize_multipl
-000438c0: 655f 6573 7469 6d61 7465 7328 696e 7075  e_estimates(inpu
-000438d0: 745f 6469 6374 290a 0a20 2020 2020 2020  t_dict)..       
-000438e0: 2069 6620 6c65 6e28 696e 7075 745f 6469   if len(input_di
-000438f0: 6374 2e62 6568 6176 696f 725f 706f 6c69  ct.behavior_poli
-00043900: 6379 5f6e 616d 6573 2920 3d3d 2031 3a0a  cy_names) == 1:.
-00043910: 2020 2020 2020 2020 2020 2020 6265 6861              beha
-00043920: 7669 6f72 5f70 6f6c 6963 795f 6e61 6d65  vior_policy_name
-00043930: 203d 2069 6e70 7574 5f64 6963 742e 6265   = input_dict.be
-00043940: 6861 7669 6f72 5f70 6f6c 6963 795f 6e61  havior_policy_na
-00043950: 6d65 735b 305d 0a0a 2020 2020 2020 2020  mes[0]..        
-00043960: 7661 7269 616e 6365 5f64 6963 745f 203d  variance_dict_ =
-00043970: 2073 656c 662e 6573 7469 6d61 7465 5f76   self.estimate_v
-00043980: 6172 6961 6e63 6528 0a20 2020 2020 2020  ariance(.       
-00043990: 2020 2020 2069 6e70 7574 5f64 6963 743d       input_dict=
-000439a0: 696e 7075 745f 6469 6374 2c0a 2020 2020  input_dict,.    
-000439b0: 2020 2020 2020 2020 636f 6d70 6172 6564          compared
-000439c0: 5f65 7374 696d 6174 6f72 733d 636f 6d70  _estimators=comp
-000439d0: 6172 6564 5f65 7374 696d 6174 6f72 732c  ared_estimators,
-000439e0: 0a20 2020 2020 2020 2020 2020 2062 6568  .            beh
-000439f0: 6176 696f 725f 706f 6c69 6379 5f6e 616d  avior_policy_nam
-00043a00: 653d 6265 6861 7669 6f72 5f70 6f6c 6963  e=behavior_polic
-00043a10: 795f 6e61 6d65 2c0a 2020 2020 2020 2020  y_name,.        
-00043a20: 290a 0a20 2020 2020 2020 2069 6620 6265  )..        if be
-00043a30: 6861 7669 6f72 5f70 6f6c 6963 795f 6e61  havior_policy_na
-00043a40: 6d65 2069 7320 4e6f 6e65 3a0a 2020 2020  me is None:.    
-00043a50: 2020 2020 2020 2020 7661 7269 616e 6365          variance
-00043a60: 5f64 6963 7420 3d20 6465 6661 756c 7464  _dict = defaultd
-00043a70: 6963 7428 6c61 6d62 6461 3a20 6465 6661  ict(lambda: defa
-00043a80: 756c 7464 6963 7428 6469 6374 2929 0a0a  ultdict(dict))..
-00043a90: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00043aa0: 6265 6861 7669 6f72 5f70 6f6c 6963 792c  behavior_policy,
-00043ab0: 206e 5f64 6174 6173 6574 7320 696e 2069   n_datasets in i
-00043ac0: 6e70 7574 5f64 6963 742e 6e5f 6461 7461  nput_dict.n_data
-00043ad0: 7365 7473 2e69 7465 6d73 2829 3a0a 2020  sets.items():.  
-00043ae0: 2020 2020 2020 2020 2020 2020 2020 696e                in
-00043af0: 7075 745f 6469 6374 5f30 203d 2069 6e70  put_dict_0 = inp
-00043b00: 7574 5f64 6963 742e 6765 7428 0a20 2020  ut_dict.get(.   
-00043b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043b20: 2062 6568 6176 696f 725f 706f 6c69 6379   behavior_policy
-00043b30: 5f6e 616d 653d 6265 6861 7669 6f72 5f70  _name=behavior_p
-00043b40: 6f6c 6963 792c 2064 6174 6173 6574 5f69  olicy, dataset_i
-00043b50: 643d 300a 2020 2020 2020 2020 2020 2020  d=0.            
-00043b60: 2020 2020 290a 0a20 2020 2020 2020 2020      )..         
-00043b70: 2020 2020 2020 2066 6f72 2065 7661 6c5f         for eval_
-00043b80: 706f 6c69 6379 2069 6e20 696e 7075 745f  policy in input_
-00043b90: 6469 6374 5f30 2e6b 6579 7328 293a 0a20  dict_0.keys():. 
-00043ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043bb0: 2020 2066 6f72 2065 7374 696d 6174 6f72     for estimator
-00043bc0: 2069 6e20 636f 6d70 6172 6564 5f65 7374   in compared_est
-00043bd0: 696d 6174 6f72 733a 0a20 2020 2020 2020  imators:.       
+00043120: 2020 2073 7461 7465 5f6d 6172 6769 6e61     state_margina
+00043130: 6c5f 696d 706f 7274 616e 6365 5f77 6569  l_importance_wei
+00043140: 6768 742c 0a20 2020 2020 2020 2020 2020  ght,.           
+00043150: 2020 2020 2020 2020 206f 6e5f 706f 6c69           on_poli
+00043160: 6379 5f70 6f6c 6963 795f 7661 6c75 652c  cy_policy_value,
+00043170: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00043180: 2020 2020 2067 616d 6d61 2c0a 2020 2020       gamma,.    
+00043190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000431a0: 6265 6861 7669 6f72 5f70 6f6c 6963 792c  behavior_policy,
+000431b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000431c0: 2020 2020 2065 7661 6c75 6174 696f 6e5f       evaluation_
+000431d0: 706f 6c69 6379 2c0a 2020 2020 2020 2020  policy,.        
+000431e0: 2020 2020 2020 2020 2020 2020 6461 7461              data
+000431f0: 7365 745f 6964 2c0a 2020 2020 2020 2020  set_id,.        
+00043200: 2020 2020 2020 2020 5d0a 0a20 2020 2020          ]..     
+00043210: 2020 2020 2020 202e 2e20 7365 6561 6c73         .. seeals
+00043220: 6f3a 3a0a 0a20 2020 2020 2020 2020 2020  o::..           
+00043230: 2020 2020 203a 636c 6173 733a 6073 636f       :class:`sco
+00043240: 7065 5f72 6c2e 6f70 652e 696e 7075 742e  pe_rl.ope.input.
+00043250: 4372 6561 7465 4f50 4549 6e70 7574 6020  CreateOPEInput` 
+00043260: 6465 7363 7269 6265 7320 7468 6520 636f  describes the co
+00043270: 6d70 6f6e 656e 7473 206f 6620 3a63 6c61  mponents of :cla
+00043280: 7373 3a60 696e 7075 745f 6469 6374 602e  ss:`input_dict`.
+00043290: 0a0a 2020 2020 2020 2020 636f 6d70 6172  ..        compar
+000432a0: 6564 5f65 7374 696d 6174 6f72 733a 206c  ed_estimators: l
+000432b0: 6973 7420 6f66 2073 7472 2c20 6465 6661  ist of str, defa
+000432c0: 756c 743d 4e6f 6e65 0a20 2020 2020 2020  ult=None.       
+000432d0: 2020 2020 204e 616d 6520 6f66 2063 6f6d       Name of com
+000432e0: 7061 7265 6420 6573 7469 6d61 746f 7273  pared estimators
+000432f0: 2e0a 2020 2020 2020 2020 2020 2020 4966  ..            If
+00043300: 2060 4e6f 6e65 6020 6973 2067 6976 656e   `None` is given
+00043310: 2c20 616c 6c20 7468 6520 6573 7469 6d61  , all the estima
+00043320: 746f 7273 2061 7265 2063 6f6d 7061 7265  tors are compare
+00043330: 642e 0a0a 2020 2020 2020 2020 6265 6861  d...        beha
+00043340: 7669 6f72 5f70 6f6c 6963 795f 6e61 6d65  vior_policy_name
+00043350: 3a20 7374 722c 2064 6566 6175 6c74 3d4e  : str, default=N
+00043360: 6f6e 650a 2020 2020 2020 2020 2020 2020  one.            
+00043370: 4e61 6d65 206f 6620 7468 6520 6265 6861  Name of the beha
+00043380: 7669 6f72 2070 6f6c 6963 792e 0a0a 2020  vior policy...  
+00043390: 2020 2020 2020 706c 6f74 5f74 7970 653a        plot_type:
+000433a0: 207b 2263 6922 2c20 2273 6361 7474 6572   {"ci", "scatter
+000433b0: 222c 2022 7669 6f6c 696e 227d 2c20 6465  ", "violin"}, de
+000433c0: 6661 756c 743d 2263 6922 0a20 2020 2020  fault="ci".     
+000433d0: 2020 2020 2020 2054 7970 6520 6f66 2070         Type of p
+000433e0: 6c6f 742e 0a20 2020 2020 2020 2020 2020  lot..           
+000433f0: 2049 6620 2263 6922 2069 7320 6769 7665   If "ci" is give
+00043400: 6e2c 2077 6520 6765 7420 7468 6520 656d  n, we get the em
+00043410: 7069 7269 6361 6c20 6176 6572 6167 6520  pirical average 
+00043420: 6f66 2074 6865 2065 7374 696d 6174 6564  of the estimated
+00043430: 2076 616c 7565 7320 7769 7468 2074 6865   values with the
+00043440: 6972 2065 7374 696d 6174 6564 2063 6f6e  ir estimated con
+00043450: 6669 6465 6e63 6520 696e 7465 7276 616c  fidence interval
+00043460: 732e 0a20 2020 2020 2020 2020 2020 2049  s..            I
+00043470: 6620 2273 6361 7474 6572 2220 6973 2067  f "scatter" is g
+00043480: 6976 656e 2c20 7765 2067 6574 2061 2073  iven, we get a s
+00043490: 6361 7474 6572 2070 6c6f 7420 6f66 2065  catter plot of e
+000434a0: 7374 696d 6174 6564 2076 616c 7565 732e  stimated values.
+000434b0: 0a0a 2020 2020 2020 2020 6875 653a 207b  ..        hue: {
+000434c0: 2265 7374 696d 6174 6f72 222c 2022 706f  "estimator", "po
+000434d0: 6c69 6379 227d 2c20 6465 6661 756c 743d  licy"}, default=
+000434e0: 2265 7374 696d 6174 6f72 220a 2020 2020  "estimator".    
+000434f0: 2020 2020 2020 2020 4875 6520 6f66 2074          Hue of t
+00043500: 6865 2070 6c6f 742e 0a0a 2020 2020 2020  he plot...      
+00043510: 2020 6c65 6765 6e64 3a20 626f 6f6c 2c20    legend: bool, 
+00043520: 6465 6661 756c 743d 5472 7565 0a20 2020  default=True.   
+00043530: 2020 2020 2020 2020 2057 6865 7468 6572           Whether
+00043540: 2074 6f20 696e 636c 7564 6520 6120 6c65   to include a le
+00043550: 6765 6e64 2069 6e20 7468 6520 7363 6174  gend in the scat
+00043560: 7465 7220 706c 6f74 2e0a 0a20 2020 2020  ter plot...     
+00043570: 2020 2073 6861 7265 793a 2062 6f6f 6c2c     sharey: bool,
+00043580: 2064 6566 6175 6c74 3d46 616c 7365 0a20   default=False. 
+00043590: 2020 2020 2020 2020 2020 2049 6620 6054             If `T
+000435a0: 7275 6560 2c20 7468 6520 792d 6178 6973  rue`, the y-axis
+000435b0: 2077 696c 6c20 6265 2073 6861 7265 6420   will be shared 
+000435c0: 616d 6f6e 6720 6469 6666 6572 656e 7420  among different 
+000435d0: 6573 7469 6d61 746f 7273 206f 7220 6576  estimators or ev
+000435e0: 616c 7561 7469 6f6e 2070 6f6c 6963 6965  aluation policie
+000435f0: 732e 0a0a 2020 2020 2020 2020 6669 675f  s...        fig_
+00043600: 6469 723a 2050 6174 682c 2064 6566 6175  dir: Path, defau
+00043610: 6c74 3d4e 6f6e 650a 2020 2020 2020 2020  lt=None.        
+00043620: 2020 2020 5061 7468 2074 6f20 7374 6f72      Path to stor
+00043630: 6520 7468 6520 6261 7220 6669 6775 7265  e the bar figure
+00043640: 2e0a 2020 2020 2020 2020 2020 2020 4966  ..            If
+00043650: 2060 4e6f 6e65 6020 6973 2067 6976 656e   `None` is given
+00043660: 2c20 7468 6520 6669 6775 7265 2077 696c  , the figure wil
+00043670: 6c20 6e6f 7420 6265 2073 6176 6564 2e0a  l not be saved..
+00043680: 0a20 2020 2020 2020 2066 6967 5f6e 616d  .        fig_nam
+00043690: 653a 2073 7472 2c20 6465 6661 756c 743d  e: str, default=
+000436a0: 2265 7374 696d 6174 6564 5f76 6172 6961  "estimated_varia
+000436b0: 6e63 655f 6d75 6c74 6970 6c65 2e70 6e67  nce_multiple.png
+000436c0: 220a 2020 2020 2020 2020 2020 2020 4e61  ".            Na
+000436d0: 6d65 206f 6620 7468 6520 6261 7220 6669  me of the bar fi
+000436e0: 6775 7265 2e0a 0a20 2020 2020 2020 2022  gure...        "
+000436f0: 2222 0a20 2020 2020 2020 2063 6f6d 7061  "".        compa
+00043700: 7265 645f 6573 7469 6d61 746f 7273 203d  red_estimators =
+00043710: 2073 656c 662e 5f63 6865 636b 5f63 6f6d   self._check_com
+00043720: 7061 7265 645f 6573 7469 6d61 746f 7273  pared_estimators
+00043730: 2863 6f6d 7061 7265 645f 6573 7469 6d61  (compared_estima
+00043740: 746f 7273 290a 2020 2020 2020 2020 7365  tors).        se
+00043750: 6c66 2e5f 6368 6563 6b5f 6261 7369 635f  lf._check_basic_
+00043760: 7669 7375 616c 697a 6174 696f 6e5f 696e  visualization_in
+00043770: 7075 7473 280a 2020 2020 2020 2020 2020  puts(.          
+00043780: 2020 6875 653d 6875 652c 2066 6967 5f64    hue=hue, fig_d
+00043790: 6972 3d66 6967 5f64 6972 2c20 6669 675f  ir=fig_dir, fig_
+000437a0: 6e61 6d65 3d66 6967 5f6e 616d 650a 2020  name=fig_name.  
+000437b0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+000437c0: 7365 6c66 2e5f 6368 6563 6b5f 696e 7075  self._check_inpu
+000437d0: 745f 6469 6374 5f66 6f72 5f76 6973 7561  t_dict_for_visua
+000437e0: 6c69 7a65 5f6d 756c 7469 706c 655f 6573  lize_multiple_es
+000437f0: 7469 6d61 7465 7328 696e 7075 745f 6469  timates(input_di
+00043800: 6374 290a 0a20 2020 2020 2020 2069 6620  ct)..        if 
+00043810: 6c65 6e28 696e 7075 745f 6469 6374 2e62  len(input_dict.b
+00043820: 6568 6176 696f 725f 706f 6c69 6379 5f6e  ehavior_policy_n
+00043830: 616d 6573 2920 3d3d 2031 3a0a 2020 2020  ames) == 1:.    
+00043840: 2020 2020 2020 2020 6265 6861 7669 6f72          behavior
+00043850: 5f70 6f6c 6963 795f 6e61 6d65 203d 2069  _policy_name = i
+00043860: 6e70 7574 5f64 6963 742e 6265 6861 7669  nput_dict.behavi
+00043870: 6f72 5f70 6f6c 6963 795f 6e61 6d65 735b  or_policy_names[
+00043880: 305d 0a0a 2020 2020 2020 2020 7661 7269  0]..        vari
+00043890: 616e 6365 5f64 6963 745f 203d 2073 656c  ance_dict_ = sel
+000438a0: 662e 6573 7469 6d61 7465 5f76 6172 6961  f.estimate_varia
+000438b0: 6e63 6528 0a20 2020 2020 2020 2020 2020  nce(.           
+000438c0: 2069 6e70 7574 5f64 6963 743d 696e 7075   input_dict=inpu
+000438d0: 745f 6469 6374 2c0a 2020 2020 2020 2020  t_dict,.        
+000438e0: 2020 2020 636f 6d70 6172 6564 5f65 7374      compared_est
+000438f0: 696d 6174 6f72 733d 636f 6d70 6172 6564  imators=compared
+00043900: 5f65 7374 696d 6174 6f72 732c 0a20 2020  _estimators,.   
+00043910: 2020 2020 2020 2020 2062 6568 6176 696f           behavio
+00043920: 725f 706f 6c69 6379 5f6e 616d 653d 6265  r_policy_name=be
+00043930: 6861 7669 6f72 5f70 6f6c 6963 795f 6e61  havior_policy_na
+00043940: 6d65 2c0a 2020 2020 2020 2020 290a 0a20  me,.        ).. 
+00043950: 2020 2020 2020 2069 6620 6265 6861 7669         if behavi
+00043960: 6f72 5f70 6f6c 6963 795f 6e61 6d65 2069  or_policy_name i
+00043970: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
+00043980: 2020 2020 7661 7269 616e 6365 5f64 6963      variance_dic
+00043990: 7420 3d20 6465 6661 756c 7464 6963 7428  t = defaultdict(
+000439a0: 6c61 6d62 6461 3a20 6465 6661 756c 7464  lambda: defaultd
+000439b0: 6963 7428 6469 6374 2929 0a0a 2020 2020  ict(dict))..    
+000439c0: 2020 2020 2020 2020 666f 7220 6265 6861          for beha
+000439d0: 7669 6f72 5f70 6f6c 6963 792c 206e 5f64  vior_policy, n_d
+000439e0: 6174 6173 6574 7320 696e 2069 6e70 7574  atasets in input
+000439f0: 5f64 6963 742e 6e5f 6461 7461 7365 7473  _dict.n_datasets
+00043a00: 2e69 7465 6d73 2829 3a0a 2020 2020 2020  .items():.      
+00043a10: 2020 2020 2020 2020 2020 696e 7075 745f            input_
+00043a20: 6469 6374 5f30 203d 2069 6e70 7574 5f64  dict_0 = input_d
+00043a30: 6963 742e 6765 7428 0a20 2020 2020 2020  ict.get(.       
+00043a40: 2020 2020 2020 2020 2020 2020 2062 6568               beh
+00043a50: 6176 696f 725f 706f 6c69 6379 5f6e 616d  avior_policy_nam
+00043a60: 653d 6265 6861 7669 6f72 5f70 6f6c 6963  e=behavior_polic
+00043a70: 792c 2064 6174 6173 6574 5f69 643d 300a  y, dataset_id=0.
+00043a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00043a90: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
+00043aa0: 2020 2066 6f72 2065 7661 6c5f 706f 6c69     for eval_poli
+00043ab0: 6379 2069 6e20 696e 7075 745f 6469 6374  cy in input_dict
+00043ac0: 5f30 2e6b 6579 7328 293a 0a20 2020 2020  _0.keys():.     
+00043ad0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00043ae0: 6f72 2065 7374 696d 6174 6f72 2069 6e20  or estimator in 
+00043af0: 636f 6d70 6172 6564 5f65 7374 696d 6174  compared_estimat
+00043b00: 6f72 733a 0a20 2020 2020 2020 2020 2020  ors:.           
+00043b10: 2020 2020 2020 2020 2020 2020 2076 6172               var
+00043b20: 6961 6e63 6520 3d20 6e70 2e7a 6572 6f73  iance = np.zeros
+00043b30: 2828 6e5f 6461 7461 7365 7473 2c29 290a  ((n_datasets,)).
+00043b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00043b50: 2020 2020 2020 2020 666f 7220 6461 7461          for data
+00043b60: 7365 745f 6964 5f20 696e 2072 616e 6765  set_id_ in range
+00043b70: 286e 5f64 6174 6173 6574 7329 3a0a 2020  (n_datasets):.  
+00043b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00043b90: 2020 2020 2020 2020 2020 7661 7269 616e            varian
+00043ba0: 6365 5b64 6174 6173 6574 5f69 645f 5d20  ce[dataset_id_] 
+00043bb0: 3d20 7661 7269 616e 6365 5f64 6963 745f  = variance_dict_
+00043bc0: 5b62 6568 6176 696f 725f 706f 6c69 6379  [behavior_policy
+00043bd0: 5d5b 0a20 2020 2020 2020 2020 2020 2020  ][.             
 00043be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043bf0: 2076 6172 6961 6e63 6520 3d20 6e70 2e7a   variance = np.z
-00043c00: 6572 6f73 2828 6e5f 6461 7461 7365 7473  eros((n_datasets
-00043c10: 2c29 290a 2020 2020 2020 2020 2020 2020  ,)).            
-00043c20: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00043c30: 6461 7461 7365 745f 6964 5f20 696e 2072  dataset_id_ in r
-00043c40: 616e 6765 286e 5f64 6174 6173 6574 7329  ange(n_datasets)
-00043c50: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00043c60: 2020 2020 2020 2020 2020 2020 2020 7661                va
-00043c70: 7269 616e 6365 5b64 6174 6173 6574 5f69  riance[dataset_i
-00043c80: 645f 5d20 3d20 7661 7269 616e 6365 5f64  d_] = variance_d
-00043c90: 6963 745f 5b62 6568 6176 696f 725f 706f  ict_[behavior_po
-00043ca0: 6c69 6379 5d5b 0a20 2020 2020 2020 2020  licy][.         
-00043cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043cc0: 2020 2020 2020 2064 6174 6173 6574 5f69         dataset_i
-00043cd0: 645f 0a20 2020 2020 2020 2020 2020 2020  d_.             
-00043ce0: 2020 2020 2020 2020 2020 2020 2020 205d                 ]
-00043cf0: 5b65 7661 6c5f 706f 6c69 6379 5d5b 6573  [eval_policy][es
-00043d00: 7469 6d61 746f 725d 0a0a 2020 2020 2020  timator]..      
-00043d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043d20: 2020 7661 7269 616e 6365 5f64 6963 745b    variance_dict[
-00043d30: 6265 6861 7669 6f72 5f70 6f6c 6963 795d  behavior_policy]
-00043d40: 5b65 7661 6c5f 706f 6c69 6379 5d5b 0a20  [eval_policy][. 
+00043bf0: 2020 2064 6174 6173 6574 5f69 645f 0a20     dataset_id_. 
+00043c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00043c10: 2020 2020 2020 2020 2020 205d 5b65 7661             ][eva
+00043c20: 6c5f 706f 6c69 6379 5d5b 6573 7469 6d61  l_policy][estima
+00043c30: 746f 725d 0a0a 2020 2020 2020 2020 2020  tor]..          
+00043c40: 2020 2020 2020 2020 2020 2020 2020 7661                va
+00043c50: 7269 616e 6365 5f64 6963 745b 6265 6861  riance_dict[beha
+00043c60: 7669 6f72 5f70 6f6c 6963 795d 5b65 7661  vior_policy][eva
+00043c70: 6c5f 706f 6c69 6379 5d5b 0a20 2020 2020  l_policy][.     
+00043c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00043c90: 2020 2020 2020 2065 7374 696d 6174 6f72         estimator
+00043ca0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00043cb0: 2020 2020 2020 2020 205d 203d 2076 6172           ] = var
+00043cc0: 6961 6e63 650a 0a20 2020 2020 2020 2020  iance..         
+00043cd0: 2020 2020 2020 2020 2020 206f 6e5f 706f             on_po
+00043ce0: 6c69 6379 203d 2069 6e70 7574 5f64 6963  licy = input_dic
+00043cf0: 745f 305b 6576 616c 5f70 6f6c 6963 795d  t_0[eval_policy]
+00043d00: 5b22 6f6e 5f70 6f6c 6963 795f 706f 6c69  ["on_policy_poli
+00043d10: 6379 5f76 616c 7565 225d 0a0a 2020 2020  cy_value"]..    
+00043d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00043d30: 6966 206f 6e5f 706f 6c69 6379 2069 7320  if on_policy is 
+00043d40: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
 00043d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043d60: 2020 2020 2020 2020 2020 2065 7374 696d             estim
-00043d70: 6174 6f72 0a20 2020 2020 2020 2020 2020  ator.           
-00043d80: 2020 2020 2020 2020 2020 2020 205d 203d               ] =
-00043d90: 2076 6172 6961 6e63 650a 0a20 2020 2020   variance..     
-00043da0: 2020 2020 2020 2020 2020 2020 2020 206f                 o
-00043db0: 6e5f 706f 6c69 6379 203d 2069 6e70 7574  n_policy = input
-00043dc0: 5f64 6963 745f 305b 6576 616c 5f70 6f6c  _dict_0[eval_pol
-00043dd0: 6963 795d 5b22 6f6e 5f70 6f6c 6963 795f  icy]["on_policy_
-00043de0: 706f 6c69 6379 5f76 616c 7565 225d 0a0a  policy_value"]..
-00043df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043e00: 2020 2020 6966 206f 6e5f 706f 6c69 6379      if on_policy
-00043e10: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
-00043e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043e30: 2020 2020 2020 7661 7269 616e 6365 5f64        variance_d
-00043e40: 6963 745b 6265 6861 7669 6f72 5f70 6f6c  ict[behavior_pol
-00043e50: 6963 795d 5b65 7661 6c5f 706f 6c69 6379  icy][eval_policy
-00043e60: 5d5b 0a20 2020 2020 2020 2020 2020 2020  ][.             
-00043e70: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00043e80: 6f6e 5f70 6f6c 6963 7922 0a20 2020 2020  on_policy".     
-00043e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043ea0: 2020 205d 203d 206f 6e5f 706f 6c69 6379     ] = on_policy
-00043eb0: 2e76 6172 2864 646f 663d 3129 0a20 2020  .var(ddof=1).   
-00043ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043ed0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00043ee0: 2020 2020 2020 2020 2020 2020 2020 2076                 v
-00043ef0: 6172 6961 6e63 655f 6469 6374 5b62 6568  ariance_dict[beh
-00043f00: 6176 696f 725f 706f 6c69 6379 5d5b 6576  avior_policy][ev
-00043f10: 616c 5f70 6f6c 6963 795d 5b22 6f6e 5f70  al_policy]["on_p
-00043f20: 6f6c 6963 7922 5d20 3d20 4e6f 6e65 0a0a  olicy"] = None..
-00043f30: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00043f40: 2020 2020 2020 2020 2020 7661 7269 616e            varian
-00043f50: 6365 5f64 6963 7420 3d20 6465 6661 756c  ce_dict = defaul
-00043f60: 7464 6963 7428 6469 6374 290a 0a20 2020  tdict(dict)..   
-00043f70: 2020 2020 2020 2020 2069 6e70 7574 5f64           input_d
-00043f80: 6963 745f 3020 3d20 696e 7075 745f 6469  ict_0 = input_di
-00043f90: 6374 2e67 6574 280a 2020 2020 2020 2020  ct.get(.        
-00043fa0: 2020 2020 2020 2020 6265 6861 7669 6f72          behavior
-00043fb0: 5f70 6f6c 6963 795f 6e61 6d65 3d62 6568  _policy_name=beh
-00043fc0: 6176 696f 725f 706f 6c69 6379 5f6e 616d  avior_policy_nam
-00043fd0: 652c 2064 6174 6173 6574 5f69 643d 300a  e, dataset_id=0.
-00043fe0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00043ff0: 2020 2020 2020 2020 2020 6e5f 6461 7461            n_data
-00044000: 7365 7473 203d 2069 6e70 7574 5f64 6963  sets = input_dic
-00044010: 742e 6e5f 6461 7461 7365 7473 5b62 6568  t.n_datasets[beh
-00044020: 6176 696f 725f 706f 6c69 6379 5f6e 616d  avior_policy_nam
-00044030: 655d 0a0a 2020 2020 2020 2020 2020 2020  e]..            
-00044040: 666f 7220 6576 616c 5f70 6f6c 6963 7920  for eval_policy 
-00044050: 696e 2069 6e70 7574 5f64 6963 745f 302e  in input_dict_0.
-00044060: 6b65 7973 2829 3a0a 2020 2020 2020 2020  keys():.        
-00044070: 2020 2020 2020 2020 666f 7220 6573 7469          for esti
-00044080: 6d61 746f 7220 696e 2063 6f6d 7061 7265  mator in compare
-00044090: 645f 6573 7469 6d61 746f 7273 3a0a 2020  d_estimators:.  
-000440a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000440b0: 2020 7661 7269 616e 6365 203d 206e 702e    variance = np.
-000440c0: 7a65 726f 7328 286e 5f64 6174 6173 6574  zeros((n_dataset
-000440d0: 732c 2929 0a20 2020 2020 2020 2020 2020  s,)).           
-000440e0: 2020 2020 2020 2020 2066 6f72 2064 6174           for dat
-000440f0: 6173 6574 5f69 645f 2069 6e20 7261 6e67  aset_id_ in rang
-00044100: 6528 6e5f 6461 7461 7365 7473 293a 0a20  e(n_datasets):. 
-00044110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044120: 2020 2020 2020 2076 6172 6961 6e63 655b         variance[
-00044130: 6461 7461 7365 745f 6964 5f5d 203d 2076  dataset_id_] = v
-00044140: 6172 6961 6e63 655f 6469 6374 5f5b 6461  ariance_dict_[da
-00044150: 7461 7365 745f 6964 5f5d 5b0a 2020 2020  taset_id_][.    
-00044160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044170: 2020 2020 2020 2020 6576 616c 5f70 6f6c          eval_pol
-00044180: 6963 790a 2020 2020 2020 2020 2020 2020  icy.            
-00044190: 2020 2020 2020 2020 2020 2020 5d5b 6573              ][es
-000441a0: 7469 6d61 746f 725d 0a0a 2020 2020 2020  timator]..      
-000441b0: 2020 2020 2020 2020 2020 2020 2020 7661                va
-000441c0: 7269 616e 6365 5f64 6963 745b 6576 616c  riance_dict[eval
-000441d0: 5f70 6f6c 6963 795d 5b65 7374 696d 6174  _policy][estimat
-000441e0: 6f72 5d20 3d20 7661 7269 616e 6365 0a0a  or] = variance..
-000441f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044200: 6f6e 5f70 6f6c 6963 7920 3d20 696e 7075  on_policy = inpu
-00044210: 745f 6469 6374 5f30 5b65 7661 6c5f 706f  t_dict_0[eval_po
-00044220: 6c69 6379 5d5b 226f 6e5f 706f 6c69 6379  licy]["on_policy
-00044230: 5f70 6f6c 6963 795f 7661 6c75 6522 5d0a  _policy_value"].
-00044240: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00044250: 2069 6620 6f6e 5f70 6f6c 6963 7920 6973   if on_policy is
-00044260: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
-00044270: 2020 2020 2020 2020 2020 2020 2020 2076                 v
-00044280: 6172 6961 6e63 655f 6469 6374 5b65 7661  ariance_dict[eva
-00044290: 6c5f 706f 6c69 6379 5d5b 226f 6e5f 706f  l_policy]["on_po
-000442a0: 6c69 6379 225d 203d 206f 6e5f 706f 6c69  licy"] = on_poli
-000442b0: 6379 2e76 6172 2864 646f 663d 3129 0a20  cy.var(ddof=1). 
-000442c0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-000442d0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-000442e0: 2020 2020 2020 2020 2076 6172 6961 6e63           varianc
-000442f0: 655f 6469 6374 5b65 7661 6c5f 706f 6c69  e_dict[eval_poli
-00044300: 6379 5d5b 226f 6e5f 706f 6c69 6379 225d  cy]["on_policy"]
-00044310: 203d 204e 6f6e 650a 0a20 2020 2020 2020   = None..       
-00044320: 2076 6172 6961 6e63 655f 6469 6374 203d   variance_dict =
-00044330: 2064 6566 6175 6c74 6469 6374 5f74 6f5f   defaultdict_to_
-00044340: 6469 6374 2876 6172 6961 6e63 655f 6469  dict(variance_di
-00044350: 6374 290a 0a20 2020 2020 2020 2073 656c  ct)..        sel
-00044360: 662e 5f76 6973 7561 6c69 7a65 5f6f 6666  f._visualize_off
-00044370: 5f70 6f6c 6963 795f 6573 7469 6d61 7465  _policy_estimate
-00044380: 735f 7769 7468 5f6d 756c 7469 706c 655f  s_with_multiple_
-00044390: 6573 7469 6d61 7465 7328 0a20 2020 2020  estimates(.     
-000443a0: 2020 2020 2020 2069 6e70 7574 5f64 6963         input_dic
-000443b0: 743d 696e 7075 745f 6469 6374 2c0a 2020  t=input_dict,.  
-000443c0: 2020 2020 2020 2020 2020 6573 7469 6d61            estima
-000443d0: 7469 6f6e 5f64 6963 743d 7661 7269 616e  tion_dict=varian
-000443e0: 6365 5f64 6963 742c 0a20 2020 2020 2020  ce_dict,.       
-000443f0: 2020 2020 2063 6f6d 7061 7265 645f 6573       compared_es
-00044400: 7469 6d61 746f 7273 3d63 6f6d 7061 7265  timators=compare
-00044410: 645f 6573 7469 6d61 746f 7273 2c0a 2020  d_estimators,.  
-00044420: 2020 2020 2020 2020 2020 6265 6861 7669            behavi
-00044430: 6f72 5f70 6f6c 6963 795f 6e61 6d65 3d62  or_policy_name=b
-00044440: 6568 6176 696f 725f 706f 6c69 6379 5f6e  ehavior_policy_n
-00044450: 616d 652c 0a20 2020 2020 2020 2020 2020  ame,.           
-00044460: 2079 6c61 6265 6c3d 2245 7374 696d 6174   ylabel="Estimat
-00044470: 6564 2056 6172 6961 6e63 6522 2c0a 2020  ed Variance",.  
-00044480: 2020 2020 2020 2020 2020 706c 6f74 5f74            plot_t
-00044490: 7970 653d 706c 6f74 5f74 7970 652c 0a20  ype=plot_type,. 
-000444a0: 2020 2020 2020 2020 2020 2068 7565 3d68             hue=h
-000444b0: 7565 2c0a 2020 2020 2020 2020 2020 2020  ue,.            
-000444c0: 6c65 6765 6e64 3d6c 6567 656e 642c 0a20  legend=legend,. 
-000444d0: 2020 2020 2020 2020 2020 2073 6861 7265             share
-000444e0: 793d 7368 6172 6579 2c0a 2020 2020 2020  y=sharey,.      
-000444f0: 2020 2020 2020 6669 675f 6469 723d 6669        fig_dir=fi
-00044500: 675f 6469 722c 0a20 2020 2020 2020 2020  g_dir,.         
-00044510: 2020 2066 6967 5f6e 616d 653d 6669 675f     fig_name=fig_
-00044520: 6e61 6d65 2c0a 2020 2020 2020 2020 290a  name,.        ).
-00044530: 0a20 2020 2064 6566 2076 6973 7561 6c69  .    def visuali
-00044540: 7a65 5f63 6f6e 6469 7469 6f6e 616c 5f76  ze_conditional_v
-00044550: 616c 7565 5f61 745f 7269 736b 5f77 6974  alue_at_risk_wit
-00044560: 685f 6d75 6c74 6970 6c65 5f65 7374 696d  h_multiple_estim
-00044570: 6174 6573 280a 2020 2020 2020 2020 7365  ates(.        se
-00044580: 6c66 2c0a 2020 2020 2020 2020 696e 7075  lf,.        inpu
-00044590: 745f 6469 6374 3a20 4d75 6c74 6970 6c65  t_dict: Multiple
-000445a0: 496e 7075 7444 6963 742c 0a20 2020 2020  InputDict,.     
-000445b0: 2020 2063 6f6d 7061 7265 645f 6573 7469     compared_esti
-000445c0: 6d61 746f 7273 3a20 4f70 7469 6f6e 616c  mators: Optional
-000445d0: 5b4c 6973 745b 7374 725d 5d20 3d20 4e6f  [List[str]] = No
-000445e0: 6e65 2c0a 2020 2020 2020 2020 6265 6861  ne,.        beha
-000445f0: 7669 6f72 5f70 6f6c 6963 795f 6e61 6d65  vior_policy_name
-00044600: 3a20 4f70 7469 6f6e 616c 5b73 7472 5d20  : Optional[str] 
-00044610: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-00044620: 616c 7068 613a 2066 6c6f 6174 203d 2030  alpha: float = 0
-00044630: 2e30 352c 0a20 2020 2020 2020 2070 6c6f  .05,.        plo
-00044640: 745f 7479 7065 3a20 7374 7220 3d20 2263  t_type: str = "c
-00044650: 6922 2c0a 2020 2020 2020 2020 6875 653a  i",.        hue:
-00044660: 2073 7472 203d 2022 6573 7469 6d61 746f   str = "estimato
-00044670: 7222 2c0a 2020 2020 2020 2020 6c65 6765  r",.        lege
-00044680: 6e64 3a20 626f 6f6c 203d 2054 7275 652c  nd: bool = True,
-00044690: 0a20 2020 2020 2020 2073 6861 7265 793a  .        sharey:
-000446a0: 2062 6f6f 6c20 3d20 4661 6c73 652c 0a20   bool = False,. 
-000446b0: 2020 2020 2020 2066 6967 5f64 6972 3a20         fig_dir: 
-000446c0: 4f70 7469 6f6e 616c 5b50 6174 685d 203d  Optional[Path] =
-000446d0: 204e 6f6e 652c 0a20 2020 2020 2020 2066   None,.        f
-000446e0: 6967 5f6e 616d 653a 2073 7472 203d 2022  ig_name: str = "
-000446f0: 6573 7469 6d61 7465 645f 636f 6e64 6974  estimated_condit
-00044700: 696f 6e61 6c5f 7661 6c75 655f 6174 5f72  ional_value_at_r
-00044710: 6973 6b5f 6d75 6c74 6970 6c65 2e70 6e67  isk_multiple.png
-00044720: 222c 0a20 2020 2029 202d 3e20 4e6f 6e65  ",.    ) -> None
-00044730: 3a0a 2020 2020 2020 2020 2222 2256 6973  :.        """Vis
-00044740: 7561 6c69 7a65 2074 6865 2063 6f6e 6469  ualize the condi
-00044750: 7469 6f6e 616c 2076 616c 7565 2061 7420  tional value at 
-00044760: 7269 736b 206f 6620 7468 6520 7472 616a  risk of the traj
-00044770: 6563 746f 7279 2d77 6973 6520 7265 7761  ectory-wise rewa
-00044780: 7264 2075 6e64 6572 2074 6865 2065 7661  rd under the eva
-00044790: 6c75 6174 696f 6e20 706f 6c69 6379 2065  luation policy e
-000447a0: 7374 696d 6174 6564 2062 7920 4f50 4520  stimated by OPE 
-000447b0: 6573 7469 6d61 746f 7273 2061 6372 6f73  estimators acros
-000447c0: 7320 6d75 6c74 6970 6c65 206c 6f67 6765  s multiple logge
-000447d0: 6420 6461 7461 7365 742e 0a0a 2020 2020  d dataset...    
-000447e0: 2020 2020 4e6f 7465 0a20 2020 2020 2020      Note.       
-000447f0: 202d 2d2d 2d2d 2d2d 0a20 2020 2020 2020   -------.       
-00044800: 2054 6869 7320 6675 6e63 7469 6f6e 2069   This function i
-00044810: 7320 6170 706c 6963 6162 6c65 206f 6e6c  s applicable onl
-00044820: 7920 7768 656e 204d 756c 7469 706c 654c  y when MultipleL
-00044830: 6f67 6765 6444 6174 6173 6574 2069 7320  oggedDataset is 
-00044840: 7573 6564 2061 6e64 0a20 2020 2020 2020  used and.       
-00044850: 204d 756c 7469 706c 6549 6e70 7574 4469   MultipleInputDi
-00044860: 6374 2069 7320 636f 6c6c 6563 7465 6420  ct is collected 
-00044870: 6279 2074 6865 2073 616d 6520 6576 616c  by the same eval
-00044880: 7561 7469 6f6e 2070 6f6c 6963 7920 6163  uation policy ac
-00044890: 726f 7373 206c 6f67 6765 6420 6461 7461  ross logged data
-000448a0: 7365 7473 2e0a 0a20 2020 2020 2020 2050  sets...        P
-000448b0: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
-000448c0: 2020 2d2d 2d2d 2d2d 2d0a 2020 2020 2020    -------.      
-000448d0: 2020 696e 7075 745f 6469 6374 3a20 4f50    input_dict: OP
-000448e0: 4549 6e70 7574 4469 6374 206f 7220 4d75  EInputDict or Mu
-000448f0: 6c74 6970 6c65 496e 7075 7444 6963 740a  ltipleInputDict.
-00044900: 2020 2020 2020 2020 2020 2020 4469 6374              Dict
-00044910: 696f 6e61 7279 206f 6620 7468 6520 4f50  ionary of the OP
-00044920: 4520 696e 7075 7473 2066 6f72 2065 6163  E inputs for eac
-00044930: 6820 6576 616c 7561 7469 6f6e 2070 6f6c  h evaluation pol
-00044940: 6963 792e 0a0a 2020 2020 2020 2020 2020  icy...          
-00044950: 2020 2e2e 2063 6f64 652d 626c 6f63 6b3a    .. code-block:
-00044960: 3a20 7079 7468 6f6e 0a0a 2020 2020 2020  : python..      
-00044970: 2020 2020 2020 2020 2020 6b65 793a 205b            key: [
-00044980: 6576 616c 7561 7469 6f6e 5f70 6f6c 6963  evaluation_polic
-00044990: 795d 5b0a 2020 2020 2020 2020 2020 2020  y][.            
-000449a0: 2020 2020 2020 2020 6576 616c 7561 7469          evaluati
-000449b0: 6f6e 5f70 6f6c 6963 795f 6163 7469 6f6e  on_policy_action
-000449c0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000449d0: 2020 2020 2020 6576 616c 7561 7469 6f6e        evaluation
-000449e0: 5f70 6f6c 6963 795f 6163 7469 6f6e 5f64  _policy_action_d
-000449f0: 6973 742c 0a20 2020 2020 2020 2020 2020  ist,.           
-00044a00: 2020 2020 2020 2020 2073 7461 7465 5f61           state_a
-00044a10: 6374 696f 6e5f 7661 6c75 655f 7072 6564  ction_value_pred
-00044a20: 6963 7469 6f6e 2c0a 2020 2020 2020 2020  iction,.        
-00044a30: 2020 2020 2020 2020 2020 2020 696e 6974              init
-00044a40: 6961 6c5f 7374 6174 655f 7661 6c75 655f  ial_state_value_
-00044a50: 7072 6564 6963 7469 6f6e 2c0a 2020 2020  prediction,.    
-00044a60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044a70: 7374 6174 655f 6163 7469 6f6e 5f6d 6172  state_action_mar
-00044a80: 6769 6e61 6c5f 696d 706f 7274 616e 6365  ginal_importance
-00044a90: 5f77 6569 6768 742c 0a20 2020 2020 2020  _weight,.       
-00044aa0: 2020 2020 2020 2020 2020 2020 2073 7461               sta
-00044ab0: 7465 5f6d 6172 6769 6e61 6c5f 696d 706f  te_marginal_impo
-00044ac0: 7274 616e 6365 5f77 6569 6768 742c 0a20  rtance_weight,. 
-00044ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044ae0: 2020 206f 6e5f 706f 6c69 6379 5f70 6f6c     on_policy_pol
-00044af0: 6963 795f 7661 6c75 652c 0a20 2020 2020  icy_value,.     
-00044b00: 2020 2020 2020 2020 2020 2020 2020 2067                 g
-00044b10: 616d 6d61 2c0a 2020 2020 2020 2020 2020  amma,.          
-00044b20: 2020 2020 2020 2020 2020 6265 6861 7669            behavi
-00044b30: 6f72 5f70 6f6c 6963 792c 0a20 2020 2020  or_policy,.     
-00044b40: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00044b50: 7661 6c75 6174 696f 6e5f 706f 6c69 6379  valuation_policy
-00044b60: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00044b70: 2020 2020 2020 6461 7461 7365 745f 6964        dataset_id
-00044b80: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00044b90: 2020 5d0a 0a20 2020 2020 2020 2020 2020    ]..           
-00044ba0: 202e 2e20 7365 6561 6c73 6f3a 3a0a 0a20   .. seealso::.. 
-00044bb0: 2020 2020 2020 2020 2020 2020 2020 203a                 :
-00044bc0: 636c 6173 733a 6073 636f 7065 5f72 6c2e  class:`scope_rl.
-00044bd0: 6f70 652e 696e 7075 742e 4372 6561 7465  ope.input.Create
-00044be0: 4f50 4549 6e70 7574 6020 6465 7363 7269  OPEInput` descri
-00044bf0: 6265 7320 7468 6520 636f 6d70 6f6e 656e  bes the componen
-00044c00: 7473 206f 6620 3a63 6c61 7373 3a60 696e  ts of :class:`in
-00044c10: 7075 745f 6469 6374 602e 0a0a 2020 2020  put_dict`...    
-00044c20: 2020 2020 636f 6d70 6172 6564 5f65 7374      compared_est
-00044c30: 696d 6174 6f72 733a 206c 6973 7420 6f66  imators: list of
-00044c40: 2073 7472 2c20 6465 6661 756c 743d 4e6f   str, default=No
-00044c50: 6e65 0a20 2020 2020 2020 2020 2020 204e  ne.            N
-00044c60: 616d 6520 6f66 2063 6f6d 7061 7265 6420  ame of compared 
-00044c70: 6573 7469 6d61 746f 7273 2e0a 2020 2020  estimators..    
-00044c80: 2020 2020 2020 2020 4966 2060 4e6f 6e65          If `None
-00044c90: 6020 6973 2067 6976 656e 2c20 616c 6c20  ` is given, all 
-00044ca0: 7468 6520 6573 7469 6d61 746f 7273 2061  the estimators a
-00044cb0: 7265 2063 6f6d 7061 7265 642e 0a0a 2020  re compared...  
-00044cc0: 2020 2020 2020 6265 6861 7669 6f72 5f70        behavior_p
-00044cd0: 6f6c 6963 795f 6e61 6d65 3a20 7374 722c  olicy_name: str,
-00044ce0: 2064 6566 6175 6c74 3d4e 6f6e 650a 2020   default=None.  
-00044cf0: 2020 2020 2020 2020 2020 4e61 6d65 206f            Name o
-00044d00: 6620 7468 6520 6265 6861 7669 6f72 2070  f the behavior p
-00044d10: 6f6c 6963 792e 0a0a 2020 2020 2020 2020  olicy...        
-00044d20: 616c 7068 613a 2066 6c6f 6174 203d 2030  alpha: float = 0
-00044d30: 2e30 352e 0a20 2020 2020 2020 2020 2020  .05..           
-00044d40: 2050 726f 706f 7274 696f 6e20 6f66 2074   Proportion of t
-00044d50: 6865 2073 6861 6465 6420 7265 6769 6f6e  he shaded region
-00044d60: 2069 6e20 4356 6152 2065 7374 696d 6174   in CVaR estimat
-00044d70: 652e 2054 6865 2076 616c 7565 2073 686f  e. The value sho
-00044d80: 756c 6420 6265 2077 6974 6869 6e20 605b  uld be within `[
-00044d90: 302c 2031 2960 2e0a 0a20 2020 2020 2020  0, 1)`...       
-00044da0: 2070 6c6f 745f 7479 7065 3a20 7b22 6369   plot_type: {"ci
-00044db0: 222c 2022 7363 6174 7465 7222 2c20 2276  ", "scatter", "v
-00044dc0: 696f 6c69 6e22 7d2c 2064 6566 6175 6c74  iolin"}, default
-00044dd0: 3d22 6369 220a 2020 2020 2020 2020 2020  ="ci".          
-00044de0: 2020 5479 7065 206f 6620 706c 6f74 2e0a    Type of plot..
-00044df0: 2020 2020 2020 2020 2020 2020 4966 2022              If "
-00044e00: 6369 2220 6973 2067 6976 656e 2c20 7765  ci" is given, we
-00044e10: 2067 6574 2074 6865 2065 6d70 6972 6963   get the empiric
-00044e20: 616c 2061 7665 7261 6765 206f 6620 7468  al average of th
-00044e30: 6520 6573 7469 6d61 7465 6420 7661 6c75  e estimated valu
-00044e40: 6573 2077 6974 6820 7468 6569 7220 6573  es with their es
-00044e50: 7469 6d61 7465 6420 636f 6e66 6964 656e  timated confiden
-00044e60: 6365 2069 6e74 6572 7661 6c73 2e0a 2020  ce intervals..  
-00044e70: 2020 2020 2020 2020 2020 4966 2022 7363            If "sc
-00044e80: 6174 7465 7222 2069 7320 6769 7665 6e2c  atter" is given,
-00044e90: 2077 6520 6765 7420 6120 7363 6174 7465   we get a scatte
-00044ea0: 7220 706c 6f74 206f 6620 6573 7469 6d61  r plot of estima
-00044eb0: 7465 6420 7661 6c75 6573 2e0a 0a20 2020  ted values...   
-00044ec0: 2020 2020 2068 7565 3a20 7b22 6573 7469       hue: {"esti
-00044ed0: 6d61 746f 7222 2c20 2270 6f6c 6963 7922  mator", "policy"
-00044ee0: 7d2c 2064 6566 6175 6c74 3d22 6573 7469  }, default="esti
-00044ef0: 6d61 746f 7222 0a20 2020 2020 2020 2020  mator".         
-00044f00: 2020 2048 7565 206f 6620 7468 6520 706c     Hue of the pl
-00044f10: 6f74 2e0a 0a20 2020 2020 2020 206c 6567  ot...        leg
-00044f20: 656e 643a 2062 6f6f 6c2c 2064 6566 6175  end: bool, defau
-00044f30: 6c74 3d54 7275 650a 2020 2020 2020 2020  lt=True.        
-00044f40: 2020 2020 5768 6574 6865 7220 746f 2069      Whether to i
-00044f50: 6e63 6c75 6465 2061 206c 6567 656e 6420  nclude a legend 
-00044f60: 696e 2074 6865 2073 6361 7474 6572 2070  in the scatter p
-00044f70: 6c6f 742e 0a0a 2020 2020 2020 2020 7368  lot...        sh
-00044f80: 6172 6579 3a20 626f 6f6c 2c20 6465 6661  arey: bool, defa
-00044f90: 756c 743d 4661 6c73 650a 2020 2020 2020  ult=False.      
-00044fa0: 2020 2020 2020 4966 2060 5472 7565 602c        If `True`,
-00044fb0: 2074 6865 2079 2d61 7869 7320 7769 6c6c   the y-axis will
-00044fc0: 2062 6520 7368 6172 6564 2061 6d6f 6e67   be shared among
-00044fd0: 2064 6966 6665 7265 6e74 2065 7374 696d   different estim
-00044fe0: 6174 6f72 7320 6f72 2065 7661 6c75 6174  ators or evaluat
-00044ff0: 696f 6e20 706f 6c69 6369 6573 2e0a 0a20  ion policies... 
-00045000: 2020 2020 2020 2066 6967 5f64 6972 3a20         fig_dir: 
-00045010: 5061 7468 2c20 6465 6661 756c 743d 4e6f  Path, default=No
-00045020: 6e65 0a20 2020 2020 2020 2020 2020 2050  ne.            P
-00045030: 6174 6820 746f 2073 746f 7265 2074 6865  ath to store the
-00045040: 2062 6172 2066 6967 7572 652e 0a20 2020   bar figure..   
-00045050: 2020 2020 2020 2020 2049 6620 604e 6f6e           If `Non
-00045060: 6560 2069 7320 6769 7665 6e2c 2074 6865  e` is given, the
-00045070: 2066 6967 7572 6520 7769 6c6c 206e 6f74   figure will not
-00045080: 2062 6520 7361 7665 642e 0a0a 2020 2020   be saved...    
-00045090: 2020 2020 6669 675f 6e61 6d65 3a20 7374      fig_name: st
-000450a0: 722c 2064 6566 6175 6c74 3d22 6573 7469  r, default="esti
-000450b0: 6d61 7465 645f 636f 6e64 6974 696f 6e61  mated_conditiona
-000450c0: 6c5f 7661 6c75 655f 6174 5f72 6973 6b5f  l_value_at_risk_
-000450d0: 6d75 6c74 6970 6c65 2e70 6e67 220a 2020  multiple.png".  
-000450e0: 2020 2020 2020 2020 2020 4e61 6d65 206f            Name o
-000450f0: 6620 7468 6520 6261 7220 6669 6775 7265  f the bar figure
-00045100: 2e0a 0a20 2020 2020 2020 2022 2222 0a20  ...        """. 
-00045110: 2020 2020 2020 2063 6f6d 7061 7265 645f         compared_
-00045120: 6573 7469 6d61 746f 7273 203d 2073 656c  estimators = sel
-00045130: 662e 5f63 6865 636b 5f63 6f6d 7061 7265  f._check_compare
-00045140: 645f 6573 7469 6d61 746f 7273 2863 6f6d  d_estimators(com
-00045150: 7061 7265 645f 6573 7469 6d61 746f 7273  pared_estimators
-00045160: 290a 2020 2020 2020 2020 7365 6c66 2e5f  ).        self._
-00045170: 6368 6563 6b5f 6261 7369 635f 7669 7375  check_basic_visu
-00045180: 616c 697a 6174 696f 6e5f 696e 7075 7473  alization_inputs
-00045190: 280a 2020 2020 2020 2020 2020 2020 6875  (.            hu
-000451a0: 653d 6875 652c 2066 6967 5f64 6972 3d66  e=hue, fig_dir=f
-000451b0: 6967 5f64 6972 2c20 6669 675f 6e61 6d65  ig_dir, fig_name
-000451c0: 3d66 6967 5f6e 616d 650a 2020 2020 2020  =fig_name.      
-000451d0: 2020 290a 2020 2020 2020 2020 7365 6c66    ).        self
-000451e0: 2e5f 6368 6563 6b5f 696e 7075 745f 6469  ._check_input_di
-000451f0: 6374 5f66 6f72 5f76 6973 7561 6c69 7a65  ct_for_visualize
-00045200: 5f6d 756c 7469 706c 655f 6573 7469 6d61  _multiple_estima
-00045210: 7465 7328 696e 7075 745f 6469 6374 290a  tes(input_dict).
-00045220: 0a20 2020 2020 2020 2069 6620 6c65 6e28  .        if len(
-00045230: 696e 7075 745f 6469 6374 2e62 6568 6176  input_dict.behav
-00045240: 696f 725f 706f 6c69 6379 5f6e 616d 6573  ior_policy_names
-00045250: 2920 3d3d 2031 3a0a 2020 2020 2020 2020  ) == 1:.        
-00045260: 2020 2020 6265 6861 7669 6f72 5f70 6f6c      behavior_pol
-00045270: 6963 795f 6e61 6d65 203d 2069 6e70 7574  icy_name = input
-00045280: 5f64 6963 742e 6265 6861 7669 6f72 5f70  _dict.behavior_p
-00045290: 6f6c 6963 795f 6e61 6d65 735b 305d 0a0a  olicy_names[0]..
-000452a0: 2020 2020 2020 2020 6376 6172 5f64 6963          cvar_dic
-000452b0: 745f 203d 2073 656c 662e 6573 7469 6d61  t_ = self.estima
-000452c0: 7465 5f63 6f6e 6469 7469 6f6e 616c 5f76  te_conditional_v
-000452d0: 616c 7565 5f61 745f 7269 736b 280a 2020  alue_at_risk(.  
-000452e0: 2020 2020 2020 2020 2020 696e 7075 745f            input_
-000452f0: 6469 6374 3d69 6e70 7574 5f64 6963 742c  dict=input_dict,
-00045300: 0a20 2020 2020 2020 2020 2020 2063 6f6d  .            com
-00045310: 7061 7265 645f 6573 7469 6d61 746f 7273  pared_estimators
-00045320: 3d63 6f6d 7061 7265 645f 6573 7469 6d61  =compared_estima
-00045330: 746f 7273 2c0a 2020 2020 2020 2020 2020  tors,.          
-00045340: 2020 6265 6861 7669 6f72 5f70 6f6c 6963    behavior_polic
-00045350: 795f 6e61 6d65 3d62 6568 6176 696f 725f  y_name=behavior_
-00045360: 706f 6c69 6379 5f6e 616d 652c 0a20 2020  policy_name,.   
-00045370: 2020 2020 2020 2020 2061 6c70 6861 733d           alphas=
-00045380: 616c 7068 612c 0a20 2020 2020 2020 2029  alpha,.        )
-00045390: 0a0a 2020 2020 2020 2020 6966 2062 6568  ..        if beh
-000453a0: 6176 696f 725f 706f 6c69 6379 5f6e 616d  avior_policy_nam
-000453b0: 6520 6973 204e 6f6e 653a 0a20 2020 2020  e is None:.     
-000453c0: 2020 2020 2020 2063 7661 725f 6469 6374         cvar_dict
-000453d0: 203d 2064 6566 6175 6c74 6469 6374 286c   = defaultdict(l
-000453e0: 616d 6264 613a 2064 6566 6175 6c74 6469  ambda: defaultdi
-000453f0: 6374 2864 6963 7429 290a 0a20 2020 2020  ct(dict))..     
-00045400: 2020 2020 2020 2066 6f72 2062 6568 6176         for behav
-00045410: 696f 725f 706f 6c69 6379 2c20 6e5f 6461  ior_policy, n_da
-00045420: 7461 7365 7473 2069 6e20 696e 7075 745f  tasets in input_
-00045430: 6469 6374 2e6e 5f64 6174 6173 6574 732e  dict.n_datasets.
-00045440: 6974 656d 7328 293a 0a20 2020 2020 2020  items():.       
-00045450: 2020 2020 2020 2020 2069 6e70 7574 5f64           input_d
-00045460: 6963 745f 3020 3d20 696e 7075 745f 6469  ict_0 = input_di
-00045470: 6374 2e67 6574 280a 2020 2020 2020 2020  ct.get(.        
-00045480: 2020 2020 2020 2020 2020 2020 6265 6861              beha
-00045490: 7669 6f72 5f70 6f6c 6963 795f 6e61 6d65  vior_policy_name
-000454a0: 3d62 6568 6176 696f 725f 706f 6c69 6379  =behavior_policy
-000454b0: 2c20 6461 7461 7365 745f 6964 3d30 0a20  , dataset_id=0. 
-000454c0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-000454d0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000454e0: 2020 666f 7220 6576 616c 5f70 6f6c 6963    for eval_polic
-000454f0: 7920 696e 2069 6e70 7574 5f64 6963 745f  y in input_dict_
-00045500: 302e 6b65 7973 2829 3a0a 2020 2020 2020  0.keys():.      
-00045510: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-00045520: 7220 6573 7469 6d61 746f 7220 696e 2063  r estimator in c
-00045530: 6f6d 7061 7265 645f 6573 7469 6d61 746f  ompared_estimato
-00045540: 7273 3a0a 2020 2020 2020 2020 2020 2020  rs:.            
-00045550: 2020 2020 2020 2020 2020 2020 6376 6172              cvar
-00045560: 203d 206e 702e 7a65 726f 7328 286e 5f64   = np.zeros((n_d
-00045570: 6174 6173 6574 732c 2929 0a20 2020 2020  atasets,)).     
-00045580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045590: 2020 2066 6f72 2064 6174 6173 6574 5f69     for dataset_i
-000455a0: 645f 2069 6e20 7261 6e67 6528 6e5f 6461  d_ in range(n_da
-000455b0: 7461 7365 7473 293a 0a20 2020 2020 2020  tasets):.       
-000455c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000455d0: 2020 2020 2063 7661 725b 6461 7461 7365       cvar[datase
-000455e0: 745f 6964 5f5d 203d 2063 7661 725f 6469  t_id_] = cvar_di
-000455f0: 6374 5f5b 6265 6861 7669 6f72 5f70 6f6c  ct_[behavior_pol
-00045600: 6963 795d 5b0a 2020 2020 2020 2020 2020  icy][.          
-00045610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045620: 2020 2020 2020 6461 7461 7365 745f 6964        dataset_id
-00045630: 5f0a 2020 2020 2020 2020 2020 2020 2020  _.              
-00045640: 2020 2020 2020 2020 2020 2020 2020 5d5b                ][
-00045650: 6576 616c 5f70 6f6c 6963 795d 5b65 7374  eval_policy][est
-00045660: 696d 6174 6f72 5d0a 0a20 2020 2020 2020  imator]..       
+00043d60: 2020 7661 7269 616e 6365 5f64 6963 745b    variance_dict[
+00043d70: 6265 6861 7669 6f72 5f70 6f6c 6963 795d  behavior_policy]
+00043d80: 5b65 7661 6c5f 706f 6c69 6379 5d5b 0a20  [eval_policy][. 
+00043d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00043da0: 2020 2020 2020 2020 2020 2022 6f6e 5f70             "on_p
+00043db0: 6f6c 6963 7922 0a20 2020 2020 2020 2020  olicy".         
+00043dc0: 2020 2020 2020 2020 2020 2020 2020 205d                 ]
+00043dd0: 203d 206f 6e5f 706f 6c69 6379 2e76 6172   = on_policy.var
+00043de0: 2864 646f 663d 3129 0a20 2020 2020 2020  (ddof=1).       
+00043df0: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+00043e00: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00043e10: 2020 2020 2020 2020 2020 2076 6172 6961             varia
+00043e20: 6e63 655f 6469 6374 5b62 6568 6176 696f  nce_dict[behavio
+00043e30: 725f 706f 6c69 6379 5d5b 6576 616c 5f70  r_policy][eval_p
+00043e40: 6f6c 6963 795d 5b22 6f6e 5f70 6f6c 6963  olicy]["on_polic
+00043e50: 7922 5d20 3d20 4e6f 6e65 0a0a 2020 2020  y"] = None..    
+00043e60: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00043e70: 2020 2020 2020 7661 7269 616e 6365 5f64        variance_d
+00043e80: 6963 7420 3d20 6465 6661 756c 7464 6963  ict = defaultdic
+00043e90: 7428 6469 6374 290a 0a20 2020 2020 2020  t(dict)..       
+00043ea0: 2020 2020 2069 6e70 7574 5f64 6963 745f       input_dict_
+00043eb0: 3020 3d20 696e 7075 745f 6469 6374 2e67  0 = input_dict.g
+00043ec0: 6574 280a 2020 2020 2020 2020 2020 2020  et(.            
+00043ed0: 2020 2020 6265 6861 7669 6f72 5f70 6f6c      behavior_pol
+00043ee0: 6963 795f 6e61 6d65 3d62 6568 6176 696f  icy_name=behavio
+00043ef0: 725f 706f 6c69 6379 5f6e 616d 652c 2064  r_policy_name, d
+00043f00: 6174 6173 6574 5f69 643d 300a 2020 2020  ataset_id=0.    
+00043f10: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00043f20: 2020 2020 2020 6e5f 6461 7461 7365 7473        n_datasets
+00043f30: 203d 2069 6e70 7574 5f64 6963 742e 6e5f   = input_dict.n_
+00043f40: 6461 7461 7365 7473 5b62 6568 6176 696f  datasets[behavio
+00043f50: 725f 706f 6c69 6379 5f6e 616d 655d 0a0a  r_policy_name]..
+00043f60: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00043f70: 6576 616c 5f70 6f6c 6963 7920 696e 2069  eval_policy in i
+00043f80: 6e70 7574 5f64 6963 745f 302e 6b65 7973  nput_dict_0.keys
+00043f90: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
+00043fa0: 2020 2020 666f 7220 6573 7469 6d61 746f      for estimato
+00043fb0: 7220 696e 2063 6f6d 7061 7265 645f 6573  r in compared_es
+00043fc0: 7469 6d61 746f 7273 3a0a 2020 2020 2020  timators:.      
+00043fd0: 2020 2020 2020 2020 2020 2020 2020 7661                va
+00043fe0: 7269 616e 6365 203d 206e 702e 7a65 726f  riance = np.zero
+00043ff0: 7328 286e 5f64 6174 6173 6574 732c 2929  s((n_datasets,))
+00044000: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00044010: 2020 2020 2066 6f72 2064 6174 6173 6574       for dataset
+00044020: 5f69 645f 2069 6e20 7261 6e67 6528 6e5f  _id_ in range(n_
+00044030: 6461 7461 7365 7473 293a 0a20 2020 2020  datasets):.     
+00044040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00044050: 2020 2076 6172 6961 6e63 655b 6461 7461     variance[data
+00044060: 7365 745f 6964 5f5d 203d 2076 6172 6961  set_id_] = varia
+00044070: 6e63 655f 6469 6374 5f5b 6461 7461 7365  nce_dict_[datase
+00044080: 745f 6964 5f5d 5b0a 2020 2020 2020 2020  t_id_][.        
+00044090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000440a0: 2020 2020 6576 616c 5f70 6f6c 6963 790a      eval_policy.
+000440b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000440c0: 2020 2020 2020 2020 5d5b 6573 7469 6d61          ][estima
+000440d0: 746f 725d 0a0a 2020 2020 2020 2020 2020  tor]..          
+000440e0: 2020 2020 2020 2020 2020 7661 7269 616e            varian
+000440f0: 6365 5f64 6963 745b 6576 616c 5f70 6f6c  ce_dict[eval_pol
+00044100: 6963 795d 5b65 7374 696d 6174 6f72 5d20  icy][estimator] 
+00044110: 3d20 7661 7269 616e 6365 0a0a 2020 2020  = variance..    
+00044120: 2020 2020 2020 2020 2020 2020 6f6e 5f70              on_p
+00044130: 6f6c 6963 7920 3d20 696e 7075 745f 6469  olicy = input_di
+00044140: 6374 5f30 5b65 7661 6c5f 706f 6c69 6379  ct_0[eval_policy
+00044150: 5d5b 226f 6e5f 706f 6c69 6379 5f70 6f6c  ]["on_policy_pol
+00044160: 6963 795f 7661 6c75 6522 5d0a 0a20 2020  icy_value"]..   
+00044170: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00044180: 6f6e 5f70 6f6c 6963 7920 6973 206e 6f74  on_policy is not
+00044190: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+000441a0: 2020 2020 2020 2020 2020 2076 6172 6961             varia
+000441b0: 6e63 655f 6469 6374 5b65 7661 6c5f 706f  nce_dict[eval_po
+000441c0: 6c69 6379 5d5b 226f 6e5f 706f 6c69 6379  licy]["on_policy
+000441d0: 225d 203d 206f 6e5f 706f 6c69 6379 2e76  "] = on_policy.v
+000441e0: 6172 2864 646f 663d 3129 0a20 2020 2020  ar(ddof=1).     
+000441f0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00044200: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00044210: 2020 2020 2076 6172 6961 6e63 655f 6469       variance_di
+00044220: 6374 5b65 7661 6c5f 706f 6c69 6379 5d5b  ct[eval_policy][
+00044230: 226f 6e5f 706f 6c69 6379 225d 203d 204e  "on_policy"] = N
+00044240: 6f6e 650a 0a20 2020 2020 2020 2076 6172  one..        var
+00044250: 6961 6e63 655f 6469 6374 203d 2064 6566  iance_dict = def
+00044260: 6175 6c74 6469 6374 5f74 6f5f 6469 6374  aultdict_to_dict
+00044270: 2876 6172 6961 6e63 655f 6469 6374 290a  (variance_dict).
+00044280: 0a20 2020 2020 2020 2073 656c 662e 5f76  .        self._v
+00044290: 6973 7561 6c69 7a65 5f6f 6666 5f70 6f6c  isualize_off_pol
+000442a0: 6963 795f 6573 7469 6d61 7465 735f 7769  icy_estimates_wi
+000442b0: 7468 5f6d 756c 7469 706c 655f 6573 7469  th_multiple_esti
+000442c0: 6d61 7465 7328 0a20 2020 2020 2020 2020  mates(.         
+000442d0: 2020 2069 6e70 7574 5f64 6963 743d 696e     input_dict=in
+000442e0: 7075 745f 6469 6374 2c0a 2020 2020 2020  put_dict,.      
+000442f0: 2020 2020 2020 6573 7469 6d61 7469 6f6e        estimation
+00044300: 5f64 6963 743d 7661 7269 616e 6365 5f64  _dict=variance_d
+00044310: 6963 742c 0a20 2020 2020 2020 2020 2020  ict,.           
+00044320: 2063 6f6d 7061 7265 645f 6573 7469 6d61   compared_estima
+00044330: 746f 7273 3d63 6f6d 7061 7265 645f 6573  tors=compared_es
+00044340: 7469 6d61 746f 7273 2c0a 2020 2020 2020  timators,.      
+00044350: 2020 2020 2020 6265 6861 7669 6f72 5f70        behavior_p
+00044360: 6f6c 6963 795f 6e61 6d65 3d62 6568 6176  olicy_name=behav
+00044370: 696f 725f 706f 6c69 6379 5f6e 616d 652c  ior_policy_name,
+00044380: 0a20 2020 2020 2020 2020 2020 2079 6c61  .            yla
+00044390: 6265 6c3d 2245 7374 696d 6174 6564 2056  bel="Estimated V
+000443a0: 6172 6961 6e63 6522 2c0a 2020 2020 2020  ariance",.      
+000443b0: 2020 2020 2020 706c 6f74 5f74 7970 653d        plot_type=
+000443c0: 706c 6f74 5f74 7970 652c 0a20 2020 2020  plot_type,.     
+000443d0: 2020 2020 2020 2068 7565 3d68 7565 2c0a         hue=hue,.
+000443e0: 2020 2020 2020 2020 2020 2020 6c65 6765              lege
+000443f0: 6e64 3d6c 6567 656e 642c 0a20 2020 2020  nd=legend,.     
+00044400: 2020 2020 2020 2073 6861 7265 793d 7368         sharey=sh
+00044410: 6172 6579 2c0a 2020 2020 2020 2020 2020  arey,.          
+00044420: 2020 6669 675f 6469 723d 6669 675f 6469    fig_dir=fig_di
+00044430: 722c 0a20 2020 2020 2020 2020 2020 2066  r,.            f
+00044440: 6967 5f6e 616d 653d 6669 675f 6e61 6d65  ig_name=fig_name
+00044450: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
+00044460: 2064 6566 2076 6973 7561 6c69 7a65 5f63   def visualize_c
+00044470: 6f6e 6469 7469 6f6e 616c 5f76 616c 7565  onditional_value
+00044480: 5f61 745f 7269 736b 5f77 6974 685f 6d75  _at_risk_with_mu
+00044490: 6c74 6970 6c65 5f65 7374 696d 6174 6573  ltiple_estimates
+000444a0: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+000444b0: 2020 2020 2020 2020 696e 7075 745f 6469          input_di
+000444c0: 6374 3a20 4d75 6c74 6970 6c65 496e 7075  ct: MultipleInpu
+000444d0: 7444 6963 742c 0a20 2020 2020 2020 2063  tDict,.        c
+000444e0: 6f6d 7061 7265 645f 6573 7469 6d61 746f  ompared_estimato
+000444f0: 7273 3a20 4f70 7469 6f6e 616c 5b4c 6973  rs: Optional[Lis
+00044500: 745b 7374 725d 5d20 3d20 4e6f 6e65 2c0a  t[str]] = None,.
+00044510: 2020 2020 2020 2020 6265 6861 7669 6f72          behavior
+00044520: 5f70 6f6c 6963 795f 6e61 6d65 3a20 4f70  _policy_name: Op
+00044530: 7469 6f6e 616c 5b73 7472 5d20 3d20 4e6f  tional[str] = No
+00044540: 6e65 2c0a 2020 2020 2020 2020 616c 7068  ne,.        alph
+00044550: 613a 2066 6c6f 6174 203d 2030 2e30 352c  a: float = 0.05,
+00044560: 0a20 2020 2020 2020 2070 6c6f 745f 7479  .        plot_ty
+00044570: 7065 3a20 7374 7220 3d20 2263 6922 2c0a  pe: str = "ci",.
+00044580: 2020 2020 2020 2020 6875 653a 2073 7472          hue: str
+00044590: 203d 2022 6573 7469 6d61 746f 7222 2c0a   = "estimator",.
+000445a0: 2020 2020 2020 2020 6c65 6765 6e64 3a20          legend: 
+000445b0: 626f 6f6c 203d 2054 7275 652c 0a20 2020  bool = True,.   
+000445c0: 2020 2020 2073 6861 7265 793a 2062 6f6f       sharey: boo
+000445d0: 6c20 3d20 4661 6c73 652c 0a20 2020 2020  l = False,.     
+000445e0: 2020 2066 6967 5f64 6972 3a20 4f70 7469     fig_dir: Opti
+000445f0: 6f6e 616c 5b50 6174 685d 203d 204e 6f6e  onal[Path] = Non
+00044600: 652c 0a20 2020 2020 2020 2066 6967 5f6e  e,.        fig_n
+00044610: 616d 653a 2073 7472 203d 2022 6573 7469  ame: str = "esti
+00044620: 6d61 7465 645f 636f 6e64 6974 696f 6e61  mated_conditiona
+00044630: 6c5f 7661 6c75 655f 6174 5f72 6973 6b5f  l_value_at_risk_
+00044640: 6d75 6c74 6970 6c65 2e70 6e67 222c 0a20  multiple.png",. 
+00044650: 2020 2029 202d 3e20 4e6f 6e65 3a0a 2020     ) -> None:.  
+00044660: 2020 2020 2020 2222 2256 6973 7561 6c69        """Visuali
+00044670: 7a65 2074 6865 2063 6f6e 6469 7469 6f6e  ze the condition
+00044680: 616c 2076 616c 7565 2061 7420 7269 736b  al value at risk
+00044690: 206f 6620 7468 6520 7472 616a 6563 746f   of the trajecto
+000446a0: 7279 2d77 6973 6520 7265 7761 7264 2075  ry-wise reward u
+000446b0: 6e64 6572 2074 6865 2065 7661 6c75 6174  nder the evaluat
+000446c0: 696f 6e20 706f 6c69 6379 2065 7374 696d  ion policy estim
+000446d0: 6174 6564 2062 7920 4f50 4520 6573 7469  ated by OPE esti
+000446e0: 6d61 746f 7273 2061 6372 6f73 7320 6d75  mators across mu
+000446f0: 6c74 6970 6c65 206c 6f67 6765 6420 6461  ltiple logged da
+00044700: 7461 7365 742e 0a0a 2020 2020 2020 2020  taset...        
+00044710: 4e6f 7465 0a20 2020 2020 2020 202d 2d2d  Note.        ---
+00044720: 2d2d 2d2d 0a20 2020 2020 2020 2054 6869  ----.        Thi
+00044730: 7320 6675 6e63 7469 6f6e 2069 7320 6170  s function is ap
+00044740: 706c 6963 6162 6c65 206f 6e6c 7920 7768  plicable only wh
+00044750: 656e 204d 756c 7469 706c 654c 6f67 6765  en MultipleLogge
+00044760: 6444 6174 6173 6574 2069 7320 7573 6564  dDataset is used
+00044770: 2061 6e64 0a20 2020 2020 2020 204d 756c   and.        Mul
+00044780: 7469 706c 6549 6e70 7574 4469 6374 2069  tipleInputDict i
+00044790: 7320 636f 6c6c 6563 7465 6420 6279 2074  s collected by t
+000447a0: 6865 2073 616d 6520 6576 616c 7561 7469  he same evaluati
+000447b0: 6f6e 2070 6f6c 6963 7920 6163 726f 7373  on policy across
+000447c0: 206c 6f67 6765 6420 6461 7461 7365 7473   logged datasets
+000447d0: 2e0a 0a20 2020 2020 2020 2050 6172 616d  ...        Param
+000447e0: 6574 6572 730a 2020 2020 2020 2020 2d2d  eters.        --
+000447f0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 696e  -----.        in
+00044800: 7075 745f 6469 6374 3a20 4f50 4549 6e70  put_dict: OPEInp
+00044810: 7574 4469 6374 206f 7220 4d75 6c74 6970  utDict or Multip
+00044820: 6c65 496e 7075 7444 6963 740a 2020 2020  leInputDict.    
+00044830: 2020 2020 2020 2020 4469 6374 696f 6e61          Dictiona
+00044840: 7279 206f 6620 7468 6520 4f50 4520 696e  ry of the OPE in
+00044850: 7075 7473 2066 6f72 2065 6163 6820 6576  puts for each ev
+00044860: 616c 7561 7469 6f6e 2070 6f6c 6963 792e  aluation policy.
+00044870: 0a0a 2020 2020 2020 2020 2020 2020 2e2e  ..            ..
+00044880: 2063 6f64 652d 626c 6f63 6b3a 3a20 7079   code-block:: py
+00044890: 7468 6f6e 0a0a 2020 2020 2020 2020 2020  thon..          
+000448a0: 2020 2020 2020 6b65 793a 205b 6576 616c        key: [eval
+000448b0: 7561 7469 6f6e 5f70 6f6c 6963 795d 5b0a  uation_policy][.
+000448c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000448d0: 2020 2020 6576 616c 7561 7469 6f6e 5f70      evaluation_p
+000448e0: 6f6c 6963 795f 6163 7469 6f6e 2c0a 2020  olicy_action,.  
+000448f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00044900: 2020 6576 616c 7561 7469 6f6e 5f70 6f6c    evaluation_pol
+00044910: 6963 795f 6163 7469 6f6e 5f64 6973 742c  icy_action_dist,
+00044920: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00044930: 2020 2020 2073 7461 7465 5f61 6374 696f       state_actio
+00044940: 6e5f 7661 6c75 655f 7072 6564 6963 7469  n_value_predicti
+00044950: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
+00044960: 2020 2020 2020 2020 696e 6974 6961 6c5f          initial_
+00044970: 7374 6174 655f 7661 6c75 655f 7072 6564  state_value_pred
+00044980: 6963 7469 6f6e 2c0a 2020 2020 2020 2020  iction,.        
+00044990: 2020 2020 2020 2020 2020 2020 7374 6174              stat
+000449a0: 655f 6163 7469 6f6e 5f6d 6172 6769 6e61  e_action_margina
+000449b0: 6c5f 696d 706f 7274 616e 6365 5f77 6569  l_importance_wei
+000449c0: 6768 742c 0a20 2020 2020 2020 2020 2020  ght,.           
+000449d0: 2020 2020 2020 2020 2073 7461 7465 5f6d           state_m
+000449e0: 6172 6769 6e61 6c5f 696d 706f 7274 616e  arginal_importan
+000449f0: 6365 5f77 6569 6768 742c 0a20 2020 2020  ce_weight,.     
+00044a00: 2020 2020 2020 2020 2020 2020 2020 206f                 o
+00044a10: 6e5f 706f 6c69 6379 5f70 6f6c 6963 795f  n_policy_policy_
+00044a20: 7661 6c75 652c 0a20 2020 2020 2020 2020  value,.         
+00044a30: 2020 2020 2020 2020 2020 2067 616d 6d61             gamma
+00044a40: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00044a50: 2020 2020 2020 6265 6861 7669 6f72 5f70        behavior_p
+00044a60: 6f6c 6963 792c 0a20 2020 2020 2020 2020  olicy,.         
+00044a70: 2020 2020 2020 2020 2020 2065 7661 6c75             evalu
+00044a80: 6174 696f 6e5f 706f 6c69 6379 2c0a 2020  ation_policy,.  
+00044a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00044aa0: 2020 6461 7461 7365 745f 6964 2c0a 2020    dataset_id,.  
+00044ab0: 2020 2020 2020 2020 2020 2020 2020 5d0a                ].
+00044ac0: 0a20 2020 2020 2020 2020 2020 202e 2e20  .            .. 
+00044ad0: 7365 6561 6c73 6f3a 3a0a 0a20 2020 2020  seealso::..     
+00044ae0: 2020 2020 2020 2020 2020 203a 636c 6173             :clas
+00044af0: 733a 6073 636f 7065 5f72 6c2e 6f70 652e  s:`scope_rl.ope.
+00044b00: 696e 7075 742e 4372 6561 7465 4f50 4549  input.CreateOPEI
+00044b10: 6e70 7574 6020 6465 7363 7269 6265 7320  nput` describes 
+00044b20: 7468 6520 636f 6d70 6f6e 656e 7473 206f  the components o
+00044b30: 6620 3a63 6c61 7373 3a60 696e 7075 745f  f :class:`input_
+00044b40: 6469 6374 602e 0a0a 2020 2020 2020 2020  dict`...        
+00044b50: 636f 6d70 6172 6564 5f65 7374 696d 6174  compared_estimat
+00044b60: 6f72 733a 206c 6973 7420 6f66 2073 7472  ors: list of str
+00044b70: 2c20 6465 6661 756c 743d 4e6f 6e65 0a20  , default=None. 
+00044b80: 2020 2020 2020 2020 2020 204e 616d 6520             Name 
+00044b90: 6f66 2063 6f6d 7061 7265 6420 6573 7469  of compared esti
+00044ba0: 6d61 746f 7273 2e0a 2020 2020 2020 2020  mators..        
+00044bb0: 2020 2020 4966 2060 4e6f 6e65 6020 6973      If `None` is
+00044bc0: 2067 6976 656e 2c20 616c 6c20 7468 6520   given, all the 
+00044bd0: 6573 7469 6d61 746f 7273 2061 7265 2063  estimators are c
+00044be0: 6f6d 7061 7265 642e 0a0a 2020 2020 2020  ompared...      
+00044bf0: 2020 6265 6861 7669 6f72 5f70 6f6c 6963    behavior_polic
+00044c00: 795f 6e61 6d65 3a20 7374 722c 2064 6566  y_name: str, def
+00044c10: 6175 6c74 3d4e 6f6e 650a 2020 2020 2020  ault=None.      
+00044c20: 2020 2020 2020 4e61 6d65 206f 6620 7468        Name of th
+00044c30: 6520 6265 6861 7669 6f72 2070 6f6c 6963  e behavior polic
+00044c40: 792e 0a0a 2020 2020 2020 2020 616c 7068  y...        alph
+00044c50: 613a 2066 6c6f 6174 203d 2030 2e30 352e  a: float = 0.05.
+00044c60: 0a20 2020 2020 2020 2020 2020 2050 726f  .            Pro
+00044c70: 706f 7274 696f 6e20 6f66 2074 6865 2073  portion of the s
+00044c80: 6861 6465 6420 7265 6769 6f6e 2069 6e20  haded region in 
+00044c90: 4356 6152 2065 7374 696d 6174 652e 2054  CVaR estimate. T
+00044ca0: 6865 2076 616c 7565 2073 686f 756c 6420  he value should 
+00044cb0: 6265 2077 6974 6869 6e20 605b 302c 2031  be within `[0, 1
+00044cc0: 2960 2e0a 0a20 2020 2020 2020 2070 6c6f  )`...        plo
+00044cd0: 745f 7479 7065 3a20 7b22 6369 222c 2022  t_type: {"ci", "
+00044ce0: 7363 6174 7465 7222 2c20 2276 696f 6c69  scatter", "violi
+00044cf0: 6e22 7d2c 2064 6566 6175 6c74 3d22 6369  n"}, default="ci
+00044d00: 220a 2020 2020 2020 2020 2020 2020 5479  ".            Ty
+00044d10: 7065 206f 6620 706c 6f74 2e0a 2020 2020  pe of plot..    
+00044d20: 2020 2020 2020 2020 4966 2022 6369 2220          If "ci" 
+00044d30: 6973 2067 6976 656e 2c20 7765 2067 6574  is given, we get
+00044d40: 2074 6865 2065 6d70 6972 6963 616c 2061   the empirical a
+00044d50: 7665 7261 6765 206f 6620 7468 6520 6573  verage of the es
+00044d60: 7469 6d61 7465 6420 7661 6c75 6573 2077  timated values w
+00044d70: 6974 6820 7468 6569 7220 6573 7469 6d61  ith their estima
+00044d80: 7465 6420 636f 6e66 6964 656e 6365 2069  ted confidence i
+00044d90: 6e74 6572 7661 6c73 2e0a 2020 2020 2020  ntervals..      
+00044da0: 2020 2020 2020 4966 2022 7363 6174 7465        If "scatte
+00044db0: 7222 2069 7320 6769 7665 6e2c 2077 6520  r" is given, we 
+00044dc0: 6765 7420 6120 7363 6174 7465 7220 706c  get a scatter pl
+00044dd0: 6f74 206f 6620 6573 7469 6d61 7465 6420  ot of estimated 
+00044de0: 7661 6c75 6573 2e0a 0a20 2020 2020 2020  values...       
+00044df0: 2068 7565 3a20 7b22 6573 7469 6d61 746f   hue: {"estimato
+00044e00: 7222 2c20 2270 6f6c 6963 7922 7d2c 2064  r", "policy"}, d
+00044e10: 6566 6175 6c74 3d22 6573 7469 6d61 746f  efault="estimato
+00044e20: 7222 0a20 2020 2020 2020 2020 2020 2048  r".            H
+00044e30: 7565 206f 6620 7468 6520 706c 6f74 2e0a  ue of the plot..
+00044e40: 0a20 2020 2020 2020 206c 6567 656e 643a  .        legend:
+00044e50: 2062 6f6f 6c2c 2064 6566 6175 6c74 3d54   bool, default=T
+00044e60: 7275 650a 2020 2020 2020 2020 2020 2020  rue.            
+00044e70: 5768 6574 6865 7220 746f 2069 6e63 6c75  Whether to inclu
+00044e80: 6465 2061 206c 6567 656e 6420 696e 2074  de a legend in t
+00044e90: 6865 2073 6361 7474 6572 2070 6c6f 742e  he scatter plot.
+00044ea0: 0a0a 2020 2020 2020 2020 7368 6172 6579  ..        sharey
+00044eb0: 3a20 626f 6f6c 2c20 6465 6661 756c 743d  : bool, default=
+00044ec0: 4661 6c73 650a 2020 2020 2020 2020 2020  False.          
+00044ed0: 2020 4966 2060 5472 7565 602c 2074 6865    If `True`, the
+00044ee0: 2079 2d61 7869 7320 7769 6c6c 2062 6520   y-axis will be 
+00044ef0: 7368 6172 6564 2061 6d6f 6e67 2064 6966  shared among dif
+00044f00: 6665 7265 6e74 2065 7374 696d 6174 6f72  ferent estimator
+00044f10: 7320 6f72 2065 7661 6c75 6174 696f 6e20  s or evaluation 
+00044f20: 706f 6c69 6369 6573 2e0a 0a20 2020 2020  policies...     
+00044f30: 2020 2066 6967 5f64 6972 3a20 5061 7468     fig_dir: Path
+00044f40: 2c20 6465 6661 756c 743d 4e6f 6e65 0a20  , default=None. 
+00044f50: 2020 2020 2020 2020 2020 2050 6174 6820             Path 
+00044f60: 746f 2073 746f 7265 2074 6865 2062 6172  to store the bar
+00044f70: 2066 6967 7572 652e 0a20 2020 2020 2020   figure..       
+00044f80: 2020 2020 2049 6620 604e 6f6e 6560 2069       If `None` i
+00044f90: 7320 6769 7665 6e2c 2074 6865 2066 6967  s given, the fig
+00044fa0: 7572 6520 7769 6c6c 206e 6f74 2062 6520  ure will not be 
+00044fb0: 7361 7665 642e 0a0a 2020 2020 2020 2020  saved...        
+00044fc0: 6669 675f 6e61 6d65 3a20 7374 722c 2064  fig_name: str, d
+00044fd0: 6566 6175 6c74 3d22 6573 7469 6d61 7465  efault="estimate
+00044fe0: 645f 636f 6e64 6974 696f 6e61 6c5f 7661  d_conditional_va
+00044ff0: 6c75 655f 6174 5f72 6973 6b5f 6d75 6c74  lue_at_risk_mult
+00045000: 6970 6c65 2e70 6e67 220a 2020 2020 2020  iple.png".      
+00045010: 2020 2020 2020 4e61 6d65 206f 6620 7468        Name of th
+00045020: 6520 6261 7220 6669 6775 7265 2e0a 0a20  e bar figure... 
+00045030: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00045040: 2020 2063 6f6d 7061 7265 645f 6573 7469     compared_esti
+00045050: 6d61 746f 7273 203d 2073 656c 662e 5f63  mators = self._c
+00045060: 6865 636b 5f63 6f6d 7061 7265 645f 6573  heck_compared_es
+00045070: 7469 6d61 746f 7273 2863 6f6d 7061 7265  timators(compare
+00045080: 645f 6573 7469 6d61 746f 7273 290a 2020  d_estimators).  
+00045090: 2020 2020 2020 7365 6c66 2e5f 6368 6563        self._chec
+000450a0: 6b5f 6261 7369 635f 7669 7375 616c 697a  k_basic_visualiz
+000450b0: 6174 696f 6e5f 696e 7075 7473 280a 2020  ation_inputs(.  
+000450c0: 2020 2020 2020 2020 2020 6875 653d 6875            hue=hu
+000450d0: 652c 2066 6967 5f64 6972 3d66 6967 5f64  e, fig_dir=fig_d
+000450e0: 6972 2c20 6669 675f 6e61 6d65 3d66 6967  ir, fig_name=fig
+000450f0: 5f6e 616d 650a 2020 2020 2020 2020 290a  _name.        ).
+00045100: 2020 2020 2020 2020 7365 6c66 2e5f 6368          self._ch
+00045110: 6563 6b5f 696e 7075 745f 6469 6374 5f66  eck_input_dict_f
+00045120: 6f72 5f76 6973 7561 6c69 7a65 5f6d 756c  or_visualize_mul
+00045130: 7469 706c 655f 6573 7469 6d61 7465 7328  tiple_estimates(
+00045140: 696e 7075 745f 6469 6374 290a 0a20 2020  input_dict)..   
+00045150: 2020 2020 2069 6620 6c65 6e28 696e 7075       if len(inpu
+00045160: 745f 6469 6374 2e62 6568 6176 696f 725f  t_dict.behavior_
+00045170: 706f 6c69 6379 5f6e 616d 6573 2920 3d3d  policy_names) ==
+00045180: 2031 3a0a 2020 2020 2020 2020 2020 2020   1:.            
+00045190: 6265 6861 7669 6f72 5f70 6f6c 6963 795f  behavior_policy_
+000451a0: 6e61 6d65 203d 2069 6e70 7574 5f64 6963  name = input_dic
+000451b0: 742e 6265 6861 7669 6f72 5f70 6f6c 6963  t.behavior_polic
+000451c0: 795f 6e61 6d65 735b 305d 0a0a 2020 2020  y_names[0]..    
+000451d0: 2020 2020 6376 6172 5f64 6963 745f 203d      cvar_dict_ =
+000451e0: 2073 656c 662e 6573 7469 6d61 7465 5f63   self.estimate_c
+000451f0: 6f6e 6469 7469 6f6e 616c 5f76 616c 7565  onditional_value
+00045200: 5f61 745f 7269 736b 280a 2020 2020 2020  _at_risk(.      
+00045210: 2020 2020 2020 696e 7075 745f 6469 6374        input_dict
+00045220: 3d69 6e70 7574 5f64 6963 742c 0a20 2020  =input_dict,.   
+00045230: 2020 2020 2020 2020 2063 6f6d 7061 7265           compare
+00045240: 645f 6573 7469 6d61 746f 7273 3d63 6f6d  d_estimators=com
+00045250: 7061 7265 645f 6573 7469 6d61 746f 7273  pared_estimators
+00045260: 2c0a 2020 2020 2020 2020 2020 2020 6265  ,.            be
+00045270: 6861 7669 6f72 5f70 6f6c 6963 795f 6e61  havior_policy_na
+00045280: 6d65 3d62 6568 6176 696f 725f 706f 6c69  me=behavior_poli
+00045290: 6379 5f6e 616d 652c 0a20 2020 2020 2020  cy_name,.       
+000452a0: 2020 2020 2061 6c70 6861 733d 616c 7068       alphas=alph
+000452b0: 612c 0a20 2020 2020 2020 2029 0a0a 2020  a,.        )..  
+000452c0: 2020 2020 2020 6966 2062 6568 6176 696f        if behavio
+000452d0: 725f 706f 6c69 6379 5f6e 616d 6520 6973  r_policy_name is
+000452e0: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+000452f0: 2020 2063 7661 725f 6469 6374 203d 2064     cvar_dict = d
+00045300: 6566 6175 6c74 6469 6374 286c 616d 6264  efaultdict(lambd
+00045310: 613a 2064 6566 6175 6c74 6469 6374 2864  a: defaultdict(d
+00045320: 6963 7429 290a 0a20 2020 2020 2020 2020  ict))..         
+00045330: 2020 2066 6f72 2062 6568 6176 696f 725f     for behavior_
+00045340: 706f 6c69 6379 2c20 6e5f 6461 7461 7365  policy, n_datase
+00045350: 7473 2069 6e20 696e 7075 745f 6469 6374  ts in input_dict
+00045360: 2e6e 5f64 6174 6173 6574 732e 6974 656d  .n_datasets.item
+00045370: 7328 293a 0a20 2020 2020 2020 2020 2020  s():.           
+00045380: 2020 2020 2069 6e70 7574 5f64 6963 745f       input_dict_
+00045390: 3020 3d20 696e 7075 745f 6469 6374 2e67  0 = input_dict.g
+000453a0: 6574 280a 2020 2020 2020 2020 2020 2020  et(.            
+000453b0: 2020 2020 2020 2020 6265 6861 7669 6f72          behavior
+000453c0: 5f70 6f6c 6963 795f 6e61 6d65 3d62 6568  _policy_name=beh
+000453d0: 6176 696f 725f 706f 6c69 6379 2c20 6461  avior_policy, da
+000453e0: 7461 7365 745f 6964 3d30 0a20 2020 2020  taset_id=0.     
+000453f0: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
+00045400: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+00045410: 7220 6576 616c 5f70 6f6c 6963 7920 696e  r eval_policy in
+00045420: 2069 6e70 7574 5f64 6963 745f 302e 6b65   input_dict_0.ke
+00045430: 7973 2829 3a0a 2020 2020 2020 2020 2020  ys():.          
+00045440: 2020 2020 2020 2020 2020 666f 7220 6573            for es
+00045450: 7469 6d61 746f 7220 696e 2063 6f6d 7061  timator in compa
+00045460: 7265 645f 6573 7469 6d61 746f 7273 3a0a  red_estimators:.
+00045470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00045480: 2020 2020 2020 2020 6376 6172 203d 206e          cvar = n
+00045490: 702e 7a65 726f 7328 286e 5f64 6174 6173  p.zeros((n_datas
+000454a0: 6574 732c 2929 0a20 2020 2020 2020 2020  ets,)).         
+000454b0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+000454c0: 6f72 2064 6174 6173 6574 5f69 645f 2069  or dataset_id_ i
+000454d0: 6e20 7261 6e67 6528 6e5f 6461 7461 7365  n range(n_datase
+000454e0: 7473 293a 0a20 2020 2020 2020 2020 2020  ts):.           
+000454f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00045500: 2063 7661 725b 6461 7461 7365 745f 6964   cvar[dataset_id
+00045510: 5f5d 203d 2063 7661 725f 6469 6374 5f5b  _] = cvar_dict_[
+00045520: 6265 6861 7669 6f72 5f70 6f6c 6963 795d  behavior_policy]
+00045530: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
+00045540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00045550: 2020 6461 7461 7365 745f 6964 5f0a 2020    dataset_id_.  
+00045560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00045570: 2020 2020 2020 2020 2020 5d5b 6576 616c            ][eval
+00045580: 5f70 6f6c 6963 795d 5b65 7374 696d 6174  _policy][estimat
+00045590: 6f72 5d0a 0a20 2020 2020 2020 2020 2020  or]..           
+000455a0: 2020 2020 2020 2020 2020 2020 2063 7661               cva
+000455b0: 725f 6469 6374 5b62 6568 6176 696f 725f  r_dict[behavior_
+000455c0: 706f 6c69 6379 5d5b 6576 616c 5f70 6f6c  policy][eval_pol
+000455d0: 6963 795d 5b65 7374 696d 6174 6f72 5d20  icy][estimator] 
+000455e0: 3d20 6376 6172 0a0a 2020 2020 2020 2020  = cvar..        
+000455f0: 2020 2020 2020 2020 2020 2020 6f6e 5f70              on_p
+00045600: 6f6c 6963 7920 3d20 696e 7075 745f 6469  olicy = input_di
+00045610: 6374 5f30 5b65 7661 6c5f 706f 6c69 6379  ct_0[eval_policy
+00045620: 5d5b 226f 6e5f 706f 6c69 6379 5f70 6f6c  ]["on_policy_pol
+00045630: 6963 795f 7661 6c75 6522 5d0a 0a20 2020  icy_value"]..   
+00045640: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00045650: 2069 6620 6f6e 5f70 6f6c 6963 7920 6973   if on_policy is
+00045660: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
 00045670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045680: 2063 7661 725f 6469 6374 5b62 6568 6176   cvar_dict[behav
-00045690: 696f 725f 706f 6c69 6379 5d5b 6576 616c  ior_policy][eval
-000456a0: 5f70 6f6c 6963 795d 5b65 7374 696d 6174  _policy][estimat
-000456b0: 6f72 5d20 3d20 6376 6172 0a0a 2020 2020  or] = cvar..    
-000456c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000456d0: 6f6e 5f70 6f6c 6963 7920 3d20 696e 7075  on_policy = inpu
-000456e0: 745f 6469 6374 5f30 5b65 7661 6c5f 706f  t_dict_0[eval_po
-000456f0: 6c69 6379 5d5b 226f 6e5f 706f 6c69 6379  licy]["on_policy
-00045700: 5f70 6f6c 6963 795f 7661 6c75 6522 5d0a  _policy_value"].
-00045710: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00045720: 2020 2020 2069 6620 6f6e 5f70 6f6c 6963       if on_polic
-00045730: 7920 6973 206e 6f74 204e 6f6e 653a 0a20  y is not None:. 
-00045740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045750: 2020 2020 2020 2063 7661 725f 6964 7820         cvar_idx 
-00045760: 3d20 696e 7428 616c 7068 6120 2a20 6c65  = int(alpha * le
-00045770: 6e28 6f6e 5f70 6f6c 6963 7929 290a 2020  n(on_policy)).  
+00045680: 2020 2063 7661 725f 6964 7820 3d20 696e     cvar_idx = in
+00045690: 7428 616c 7068 6120 2a20 6c65 6e28 6f6e  t(alpha * len(on
+000456a0: 5f70 6f6c 6963 7929 290a 2020 2020 2020  _policy)).      
+000456b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000456c0: 2020 6376 6172 5f64 6963 745b 6265 6861    cvar_dict[beha
+000456d0: 7669 6f72 5f70 6f6c 6963 795d 5b65 7661  vior_policy][eva
+000456e0: 6c5f 706f 6c69 6379 5d5b 0a20 2020 2020  l_policy][.     
+000456f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00045700: 2020 2020 2020 2022 6f6e 5f70 6f6c 6963         "on_polic
+00045710: 7922 0a20 2020 2020 2020 2020 2020 2020  y".             
+00045720: 2020 2020 2020 2020 2020 205d 203d 206e             ] = n
+00045730: 702e 7061 7274 6974 696f 6e28 6f6e 5f70  p.partition(on_p
+00045740: 6f6c 6963 792c 2063 7661 725f 6964 7829  olicy, cvar_idx)
+00045750: 5b3a 6376 6172 5f69 6478 5d2e 6d65 616e  [:cvar_idx].mean
+00045760: 2829 0a20 2020 2020 2020 2020 2020 2020  ().             
+00045770: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
 00045780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045790: 2020 2020 2020 6376 6172 5f64 6963 745b        cvar_dict[
-000457a0: 6265 6861 7669 6f72 5f70 6f6c 6963 795d  behavior_policy]
-000457b0: 5b65 7661 6c5f 706f 6c69 6379 5d5b 0a20  [eval_policy][. 
-000457c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000457d0: 2020 2020 2020 2020 2020 2022 6f6e 5f70             "on_p
-000457e0: 6f6c 6963 7922 0a20 2020 2020 2020 2020  olicy".         
-000457f0: 2020 2020 2020 2020 2020 2020 2020 205d                 ]
-00045800: 203d 206e 702e 7061 7274 6974 696f 6e28   = np.partition(
-00045810: 6f6e 5f70 6f6c 6963 792c 2063 7661 725f  on_policy, cvar_
-00045820: 6964 7829 5b3a 6376 6172 5f69 6478 5d2e  idx)[:cvar_idx].
-00045830: 6d65 616e 2829 0a20 2020 2020 2020 2020  mean().         
-00045840: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-00045850: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00045860: 2020 2020 2020 2020 2063 7661 725f 6469           cvar_di
-00045870: 6374 5b62 6568 6176 696f 725f 706f 6c69  ct[behavior_poli
-00045880: 6379 5d5b 6576 616c 5f70 6f6c 6963 795d  cy][eval_policy]
-00045890: 5b22 6f6e 5f70 6f6c 6963 7922 5d20 3d20  ["on_policy"] = 
-000458a0: 4e6f 6e65 0a0a 2020 2020 2020 2020 656c  None..        el
-000458b0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-000458c0: 6376 6172 5f64 6963 7420 3d20 6465 6661  cvar_dict = defa
-000458d0: 756c 7464 6963 7428 6469 6374 290a 0a20  ultdict(dict).. 
-000458e0: 2020 2020 2020 2020 2020 2069 6e70 7574             input
-000458f0: 5f64 6963 745f 3020 3d20 696e 7075 745f  _dict_0 = input_
-00045900: 6469 6374 2e67 6574 280a 2020 2020 2020  dict.get(.      
-00045910: 2020 2020 2020 2020 2020 6265 6861 7669            behavi
-00045920: 6f72 5f70 6f6c 6963 795f 6e61 6d65 3d62  or_policy_name=b
-00045930: 6568 6176 696f 725f 706f 6c69 6379 5f6e  ehavior_policy_n
-00045940: 616d 652c 2064 6174 6173 6574 5f69 643d  ame, dataset_id=
-00045950: 300a 2020 2020 2020 2020 2020 2020 290a  0.            ).
-00045960: 2020 2020 2020 2020 2020 2020 6e5f 6461              n_da
-00045970: 7461 7365 7473 203d 2069 6e70 7574 5f64  tasets = input_d
-00045980: 6963 742e 6e5f 6461 7461 7365 7473 5b62  ict.n_datasets[b
-00045990: 6568 6176 696f 725f 706f 6c69 6379 5f6e  ehavior_policy_n
-000459a0: 616d 655d 0a0a 2020 2020 2020 2020 2020  ame]..          
-000459b0: 2020 666f 7220 6576 616c 5f70 6f6c 6963    for eval_polic
-000459c0: 7920 696e 2069 6e70 7574 5f64 6963 745f  y in input_dict_
-000459d0: 302e 6b65 7973 2829 3a0a 2020 2020 2020  0.keys():.      
-000459e0: 2020 2020 2020 2020 2020 666f 7220 6573            for es
-000459f0: 7469 6d61 746f 7220 696e 2063 6f6d 7061  timator in compa
-00045a00: 7265 645f 6573 7469 6d61 746f 7273 3a0a  red_estimators:.
-00045a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045a20: 2020 2020 6376 6172 203d 206e 702e 7a65      cvar = np.ze
-00045a30: 726f 7328 286e 5f64 6174 6173 6574 732c  ros((n_datasets,
-00045a40: 2929 0a20 2020 2020 2020 2020 2020 2020  )).             
-00045a50: 2020 2020 2020 2066 6f72 2064 6174 6173         for datas
-00045a60: 6574 5f69 645f 2069 6e20 7261 6e67 6528  et_id_ in range(
-00045a70: 6e5f 6461 7461 7365 7473 293a 0a20 2020  n_datasets):.   
-00045a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045a90: 2020 2020 2063 7661 725b 6461 7461 7365       cvar[datase
-00045aa0: 745f 6964 5f5d 203d 2063 7661 725f 6469  t_id_] = cvar_di
-00045ab0: 6374 5f5b 6461 7461 7365 745f 6964 5f5d  ct_[dataset_id_]
-00045ac0: 5b65 7661 6c5f 706f 6c69 6379 5d5b 0a20  [eval_policy][. 
-00045ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045ae0: 2020 2020 2020 2020 2020 2065 7374 696d             estim
-00045af0: 6174 6f72 0a20 2020 2020 2020 2020 2020  ator.           
-00045b00: 2020 2020 2020 2020 2020 2020 205d 0a0a               ]..
-00045b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045b20: 2020 2020 6376 6172 5f64 6963 745b 6576      cvar_dict[ev
-00045b30: 616c 5f70 6f6c 6963 795d 5b65 7374 696d  al_policy][estim
-00045b40: 6174 6f72 5d20 3d20 6376 6172 0a0a 2020  ator] = cvar..  
-00045b50: 2020 2020 2020 2020 2020 2020 2020 6f6e                on
-00045b60: 5f70 6f6c 6963 7920 3d20 696e 7075 745f  _policy = input_
-00045b70: 6469 6374 5f30 5b65 7661 6c5f 706f 6c69  dict_0[eval_poli
-00045b80: 6379 5d5b 226f 6e5f 706f 6c69 6379 5f70  cy]["on_policy_p
-00045b90: 6f6c 6963 795f 7661 6c75 6522 5d0a 0a20  olicy_value"].. 
-00045ba0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00045bb0: 6620 6f6e 5f70 6f6c 6963 7920 6973 206e  f on_policy is n
-00045bc0: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
-00045bd0: 2020 2020 2020 2020 2020 2020 2063 7661               cva
-00045be0: 725f 6964 7820 3d20 696e 7428 616c 7068  r_idx = int(alph
-00045bf0: 6120 2a20 6c65 6e28 6f6e 5f70 6f6c 6963  a * len(on_polic
-00045c00: 7929 290a 2020 2020 2020 2020 2020 2020  y)).            
-00045c10: 2020 2020 2020 2020 6376 6172 5f64 6963          cvar_dic
-00045c20: 745b 6576 616c 5f70 6f6c 6963 795d 5b22  t[eval_policy]["
-00045c30: 6f6e 5f70 6f6c 6963 7922 5d20 3d20 6e70  on_policy"] = np
-00045c40: 2e70 6172 7469 7469 6f6e 280a 2020 2020  .partition(.    
-00045c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045c60: 2020 2020 6f6e 5f70 6f6c 6963 792c 2063      on_policy, c
-00045c70: 7661 725f 6964 780a 2020 2020 2020 2020  var_idx.        
-00045c80: 2020 2020 2020 2020 2020 2020 295b 3a63              )[:c
-00045c90: 7661 725f 6964 785d 2e6d 6561 6e28 290a  var_idx].mean().
-00045ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045cb0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-00045cc0: 2020 2020 2020 2020 2020 6376 6172 5f64            cvar_d
-00045cd0: 6963 745b 6576 616c 5f70 6f6c 6963 795d  ict[eval_policy]
-00045ce0: 5b22 6f6e 5f70 6f6c 6963 7922 5d20 3d20  ["on_policy"] = 
-00045cf0: 4e6f 6e65 0a0a 2020 2020 2020 2020 6376  None..        cv
-00045d00: 6172 5f64 6963 7420 3d20 6465 6661 756c  ar_dict = defaul
-00045d10: 7464 6963 745f 746f 5f64 6963 7428 6376  tdict_to_dict(cv
-00045d20: 6172 5f64 6963 7429 0a0a 2020 2020 2020  ar_dict)..      
-00045d30: 2020 7365 6c66 2e5f 7669 7375 616c 697a    self._visualiz
-00045d40: 655f 6f66 665f 706f 6c69 6379 5f65 7374  e_off_policy_est
-00045d50: 696d 6174 6573 5f77 6974 685f 6d75 6c74  imates_with_mult
-00045d60: 6970 6c65 5f65 7374 696d 6174 6573 280a  iple_estimates(.
-00045d70: 2020 2020 2020 2020 2020 2020 696e 7075              inpu
-00045d80: 745f 6469 6374 3d69 6e70 7574 5f64 6963  t_dict=input_dic
-00045d90: 742c 0a20 2020 2020 2020 2020 2020 2065  t,.            e
-00045da0: 7374 696d 6174 696f 6e5f 6469 6374 3d63  stimation_dict=c
-00045db0: 7661 725f 6469 6374 2c0a 2020 2020 2020  var_dict,.      
-00045dc0: 2020 2020 2020 636f 6d70 6172 6564 5f65        compared_e
-00045dd0: 7374 696d 6174 6f72 733d 636f 6d70 6172  stimators=compar
-00045de0: 6564 5f65 7374 696d 6174 6f72 732c 0a20  ed_estimators,. 
-00045df0: 2020 2020 2020 2020 2020 2062 6568 6176             behav
-00045e00: 696f 725f 706f 6c69 6379 5f6e 616d 653d  ior_policy_name=
-00045e10: 6265 6861 7669 6f72 5f70 6f6c 6963 795f  behavior_policy_
-00045e20: 6e61 6d65 2c0a 2020 2020 2020 2020 2020  name,.          
-00045e30: 2020 796c 6162 656c 3d66 2245 7374 696d    ylabel=f"Estim
-00045e40: 6174 6564 2043 5661 5220 287b 616c 7068  ated CVaR ({alph
-00045e50: 617d 2922 2c0a 2020 2020 2020 2020 2020  a})",.          
-00045e60: 2020 706c 6f74 5f74 7970 653d 706c 6f74    plot_type=plot
-00045e70: 5f74 7970 652c 0a20 2020 2020 2020 2020  _type,.         
-00045e80: 2020 2068 7565 3d68 7565 2c0a 2020 2020     hue=hue,.    
-00045e90: 2020 2020 2020 2020 6c65 6765 6e64 3d6c          legend=l
-00045ea0: 6567 656e 642c 0a20 2020 2020 2020 2020  egend,.         
-00045eb0: 2020 2073 6861 7265 793d 7368 6172 6579     sharey=sharey
-00045ec0: 2c0a 2020 2020 2020 2020 2020 2020 6669  ,.            fi
-00045ed0: 675f 6469 723d 6669 675f 6469 722c 0a20  g_dir=fig_dir,. 
-00045ee0: 2020 2020 2020 2020 2020 2066 6967 5f6e             fig_n
-00045ef0: 616d 653d 6669 675f 6e61 6d65 2c0a 2020  ame=fig_name,.  
-00045f00: 2020 2020 2020 290a 0a20 2020 2064 6566        )..    def
-00045f10: 2076 6973 7561 6c69 7a65 5f6c 6f77 6572   visualize_lower
-00045f20: 5f71 7561 7274 696c 655f 7769 7468 5f6d  _quartile_with_m
-00045f30: 756c 7469 706c 655f 6573 7469 6d61 7465  ultiple_estimate
-00045f40: 7328 0a20 2020 2020 2020 2073 656c 662c  s(.        self,
-00045f50: 0a20 2020 2020 2020 2069 6e70 7574 5f64  .        input_d
-00045f60: 6963 743a 204d 756c 7469 706c 6549 6e70  ict: MultipleInp
-00045f70: 7574 4469 6374 2c0a 2020 2020 2020 2020  utDict,.        
-00045f80: 636f 6d70 6172 6564 5f65 7374 696d 6174  compared_estimat
-00045f90: 6f72 733a 204f 7074 696f 6e61 6c5b 4c69  ors: Optional[Li
-00045fa0: 7374 5b73 7472 5d5d 203d 204e 6f6e 652c  st[str]] = None,
-00045fb0: 0a20 2020 2020 2020 2062 6568 6176 696f  .        behavio
-00045fc0: 725f 706f 6c69 6379 5f6e 616d 653a 204f  r_policy_name: O
-00045fd0: 7074 696f 6e61 6c5b 7374 725d 203d 204e  ptional[str] = N
-00045fe0: 6f6e 652c 0a20 2020 2020 2020 2061 6c70  one,.        alp
-00045ff0: 6861 3a20 666c 6f61 7420 3d20 302e 3035  ha: float = 0.05
-00046000: 2c0a 2020 2020 2020 2020 706c 6f74 5f74  ,.        plot_t
-00046010: 7970 653a 2073 7472 203d 2022 6369 222c  ype: str = "ci",
-00046020: 0a20 2020 2020 2020 2068 7565 3a20 7374  .        hue: st
-00046030: 7220 3d20 2265 7374 696d 6174 6f72 222c  r = "estimator",
-00046040: 0a20 2020 2020 2020 206c 6567 656e 643a  .        legend:
-00046050: 2062 6f6f 6c20 3d20 5472 7565 2c0a 2020   bool = True,.  
-00046060: 2020 2020 2020 7368 6172 6579 3a20 626f        sharey: bo
-00046070: 6f6c 203d 2046 616c 7365 2c0a 2020 2020  ol = False,.    
-00046080: 2020 2020 6669 675f 6469 723a 204f 7074      fig_dir: Opt
-00046090: 696f 6e61 6c5b 5061 7468 5d20 3d20 4e6f  ional[Path] = No
-000460a0: 6e65 2c0a 2020 2020 2020 2020 6669 675f  ne,.        fig_
-000460b0: 6e61 6d65 3a20 7374 7220 3d20 2265 7374  name: str = "est
-000460c0: 696d 6174 6564 5f63 6f6e 6469 7469 6f6e  imated_condition
-000460d0: 616c 5f76 616c 7565 5f61 745f 7269 736b  al_value_at_risk
-000460e0: 5f6d 756c 7469 706c 652e 706e 6722 2c0a  _multiple.png",.
-000460f0: 2020 2020 2920 2d3e 204e 6f6e 653a 0a20      ) -> None:. 
-00046100: 2020 2020 2020 2022 2222 5669 7375 616c         """Visual
-00046110: 697a 6520 7468 6520 6c6f 7765 7220 7175  ize the lower qu
-00046120: 6172 7469 6c65 206f 6620 7468 6520 7472  artile of the tr
-00046130: 616a 6563 746f 7279 2d77 6973 6520 7265  ajectory-wise re
-00046140: 7761 7264 2075 6e64 6572 2074 6865 2065  ward under the e
-00046150: 7661 6c75 6174 696f 6e20 706f 6c69 6379  valuation policy
-00046160: 2065 7374 696d 6174 6564 2062 7920 4f50   estimated by OP
-00046170: 4520 6573 7469 6d61 746f 7273 2061 6372  E estimators acr
-00046180: 6f73 7320 6d75 6c74 6970 6c65 206c 6f67  oss multiple log
-00046190: 6765 6420 6461 7461 7365 742e 0a0a 2020  ged dataset...  
-000461a0: 2020 2020 2020 4e6f 7465 0a20 2020 2020        Note.     
-000461b0: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 2020     -------.     
-000461c0: 2020 2054 6869 7320 6675 6e63 7469 6f6e     This function
-000461d0: 2069 7320 6170 706c 6963 6162 6c65 206f   is applicable o
-000461e0: 6e6c 7920 7768 656e 204d 756c 7469 706c  nly when Multipl
-000461f0: 654c 6f67 6765 6444 6174 6173 6574 2069  eLoggedDataset i
-00046200: 7320 7573 6564 2061 6e64 0a20 2020 2020  s used and.     
-00046210: 2020 204d 756c 7469 706c 6549 6e70 7574     MultipleInput
-00046220: 4469 6374 2069 7320 636f 6c6c 6563 7465  Dict is collecte
-00046230: 6420 6279 2074 6865 2073 616d 6520 6576  d by the same ev
-00046240: 616c 7561 7469 6f6e 2070 6f6c 6963 7920  aluation policy 
-00046250: 6163 726f 7373 206c 6f67 6765 6420 6461  across logged da
-00046260: 7461 7365 7473 2e0a 0a20 2020 2020 2020  tasets...       
-00046270: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
-00046280: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
-00046290: 2020 2020 696e 7075 745f 6469 6374 3a20      input_dict: 
-000462a0: 4f50 4549 6e70 7574 4469 6374 206f 7220  OPEInputDict or 
-000462b0: 4d75 6c74 6970 6c65 496e 7075 7444 6963  MultipleInputDic
-000462c0: 740a 2020 2020 2020 2020 2020 2020 4469  t.            Di
-000462d0: 6374 696f 6e61 7279 206f 6620 7468 6520  ctionary of the 
-000462e0: 4f50 4520 696e 7075 7473 2066 6f72 2065  OPE inputs for e
-000462f0: 6163 6820 6576 616c 7561 7469 6f6e 2070  ach evaluation p
-00046300: 6f6c 6963 792e 0a0a 2020 2020 2020 2020  olicy...        
-00046310: 2020 2020 2e2e 2063 6f64 652d 626c 6f63      .. code-bloc
-00046320: 6b3a 3a20 7079 7468 6f6e 0a0a 2020 2020  k:: python..    
-00046330: 2020 2020 2020 2020 2020 2020 6b65 793a              key:
-00046340: 205b 6576 616c 7561 7469 6f6e 5f70 6f6c   [evaluation_pol
-00046350: 6963 795d 5b0a 2020 2020 2020 2020 2020  icy][.          
-00046360: 2020 2020 2020 2020 2020 6576 616c 7561            evalua
-00046370: 7469 6f6e 5f70 6f6c 6963 795f 6163 7469  tion_policy_acti
-00046380: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
-00046390: 2020 2020 2020 2020 6576 616c 7561 7469          evaluati
-000463a0: 6f6e 5f70 6f6c 6963 795f 6163 7469 6f6e  on_policy_action
-000463b0: 5f64 6973 742c 0a20 2020 2020 2020 2020  _dist,.         
-000463c0: 2020 2020 2020 2020 2020 2073 7461 7465             state
-000463d0: 5f61 6374 696f 6e5f 7661 6c75 655f 7072  _action_value_pr
-000463e0: 6564 6963 7469 6f6e 2c0a 2020 2020 2020  ediction,.      
-000463f0: 2020 2020 2020 2020 2020 2020 2020 696e                in
-00046400: 6974 6961 6c5f 7374 6174 655f 7661 6c75  itial_state_valu
-00046410: 655f 7072 6564 6963 7469 6f6e 2c0a 2020  e_prediction,.  
-00046420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00046430: 2020 7374 6174 655f 6163 7469 6f6e 5f6d    state_action_m
-00046440: 6172 6769 6e61 6c5f 696d 706f 7274 616e  arginal_importan
-00046450: 6365 5f77 6569 6768 742c 0a20 2020 2020  ce_weight,.     
-00046460: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00046470: 7461 7465 5f6d 6172 6769 6e61 6c5f 696d  tate_marginal_im
-00046480: 706f 7274 616e 6365 5f77 6569 6768 742c  portance_weight,
-00046490: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000464a0: 2020 2020 206f 6e5f 706f 6c69 6379 5f70       on_policy_p
-000464b0: 6f6c 6963 795f 7661 6c75 652c 0a20 2020  olicy_value,.   
-000464c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000464d0: 2067 616d 6d61 2c0a 2020 2020 2020 2020   gamma,.        
-000464e0: 2020 2020 2020 2020 2020 2020 6265 6861              beha
-000464f0: 7669 6f72 5f70 6f6c 6963 792c 0a20 2020  vior_policy,.   
-00046500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00046510: 2065 7661 6c75 6174 696f 6e5f 706f 6c69   evaluation_poli
-00046520: 6379 2c0a 2020 2020 2020 2020 2020 2020  cy,.            
-00046530: 2020 2020 2020 2020 6461 7461 7365 745f          dataset_
-00046540: 6964 2c0a 2020 2020 2020 2020 2020 2020  id,.            
-00046550: 2020 2020 5d0a 0a20 2020 2020 2020 2020      ]..         
-00046560: 2020 202e 2e20 7365 6561 6c73 6f3a 3a0a     .. seealso::.
-00046570: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00046580: 203a 636c 6173 733a 6073 636f 7065 5f72   :class:`scope_r
-00046590: 6c2e 6f70 652e 696e 7075 742e 4372 6561  l.ope.input.Crea
-000465a0: 7465 4f50 4549 6e70 7574 6020 6465 7363  teOPEInput` desc
-000465b0: 7269 6265 7320 7468 6520 636f 6d70 6f6e  ribes the compon
-000465c0: 656e 7473 206f 6620 3a63 6c61 7373 3a60  ents of :class:`
-000465d0: 696e 7075 745f 6469 6374 602e 0a0a 2020  input_dict`...  
-000465e0: 2020 2020 2020 636f 6d70 6172 6564 5f65        compared_e
-000465f0: 7374 696d 6174 6f72 733a 206c 6973 7420  stimators: list 
-00046600: 6f66 2073 7472 2c20 6465 6661 756c 743d  of str, default=
-00046610: 4e6f 6e65 0a20 2020 2020 2020 2020 2020  None.           
-00046620: 204e 616d 6520 6f66 2063 6f6d 7061 7265   Name of compare
-00046630: 6420 6573 7469 6d61 746f 7273 2e0a 2020  d estimators..  
-00046640: 2020 2020 2020 2020 2020 4966 2060 4e6f            If `No
-00046650: 6e65 6020 6973 2067 6976 656e 2c20 616c  ne` is given, al
-00046660: 6c20 7468 6520 6573 7469 6d61 746f 7273  l the estimators
-00046670: 2061 7265 2063 6f6d 7061 7265 642e 0a0a   are compared...
-00046680: 2020 2020 2020 2020 6265 6861 7669 6f72          behavior
-00046690: 5f70 6f6c 6963 795f 6e61 6d65 3a20 7374  _policy_name: st
-000466a0: 722c 2064 6566 6175 6c74 3d4e 6f6e 650a  r, default=None.
-000466b0: 2020 2020 2020 2020 2020 2020 4e61 6d65              Name
-000466c0: 206f 6620 7468 6520 6265 6861 7669 6f72   of the behavior
-000466d0: 2070 6f6c 6963 792e 0a0a 2020 2020 2020   policy...      
-000466e0: 2020 616c 7068 613a 2066 6c6f 6174 203d    alpha: float =
-000466f0: 2030 2e30 352e 0a20 2020 2020 2020 2020   0.05..         
-00046700: 2020 2050 726f 706f 7274 696f 6e20 6f66     Proportion of
-00046710: 2074 6865 2073 6861 6465 6420 7265 6769   the shaded regi
-00046720: 6f6e 2069 6e20 4356 6152 2065 7374 696d  on in CVaR estim
-00046730: 6174 652e 2054 6865 2076 616c 7565 2073  ate. The value s
-00046740: 686f 756c 6420 6265 2077 6974 6869 6e20  hould be within 
-00046750: 605b 302c 2031 2960 2e0a 0a20 2020 2020  `[0, 1)`...     
-00046760: 2020 2070 6c6f 745f 7479 7065 3a20 7b22     plot_type: {"
-00046770: 6369 222c 2022 7363 6174 7465 7222 2c20  ci", "scatter", 
-00046780: 2276 696f 6c69 6e22 7d2c 2064 6566 6175  "violin"}, defau
-00046790: 6c74 3d22 6369 220a 2020 2020 2020 2020  lt="ci".        
-000467a0: 2020 2020 5479 7065 206f 6620 706c 6f74      Type of plot
-000467b0: 2e0a 2020 2020 2020 2020 2020 2020 4966  ..            If
-000467c0: 2022 6369 2220 6973 2067 6976 656e 2c20   "ci" is given, 
-000467d0: 7765 2067 6574 2074 6865 2065 6d70 6972  we get the empir
-000467e0: 6963 616c 2061 7665 7261 6765 206f 6620  ical average of 
-000467f0: 7468 6520 6573 7469 6d61 7465 6420 7661  the estimated va
-00046800: 6c75 6573 2077 6974 6820 7468 6569 7220  lues with their 
-00046810: 6573 7469 6d61 7465 6420 636f 6e66 6964  estimated confid
-00046820: 656e 6365 2069 6e74 6572 7661 6c73 2e0a  ence intervals..
-00046830: 2020 2020 2020 2020 2020 2020 4966 2022              If "
-00046840: 7363 6174 7465 7222 2069 7320 6769 7665  scatter" is give
-00046850: 6e2c 2077 6520 6765 7420 6120 7363 6174  n, we get a scat
-00046860: 7465 7220 706c 6f74 206f 6620 6573 7469  ter plot of esti
-00046870: 6d61 7465 6420 7661 6c75 6573 2e0a 0a20  mated values... 
-00046880: 2020 2020 2020 2068 7565 3a20 7b22 6573         hue: {"es
-00046890: 7469 6d61 746f 7222 2c20 2270 6f6c 6963  timator", "polic
-000468a0: 7922 7d2c 2064 6566 6175 6c74 3d22 6573  y"}, default="es
-000468b0: 7469 6d61 746f 7222 0a20 2020 2020 2020  timator".       
-000468c0: 2020 2020 2048 7565 206f 6620 7468 6520       Hue of the 
-000468d0: 706c 6f74 2e0a 0a20 2020 2020 2020 206c  plot...        l
-000468e0: 6567 656e 643a 2062 6f6f 6c2c 2064 6566  egend: bool, def
-000468f0: 6175 6c74 3d54 7275 650a 2020 2020 2020  ault=True.      
-00046900: 2020 2020 2020 5768 6574 6865 7220 746f        Whether to
-00046910: 2069 6e63 6c75 6465 2061 206c 6567 656e   include a legen
-00046920: 6420 696e 2074 6865 2073 6361 7474 6572  d in the scatter
-00046930: 2070 6c6f 742e 0a0a 2020 2020 2020 2020   plot...        
-00046940: 7368 6172 6579 3a20 626f 6f6c 2c20 6465  sharey: bool, de
-00046950: 6661 756c 743d 4661 6c73 650a 2020 2020  fault=False.    
-00046960: 2020 2020 2020 2020 4966 2060 5472 7565          If `True
-00046970: 602c 2074 6865 2079 2d61 7869 7320 7769  `, the y-axis wi
-00046980: 6c6c 2062 6520 7368 6172 6564 2061 6d6f  ll be shared amo
-00046990: 6e67 2064 6966 6665 7265 6e74 2065 7374  ng different est
-000469a0: 696d 6174 6f72 7320 6f72 2065 7661 6c75  imators or evalu
-000469b0: 6174 696f 6e20 706f 6c69 6369 6573 2e0a  ation policies..
-000469c0: 0a20 2020 2020 2020 2066 6967 5f64 6972  .        fig_dir
-000469d0: 3a20 5061 7468 2c20 6465 6661 756c 743d  : Path, default=
-000469e0: 4e6f 6e65 0a20 2020 2020 2020 2020 2020  None.           
-000469f0: 2050 6174 6820 746f 2073 746f 7265 2074   Path to store t
-00046a00: 6865 2062 6172 2066 6967 7572 652e 0a20  he bar figure.. 
-00046a10: 2020 2020 2020 2020 2020 2049 6620 604e             If `N
-00046a20: 6f6e 6560 2069 7320 6769 7665 6e2c 2074  one` is given, t
-00046a30: 6865 2066 6967 7572 6520 7769 6c6c 206e  he figure will n
-00046a40: 6f74 2062 6520 7361 7665 642e 0a0a 2020  ot be saved...  
-00046a50: 2020 2020 2020 6669 675f 6e61 6d65 3a20        fig_name: 
-00046a60: 7374 722c 2064 6566 6175 6c74 3d22 6573  str, default="es
-00046a70: 7469 6d61 7465 645f 636f 6e64 6974 696f  timated_conditio
-00046a80: 6e61 6c5f 7661 6c75 655f 6174 5f72 6973  nal_value_at_ris
-00046a90: 6b5f 6d75 6c74 6970 6c65 2e70 6e67 220a  k_multiple.png".
-00046aa0: 2020 2020 2020 2020 2020 2020 4e61 6d65              Name
-00046ab0: 206f 6620 7468 6520 6261 7220 6669 6775   of the bar figu
-00046ac0: 7265 2e0a 0a20 2020 2020 2020 2022 2222  re...        """
-00046ad0: 0a20 2020 2020 2020 2063 6f6d 7061 7265  .        compare
-00046ae0: 645f 6573 7469 6d61 746f 7273 203d 2073  d_estimators = s
-00046af0: 656c 662e 5f63 6865 636b 5f63 6f6d 7061  elf._check_compa
-00046b00: 7265 645f 6573 7469 6d61 746f 7273 2863  red_estimators(c
-00046b10: 6f6d 7061 7265 645f 6573 7469 6d61 746f  ompared_estimato
-00046b20: 7273 290a 2020 2020 2020 2020 7365 6c66  rs).        self
-00046b30: 2e5f 6368 6563 6b5f 6261 7369 635f 7669  ._check_basic_vi
-00046b40: 7375 616c 697a 6174 696f 6e5f 696e 7075  sualization_inpu
-00046b50: 7473 280a 2020 2020 2020 2020 2020 2020  ts(.            
-00046b60: 6875 653d 6875 652c 2066 6967 5f64 6972  hue=hue, fig_dir
-00046b70: 3d66 6967 5f64 6972 2c20 6669 675f 6e61  =fig_dir, fig_na
-00046b80: 6d65 3d66 6967 5f6e 616d 650a 2020 2020  me=fig_name.    
-00046b90: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
-00046ba0: 6c66 2e5f 6368 6563 6b5f 696e 7075 745f  lf._check_input_
-00046bb0: 6469 6374 5f66 6f72 5f76 6973 7561 6c69  dict_for_visuali
-00046bc0: 7a65 5f6d 756c 7469 706c 655f 6573 7469  ze_multiple_esti
-00046bd0: 6d61 7465 7328 696e 7075 745f 6469 6374  mates(input_dict
-00046be0: 290a 0a20 2020 2020 2020 2069 6620 6c65  )..        if le
-00046bf0: 6e28 696e 7075 745f 6469 6374 2e62 6568  n(input_dict.beh
-00046c00: 6176 696f 725f 706f 6c69 6379 5f6e 616d  avior_policy_nam
-00046c10: 6573 2920 3d3d 2031 3a0a 2020 2020 2020  es) == 1:.      
-00046c20: 2020 2020 2020 6265 6861 7669 6f72 5f70        behavior_p
-00046c30: 6f6c 6963 795f 6e61 6d65 203d 2069 6e70  olicy_name = inp
-00046c40: 7574 5f64 6963 742e 6265 6861 7669 6f72  ut_dict.behavior
-00046c50: 5f70 6f6c 6963 795f 6e61 6d65 735b 305d  _policy_names[0]
-00046c60: 0a0a 2020 2020 2020 2020 6c6f 7765 725f  ..        lower_
-00046c70: 7175 6172 7469 6c65 5f64 6963 745f 203d  quartile_dict_ =
-00046c80: 2073 656c 662e 6573 7469 6d61 7465 5f69   self.estimate_i
-00046c90: 6e74 6572 7175 6172 7469 6c65 5f72 616e  nterquartile_ran
-00046ca0: 6765 280a 2020 2020 2020 2020 2020 2020  ge(.            
-00046cb0: 696e 7075 745f 6469 6374 3d69 6e70 7574  input_dict=input
-00046cc0: 5f64 6963 742c 0a20 2020 2020 2020 2020  _dict,.         
-00046cd0: 2020 2063 6f6d 7061 7265 645f 6573 7469     compared_esti
-00046ce0: 6d61 746f 7273 3d63 6f6d 7061 7265 645f  mators=compared_
-00046cf0: 6573 7469 6d61 746f 7273 2c0a 2020 2020  estimators,.    
-00046d00: 2020 2020 2020 2020 6265 6861 7669 6f72          behavior
-00046d10: 5f70 6f6c 6963 795f 6e61 6d65 3d62 6568  _policy_name=beh
-00046d20: 6176 696f 725f 706f 6c69 6379 5f6e 616d  avior_policy_nam
-00046d30: 652c 0a20 2020 2020 2020 2020 2020 2061  e,.            a
-00046d40: 6c70 6861 3d61 6c70 6861 2c0a 2020 2020  lpha=alpha,.    
-00046d50: 2020 2020 290a 0a20 2020 2020 2020 2069      )..        i
-00046d60: 6620 6265 6861 7669 6f72 5f70 6f6c 6963  f behavior_polic
-00046d70: 795f 6e61 6d65 2069 7320 4e6f 6e65 3a0a  y_name is None:.
-00046d80: 2020 2020 2020 2020 2020 2020 6c6f 7765              lowe
-00046d90: 725f 7175 6172 7469 6c65 5f64 6963 7420  r_quartile_dict 
-00046da0: 3d20 6465 6661 756c 7464 6963 7428 6c61  = defaultdict(la
-00046db0: 6d62 6461 3a20 6465 6661 756c 7464 6963  mbda: defaultdic
-00046dc0: 7428 6469 6374 2929 0a0a 2020 2020 2020  t(dict))..      
-00046dd0: 2020 2020 2020 666f 7220 6265 6861 7669        for behavi
-00046de0: 6f72 5f70 6f6c 6963 792c 206e 5f64 6174  or_policy, n_dat
-00046df0: 6173 6574 7320 696e 2069 6e70 7574 5f64  asets in input_d
-00046e00: 6963 742e 6e5f 6461 7461 7365 7473 2e69  ict.n_datasets.i
-00046e10: 7465 6d73 2829 3a0a 2020 2020 2020 2020  tems():.        
-00046e20: 2020 2020 2020 2020 696e 7075 745f 6469          input_di
-00046e30: 6374 5f30 203d 2069 6e70 7574 5f64 6963  ct_0 = input_dic
-00046e40: 742e 6765 7428 0a20 2020 2020 2020 2020  t.get(.         
-00046e50: 2020 2020 2020 2020 2020 2062 6568 6176             behav
-00046e60: 696f 725f 706f 6c69 6379 5f6e 616d 653d  ior_policy_name=
-00046e70: 6265 6861 7669 6f72 5f70 6f6c 6963 792c  behavior_policy,
-00046e80: 2064 6174 6173 6574 5f69 643d 300a 2020   dataset_id=0.  
-00046e90: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-00046ea0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00046eb0: 2066 6f72 2065 7661 6c5f 706f 6c69 6379   for eval_policy
-00046ec0: 2069 6e20 696e 7075 745f 6469 6374 5f30   in input_dict_0
-00046ed0: 2e6b 6579 7328 293a 0a20 2020 2020 2020  .keys():.       
-00046ee0: 2020 2020 2020 2020 2020 2020 2066 6f72               for
-00046ef0: 2065 7374 696d 6174 6f72 2069 6e20 636f   estimator in co
-00046f00: 6d70 6172 6564 5f65 7374 696d 6174 6f72  mpared_estimator
-00046f10: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
-00046f20: 2020 2020 2020 2020 2020 206c 6f77 6572             lower
-00046f30: 5f71 7561 7274 696c 6520 3d20 6e70 2e7a  _quartile = np.z
-00046f40: 6572 6f73 2828 6e5f 6461 7461 7365 7473  eros((n_datasets
-00046f50: 2c29 290a 2020 2020 2020 2020 2020 2020  ,)).            
-00046f60: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00046f70: 6461 7461 7365 745f 6964 5f20 696e 2072  dataset_id_ in r
-00046f80: 616e 6765 286e 5f64 6174 6173 6574 7329  ange(n_datasets)
-00046f90: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00046fa0: 2020 2020 2020 2020 2020 2020 2020 6c6f                lo
-00046fb0: 7765 725f 7175 6172 7469 6c65 5b64 6174  wer_quartile[dat
-00046fc0: 6173 6574 5f69 645f 5d20 3d20 6c6f 7765  aset_id_] = lowe
-00046fd0: 725f 7175 6172 7469 6c65 5f64 6963 745f  r_quartile_dict_
-00046fe0: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
+00045790: 2020 2020 2063 7661 725f 6469 6374 5b62       cvar_dict[b
+000457a0: 6568 6176 696f 725f 706f 6c69 6379 5d5b  ehavior_policy][
+000457b0: 6576 616c 5f70 6f6c 6963 795d 5b22 6f6e  eval_policy]["on
+000457c0: 5f70 6f6c 6963 7922 5d20 3d20 4e6f 6e65  _policy"] = None
+000457d0: 0a0a 2020 2020 2020 2020 656c 7365 3a0a  ..        else:.
+000457e0: 2020 2020 2020 2020 2020 2020 6376 6172              cvar
+000457f0: 5f64 6963 7420 3d20 6465 6661 756c 7464  _dict = defaultd
+00045800: 6963 7428 6469 6374 290a 0a20 2020 2020  ict(dict)..     
+00045810: 2020 2020 2020 2069 6e70 7574 5f64 6963         input_dic
+00045820: 745f 3020 3d20 696e 7075 745f 6469 6374  t_0 = input_dict
+00045830: 2e67 6574 280a 2020 2020 2020 2020 2020  .get(.          
+00045840: 2020 2020 2020 6265 6861 7669 6f72 5f70        behavior_p
+00045850: 6f6c 6963 795f 6e61 6d65 3d62 6568 6176  olicy_name=behav
+00045860: 696f 725f 706f 6c69 6379 5f6e 616d 652c  ior_policy_name,
+00045870: 2064 6174 6173 6574 5f69 643d 300a 2020   dataset_id=0.  
+00045880: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00045890: 2020 2020 2020 2020 6e5f 6461 7461 7365          n_datase
+000458a0: 7473 203d 2069 6e70 7574 5f64 6963 742e  ts = input_dict.
+000458b0: 6e5f 6461 7461 7365 7473 5b62 6568 6176  n_datasets[behav
+000458c0: 696f 725f 706f 6c69 6379 5f6e 616d 655d  ior_policy_name]
+000458d0: 0a0a 2020 2020 2020 2020 2020 2020 666f  ..            fo
+000458e0: 7220 6576 616c 5f70 6f6c 6963 7920 696e  r eval_policy in
+000458f0: 2069 6e70 7574 5f64 6963 745f 302e 6b65   input_dict_0.ke
+00045900: 7973 2829 3a0a 2020 2020 2020 2020 2020  ys():.          
+00045910: 2020 2020 2020 666f 7220 6573 7469 6d61        for estima
+00045920: 746f 7220 696e 2063 6f6d 7061 7265 645f  tor in compared_
+00045930: 6573 7469 6d61 746f 7273 3a0a 2020 2020  estimators:.    
+00045940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00045950: 6376 6172 203d 206e 702e 7a65 726f 7328  cvar = np.zeros(
+00045960: 286e 5f64 6174 6173 6574 732c 2929 0a20  (n_datasets,)). 
+00045970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00045980: 2020 2066 6f72 2064 6174 6173 6574 5f69     for dataset_i
+00045990: 645f 2069 6e20 7261 6e67 6528 6e5f 6461  d_ in range(n_da
+000459a0: 7461 7365 7473 293a 0a20 2020 2020 2020  tasets):.       
+000459b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000459c0: 2063 7661 725b 6461 7461 7365 745f 6964   cvar[dataset_id
+000459d0: 5f5d 203d 2063 7661 725f 6469 6374 5f5b  _] = cvar_dict_[
+000459e0: 6461 7461 7365 745f 6964 5f5d 5b65 7661  dataset_id_][eva
+000459f0: 6c5f 706f 6c69 6379 5d5b 0a20 2020 2020  l_policy][.     
+00045a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00045a10: 2020 2020 2020 2065 7374 696d 6174 6f72         estimator
+00045a20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00045a30: 2020 2020 2020 2020 205d 0a0a 2020 2020           ]..    
+00045a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00045a50: 6376 6172 5f64 6963 745b 6576 616c 5f70  cvar_dict[eval_p
+00045a60: 6f6c 6963 795d 5b65 7374 696d 6174 6f72  olicy][estimator
+00045a70: 5d20 3d20 6376 6172 0a0a 2020 2020 2020  ] = cvar..      
+00045a80: 2020 2020 2020 2020 2020 6f6e 5f70 6f6c            on_pol
+00045a90: 6963 7920 3d20 696e 7075 745f 6469 6374  icy = input_dict
+00045aa0: 5f30 5b65 7661 6c5f 706f 6c69 6379 5d5b  _0[eval_policy][
+00045ab0: 226f 6e5f 706f 6c69 6379 5f70 6f6c 6963  "on_policy_polic
+00045ac0: 795f 7661 6c75 6522 5d0a 0a20 2020 2020  y_value"]..     
+00045ad0: 2020 2020 2020 2020 2020 2069 6620 6f6e             if on
+00045ae0: 5f70 6f6c 6963 7920 6973 206e 6f74 204e  _policy is not N
+00045af0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+00045b00: 2020 2020 2020 2020 2063 7661 725f 6964           cvar_id
+00045b10: 7820 3d20 696e 7428 616c 7068 6120 2a20  x = int(alpha * 
+00045b20: 6c65 6e28 6f6e 5f70 6f6c 6963 7929 290a  len(on_policy)).
+00045b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00045b40: 2020 2020 6376 6172 5f64 6963 745b 6576      cvar_dict[ev
+00045b50: 616c 5f70 6f6c 6963 795d 5b22 6f6e 5f70  al_policy]["on_p
+00045b60: 6f6c 6963 7922 5d20 3d20 6e70 2e70 6172  olicy"] = np.par
+00045b70: 7469 7469 6f6e 280a 2020 2020 2020 2020  tition(.        
+00045b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00045b90: 6f6e 5f70 6f6c 6963 792c 2063 7661 725f  on_policy, cvar_
+00045ba0: 6964 780a 2020 2020 2020 2020 2020 2020  idx.            
+00045bb0: 2020 2020 2020 2020 295b 3a63 7661 725f          )[:cvar_
+00045bc0: 6964 785d 2e6d 6561 6e28 290a 2020 2020  idx].mean().    
+00045bd0: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00045be0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00045bf0: 2020 2020 2020 6376 6172 5f64 6963 745b        cvar_dict[
+00045c00: 6576 616c 5f70 6f6c 6963 795d 5b22 6f6e  eval_policy]["on
+00045c10: 5f70 6f6c 6963 7922 5d20 3d20 4e6f 6e65  _policy"] = None
+00045c20: 0a0a 2020 2020 2020 2020 6376 6172 5f64  ..        cvar_d
+00045c30: 6963 7420 3d20 6465 6661 756c 7464 6963  ict = defaultdic
+00045c40: 745f 746f 5f64 6963 7428 6376 6172 5f64  t_to_dict(cvar_d
+00045c50: 6963 7429 0a0a 2020 2020 2020 2020 7365  ict)..        se
+00045c60: 6c66 2e5f 7669 7375 616c 697a 655f 6f66  lf._visualize_of
+00045c70: 665f 706f 6c69 6379 5f65 7374 696d 6174  f_policy_estimat
+00045c80: 6573 5f77 6974 685f 6d75 6c74 6970 6c65  es_with_multiple
+00045c90: 5f65 7374 696d 6174 6573 280a 2020 2020  _estimates(.    
+00045ca0: 2020 2020 2020 2020 696e 7075 745f 6469          input_di
+00045cb0: 6374 3d69 6e70 7574 5f64 6963 742c 0a20  ct=input_dict,. 
+00045cc0: 2020 2020 2020 2020 2020 2065 7374 696d             estim
+00045cd0: 6174 696f 6e5f 6469 6374 3d63 7661 725f  ation_dict=cvar_
+00045ce0: 6469 6374 2c0a 2020 2020 2020 2020 2020  dict,.          
+00045cf0: 2020 636f 6d70 6172 6564 5f65 7374 696d    compared_estim
+00045d00: 6174 6f72 733d 636f 6d70 6172 6564 5f65  ators=compared_e
+00045d10: 7374 696d 6174 6f72 732c 0a20 2020 2020  stimators,.     
+00045d20: 2020 2020 2020 2062 6568 6176 696f 725f         behavior_
+00045d30: 706f 6c69 6379 5f6e 616d 653d 6265 6861  policy_name=beha
+00045d40: 7669 6f72 5f70 6f6c 6963 795f 6e61 6d65  vior_policy_name
+00045d50: 2c0a 2020 2020 2020 2020 2020 2020 796c  ,.            yl
+00045d60: 6162 656c 3d66 2245 7374 696d 6174 6564  abel=f"Estimated
+00045d70: 2043 5661 5220 287b 616c 7068 617d 2922   CVaR ({alpha})"
+00045d80: 2c0a 2020 2020 2020 2020 2020 2020 706c  ,.            pl
+00045d90: 6f74 5f74 7970 653d 706c 6f74 5f74 7970  ot_type=plot_typ
+00045da0: 652c 0a20 2020 2020 2020 2020 2020 2068  e,.            h
+00045db0: 7565 3d68 7565 2c0a 2020 2020 2020 2020  ue=hue,.        
+00045dc0: 2020 2020 6c65 6765 6e64 3d6c 6567 656e      legend=legen
+00045dd0: 642c 0a20 2020 2020 2020 2020 2020 2073  d,.            s
+00045de0: 6861 7265 793d 7368 6172 6579 2c0a 2020  harey=sharey,.  
+00045df0: 2020 2020 2020 2020 2020 6669 675f 6469            fig_di
+00045e00: 723d 6669 675f 6469 722c 0a20 2020 2020  r=fig_dir,.     
+00045e10: 2020 2020 2020 2066 6967 5f6e 616d 653d         fig_name=
+00045e20: 6669 675f 6e61 6d65 2c0a 2020 2020 2020  fig_name,.      
+00045e30: 2020 290a 0a20 2020 2064 6566 2076 6973    )..    def vis
+00045e40: 7561 6c69 7a65 5f6c 6f77 6572 5f71 7561  ualize_lower_qua
+00045e50: 7274 696c 655f 7769 7468 5f6d 756c 7469  rtile_with_multi
+00045e60: 706c 655f 6573 7469 6d61 7465 7328 0a20  ple_estimates(. 
+00045e70: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+00045e80: 2020 2020 2069 6e70 7574 5f64 6963 743a       input_dict:
+00045e90: 204d 756c 7469 706c 6549 6e70 7574 4469   MultipleInputDi
+00045ea0: 6374 2c0a 2020 2020 2020 2020 636f 6d70  ct,.        comp
+00045eb0: 6172 6564 5f65 7374 696d 6174 6f72 733a  ared_estimators:
+00045ec0: 204f 7074 696f 6e61 6c5b 4c69 7374 5b73   Optional[List[s
+00045ed0: 7472 5d5d 203d 204e 6f6e 652c 0a20 2020  tr]] = None,.   
+00045ee0: 2020 2020 2062 6568 6176 696f 725f 706f       behavior_po
+00045ef0: 6c69 6379 5f6e 616d 653a 204f 7074 696f  licy_name: Optio
+00045f00: 6e61 6c5b 7374 725d 203d 204e 6f6e 652c  nal[str] = None,
+00045f10: 0a20 2020 2020 2020 2061 6c70 6861 3a20  .        alpha: 
+00045f20: 666c 6f61 7420 3d20 302e 3035 2c0a 2020  float = 0.05,.  
+00045f30: 2020 2020 2020 706c 6f74 5f74 7970 653a        plot_type:
+00045f40: 2073 7472 203d 2022 6369 222c 0a20 2020   str = "ci",.   
+00045f50: 2020 2020 2068 7565 3a20 7374 7220 3d20       hue: str = 
+00045f60: 2265 7374 696d 6174 6f72 222c 0a20 2020  "estimator",.   
+00045f70: 2020 2020 206c 6567 656e 643a 2062 6f6f       legend: boo
+00045f80: 6c20 3d20 5472 7565 2c0a 2020 2020 2020  l = True,.      
+00045f90: 2020 7368 6172 6579 3a20 626f 6f6c 203d    sharey: bool =
+00045fa0: 2046 616c 7365 2c0a 2020 2020 2020 2020   False,.        
+00045fb0: 6669 675f 6469 723a 204f 7074 696f 6e61  fig_dir: Optiona
+00045fc0: 6c5b 5061 7468 5d20 3d20 4e6f 6e65 2c0a  l[Path] = None,.
+00045fd0: 2020 2020 2020 2020 6669 675f 6e61 6d65          fig_name
+00045fe0: 3a20 7374 7220 3d20 2265 7374 696d 6174  : str = "estimat
+00045ff0: 6564 5f63 6f6e 6469 7469 6f6e 616c 5f76  ed_conditional_v
+00046000: 616c 7565 5f61 745f 7269 736b 5f6d 756c  alue_at_risk_mul
+00046010: 7469 706c 652e 706e 6722 2c0a 2020 2020  tiple.png",.    
+00046020: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
+00046030: 2020 2022 2222 5669 7375 616c 697a 6520     """Visualize 
+00046040: 7468 6520 6c6f 7765 7220 7175 6172 7469  the lower quarti
+00046050: 6c65 206f 6620 7468 6520 7472 616a 6563  le of the trajec
+00046060: 746f 7279 2d77 6973 6520 7265 7761 7264  tory-wise reward
+00046070: 2075 6e64 6572 2074 6865 2065 7661 6c75   under the evalu
+00046080: 6174 696f 6e20 706f 6c69 6379 2065 7374  ation policy est
+00046090: 696d 6174 6564 2062 7920 4f50 4520 6573  imated by OPE es
+000460a0: 7469 6d61 746f 7273 2061 6372 6f73 7320  timators across 
+000460b0: 6d75 6c74 6970 6c65 206c 6f67 6765 6420  multiple logged 
+000460c0: 6461 7461 7365 742e 0a0a 2020 2020 2020  dataset...      
+000460d0: 2020 4e6f 7465 0a20 2020 2020 2020 202d    Note.        -
+000460e0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2054  ------.        T
+000460f0: 6869 7320 6675 6e63 7469 6f6e 2069 7320  his function is 
+00046100: 6170 706c 6963 6162 6c65 206f 6e6c 7920  applicable only 
+00046110: 7768 656e 204d 756c 7469 706c 654c 6f67  when MultipleLog
+00046120: 6765 6444 6174 6173 6574 2069 7320 7573  gedDataset is us
+00046130: 6564 2061 6e64 0a20 2020 2020 2020 204d  ed and.        M
+00046140: 756c 7469 706c 6549 6e70 7574 4469 6374  ultipleInputDict
+00046150: 2069 7320 636f 6c6c 6563 7465 6420 6279   is collected by
+00046160: 2074 6865 2073 616d 6520 6576 616c 7561   the same evalua
+00046170: 7469 6f6e 2070 6f6c 6963 7920 6163 726f  tion policy acro
+00046180: 7373 206c 6f67 6765 6420 6461 7461 7365  ss logged datase
+00046190: 7473 2e0a 0a20 2020 2020 2020 2050 6172  ts...        Par
+000461a0: 616d 6574 6572 730a 2020 2020 2020 2020  ameters.        
+000461b0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+000461c0: 696e 7075 745f 6469 6374 3a20 4f50 4549  input_dict: OPEI
+000461d0: 6e70 7574 4469 6374 206f 7220 4d75 6c74  nputDict or Mult
+000461e0: 6970 6c65 496e 7075 7444 6963 740a 2020  ipleInputDict.  
+000461f0: 2020 2020 2020 2020 2020 4469 6374 696f            Dictio
+00046200: 6e61 7279 206f 6620 7468 6520 4f50 4520  nary of the OPE 
+00046210: 696e 7075 7473 2066 6f72 2065 6163 6820  inputs for each 
+00046220: 6576 616c 7561 7469 6f6e 2070 6f6c 6963  evaluation polic
+00046230: 792e 0a0a 2020 2020 2020 2020 2020 2020  y...            
+00046240: 2e2e 2063 6f64 652d 626c 6f63 6b3a 3a20  .. code-block:: 
+00046250: 7079 7468 6f6e 0a0a 2020 2020 2020 2020  python..        
+00046260: 2020 2020 2020 2020 6b65 793a 205b 6576          key: [ev
+00046270: 616c 7561 7469 6f6e 5f70 6f6c 6963 795d  aluation_policy]
+00046280: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
+00046290: 2020 2020 2020 6576 616c 7561 7469 6f6e        evaluation
+000462a0: 5f70 6f6c 6963 795f 6163 7469 6f6e 2c0a  _policy_action,.
+000462b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000462c0: 2020 2020 6576 616c 7561 7469 6f6e 5f70      evaluation_p
+000462d0: 6f6c 6963 795f 6163 7469 6f6e 5f64 6973  olicy_action_dis
+000462e0: 742c 0a20 2020 2020 2020 2020 2020 2020  t,.             
+000462f0: 2020 2020 2020 2073 7461 7465 5f61 6374         state_act
+00046300: 696f 6e5f 7661 6c75 655f 7072 6564 6963  ion_value_predic
+00046310: 7469 6f6e 2c0a 2020 2020 2020 2020 2020  tion,.          
+00046320: 2020 2020 2020 2020 2020 696e 6974 6961            initia
+00046330: 6c5f 7374 6174 655f 7661 6c75 655f 7072  l_state_value_pr
+00046340: 6564 6963 7469 6f6e 2c0a 2020 2020 2020  ediction,.      
+00046350: 2020 2020 2020 2020 2020 2020 2020 7374                st
+00046360: 6174 655f 6163 7469 6f6e 5f6d 6172 6769  ate_action_margi
+00046370: 6e61 6c5f 696d 706f 7274 616e 6365 5f77  nal_importance_w
+00046380: 6569 6768 742c 0a20 2020 2020 2020 2020  eight,.         
+00046390: 2020 2020 2020 2020 2020 2073 7461 7465             state
+000463a0: 5f6d 6172 6769 6e61 6c5f 696d 706f 7274  _marginal_import
+000463b0: 616e 6365 5f77 6569 6768 742c 0a20 2020  ance_weight,.   
+000463c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000463d0: 206f 6e5f 706f 6c69 6379 5f70 6f6c 6963   on_policy_polic
+000463e0: 795f 7661 6c75 652c 0a20 2020 2020 2020  y_value,.       
+000463f0: 2020 2020 2020 2020 2020 2020 2067 616d               gam
+00046400: 6d61 2c0a 2020 2020 2020 2020 2020 2020  ma,.            
+00046410: 2020 2020 2020 2020 6265 6861 7669 6f72          behavior
+00046420: 5f70 6f6c 6963 792c 0a20 2020 2020 2020  _policy,.       
+00046430: 2020 2020 2020 2020 2020 2020 2065 7661               eva
+00046440: 6c75 6174 696f 6e5f 706f 6c69 6379 2c0a  luation_policy,.
+00046450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00046460: 2020 2020 6461 7461 7365 745f 6964 2c0a      dataset_id,.
+00046470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00046480: 5d0a 0a20 2020 2020 2020 2020 2020 202e  ]..            .
+00046490: 2e20 7365 6561 6c73 6f3a 3a0a 0a20 2020  . seealso::..   
+000464a0: 2020 2020 2020 2020 2020 2020 203a 636c               :cl
+000464b0: 6173 733a 6073 636f 7065 5f72 6c2e 6f70  ass:`scope_rl.op
+000464c0: 652e 696e 7075 742e 4372 6561 7465 4f50  e.input.CreateOP
+000464d0: 4549 6e70 7574 6020 6465 7363 7269 6265  EInput` describe
+000464e0: 7320 7468 6520 636f 6d70 6f6e 656e 7473  s the components
+000464f0: 206f 6620 3a63 6c61 7373 3a60 696e 7075   of :class:`inpu
+00046500: 745f 6469 6374 602e 0a0a 2020 2020 2020  t_dict`...      
+00046510: 2020 636f 6d70 6172 6564 5f65 7374 696d    compared_estim
+00046520: 6174 6f72 733a 206c 6973 7420 6f66 2073  ators: list of s
+00046530: 7472 2c20 6465 6661 756c 743d 4e6f 6e65  tr, default=None
+00046540: 0a20 2020 2020 2020 2020 2020 204e 616d  .            Nam
+00046550: 6520 6f66 2063 6f6d 7061 7265 6420 6573  e of compared es
+00046560: 7469 6d61 746f 7273 2e0a 2020 2020 2020  timators..      
+00046570: 2020 2020 2020 4966 2060 4e6f 6e65 6020        If `None` 
+00046580: 6973 2067 6976 656e 2c20 616c 6c20 7468  is given, all th
+00046590: 6520 6573 7469 6d61 746f 7273 2061 7265  e estimators are
+000465a0: 2063 6f6d 7061 7265 642e 0a0a 2020 2020   compared...    
+000465b0: 2020 2020 6265 6861 7669 6f72 5f70 6f6c      behavior_pol
+000465c0: 6963 795f 6e61 6d65 3a20 7374 722c 2064  icy_name: str, d
+000465d0: 6566 6175 6c74 3d4e 6f6e 650a 2020 2020  efault=None.    
+000465e0: 2020 2020 2020 2020 4e61 6d65 206f 6620          Name of 
+000465f0: 7468 6520 6265 6861 7669 6f72 2070 6f6c  the behavior pol
+00046600: 6963 792e 0a0a 2020 2020 2020 2020 616c  icy...        al
+00046610: 7068 613a 2066 6c6f 6174 203d 2030 2e30  pha: float = 0.0
+00046620: 352e 0a20 2020 2020 2020 2020 2020 2050  5..            P
+00046630: 726f 706f 7274 696f 6e20 6f66 2074 6865  roportion of the
+00046640: 2073 6861 6465 6420 7265 6769 6f6e 2069   shaded region i
+00046650: 6e20 4356 6152 2065 7374 696d 6174 652e  n CVaR estimate.
+00046660: 2054 6865 2076 616c 7565 2073 686f 756c   The value shoul
+00046670: 6420 6265 2077 6974 6869 6e20 605b 302c  d be within `[0,
+00046680: 2031 2960 2e0a 0a20 2020 2020 2020 2070   1)`...        p
+00046690: 6c6f 745f 7479 7065 3a20 7b22 6369 222c  lot_type: {"ci",
+000466a0: 2022 7363 6174 7465 7222 2c20 2276 696f   "scatter", "vio
+000466b0: 6c69 6e22 7d2c 2064 6566 6175 6c74 3d22  lin"}, default="
+000466c0: 6369 220a 2020 2020 2020 2020 2020 2020  ci".            
+000466d0: 5479 7065 206f 6620 706c 6f74 2e0a 2020  Type of plot..  
+000466e0: 2020 2020 2020 2020 2020 4966 2022 6369            If "ci
+000466f0: 2220 6973 2067 6976 656e 2c20 7765 2067  " is given, we g
+00046700: 6574 2074 6865 2065 6d70 6972 6963 616c  et the empirical
+00046710: 2061 7665 7261 6765 206f 6620 7468 6520   average of the 
+00046720: 6573 7469 6d61 7465 6420 7661 6c75 6573  estimated values
+00046730: 2077 6974 6820 7468 6569 7220 6573 7469   with their esti
+00046740: 6d61 7465 6420 636f 6e66 6964 656e 6365  mated confidence
+00046750: 2069 6e74 6572 7661 6c73 2e0a 2020 2020   intervals..    
+00046760: 2020 2020 2020 2020 4966 2022 7363 6174          If "scat
+00046770: 7465 7222 2069 7320 6769 7665 6e2c 2077  ter" is given, w
+00046780: 6520 6765 7420 6120 7363 6174 7465 7220  e get a scatter 
+00046790: 706c 6f74 206f 6620 6573 7469 6d61 7465  plot of estimate
+000467a0: 6420 7661 6c75 6573 2e0a 0a20 2020 2020  d values...     
+000467b0: 2020 2068 7565 3a20 7b22 6573 7469 6d61     hue: {"estima
+000467c0: 746f 7222 2c20 2270 6f6c 6963 7922 7d2c  tor", "policy"},
+000467d0: 2064 6566 6175 6c74 3d22 6573 7469 6d61   default="estima
+000467e0: 746f 7222 0a20 2020 2020 2020 2020 2020  tor".           
+000467f0: 2048 7565 206f 6620 7468 6520 706c 6f74   Hue of the plot
+00046800: 2e0a 0a20 2020 2020 2020 206c 6567 656e  ...        legen
+00046810: 643a 2062 6f6f 6c2c 2064 6566 6175 6c74  d: bool, default
+00046820: 3d54 7275 650a 2020 2020 2020 2020 2020  =True.          
+00046830: 2020 5768 6574 6865 7220 746f 2069 6e63    Whether to inc
+00046840: 6c75 6465 2061 206c 6567 656e 6420 696e  lude a legend in
+00046850: 2074 6865 2073 6361 7474 6572 2070 6c6f   the scatter plo
+00046860: 742e 0a0a 2020 2020 2020 2020 7368 6172  t...        shar
+00046870: 6579 3a20 626f 6f6c 2c20 6465 6661 756c  ey: bool, defaul
+00046880: 743d 4661 6c73 650a 2020 2020 2020 2020  t=False.        
+00046890: 2020 2020 4966 2060 5472 7565 602c 2074      If `True`, t
+000468a0: 6865 2079 2d61 7869 7320 7769 6c6c 2062  he y-axis will b
+000468b0: 6520 7368 6172 6564 2061 6d6f 6e67 2064  e shared among d
+000468c0: 6966 6665 7265 6e74 2065 7374 696d 6174  ifferent estimat
+000468d0: 6f72 7320 6f72 2065 7661 6c75 6174 696f  ors or evaluatio
+000468e0: 6e20 706f 6c69 6369 6573 2e0a 0a20 2020  n policies...   
+000468f0: 2020 2020 2066 6967 5f64 6972 3a20 5061       fig_dir: Pa
+00046900: 7468 2c20 6465 6661 756c 743d 4e6f 6e65  th, default=None
+00046910: 0a20 2020 2020 2020 2020 2020 2050 6174  .            Pat
+00046920: 6820 746f 2073 746f 7265 2074 6865 2062  h to store the b
+00046930: 6172 2066 6967 7572 652e 0a20 2020 2020  ar figure..     
+00046940: 2020 2020 2020 2049 6620 604e 6f6e 6560         If `None`
+00046950: 2069 7320 6769 7665 6e2c 2074 6865 2066   is given, the f
+00046960: 6967 7572 6520 7769 6c6c 206e 6f74 2062  igure will not b
+00046970: 6520 7361 7665 642e 0a0a 2020 2020 2020  e saved...      
+00046980: 2020 6669 675f 6e61 6d65 3a20 7374 722c    fig_name: str,
+00046990: 2064 6566 6175 6c74 3d22 6573 7469 6d61   default="estima
+000469a0: 7465 645f 636f 6e64 6974 696f 6e61 6c5f  ted_conditional_
+000469b0: 7661 6c75 655f 6174 5f72 6973 6b5f 6d75  value_at_risk_mu
+000469c0: 6c74 6970 6c65 2e70 6e67 220a 2020 2020  ltiple.png".    
+000469d0: 2020 2020 2020 2020 4e61 6d65 206f 6620          Name of 
+000469e0: 7468 6520 6261 7220 6669 6775 7265 2e0a  the bar figure..
+000469f0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00046a00: 2020 2020 2063 6f6d 7061 7265 645f 6573       compared_es
+00046a10: 7469 6d61 746f 7273 203d 2073 656c 662e  timators = self.
+00046a20: 5f63 6865 636b 5f63 6f6d 7061 7265 645f  _check_compared_
+00046a30: 6573 7469 6d61 746f 7273 2863 6f6d 7061  estimators(compa
+00046a40: 7265 645f 6573 7469 6d61 746f 7273 290a  red_estimators).
+00046a50: 2020 2020 2020 2020 7365 6c66 2e5f 6368          self._ch
+00046a60: 6563 6b5f 6261 7369 635f 7669 7375 616c  eck_basic_visual
+00046a70: 697a 6174 696f 6e5f 696e 7075 7473 280a  ization_inputs(.
+00046a80: 2020 2020 2020 2020 2020 2020 6875 653d              hue=
+00046a90: 6875 652c 2066 6967 5f64 6972 3d66 6967  hue, fig_dir=fig
+00046aa0: 5f64 6972 2c20 6669 675f 6e61 6d65 3d66  _dir, fig_name=f
+00046ab0: 6967 5f6e 616d 650a 2020 2020 2020 2020  ig_name.        
+00046ac0: 290a 2020 2020 2020 2020 7365 6c66 2e5f  ).        self._
+00046ad0: 6368 6563 6b5f 696e 7075 745f 6469 6374  check_input_dict
+00046ae0: 5f66 6f72 5f76 6973 7561 6c69 7a65 5f6d  _for_visualize_m
+00046af0: 756c 7469 706c 655f 6573 7469 6d61 7465  ultiple_estimate
+00046b00: 7328 696e 7075 745f 6469 6374 290a 0a20  s(input_dict).. 
+00046b10: 2020 2020 2020 2069 6620 6c65 6e28 696e         if len(in
+00046b20: 7075 745f 6469 6374 2e62 6568 6176 696f  put_dict.behavio
+00046b30: 725f 706f 6c69 6379 5f6e 616d 6573 2920  r_policy_names) 
+00046b40: 3d3d 2031 3a0a 2020 2020 2020 2020 2020  == 1:.          
+00046b50: 2020 6265 6861 7669 6f72 5f70 6f6c 6963    behavior_polic
+00046b60: 795f 6e61 6d65 203d 2069 6e70 7574 5f64  y_name = input_d
+00046b70: 6963 742e 6265 6861 7669 6f72 5f70 6f6c  ict.behavior_pol
+00046b80: 6963 795f 6e61 6d65 735b 305d 0a0a 2020  icy_names[0]..  
+00046b90: 2020 2020 2020 6c6f 7765 725f 7175 6172        lower_quar
+00046ba0: 7469 6c65 5f64 6963 745f 203d 2073 656c  tile_dict_ = sel
+00046bb0: 662e 6573 7469 6d61 7465 5f69 6e74 6572  f.estimate_inter
+00046bc0: 7175 6172 7469 6c65 5f72 616e 6765 280a  quartile_range(.
+00046bd0: 2020 2020 2020 2020 2020 2020 696e 7075              inpu
+00046be0: 745f 6469 6374 3d69 6e70 7574 5f64 6963  t_dict=input_dic
+00046bf0: 742c 0a20 2020 2020 2020 2020 2020 2063  t,.            c
+00046c00: 6f6d 7061 7265 645f 6573 7469 6d61 746f  ompared_estimato
+00046c10: 7273 3d63 6f6d 7061 7265 645f 6573 7469  rs=compared_esti
+00046c20: 6d61 746f 7273 2c0a 2020 2020 2020 2020  mators,.        
+00046c30: 2020 2020 6265 6861 7669 6f72 5f70 6f6c      behavior_pol
+00046c40: 6963 795f 6e61 6d65 3d62 6568 6176 696f  icy_name=behavio
+00046c50: 725f 706f 6c69 6379 5f6e 616d 652c 0a20  r_policy_name,. 
+00046c60: 2020 2020 2020 2020 2020 2061 6c70 6861             alpha
+00046c70: 3d61 6c70 6861 2c0a 2020 2020 2020 2020  =alpha,.        
+00046c80: 290a 0a20 2020 2020 2020 2069 6620 6265  )..        if be
+00046c90: 6861 7669 6f72 5f70 6f6c 6963 795f 6e61  havior_policy_na
+00046ca0: 6d65 2069 7320 4e6f 6e65 3a0a 2020 2020  me is None:.    
+00046cb0: 2020 2020 2020 2020 6c6f 7765 725f 7175          lower_qu
+00046cc0: 6172 7469 6c65 5f64 6963 7420 3d20 6465  artile_dict = de
+00046cd0: 6661 756c 7464 6963 7428 6c61 6d62 6461  faultdict(lambda
+00046ce0: 3a20 6465 6661 756c 7464 6963 7428 6469  : defaultdict(di
+00046cf0: 6374 2929 0a0a 2020 2020 2020 2020 2020  ct))..          
+00046d00: 2020 666f 7220 6265 6861 7669 6f72 5f70    for behavior_p
+00046d10: 6f6c 6963 792c 206e 5f64 6174 6173 6574  olicy, n_dataset
+00046d20: 7320 696e 2069 6e70 7574 5f64 6963 742e  s in input_dict.
+00046d30: 6e5f 6461 7461 7365 7473 2e69 7465 6d73  n_datasets.items
+00046d40: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
+00046d50: 2020 2020 696e 7075 745f 6469 6374 5f30      input_dict_0
+00046d60: 203d 2069 6e70 7574 5f64 6963 742e 6765   = input_dict.ge
+00046d70: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
+00046d80: 2020 2020 2020 2062 6568 6176 696f 725f         behavior_
+00046d90: 706f 6c69 6379 5f6e 616d 653d 6265 6861  policy_name=beha
+00046da0: 7669 6f72 5f70 6f6c 6963 792c 2064 6174  vior_policy, dat
+00046db0: 6173 6574 5f69 643d 300a 2020 2020 2020  aset_id=0.      
+00046dc0: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+00046dd0: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+00046de0: 2065 7661 6c5f 706f 6c69 6379 2069 6e20   eval_policy in 
+00046df0: 696e 7075 745f 6469 6374 5f30 2e6b 6579  input_dict_0.key
+00046e00: 7328 293a 0a20 2020 2020 2020 2020 2020  s():.           
+00046e10: 2020 2020 2020 2020 2066 6f72 2065 7374           for est
+00046e20: 696d 6174 6f72 2069 6e20 636f 6d70 6172  imator in compar
+00046e30: 6564 5f65 7374 696d 6174 6f72 733a 0a20  ed_estimators:. 
+00046e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00046e50: 2020 2020 2020 206c 6f77 6572 5f71 7561         lower_qua
+00046e60: 7274 696c 6520 3d20 6e70 2e7a 6572 6f73  rtile = np.zeros
+00046e70: 2828 6e5f 6461 7461 7365 7473 2c29 290a  ((n_datasets,)).
+00046e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00046e90: 2020 2020 2020 2020 666f 7220 6461 7461          for data
+00046ea0: 7365 745f 6964 5f20 696e 2072 616e 6765  set_id_ in range
+00046eb0: 286e 5f64 6174 6173 6574 7329 3a0a 2020  (n_datasets):.  
+00046ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00046ed0: 2020 2020 2020 2020 2020 6c6f 7765 725f            lower_
+00046ee0: 7175 6172 7469 6c65 5b64 6174 6173 6574  quartile[dataset
+00046ef0: 5f69 645f 5d20 3d20 6c6f 7765 725f 7175  _id_] = lower_qu
+00046f00: 6172 7469 6c65 5f64 6963 745f 5b0a 2020  artile_dict_[.  
+00046f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00046f20: 2020 2020 2020 2020 2020 2020 2020 6265                be
+00046f30: 6861 7669 6f72 5f70 6f6c 6963 790a 2020  havior_policy.  
+00046f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00046f50: 2020 2020 2020 2020 2020 5d5b 6461 7461            ][data
+00046f60: 7365 745f 6964 5f5d 5b65 7661 6c5f 706f  set_id_][eval_po
+00046f70: 6c69 6379 5d5b 6573 7469 6d61 746f 725d  licy][estimator]
+00046f80: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
+00046f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00046fa0: 2020 6622 7b28 3120 2d20 616c 7068 6129    f"{(1 - alpha)
+00046fb0: 202a 2031 3030 7d25 2071 7561 7274 696c   * 100}% quartil
+00046fc0: 6520 286c 6f77 6572 2922 0a20 2020 2020  e (lower)".     
+00046fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00046fe0: 2020 2020 2020 205d 0a0a 2020 2020 2020         ]..      
 00046ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00047000: 2020 6265 6861 7669 6f72 5f70 6f6c 6963    behavior_polic
-00047010: 790a 2020 2020 2020 2020 2020 2020 2020  y.              
-00047020: 2020 2020 2020 2020 2020 2020 2020 5d5b                ][
-00047030: 6461 7461 7365 745f 6964 5f5d 5b65 7661  dataset_id_][eva
-00047040: 6c5f 706f 6c69 6379 5d5b 6573 7469 6d61  l_policy][estima
-00047050: 746f 725d 5b0a 2020 2020 2020 2020 2020  tor][.          
+00047000: 2020 6c6f 7765 725f 7175 6172 7469 6c65    lower_quartile
+00047010: 5f64 6963 745b 6265 6861 7669 6f72 5f70  _dict[behavior_p
+00047020: 6f6c 6963 795d 5b65 7661 6c5f 706f 6c69  olicy][eval_poli
+00047030: 6379 5d5b 0a20 2020 2020 2020 2020 2020  cy][.           
+00047040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00047050: 2065 7374 696d 6174 6f72 0a20 2020 2020   estimator.     
 00047060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00047070: 2020 2020 2020 6622 7b28 3120 2d20 616c        f"{(1 - al
-00047080: 7068 6129 202a 2031 3030 7d25 2071 7561  pha) * 100}% qua
-00047090: 7274 696c 6520 286c 6f77 6572 2922 0a20  rtile (lower)". 
-000470a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000470b0: 2020 2020 2020 2020 2020 205d 0a0a 2020             ]..  
-000470c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000470d0: 2020 2020 2020 6c6f 7765 725f 7175 6172        lower_quar
-000470e0: 7469 6c65 5f64 6963 745b 6265 6861 7669  tile_dict[behavi
-000470f0: 6f72 5f70 6f6c 6963 795d 5b65 7661 6c5f  or_policy][eval_
-00047100: 706f 6c69 6379 5d5b 0a20 2020 2020 2020  policy][.       
+00047070: 2020 205d 203d 206c 6f77 6572 5f71 7561     ] = lower_qua
+00047080: 7274 696c 650a 0a20 2020 2020 2020 2020  rtile..         
+00047090: 2020 2020 2020 2020 2020 206f 6e5f 706f             on_po
+000470a0: 6c69 6379 203d 2069 6e70 7574 5f64 6963  licy = input_dic
+000470b0: 745f 305b 6576 616c 5f70 6f6c 6963 795d  t_0[eval_policy]
+000470c0: 5b22 6f6e 5f70 6f6c 6963 795f 706f 6c69  ["on_policy_poli
+000470d0: 6379 5f76 616c 7565 225d 0a0a 2020 2020  cy_value"]..    
+000470e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000470f0: 6966 206f 6e5f 706f 6c69 6379 2069 7320  if on_policy is 
+00047100: 6e6f 7420 4e6f 6e65 3a0a 2020 2020 2020  not None:.      
 00047110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00047120: 2020 2020 2065 7374 696d 6174 6f72 0a20       estimator. 
-00047130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00047140: 2020 2020 2020 205d 203d 206c 6f77 6572         ] = lower
-00047150: 5f71 7561 7274 696c 650a 0a20 2020 2020  _quartile..     
-00047160: 2020 2020 2020 2020 2020 2020 2020 206f                 o
-00047170: 6e5f 706f 6c69 6379 203d 2069 6e70 7574  n_policy = input
-00047180: 5f64 6963 745f 305b 6576 616c 5f70 6f6c  _dict_0[eval_pol
-00047190: 6963 795d 5b22 6f6e 5f70 6f6c 6963 795f  icy]["on_policy_
-000471a0: 706f 6c69 6379 5f76 616c 7565 225d 0a0a  policy_value"]..
-000471b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000471c0: 2020 2020 6966 206f 6e5f 706f 6c69 6379      if on_policy
-000471d0: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
-000471e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000471f0: 2020 2020 2020 6c6f 7765 725f 6964 7820        lower_idx 
-00047200: 3d20 696e 7428 616c 7068 6120 2a20 6c65  = int(alpha * le
-00047210: 6e28 6f6e 5f70 6f6c 6963 7929 290a 2020  n(on_policy)).  
-00047220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00047230: 2020 2020 2020 6c6f 7765 725f 7175 6172        lower_quar
-00047240: 7469 6c65 5f64 6963 745b 6265 6861 7669  tile_dict[behavi
-00047250: 6f72 5f70 6f6c 6963 795d 5b65 7661 6c5f  or_policy][eval_
-00047260: 706f 6c69 6379 5d5b 0a20 2020 2020 2020  policy][.       
+00047120: 2020 6c6f 7765 725f 6964 7820 3d20 696e    lower_idx = in
+00047130: 7428 616c 7068 6120 2a20 6c65 6e28 6f6e  t(alpha * len(on
+00047140: 5f70 6f6c 6963 7929 290a 2020 2020 2020  _policy)).      
+00047150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00047160: 2020 6c6f 7765 725f 7175 6172 7469 6c65    lower_quartile
+00047170: 5f64 6963 745b 6265 6861 7669 6f72 5f70  _dict[behavior_p
+00047180: 6f6c 6963 795d 5b65 7661 6c5f 706f 6c69  olicy][eval_poli
+00047190: 6379 5d5b 0a20 2020 2020 2020 2020 2020  cy][.           
+000471a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000471b0: 2022 6f6e 5f70 6f6c 6963 7922 0a20 2020   "on_policy".   
+000471c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000471d0: 2020 2020 205d 203d 206e 702e 7061 7274       ] = np.part
+000471e0: 6974 696f 6e28 6f6e 5f70 6f6c 6963 792c  ition(on_policy,
+000471f0: 206c 6f77 6572 5f69 6478 295b 6c6f 7765   lower_idx)[lowe
+00047200: 725f 6964 785d 0a20 2020 2020 2020 2020  r_idx].         
+00047210: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00047220: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00047230: 2020 2020 2020 2020 206c 6f77 6572 5f71           lower_q
+00047240: 7561 7274 696c 655f 6469 6374 5b62 6568  uartile_dict[beh
+00047250: 6176 696f 725f 706f 6c69 6379 5d5b 6576  avior_policy][ev
+00047260: 616c 5f70 6f6c 6963 795d 5b0a 2020 2020  al_policy][.    
 00047270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00047280: 2020 2020 2022 6f6e 5f70 6f6c 6963 7922       "on_policy"
-00047290: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000472a0: 2020 2020 2020 2020 205d 203d 206e 702e           ] = np.
-000472b0: 7061 7274 6974 696f 6e28 6f6e 5f70 6f6c  partition(on_pol
-000472c0: 6963 792c 206c 6f77 6572 5f69 6478 295b  icy, lower_idx)[
-000472d0: 6c6f 7765 725f 6964 785d 0a20 2020 2020  lower_idx].     
-000472e0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-000472f0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00047300: 2020 2020 2020 2020 2020 2020 206c 6f77               low
-00047310: 6572 5f71 7561 7274 696c 655f 6469 6374  er_quartile_dict
-00047320: 5b62 6568 6176 696f 725f 706f 6c69 6379  [behavior_policy
-00047330: 5d5b 6576 616c 5f70 6f6c 6963 795d 5b0a  ][eval_policy][.
-00047340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00047350: 2020 2020 2020 2020 2020 2020 226f 6e5f              "on_
-00047360: 706f 6c69 6379 220a 2020 2020 2020 2020  policy".        
-00047370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00047380: 5d20 3d20 4e6f 6e65 0a0a 2020 2020 2020  ] = None..      
-00047390: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-000473a0: 2020 2020 6c6f 7765 725f 7175 6172 7469      lower_quarti
-000473b0: 6c65 5f64 6963 7420 3d20 6465 6661 756c  le_dict = defaul
-000473c0: 7464 6963 7428 6469 6374 290a 0a20 2020  tdict(dict)..   
-000473d0: 2020 2020 2020 2020 2069 6e70 7574 5f64           input_d
-000473e0: 6963 745f 3020 3d20 696e 7075 745f 6469  ict_0 = input_di
-000473f0: 6374 2e67 6574 280a 2020 2020 2020 2020  ct.get(.        
-00047400: 2020 2020 2020 2020 6265 6861 7669 6f72          behavior
-00047410: 5f70 6f6c 6963 795f 6e61 6d65 3d62 6568  _policy_name=beh
-00047420: 6176 696f 725f 706f 6c69 6379 5f6e 616d  avior_policy_nam
-00047430: 652c 2064 6174 6173 6574 5f69 643d 300a  e, dataset_id=0.
-00047440: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00047450: 2020 2020 2020 2020 2020 6e5f 6461 7461            n_data
-00047460: 7365 7473 203d 2069 6e70 7574 5f64 6963  sets = input_dic
-00047470: 742e 6e5f 6461 7461 7365 7473 5b62 6568  t.n_datasets[beh
-00047480: 6176 696f 725f 706f 6c69 6379 5f6e 616d  avior_policy_nam
-00047490: 655d 0a0a 2020 2020 2020 2020 2020 2020  e]..            
-000474a0: 666f 7220 6576 616c 5f70 6f6c 6963 7920  for eval_policy 
-000474b0: 696e 2069 6e70 7574 5f64 6963 745f 302e  in input_dict_0.
-000474c0: 6b65 7973 2829 3a0a 2020 2020 2020 2020  keys():.        
-000474d0: 2020 2020 2020 2020 666f 7220 6573 7469          for esti
-000474e0: 6d61 746f 7220 696e 2063 6f6d 7061 7265  mator in compare
-000474f0: 645f 6573 7469 6d61 746f 7273 3a0a 2020  d_estimators:.  
+00047280: 2020 2020 2020 2020 226f 6e5f 706f 6c69          "on_poli
+00047290: 6379 220a 2020 2020 2020 2020 2020 2020  cy".            
+000472a0: 2020 2020 2020 2020 2020 2020 5d20 3d20              ] = 
+000472b0: 4e6f 6e65 0a0a 2020 2020 2020 2020 656c  None..        el
+000472c0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+000472d0: 6c6f 7765 725f 7175 6172 7469 6c65 5f64  lower_quartile_d
+000472e0: 6963 7420 3d20 6465 6661 756c 7464 6963  ict = defaultdic
+000472f0: 7428 6469 6374 290a 0a20 2020 2020 2020  t(dict)..       
+00047300: 2020 2020 2069 6e70 7574 5f64 6963 745f       input_dict_
+00047310: 3020 3d20 696e 7075 745f 6469 6374 2e67  0 = input_dict.g
+00047320: 6574 280a 2020 2020 2020 2020 2020 2020  et(.            
+00047330: 2020 2020 6265 6861 7669 6f72 5f70 6f6c      behavior_pol
+00047340: 6963 795f 6e61 6d65 3d62 6568 6176 696f  icy_name=behavio
+00047350: 725f 706f 6c69 6379 5f6e 616d 652c 2064  r_policy_name, d
+00047360: 6174 6173 6574 5f69 643d 300a 2020 2020  ataset_id=0.    
+00047370: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00047380: 2020 2020 2020 6e5f 6461 7461 7365 7473        n_datasets
+00047390: 203d 2069 6e70 7574 5f64 6963 742e 6e5f   = input_dict.n_
+000473a0: 6461 7461 7365 7473 5b62 6568 6176 696f  datasets[behavio
+000473b0: 725f 706f 6c69 6379 5f6e 616d 655d 0a0a  r_policy_name]..
+000473c0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+000473d0: 6576 616c 5f70 6f6c 6963 7920 696e 2069  eval_policy in i
+000473e0: 6e70 7574 5f64 6963 745f 302e 6b65 7973  nput_dict_0.keys
+000473f0: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
+00047400: 2020 2020 666f 7220 6573 7469 6d61 746f      for estimato
+00047410: 7220 696e 2063 6f6d 7061 7265 645f 6573  r in compared_es
+00047420: 7469 6d61 746f 7273 3a0a 2020 2020 2020  timators:.      
+00047430: 2020 2020 2020 2020 2020 2020 2020 6c6f                lo
+00047440: 7765 725f 7175 6172 7469 6c65 203d 206e  wer_quartile = n
+00047450: 702e 7a65 726f 7328 286e 5f64 6174 6173  p.zeros((n_datas
+00047460: 6574 732c 2929 0a20 2020 2020 2020 2020  ets,)).         
+00047470: 2020 2020 2020 2020 2020 2066 6f72 2064             for d
+00047480: 6174 6173 6574 5f69 645f 2069 6e20 7261  ataset_id_ in ra
+00047490: 6e67 6528 6e5f 6461 7461 7365 7473 293a  nge(n_datasets):
+000474a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000474b0: 2020 2020 2020 2020 206c 6f77 6572 5f71           lower_q
+000474c0: 7561 7274 696c 655b 6461 7461 7365 745f  uartile[dataset_
+000474d0: 6964 5f5d 203d 206c 6f77 6572 5f71 7561  id_] = lower_qua
+000474e0: 7274 696c 655f 6469 6374 5f5b 6461 7461  rtile_dict_[data
+000474f0: 7365 745f 6964 5f5d 5b0a 2020 2020 2020  set_id_][.      
 00047500: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00047510: 2020 6c6f 7765 725f 7175 6172 7469 6c65    lower_quartile
-00047520: 203d 206e 702e 7a65 726f 7328 286e 5f64   = np.zeros((n_d
-00047530: 6174 6173 6574 732c 2929 0a20 2020 2020  atasets,)).     
-00047540: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00047550: 6f72 2064 6174 6173 6574 5f69 645f 2069  or dataset_id_ i
-00047560: 6e20 7261 6e67 6528 6e5f 6461 7461 7365  n range(n_datase
-00047570: 7473 293a 0a20 2020 2020 2020 2020 2020  ts):.           
-00047580: 2020 2020 2020 2020 2020 2020 206c 6f77               low
-00047590: 6572 5f71 7561 7274 696c 655b 6461 7461  er_quartile[data
-000475a0: 7365 745f 6964 5f5d 203d 206c 6f77 6572  set_id_] = lower
-000475b0: 5f71 7561 7274 696c 655f 6469 6374 5f5b  _quartile_dict_[
-000475c0: 6461 7461 7365 745f 6964 5f5d 5b0a 2020  dataset_id_][.  
-000475d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000475e0: 2020 2020 2020 2020 2020 6576 616c 5f70            eval_p
-000475f0: 6f6c 6963 790a 2020 2020 2020 2020 2020  olicy.          
-00047600: 2020 2020 2020 2020 2020 2020 2020 5d5b                ][
-00047610: 6573 7469 6d61 746f 725d 5b66 227b 2831  estimator][f"{(1
-00047620: 202d 2061 6c70 6861 2920 2a20 3130 307d   - alpha) * 100}
-00047630: 2520 7175 6172 7469 6c65 2028 6c6f 7765  % quartile (lowe
-00047640: 7229 225d 0a0a 2020 2020 2020 2020 2020  r)"]..          
-00047650: 2020 2020 2020 2020 2020 6c6f 7765 725f            lower_
-00047660: 7175 6172 7469 6c65 5f64 6963 745b 6576  quartile_dict[ev
-00047670: 616c 5f70 6f6c 6963 795d 5b65 7374 696d  al_policy][estim
-00047680: 6174 6f72 5d20 3d20 6c6f 7765 725f 7175  ator] = lower_qu
-00047690: 6172 7469 6c65 0a0a 2020 2020 2020 2020  artile..        
-000476a0: 2020 2020 2020 2020 6f6e 5f70 6f6c 6963          on_polic
-000476b0: 7920 3d20 696e 7075 745f 6469 6374 5f30  y = input_dict_0
-000476c0: 5b65 7661 6c5f 706f 6c69 6379 5d5b 226f  [eval_policy]["o
-000476d0: 6e5f 706f 6c69 6379 5f70 6f6c 6963 795f  n_policy_policy_
-000476e0: 7661 6c75 6522 5d0a 0a20 2020 2020 2020  value"]..       
-000476f0: 2020 2020 2020 2020 2069 6620 6f6e 5f70           if on_p
-00047700: 6f6c 6963 7920 6973 206e 6f74 204e 6f6e  olicy is not Non
-00047710: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00047720: 2020 2020 2020 206c 6f77 6572 5f69 6478         lower_idx
-00047730: 203d 2069 6e74 2861 6c70 6861 202a 206c   = int(alpha * l
-00047740: 656e 286f 6e5f 706f 6c69 6379 2929 0a20  en(on_policy)). 
-00047750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00047760: 2020 206c 6f77 6572 5f71 7561 7274 696c     lower_quartil
-00047770: 655f 6469 6374 5b65 7661 6c5f 706f 6c69  e_dict[eval_poli
-00047780: 6379 5d5b 226f 6e5f 706f 6c69 6379 225d  cy]["on_policy"]
-00047790: 203d 206e 702e 7061 7274 6974 696f 6e28   = np.partition(
-000477a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000477b0: 2020 2020 2020 2020 206f 6e5f 706f 6c69           on_poli
-000477c0: 6379 2c20 6c6f 7765 725f 6964 780a 2020  cy, lower_idx.  
-000477d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000477e0: 2020 295b 6c6f 7765 725f 6964 785d 0a20    )[lower_idx]. 
-000477f0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00047800: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00047810: 2020 2020 2020 2020 206c 6f77 6572 5f71           lower_q
-00047820: 7561 7274 696c 655f 6469 6374 5b65 7661  uartile_dict[eva
-00047830: 6c5f 706f 6c69 6379 5d5b 226f 6e5f 706f  l_policy]["on_po
-00047840: 6c69 6379 225d 203d 204e 6f6e 650a 0a20  licy"] = None.. 
-00047850: 2020 2020 2020 206c 6f77 6572 5f71 7561         lower_qua
-00047860: 7274 696c 655f 6469 6374 203d 2064 6566  rtile_dict = def
-00047870: 6175 6c74 6469 6374 5f74 6f5f 6469 6374  aultdict_to_dict
-00047880: 286c 6f77 6572 5f71 7561 7274 696c 655f  (lower_quartile_
-00047890: 6469 6374 290a 0a20 2020 2020 2020 2073  dict)..        s
-000478a0: 656c 662e 5f76 6973 7561 6c69 7a65 5f6f  elf._visualize_o
-000478b0: 6666 5f70 6f6c 6963 795f 6573 7469 6d61  ff_policy_estima
-000478c0: 7465 735f 7769 7468 5f6d 756c 7469 706c  tes_with_multipl
-000478d0: 655f 6573 7469 6d61 7465 7328 0a20 2020  e_estimates(.   
-000478e0: 2020 2020 2020 2020 2069 6e70 7574 5f64           input_d
-000478f0: 6963 743d 696e 7075 745f 6469 6374 2c0a  ict=input_dict,.
-00047900: 2020 2020 2020 2020 2020 2020 6573 7469              esti
-00047910: 6d61 7469 6f6e 5f64 6963 743d 6c6f 7765  mation_dict=lowe
-00047920: 725f 7175 6172 7469 6c65 5f64 6963 742c  r_quartile_dict,
-00047930: 0a20 2020 2020 2020 2020 2020 2063 6f6d  .            com
-00047940: 7061 7265 645f 6573 7469 6d61 746f 7273  pared_estimators
-00047950: 3d63 6f6d 7061 7265 645f 6573 7469 6d61  =compared_estima
-00047960: 746f 7273 2c0a 2020 2020 2020 2020 2020  tors,.          
-00047970: 2020 6265 6861 7669 6f72 5f70 6f6c 6963    behavior_polic
-00047980: 795f 6e61 6d65 3d62 6568 6176 696f 725f  y_name=behavior_
-00047990: 706f 6c69 6379 5f6e 616d 652c 0a20 2020  policy_name,.   
-000479a0: 2020 2020 2020 2020 2079 6c61 6265 6c3d           ylabel=
-000479b0: 6622 4573 7469 6d61 7465 6420 4c6f 7765  f"Estimated Lowe
-000479c0: 7220 5175 6172 7469 6c65 2028 7b61 6c70  r Quartile ({alp
-000479d0: 6861 7d29 222c 0a20 2020 2020 2020 2020  ha})",.         
-000479e0: 2020 2070 6c6f 745f 7479 7065 3d70 6c6f     plot_type=plo
-000479f0: 745f 7479 7065 2c0a 2020 2020 2020 2020  t_type,.        
-00047a00: 2020 2020 6875 653d 6875 652c 0a20 2020      hue=hue,.   
-00047a10: 2020 2020 2020 2020 206c 6567 656e 643d           legend=
-00047a20: 6c65 6765 6e64 2c0a 2020 2020 2020 2020  legend,.        
-00047a30: 2020 2020 7368 6172 6579 3d73 6861 7265      sharey=share
-00047a40: 792c 0a20 2020 2020 2020 2020 2020 2066  y,.            f
-00047a50: 6967 5f64 6972 3d66 6967 5f64 6972 2c0a  ig_dir=fig_dir,.
-00047a60: 2020 2020 2020 2020 2020 2020 6669 675f              fig_
-00047a70: 6e61 6d65 3d66 6967 5f6e 616d 652c 0a20  name=fig_name,. 
-00047a80: 2020 2020 2020 2029 0a0a 2020 2020 4070         )..    @p
-00047a90: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-00047aa0: 6573 7469 6d61 746f 7273 5f6e 616d 6528  estimators_name(
-00047ab0: 7365 6c66 293a 0a20 2020 2020 2020 2072  self):.        r
-00047ac0: 6574 7572 6e20 6c69 7374 2873 656c 662e  eturn list(self.
-00047ad0: 6f70 655f 6573 7469 6d61 746f 7273 5f2e  ope_estimators_.
-00047ae0: 6b65 7973 2829 290a                      keys()).
+00047510: 2020 2020 2020 6576 616c 5f70 6f6c 6963        eval_polic
+00047520: 790a 2020 2020 2020 2020 2020 2020 2020  y.              
+00047530: 2020 2020 2020 2020 2020 5d5b 6573 7469            ][esti
+00047540: 6d61 746f 725d 5b66 227b 2831 202d 2061  mator][f"{(1 - a
+00047550: 6c70 6861 2920 2a20 3130 307d 2520 7175  lpha) * 100}% qu
+00047560: 6172 7469 6c65 2028 6c6f 7765 7229 225d  artile (lower)"]
+00047570: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00047580: 2020 2020 2020 6c6f 7765 725f 7175 6172        lower_quar
+00047590: 7469 6c65 5f64 6963 745b 6576 616c 5f70  tile_dict[eval_p
+000475a0: 6f6c 6963 795d 5b65 7374 696d 6174 6f72  olicy][estimator
+000475b0: 5d20 3d20 6c6f 7765 725f 7175 6172 7469  ] = lower_quarti
+000475c0: 6c65 0a0a 2020 2020 2020 2020 2020 2020  le..            
+000475d0: 2020 2020 6f6e 5f70 6f6c 6963 7920 3d20      on_policy = 
+000475e0: 696e 7075 745f 6469 6374 5f30 5b65 7661  input_dict_0[eva
+000475f0: 6c5f 706f 6c69 6379 5d5b 226f 6e5f 706f  l_policy]["on_po
+00047600: 6c69 6379 5f70 6f6c 6963 795f 7661 6c75  licy_policy_valu
+00047610: 6522 5d0a 0a20 2020 2020 2020 2020 2020  e"]..           
+00047620: 2020 2020 2069 6620 6f6e 5f70 6f6c 6963       if on_polic
+00047630: 7920 6973 206e 6f74 204e 6f6e 653a 0a20  y is not None:. 
+00047640: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00047650: 2020 206c 6f77 6572 5f69 6478 203d 2069     lower_idx = i
+00047660: 6e74 2861 6c70 6861 202a 206c 656e 286f  nt(alpha * len(o
+00047670: 6e5f 706f 6c69 6379 2929 0a20 2020 2020  n_policy)).     
+00047680: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+00047690: 6f77 6572 5f71 7561 7274 696c 655f 6469  ower_quartile_di
+000476a0: 6374 5b65 7661 6c5f 706f 6c69 6379 5d5b  ct[eval_policy][
+000476b0: 226f 6e5f 706f 6c69 6379 225d 203d 206e  "on_policy"] = n
+000476c0: 702e 7061 7274 6974 696f 6e28 0a20 2020  p.partition(.   
+000476d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000476e0: 2020 2020 206f 6e5f 706f 6c69 6379 2c20       on_policy, 
+000476f0: 6c6f 7765 725f 6964 780a 2020 2020 2020  lower_idx.      
+00047700: 2020 2020 2020 2020 2020 2020 2020 295b                )[
+00047710: 6c6f 7765 725f 6964 785d 0a20 2020 2020  lower_idx].     
+00047720: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00047730: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00047740: 2020 2020 206c 6f77 6572 5f71 7561 7274       lower_quart
+00047750: 696c 655f 6469 6374 5b65 7661 6c5f 706f  ile_dict[eval_po
+00047760: 6c69 6379 5d5b 226f 6e5f 706f 6c69 6379  licy]["on_policy
+00047770: 225d 203d 204e 6f6e 650a 0a20 2020 2020  "] = None..     
+00047780: 2020 206c 6f77 6572 5f71 7561 7274 696c     lower_quartil
+00047790: 655f 6469 6374 203d 2064 6566 6175 6c74  e_dict = default
+000477a0: 6469 6374 5f74 6f5f 6469 6374 286c 6f77  dict_to_dict(low
+000477b0: 6572 5f71 7561 7274 696c 655f 6469 6374  er_quartile_dict
+000477c0: 290a 0a20 2020 2020 2020 2073 656c 662e  )..        self.
+000477d0: 5f76 6973 7561 6c69 7a65 5f6f 6666 5f70  _visualize_off_p
+000477e0: 6f6c 6963 795f 6573 7469 6d61 7465 735f  olicy_estimates_
+000477f0: 7769 7468 5f6d 756c 7469 706c 655f 6573  with_multiple_es
+00047800: 7469 6d61 7465 7328 0a20 2020 2020 2020  timates(.       
+00047810: 2020 2020 2069 6e70 7574 5f64 6963 743d       input_dict=
+00047820: 696e 7075 745f 6469 6374 2c0a 2020 2020  input_dict,.    
+00047830: 2020 2020 2020 2020 6573 7469 6d61 7469          estimati
+00047840: 6f6e 5f64 6963 743d 6c6f 7765 725f 7175  on_dict=lower_qu
+00047850: 6172 7469 6c65 5f64 6963 742c 0a20 2020  artile_dict,.   
+00047860: 2020 2020 2020 2020 2063 6f6d 7061 7265           compare
+00047870: 645f 6573 7469 6d61 746f 7273 3d63 6f6d  d_estimators=com
+00047880: 7061 7265 645f 6573 7469 6d61 746f 7273  pared_estimators
+00047890: 2c0a 2020 2020 2020 2020 2020 2020 6265  ,.            be
+000478a0: 6861 7669 6f72 5f70 6f6c 6963 795f 6e61  havior_policy_na
+000478b0: 6d65 3d62 6568 6176 696f 725f 706f 6c69  me=behavior_poli
+000478c0: 6379 5f6e 616d 652c 0a20 2020 2020 2020  cy_name,.       
+000478d0: 2020 2020 2079 6c61 6265 6c3d 6622 4573       ylabel=f"Es
+000478e0: 7469 6d61 7465 6420 4c6f 7765 7220 5175  timated Lower Qu
+000478f0: 6172 7469 6c65 2028 7b61 6c70 6861 7d29  artile ({alpha})
+00047900: 222c 0a20 2020 2020 2020 2020 2020 2070  ",.            p
+00047910: 6c6f 745f 7479 7065 3d70 6c6f 745f 7479  lot_type=plot_ty
+00047920: 7065 2c0a 2020 2020 2020 2020 2020 2020  pe,.            
+00047930: 6875 653d 6875 652c 0a20 2020 2020 2020  hue=hue,.       
+00047940: 2020 2020 206c 6567 656e 643d 6c65 6765       legend=lege
+00047950: 6e64 2c0a 2020 2020 2020 2020 2020 2020  nd,.            
+00047960: 7368 6172 6579 3d73 6861 7265 792c 0a20  sharey=sharey,. 
+00047970: 2020 2020 2020 2020 2020 2066 6967 5f64             fig_d
+00047980: 6972 3d66 6967 5f64 6972 2c0a 2020 2020  ir=fig_dir,.    
+00047990: 2020 2020 2020 2020 6669 675f 6e61 6d65          fig_name
+000479a0: 3d66 6967 5f6e 616d 652c 0a20 2020 2020  =fig_name,.     
+000479b0: 2020 2029 0a0a 2020 2020 4070 726f 7065     )..    @prope
+000479c0: 7274 790a 2020 2020 6465 6620 6573 7469  rty.    def esti
+000479d0: 6d61 746f 7273 5f6e 616d 6528 7365 6c66  mators_name(self
+000479e0: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+000479f0: 6e20 6c69 7374 2873 656c 662e 6f70 655f  n list(self.ope_
+00047a00: 6573 7469 6d61 746f 7273 5f2e 6b65 7973  estimators_.keys
+00047a10: 2829 290a                                ()).
```

### Comparing `scope-rl-0.1.3/scope_rl/ope/ops.py` & `scope-rl-0.2.1/scope_rl/ope/ops.py`

 * *Files 0% similar despite different names*

```diff
@@ -105,36 +105,32 @@
         from scope_rl.ope import CumulativeDistributionOPE
         from scope_rl.ope.discrete import CumulativeDistributionTIS as CD_IS
         from scope_rl.ope.discrete import CumulativeDistributionSNTIS as CD_SNIS
 
         # import necessary module from other libraries
         import gym
         import rtbgym
-        from d3rlpy.algos import DoubleDQN
-        from d3rlpy.online.buffers import ReplayBuffer
-        from d3rlpy.online.explorers import ConstantEpsilonGreedy
+        from d3rlpy.algos import DoubleDQNConfig
+        from d3rlpy.dataset import create_fifo_replay_buffer
+        from d3rlpy.algos import ConstantEpsilonGreedy
 
         # initialize environment
         env = gym.make("RTBEnv-discrete-v0")
 
-        # for api compatibility to d3rlpy
-        from scope_rl.utils import OldGymAPIWrapper
-        env_ = OldGymAPIWrapper(env)
-
         # define (RL) agent (i.e., policy) and train on the environment
-        ddqn = DoubleDQN()
-        buffer = ReplayBuffer(
-            maxlen=10000,
-            env=env_,
+        ddqn = DoubleDQNConfig().create()
+        buffer = create_fifo_replay_buffer(
+            limit=10000,
+            env=env,
         )
         explorer = ConstantEpsilonGreedy(
             epsilon=0.3,
         )
         ddqn.fit_online(
-            env=env_,
+            env=env,
             buffer=buffer,
             explorer=explorer,
             n_steps=10000,
             n_steps_per_epoch=1000,
         )
 
         # convert ddqn policy to stochastic data collection policy
```

### Comparing `scope-rl-0.1.3/scope_rl/ope/weight_value_learning/__init__.py` & `scope-rl-0.2.1/scope_rl/ope/weight_value_learning/__init__.py`

 * *Files identical despite different names*

### Comparing `scope-rl-0.1.3/scope_rl/ope/weight_value_learning/augmented_lagrangian_learning_continuous.py` & `scope-rl-0.2.1/scope_rl/ope/weight_value_learning/augmented_lagrangian_learning_continuous.py`

 * *Files identical despite different names*

### Comparing `scope-rl-0.1.3/scope_rl/ope/weight_value_learning/augmented_lagrangian_learning_discrete.py` & `scope-rl-0.2.1/scope_rl/ope/weight_value_learning/augmented_lagrangian_learning_discrete.py`

 * *Files identical despite different names*

### Comparing `scope-rl-0.1.3/scope_rl/ope/weight_value_learning/base.py` & `scope-rl-0.2.1/scope_rl/ope/weight_value_learning/base.py`

 * *Files identical despite different names*

### Comparing `scope-rl-0.1.3/scope_rl/ope/weight_value_learning/function.py` & `scope-rl-0.2.1/scope_rl/ope/weight_value_learning/function.py`

 * *Files identical despite different names*

### Comparing `scope-rl-0.1.3/scope_rl/ope/weight_value_learning/minimax_value_learning_continuous.py` & `scope-rl-0.2.1/scope_rl/ope/weight_value_learning/minimax_value_learning_continuous.py`

 * *Files identical despite different names*

### Comparing `scope-rl-0.1.3/scope_rl/ope/weight_value_learning/minimax_value_learning_discrete.py` & `scope-rl-0.2.1/scope_rl/ope/weight_value_learning/minimax_value_learning_discrete.py`

 * *Files identical despite different names*

### Comparing `scope-rl-0.1.3/scope_rl/ope/weight_value_learning/minimax_weight_learning_continuous.py` & `scope-rl-0.2.1/scope_rl/ope/weight_value_learning/minimax_weight_learning_continuous.py`

 * *Files identical despite different names*

### Comparing `scope-rl-0.1.3/scope_rl/ope/weight_value_learning/minimax_weight_learning_discrete.py` & `scope-rl-0.2.1/scope_rl/ope/weight_value_learning/minimax_weight_learning_discrete.py`

 * *Files identical despite different names*

### Comparing `scope-rl-0.1.3/scope_rl/policy/head.py` & `scope-rl-0.2.1/scope_rl/policy/head.py`

 * *Files 5% similar despite different names*

```diff
@@ -7,37 +7,36 @@
 from dataclasses import dataclass
 
 import numpy as np
 from scipy.stats import norm, truncnorm
 from sklearn.utils import check_scalar, check_random_state
 
 import gym
-from d3rlpy.algos import AlgoBase
-from d3rlpy.dataset import MDPDataset, Transition, TransitionMiniBatch
-from d3rlpy.logger import D3RLPyLogger
+from d3rlpy.algos import QLearningAlgoBase
+from d3rlpy.dataset import MDPDataset, TransitionMiniBatch
 
 from ..utils import check_array
 
 
 @dataclass
-class BaseHead(AlgoBase):
+class BaseHead(QLearningAlgoBase):
     """Base class to convert a greedy policy into a stochastic policy.
 
-    Bases: :class:`d3rlpy.algos.AlgoBase`
+    Bases: :class:`d3rlpy.algos.QLearningAlgoBase`
 
     Imported as: :class:`scope_rl.policy.BaseHead`
 
     Note
     -------
-    To ensure API compatibility with `d3rlpy <https://github.com/takuseno/d3rlpy>`_, :class:`BaseHead` inherits :class:`d3rlpy.algos.AlgoBase`.
+    To ensure API compatibility with `d3rlpy <https://github.com/takuseno/d3rlpy>`_, :class:`BaseHead` inherits :class:`d3rlpy.algos.QLearningAlgoBase`.
     This base class also has additional methods including :class:`fit`, :class:`predict`, and :class:`predict_value`. Please also refer to the following documentation for the methods that are not described in this API reference.
 
     .. seealso::
 
-        (external) `d3rlpy's documentation about AlgoBase <https://d3rlpy.readthedocs.io/en/latest/references/algos.html>`_
+        (external) `d3rlpy's documentation about QLearningAlgoBase <https://d3rlpy.readthedocs.io/en/latest/references/algos.html>`_
 
     """
 
     @abstractmethod
     def sample_action_and_output_pscore(self, x: np.ndarray):
         """Sample an action stochastically with its pscore."""
         raise NotImplementedError()
@@ -89,89 +88,86 @@
 
     def build_with_dataset(self, dataset: MDPDataset):
         return self.base_policy.build_with_dataset(dataset)
 
     def build_with_env(self, env: gym.Env):
         return self.base_policy.build_with_env(env)
 
-    def copy_policy_from(self, algo: AlgoBase):
+    def copy_policy_from(self, algo: QLearningAlgoBase):
         return self.base_policy.copy_policy_from(algo)
 
-    def copy_q_function_from(self, algo: AlgoBase):
+    def copy_policy_optim_from(self, algo: QLearningAlgoBase):
+        return self.base_policy.copy_policy_optim_from(algo)
+
+    def copy_q_function_from(self, algo: QLearningAlgoBase):
         return self.base_policy.copy_q_function_from(algo)
 
+    def copy_q_function_optim_from(self, algo: QLearningAlgoBase):
+        return self.base_policy.copy_q_function_optim_from(algo)
+
     def fit(self, dataset: MDPDataset, **kwargs):
         return self.base_policy.fit(dataset, **kwargs)
 
-    def fit_batch_online(self, env: gym.Env, **kwargs):
-        return self.base_policy.fit_batch_online(env, **kwargs)
-
     def fit_online(self, env: gym.Env, **kwargs):
         return self.base_policy.fit_online(env, **kwargs)
 
     def fitter(self, env: gym.Env, **kwargs):
         return self.base_policy.fitter(env, **kwargs)
 
-    def generate_new_data(self, transition: Transition):
-        return self.base_policy.generate_new_data(transition)
-
-    def collect(self, env: gym.Env, **kwargs):
-        return self.base_policy.collect(env, **kwargs)
-
     def update(self, batch: TransitionMiniBatch):
         return self.base_policy.update(batch)
 
+    def inner_update(self, batch: TransitionMiniBatch):
+        return self.base_policy.inner_update(batch)
+
     def create_impl(self, observation_shape: Sequence[int], action_size: int):
         return self.base_policy.create_impl(observation_shape, action_size)
 
+    def inner_create_impl(self, observation_shape: Sequence[int], action_size: int):
+        return self.base_policy.inner_create_impl(observation_shape, action_size)
+
     def get_action_type(self):
         return self.base_policy.get_action_type()
 
-    def get_params(self, **kwargs):
-        return self.base_policy.get_params()
-
     def load_model(self, fname: str):
         return self.base_policy.load_model(fname)
 
     def from_json(self, fname: str, **kwargs):
         return self.base_policy.from_json(fname, **kwargs)
 
     def save_model(self, fname: str):
         return self.base_policy.save_model(fname)
 
-    def save_params(self, logger: D3RLPyLogger):
-        return self.base_policy.save_model(logger)
+    def save(self, fname: str):
+        return self.base_policy.save(fname)
 
     def save_policy(self, fname: str, **kwargs):
         return self.base_policy.save_policy(fname, **kwargs)
 
-    def set_active_logger(self, logger: D3RLPyLogger):
-        return self.base_policy.set_active_logger(logger)
-
     def set_grad_step(self, grad_step: int):
         return self.base_policy.set_grad_step(grad_step)
 
-    def set_params(self, **params):
-        return self.base_policy.set_params(**params)
+    def reset_optimizer_states(self):
+        return self.base_policy.reset_optimizer_states()
 
     @property
-    def scaler(self):
-        return self.base_policy.scaler
+    def observation_scaler(self):
+        return self.base_policy.observation_scaler
 
     @property
     def action_scalar(self):
         return self.base_policy.action_scaler
 
     @property
     def reward_scaler(self):
         return self.base_policy.reward_scaler
 
     @property
-    def observation_space(self):
-        return self.base_policy.observation_space
+    def observation_shape(self):
+        return self.base_policy.observation_shape
 
     @property
     def action_size(self):
         return self.base_policy.action_size
 
     @property
     def gamma(self):
@@ -182,28 +178,20 @@
         return self.base_policy.batch_size
 
     @property
     def grad_step(self):
         return self.base_policy.grad_step
 
     @property
-    def n_frames(self):
-        return self.base_policy.n_frames
-
-    @property
-    def n_steps(self):
-        return self.base_policy.n_steps
-
-    @property
     def impl(self):
         return self.base_policy.impl
 
     @property
-    def action_logger(self):
-        return self.base_policy.action_logger
+    def config(self):
+        return self.base_policy.config
 
 
 @dataclass
 class OnlineHead(BaseHead):
     """Class to enable online interaction.
 
     Bases: :class:`scope_rl.policy.BaseHead`
@@ -212,32 +200,32 @@
 
     Note
     -------
     This class aims to make a d3rlpy's policy an instance of :class:`BaseHead`.
 
     Note
     -------
-    To ensure API compatibility with `d3rlpy <https://github.com/takuseno/d3rlpy>`_, :class:`BaseHead` inherits :class:`d3rlpy.algos.AlgoBase`.
+    To ensure API compatibility with `d3rlpy <https://github.com/takuseno/d3rlpy>`_, :class:`BaseHead` inherits :class:`d3rlpy.algos.QLearningAlgoBase`.
     This base class also has additional methods including :class:`fit`, :class:`predict`, and :class:`predict_value`. Please also refer to the following documentation for the methods that are not described in this API reference.
 
     .. seealso::
 
-        (external) `d3rlpy's documentation about AlgoBase <https://d3rlpy.readthedocs.io/en/latest/references/algos.html>`_
+        (external) `d3rlpy's documentation about QLearningAlgoBase <https://d3rlpy.readthedocs.io/en/latest/references/algos.html>`_
 
     Parameters
     -------
-    base_policy: AlgoBase
+    base_policy: QLearningAlgoBase
         Reinforcement learning (RL) policy.
 
     name: str
         Name of the policy.
 
     """
 
-    base_policy: AlgoBase
+    base_policy: QLearningAlgoBase
     name: str
 
     def sample_action_and_output_pscore(self, x: np.ndarray):
         """Only for API consistency."""
         pass
 
     def calc_action_choice_probability(self, x: np.ndarray):
@@ -266,24 +254,24 @@
         \\pi(a \\mid s) := (1 - \\epsilon) * \\mathbb{I}(a = a*)) + \\epsilon / |\\mathcal{A}|
 
     where :math:`\\epsilon` is the probability of taking random actions and :math:`a*` is the greedy action.
     :math:`\\mathbb{I}(\\cdot)` denotes the indicator function.
 
     Note
     -------
-    To ensure API compatibility with `d3rlpy <https://github.com/takuseno/d3rlpy>`_, :class:`BaseHead` inherits :class:`d3rlpy.algos.AlgoBase`.
+    To ensure API compatibility with `d3rlpy <https://github.com/takuseno/d3rlpy>`_, :class:`BaseHead` inherits :class:`d3rlpy.algos.QLearningAlgoBase`.
     This base class also has additional methods including :class:`fit`, :class:`predict`, and :class:`predict_value`. Please also refer to the following documentation for the methods that are not described in this API reference.
 
     .. seealso::
 
-        (external) `d3rlpy's documentation about AlgoBase <https://d3rlpy.readthedocs.io/en/latest/references/algos.html>`_
+        (external) `d3rlpy's documentation about QLearningAlgoBase <https://d3rlpy.readthedocs.io/en/latest/references/algos.html>`_
 
     Parameters
     -------
-    base_policy: AlgoBase
+    base_policy: QLearningAlgoBase
         Reinforcement learning (RL) policy.
 
     name: str
         Name of the policy.
 
     n_actions: int (> 0)
         Number of actions.
@@ -292,26 +280,26 @@
         Probability of exploration. The value should be within `[0, 1]`.
 
     random_state: int, default=None (>= 0)
         Random state.
 
     """
 
-    base_policy: AlgoBase
+    base_policy: QLearningAlgoBase
     name: str
     n_actions: int
     epsilon: float
     random_state: Optional[int] = None
 
     def __post_init__(self):
         "Initialize class."
         self.action_type = "discrete"
 
-        if not isinstance(self.base_policy, AlgoBase):
-            raise ValueError("base_policy must be a child class of AlgoBase")
+        if not isinstance(self.base_policy, QLearningAlgoBase):
+            raise ValueError("base_policy must be a child class of QLearningAlgoBase")
 
         check_scalar(self.n_actions, name="n_actions", target_type=int, min_val=2)
         self.action_matrix = np.eye(self.n_actions)
 
         check_scalar(
             self.epsilon, name="epsilon", target_type=float, min_val=0.0, max_val=1.0
         )
@@ -425,24 +413,24 @@
         \\pi(a \\mid s) := \\frac{\\exp(Q(s, a) / \\tau)}{\\sum_{a' \\in \\mathcal{A}} \\exp(Q(s, a') / \\tau)}
 
     where :math:`\\tau` is the temperature parameter of the softmax function.
     :math:`Q(s, a)` is the predicted value for the given :math:`(s, a)` pair.
 
     Note
     -------
-    To ensure API compatibility with `d3rlpy <https://github.com/takuseno/d3rlpy>`_, :class:`BaseHead` inherits :class:`d3rlpy.algos.AlgoBase`.
+    To ensure API compatibility with `d3rlpy <https://github.com/takuseno/d3rlpy>`_, :class:`BaseHead` inherits :class:`d3rlpy.algos.QLearningAlgoBase`.
     This base class also has additional methods including :class:`fit`, :class:`predict`, and :class:`predict_value`. Please also refer to the following documentation for the methods that are not described in this API reference.
 
     .. seealso::
 
-        (external) `d3rlpy's documentation about AlgoBase <https://d3rlpy.readthedocs.io/en/latest/references/algos.html>`_
+        (external) `d3rlpy's documentation about QLearningAlgoBase <https://d3rlpy.readthedocs.io/en/latest/references/algos.html>`_
 
     Parameters
     -------
-    base_policy: AlgoBase
+    base_policy: QLearningAlgoBase
         Reinforcement learning (RL) policy.
 
     name: str
         Name of the policy.
 
     n_actions: int (> 0)
         Number of actions.
@@ -452,26 +440,26 @@
         A negative value leads to a sub-optimal policy.
 
     random_state: int, default=None (>= 0)
         Random state.
 
     """
 
-    base_policy: AlgoBase
+    base_policy: QLearningAlgoBase
     name: str
     n_actions: int
     tau: float = 1.0
     random_state: Optional[int] = None
 
     def __post_init__(self):
         """Initialize class."""
         self.action_type = "discrete"
 
-        if not isinstance(self.base_policy, AlgoBase):
-            raise ValueError("base_policy must be a child class of AlgoBase")
+        if not isinstance(self.base_policy, QLearningAlgoBase):
+            raise ValueError("base_policy must be a child class of QLearningAlgoBase")
 
         check_scalar(self.n_actions, name="actions", target_type=int, min_val=2)
         check_scalar(self.tau, name="tau", target_type=float)
         if self.tau == 0:
             self.tau += 1e-10
 
         if self.random_state is None:
@@ -635,57 +623,59 @@
         a \\sim Normal(\\pi(s), \\sigma)
 
     where :math:`\\sigma` is the standard deviation of the normal distribution.
     :math:`\\pi(s)` is the action chosen by the deterministic policy.
 
     Note
     -------
-    To ensure API compatibility with `d3rlpy <https://github.com/takuseno/d3rlpy>`_, :class:`BaseHead` inherits :class:`d3rlpy.algos.AlgoBase`.
+    To ensure API compatibility with `d3rlpy <https://github.com/takuseno/d3rlpy>`_, :class:`BaseHead` inherits :class:`d3rlpy.algos.QLearningAlgoBase`.
     This base class also has additional methods including :class:`fit`, :class:`predict`, and :class:`predict_value`. Please also refer to the following documentation for the methods that are not described in this API reference.
 
     .. seealso::
 
-        (external) `d3rlpy's documentation about AlgoBase <https://d3rlpy.readthedocs.io/en/latest/references/algos.html>`_
+        (external) `d3rlpy's documentation about QLearningAlgoBase <https://d3rlpy.readthedocs.io/en/latest/references/algos.html>`_
 
     Parameters
     -------
-    base_policy: AlgoBase
+    base_policy: QLearningAlgoBase
         Reinforcement learning (RL) policy.
 
     name: str
         Name of the policy.
 
     sigma: array-like of shape (action_dim, )
         Standard deviation of Gaussian distribution.
 
     random_state: int, default=None (>= 0)
         Random state.
 
     """
 
-    base_policy: AlgoBase
+    base_policy: QLearningAlgoBase
     name: str
     sigma: np.ndarray
     random_state: Optional[int] = None
 
     def __post_init__(self):
         """Initialize class."""
         self.action_type = "continuous"
 
-        if not isinstance(self.base_policy, AlgoBase):
-            raise ValueError("base_policy must be a child class of AlgoBase")
+        if not isinstance(self.base_policy, QLearningAlgoBase):
+            raise ValueError("base_policy must be a child class of QLearningAlgoBase")
 
         check_array(self.sigma, name="sigma", expected_dim=1, min_val=0.0)
 
         if self.random_state is None:
             raise ValueError("random_state must be given")
         self.random_ = check_random_state(self.random_state)
 
-    def calc_action_choice_probability(self, greedy_action: np.ndarray, action: np.ndarray):
-        """Calculate pscore.
+    def calc_action_choice_probability(
+        self, greedy_action: np.ndarray, action: np.ndarray
+    ):
+        """Calculate action choice probabilities.
 
         Parameters
         -------
         greedy_action: array-like of shape (n_samples, action_dim)
             Greedy action.
 
         action: array-like of shape (n_samples, action_dim)
@@ -785,24 +775,24 @@
         a \\sim TruncNorm(\\pi(s), \\sigma)
 
     where :math:`\\sigma` is the standard deviation of the truncated normal distribution.
     :math:`\\pi(s)` is the action chosen by the deterministic policy.
 
     Note
     -------
-    To ensure API compatibility with `d3rlpy <https://github.com/takuseno/d3rlpy>`_, :class:`BaseHead` inherits :class:`d3rlpy.algos.AlgoBase`.
+    To ensure API compatibility with `d3rlpy <https://github.com/takuseno/d3rlpy>`_, :class:`BaseHead` inherits :class:`d3rlpy.algos.QLearningAlgoBase`.
     This base class also has additional methods including :class:`fit`, :class:`predict`, and :class:`predict_value`. Please also refer to the following documentation for the methods that are not described in this API reference.
 
     .. seealso::
 
-        (external) `d3rlpy's documentation about AlgoBase <https://d3rlpy.readthedocs.io/en/latest/references/algos.html>`_
+        (external) `d3rlpy's documentation about QLearningAlgoBase <https://d3rlpy.readthedocs.io/en/latest/references/algos.html>`_
 
     Parameters
     -------
-    base_policy: AlgoBase
+    base_policy: QLearningAlgoBase
         Reinforcement learning (RL) policy.
 
     name: str
         Name of the policy.
 
     sigma: array-like of shape (action_dim, )
         Standard deviation of Gaussian distribution.
@@ -814,42 +804,44 @@
         Maximum value of action vector.
 
     random_state: int, default=None (>= 0)
         Random state.
 
     """
 
-    base_policy: AlgoBase
+    base_policy: QLearningAlgoBase
     name: str
     sigma: np.ndarray
     minimum: np.ndarray
     maximum: np.ndarray
     random_state: Optional[int] = None
 
     def __post_init__(self):
         """Initialize class."""
         self.action_type = "continuous"
 
-        if not isinstance(self.base_policy, AlgoBase):
-            raise ValueError("base_policy must be a child class of AlgoBase")
+        if not isinstance(self.base_policy, QLearningAlgoBase):
+            raise ValueError("base_policy must be a child class of QLearningAlgoBase")
 
         check_array(self.sigma, name="sigma", expected_dim=1, min_val=0.0)
         check_array(self.minimum, name="minimum", expected_dim=1)
         check_array(self.maximum, name="maximum", expected_dim=1)
 
         if np.any(self.minimum >= self.maximum):
             raise ValueError("minimum must be smaller than maximum")
         self.uniform_pscore = 1 / (self.maximum - self.minimum)
 
         if self.random_state is None:
             raise ValueError("random_state must be given")
         self.random_ = check_random_state(self.random_state)
 
-    def calc_action_choice_probability(self, greedy_action: np.ndarray, action: np.ndarray):
-        """Calculate pscore.
+    def calc_action_choice_probability(
+        self, greedy_action: np.ndarray, action: np.ndarray
+    ):
+        """Calculate action choice probabilities.
 
         Parameters
         -------
         greedy_action: array-like of shape (n_samples, action_dim)
             Greedy action.
 
         action: array-like of shape (n_samples, action_dim)
@@ -942,43 +934,55 @@
 
     Bases: :class:`scope_rl.policy.BaseHead`
 
     Imported as: :class:`scope_rl.policy.ContinuousEvalHead`
 
     Note
     -------
-    To ensure API compatibility with `d3rlpy <https://github.com/takuseno/d3rlpy>`_, :class:`BaseHead` inherits :class:`d3rlpy.algos.AlgoBase`.
+    To ensure API compatibility with `d3rlpy <https://github.com/takuseno/d3rlpy>`_, :class:`BaseHead` inherits :class:`d3rlpy.algos.QLearningAlgoBase`.
     This base class also has additional methods including :class:`fit`, :class:`predict`, and :class:`predict_value`. Please also refer to the following documentation for the methods that are not described in this API reference.
 
     .. seealso::
 
-        (external) `d3rlpy's documentation about AlgoBase <https://d3rlpy.readthedocs.io/en/latest/references/algos.html>`_
+        (external) `d3rlpy's documentation about QLearningAlgoBase <https://d3rlpy.readthedocs.io/en/latest/references/algos.html>`_
 
     Parameters
     -------
-    base_policy: AlgoBase
+    base_policy: QLearningAlgoBase
         Reinforcement learning (RL) policy.
 
     name: str
         Name of the policy.
 
     random_state: int, default=None (>= 0)
         Random state. (This is for API consistency.)
 
     """
 
-    base_policy: AlgoBase
+    base_policy: QLearningAlgoBase
     name: str
     random_state: Optional[int] = None
 
     def __post_init__(self):
         """Initialize class."""
         self.action_type = "continuous"
-        if not isinstance(self.base_policy, AlgoBase):
-            raise ValueError("base_policy must be a child class of AlgoBase")
+        if not isinstance(self.base_policy, QLearningAlgoBase):
+            raise ValueError("base_policy must be a child class of QLearningAlgoBase")
+
+    def sample_action_and_output_pscore(self, x: np.ndarray):
+        """Only for API consistency."""
+        pass
+
+    def calc_action_choice_probability(self, x: np.ndarray):
+        """Only for API consistency."""
+        pass
+
+    def calc_pscore_given_action(self, x: np.ndarray, action: np.ndarray):
+        """Only for API consistency."""
+        pass
 
     def sample_action_and_output_pscore(self, x: np.ndarray):
         """Only for API consistency."""
         pass
 
     def calc_action_choice_probability(self, x: np.ndarray):
         """Only for API consistency."""
```

### Comparing `scope-rl-0.1.3/scope_rl/policy/orl.py` & `scope-rl-0.2.1/scope_rl/policy/orl.py`

 * *Files 3% similar despite different names*

```diff
@@ -5,15 +5,15 @@
 from dataclasses import dataclass
 from collections import defaultdict
 from typing import Union, Optional, Any, Dict, List, Tuple
 from tqdm.auto import tqdm
 
 import numpy as np
 
-from d3rlpy.algos import AlgoBase
+from d3rlpy.algos import QLearningAlgoBase
 from d3rlpy.dataset import MDPDataset
 from sklearn.model_selection import train_test_split
 
 from .head import BaseHead
 from ..utils import MultipleLoggedDataset, defaultdict_to_dict
 from ..types import LoggedDataset
 
@@ -43,26 +43,27 @@
         from scope_rl.dataset import SyntheticDataset
         from scope_rl.policy import TrainCandidatePolicies
         from scope_rl.policy import EpsilonGreedyHead, SoftmaxHead
 
         # import necessary module from other libraries
         import gym
         import rtbgym
-        from d3rlpy.algos import DoubleDQN
-        from d3rlpy.online.buffers import ReplayBuffer
-        from d3rlpy.online.explorers import ConstantEpsilonGreedy
-        from d3rlpy.algos import DiscreteBCQ, DiscreteCQL
+        from d3rlpy.algos import DoubleDQNConfig
+        from d3rlpy.dataset import create_fifo_replay_buffer
+
+        from d3rlpy.algos import ConstantEpsilonGreedy
+        from d3rlpy.algos import DiscreteBCQConfig, DiscreteCQLConfig
 
         # initialize environment
         env = gym.make("RTBEnv-discrete-v0")
 
         # define (RL) agent (i.e., policy) and train on the environment
-        ddqn = DoubleDQN()
-        buffer = ReplayBuffer(
-            maxlen=10000,
+        ddqn = DoubleDQNConfig().create()
+        buffer = create_fifo_replay_buffer(
+            limit=10000,
             env=env,
         )
         explorer = ConstantEpsilonGreedy(
             epsilon=0.3,
         )
         ddqn.fit_online(
             env=env,
@@ -80,28 +81,32 @@
             name="ddqn_epsilon_0.3",
             random_state=12345,
         )
 
         # initialize dataset class
         dataset = SyntheticDataset(
             env=env,
-            behavior_policy=behavior_policy,
-            random_state=12345,
+            max_episode_steps=env.step_per_episode,
         )
 
         # data collection
-        logged_dataset = dataset.obtain_episodes(n_trajectories=100)
+        logged_dataset = dataset.obtain_episodes(
+            behavior_policies=behavior_policy,
+            n_datasets=2,
+            n_trajectories=100,
+            random_state=12345,
+        )
 
     **Learning Evaluation Policies**:
 
     .. code-block:: python
 
         # base algorithms
-        bcq = DiscreteBCQ()
-        cql = DiscreteCQL()
+        bcq = DiscreteBCQConfig().create()
+        cql = DiscreteCQLConfig().create()
         algorithms = [bcq, cql]
         algorithms_name = ["bcq", "cql"]
 
         # policy wrappers
         policy_wrappers = {
             "eps_01": (
                 EpsilonGreedyHead,
@@ -125,44 +130,44 @@
                 }
             ),
         }
 
         # off-policy learning
         orl = TrainCandidatePolicies()
         eval_policies = orl.obtain_evaluation_policy(
+            logged_dataset=logged_dataset,
             algorithms=algorithms,
             algorithms_name=algorithms_name,
             policy_wrappers=policy_wrappers,
             random_state=12345,
         )
 
     **Output**:
 
     .. code-block:: python
 
-        >>> [eval_policy.name for eval_policy in eval_policies[0]]
+        >>> [eval_policy.name for eval_policy in eval_policies[behavior_policy.name][0]]
 
         ['bcq_eps_01', 'bcq_eps_03', 'bcq_softmax', 'cql_eps_01', 'cql_eps_03', 'cql_softmax']
 
 
     """
 
     fitting_args: Optional[Dict[str, Any]] = None
 
     def __post_init__(self):
         if self.fitting_args is None:
             self.fitting_args = {
                 "n_steps": 10000,
-                "scorer": {},
             }
 
     def _learn_base_policy(
         self,
         logged_dataset: LoggedDataset,
-        algorithms: List[AlgoBase],
+        algorithms: List[QLearningAlgoBase],
         random_state: Optional[int] = None,
     ):
         """Learn base policy.
 
         Parameters
         -------
         logged_dataset: LoggedDataset or MultipleLoggedDataset
@@ -190,65 +195,57 @@
                     pscore,
                 ]
 
             .. seealso::
 
                 :class:`scope_rl.dataset.SyntheticDataset` describes the components of :class:`logged_dataset`.
 
-        algorithms: list of AlgoBase
+        algorithms: list of QLearningAlgoBase
             List of algorithms to fit.
 
         random_state: int, default=None (>= 0)
             Random state.
 
         Returns
         -------
-        base_policies: List of AlgoBase
+        base_policies: List of QLearningAlgoBase
             List of learned policies.
 
         """
         offlinerl_dataset = MDPDataset(
             observations=logged_dataset["state"],
             actions=logged_dataset["action"],
             rewards=logged_dataset["reward"],
             terminals=logged_dataset["done"],
-            episode_terminals=logged_dataset["done"],
-            discrete_action=(logged_dataset["action_type"] == "discrete"),
-        )
-        train_episodes, test_episodes = train_test_split(
-            offlinerl_dataset,
-            test_size=0.2,
-            random_state=random_state,
         )
 
         for i in tqdm(
             np.arange(len(algorithms)),
             desc="[learn_policies: algorithms]",
             total=len(algorithms),
         ):
             algorithms[i].fit(
-                train_episodes,
-                eval_episodes=test_episodes,
+                offlinerl_dataset,
                 **self.fitting_args,
             )
 
         return algorithms
 
     def _apply_head(
         self,
-        base_policies: List[AlgoBase],
+        base_policies: List[QLearningAlgoBase],
         base_policies_name: List[str],
         policy_wrappers: HeadDict,
         random_state: Optional[int] = None,
     ):
         """Apply policy wrappers to the (deterministic) base policies.
 
         Parameters
         -------
-        base_policies: list of AlgoBase
+        base_policies: list of QLearningAlgoBase
             List of base (learned) policies.
 
         base_policies_name: list of str
             List of the name of each base policy.
 
         policy_wrappers: HeadDict.
             Dictionary containing information about policy wrappers.
@@ -306,15 +303,15 @@
                 eval_policies.append(eval_policy)
 
         return eval_policies
 
     def learn_base_policy(
         self,
         logged_dataset: Union[LoggedDataset, MultipleLoggedDataset],
-        algorithms: List[AlgoBase],
+        algorithms: List[QLearningAlgoBase],
         behavior_policy_name: Optional[str] = None,
         dataset_id: Optional[int] = None,
         random_state: Optional[int] = None,
     ):
         """Learn base policy.
 
         Parameters
@@ -346,29 +343,29 @@
                     dataset_id,
                 ]
 
             .. seealso::
 
                 :class:`scope_rl.dataset.SyntheticDataset` describes the components of :class:`logged_dataset`.
 
-        algorithms: list of AlgoBase
+        algorithms: list of QLearningAlgoBase
             List of algorithms to fit.
 
         behavior_policy_name: str, default=None
             Name of the behavior policy.
 
         dataset_id: int, default=None
             Id of the logged dataset.
 
         random_state: int, default=None (>= 0)
             Random state.
 
         Returns
         -------
-        base_policies: AlgoBase
+        base_policies: QLearningAlgoBase
             List of learned policies.
 
         """
         if isinstance(logged_dataset, MultipleLoggedDataset):
             if behavior_policy_name is None and dataset_id is None:
                 base_policies = defaultdict(list)
 
@@ -434,24 +431,26 @@
                 random_state=random_state,
             )
 
         return base_policies
 
     def apply_head(
         self,
-        base_policies: Union[List[AlgoBase], Dict[str, List[AlgoBase]]],
+        base_policies: Union[
+            List[QLearningAlgoBase], Dict[str, List[QLearningAlgoBase]]
+        ],
         base_policies_name: List[str],
         policy_wrappers: HeadDict,
         random_state: Optional[int] = None,
     ):
         """Apply policy wrappers to the (deterministic) base policies.
 
         Parameters
         -------
-        base_policies: list of AlgoBase
+        base_policies: list of QLearningAlgoBase
             List of base (learned) policies.
 
         base_policies_name: list of str
             List of the name of each base policy.
 
         policy_wrappers: HeadDict.
             Dictionary containing information about policy wrappers.
@@ -500,15 +499,15 @@
         evaluation_policies: list of BaseHead
             List of (stochastic) evaluation policies.
 
         """
         if isinstance(base_policies, dict):
             evaluation_policies = {}
             for behavior_policy in base_policies.keys():
-                if isinstance(base_policies[behavior_policy][0], AlgoBase):
+                if isinstance(base_policies[behavior_policy][0], QLearningAlgoBase):
                     if len(base_policies[behavior_policy]) != len(base_policies_name):
                         raise ValueError(
                             "Expected `len(base_policies[behavior_policy]) == len(base_policies_name)`, but found False"
                         )
                     evaluation_policies[behavior_policy] = self._apply_head(
                         base_policies=base_policies[behavior_policy],
                         base_policies_name=base_policies_name,
@@ -532,15 +531,15 @@
                             random_state=random_state,
                         )
                         evaluation_policies[behavior_policy].append(
                             evaluation_policies_
                         )
 
         else:
-            if isinstance(base_policies[0], AlgoBase):
+            if isinstance(base_policies[0], QLearningAlgoBase):
                 if len(base_policies) != len(base_policies_name):
                     raise ValueError(
                         "Expected `len(base_policies) == len(base_policies_name)`, but found False"
                     )
                 evaluation_policies = self._apply_head(
                     base_policies=base_policies,
                     base_policies_name=base_policies_name,
@@ -559,15 +558,15 @@
                     evaluation_policies.append(evaluation_policies_)
 
         return evaluation_policies
 
     def obtain_evaluation_policy(
         self,
         logged_dataset: Union[LoggedDataset, MultipleLoggedDataset],
-        algorithms: List[AlgoBase],
+        algorithms: List[QLearningAlgoBase],
         algorithms_name: List[str],
         policy_wrappers: HeadDict,
         behavior_policy_name: Optional[str] = None,
         dataset_id: Optional[int] = None,
         random_state: Optional[int] = None,
     ):
         """Obtain evaluation policies given base algorithms and policy wrappers.
@@ -599,15 +598,15 @@
                     pscore,
                 ]
 
             .. seealso::
 
                 :class:`scope_rl.dataset.SyntheticDataset` describes the components of :class:`logged_dataset`.
 
-        algorithms: list of AlgoBase
+        algorithms: list of QLearningAlgoBase
             List of algorithms to fit.
 
         algorithms_name: list of str
             List of the name of each base policy.
 
         policy_wrappers: HeadDict
             Dictionary containing information about policy wrappers.
@@ -653,15 +652,15 @@
 
         Returns
         -------
         evaluation_policies: list of BaseHead
             List of (stochastic) evaluation policies.
 
         """
-        if not len(algorithms) != len(algorithms_name):
+        if len(algorithms) != len(algorithms_name):
             raise ValueError(
                 "algorithms and alogirthms_name must have the same length, but found False"
             )
         if isinstance(logged_dataset, MultipleLoggedDataset):
             if behavior_policy_name is None and dataset_id is None:
                 eval_policies = defaultdict(list)
```

### Comparing `scope-rl-0.1.3/scope_rl/utils.py` & `scope-rl-0.2.1/scope_rl/utils.py`

 * *Files 23% similar despite different names*

```diff
@@ -11,21 +11,14 @@
 import gym
 import scipy
 import numpy as np
 from sklearn.utils import check_scalar, check_random_state
 
 from .types import LoggedDataset, OPEInputDict
 
-# for scalers
-from typing import ClassVar, List
-import gym
-import torch
-from d3rlpy.dataset import MDPDataset, Transition
-from d3rlpy.preprocessing import Scaler, ActionScaler
-
 
 @dataclass
 class MultipleLoggedDataset:
     """This class contains paths to multiple logged datasets and returns logged_dataset.
 
     Parameters
     -------
@@ -804,213 +797,7 @@
         self.env.close()
 
     def seed(self, seed: Optional[int] = None):
         self.env.reset(seed=seed)
 
     def __getattr__(self, key) -> Any:
         return object.__getattribute__(self.env, key)
-
-
-class MinMaxActionScaler(ActionScaler):
-    r"""Min-Max normalization action preprocessing (temporally supported).
-
-    Actions will be normalized in range ``[-1.0, 1.0]``.
-
-    .. math::
-
-        a' = (a - \min{a}) / (\max{a} - \min{a}) * 2 - 1
-
-    Args:
-        dataset (d3rlpy.dataset.MDPDataset): dataset object.
-
-        min (numpy.ndarray): minimum values at each entry.
-
-        max (numpy.ndarray): maximum values at each entry.
-
-    """
-
-    TYPE: ClassVar[str] = "min_max"
-    _minimum: Optional[np.ndarray]
-    _maximum: Optional[np.ndarray]
-
-    def __init__(
-        self,
-        dataset: Optional[MDPDataset] = None,
-        maximum: Optional[np.ndarray] = None,
-        minimum: Optional[np.ndarray] = None,
-    ):
-        self._minimum = None
-        self._maximum = None
-        if dataset:
-            transitions = []
-            for episode in dataset.episodes:
-                transitions += episode.transitions
-            self.fit(transitions)
-        elif maximum is not None and minimum is not None:
-            self._minimum = np.asarray(minimum)
-            self._maximum = np.asarray(maximum)
-
-    def fit(self, transitions: List[Transition]) -> None:
-        if self._minimum is not None and self._maximum is not None:
-            return
-
-        for i, transition in enumerate(transitions):
-            action = np.asarray(transition.action)
-            if i == 0:
-                minimum = action
-                maximum = action
-            else:
-                minimum = np.minimum(minimum, action)
-                maximum = np.maximum(maximum, action)
-
-        self._minimum = minimum.reshape((1,) + minimum.shape)
-        self._maximum = maximum.reshape((1,) + maximum.shape)
-
-    def fit_with_env(self, env: gym.Env) -> None:
-        if self._minimum is not None and self._maximum is not None:
-            return
-
-        assert isinstance(env.action_space, gym.spaces.Box)
-        shape = env.action_space.shape
-        low = np.asarray(env.action_space.low)
-        high = np.asarray(env.action_space.high)
-        self._minimum = low.reshape((1,) + shape)
-        self._maximum = high.reshape((1,) + shape)
-
-    def transform(self, action: torch.Tensor) -> torch.Tensor:
-        assert self._minimum is not None and self._maximum is not None
-        minimum = torch.tensor(self._minimum, dtype=torch.float32, device=action.device)
-        maximum = torch.tensor(self._maximum, dtype=torch.float32, device=action.device)
-        # transform action into [-1.0, 1.0]
-        return ((action - minimum) / (maximum - minimum)) * 2.0 - 1.0
-
-    def reverse_transform(self, action: torch.Tensor) -> torch.Tensor:
-        assert self._minimum is not None and self._maximum is not None
-        minimum = torch.tensor(self._minimum, dtype=torch.float32, device=action.device)
-        maximum = torch.tensor(self._maximum, dtype=torch.float32, device=action.device)
-        # transform action from [-1.0, 1.0]
-        return ((maximum - minimum) * ((action + 1.0) / 2.0)) + minimum
-
-    def transform_numpy(self, action: np.ndarray) -> np.ndarray:
-        assert self._minimum is not None and self._maximum is not None
-        minimum, maximum = self._minimum, self._maximum
-        # transform action into [-1.0, 1.0]
-        return ((action - minimum) / (maximum - minimum)) * 2.0 - 1.0
-
-    def reverse_transform_numpy(self, action: np.ndarray) -> np.ndarray:
-        assert self._minimum is not None and self._maximum is not None
-        minimum, maximum = self._minimum, self._maximum
-        # transform action from [-1.0, 1.0]
-        return ((maximum - minimum) * ((action + 1.0) / 2.0)) + minimum
-
-    def get_params(self, deep: bool = False) -> Dict[str, Any]:
-        if self._minimum is not None:
-            minimum = self._minimum.copy() if deep else self._minimum
-        else:
-            minimum = None
-
-        if self._maximum is not None:
-            maximum = self._maximum.copy() if deep else self._maximum
-        else:
-            maximum = None
-
-        return {"minimum": minimum, "maximum": maximum}
-
-
-class MinMaxScaler(Scaler):
-    """Min-Max normalization preprocessing (temporally supported).
-
-    .. math::
-
-        x' = (x - \min{x}) / (\max{x} - \min{x})
-
-    Args:
-        dataset (d3rlpy.dataset.MDPDataset): dataset object.
-
-        min (numpy.ndarray): minimum values at each entry.
-
-        max (numpy.ndarray): maximum values at each entry.
-
-    """
-
-    TYPE: ClassVar[str] = "min_max"
-    _minimum: Optional[np.ndarray]
-    _maximum: Optional[np.ndarray]
-
-    def __init__(
-        self,
-        dataset: Optional[MDPDataset] = None,
-        maximum: Optional[np.ndarray] = None,
-        minimum: Optional[np.ndarray] = None,
-    ):
-        self._minimum = None
-        self._maximum = None
-        if dataset:
-            transitions = []
-            for episode in dataset.episodes:
-                transitions += episode.transitions
-            self.fit(transitions)
-        elif maximum is not None and minimum is not None:
-            self._minimum = np.asarray(minimum)
-            self._maximum = np.asarray(maximum)
-
-    def fit(self, transitions: List[Transition]) -> None:
-        if self._minimum is not None and self._maximum is not None:
-            return
-
-        for i, transition in enumerate(transitions):
-            observation = np.asarray(transition.observation)
-            if i == 0:
-                minimum = observation
-                maximum = observation
-            else:
-                minimum = np.minimum(minimum, observation)
-                maximum = np.maximum(maximum, observation)
-
-        self._minimum = minimum.reshape((1,) + minimum.shape)
-        self._maximum = maximum.reshape((1,) + maximum.shape)
-
-    def fit_with_env(self, env: gym.Env) -> None:
-        if self._minimum is not None and self._maximum is not None:
-            return
-
-        assert isinstance(env.observation_space, gym.spaces.Box)
-        shape = env.observation_space.shape
-        low = np.asarray(env.observation_space.low)
-        high = np.asarray(env.observation_space.high)
-        self._minimum = low.reshape((1,) + shape)
-        self._maximum = high.reshape((1,) + shape)
-
-    def transform(self, x: torch.Tensor) -> torch.Tensor:
-        assert self._minimum is not None and self._maximum is not None
-        minimum = torch.tensor(self._minimum, dtype=torch.float32, device=x.device)
-        maximum = torch.tensor(self._maximum, dtype=torch.float32, device=x.device)
-        return (x - minimum) / (maximum - minimum)
-
-    def reverse_transform(self, x: torch.Tensor) -> torch.Tensor:
-        assert self._minimum is not None and self._maximum is not None
-        minimum = torch.tensor(self._minimum, dtype=torch.float32, device=x.device)
-        maximum = torch.tensor(self._maximum, dtype=torch.float32, device=x.device)
-        return ((maximum - minimum) * x) + minimum
-
-    def transform_numpy(self, x: np.ndarray) -> np.ndarray:
-        assert self._minimum is not None and self._maximum is not None
-        minimum, maximum = self._minimum, self._maximum
-        return (x - minimum) / (maximum - minimum)
-
-    def reverse_transform_numpy(self, x: torch.Tensor) -> torch.Tensor:
-        assert self._minimum is not None and self._maximum is not None
-        minimum, maximum = self._minimum, self._maximum
-        return ((maximum - minimum) * x) + minimum
-
-    def get_params(self, deep: bool = False) -> Dict[str, Any]:
-        if self._maximum is not None:
-            maximum = self._maximum.copy() if deep else self._maximum
-        else:
-            maximum = None
-
-        if self._minimum is not None:
-            minimum = self._minimum.copy() if deep else self._minimum
-        else:
-            minimum = None
-
-        return {"maximum": maximum, "minimum": minimum}
```

### Comparing `scope-rl-0.1.3/scope_rl.egg-info/PKG-INFO` & `scope-rl-0.2.1/scope_rl.egg-info/PKG-INFO`

 * *Files 4% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: scope-rl
-Version: 0.1.3
+Version: 0.2.1
 Summary: SCOPE-RL: A pipeline for offline reinforcement learning research and applications
 Home-page: https://github.com/hakuhodo-technologies/scope-rl
 Author: Haruka Kiyohara
 Author-email: hk844@cornell.edu
 License: Apache License 2.0
 Keywords: off-policy evaluation,offline reinforcement learning,risk assessment
 Platform: UNKNOWN
@@ -22,14 +22,23 @@
 Description-Content-Type: text/markdown
 License-File: LICENSE
 
 # SCOPE-RL: A Python library for offline reinforcement learning, off-policy evaluation, and selection
 
 <div align="center"><img src="https://raw.githubusercontent.com/hakuhodo-technologies/scope-rl/main/images/logo.png" width="100%"/></div>
 
+[![pypi](https://img.shields.io/pypi/v/scope-rl.svg)](https://pypi.python.org/pypi/scope-rl)
+[![Python](https://img.shields.io/badge/python-3.9%20%7C%203.10%20%7C%203.11-blue)](https://www.python.org)
+[![Downloads](https://pepy.tech/badge/scope-rl)](https://pepy.tech/project/scope-rl)
+[![GitHub commit activity](https://img.shields.io/github/commit-activity/m/hakuhodo-technologies/scope-rl)](https://github.com/hakuhodo-technologies/scope-rl/graphs/contributors)
+[![GitHub last commit](https://img.shields.io/github/last-commit/hakuhodo-technologies/scope-rl)](https://github.com/hakuhodo-technologies/scope-rl/graphs/commit-activity)
+[![Documentation Status](https://readthedocs.org/projects/scope-rl/badge/?version=latest)](https://scope-rl.readthedocs.io/en/latest/)
+[![License](https://img.shields.io/badge/License-Apache%202.0-blue.svg)](https://opensource.org/licenses/Apache-2.0)
+[![arXiv](https://img.shields.io/badge/arXiv-23xx.xxxxx-b31b1b.svg)](https://arxiv.org/abs/23xx.xxxxx)
+
 <details>
 <summary><strong>Table of Contents </strong>(click to expand)</summary>
 
 - [SCOPE-RL: A Python library for offline reinforcement learning, off-policy evaluation, and selection](#SCOPE-RL-a-python-library-for-offline-reinforcement-learning-off-policy-evaluation-and-selection)
 - [Overview](#overview)
 - [Installation](#installation)
 - [Usage](#usage)
@@ -172,38 +181,36 @@
 ```Python
 # implement a data collection procedure on the RTBGym environment
 
 # import SCOPE-RL modules
 from scope_rl.dataset import SyntheticDataset
 from scope_rl.policy import EpsilonGreedyHead
 # import d3rlpy algorithms
-from d3rlpy.algos import DoubleDQN
-from d3rlpy.online.buffers import ReplayBuffer
-from d3rlpy.online.explorers import ConstantEpsilonGreedy
+from d3rlpy.algos import DoubleDQNConfig
+from d3rlpy.dataset import create_fifo_replay_buffer
+from d3rlpy.algos import ConstantEpsilonGreedy
 # import rtbgym and gym
 import rtbgym
 import gym
+import torch
 # random state
 random_state = 12345
+device = "cuda:0" if torch.cuda.is_available() else "cpu"
 
 # (0) Setup environment
 env = gym.make("RTBEnv-discrete-v0")
 
-# for api compatibility to d3rlpy
-from scope_rl.utils import OldGymAPIWrapper
-env_ = OldGymAPIWrapper(env)
-
 # (1) Learn a baseline policy in an online environment (using d3rlpy)
 # initialize the algorithm
-ddqn = DoubleDQN()
+ddqn = DoubleDQNConfig().create(device=device)
 # train an online policy
 # this takes about 5min to compute
 ddqn.fit_online(
-    env_,
-    buffer=ReplayBuffer(maxlen=10000, env=env_),
+    env,
+    buffer=create_fifo_replay_buffer(limit=10000, env=env),
     explorer=ConstantEpsilonGreedy(epsilon=0.3),
     n_steps=100000,
     n_steps_per_epoch=1000,
     update_start_step=1000,
 )
 
 # (2) Generate a logged dataset
@@ -214,56 +221,53 @@
     epsilon=0.3,
     name="ddqn_epsilon_0.3",
     random_state=random_state,
 )
 # initialize the dataset class
 dataset = SyntheticDataset(
     env=env,
-    maximum_episode_steps=env.step_per_episode,
+    max_episode_steps=env.step_per_episode,
 )
 # the behavior policy collects some logged data
-train_logged_dataset = dataset.obtain_trajectories(
+train_logged_dataset = dataset.obtain_episodes(
   behavior_policies=behavior_policy,
   n_trajectories=10000,
   random_state=random_state,
 )
-test_logged_dataset = dataset.obtain_trajectories(
+test_logged_dataset = dataset.obtain_episodes(
   behavior_policies=behavior_policy,
   n_trajectories=10000,
   random_state=random_state + 1,
 )
 ```
 
 ### Offline Reinforcement Learning
 We are now ready to learn a new policy (evaluation policy) from the logged data using [d3rlpy](https://github.com/takuseno/d3rlpy).
 
 ```Python
 # implement an offline RL procedure using SCOPE-RL and d3rlpy
 
 # import d3rlpy algorithms
 from d3rlpy.dataset import MDPDataset
-from d3rlpy.algos import DiscreteCQL
+from d3rlpy.algos import DiscreteCQLConfig
 
 # (3) Learning a new policy from offline logged data (using d3rlpy)
 # convert the logged dataset into d3rlpy's dataset format
 offlinerl_dataset = MDPDataset(
     observations=train_logged_dataset["state"],
     actions=train_logged_dataset["action"],
     rewards=train_logged_dataset["reward"],
     terminals=train_logged_dataset["done"],
-    episode_terminals=train_logged_dataset["done"],
-    discrete_action=True,
 )
 # initialize the algorithm
-cql = DiscreteCQL()
+cql = DiscreteCQLConfig().create(device=device)
 # train an offline policy
 cql.fit(
     offlinerl_dataset,
     n_steps=10000,
-    scorers={},
 )
 ```
 
 ### Basic Off-Policy Evaluation
 
 Then, we evaluate the performance of several evaluation policies (ddqn, cql, and random) using offline logged data collected by the behavior policy. Specifically, we compare the estimation results of various OPE estimators, including Direct Method (DM), Trajectory-wise Importance Sampling (TIS), Per-Decision Importance Sampling (PDIS), and Doubly Robust (DR) below.
 
@@ -301,15 +305,14 @@
     epsilon=1.0,
     random_state=random_state,
 )
 evaluation_policies = [cql_, ddqn_, random_]
 # create input for the OPE class
 prep = CreateOPEInput(
     env=env,
-    logged_dataset=test_logged_dataset,
 )
 input_dict = prep.obtain_whole_inputs(
     logged_dataset=test_logged_dataset,
     evaluation_policies=evaluation_policies,
     require_value_prediction=True,
     n_trajectories_on_policy_evaluation=100,
     random_state=random_state,
@@ -377,15 +380,15 @@
 </p>
 </figcaption>
 
 For more extensive examples, please refer to [quickstart/rtb/rtb_synthetic_discrete_advanced.ipynb](./examples/quickstart/rtb/rtb_synthetic_discrete_advanced.ipynb).
 
 ### Off-Policy Selection and Evaluation of OPE/OPS
 
-We can also select the best-performing policy among a set of candidate policies based on the OPE results using the OPS class. It is also possible to evaluate the reliability of OPE/OPS using various metrics such as mean squaredberror, rank correlation, regret, and type I and type II error rates.
+We can also select the best-performing policy among a set of candidate policies based on the OPE results using the OPS class. It is also possible to evaluate the reliability of OPE/OPS using various metrics such as mean squared error, rank correlation, regret, and type I and type II error rates.
 
 ```Python
 # perform off-policy selection based on the OPE results
 
 # import SCOPE-RL modules
 from scope_rl.ope import OffPolicySelection
 
@@ -399,15 +402,15 @@
 ranking_dict = ops.select_by_policy_value(input_dict)
 # rank the candidate policies by their policy value estimated by cumulative distribution OPE
 ranking_dict_ = ops.select_by_policy_value_via_cumulative_distribution_ope(input_dict)
 # visualize the top k deployment result
 ops.visualize_topk_policy_value_selected_by_standard_ope(
     input_dict=input_dict,
     compared_estimators=["dm", "tis", "pdis", "dr"],
-    safety_criteria=1.0,
+    relative_safety_criteria=1.0,
 )
 ```
 <div align="center"><img src="https://raw.githubusercontent.com/hakuhodo-technologies/scope-rl/main/images/ops_topk_lower_quartile.png" width="100%"/></div>
 <figcaption>
 <p align="center">
   Comparison of the Top-k Statistics of 10% Lower Quartile of Policy Value
 </p>
@@ -419,15 +422,15 @@
 ranking_df, metric_df = ops.select_by_lower_quartile(
     input_dict,
     alpha=0.3,
     return_metrics=True,
     return_by_dataframe=True,
 )
 # visualize the OPS results with the ground-truth metrics
-ops.visualize_cvar_for_validation(
+ops.visualize_conditional_value_at_risk_for_validation(
     input_dict,
     alpha=0.3,
     share_axes=True,
 )
 ```
 <div align="center"><img src="https://raw.githubusercontent.com/hakuhodo-technologies/scope-rl/main/images/ops_variance_validation.png" width="100%"/></div>
 <figcaption>
```

### Comparing `scope-rl-0.1.3/scope_rl.egg-info/SOURCES.txt` & `scope-rl-0.2.1/scope_rl.egg-info/SOURCES.txt`

 * *Files 0% similar despite different names*

```diff
@@ -68,10 +68,9 @@
 scope_rl/ope/weight_value_learning/base.py
 scope_rl/ope/weight_value_learning/function.py
 scope_rl/ope/weight_value_learning/minimax_value_learning_continuous.py
 scope_rl/ope/weight_value_learning/minimax_value_learning_discrete.py
 scope_rl/ope/weight_value_learning/minimax_weight_learning_continuous.py
 scope_rl/ope/weight_value_learning/minimax_weight_learning_discrete.py
 scope_rl/policy/__init__.py
-scope_rl/policy/encoder.py
 scope_rl/policy/head.py
 scope_rl/policy/orl.py
```

### Comparing `scope-rl-0.1.3/setup.py` & `scope-rl-0.2.1/setup.py`

 * *Files identical despite different names*


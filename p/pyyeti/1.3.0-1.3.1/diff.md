# Comparing `tmp/pyyeti-1.3.0.tar.gz` & `tmp/pyyeti-1.3.1.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "pyyeti-1.3.0.tar", last modified: Sun Jul 23 21:23:24 2023, max compression
+gzip compressed data, was "pyyeti-1.3.1.tar", last modified: Sun Jul 30 00:40:20 2023, max compression
```

## Comparing `pyyeti-1.3.0.tar` & `pyyeti-1.3.1.tar`

### file list

```diff
@@ -1,82 +1,82 @@
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-07-23 21:23:24.011610 pyyeti-1.3.0/
--rw-r--r--   0 runner    (1001) docker     (123)     1545 2023-07-23 21:23:00.000000 pyyeti-1.3.0/LICENSE.txt
--rw-r--r--   0 runner    (1001) docker     (123)      284 2023-07-23 21:23:00.000000 pyyeti-1.3.0/MANIFEST.in
--rw-r--r--   0 runner    (1001) docker     (123)     4268 2023-07-23 21:23:24.015610 pyyeti-1.3.0/PKG-INFO
--rw-r--r--   0 runner    (1001) docker     (123)     3188 2023-07-23 21:23:00.000000 pyyeti-1.3.0/README.md
--rw-r--r--   0 runner    (1001) docker     (123)       89 2023-07-23 21:23:00.000000 pyyeti-1.3.0/pyproject.toml
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-07-23 21:23:24.003610 pyyeti-1.3.0/pyyeti/
--rw-r--r--   0 runner    (1001) docker     (123)     1035 2023-07-23 21:23:00.000000 pyyeti-1.3.0/pyyeti/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)   106717 2023-07-23 21:23:00.000000 pyyeti-1.3.0/pyyeti/cb.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-07-23 21:23:24.007610 pyyeti-1.3.0/pyyeti/cla/
--rw-r--r--   0 runner    (1001) docker     (123)      468 2023-07-23 21:23:00.000000 pyyeti-1.3.0/pyyeti/cla/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)    15100 2023-07-23 21:23:00.000000 pyyeti-1.3.0/pyyeti/cla/_magpct.py
--rw-r--r--   0 runner    (1001) docker     (123)     4520 2023-07-23 21:23:00.000000 pyyeti-1.3.0/pyyeti/cla/_rptext1.py
--rw-r--r--   0 runner    (1001) docker     (123)    36465 2023-07-23 21:23:00.000000 pyyeti-1.3.0/pyyeti/cla/_rptpct1.py
--rw-r--r--   0 runner    (1001) docker     (123)    10341 2023-07-23 21:23:00.000000 pyyeti-1.3.0/pyyeti/cla/_rpttab1.py
--rw-r--r--   0 runner    (1001) docker     (123)    21418 2023-07-23 21:23:00.000000 pyyeti-1.3.0/pyyeti/cla/_utilities.py
--rw-r--r--   0 runner    (1001) docker     (123)    50944 2023-07-23 21:23:00.000000 pyyeti-1.3.0/pyyeti/cla/dr_def.py
--rw-r--r--   0 runner    (1001) docker     (123)    24805 2023-07-23 21:23:00.000000 pyyeti-1.3.0/pyyeti/cla/dr_event.py
--rw-r--r--   0 runner    (1001) docker     (123)   111221 2023-07-23 21:23:00.000000 pyyeti-1.3.0/pyyeti/cla/dr_results.py
--rw-r--r--   0 runner    (1001) docker     (123)    22910 2023-07-23 21:23:00.000000 pyyeti-1.3.0/pyyeti/cla/dr_results_plots.py
--rw-r--r--   0 runner    (1001) docker     (123)     7083 2023-07-23 21:23:00.000000 pyyeti-1.3.0/pyyeti/cla/rel_disp_dtm.py
--rw-r--r--   0 runner    (1001) docker     (123)     3912 2023-07-23 21:23:00.000000 pyyeti-1.3.0/pyyeti/column_plotter.py
--rw-r--r--   0 runner    (1001) docker     (123)    24211 2023-07-23 21:23:00.000000 pyyeti-1.3.0/pyyeti/cyclecount.py
--rw-r--r--   0 runner    (1001) docker     (123)    26399 2023-07-23 21:23:00.000000 pyyeti-1.3.0/pyyeti/datacursor.py
--rw-r--r--   0 runner    (1001) docker     (123)   124529 2023-07-23 21:23:00.000000 pyyeti-1.3.0/pyyeti/dsp.py
--rw-r--r--   0 runner    (1001) docker     (123)    70785 2023-07-23 21:23:00.000000 pyyeti-1.3.0/pyyeti/era.py
--rw-r--r--   0 runner    (1001) docker     (123)    42901 2023-07-23 21:23:00.000000 pyyeti-1.3.0/pyyeti/expmint.py
--rw-r--r--   0 runner    (1001) docker     (123)    29799 2023-07-23 21:23:00.000000 pyyeti-1.3.0/pyyeti/fdepsd.py
--rw-r--r--   0 runner    (1001) docker     (123)    33689 2023-07-23 21:23:00.000000 pyyeti-1.3.0/pyyeti/frclim.py
--rw-r--r--   0 runner    (1001) docker     (123)    16400 2023-07-23 21:23:00.000000 pyyeti-1.3.0/pyyeti/guitools.py
--rw-r--r--   0 runner    (1001) docker     (123)    14662 2023-07-23 21:23:00.000000 pyyeti-1.3.0/pyyeti/locate.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-07-23 21:23:24.007610 pyyeti-1.3.0/pyyeti/nastran/
--rw-r--r--   0 runner    (1001) docker     (123)      138 2023-07-23 21:23:00.000000 pyyeti-1.3.0/pyyeti/nastran/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)   131608 2023-07-23 21:23:00.000000 pyyeti-1.3.0/pyyeti/nastran/bulk.py
--rw-r--r--   0 runner    (1001) docker     (123)   136601 2023-07-23 21:23:00.000000 pyyeti-1.3.0/pyyeti/nastran/n2p.py
--rw-r--r--   0 runner    (1001) docker     (123)   120944 2023-07-23 21:23:00.000000 pyyeti-1.3.0/pyyeti/nastran/op2.py
--rw-r--r--   0 runner    (1001) docker     (123)    91322 2023-07-23 21:23:00.000000 pyyeti-1.3.0/pyyeti/nastran/op4.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-07-23 21:23:24.011610 pyyeti-1.3.0/pyyeti/ode/
--rw-r--r--   0 runner    (1001) docker     (123)      869 2023-07-23 21:23:00.000000 pyyeti-1.3.0/pyyeti/ode/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)    18978 2023-07-23 21:23:00.000000 pyyeti-1.3.0/pyyeti/ode/_base_ode_class.py
--rw-r--r--   0 runner    (1001) docker     (123)    39134 2023-07-23 21:23:00.000000 pyyeti-1.3.0/pyyeti/ode/_utilities.py
--rw-r--r--   0 runner    (1001) docker     (123)     9990 2023-07-23 21:23:00.000000 pyyeti-1.3.0/pyyeti/ode/freqdirect.py
--rw-r--r--   0 runner    (1001) docker     (123)    17392 2023-07-23 21:23:00.000000 pyyeti-1.3.0/pyyeti/ode/frf_mode_participation.py
--rw-r--r--   0 runner    (1001) docker     (123)    10055 2023-07-23 21:23:00.000000 pyyeti-1.3.0/pyyeti/ode/solvecdf.py
--rw-r--r--   0 runner    (1001) docker     (123)     5653 2023-07-23 21:23:00.000000 pyyeti-1.3.0/pyyeti/ode/solveexp1.py
--rw-r--r--   0 runner    (1001) docker     (123)    28070 2023-07-23 21:23:00.000000 pyyeti-1.3.0/pyyeti/ode/solveexp2.py
--rw-r--r--   0 runner    (1001) docker     (123)    27500 2023-07-23 21:23:00.000000 pyyeti-1.3.0/pyyeti/ode/solvenewmark.py
--rw-r--r--   0 runner    (1001) docker     (123)    69302 2023-07-23 21:23:00.000000 pyyeti-1.3.0/pyyeti/ode/solveunc.py
--rw-r--r--   0 runner    (1001) docker     (123)     9395 2023-07-23 21:23:00.000000 pyyeti-1.3.0/pyyeti/pp.py
--rw-r--r--   0 runner    (1001) docker     (123)    43788 2023-07-23 21:23:00.000000 pyyeti-1.3.0/pyyeti/psd.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-07-23 21:23:24.011610 pyyeti-1.3.0/pyyeti/rainflow/
--rw-r--r--   0 runner    (1001) docker     (123)      195 2023-07-23 21:23:00.000000 pyyeti-1.3.0/pyyeti/rainflow/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)    13898 2023-07-23 21:23:00.000000 pyyeti-1.3.0/pyyeti/rainflow/c_rain.c
--rw-r--r--   0 runner    (1001) docker     (123)     6540 2023-07-23 21:23:00.000000 pyyeti-1.3.0/pyyeti/rainflow/py_rain.py
--rw-r--r--   0 runner    (1001) docker     (123)    74708 2023-07-23 21:23:00.000000 pyyeti-1.3.0/pyyeti/srs.py
--rw-r--r--   0 runner    (1001) docker     (123)    11892 2023-07-23 21:23:00.000000 pyyeti-1.3.0/pyyeti/ssmodel.py
--rw-r--r--   0 runner    (1001) docker     (123)    14070 2023-07-23 21:23:00.000000 pyyeti-1.3.0/pyyeti/stats.py
--rw-r--r--   0 runner    (1001) docker     (123)    12371 2023-07-23 21:23:00.000000 pyyeti-1.3.0/pyyeti/writer.py
--rw-r--r--   0 runner    (1001) docker     (123)    57514 2023-07-23 21:23:00.000000 pyyeti-1.3.0/pyyeti/ytools.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-07-23 21:23:24.003610 pyyeti-1.3.0/pyyeti.egg-info/
--rw-r--r--   0 runner    (1001) docker     (123)     4268 2023-07-23 21:23:23.000000 pyyeti-1.3.0/pyyeti.egg-info/PKG-INFO
--rw-r--r--   0 runner    (1001) docker     (123)     1596 2023-07-23 21:23:23.000000 pyyeti-1.3.0/pyyeti.egg-info/SOURCES.txt
--rw-r--r--   0 runner    (1001) docker     (123)        1 2023-07-23 21:23:23.000000 pyyeti-1.3.0/pyyeti.egg-info/dependency_links.txt
--rw-r--r--   0 runner    (1001) docker     (123)       29 2023-07-23 21:23:23.000000 pyyeti-1.3.0/pyyeti.egg-info/requires.txt
--rw-r--r--   0 runner    (1001) docker     (123)        7 2023-07-23 21:23:23.000000 pyyeti-1.3.0/pyyeti.egg-info/top_level.txt
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-07-23 21:23:24.011610 pyyeti-1.3.0/scripts/
--rwxr-xr-x   0 runner    (1001) docker     (123)      581 2023-07-23 21:23:00.000000 pyyeti-1.3.0/scripts/lsop2
--rwxr-xr-x   0 runner    (1001) docker     (123)      365 2023-07-23 21:23:00.000000 pyyeti-1.3.0/scripts/lsop4
--rw-r--r--   0 runner    (1001) docker     (123)      266 2023-07-23 21:23:24.015610 pyyeti-1.3.0/setup.cfg
--rw-r--r--   0 runner    (1001) docker     (123)     4661 2023-07-23 21:23:00.000000 pyyeti-1.3.0/setup.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-07-23 21:23:23.999610 pyyeti-1.3.0/tests/
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-07-23 21:23:24.011610 pyyeti-1.3.0/tests/nas2cam_csuper/
--rw-r--r--   0 runner    (1001) docker     (123)     1622 2023-07-23 21:23:00.000000 pyyeti-1.3.0/tests/nas2cam_csuper/inboard.asm
--rw-r--r--   0 runner    (1001) docker     (123)    25840 2023-07-23 21:23:00.000000 pyyeti-1.3.0/tests/nas2cam_csuper/inboard.op4
--rw-r--r--   0 runner    (1001) docker     (123)     4727 2023-07-23 21:23:00.000000 pyyeti-1.3.0/tests/nas2cam_csuper/inboard.pch
--rw-r--r--   0 runner    (1001) docker     (123)    15736 2023-07-23 21:23:00.000000 pyyeti-1.3.0/tests/nas2cam_csuper/nas2cam.op2
--rw-r--r--   0 runner    (1001) docker     (123)   147552 2023-07-23 21:23:00.000000 pyyeti-1.3.0/tests/nas2cam_csuper/nas2cam.op4
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-07-23 21:23:24.011610 pyyeti-1.3.0/tests/nastran_drm12/
--rw-r--r--   0 runner    (1001) docker     (123)    13464 2023-07-23 21:23:00.000000 pyyeti-1.3.0/tests/nastran_drm12/drm12.op2
--rw-r--r--   0 runner    (1001) docker     (123)    77852 2023-07-23 21:23:00.000000 pyyeti-1.3.0/tests/nastran_drm12/drm12.op4
--rw-r--r--   0 runner    (1001) docker     (123)    17160 2023-07-23 21:23:00.000000 pyyeti-1.3.0/tests/nastran_drm12/inboard_nas2cam.op2
--rw-r--r--   0 runner    (1001) docker     (123)    51624 2023-07-23 21:23:00.000000 pyyeti-1.3.0/tests/nastran_drm12/inboard_nas2cam.op4
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-07-30 00:40:20.509076 pyyeti-1.3.1/
+-rw-r--r--   0 runner    (1001) docker     (123)     1545 2023-07-30 00:40:00.000000 pyyeti-1.3.1/LICENSE.txt
+-rw-r--r--   0 runner    (1001) docker     (123)      284 2023-07-30 00:40:00.000000 pyyeti-1.3.1/MANIFEST.in
+-rw-r--r--   0 runner    (1001) docker     (123)     4168 2023-07-30 00:40:20.509076 pyyeti-1.3.1/PKG-INFO
+-rw-r--r--   0 runner    (1001) docker     (123)     3188 2023-07-30 00:40:00.000000 pyyeti-1.3.1/README.md
+-rw-r--r--   0 runner    (1001) docker     (123)       89 2023-07-30 00:40:00.000000 pyyeti-1.3.1/pyproject.toml
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-07-30 00:40:20.501076 pyyeti-1.3.1/pyyeti/
+-rw-r--r--   0 runner    (1001) docker     (123)     1035 2023-07-30 00:40:00.000000 pyyeti-1.3.1/pyyeti/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)   106819 2023-07-30 00:40:00.000000 pyyeti-1.3.1/pyyeti/cb.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-07-30 00:40:20.505076 pyyeti-1.3.1/pyyeti/cla/
+-rw-r--r--   0 runner    (1001) docker     (123)      468 2023-07-30 00:40:00.000000 pyyeti-1.3.1/pyyeti/cla/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)    15100 2023-07-30 00:40:00.000000 pyyeti-1.3.1/pyyeti/cla/_magpct.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4520 2023-07-30 00:40:00.000000 pyyeti-1.3.1/pyyeti/cla/_rptext1.py
+-rw-r--r--   0 runner    (1001) docker     (123)    36465 2023-07-30 00:40:00.000000 pyyeti-1.3.1/pyyeti/cla/_rptpct1.py
+-rw-r--r--   0 runner    (1001) docker     (123)    10341 2023-07-30 00:40:00.000000 pyyeti-1.3.1/pyyeti/cla/_rpttab1.py
+-rw-r--r--   0 runner    (1001) docker     (123)    21418 2023-07-30 00:40:00.000000 pyyeti-1.3.1/pyyeti/cla/_utilities.py
+-rw-r--r--   0 runner    (1001) docker     (123)    50944 2023-07-30 00:40:00.000000 pyyeti-1.3.1/pyyeti/cla/dr_def.py
+-rw-r--r--   0 runner    (1001) docker     (123)    24805 2023-07-30 00:40:00.000000 pyyeti-1.3.1/pyyeti/cla/dr_event.py
+-rw-r--r--   0 runner    (1001) docker     (123)   111221 2023-07-30 00:40:00.000000 pyyeti-1.3.1/pyyeti/cla/dr_results.py
+-rw-r--r--   0 runner    (1001) docker     (123)    22910 2023-07-30 00:40:00.000000 pyyeti-1.3.1/pyyeti/cla/dr_results_plots.py
+-rw-r--r--   0 runner    (1001) docker     (123)     7083 2023-07-30 00:40:00.000000 pyyeti-1.3.1/pyyeti/cla/rel_disp_dtm.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3912 2023-07-30 00:40:00.000000 pyyeti-1.3.1/pyyeti/column_plotter.py
+-rw-r--r--   0 runner    (1001) docker     (123)    24211 2023-07-30 00:40:00.000000 pyyeti-1.3.1/pyyeti/cyclecount.py
+-rw-r--r--   0 runner    (1001) docker     (123)    26399 2023-07-30 00:40:00.000000 pyyeti-1.3.1/pyyeti/datacursor.py
+-rw-r--r--   0 runner    (1001) docker     (123)   127254 2023-07-30 00:40:00.000000 pyyeti-1.3.1/pyyeti/dsp.py
+-rw-r--r--   0 runner    (1001) docker     (123)    70785 2023-07-30 00:40:00.000000 pyyeti-1.3.1/pyyeti/era.py
+-rw-r--r--   0 runner    (1001) docker     (123)    42901 2023-07-30 00:40:00.000000 pyyeti-1.3.1/pyyeti/expmint.py
+-rw-r--r--   0 runner    (1001) docker     (123)    29799 2023-07-30 00:40:00.000000 pyyeti-1.3.1/pyyeti/fdepsd.py
+-rw-r--r--   0 runner    (1001) docker     (123)    45468 2023-07-30 00:40:00.000000 pyyeti-1.3.1/pyyeti/frclim.py
+-rw-r--r--   0 runner    (1001) docker     (123)    16400 2023-07-30 00:40:00.000000 pyyeti-1.3.1/pyyeti/guitools.py
+-rw-r--r--   0 runner    (1001) docker     (123)    14662 2023-07-30 00:40:00.000000 pyyeti-1.3.1/pyyeti/locate.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-07-30 00:40:20.505076 pyyeti-1.3.1/pyyeti/nastran/
+-rw-r--r--   0 runner    (1001) docker     (123)      138 2023-07-30 00:40:00.000000 pyyeti-1.3.1/pyyeti/nastran/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)   135179 2023-07-30 00:40:00.000000 pyyeti-1.3.1/pyyeti/nastran/bulk.py
+-rw-r--r--   0 runner    (1001) docker     (123)   136601 2023-07-30 00:40:00.000000 pyyeti-1.3.1/pyyeti/nastran/n2p.py
+-rw-r--r--   0 runner    (1001) docker     (123)   120944 2023-07-30 00:40:00.000000 pyyeti-1.3.1/pyyeti/nastran/op2.py
+-rw-r--r--   0 runner    (1001) docker     (123)    91322 2023-07-30 00:40:00.000000 pyyeti-1.3.1/pyyeti/nastran/op4.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-07-30 00:40:20.509076 pyyeti-1.3.1/pyyeti/ode/
+-rw-r--r--   0 runner    (1001) docker     (123)      869 2023-07-30 00:40:00.000000 pyyeti-1.3.1/pyyeti/ode/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)    18978 2023-07-30 00:40:00.000000 pyyeti-1.3.1/pyyeti/ode/_base_ode_class.py
+-rw-r--r--   0 runner    (1001) docker     (123)    39134 2023-07-30 00:40:00.000000 pyyeti-1.3.1/pyyeti/ode/_utilities.py
+-rw-r--r--   0 runner    (1001) docker     (123)     9990 2023-07-30 00:40:00.000000 pyyeti-1.3.1/pyyeti/ode/freqdirect.py
+-rw-r--r--   0 runner    (1001) docker     (123)    17392 2023-07-30 00:40:00.000000 pyyeti-1.3.1/pyyeti/ode/frf_mode_participation.py
+-rw-r--r--   0 runner    (1001) docker     (123)    10055 2023-07-30 00:40:00.000000 pyyeti-1.3.1/pyyeti/ode/solvecdf.py
+-rw-r--r--   0 runner    (1001) docker     (123)     5653 2023-07-30 00:40:00.000000 pyyeti-1.3.1/pyyeti/ode/solveexp1.py
+-rw-r--r--   0 runner    (1001) docker     (123)    28070 2023-07-30 00:40:00.000000 pyyeti-1.3.1/pyyeti/ode/solveexp2.py
+-rw-r--r--   0 runner    (1001) docker     (123)    27500 2023-07-30 00:40:00.000000 pyyeti-1.3.1/pyyeti/ode/solvenewmark.py
+-rw-r--r--   0 runner    (1001) docker     (123)    69302 2023-07-30 00:40:00.000000 pyyeti-1.3.1/pyyeti/ode/solveunc.py
+-rw-r--r--   0 runner    (1001) docker     (123)     9395 2023-07-30 00:40:00.000000 pyyeti-1.3.1/pyyeti/pp.py
+-rw-r--r--   0 runner    (1001) docker     (123)    43788 2023-07-30 00:40:00.000000 pyyeti-1.3.1/pyyeti/psd.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-07-30 00:40:20.509076 pyyeti-1.3.1/pyyeti/rainflow/
+-rw-r--r--   0 runner    (1001) docker     (123)      195 2023-07-30 00:40:00.000000 pyyeti-1.3.1/pyyeti/rainflow/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)    13898 2023-07-30 00:40:00.000000 pyyeti-1.3.1/pyyeti/rainflow/c_rain.c
+-rw-r--r--   0 runner    (1001) docker     (123)     6540 2023-07-30 00:40:00.000000 pyyeti-1.3.1/pyyeti/rainflow/py_rain.py
+-rw-r--r--   0 runner    (1001) docker     (123)    74708 2023-07-30 00:40:00.000000 pyyeti-1.3.1/pyyeti/srs.py
+-rw-r--r--   0 runner    (1001) docker     (123)    11892 2023-07-30 00:40:00.000000 pyyeti-1.3.1/pyyeti/ssmodel.py
+-rw-r--r--   0 runner    (1001) docker     (123)    14070 2023-07-30 00:40:00.000000 pyyeti-1.3.1/pyyeti/stats.py
+-rw-r--r--   0 runner    (1001) docker     (123)    12371 2023-07-30 00:40:00.000000 pyyeti-1.3.1/pyyeti/writer.py
+-rw-r--r--   0 runner    (1001) docker     (123)    57517 2023-07-30 00:40:00.000000 pyyeti-1.3.1/pyyeti/ytools.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-07-30 00:40:20.501076 pyyeti-1.3.1/pyyeti.egg-info/
+-rw-r--r--   0 runner    (1001) docker     (123)     4168 2023-07-30 00:40:20.000000 pyyeti-1.3.1/pyyeti.egg-info/PKG-INFO
+-rw-r--r--   0 runner    (1001) docker     (123)     1596 2023-07-30 00:40:20.000000 pyyeti-1.3.1/pyyeti.egg-info/SOURCES.txt
+-rw-r--r--   0 runner    (1001) docker     (123)        1 2023-07-30 00:40:20.000000 pyyeti-1.3.1/pyyeti.egg-info/dependency_links.txt
+-rw-r--r--   0 runner    (1001) docker     (123)       29 2023-07-30 00:40:20.000000 pyyeti-1.3.1/pyyeti.egg-info/requires.txt
+-rw-r--r--   0 runner    (1001) docker     (123)        7 2023-07-30 00:40:20.000000 pyyeti-1.3.1/pyyeti.egg-info/top_level.txt
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-07-30 00:40:20.509076 pyyeti-1.3.1/scripts/
+-rwxr-xr-x   0 runner    (1001) docker     (123)      581 2023-07-30 00:40:00.000000 pyyeti-1.3.1/scripts/lsop2
+-rwxr-xr-x   0 runner    (1001) docker     (123)      365 2023-07-30 00:40:00.000000 pyyeti-1.3.1/scripts/lsop4
+-rw-r--r--   0 runner    (1001) docker     (123)      266 2023-07-30 00:40:20.509076 pyyeti-1.3.1/setup.cfg
+-rw-r--r--   0 runner    (1001) docker     (123)     4571 2023-07-30 00:40:00.000000 pyyeti-1.3.1/setup.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-07-30 00:40:20.497076 pyyeti-1.3.1/tests/
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-07-30 00:40:20.509076 pyyeti-1.3.1/tests/nas2cam_csuper/
+-rw-r--r--   0 runner    (1001) docker     (123)     1622 2023-07-30 00:40:00.000000 pyyeti-1.3.1/tests/nas2cam_csuper/inboard.asm
+-rw-r--r--   0 runner    (1001) docker     (123)    25840 2023-07-30 00:40:00.000000 pyyeti-1.3.1/tests/nas2cam_csuper/inboard.op4
+-rw-r--r--   0 runner    (1001) docker     (123)     4727 2023-07-30 00:40:00.000000 pyyeti-1.3.1/tests/nas2cam_csuper/inboard.pch
+-rw-r--r--   0 runner    (1001) docker     (123)    15736 2023-07-30 00:40:00.000000 pyyeti-1.3.1/tests/nas2cam_csuper/nas2cam.op2
+-rw-r--r--   0 runner    (1001) docker     (123)   147552 2023-07-30 00:40:00.000000 pyyeti-1.3.1/tests/nas2cam_csuper/nas2cam.op4
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-07-30 00:40:20.509076 pyyeti-1.3.1/tests/nastran_drm12/
+-rw-r--r--   0 runner    (1001) docker     (123)    13464 2023-07-30 00:40:00.000000 pyyeti-1.3.1/tests/nastran_drm12/drm12.op2
+-rw-r--r--   0 runner    (1001) docker     (123)    77852 2023-07-30 00:40:00.000000 pyyeti-1.3.1/tests/nastran_drm12/drm12.op4
+-rw-r--r--   0 runner    (1001) docker     (123)    17160 2023-07-30 00:40:00.000000 pyyeti-1.3.1/tests/nastran_drm12/inboard_nas2cam.op2
+-rw-r--r--   0 runner    (1001) docker     (123)    51624 2023-07-30 00:40:00.000000 pyyeti-1.3.1/tests/nastran_drm12/inboard_nas2cam.op4
```

### Comparing `pyyeti-1.3.0/LICENSE.txt` & `pyyeti-1.3.1/LICENSE.txt`

 * *Files identical despite different names*

### Comparing `pyyeti-1.3.0/PKG-INFO` & `pyyeti-1.3.1/PKG-INFO`

 * *Files 6% similar despite different names*

```diff
@@ -1,21 +1,19 @@
 Metadata-Version: 2.1
 Name: pyyeti
-Version: 1.3.0
+Version: 1.3.1
 Summary: Tools mostly related to structural dynamics
 Home-page: http://github.com/twmacro/pyyeti/
 Author: Tim Widrick
 Author-email: twmacro@gmail.com
 License: BSD
 Platform: any
 Classifier: Development Status :: 4 - Beta
 Classifier: Programming Language :: C
 Classifier: Programming Language :: Python
-Classifier: Programming Language :: Python :: 3.6
-Classifier: Programming Language :: Python :: 3.7
 Classifier: Programming Language :: Python :: 3.8
 Classifier: Programming Language :: Python :: 3.9
 Classifier: Programming Language :: Python :: 3.10
 Classifier: Programming Language :: Python :: 3.11
 Classifier: Programming Language :: Python :: 3 :: Only
 Classifier: Programming Language :: Python :: Implementation :: CPython
 Classifier: Natural Language :: English
```

#### html2text {}

```diff
@@ -1,22 +1,20 @@
-Metadata-Version: 2.1 Name: pyyeti Version: 1.3.0 Summary: Tools mostly related
+Metadata-Version: 2.1 Name: pyyeti Version: 1.3.1 Summary: Tools mostly related
 to structural dynamics Home-page: http://github.com/twmacro/pyyeti/ Author: Tim
 Widrick Author-email: twmacro@gmail.com License: BSD Platform: any Classifier:
 Development Status :: 4 - Beta Classifier: Programming Language :: C
 Classifier: Programming Language :: Python Classifier: Programming Language ::
-Python :: 3.6 Classifier: Programming Language :: Python :: 3.7 Classifier:
-Programming Language :: Python :: 3.8 Classifier: Programming Language ::
-Python :: 3.9 Classifier: Programming Language :: Python :: 3.10 Classifier:
-Programming Language :: Python :: 3.11 Classifier: Programming Language ::
-Python :: 3 :: Only Classifier: Programming Language :: Python ::
-Implementation :: CPython Classifier: Natural Language :: English Classifier:
-Intended Audience :: Science/Research Classifier: License :: OSI Approved ::
-BSD License Classifier: Operating System :: OS Independent Classifier: Topic ::
-Scientific/Engineering Description-Content-Type: text/markdown License-File:
-LICENSE.txt
+Python :: 3.8 Classifier: Programming Language :: Python :: 3.9 Classifier:
+Programming Language :: Python :: 3.10 Classifier: Programming Language ::
+Python :: 3.11 Classifier: Programming Language :: Python :: 3 :: Only
+Classifier: Programming Language :: Python :: Implementation :: CPython
+Classifier: Natural Language :: English Classifier: Intended Audience ::
+Science/Research Classifier: License :: OSI Approved :: BSD License Classifier:
+Operating System :: OS Independent Classifier: Topic :: Scientific/Engineering
+Description-Content-Type: text/markdown License-File: LICENSE.txt
 [Build_Status] [Documentation_Status] [Coverage_Status] [License:_BSD_3-Clause]
                           [PyPI] [Code_style:_black]
 # pyYeti pyYeti has tools mostly related to structural dynamics: * Solve matrix
 equations of motion in the time and frequency domains * Shock response spectrum
 (SRS) * Fatigue damage equivalent power spectral densities (PSD) * Hurty-Craig-
 Bampton model checks * Coupled loads analysis tools * Statistics tools for
 computing k-factors (for tolerance bounds and intervals) and for order
```

### Comparing `pyyeti-1.3.0/README.md` & `pyyeti-1.3.1/README.md`

 * *Files identical despite different names*

### Comparing `pyyeti-1.3.0/pyyeti/__init__.py` & `pyyeti-1.3.1/pyyeti/__init__.py`

 * *Files identical despite different names*

### Comparing `pyyeti-1.3.0/pyyeti/cb.py` & `pyyeti-1.3.1/pyyeti/cb.py`

 * *Files 0% similar despite different names*

```diff
@@ -2073,26 +2073,29 @@
     if len(refpoint) != 6:
         raise ValueError("reference point must have length of 6")
 
     # make refpoint be relative to b-set:
     refpoint = refpoint - np.min(bset)  # not -= because that can change bset
 
     kbb = K[np.ix_(bset, bset)]
-    # trim out zero rows/cols from kbb:
-    nz = kbb.any(axis=0)
-    z = ~nz
-    if z.any():
-        nz2 = np.ix_(nz, nz)
-        kbb = kbb[nz2]
-        refpoint_bool = np.zeros(lb, dtype=bool)
-        refpoint_bool[refpoint] = True
-        refpoint = refpoint_bool[nz].nonzero()[0]
-        if len(refpoint) != 6:
-            raise RuntimeError("reference point has DOF with zero stiffness")
-        lb = kbb.shape[0]
+
+    lb_orig = lb
+    if lb_orig > 6:
+        # trim out zero rows/cols from kbb:
+        nz = kbb.any(axis=0)
+        z = ~nz
+        if z.any():
+            nz2 = np.ix_(nz, nz)
+            kbb = kbb[nz2]
+            refpoint_bool = np.zeros(lb, dtype=bool)
+            refpoint_bool[refpoint] = True
+            refpoint = refpoint_bool[nz].nonzero()[0]
+            if len(refpoint) != 6:
+                raise RuntimeError("reference point has DOF with zero stiffness")
+            lb = kbb.shape[0]
 
     o = locate.flippv(refpoint, lb)
     rbmodes = np.zeros((lb, 6))
     rbmodes[refpoint] = np.eye(6)
     refpoint_chk = "pass"
 
     if o.size > 0:
@@ -2134,15 +2137,15 @@
                 fout.write("and the difference is:\n\n")
                 _write_matrix(krr - rhs)
 
             with ytools.np_printoptions(precision=2, suppress=1, linewidth=140):
                 fout.write("The percent difference is:\n\n")
                 _write_matrix((rhs - krr) / krr * 100)
 
-    if z.any():
+    if lb_orig > 6 and z.any():
         rb2 = np.empty((z.shape[0], 6))
         rb2[nz, :] = rbmodes
         rb2[z, :] = 0.0
         rbmodes = rb2
 
     if rb_normalizer is not None:
         rbmodes = rbmodes @ rb_normalizer
```

### Comparing `pyyeti-1.3.0/pyyeti/cla/_magpct.py` & `pyyeti-1.3.1/pyyeti/cla/_magpct.py`

 * *Files identical despite different names*

### Comparing `pyyeti-1.3.0/pyyeti/cla/_rptext1.py` & `pyyeti-1.3.1/pyyeti/cla/_rptext1.py`

 * *Files identical despite different names*

### Comparing `pyyeti-1.3.0/pyyeti/cla/_rptpct1.py` & `pyyeti-1.3.1/pyyeti/cla/_rptpct1.py`

 * *Files identical despite different names*

### Comparing `pyyeti-1.3.0/pyyeti/cla/_rpttab1.py` & `pyyeti-1.3.1/pyyeti/cla/_rpttab1.py`

 * *Files identical despite different names*

### Comparing `pyyeti-1.3.0/pyyeti/cla/_utilities.py` & `pyyeti-1.3.1/pyyeti/cla/_utilities.py`

 * *Files identical despite different names*

### Comparing `pyyeti-1.3.0/pyyeti/cla/dr_def.py` & `pyyeti-1.3.1/pyyeti/cla/dr_def.py`

 * *Files identical despite different names*

### Comparing `pyyeti-1.3.0/pyyeti/cla/dr_event.py` & `pyyeti-1.3.1/pyyeti/cla/dr_event.py`

 * *Files identical despite different names*

### Comparing `pyyeti-1.3.0/pyyeti/cla/dr_results.py` & `pyyeti-1.3.1/pyyeti/cla/dr_results.py`

 * *Files identical despite different names*

### Comparing `pyyeti-1.3.0/pyyeti/cla/dr_results_plots.py` & `pyyeti-1.3.1/pyyeti/cla/dr_results_plots.py`

 * *Files identical despite different names*

### Comparing `pyyeti-1.3.0/pyyeti/cla/rel_disp_dtm.py` & `pyyeti-1.3.1/pyyeti/cla/rel_disp_dtm.py`

 * *Files identical despite different names*

### Comparing `pyyeti-1.3.0/pyyeti/column_plotter.py` & `pyyeti-1.3.1/pyyeti/column_plotter.py`

 * *Files identical despite different names*

### Comparing `pyyeti-1.3.0/pyyeti/cyclecount.py` & `pyyeti-1.3.1/pyyeti/cyclecount.py`

 * *Files identical despite different names*

### Comparing `pyyeti-1.3.0/pyyeti/datacursor.py` & `pyyeti-1.3.1/pyyeti/datacursor.py`

 * *Files identical despite different names*

### Comparing `pyyeti-1.3.0/pyyeti/dsp.py` & `pyyeti-1.3.1/pyyeti/dsp.py`

 * *Files 4% similar despite different names*

```diff
@@ -13,14 +13,22 @@
 import pandas as pd
 import scipy.signal as signal
 import scipy.interpolate as interp
 import matplotlib.patches as mpatches
 from pyyeti.ytools import _check_makeplot
 
 
+try:
+    import numba
+except ImportError:
+    HAVE_NUMBA = False
+else:
+    HAVE_NUMBA = True
+
+
 # FIXME: We need the str/repr formatting used in Numpy < 1.14.
 try:
     np.set_printoptions(legacy="1.13")
 except TypeError:
     pass
 
 
@@ -505,15 +513,15 @@
         pv.append(k)
     return pv
 
 
 def _get_stats_full(y, n, sigma, min_limit, xp):
     ave = exclusive_sgfilter(y, n, exclude_point=xp)
     y_delta = abs(y - ave)
-    var = exclusive_sgfilter(y ** 2, n, exclude_point=xp) - ave ** 2
+    var = exclusive_sgfilter(y**2, n, exclude_point=xp) - ave**2
     # use abs to care of negative numerical zeros:
     std = np.sqrt(abs(var))
     limit = np.fmax(sigma * std, min_limit)
     return ave, y_delta, var, std, limit
 
 
 def _outs_first(y, n, sigma, min_limit, xp, ave, y_delta, var, std, limit):
@@ -707,15 +715,14 @@
     the signal may not be at the requested position in the window (see
     :func:`exclusive_sgfilter` for more information on this).
 
     To not use a threshold, set `threshold_sigma` to 0.0 (or set
     `threshold_value` to 0.0).
 
     .. note::
-
         If you plan to use both :func:`fixtime` and :func:`despike`,
         it is recommended that you let :func:`fixtime` call
         :func:`despike` (via the `delspikes` option) instead of
         calling it directly. This is preferable because the ideal time
         to run :func:`despike` is in the middle of :func:`fixtime`:
         after drop-outs have been deleted but before gaps are filled.
 
@@ -928,15 +935,15 @@
         limit[i:j] = np.fmax(sigma * std[i:j], min_limit)
         dpv[i:j] = dy_delta[i:j] > limit[i:j]
 
 
 def _find_outlier_peaks_diff(y, dy, n, sigma, min_limit, xp):
     ave = exclusive_sgfilter(dy, n, exclude_point=xp)
     dy_delta = abs(dy - ave)
-    var = exclusive_sgfilter(dy ** 2, n, exclude_point=xp) - ave ** 2
+    var = exclusive_sgfilter(dy**2, n, exclude_point=xp) - ave**2
     # use abs to care of negative numerical zeros:
     std = np.sqrt(abs(var))
     limit = np.fmax(sigma * std, min_limit)
     dpv = dy_delta > limit
     if xp in ("first", 0):
         yield from _outs_first_diff(
             y, dy, n, sigma, min_limit, xp, ave, dy_delta, var, std, limit, dpv
@@ -1031,15 +1038,14 @@
     the signal may not be at the requested position in the window (see
     :func:`exclusive_sgfilter` for more information on this).
 
     To not use a threshold, set `threshold_sigma` to 0.0 (or set
     `threshold_value` to 0.0).
 
     .. note::
-
         If you plan to use both :func:`fixtime` and
         :func:`despike_diff`, it is recommended that you let
         :func:`fixtime` call :func:`despike_diff` (via the `delspikes`
         option) instead of calling it directly. This is preferable
         because the ideal time to run :func:`despike_diff` is in the
         middle of :func:`fixtime`: after drop-outs have been deleted
         but before gaps are filled.
@@ -1357,104 +1363,165 @@
                 f"there are a large ({n * 100:.2f}%) number of time "
                 f"steps {s1:s} than {dt:g} by more than 7%. Double "
                 f"check the sample rate; it might be too {s2:s}.",
                 RuntimeWarning,
             )
 
 
-def _add_drift_turning_pts(tp, told, dt):
-    # expand turning points if needed to account for drift
-    # (sample rate being slightly off in otherwise good data)
-    tp_drift = []
-    Lold = len(told)
-    for i in range(len(tp) - 1):
-        m, n = tp[i], tp[i + 1]
-        while n - m > 0.1 * Lold:
-            tdiff = np.arange(n - m) * dt - (told[m:n] - told[m])
-            pv = abs(tdiff) > 1.01 * dt / 2
-            if pv[-1]:
-                m += np.nonzero(~pv)[0].max() + 1
-                tp_drift.append(m)
-            else:
-                break
-    return np.sort(np.hstack((tp, tp_drift)))
-
-
-def _get_turning_points(told, dt):
+def _get_time_shifts(told, dt):
     tp = np.empty(len(told), bool)
     tp[0] = True
     tp[1:] = abs(np.diff(told) - dt) > dt / 4
     tp[:-1] |= tp[1:]
     tp[-1] = True
     tp = np.nonzero(tp)[0]
 
     if len(tp) - 2 > len(told) // 2:  # -2 to ignore ends
         align = False
         p = (len(tp) - 2) / len(told) * 100
         msg = (
-            f"there are too many turning points ({p:.2f}%) to "
-            "account for drift or align the largest section. "
-            "Skipping steps 11 and 12."
+            "there are too many time-step changes ('turning points')"
+            f" ({p:.2f}%) to align the largest section."
         )
         warn(msg, RuntimeWarning)
     else:
         align = True
     return tp, align
 
 
-def _mk_initial_tnew(told, sr, dt, difft, fixdrift):
+def _mk_initial_tnew(told, sr, dt, difft):
     L = int(round((told[-1] - told[0]) * sr)) + 1
     tnew = np.arange(L) / sr + told[0]
 
     # get turning points and see if we should try to align:
-    tp, align = _get_turning_points(told, dt)
+    tp, align = _get_time_shifts(told, dt)
 
     if align:
-        if fixdrift:
-            tp = _add_drift_turning_pts(tp, told, dt)
-
-        # align with the "good" range:
+        # align with the largest "good" range in `told`:
         j = np.argmax(np.diff(tp))
-        t_good = told[tp[j] : tp[j + 1] + 1]
+        told_good = told[tp[j] : tp[j + 1] + 1]
+        lold = len(told_good)
 
-        p = _get_prev_index(tnew, t_good[0] + dt / 2)
-        tnew_good = tnew[p : p + len(t_good)]
-
-        delt = np.mean(t_good[: len(tnew_good)] - tnew_good)
-        adelt = abs(delt)
-        if adelt > dt / 2:
-            sgn = np.sign(delt)
-            factor = int(adelt / delt)
-            dt = sgn * (adelt - factor * delt)
+        p = _get_prev_index(tnew, told_good[0] + dt / 2)
+        n = _get_prev_index(tnew, told_good[-1] + dt / 2)
+        tnew_good = tnew[p : n + 1]
+        if (lnew := len(tnew_good)) != lold:
+            lohi = "low" if lnew < lold else "high"
+            warn(
+                "when trying to align best sections of data, lengths of old"
+                f" time vector and new time vector do not match ({lold} vs "
+                f"{lnew}); sample rate used too {lohi}? Only aligning on "
+                "first data point of 'good' section.",
+                RuntimeWarning,
+            )
+            delt = told_good[0] - tnew_good[0]
+        else:
+            delt = np.mean(told_good - tnew_good)
         tnew += delt
     return tnew, tp
 
 
-def _best_fit_segments(tnew, tp, told, dt):
-    L = len(tnew)
-    index = np.zeros(L, np.int64) - 1
-    lastp = 0
-    lastn = 0
-    for i in range(len(tp) - 1):
-        m, n = tp[i], tp[i + 1]
-        p = _get_prev_index(tnew, told[m] + dt / 2)
-        index[lastp:p] = lastn
-        if p + n - m > L:
-            n = L + m - p
-        index[p : p + n - m] = np.arange(m, n)
-        lastp, lastn = p + n - m, n - 1
-    if lastp < L:
-        # can last point be considered part of a good segment?
-        if n - m == 1 and abs(told[n] - told[m] - dt) > dt / 4:
-            # no, so find index and fill in before moving on
-            p = _get_prev_index(tnew, told[n] + dt / 2)
-            index[lastp:p] = lastn
-            lastp = p
-        index[lastp:] = n
-    return index
+if not HAVE_NUMBA:
+
+    def _find_closest_times(told, tnew):
+        # - note this simple method doesn't work if there are large
+        #   gaps in `told`:
+        #       index = np.searchsorted(told, tnew - dt / 2)
+
+        index = np.searchsorted(told, tnew)
+        # told[index] <= tnew (except possibly at ends)
+
+        lold = len(told)
+        index[index == lold] = lold - 1
+
+        delta = told[index] - tnew
+
+        # check 1 time-step earlier to see if it's closer:
+        delta_1 = told[index - 1] - tnew
+
+        pv = abs(delta_1) <= abs(delta)
+        index[pv] -= 1
+        return index
+
+    def _find_closest_previous_times(told, tnew):
+        index = np.searchsorted(told, tnew) - 1
+        index[index < 0] = 0
+        return index
+
+else:
+
+    @numba.njit(cache=True)
+    def _find_closest_times(told, tnew):
+        # both vectors are monotonically ascending
+        lold = len(told)
+        lnew = len(tnew)
+
+        # find first i such that told[i] >= tnew[0]:
+        v = tnew[0]
+        for i in range(lold):
+            if told[i] >= v:
+                break
+        else:
+            return np.zeros(lnew, np.int64)
+
+        index = np.empty(lnew, np.int64)
+        if i > 0 and v - told[i - 1] <= told[i] - v:
+            index[0] = i - 1
+        else:
+            index[0] = i
+
+        for j in range(1, lnew):
+            v = tnew[j]
+
+            for i in range(i, lold):
+                if told[i] >= v:
+                    break
+
+            if i > 0 and v - told[i - 1] <= told[i] - v:
+                index[j] = i - 1
+            else:
+                index[j] = i
+
+        return index
+
+    @numba.njit(cache=True)
+    def _find_closest_previous_times(told, tnew):
+        # both vectors are monotonically ascending
+        lold = len(told)
+        lnew = len(tnew)
+
+        # find first i such that told[i] > tnew[0]:
+        v = tnew[0]
+        for i in range(lold):
+            if told[i] > v:
+                break
+        else:
+            return np.zeros(lnew, np.int64)
+
+        index = np.empty(lnew, np.int64)
+        if i > 0:
+            index[0] = i - 1
+        else:
+            index[0] = i
+
+        for j in range(1, lnew):
+            v = tnew[j]
+
+            for i in range(i, lold):
+                if told[i] > v:
+                    break
+            else:
+                i = lold
+
+            if i > 0:
+                index[j] = i - 1
+            else:
+                index[j] = i
+
+        return index
 
 
 def _return(t, data, alldrops, sr_stats, tp, getall, return_ndarray, despike_info):
     if return_ndarray:
         newdata = np.vstack((t, data)).T
     else:
         newdata = (t, data)
@@ -1465,21 +1532,23 @@
         return newdata, fixinfo
     return newdata
 
 
 def fixtime(
     olddata,
     sr=None,
+    *,
     negmethod="sort",
     deldrops=True,
     dropval=-1.40130e-45,
     delouttimes=True,
     delspikes=False,
     base=None,
-    fixdrift=False,
+    hold_previous_value=False,
+    previous_value_tol=1e-3,
     getall=False,
     verbose=True,
 ):
     """
     Process recorded data to make an even time vector.
 
     Parameters
@@ -1543,16 +1612,35 @@
             sigma = 8
             maxiter = -1   # negative value means no limit
 
     base : scalar or None; optional
         Scalar value that new time vector would hit exactly if within
         range. If None, new time vector is aligned to longest section
         of "good" data.
-    fixdrift : bool; optional
-        If True, shift data
+    hold_previous_value : bool; optional
+        If True, hold previous value instead of finding closest value
+        (but see `previous_value_tol`). The default is False; find
+        closest value and, in case of a tie, use previous value. For
+        example::
+
+            olddata = ([0.0, 4.0], [10.0, 20])
+            t, y1 = fixtime(olddata, sr=1.0)
+            t, y2 = fixtime(olddata, sr=1.0, hold_previous_value=True)
+
+        Gives::
+
+            t  --> array([  0.,   1.,   2.,   3.,   4.])
+            y1 --> array([ 10.,  10.,  10.,  20.,  20.])
+            y2 --> array([ 10.,  10.,  10.,  10.,  20.])
+
+    previous_value_tol : float; optional
+        If `hold_previous_value` is True, a new time value is
+        considered equal to an old time value if it is within
+        ``previous_value_tol * dt`` of it, where ``dt`` is the new
+        time step. Must be within [0.0, 1.0], inclusive.
     getall : bool; optional
         If True, return `fixinfo`; otherwise only `newdata` is
         returned.
     verbose : bool; optional
         If True, sample rate statistics are printed. Note that if `sr`
         is None, `verbose` is internally set to True.
 
@@ -1575,15 +1663,14 @@
 
            The `max_count_sr` is the sample rate that occurred most
            often. This is usually the 'correct' sample rate.
            `max_count_percent` gives the percent occurrence of
            `max_count_sr`.
 
         - `tp` : 1d ndarray
-
            Contains indices into old time vector of where time-step
            shifts ("turning points") were done to align the new time
            vector against the old.
 
         - `alldrops` : SimpleNamespace or None
            Has 1d indexing arrays into `olddata` showing the drops:
 
@@ -1627,15 +1714,15 @@
 
        4.  Check the time vector for negative steps. Sort or error
            out as specified by `negmethod`. Warnings are printed in any
            case.
 
        5.  Compute and print sample rates for user review. Perhaps the
            most useful of these printed numbers is the one based on
-           the count. :func:`np.histogram` is used to count which
+           the count. :func:`numpy.histogram` is used to count which
            sample rate occurs most often (to the nearest multiple of 5
            in most cases). If there is a high percentage printed with
            that sample rate, it is likely the correct value to use (at
            least within 5 samples/second). If `sr` is not input,
            prompt user for `sr`.
 
        6.  Call selected despiker if requested to delete data spikes.
@@ -1652,38 +1739,33 @@
            sample rate that spans the range of time in `olddata`.
 
        10. Find the "turning points" in the old time vector. These are
            where the step differs by more than 1/4 step from the
            ideal. Will issue warning if the number of turning points
            is greater than 50% of total points.
 
-       11. If `fixdrift` is True, and step 10 did not issue a warning
-           about too many turning points, search for additional
-           turning points to account for drift (when the sample rate
-           in the data is slightly off from the ideal). Note: using
-           `fixdrift` is not recommended; it's probably better to
-           adjust the sample rate instead.
-
-       12. If step 10 did not issue a warning about too many turning
+       11. If step 10 did not issue a warning about too many turning
            points, the new time vector is shifted to align with the
            longest section of "good" old time steps.
 
-       13. Loop over the segments defined by the turning points. Each
+       12. Loop over the segments defined by the turning points. Each
            segment will shifted left or right to fit with the new time
            vector. The longest section is not shifted due to step 12
            (unless that step was skipped because of too many turning
            points).
 
-       14. If `base` is not None, the new time vector is shifted by up
+       13. If `base` is not None, the new time vector is shifted by up
            to a half time step such that it would hit `base` exactly
            (if it was in range).
 
-       15. Fill in new data vector using best fit times. This means
-           that gaps are filled with previous value (flat line). This
-           routine does not do any linear interpolation.
+       14. Fill in new data vector using best fit times. This means
+           that gaps are filled with flat lines using the closest
+           value if `hold_previous_value` is False, or the previous
+           value if `hold_previous_value` is True. This routine
+           does not do any linear interpolation.
 
     If despiking is not producing good results:
 
         1. Spikes very near the ends of the signal (in the first or
            last window) can cause trouble for the :func:`despike_diff`
            and :func:`despike` routines. If `exclude_point` is
            'first', spikes in the last window should be avoided (the
@@ -1706,30 +1788,39 @@
 
         5. Try a different method. They all have strengths and
            weaknesses, so experiment.
 
     Examples
     --------
     >>> from pyyeti import dsp
-    >>> t = [0, 1, 6, 7]
-    >>> y = [1, 2, 3, 4]
+    >>> t = [0., 1., 5., 6.]
+    >>> y = [1., 2., 3., 4.]
     >>> tn, yn = dsp.fixtime((t, y), sr=1)
     ==> Info: [min, max, ave, count (% occurrence)] time step:
-    ==>           [1, 5, 2.33333, 1 (66.7%)]
+    ==>           [1, 4, 2, 1 (66.7%)]
     ==>       Corresponding sample rates:
-    ==>           [1, 0.2, 0.428571, 1 (66.7%)]
+    ==>           [1, 0.25, 0.5, 1 (66.7%)]
     ==>       Note: "count" shows most frequent sample rate to
               nearest 0.2 samples/sec.
     ==> Using sample rate = 1
     >>> tn
-    array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.])
+    array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.])
     >>> yn
-    array([1, 2, 2, 2, 2, 2, 3, 4])
-    """
+    array([ 1.,  2.,  2.,  2.,  3.,  3.,  4.])
+
+    Repeat, but with `hold_previous_value` set to True:
 
+    >>> tn, yn = dsp.fixtime(
+    ...    (t, y), sr=1, hold_previous_value=True, verbose=False
+    ... )
+    >>> tn
+    array([ 0.,  1.,  2.,  3.,  4.,  5.,  6.])
+    >>> yn
+    array([ 1.,  2.,  2.,  2.,  2.,  3.,  4.])
+    """
     # begin main routine
     told, olddata, return_ndarray = _get_timedata(olddata)
 
     # check for negative steps:
     told, olddata, difft, sortvec = _chk_negsteps(told, olddata, negmethod)
 
     # prep `delspikes` if needed:
@@ -1774,20 +1865,29 @@
     difft = np.diff(told)
 
     # check for small and large time steps:
     _check_dt_size(difft, dt)
 
     # make initial new time vector aligned with longest range in
     # told of "good" time steps (tp: turning points):
-    tnew, tp = _mk_initial_tnew(told, sr, dt, difft, fixdrift)
+    tnew, tp = _mk_initial_tnew(told, sr, dt, difft)
 
-    # build a best-fit index by segments:
-    index = _best_fit_segments(tnew, tp, told, dt)
+    # build a best-fit index by finding closest new time (no
+    # interpolation)
+    if hold_previous_value:
+        if previous_value_tol < 0.0 or previous_value_tol > 1.0:
+            raise ValueError(
+                "`previous_value_tol` must be in [0.0, 1.0];"
+                f" it is {previous_value_tol}"
+            )
+        index = _find_closest_previous_times(told - dt * previous_value_tol, tnew)
+    else:
+        index = _find_closest_times(told, tnew)
 
-    # fill in new data vector with best-fit times (no interpolation):
+    # fill in new data vector with closest old data:
     newdata = olddata[index]
 
     # if want new time to exactly hit base (if base were in range):
     if base is not None:
         t0 = tnew[0]
         t1 = base - t0 - round((base - t0) * sr) / sr
         tnew += t1
@@ -2075,15 +2175,14 @@
         Set to None if `func` only returns the amplitudes. Otherwise,
         if `func` returns multiple outputs, set `which` to the index
         of the output corresponding to the amplitudes. For example, if
         `func` returns ``(frequencies, amplitudes)``, `which` would be
         1 (and `freq` would be 0).
 
         .. note::
-
            Setting `which` to None is not the same as setting it to
            0. Using None means that the function only returns
            amplitudes, while a 0 indicates that the output of `func`
            must be indexed by 0 to get the amplitudes. For example: if
            the function has ``return amps``, use ``which=None``; if
            the function has ``return (amps,)``, use ``which=0``.
 
@@ -2479,15 +2578,15 @@
         ye_max[ye_max < base] = base
         ye_min[ye_min > base] = base
         ye_max, xe_max = get_turning_pts(ye_max, xe, getindex=0)
         ye_min, xe_min = get_turning_pts(ye_min, xe, getindex=0)
 
     ax = _check_makeplot(makeplot)
     if ax:
-        envlabel = fr"$\pm${p}% envelope"
+        envlabel = rf"$\pm${p}% envelope"
         ln = ax.plot(x, y, label=label)[0]
         p = mpatches.Patch(color=polycolor, label=envlabel)
         if base is None:
             ax.fill_between(xe_max, ye_max, ye_min, facecolor=polycolor, lw=0)
         else:
             ax.fill_between(xe_max, ye_max, base, facecolor=polycolor, lw=0)
             if method == "both":
@@ -2509,15 +2608,15 @@
     y : nd array_like
         Signal(s) to be scaled. Scaling is done along axis `axis`.
     sr : scalar
         Sample rate.
     scale : 2d array_like
         A two column matrix of [freq scale]. It is automatically sized
         to the correct dimensions via linear interpolation (uses
-        :func:`np.interp`).
+        :func:`numpy.interp`).
     axis : int, optional
         Axis along which to operate.
 
     Returns
     -------
     y_new : nd ndarray
         The scaled version of `y`.
@@ -2629,15 +2728,15 @@
         bw = _bw
 
     H = np.empty(freq.shape[0])
     on = pass_zero
     # position ramps; try to have "mag" point closest to each value
     # in w:
     I = 0
-    for (_w, _bw) in zip(w, bw):
+    for _w, _bw in zip(w, bw):
         j = np.argmin(abs(freq - _w))
         ramp = _get_ramp(df, _bw, on)
         n = ramp.shape[0]
         i = np.argmin(abs(ramp - mag))
         if i > j or j - i < I or j - i + n > freq.shape[0]:
             # if ramp doesn't fit in range or if it conflicts with
             # previous, error out:
@@ -3054,15 +3153,15 @@
 
     if not (axis == -1 or axis == x.ndim - 1):
         # Move the axis containing the data to the end
         a = np.swapaxes(a, axis, x.ndim - 1)
         b = np.swapaxes(b, axis, x.ndim - 1)
 
     if coef == "mag":
-        return np.sqrt(a ** 2 + b ** 2), np.arctan2(-a, b), f
+        return np.sqrt(a**2 + b**2), np.arctan2(-a, b), f
     elif coef == "complex":
         return a + 1j * b, None, f
     return a, b, f
 
 
 def fftmap(
     timeslice, tsoverlap, sig, sr, window="hann", dodetrend=False, fold=True, maxdf=None
```

### Comparing `pyyeti-1.3.0/pyyeti/era.py` & `pyyeti-1.3.1/pyyeti/era.py`

 * *Files identical despite different names*

### Comparing `pyyeti-1.3.0/pyyeti/expmint.py` & `pyyeti-1.3.1/pyyeti/expmint.py`

 * *Files identical despite different names*

### Comparing `pyyeti-1.3.0/pyyeti/fdepsd.py` & `pyyeti-1.3.1/pyyeti/fdepsd.py`

 * *Files identical despite different names*

### Comparing `pyyeti-1.3.0/pyyeti/frclim.py` & `pyyeti-1.3.1/pyyeti/frclim.py`

 * *Files 22% similar despite different names*

```diff
@@ -15,22 +15,26 @@
 try:
     np.set_printoptions(legacy="1.13")
 except TypeError:
     pass
 
 
 def calcAM(S, freq):
-    """
+    r"""
     Calculate apparent mass
 
+    Apparent mass is also known as "dynamic mass". The inverse of
+    apparent mass is known as "inertance" or "accelerance". See
+    :func:`ntfl` for more discussion.
+
     Parameters
     ----------
     S : list/tuple
         Contains: ``[mass, damp, stiff, bdof]`` for structure. These
-        are the source mass, damping, and stiffness matrices (see
+        are the Source mass, damping, and stiffness matrices (see
         :class:`pyyeti.ode.SolveUnc`) and `bdof`, which is described
         below.
     freq : 1d array_like
         Frequency vector (Hz)
 
     Returns
     -------
@@ -54,20 +58,116 @@
            :class:`pyyeti.ode.SolveUnc` with ``pre_eig=True`` to
            compute apparent mass).
        2.  Otherwise, `bdof` is assumed to be a 1d partition vector
            from full `N` size to b-set and structure is assumed to be
            in Craig-Bampton form (uses :func:`pyyeti.cb.cbtf` to
            compute apparent mass).
 
-    The routine :func:`ntfl` example demonstrates this function.
-
     See also
     --------
     :func:`ntfl`.
+
+    Examples
+    --------
+    Consider the 2 DOF system:
+
+    .. code-block:: none
+
+        |----|    k    |----|
+        |    |--\/\/\--|    |
+        | m1 |         | m2 |
+        |    |---| |---|    |
+        |----|    c    |----|
+
+        Where:
+
+            m1 = 10.0 kg
+            m2 = 4.0 kg
+            k = 5000.0 N/m
+            c = 15.0 N/(m/s)
+
+    The following will plot the apparent mass curves relative to each
+    of the masses, and annotate the plot with three mass values (4,
+    10, & 14 kg) and three frequency values (free-free, with the 4 kg
+    mass fixed, and with the 10 kg mass fixed). The annotations are
+    meant as an aide to guide intuition.
+
+    .. plot::
+        :context: close-figs
+
+        >>> import numpy as np
+        >>> from scipy.linalg import eigh
+        >>> import matplotlib.pyplot as plt
+        >>> from pyyeti import frclim
+        >>>
+        >>> m1 = 10.0
+        >>> m2 = 4.0
+        >>> k = 5000.0
+        >>> c = 15.0
+        >>>
+        >>> M = np.diag([m1, m2])
+        >>> K = np.array([[k, -k], [-k, k]])
+        >>> C = np.array([[c, -c], [-c, c]])
+        >>>
+        >>> # compute free-free frequencies (1st is 0 Hz rigid-body mode)
+        >>> lam_ff, phi_ff = eigh(K, M)
+        >>> omega_ff = np.sqrt(abs(lam_ff))
+        >>> frq_ff = omega_ff / 2 / np.pi
+        >>>
+        >>> freq = np.geomspace(0.5, 100.0, 500)
+        >>> fig = plt.figure("apparent mass", clear=True)
+        >>> ax = fig.subplots(1, 1)
+        >>>
+        >>> fx_frqs = []
+        >>> for fixed, lbl in (
+        ...     (np.array([True, False]), "Relative to 10 kg Mass"),
+        ...     (np.array([False, True]), "Relative to 4 kg Mass"),
+        ... ):
+        ...     free = ~fixed
+        ...     ff = np.ix_(free, free)
+        ...     lam, phi = eigh(K[ff], M[ff])  # compute fixed frequency
+        ...
+        ...     omega = np.sqrt(lam[0])
+        ...     fx_frqs.append(omega / 2 / np.pi)
+        ...
+        ...     T = np.zeros((1, 2))
+        ...     T[0, fixed] = 1.0
+        ...     am = frclim.calcAM([M, C, K, T], freq)
+        ...     _ = ax.loglog(freq, abs(am[0, :, 0]), label=lbl)
+        >>>
+        >>> _ = ax.set_title("Apparent Mass")
+        >>> _ = ax.set_xlabel("Frequency (Hz)")
+        >>> _ = ax.set_ylabel("Apparent Mass (kg)")
+        >>> _ = ax.legend(loc="upper right")
+        >>>
+        >>> opts = dict(lw=1.5, c="gray", zorder=-10)
+        >>> _ = ax.axhline(14, ls="--", **opts)
+        >>> _ = ax.text(100.0, 14, "14 kg", va="bottom", ha="right")
+        >>>
+        >>> _ = ax.axhline(10, ls="--", **opts)
+        >>> _ = ax.text(100.0, 10, "10 kg", va="top", ha="right")
+        >>>
+        >>> _ = ax.axhline(4, ls="--", **opts)
+        >>> _ = ax.text(100.0, 4, "4 kg", va="bottom", ha="right")
+        >>>
+        >>> _ = ax.axvline(fx_frqs[0], ls="-.", **opts)
+        >>> _ = label = f" {fx_frqs[0]:.3f} Hz\n (10 kg fixed)"
+        >>> _ = ax.text(fx_frqs[0], 50, label, va="bottom", ha="left")
+        >>>
+        >>> _ = ax.axvline(fx_frqs[1], ls="-.", **opts)
+        >>> _ = label = f" {fx_frqs[1]:.3f} Hz\n (4 kg fixed)"
+        >>> _ = ax.text(fx_frqs[1], 115, label, va="bottom", ha="left")
+        >>>
+        >>> _ = ax.axvline(frq_ff[1], ls="-.", **opts)
+        >>> _ = label = f" {frq_ff[1]:.3f} Hz\n (free-free)"
+        >>> _ = ax.text(frq_ff[1], 2.0, label, va="bottom", ha="left")
+        >>>
+        >>> fig.tight_layout()
     """
+
     lf = len(freq)
     m = S[0]
     b = S[1]
     k = S[2]
     bdof = np.atleast_1d(S[3])
 
     if bdof.ndim == 2:  # bdof is treated as a drm
@@ -104,53 +204,54 @@
             tf = cb.cbtf(m, b, k, acce[direc, :], freq, bdof, save)
             AM[:, :, direc] = tf.frc
     return AM
 
 
 def ntfl(Source, Load, As, freq):
     r"""
-    Norton Thevenin Force Limit
+    Norton-Thevenin Force Limit
 
     Parameters
     ----------
     Source : list/tuple or 3d ndarray
         Can be either:
 
-           1. list/tuple of ``[mass, damp, stiff, bdof]`` for source
-              (eg, launch vehicle). These are the source mass,
+           1. list/tuple of ``[mass, damp, stiff, bdof]`` for Source
+              (eg, launch vehicle). These are the Source mass,
               damping, and stiffness matrices (see
               :class:`pyyeti.ode.SolveUnc`) and `bdof`, which is
               described below.
-           2. SAM, a 3d ndarray of source apparent mass (from a
+           2. SAM, a 3d ndarray of Source apparent mass (from a
               previous run). See description of outputs.
 
     Load :  list/tuple or 3d ndarray
-        Same format as `Source` except for the "load" (eg spacecraft)
+        Same format as `Source` except for the "Load" (eg, spacecraft)
     As : 2d array_like
-        Free acceleration of the source (interface acceleration
+        Free acceleration of the Source (interface acceleration
         without the Load attached).
     freq : 1d array_like
         Frequency vector in Hz for `Source`, `Load`, `As` and all
         return values.
 
     Returns
     -------
     A SimpleNamespace with the members:
 
-    R : 2d ndarray
-        Norton Thevenin normalized response ratio; complex,
-        # bdof x len(freq). `R` is independent of `As`. Each row of
-        `R` is the ratio of loaded-response over free-response
-        assuming a unit input in that direction (with the other
-        directions fixed).
     A : 2d ndarray
         Coupled system interface acceleration, complex, # bdof x
         len(freq).
     F : 2d ndarray
         Coupled system interface force, complex, # bdof x len(freq)
+    R : 2d ndarray
+        Norton-Thevenin normalized response ratio; complex, # bdof x
+        len(freq). `R` is independent of `As`. Each row of `R` is the
+        diagonal of the ratio of the loaded-response over the
+        free-response, which is the same as the diagonal of the Source
+        apparent mass over the Total apparent mass.
+
     LAM, SAM, TAM : 3d ndarrays
         Load, Source and Total apparent mass matrices:
 
         .. code-block:: none
 
             boundary DOF x Frequencies x boundary DOF
              (response)                   (input)
@@ -158,22 +259,197 @@
         ``TAM = SAM + LAM``
 
     freq : 1d array_like
         Copy of the input `freq`.
 
     Notes
     -----
+    The Norton-Thevenin (NT) equations couple the Source and Load
+    models together in an exact way in the frequency domain. It is a
+    very convenient formulation for force-limiting applications simply
+    because the Source and Load models are kept separate and coupled
+    system responses are computed by using the "apparent mass" of both
+    models and the "free-acceleration" of the Source. If those
+    quantities are known exactly, the responses computed from the NT
+    equations are also exact.
+
+    *Apparent Mass*
+
+    The term "apparent mass" is very apt. Apparent mass is also known
+    as "dynamic mass", and its inverse is known as "inertance" or
+    "accelerance". If you were to grab some point on a structure and
+    push and pull in a sinusoidal fashion at some frequency, the
+    amount of mass you would feel resisting you is the apparent
+    mass. It varies by frequency. At zero Hz (for rigid-body motion),
+    there is no vibration and the mass you feel is the physical mass
+    of the structure. At frequencies greater than zero, the structure
+    will vibrate and "inertial forces" (mass x acceleration) will come
+    into play. Inertial forces can either push against you -- so
+    apparent mass > physical mass -- or work with you -- so apparent
+    mass < physical mass.
+
+    To compute the apparent mass for the Source (or the Load) relative
+    to the boundary "b" DOF that attach to the Load (or the Source),
+    consider this frequency domain equation:
+
+    .. math::
+
+        \ddot{X}_{b}(\Omega) = H_{bb}(\Omega) \cdot F_{b}(\Omega)
+
+    The transfer function :math:`H_{bb}(\Omega)` is known as
+    "inertance" or "accelerance". By applying unit forces to the "b"
+    DOF one at a time (so that :math:`F_{b}(\Omega)` is identity), the
+    response :math:`\ddot{X}_{b}(\Omega)` is equal to
+    :math:`H_{bb}(\Omega)`. The apparent mass :math:`AM_{bb}(\Omega)`
+    is simply the inverse of the accelerance :math:`H_{bb}(\Omega)`:
+
+    .. math::
+
+        \begin{array}{c}
+            AM_{bb}(\Omega) = {H_{bb}(\Omega)}^{-1} \\
+            F_{b} (\Omega) = AM_{bb}(\Omega) \cdot
+                \ddot{X}_{b}(\Omega)
+        \end{array}
+
+    This is Newton's second law (``F = ma``) in the frequency
+    domain. The routine :func:`calcAM` calculates the apparent mass.
+
+    *Free Acceleration*
+
+    The term "free acceleration" is also quite apt. With all Source
+    external forces applied as normal, "free acceleration" is the
+    acceleration response of the Source "b" DOF with those DOF in a
+    free-free boundary condition (that is, without the Load attached).
+
+    *Deriving the NT Coupling Equations*
+
+    Consider the equations of motion for the Source ("S") or the Load
+    ("L"):
+
+    .. math::
+        \left\{
+            \begin{array}{c}
+                \ddot{X}_b(\Omega) \\
+                \ddot{X}_o(\Omega)
+            \end{array}
+        \right\}_{S~or~L} =
+        \left[
+            \begin{array}{cc}
+                H_{bb}(\Omega) & H_{bo}(\Omega) \\
+                H_{ob}(\Omega) & H_{oo}(\Omega)
+            \end{array}
+        \right]_{S~or~L}
+        \left\{
+            \begin{array}{c}
+                F_b(\Omega) + \tilde{F}_b(\Omega) \\
+                F_o(\Omega)
+            \end{array}
+        \right\}_{S~or~L}~~~~~~~(1)
+
+    Here, the "o" DOF are all other DOF (DOF that are not on the
+    boundary), :math:`F_b` and :math:`F_o` are externally applied
+    forces, and :math:`\tilde{F}_b` are forces from the other
+    component.
+
+    For joint compatibility, we need equal accelerations, and equal
+    but opposite forces:
+
+    .. math::
+        \begin{array}{c}
+            \ddot{X}_{b,L}(\Omega) = \ddot{X}_{b,S}(\Omega)
+                = \ddot{X}_b(\Omega) \\
+            \tilde{F}_{b,L}(\Omega) = - \tilde{F}_{b,S}(\Omega)
+                = \tilde{F}_b(\Omega)
+        \end{array}
+
+    For the Load without any externally applied forces, :math:`F_{b,L}
+    = 0` and :math:`F_{o,L} = 0`, the 1st partition of equation (1)
+    becomes:
+
+    .. math::
+        \ddot{X}_b(\Omega) = H_{bb,L}(\Omega) \cdot \tilde{F}_b(\Omega)
+
+    Or:
+
+    .. math::
+         \tilde{F}_b(\Omega) = AM_{bb,L}(\Omega) \cdot
+         \ddot{X}_b(\Omega)~~~~~~~(2)
+
+    To derive an equation for the free acceleration
+    :math:`A_S(\Omega)`, set :math:`\tilde{F}_{b,S} \rightarrow 0`
+    (since there is no Load attached) in equation (1):
+
+    .. math::
+        A_S(\Omega) = \ddot{X}_{b,S,no-Load}(\Omega) =
+            H_{bb,S}(\Omega) \cdot F_{b,S}(\Omega) +
+            H_{bo,S}(\Omega) \cdot F_{o,S}(\Omega)
+
+    Therefore, the top of equation (1) for the Source can be written
+    as (remembering that :math:`\tilde{F}_{b,S}(\Omega) = -
+    \tilde{F}_b(\Omega)`):
+
+    .. math::
+        \ddot{X}_b(\Omega) = - H_{bb,S}(\Omega) \cdot
+            \tilde{F}_{b}(\Omega) + A_S(\Omega)~~~~~~~(3)
+
+    Substituting equation (2) into (3) and collecting terms:
+
+    .. math::
+        \begin{array}{c}
+            \ddot{X}_b(\Omega) = - H_{bb,S}(\Omega) \cdot
+                AM_{bb,L}(\Omega) \cdot
+                \ddot{X}_b(\Omega) + A_S(\Omega) \\
+            (I + H_{bb,S}(\Omega) \cdot AM_{bb,L}(\Omega)) \cdot
+                \ddot{X}_b(\Omega) = A_S(\Omega)
+        \end{array}
+
+    Multiplying that result by the Source apparent mass gives:
+
+    .. math::
+        (AM_{bb,S}(\Omega) + AM_{bb,L}(\Omega)) \cdot
+            \ddot{X}_b(\Omega) = AM_{bb,S}(\Omega) \cdot A_S(\Omega)
+
+    Solving for :math:`\ddot{X}_b(\Omega)`:
+
+    .. math::
+        \ddot{X}_b(\Omega) =
+            (AM_{bb,S}(\Omega) + AM_{bb,L}(\Omega))^{-1} \cdot
+            AM_{bb,S}(\Omega) \cdot A_S(\Omega)~~~~~~~(4)
+
+    After solving for :math:`\ddot{X}_b(\Omega)` from equation (4), we
+    can solve for :math:`\tilde{F}_b(\Omega)` from equation (2). We
+    can also use equation (4) to expand equation (2):
+
+    .. math::
+         \tilde{F}_b(\Omega) = AM_{bb,L}(\Omega) \cdot
+            (AM_{bb,S}(\Omega) + AM_{bb,L}(\Omega))^{-1} \cdot
+            AM_{bb,S}(\Omega) \cdot A_S(\Omega)~~~~~~~(5)
+
+    *Outputs of this routine*
+
     The outputs are computed as follows:
 
     .. math::
+        \begin{aligned}
+            A(\Omega) &= \ddot{X}_b(\Omega) = (AM_{bb,S}(\Omega) +
+                AM_{bb,L}(\Omega))^{-1} \cdot
+                AM_{bb,S}(\Omega) \cdot A_S(\Omega) \\
+            F(\Omega) &= \tilde{F}_b(\Omega) = AM_{bb,L}(\Omega) \cdot
+                A(\Omega) \\
+            R(\Omega) &= diag((AM_{bb,S}(\Omega) +
+                AM_{bb,L}(\Omega))^{-1} \cdot AM_{bb,S}(\Omega)) \\
+        \end{aligned}
+
+    On output, the 3D apparent mass arrays are named as follows:
 
+    .. math::
         \begin{aligned}
-        R(f) &= diag(T_{AM}(f)^{-1} \cdot S_{AM}(f)) \\
-        A(f) &= T_{AM}(f)^{-1} \cdot S_{AM}(f) \cdot A_s(f) \\
-        F(f) &= L_{AM}(f) \cdot T_{AM}(f)^{-1} \cdot S_{AM}(f) \cdot A_s(f)
+            AM_{bb,L}(\Omega) & \rightarrow LAM \\
+            AM_{bb,S}(\Omega) & \rightarrow SAM \\
+            AM_{bb,L}(\Omega) + AM_{bb,S}(\Omega) & \rightarrow TAM
         \end{aligned}
 
     The `bdof` input defines boundary DOF in one of two ways as
     follows. Let `N` be total number of DOF in mass, damping, &
     stiffness.
 
        1.  If `bdof` is a 2d array_like, it is interpreted to be a
@@ -186,79 +462,105 @@
            in Craig-Bampton form (uses :func:`pyyeti.cb.cbtf` to
            compute apparent mass).
 
     Note that the Source and Load `bdof` must define the same number
     of boundary DOF and both sets of boundary DOF must be in the same
     coordinate system.
 
-    Tips:
+    *Tips*
 
     - If using a free-free model, include residual vectors defined
-      relative to the boundary DOF.
-    - The free acceleration of the source is the complex response of
-      the boundary DOF without the load attached. Frequency envelopes
+      relative to the boundary DOF. These can be critical for
+      retaining the boundary flexibility needed for accurate results
+      even in the lowest system frequencies. This is because boundary
+      stiffness that only participates in very high frequency modes
+      with a free-free boundary condition can participate in the
+      lowest frequency modes when connected to another model.
+
+    - The free acceleration of the Source is the complex response of
+      the boundary DOF without the Load attached. Frequency envelopes
       of flight data, or vibration specifications derived from
       envelopes, are not accurate ways to come up with the free
-      acceleration.
+      acceleration because a Load is attached. However, since this is
+      sometimes the only viable option, is it conservative?
+      Conservatism becomes more and more likely with this approach as
+      the number of enveloped curves increases. This is because, for a
+      given Load, the coupled system response will likely exceed the
+      free acceleration response in some frequency bands. See, for
+      example, the final two subplots in the example below; the
+      coupled system response is higher than the free acceleration
+      response at 12.5 Hz. Such enveloping can therefore lead to a
+      very conservative free acceleration curve, which means
+      conservative results.
+
+    - The apparent mass of a structure can be used to perform
+      frequency domain base-drive analyses instead of using a seismic
+      mass. Just compute the force required to meet the acceleration
+      requirement via equation (2) above (:math:`\tilde{F}_b(\Omega) =
+      AM_{bb}(\Omega) \cdot \ddot{X}_b(\Omega)`). Note that a simple
+      matrix multiply will not work for all frequencies at the same
+      time since the apparent mass is a 3D array. You could use a
+      loop, or you could use the remarkable :func:`numpy.einsum`
+      function: ``F = numpy.einsum('ijk,kj->ij', AM, Xdd)``
 
-    Notional example::
+    *Notional example*::
 
         from pyyeti import frclim
         from pyyeti.nastran op2, n2p, op4
         import pickle
 
-        # Load free acceleration of LV
+        # load free acceleration of LV
         dct = pickle.load('ifresults_free.p')
         As = dct['As']
         freq = dct['freq']
 
-        # Load source free-free model, with residual vectors included
+        # load Source free-free model, with residual vectors included
         nas = op2.rdnas2cam('nas2cam')
         m1 = None
         zeta = 0.01
         k1 = nas['lambda'][0]
         k1[:nas['nrb']] = 0.
         b1 = 2*zeta*np.sqrt(k1)
 
         # Transformation to i/f node:
         T, dof = n2p.formdrm(nas, seup=0, sedn=0, dof=888888)
 
-        # Load S/C mass and stiffness:
+        # get S/C mass and stiffness of Load:
         mk = op4.read('mk.op4')
         kgen = mk['kgen']
         mgen = mk['mgen']
         kgen[:6, :6] = 0.
         zeta = 0.01
         bgen = np.diag(2*zeta*np.sqrt(np.diag(kgen)))
 
-        # Norton Thevenin force limit function:
+        # Norton-Thevenin force limit function:
         r = frclim.ntfl([m1, b1, k1, T], [mgen, bgen, kgen,
                         np.arange(6)], As, freq)
 
     See also
     --------
-    :func:`sefl`, :func:`ctdfs`, :func:`stdfs`.
+    :func:`calcAM`, :func:`sefl`, :func:`ctdfs`, :func:`stdfs`.
 
     Examples
     --------
     This example sets up a simple mass-spring system to demonstrate
     that the Norton-Thevenin equations can be exact.
 
     Steps:
 
-      1. setup a coupled system of a SOURCE and a LOAD
-      2. solve for interface acceleration and force from coupled system
+      1. Setup a coupled system of a SOURCE and a LOAD
+      2. Solve for interface acceleration and force from coupled system
          (frequency domain)
-      3. calculate free acceleration from SOURCE alone and setup LOAD
-      4. use :func:`ntfl` to couple the system
-      5. plot interface acceleration and force to show :func:`ntfl` can
+      3. Calculate free acceleration from SOURCE alone and setup LOAD
+      4. Use :func:`ntfl` to couple the system
+      5. Plot interface acceleration and force to show :func:`ntfl` can
          be an exact coupling method
-      6. plot apparent masses
-      7. plot free acceleration and coupled acceleration
-      8. plot normalized response ratio (can be thought of as force
+      6. Plot apparent masses
+      7. Plot free acceleration and coupled acceleration
+      8. Plot normalized response ratio (can be thought of as force
          limiting factor)
 
     1. Setup system:
 
     .. code-block:: none
 
                 |--> x1       |--> x2        |--> x3        |--> x4
@@ -440,18 +742,18 @@
     R = np.empty((r, c), dtype=complex)
     A = np.empty((r, c), dtype=complex)
     F = np.empty((r, c), dtype=complex)
     for j in range(c):
         Ms = SAM[:, j, :]
         Ml = LAM[:, j, :]
         Mr = la.solve(Ms + Ml, Ms)
-        R[:, j] = np.diag(Mr)
         A[:, j] = Mr @ As[:, j]
         F[:, j] = Ml @ A[:, j]
-    return SimpleNamespace(R=R, F=F, A=A, LAM=LAM, SAM=SAM, TAM=TAM, freq=freq)
+        R[:, j] = np.diag(Mr)
+    return SimpleNamespace(F=F, A=A, R=R, LAM=LAM, SAM=SAM, TAM=TAM, freq=freq)
 
 
 def sefl(c, f, f0):
     """
     Semi-empirical normalized force limit.
 
     Parameters
@@ -538,15 +840,15 @@
             |                     |---> a1           |---> a2
         |---------|               |                  |
         |         |     k1     |-----|     k2     |-----|
         |  rigid  |----\/\/\---|     |----\/\/\---|     |
         |  base   |            | m1  |            | m2  |
         |  (M)    |----| |-----|     |----| |-----|     |
         |         |     c1     |-----|     c2     |-----|
-        |---------|           (source)            (load)
+        |---------|           (Source)            (Load)
 
     Analysis is done in the frequency domain. Methodology:
 
       1. Define stiffnesses such that ``k1/m1 = k2/m2`` (this is worst
          case, or very near)
       2. Excite M, bounding frequency range of interest
       3. Recover maximum interface acceleration: ``A`` (accel of m1)
@@ -614,16 +916,16 @@
         zeta1 = zeta2 = 1 / 2 / Q[0]
     else:
         zeta1 = 1 / 2 / Q[0]
         zeta2 = 1 / 2 / Q[1]
     m1 = m2 / mr
     c1 = 2 * zeta1 * w1 * m1
     c2 = 2 * zeta2 * w2 * m2
-    k1 = w1 ** 2 * m1
-    k2 = w2 ** 2 * m2
+    k1 = w1**2 * m1
+    k2 = w2**2 * m2
 
     # setup system equations of motion:
     mass = np.array([[M, 0, 0], [0, m1, 0], [0, 0, m2]])
     damp = np.array([[c1, -c1, 0], [-c1, c1 + c2, -c2], [0, -c2, c2]])
     stif = np.array([[k1, -k1, 0], [-k1, k1 + k2, -k2], [0, -k2, k2]])
     w = la.eigh(stif, mass, eigvals_only=True)
 
@@ -645,21 +947,21 @@
 def _ctdfs_old(mmr1, mmr2, rmr, Q, wr=(1 / np.sqrt(2), np.sqrt(2))):
     r"""
     Compute the normalized force limit for complex 2-DOF system.
 
     Parameters
     ----------
     mmr1 : scalar
-        Modal to residual mass ratio for source; 0.0001 to 10 is
+        Modal to residual mass ratio for Source; 0.0001 to 10 is
         reasonable ``m1/M1``
     mmr2 : scalar
-        Modal to residual mass ratio for load; 0.0001 to 10 is
+        Modal to residual mass ratio for Load; 0.0001 to 10 is
         reasonable ``m2/M2``
     rmr : scalar
-        Residual mass ratio of source over load; 0.0001 to 10 is
+        Residual mass ratio of Source over Load; 0.0001 to 10 is
         reasonable ``M2/M1``
     Q : scalar to 2 element array_like
         Dynamic amplification factor, 1/2/zeta. If a scalar, the same
         value is used for both dampers. If a 2 element vector, it is
         [Q1, Q2] (see figure below).
     wr : 2 element array_like
 
@@ -773,15 +1075,15 @@
 
     if m2 == 0:
         return 1, 1
     if m1 == 0:
         m1 = 1e-5
 
     c1 = 2 * zeta1 * w1 * m1
-    k1 = w1 ** 2 * m1
+    k1 = w1**2 * m1
     fl = wr[0]  # low bound
     fh = wr[1]  # high bound
 
     wrange = np.logspace(np.log10(fl), np.log10(fh), 30)
     step = wrange[-1] - wrange[-2]
     maxstep = 0.0001
     tol = 1e-6
@@ -793,15 +1095,15 @@
 
     mass = np.array([[m1, 0, 0], [0, M1 + M2, 0], [0, 0, m2]])
     while True:
         J += 1
         pknfl = np.zeros_like(wrange)
         for j, w2 in enumerate(wrange * w1):  # tuning loop
             c2 = 2 * zeta2 * w2 * m2
-            k2 = w2 ** 2 * m2
+            k2 = w2**2 * m2
 
             # solve equations of motion at eigenvalues
             damp = np.array([[c1, -c1, 0], [-c1, c1 + c2, -c2], [0, -c2, c2]])
             stif = np.array([[k1, -k1, 0], [-k1, k1 + k2, -k2], [0, -k2, k2]])
             w = la.eigh(stif, mass, eigvals_only=True)
             lam = np.sqrt(abs(w))
             fq2 = lam[1] / 2 / np.pi
@@ -838,21 +1140,21 @@
 def ctdfs(mmr1, mmr2, rmr, Q, wr=(1 / np.sqrt(2), np.sqrt(2))):
     r"""
     Compute the normalized force limit for complex 2-DOF system.
 
     Parameters
     ----------
     mmr1 : scalar
-        Modal to residual mass ratio for source; 0.0001 to 10 is
+        Modal to residual mass ratio for Source; 0.0001 to 10 is
         reasonable ``m1/M1``
     mmr2 : scalar
-        Modal to residual mass ratio for load; 0.0001 to 10 is
+        Modal to residual mass ratio for Load; 0.0001 to 10 is
         reasonable ``m2/M2``
     rmr : scalar
-        Residual mass ratio of source over load; 0.0001 to 10 is
+        Residual mass ratio of Source over Load; 0.0001 to 10 is
         reasonable ``M2/M1``
     Q : scalar to 2 element array_like
         Dynamic amplification factor, 1/2/zeta. If a scalar, the same
         value is used for both dampers. If a 2 element vector, it is
         [Q1, Q2] (see figure below).
     wr : 2 element array_like
 
@@ -969,24 +1271,24 @@
 
     if m2 == 0:
         return 1, 1
     if m1 == 0:
         m1 = 1e-5
 
     c1 = 2 * zeta1 * w1 * m1
-    k1 = w1 ** 2 * m1
+    k1 = w1**2 * m1
 
     def get_neg_pknfl(nw2):
         """
         Computes the negative (for minimization) of peak normalized
         force limit
         """
         w2 = nw2 * w1
         c2 = 2 * zeta2 * w2 * m2
-        k2 = w2 ** 2 * m2
+        k2 = w2**2 * m2
 
         # solve equations of motion at eigenvalues
         damp = np.array([[c1, -c1, 0], [-c1, c1 + c2, -c2], [0, -c2, c2]])
         stif = np.array([[k1, -k1, 0], [-k1, k1 + k2, -k2], [0, -k2, k2]])
         w = la.eigh(stif, mass, eigvals_only=True)
         lam = np.sqrt(abs(w))
         fq2 = lam[1] / 2 / np.pi
```

### Comparing `pyyeti-1.3.0/pyyeti/guitools.py` & `pyyeti-1.3.1/pyyeti/guitools.py`

 * *Files identical despite different names*

### Comparing `pyyeti-1.3.0/pyyeti/locate.py` & `pyyeti-1.3.1/pyyeti/locate.py`

 * *Files identical despite different names*

### Comparing `pyyeti-1.3.0/pyyeti/nastran/bulk.py` & `pyyeti-1.3.1/pyyeti/nastran/bulk.py`

 * *Files 1% similar despite different names*

```diff
@@ -55,8172 +55,8395 @@
 00000360: 2020 2261 736d 3275 7365 7422 2c0a 2020    "asm2uset",.  
 00000370: 2020 2272 6477 7462 756c 6b22 2c0a 2020    "rdwtbulk",.  
 00000380: 2020 2272 6465 6967 656e 222c 0a20 2020    "rdeigen",.   
 00000390: 2022 7774 6e61 7369 6e74 7322 2c0a 2020   "wtnasints",.  
 000003a0: 2020 2272 6463 7375 7065 7273 222c 0a20    "rdcsupers",. 
 000003b0: 2020 2022 7264 6578 7472 6e22 2c0a 2020     "rdextrn",.  
 000003c0: 2020 2277 7463 7375 7065 7222 2c0a 2020    "wtcsuper",.  
-000003d0: 2020 2277 7473 7063 3122 2c0a 2020 2020    "wtspc1",.    
-000003e0: 2277 7478 7365 7431 222c 0a20 2020 2022  "wtxset1",.    "
-000003f0: 7774 7163 7365 7422 2c0a 2020 2020 2277  wtqcset",.    "w
-00000400: 7472 6265 3222 2c0a 2020 2020 2277 7472  trbe2",.    "wtr
-00000410: 6265 3322 2c0a 2020 2020 2277 7473 6573  be3",.    "wtses
-00000420: 6574 222c 0a20 2020 2022 7774 7365 7422  et",.    "wtset"
-00000430: 2c0a 2020 2020 2277 7472 7370 6c69 6e65  ,.    "wtrspline
-00000440: 222c 0a20 2020 2022 7774 7273 706c 696e  ",.    "wtrsplin
-00000450: 655f 7269 6e67 7322 2c0a 2020 2020 2277  e_rings",.    "w
-00000460: 7463 6f6f 7264 6361 7264 7322 2c0a 2020  tcoordcards",.  
-00000470: 2020 2277 7465 7874 726e 222c 0a20 2020    "wtextrn",.   
-00000480: 2022 7774 6578 7473 656f 7574 222c 0a20   "wtextseout",. 
-00000490: 2020 2022 6d6b 6e61 7374 222c 0a20 2020     "mknast",.   
-000004a0: 2022 7264 6474 6970 6368 222c 0a5d 0a0a   "rddtipch",.]..
-000004b0: 0a64 6566 206e 6173 5f73 7363 616e 6628  .def nas_sscanf(
-000004c0: 732c 206b 6565 705f 7374 7269 6e67 3d46  s, keep_string=F
-000004d0: 616c 7365 293a 0a20 2020 2022 2222 0a20  alse):.    """. 
-000004e0: 2020 2052 6561 6420 6120 7369 6e67 6c65     Read a single
-000004f0: 2069 6e74 6567 6572 206f 7220 4e61 7374   integer or Nast
-00000500: 7261 6e2d 666f 726d 6174 7465 6420 666c  ran-formatted fl
-00000510: 6f61 7469 6e67 2070 6f69 6e74 206e 756d  oating point num
-00000520: 6265 720a 0a20 2020 2050 6172 616d 6574  ber..    Paramet
-00000530: 6572 730a 2020 2020 2d2d 2d2d 2d2d 2d2d  ers.    --------
-00000540: 2d2d 0a20 2020 2073 203a 2073 7472 696e  --.    s : strin
-00000550: 670a 2020 2020 2020 2020 4d61 7920 6265  g.        May be
-00000560: 2066 6f72 6d61 7474 6564 2069 6e20 7468   formatted in th
-00000570: 6520 4e41 5354 5241 4e20 7368 6f72 7463  e NASTRAN shortc
-00000580: 7574 2077 6179 3b20 6567 2c20 2731 2e37  ut way; eg, '1.7
-00000590: 2d34 270a 2020 2020 2020 2020 696e 7374  -4'.        inst
-000005a0: 6561 6420 6f66 2027 312e 3765 2d34 272e  ead of '1.7e-4'.
-000005b0: 204d 6179 2061 6c73 6f20 7573 6520 2764   May also use 'd
-000005c0: 2720 696e 7374 6561 6420 6f66 2027 6527  ' instead of 'e'
-000005d0: 2e0a 2020 2020 6b65 6570 5f73 7472 696e  ..    keep_strin
-000005e0: 6720 3a20 626f 6f6c 3b20 6f70 7469 6f6e  g : bool; option
-000005f0: 616c 0a20 2020 2020 2020 204f 6e6c 7920  al.        Only 
-00000600: 7573 6564 2069 6620 6073 6020 6973 2061  used if `s` is a
-00000610: 2073 7472 696e 6720 7468 6174 2063 616e   string that can
-00000620: 6e6f 7420 6265 2069 6e74 6572 7072 6574  not be interpret
-00000630: 6564 2061 7320 610a 2020 2020 2020 2020  ed as a.        
-00000640: 6e75 6d62 6572 2e20 496e 2074 6861 7420  number. In that 
-00000650: 6361 7365 2c20 6966 2060 6b65 6570 5f73  case, if `keep_s
-00000660: 7472 696e 6760 2069 7320 5472 7565 2c20  tring` is True, 
-00000670: 6060 732e 7374 7269 7028 2960 600a 2020  ``s.strip()``.  
-00000680: 2020 2020 2020 6973 2072 6574 7572 6e65        is returne
-00000690: 643b 206f 7468 6572 7769 7365 2c20 6966  d; otherwise, if
-000006a0: 2060 6b65 6570 5f73 7472 696e 6760 2069   `keep_string` i
-000006b0: 7320 4661 6c73 652c 204e 6f6e 6520 6973  s False, None is
-000006c0: 0a20 2020 2020 2020 2072 6574 7572 6e65  .        returne
-000006d0: 642e 0a0a 2020 2020 5265 7475 726e 730a  d...    Returns.
-000006e0: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
-000006f0: 7620 3a20 696e 7420 6f72 2066 6c6f 6174  v : int or float
-00000700: 206f 7220 7374 7269 6e67 206f 7220 4e6f   or string or No
-00000710: 6e65 0a20 2020 2020 2020 2054 6865 2073  ne.        The s
-00000720: 6361 6c61 7220 7661 6c75 6520 7468 6174  calar value that
-00000730: 2074 6865 2073 7472 696e 6720 7265 7072   the string repr
-00000740: 6573 656e 7473 2e20 4966 2073 7472 696e  esents. If strin
-00000750: 6720 6973 0a20 2020 2020 2020 2065 6d70  g is.        emp
-00000760: 7479 2c20 7265 7475 726e 7320 4e6f 6e65  ty, returns None
-00000770: 2e20 4966 2060 6b65 6570 5f73 7472 696e  . If `keep_strin
-00000780: 6760 2069 7320 5472 7565 2c20 6076 6020  g` is True, `v` 
-00000790: 7769 6c6c 2062 650a 2020 2020 2020 2020  will be.        
-000007a0: 6060 732e 7374 7269 7028 2960 6020 7768  ``s.strip()`` wh
-000007b0: 656e 2060 7360 2063 616e 6e6f 7420 6265  en `s` cannot be
-000007c0: 2063 6f6e 7665 7274 6564 2074 6f20 6120   converted to a 
-000007d0: 6e75 6d62 6572 2e0a 0a20 2020 2045 7861  number...    Exa
-000007e0: 6d70 6c65 730a 2020 2020 2d2d 2d2d 2d2d  mples.    ------
-000007f0: 2d2d 0a20 2020 203e 3e3e 2066 726f 6d20  --.    >>> from 
-00000800: 7079 7965 7469 2069 6d70 6f72 7420 6e61  pyyeti import na
-00000810: 7374 7261 6e0a 2020 2020 3e3e 3e20 6e61  stran.    >>> na
-00000820: 7374 7261 6e2e 6e61 735f 7373 6361 6e66  stran.nas_sscanf
-00000830: 2827 2031 3027 290a 2020 2020 3130 0a20  (' 10').    10. 
-00000840: 2020 203e 3e3e 206e 6173 7472 616e 2e6e     >>> nastran.n
-00000850: 6173 5f73 7363 616e 6628 2731 2e37 652d  as_sscanf('1.7e-
-00000860: 3427 290a 2020 2020 302e 3030 3031 370a  4').    0.00017.
-00000870: 2020 2020 3e3e 3e20 6e61 7374 7261 6e2e      >>> nastran.
-00000880: 6e61 735f 7373 6361 6e66 2827 312e 372d  nas_sscanf('1.7-
-00000890: 3427 290a 2020 2020 302e 3030 3031 370a  4').    0.00017.
-000008a0: 2020 2020 3e3e 3e20 6e61 7374 7261 6e2e      >>> nastran.
-000008b0: 6e61 735f 7373 6361 6e66 2827 312e 3764  nas_sscanf('1.7d
-000008c0: 3427 290a 2020 2020 3137 3030 302e 300a  4').    17000.0.
-000008d0: 2020 2020 3e3e 3e20 7072 696e 7428 6e61      >>> print(na
-000008e0: 7374 7261 6e2e 6e61 735f 7373 6361 6e66  stran.nas_sscanf
-000008f0: 2827 2027 2929 0a20 2020 204e 6f6e 650a  (' ')).    None.
-00000900: 2020 2020 3e3e 3e20 7072 696e 7428 6e61      >>> print(na
-00000910: 7374 7261 6e2e 6e61 735f 7373 6361 6e66  stran.nas_sscanf
-00000920: 2827 7374 7269 6e67 2729 290a 2020 2020  ('string')).    
-00000930: 4e6f 6e65 0a20 2020 203e 3e3e 2070 7269  None.    >>> pri
-00000940: 6e74 286e 6173 7472 616e 2e6e 6173 5f73  nt(nastran.nas_s
-00000950: 7363 616e 6628 2773 7472 696e 6727 2c20  scanf('string', 
-00000960: 6b65 6570 5f73 7472 696e 673d 5472 7565  keep_string=True
-00000970: 2929 0a20 2020 2073 7472 696e 670a 2020  )).    string.  
-00000980: 2020 2222 220a 2020 2020 7472 793a 0a20    """.    try:. 
-00000990: 2020 2020 2020 2072 6574 7572 6e20 696e         return in
-000009a0: 7428 7329 0a20 2020 2065 7863 6570 7420  t(s).    except 
-000009b0: 5661 6c75 6545 7272 6f72 3a0a 2020 2020  ValueError:.    
-000009c0: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
-000009d0: 2020 2020 2072 6574 7572 6e20 666c 6f61       return floa
-000009e0: 7428 7329 0a20 2020 2020 2020 2065 7863  t(s).        exc
-000009f0: 6570 7420 5661 6c75 6545 7272 6f72 3a0a  ept ValueError:.
-00000a00: 2020 2020 2020 2020 2020 2020 5320 3d20              S = 
-00000a10: 7320 3d20 732e 7374 7269 7028 290a 2020  s = s.strip().  
-00000a20: 2020 2020 2020 2020 2020 6966 206c 656e            if len
-00000a30: 2873 2920 3d3d 2030 3a0a 2020 2020 2020  (s) == 0:.      
-00000a40: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00000a50: 204e 6f6e 650a 2020 2020 2020 2020 2020   None.          
-00000a60: 2020 7320 3d20 732e 6c6f 7765 7228 292e    s = s.lower().
-00000a70: 7265 706c 6163 6528 2264 222c 2022 6522  replace("d", "e"
-00000a80: 290a 2020 2020 2020 2020 2020 2020 7472  ).            tr
-00000a90: 793a 0a20 2020 2020 2020 2020 2020 2020  y:.             
-00000aa0: 2020 2072 6574 7572 6e20 666c 6f61 7428     return float(
-00000ab0: 7329 0a20 2020 2020 2020 2020 2020 2065  s).            e
-00000ac0: 7863 6570 7420 5661 6c75 6545 7272 6f72  xcept ValueError
-00000ad0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00000ae0: 2020 7320 3d20 735b 305d 202b 2073 5b31    s = s[0] + s[1
-00000af0: 3a5d 2e72 6570 6c61 6365 2822 2b22 2c20  :].replace("+", 
-00000b00: 2265 2b22 292e 7265 706c 6163 6528 222d  "e+").replace("-
-00000b10: 222c 2022 652d 2229 0a20 2020 2020 2020  ", "e-").       
-00000b20: 2020 2020 2020 2020 2074 7279 3a0a 2020           try:.  
-00000b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000b40: 2020 7265 7475 726e 2066 6c6f 6174 2873    return float(s
-00000b50: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00000b60: 2020 6578 6365 7074 2056 616c 7565 4572    except ValueEr
-00000b70: 726f 723a 0a20 2020 2020 2020 2020 2020  ror:.           
-00000b80: 2020 2020 2020 2020 2069 6620 6b65 6570           if keep
-00000b90: 5f73 7472 696e 673a 0a20 2020 2020 2020  _string:.       
-00000ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00000bb0: 2072 6574 7572 6e20 530a 2020 2020 2020   return S.      
-00000bc0: 2020 2020 2020 2020 2020 2020 2020 7265                re
-00000bd0: 7475 726e 204e 6f6e 650a 0a0a 6465 6620  turn None...def 
-00000be0: 6673 6561 7263 6828 662c 2073 293a 0a20  fsearch(f, s):. 
-00000bf0: 2020 2022 2222 0a20 2020 2053 6561 7263     """.    Searc
-00000c00: 6820 666f 7220 6120 6c69 6e65 2069 6e20  h for a line in 
-00000c10: 6120 6669 6c65 2e0a 0a20 2020 2050 6172  a file...    Par
-00000c20: 616d 6574 6572 730a 2020 2020 2d2d 2d2d  ameters.    ----
-00000c30: 2d2d 2d2d 2d2d 0a20 2020 2066 203a 2066  ------.    f : f
-00000c40: 696c 655f 6c69 6b65 0a20 2020 2020 2020  ile_like.       
-00000c50: 2046 696c 655f 6c69 6b65 206f 626a 6563   File_like objec
-00000c60: 7420 746f 2073 6561 7263 6820 696e 2e0a  t to search in..
-00000c70: 2020 2020 7320 3a20 7374 7269 6e67 0a20      s : string. 
-00000c80: 2020 2020 2020 2053 7472 696e 6720 746f         String to
-00000c90: 2073 6561 7263 6820 666f 722e 0a0a 2020   search for...  
-00000ca0: 2020 5265 7475 726e 730a 2020 2020 2d2d    Returns.    --
-00000cb0: 2d2d 2d2d 2d0a 2020 2020 6c69 6e65 203a  -----.    line :
-00000cc0: 2073 7472 696e 6720 6f72 204e 6f6e 650a   string or None.
-00000cd0: 2020 2020 2020 2020 5468 6520 6669 7273          The firs
-00000ce0: 7420 6c69 6e65 2074 6861 7420 636f 6e74  t line that cont
-00000cf0: 6169 6e73 2074 6865 2073 7472 696e 672e  ains the string.
-00000d00: 204e 6f6e 6520 6966 206e 6f74 2066 6f75   None if not fou
-00000d10: 6e64 2e0a 2020 2020 7020 3a20 696e 7465  nd..    p : inte
-00000d20: 6765 7220 6f72 204e 6f6e 650a 2020 2020  ger or None.    
-00000d30: 2020 2020 5468 6520 706f 7369 7469 6f6e      The position
-00000d40: 2077 6865 7265 2060 7360 2062 6567 696e   where `s` begin
-00000d50: 7320 696e 2060 6c69 6e65 602e 204e 6f6e  s in `line`. Non
-00000d60: 6520 6966 206e 6f74 2066 6f75 6e64 2e0a  e if not found..
-00000d70: 0a20 2020 204e 6f74 6573 0a20 2020 202d  .    Notes.    -
-00000d80: 2d2d 2d2d 0a20 2020 2054 6865 2073 6561  ----.    The sea
-00000d90: 7263 6820 6265 6769 6e73 2061 7420 7468  rch begins at th
-00000da0: 6520 6375 7272 656e 7420 6669 6c65 2070  e current file p
-00000db0: 6f73 6974 696f 6e2e 0a20 2020 2022 2222  osition..    """
-00000dc0: 0a20 2020 2066 6f72 206c 696e 6520 696e  .    for line in
-00000dd0: 2066 3a0a 2020 2020 2020 2020 7020 3d20   f:.        p = 
-00000de0: 6c69 6e65 2e66 696e 6428 7329 0a20 2020  line.find(s).   
-00000df0: 2020 2020 2069 6620 7020 3e20 2d31 3a0a       if p > -1:.
-00000e00: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00000e10: 726e 206c 696e 652c 2070 0a20 2020 2072  rn line, p.    r
-00000e20: 6574 7572 6e20 4e6f 6e65 2c20 4e6f 6e65  eturn None, None
-00000e30: 0a0a 0a40 6775 6974 6f6f 6c73 2e72 6561  ...@guitools.rea
-00000e40: 645f 7465 7874 5f66 696c 650a 6465 6620  d_text_file.def 
-00000e50: 7264 6770 7767 2866 2c20 7365 6172 6368  rdgpwg(f, search
-00000e60: 5f73 7472 696e 6773 3d4e 6f6e 6529 3a0a  _strings=None):.
-00000e70: 2020 2020 2222 220a 2020 2020 5265 6164      """.    Read
-00000e80: 2061 2047 5057 4720 7461 626c 6520 6672   a GPWG table fr
-00000e90: 6f6d 2061 204e 6173 7472 616e 2046 3036  om a Nastran F06
-00000ea0: 2066 696c 652e 0a0a 2020 2020 5061 7261   file...    Para
-00000eb0: 6d65 7465 7273 0a20 2020 202d 2d2d 2d2d  meters.    -----
-00000ec0: 2d2d 2d2d 2d0a 2020 2020 6620 3a20 7374  -----.    f : st
-00000ed0: 7269 6e67 206f 7220 6669 6c65 5f6c 696b  ring or file_lik
-00000ee0: 6520 6f72 204e 6f6e 650a 2020 2020 2020  e or None.      
-00000ef0: 2020 4569 7468 6572 2061 206e 616d 6520    Either a name 
-00000f00: 6f66 2061 2066 696c 652c 206f 7220 6973  of a file, or is
-00000f10: 2061 2066 696c 655f 6c69 6b65 206f 626a   a file_like obj
-00000f20: 6563 7420 6173 2072 6574 7572 6e65 640a  ect as returned.
-00000f30: 2020 2020 2020 2020 6279 203a 6675 6e63          by :func
-00000f40: 3a60 6f70 656e 602e 2049 6620 6669 6c65  :`open`. If file
-00000f50: 5f6c 696b 6520 6f62 6a65 6374 2c20 6974  _like object, it
-00000f60: 2069 7320 7265 776f 756e 6420 6669 7273   is rewound firs
-00000f70: 742e 2043 616e 0a20 2020 2020 2020 2061  t. Can.        a
-00000f80: 6c73 6f20 6265 2074 6865 206e 616d 6520  lso be the name 
-00000f90: 6f66 2061 2064 6972 6563 746f 7279 206f  of a directory o
-00000fa0: 7220 4e6f 6e65 3b20 696e 2074 6865 7365  r None; in these
-00000fb0: 2063 6173 6573 2c20 6120 4755 490a 2020   cases, a GUI.  
-00000fc0: 2020 2020 2020 6973 206f 7065 6e65 6420        is opened 
-00000fd0: 666f 7220 6669 6c65 2073 656c 6563 7469  for file selecti
-00000fe0: 6f6e 2e0a 2020 2020 7365 6172 6368 5f73  on..    search_s
-00000ff0: 7472 696e 6773 203a 204e 6f6e 652c 2073  trings : None, s
-00001000: 7472 696e 672c 206f 7220 6c69 7374 5f6c  tring, or list_l
-00001010: 696b 6520 6f66 2073 7472 696e 6773 0a20  ike of strings. 
-00001020: 2020 2020 2020 2049 6620 6120 7374 7269         If a stri
-00001030: 6e67 2c20 7468 6973 2072 6f75 7469 6e65  ng, this routine
-00001040: 2077 696c 6c20 7363 616e 2074 6865 2066   will scan the f
-00001050: 696c 6520 756e 7469 6c20 7468 6520 7374  ile until the st
-00001060: 7269 6e67 0a20 2020 2020 2020 2069 7320  ring.        is 
-00001070: 666f 756e 6420 6265 666f 7265 2072 6561  found before rea
-00001080: 6469 6e67 2074 6865 2047 5057 4720 7461  ding the GPWG ta
-00001090: 626c 652e 2049 6620 6d75 6c74 6970 6c65  ble. If multiple
-000010a0: 2073 7472 696e 6773 2069 6e0a 2020 2020   strings in.    
-000010b0: 2020 2020 6120 6c69 7374 206f 7220 7475      a list or tu
-000010c0: 706c 652c 2074 6865 2072 6f75 7469 6e65  ple, the routine
-000010d0: 2077 696c 6c20 7363 616e 2066 6f72 2065   will scan for e
-000010e0: 6163 6820 7374 7269 6e67 2c20 696e 2074  ach string, in t
-000010f0: 6865 0a20 2020 2020 2020 206f 7264 6572  he.        order
-00001100: 2070 726f 7669 6465 642c 2062 6566 6f72   provided, befor
-00001110: 6520 7265 6164 696e 6720 7468 6520 4750  e reading the GP
-00001120: 5747 2074 6162 6c65 2e20 4966 204e 6f6e  WG table. If Non
-00001130: 652c 2074 6865 0a20 2020 2020 2020 2066  e, the.        f
-00001140: 6972 7374 2047 5057 4720 7461 626c 6520  irst GPWG table 
-00001150: 6973 2072 6561 642e 0a0a 2020 2020 5265  is read...    Re
-00001160: 7475 726e 730a 2020 2020 2d2d 2d2d 2d2d  turns.    ------
-00001170: 2d0a 2020 2020 6d61 7373 203a 2032 6420  -.    mass : 2d 
-00001180: 6e64 6172 7261 790a 2020 2020 2020 2020  ndarray.        
-00001190: 5468 6520 3678 3620 6d61 7373 2028 6f72  The 6x6 mass (or
-000011a0: 2077 6569 6768 7429 206d 6174 7269 782e   weight) matrix.
-000011b0: 0a20 2020 2063 6720 3a20 3264 206e 6461  .    cg : 2d nda
-000011c0: 7272 6179 0a20 2020 2020 2020 2054 6865  rray.        The
-000011d0: 2033 7834 2063 656e 7465 722d 6f66 2d67   3x4 center-of-g
-000011e0: 7261 7669 7479 2074 6162 6c65 3a3a 0a0a  ravity table::..
-000011f0: 2020 2020 2020 2020 2020 2020 5b20 6d61              [ ma
-00001200: 7373 2878 2c20 792c 207a 2920 782d 6367  ss(x, y, z) x-cg
-00001210: 2079 2d63 6720 7a2d 6367 205d 0a0a 2020   y-cg z-cg ]..  
-00001220: 2020 7265 6670 7420 3a20 696e 7465 6765    refpt : intege
-00001230: 720a 2020 2020 2020 2020 5468 6520 7265  r.        The re
-00001240: 6665 7265 6e63 6520 706f 696e 7420 6c69  ference point li
-00001250: 7374 6564 206a 7573 7420 6265 666f 7265  sted just before
-00001260: 2074 6865 206d 6173 7320 6d61 7472 6978   the mass matrix
-00001270: 2069 6e20 7468 650a 2020 2020 2020 2020   in the.        
-00001280: 4630 3620 6669 6c65 2e0a 2020 2020 4973  F06 file..    Is
-00001290: 203a 2032 6420 6e64 6172 7261 790a 2020   : 2d ndarray.  
-000012a0: 2020 2020 2020 5468 6520 4928 5329 206d        The I(S) m
-000012b0: 6174 7269 782e 2054 6869 7320 6973 2074  atrix. This is t
-000012c0: 6865 2033 2078 2033 206d 6173 7320 6d6f  he 3 x 3 mass mo
-000012d0: 6d65 6e74 206f 6620 696e 6572 7469 610a  ment of inertia.
-000012e0: 2020 2020 2020 2020 7061 7274 6974 696f          partitio
-000012f0: 6e20 7769 7468 2072 6573 7065 6374 2074  n with respect t
-00001300: 6f20 7468 6520 6365 6e74 6572 206f 6620  o the center of 
-00001310: 6772 6176 6974 7920 7265 6665 7272 6564  gravity referred
-00001320: 2074 6f0a 2020 2020 2020 2020 7468 6520   to.        the 
-00001330: 7072 696e 6369 7061 6c20 6d61 7373 2061  principal mass a
-00001340: 7865 7320 2874 6865 2053 2073 7973 7465  xes (the S syste
-00001350: 6d29 2e20 5468 6973 2069 7320 6e6f 740a  m). This is not.
-00001360: 2020 2020 2020 2020 6e65 6365 7373 6172          necessar
-00001370: 696c 7920 6120 6469 6167 6f6e 616c 206d  ily a diagonal m
-00001380: 6174 7269 7820 6265 6361 7573 6520 7468  atrix because th
-00001390: 6520 6465 7465 726d 696e 6174 696f 6e20  e determination 
-000013a0: 6f66 2074 6865 0a20 2020 2020 2020 2053  of the.        S
-000013b0: 2073 7973 7465 6d20 646f 6573 206e 6f74   system does not
-000013c0: 2069 6e76 6f6c 7665 2073 6563 6f6e 6420   involve second 
-000013d0: 6d6f 6d65 6e74 732e 2054 6865 2076 616c  moments. The val
-000013e0: 7565 7320 6f66 0a20 2020 2020 2020 2069  ues of.        i
-000013f0: 6e65 7274 6961 7320 6174 2074 6865 2063  nertias at the c
-00001400: 656e 7465 7220 6f66 2067 7261 7669 7479  enter of gravity
-00001410: 2061 7265 2066 6f75 6e64 2066 726f 6d20   are found from 
-00001420: 7468 6520 7661 6c75 6573 2061 740a 2020  the values at.  
-00001430: 2020 2020 2020 7468 6520 7265 6665 7265        the refere
-00001440: 6e63 6520 706f 696e 7420 656d 706c 6f79  nce point employ
-00001450: 696e 6720 7468 6520 7061 7261 6c6c 656c  ing the parallel
-00001460: 2061 7869 7320 7275 6c65 2e0a 0a20 2020   axis rule...   
-00001470: 204e 6f74 6573 0a20 2020 202d 2d2d 2d2d   Notes.    -----
-00001480: 0a20 2020 2054 6865 2072 6f75 7469 6e65  .    The routine
-00001490: 2077 696c 6c20 6c6f 6164 2074 6865 2066   will load the f
-000014a0: 6972 7374 2047 5057 4720 7461 626c 6520  irst GPWG table 
-000014b0: 6974 2066 696e 6473 2061 6674 6572 0a20  it finds after. 
-000014c0: 2020 2073 6561 7263 6869 6e67 2066 6f72     searching for
-000014d0: 2065 6163 6820 7374 7269 6e67 2069 6e20   each string in 
-000014e0: 6073 6561 7263 685f 7374 7269 6e67 7360  `search_strings`
-000014f0: 2c20 6966 2070 726f 7669 6465 642e 2041  , if provided. A
-00001500: 6674 6572 0a20 2020 2073 6561 7263 6869  fter.    searchi
-00001510: 6e67 2066 6f72 2074 6865 7365 2073 7472  ng for these str
-00001520: 696e 6773 2c20 7468 6520 726f 7574 696e  ings, the routin
-00001530: 6520 7769 6c6c 2073 6561 7263 6820 666f  e will search fo
-00001540: 7220 7468 6520 6e65 7874 0a20 2020 2022  r the next.    "
-00001550: 5720 4520 4920 4720 4820 5422 2073 7472  W E I G H T" str
-00001560: 696e 672e 0a0a 2020 2020 416c 6c20 6f75  ing...    All ou
-00001570: 7470 7574 7320 7769 6c6c 2062 6520 7365  tputs will be se
-00001580: 7420 746f 204e 6f6e 6520 6966 206e 6f20  t to None if no 
-00001590: 4750 5747 2074 6162 6c65 2069 7320 666f  GPWG table is fo
-000015a0: 756e 6420 6f72 2069 6620 610a 2020 2020  und or if a.    
-000015b0: 7365 6172 6368 2073 7472 696e 6720 6973  search string is
-000015c0: 206e 6f74 2066 6f75 6e64 2e0a 0a20 2020   not found...   
-000015d0: 2045 7861 6d70 6c65 2075 7361 6765 3a3a   Example usage::
-000015e0: 0a0a 2020 2020 2020 2020 6672 6f6d 2070  ..        from p
-000015f0: 7979 6574 6920 696d 706f 7274 206e 6173  yyeti import nas
-00001600: 7472 616e 0a20 2020 2020 2020 2073 7472  tran.        str
-00001610: 3120 3d20 2720 2020 2020 2020 2020 2020  1 = '           
-00001620: 5355 5045 5245 4c45 4d45 4e54 2031 3030  SUPERELEMENT 100
-00001630: 270a 2020 2020 2020 2020 7374 7232 203d  '.        str2 =
-00001640: 2027 5e5e 5e46 2d53 4554 204d 4153 5320   '^^^F-SET MASS 
-00001650: 5441 424c 4527 0a20 2020 2020 2020 206d  TABLE'.        m
-00001660: 6173 732c 2063 672c 2072 6566 2c20 4920  ass, cg, ref, I 
-00001670: 3d20 6e61 7374 7261 6e2e 7264 6770 7767  = nastran.rdgpwg
-00001680: 2827 6d6f 6465 732e 6630 3627 2c20 2873  ('modes.f06', (s
-00001690: 7472 312c 2073 7472 3229 290a 2020 2020  tr1, str2)).    
-000016a0: 2222 220a 2020 2020 662e 7365 656b 2830  """.    f.seek(0
-000016b0: 2c20 3029 0a20 2020 2064 6566 6175 6c74  , 0).    default
-000016c0: 203d 204e 6f6e 652c 204e 6f6e 652c 204e   = None, None, N
-000016d0: 6f6e 652c 204e 6f6e 650a 2020 2020 6966  one, None.    if
-000016e0: 2073 6561 7263 685f 7374 7269 6e67 7320   search_strings 
-000016f0: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
-00001700: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
-00001710: 6365 2873 6561 7263 685f 7374 7269 6e67  ce(search_string
-00001720: 732c 2073 7472 293a 0a20 2020 2020 2020  s, str):.       
-00001730: 2020 2020 2073 6561 7263 685f 7374 7269       search_stri
-00001740: 6e67 7320 3d20 2873 6561 7263 685f 7374  ngs = (search_st
-00001750: 7269 6e67 732c 290a 2020 2020 2020 2020  rings,).        
-00001760: 666f 7220 7320 696e 2073 6561 7263 685f  for s in search_
-00001770: 7374 7269 6e67 733a 0a20 2020 2020 2020  strings:.       
-00001780: 2020 2020 2066 6f72 206c 696e 6520 696e       for line in
-00001790: 2066 3a0a 2020 2020 2020 2020 2020 2020   f:.            
-000017a0: 2020 2020 6966 206c 696e 652e 6669 6e64      if line.find
-000017b0: 2873 2920 3e20 2d31 3a0a 2020 2020 2020  (s) > -1:.      
-000017c0: 2020 2020 2020 2020 2020 2020 2020 6272                br
-000017d0: 6561 6b0a 2020 2020 2020 2020 2020 2020  eak.            
-000017e0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-000017f0: 2020 2020 2020 7265 7475 726e 2064 6566        return def
-00001800: 6175 6c74 0a0a 2020 2020 6c69 6e65 2c20  ault..    line, 
-00001810: 7020 3d20 6673 6561 7263 6828 662c 2022  p = fsearch(f, "
-00001820: 5720 4520 4920 4720 4820 5422 290a 2020  W E I G H T").  
-00001830: 2020 6966 206c 696e 6520 6973 204e 6f6e    if line is Non
-00001840: 653a 0a20 2020 2020 2020 2072 6574 7572  e:.        retur
-00001850: 6e20 6465 6661 756c 740a 2020 2020 6c69  n default.    li
-00001860: 6e65 2c20 7020 3d20 6673 6561 7263 6828  ne, p = fsearch(
-00001870: 662c 2022 5245 4645 5245 4e43 4520 504f  f, "REFERENCE PO
-00001880: 494e 5420 3d22 290a 2020 2020 7265 6670  INT =").    refp
-00001890: 7420 3d20 696e 7428 6c69 6e65 5b70 202b  t = int(line[p +
-000018a0: 2031 3720 3a5d 290a 0a20 2020 2066 2e72   17 :])..    f.r
-000018b0: 6561 646c 696e 6528 290a 2020 2020 6d61  eadline().    ma
-000018c0: 7373 203d 205b 5d0a 2020 2020 666f 7220  ss = [].    for 
-000018d0: 5f20 696e 2072 616e 6765 2836 293a 0a20  _ in range(6):. 
-000018e0: 2020 2020 2020 206c 696e 6520 3d20 662e         line = f.
-000018f0: 7265 6164 6c69 6e65 2829 2e73 7472 6970  readline().strip
-00001900: 2829 0a20 2020 2020 2020 206d 6173 732e  ().        mass.
-00001910: 6170 7065 6e64 285b 666c 6f61 7428 6974  append([float(it
-00001920: 656d 2920 666f 7220 6974 656d 2069 6e20  em) for item in 
-00001930: 6c69 6e65 5b31 3a2d 315d 2e73 706c 6974  line[1:-1].split
-00001940: 2829 5d29 0a20 2020 206d 6173 7320 3d20  ()]).    mass = 
-00001950: 6e70 2e61 7272 6179 286d 6173 7329 0a20  np.array(mass). 
-00001960: 2020 206c 696e 652c 2070 203d 2066 7365     line, p = fse
-00001970: 6172 6368 2866 2c20 224d 4153 5320 4158  arch(f, "MASS AX
-00001980: 4953 2053 5953 5445 4d22 290a 0a20 2020  IS SYSTEM")..   
-00001990: 2063 6720 3d20 5b5d 0a20 2020 2066 6f72   cg = [].    for
-000019a0: 205f 2069 6e20 7261 6e67 6528 3329 3a0a   _ in range(3):.
-000019b0: 2020 2020 2020 2020 6c69 6e65 203d 2066          line = f
-000019c0: 2e72 6561 646c 696e 6528 292e 7374 7269  .readline().stri
-000019d0: 7028 290a 2020 2020 2020 2020 6367 2e61  p().        cg.a
-000019e0: 7070 656e 6428 5b66 6c6f 6174 2869 7465  ppend([float(ite
-000019f0: 6d29 2066 6f72 2069 7465 6d20 696e 206c  m) for item in l
-00001a00: 696e 655b 313a 5d2e 7370 6c69 7428 295d  ine[1:].split()]
-00001a10: 290a 2020 2020 6367 203d 206e 702e 6172  ).    cg = np.ar
-00001a20: 7261 7928 6367 290a 0a20 2020 2066 2e72  ray(cg)..    f.r
-00001a30: 6561 646c 696e 6528 290a 2020 2020 4973  eadline().    Is
-00001a40: 203d 205b 5d0a 2020 2020 666f 7220 5f20   = [].    for _ 
-00001a50: 696e 2072 616e 6765 2833 293a 0a20 2020  in range(3):.   
-00001a60: 2020 2020 206c 696e 6520 3d20 662e 7265       line = f.re
-00001a70: 6164 6c69 6e65 2829 2e73 7472 6970 2829  adline().strip()
-00001a80: 0a20 2020 2020 2020 2049 732e 6170 7065  .        Is.appe
-00001a90: 6e64 285b 666c 6f61 7428 6974 656d 2920  nd([float(item) 
-00001aa0: 666f 7220 6974 656d 2069 6e20 6c69 6e65  for item in line
-00001ab0: 5b31 3a2d 315d 2e73 706c 6974 2829 5d29  [1:-1].split()])
-00001ac0: 0a20 2020 2049 7320 3d20 6e70 2e61 7272  .    Is = np.arr
-00001ad0: 6179 2849 7329 0a20 2020 2072 6574 7572  ay(Is).    retur
-00001ae0: 6e20 6d61 7373 2c20 6367 2c20 7265 6670  n mass, cg, refp
-00001af0: 742c 2049 730a 0a0a 2320 6465 6620 5f72  t, Is...# def _r
-00001b00: 6561 646c 696e 655f 6b65 6570 5f63 6f6d  eadline_keep_com
-00001b10: 6d65 6e74 7328 6974 2c20 5661 6c73 293a  ments(it, Vals):
-00001b20: 0a23 2020 2020 2074 7279 3a0a 2320 2020  .#     try:.#   
-00001b30: 2020 2020 2020 7320 3d20 6e65 7874 2869        s = next(i
-00001b40: 7429 0a23 2020 2020 2020 2020 2077 6869  t).#         whi
-00001b50: 6c65 206c 656e 2873 2920 3e20 3020 616e  le len(s) > 0 an
-00001b60: 6420 735b 305d 203d 3d20 2224 223a 0a23  d s[0] == "$":.#
-00001b70: 2020 2020 2020 2020 2020 2020 2056 616c               Val
-00001b80: 732e 6170 7065 6e64 2873 290a 2320 2020  s.append(s).#   
-00001b90: 2020 2020 2020 2020 2020 7320 3d20 6e65            s = ne
-00001ba0: 7874 2869 7429 0a23 2020 2020 2020 2020  xt(it).#        
-00001bb0: 2072 6574 7572 6e20 730a 2320 2020 2020   return s.#     
-00001bc0: 6578 6365 7074 2053 746f 7049 7465 7261  except StopItera
-00001bd0: 7469 6f6e 3a0a 2320 2020 2020 2020 2020  tion:.#         
-00001be0: 7265 7475 726e 204e 6f6e 650a 230a 230a  return None.#.#.
-00001bf0: 2320 6465 6620 5f72 6561 646c 696e 655f  # def _readline_
-00001c00: 736b 6970 5f63 6f6d 6d65 6e74 7328 6974  skip_comments(it
-00001c10: 2c20 5661 6c73 293a 0a23 2020 2020 2074  , Vals):.#     t
-00001c20: 7279 3a0a 2320 2020 2020 2020 2020 7320  ry:.#         s 
-00001c30: 3d20 6e65 7874 2869 7429 0a23 2020 2020  = next(it).#    
-00001c40: 2020 2020 2077 6869 6c65 206c 656e 2873       while len(s
-00001c50: 2920 3e20 3020 616e 6420 735b 305d 203d  ) > 0 and s[0] =
-00001c60: 3d20 2224 223a 0a23 2020 2020 2020 2020  = "$":.#        
-00001c70: 2020 2020 2073 203d 206e 6578 7428 6974       s = next(it
-00001c80: 290a 2320 2020 2020 2020 2020 7265 7475  ).#         retu
-00001c90: 726e 2073 0a23 2020 2020 2065 7863 6570  rn s.#     excep
-00001ca0: 7420 5374 6f70 4974 6572 6174 696f 6e3a  t StopIteration:
-00001cb0: 0a23 2020 2020 2020 2020 2072 6574 7572  .#         retur
-00001cc0: 6e20 4e6f 6e65 0a23 0a23 0a23 2064 6566  n None.#.#.# def
-00001cd0: 205f 6765 745f 6c69 6e65 2866 6974 6572   _get_line(fiter
-00001ce0: 2c20 5f72 6561 646c 696e 652c 2056 616c  , _readline, Val
-00001cf0: 732c 2073 3d4e 6f6e 652c 2074 7269 6d3d  s, s=None, trim=
-00001d00: 5472 7565 293a 0a23 2020 2020 2069 6620  True):.#     if 
-00001d10: 7320 6973 204e 6f6e 653a 0a23 2020 2020  s is None:.#    
-00001d20: 2020 2020 2073 203d 205f 7265 6164 6c69       s = _readli
-00001d30: 6e65 2866 6974 6572 2c20 5661 6c73 290a  ne(fiter, Vals).
-00001d40: 2320 2020 2020 2020 2020 6966 2073 2069  #         if s i
-00001d50: 7320 4e6f 6e65 3a0a 2320 2020 2020 2020  s None:.#       
-00001d60: 2020 2020 2020 7265 7475 726e 204e 6f6e        return Non
-00001d70: 650a 2320 2020 2020 7320 3d20 732e 6578  e.#     s = s.ex
-00001d80: 7061 6e64 7461 6273 2829 0a23 2020 2020  pandtabs().#    
-00001d90: 2069 6620 7472 696d 3a0a 2320 2020 2020   if trim:.#     
-00001da0: 2020 2020 7320 3d20 735b 3a37 325d 0a23      s = s[:72].#
-00001db0: 2020 2020 2070 203d 2073 2e66 696e 6428       p = s.find(
-00001dc0: 2224 2229 0a23 2020 2020 2069 6620 7020  "$").#     if p 
-00001dd0: 3e20 2d31 3a0a 2320 2020 2020 2020 2020  > -1:.#         
-00001de0: 7320 3d20 735b 3a70 5d0a 2320 2020 2020  s = s[:p].#     
-00001df0: 7320 3d20 732e 7273 7472 6970 2829 0a23  s = s.rstrip().#
-00001e00: 2020 2020 2072 6574 7572 6e20 730a 0a0a       return s...
-00001e10: 6465 6620 5f70 726f 635f 6c69 6e65 2873  def _proc_line(s
-00001e20: 293a 0a20 2020 2070 203d 2073 2e66 696e  ):.    p = s.fin
-00001e30: 6428 2224 2229 0a20 2020 2069 6620 7020  d("$").    if p 
-00001e40: 3e20 2d31 3a0a 2020 2020 2020 2020 7320  > -1:.        s 
-00001e50: 3d20 735b 3a70 5d0a 2020 2020 7265 7475  = s[:p].    retu
-00001e60: 726e 2073 2e72 7374 7269 7028 290a 0a0a  rn s.rstrip()...
-00001e70: 6465 6620 5f68 616e 646c 655f 636f 6d6d  def _handle_comm
-00001e80: 656e 7473 2863 6f6d 6d65 6e74 5f6c 6973  ents(comment_lis
-00001e90: 742c 2056 616c 7329 3a0a 2020 2020 6966  t, Vals):.    if
-00001ea0: 2063 6f6d 6d65 6e74 5f6c 6973 743a 0a20   comment_list:. 
-00001eb0: 2020 2020 2020 2023 2069 6620 7468 6572         # if ther
-00001ec0: 6520 7765 7265 2063 6f6d 6d65 6e74 7320  e were comments 
-00001ed0: 7265 6164 2069 6e2c 2073 746f 7265 2074  read in, store t
-00001ee0: 6865 6d0a 2020 2020 2020 2020 2320 616e  hem.        # an
-00001ef0: 6420 636c 6561 7220 6361 6368 653a 0a20  d clear cache:. 
-00001f00: 2020 2020 2020 2056 616c 732e 6578 7465         Vals.exte
-00001f10: 6e64 2863 6f6d 6d65 6e74 5f6c 6973 7429  nd(comment_list)
-00001f20: 0a20 2020 2020 2020 2063 6f6d 6d65 6e74  .        comment
-00001f30: 5f6c 6973 742e 636c 6561 7228 290a 0a0a  _list.clear()...
-00001f40: 6465 6620 5f6e 6578 745f 6c69 6e65 2866  def _next_line(f
-00001f50: 2c20 6e61 6d65 2c20 7265 6765 782c 206b  , name, regex, k
-00001f60: 6565 705f 636f 6d6d 656e 7473 2c20 5661  eep_comments, Va
-00001f70: 6c73 293a 0a20 2020 2069 6620 7265 6765  ls):.    if rege
-00001f80: 783a 0a20 2020 2020 2020 2070 726f 6720  x:.        prog 
-00001f90: 3d20 7265 2e63 6f6d 7069 6c65 286e 616d  = re.compile(nam
-00001fa0: 652c 2072 652e 4947 4e4f 5245 4341 5345  e, re.IGNORECASE
-00001fb0: 290a 0a20 2020 2020 2020 2064 6566 2069  )..        def i
-00001fc0: 736d 6174 6368 286c 696e 652c 2070 726f  smatch(line, pro
-00001fd0: 6729 3a0a 2020 2020 2020 2020 2020 2020  g):.            
-00001fe0: 7265 7475 726e 2070 726f 672e 6d61 7463  return prog.matc
-00001ff0: 6828 6c69 6e65 290a 0a20 2020 2065 6c73  h(line)..    els
-00002000: 653a 0a20 2020 2020 2020 2070 726f 6720  e:.        prog 
-00002010: 3d20 6e61 6d65 2e6c 6f77 6572 2829 0a0a  = name.lower()..
-00002020: 2020 2020 2020 2020 6465 6620 6973 6d61          def isma
-00002030: 7463 6828 6c69 6e65 2c20 7072 6f67 293a  tch(line, prog):
-00002040: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00002050: 7572 6e20 6c69 6e65 2e6c 6f77 6572 2829  urn line.lower()
-00002060: 2e66 696e 6428 7072 6f67 2920 3d3d 2030  .find(prog) == 0
-00002070: 0a0a 2020 2020 646f 5f6d 6174 6368 203d  ..    do_match =
-00002080: 2054 7275 650a 2020 2020 6966 206e 6f74   True.    if not
-00002090: 206b 6565 705f 636f 6d6d 656e 7473 3a0a   keep_comments:.
-000020a0: 2020 2020 2020 2020 666f 7220 6c69 6e65          for line
-000020b0: 2069 6e20 663a 0a20 2020 2020 2020 2020   in f:.         
-000020c0: 2020 206c 696e 6520 3d20 6c69 6e65 2e65     line = line.e
-000020d0: 7870 616e 6474 6162 7328 290a 2020 2020  xpandtabs().    
-000020e0: 2020 2020 2020 2020 6966 2064 6f5f 6d61          if do_ma
-000020f0: 7463 683a 0a20 2020 2020 2020 2020 2020  tch:.           
-00002100: 2020 2020 2069 6620 6973 6d61 7463 6828       if ismatch(
-00002110: 6c69 6e65 2c20 7072 6f67 293a 0a20 2020  line, prog):.   
-00002120: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002130: 2023 2066 6f75 6e64 2074 6865 2073 7461   # found the sta
-00002140: 7274 206f 6620 6120 6d61 7463 6869 6e67  rt of a matching
-00002150: 2063 6172 642c 2079 6965 6c64 206c 696e   card, yield lin
-00002160: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
-00002170: 2020 2020 2020 646f 5f6d 6174 6368 203d        do_match =
-00002180: 2079 6965 6c64 206c 696e 650a 2020 2020   yield line.    
-00002190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000021a0: 2320 6966 2063 6172 6420 636f 6e74 696e  # if card contin
-000021b0: 7565 7320 6f6e 206d 756c 7469 706c 6520  ues on multiple 
-000021c0: 6c69 6e65 732c 2064 6f5f 6d61 7463 680a  lines, do_match.
-000021d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000021e0: 2020 2020 2320 7769 6c6c 2062 6520 7365      # will be se
-000021f0: 7420 746f 2046 616c 7365 0a20 2020 2020  t to False.     
-00002200: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00002210: 2020 2020 2020 2020 2020 2020 2023 2064               # d
-00002220: 6f5f 6d61 7463 6820 6973 2046 616c 7365  o_match is False
-00002230: 2028 6d65 616e 696e 6720 7265 6164 696e   (meaning readin
-00002240: 6720 636f 6e74 696e 7561 7469 6f6e 0a20  g continuation. 
-00002250: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-00002260: 206c 696e 6573 292c 2073 6f20 6765 7420   lines), so get 
-00002270: 6e65 7874 206c 696e 6520 6e6f 206d 6174  next line no mat
-00002280: 7465 7220 7768 6174 2069 7420 6973 3a0a  ter what it is:.
-00002290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000022a0: 646f 5f6d 6174 6368 203d 2079 6965 6c64  do_match = yield
-000022b0: 206c 696e 650a 2020 2020 2020 2020 2020   line.          
-000022c0: 2020 2020 2020 2320 6966 2064 6f5f 6d61        # if do_ma
-000022d0: 7463 6820 6973 206e 6f77 2054 7275 652c  tch is now True,
-000022e0: 2074 6865 206c 6173 7420 6c69 6e65 2072   the last line r
-000022f0: 6561 6420 6973 2074 6865 0a20 2020 2020  ead is the.     
-00002300: 2020 2020 2020 2020 2020 2023 206e 6578             # nex
-00002310: 7420 6c69 6e65 2074 6861 7420 6e65 6564  t line that need
-00002320: 7320 746f 2062 6520 6578 616d 696e 6564  s to be examined
-00002330: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00002340: 2020 6966 2064 6f5f 6d61 7463 683a 0a20    if do_match:. 
+000003d0: 2020 2277 746d 7063 222c 0a20 2020 2022    "wtmpc",.    "
+000003e0: 7774 7370 6f69 6e74 7322 2c0a 2020 2020  wtspoints",.    
+000003f0: 2277 7473 7063 3122 2c0a 2020 2020 2277  "wtspc1",.    "w
+00000400: 7478 7365 7431 222c 0a20 2020 2022 7774  txset1",.    "wt
+00000410: 7163 7365 7422 2c0a 2020 2020 2277 7472  qcset",.    "wtr
+00000420: 6265 3222 2c0a 2020 2020 2277 7472 6265  be2",.    "wtrbe
+00000430: 3322 2c0a 2020 2020 2277 7473 6573 6574  3",.    "wtseset
+00000440: 222c 0a20 2020 2022 7774 7365 7422 2c0a  ",.    "wtset",.
+00000450: 2020 2020 2277 7472 7370 6c69 6e65 222c      "wtrspline",
+00000460: 0a20 2020 2022 7774 7273 706c 696e 655f  .    "wtrspline_
+00000470: 7269 6e67 7322 2c0a 2020 2020 2277 7463  rings",.    "wtc
+00000480: 6f6f 7264 6361 7264 7322 2c0a 2020 2020  oordcards",.    
+00000490: 2277 7465 7874 726e 222c 0a20 2020 2022  "wtextrn",.    "
+000004a0: 7774 6578 7473 656f 7574 222c 0a20 2020  wtextseout",.   
+000004b0: 2022 6d6b 6e61 7374 222c 0a20 2020 2022   "mknast",.    "
+000004c0: 7264 6474 6970 6368 222c 0a5d 0a0a 0a64  rddtipch",.]...d
+000004d0: 6566 206e 6173 5f73 7363 616e 6628 732c  ef nas_sscanf(s,
+000004e0: 206b 6565 705f 7374 7269 6e67 3d46 616c   keep_string=Fal
+000004f0: 7365 293a 0a20 2020 2022 2222 0a20 2020  se):.    """.   
+00000500: 2052 6561 6420 6120 7369 6e67 6c65 2069   Read a single i
+00000510: 6e74 6567 6572 206f 7220 4e61 7374 7261  nteger or Nastra
+00000520: 6e2d 666f 726d 6174 7465 6420 666c 6f61  n-formatted floa
+00000530: 7469 6e67 2070 6f69 6e74 206e 756d 6265  ting point numbe
+00000540: 720a 0a20 2020 2050 6172 616d 6574 6572  r..    Parameter
+00000550: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  s.    ----------
+00000560: 0a20 2020 2073 203a 2073 7472 696e 670a  .    s : string.
+00000570: 2020 2020 2020 2020 4d61 7920 6265 2066          May be f
+00000580: 6f72 6d61 7474 6564 2069 6e20 7468 6520  ormatted in the 
+00000590: 4e41 5354 5241 4e20 7368 6f72 7463 7574  NASTRAN shortcut
+000005a0: 2077 6179 3b20 6567 2c20 2731 2e37 2d34   way; eg, '1.7-4
+000005b0: 270a 2020 2020 2020 2020 696e 7374 6561  '.        instea
+000005c0: 6420 6f66 2027 312e 3765 2d34 272e 204d  d of '1.7e-4'. M
+000005d0: 6179 2061 6c73 6f20 7573 6520 2764 2720  ay also use 'd' 
+000005e0: 696e 7374 6561 6420 6f66 2027 6527 2e0a  instead of 'e'..
+000005f0: 2020 2020 6b65 6570 5f73 7472 696e 6720      keep_string 
+00000600: 3a20 626f 6f6c 3b20 6f70 7469 6f6e 616c  : bool; optional
+00000610: 0a20 2020 2020 2020 204f 6e6c 7920 7573  .        Only us
+00000620: 6564 2069 6620 6073 6020 6973 2061 2073  ed if `s` is a s
+00000630: 7472 696e 6720 7468 6174 2063 616e 6e6f  tring that canno
+00000640: 7420 6265 2069 6e74 6572 7072 6574 6564  t be interpreted
+00000650: 2061 7320 610a 2020 2020 2020 2020 6e75   as a.        nu
+00000660: 6d62 6572 2e20 496e 2074 6861 7420 6361  mber. In that ca
+00000670: 7365 2c20 6966 2060 6b65 6570 5f73 7472  se, if `keep_str
+00000680: 696e 6760 2069 7320 5472 7565 2c20 6060  ing` is True, ``
+00000690: 732e 7374 7269 7028 2960 600a 2020 2020  s.strip()``.    
+000006a0: 2020 2020 6973 2072 6574 7572 6e65 643b      is returned;
+000006b0: 206f 7468 6572 7769 7365 2c20 6966 2060   otherwise, if `
+000006c0: 6b65 6570 5f73 7472 696e 6760 2069 7320  keep_string` is 
+000006d0: 4661 6c73 652c 204e 6f6e 6520 6973 0a20  False, None is. 
+000006e0: 2020 2020 2020 2072 6574 7572 6e65 642e         returned.
+000006f0: 0a0a 2020 2020 5265 7475 726e 730a 2020  ..    Returns.  
+00000700: 2020 2d2d 2d2d 2d2d 2d0a 2020 2020 7620    -------.    v 
+00000710: 3a20 696e 7420 6f72 2066 6c6f 6174 206f  : int or float o
+00000720: 7220 7374 7269 6e67 206f 7220 4e6f 6e65  r string or None
+00000730: 0a20 2020 2020 2020 2054 6865 2073 6361  .        The sca
+00000740: 6c61 7220 7661 6c75 6520 7468 6174 2074  lar value that t
+00000750: 6865 2073 7472 696e 6720 7265 7072 6573  he string repres
+00000760: 656e 7473 2e20 4966 2073 7472 696e 6720  ents. If string 
+00000770: 6973 0a20 2020 2020 2020 2065 6d70 7479  is.        empty
+00000780: 2c20 7265 7475 726e 7320 4e6f 6e65 2e20  , returns None. 
+00000790: 4966 2060 6b65 6570 5f73 7472 696e 6760  If `keep_string`
+000007a0: 2069 7320 5472 7565 2c20 6076 6020 7769   is True, `v` wi
+000007b0: 6c6c 2062 650a 2020 2020 2020 2020 6060  ll be.        ``
+000007c0: 732e 7374 7269 7028 2960 6020 7768 656e  s.strip()`` when
+000007d0: 2060 7360 2063 616e 6e6f 7420 6265 2063   `s` cannot be c
+000007e0: 6f6e 7665 7274 6564 2074 6f20 6120 6e75  onverted to a nu
+000007f0: 6d62 6572 2e0a 0a20 2020 2045 7861 6d70  mber...    Examp
+00000800: 6c65 730a 2020 2020 2d2d 2d2d 2d2d 2d2d  les.    --------
+00000810: 0a20 2020 203e 3e3e 2066 726f 6d20 7079  .    >>> from py
+00000820: 7965 7469 2069 6d70 6f72 7420 6e61 7374  yeti import nast
+00000830: 7261 6e0a 2020 2020 3e3e 3e20 6e61 7374  ran.    >>> nast
+00000840: 7261 6e2e 6e61 735f 7373 6361 6e66 2827  ran.nas_sscanf('
+00000850: 2031 3027 290a 2020 2020 3130 0a20 2020   10').    10.   
+00000860: 203e 3e3e 206e 6173 7472 616e 2e6e 6173   >>> nastran.nas
+00000870: 5f73 7363 616e 6628 2731 2e37 652d 3427  _sscanf('1.7e-4'
+00000880: 290a 2020 2020 302e 3030 3031 370a 2020  ).    0.00017.  
+00000890: 2020 3e3e 3e20 6e61 7374 7261 6e2e 6e61    >>> nastran.na
+000008a0: 735f 7373 6361 6e66 2827 312e 372d 3427  s_sscanf('1.7-4'
+000008b0: 290a 2020 2020 302e 3030 3031 370a 2020  ).    0.00017.  
+000008c0: 2020 3e3e 3e20 6e61 7374 7261 6e2e 6e61    >>> nastran.na
+000008d0: 735f 7373 6361 6e66 2827 312e 3764 3427  s_sscanf('1.7d4'
+000008e0: 290a 2020 2020 3137 3030 302e 300a 2020  ).    17000.0.  
+000008f0: 2020 3e3e 3e20 7072 696e 7428 6e61 7374    >>> print(nast
+00000900: 7261 6e2e 6e61 735f 7373 6361 6e66 2827  ran.nas_sscanf('
+00000910: 2027 2929 0a20 2020 204e 6f6e 650a 2020   ')).    None.  
+00000920: 2020 3e3e 3e20 7072 696e 7428 6e61 7374    >>> print(nast
+00000930: 7261 6e2e 6e61 735f 7373 6361 6e66 2827  ran.nas_sscanf('
+00000940: 7374 7269 6e67 2729 290a 2020 2020 4e6f  string')).    No
+00000950: 6e65 0a20 2020 203e 3e3e 2070 7269 6e74  ne.    >>> print
+00000960: 286e 6173 7472 616e 2e6e 6173 5f73 7363  (nastran.nas_ssc
+00000970: 616e 6628 2773 7472 696e 6727 2c20 6b65  anf('string', ke
+00000980: 6570 5f73 7472 696e 673d 5472 7565 2929  ep_string=True))
+00000990: 0a20 2020 2073 7472 696e 670a 2020 2020  .    string.    
+000009a0: 2222 220a 2020 2020 7472 793a 0a20 2020  """.    try:.   
+000009b0: 2020 2020 2072 6574 7572 6e20 696e 7428       return int(
+000009c0: 7329 0a20 2020 2065 7863 6570 7420 5661  s).    except Va
+000009d0: 6c75 6545 7272 6f72 3a0a 2020 2020 2020  lueError:.      
+000009e0: 2020 7472 793a 0a20 2020 2020 2020 2020    try:.         
+000009f0: 2020 2072 6574 7572 6e20 666c 6f61 7428     return float(
+00000a00: 7329 0a20 2020 2020 2020 2065 7863 6570  s).        excep
+00000a10: 7420 5661 6c75 6545 7272 6f72 3a0a 2020  t ValueError:.  
+00000a20: 2020 2020 2020 2020 2020 5320 3d20 7320            S = s 
+00000a30: 3d20 732e 7374 7269 7028 290a 2020 2020  = s.strip().    
+00000a40: 2020 2020 2020 2020 6966 206c 656e 2873          if len(s
+00000a50: 2920 3d3d 2030 3a0a 2020 2020 2020 2020  ) == 0:.        
+00000a60: 2020 2020 2020 2020 7265 7475 726e 204e          return N
+00000a70: 6f6e 650a 2020 2020 2020 2020 2020 2020  one.            
+00000a80: 7320 3d20 732e 6c6f 7765 7228 292e 7265  s = s.lower().re
+00000a90: 706c 6163 6528 2264 222c 2022 6522 290a  place("d", "e").
+00000aa0: 2020 2020 2020 2020 2020 2020 7472 793a              try:
+00000ab0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00000ac0: 2072 6574 7572 6e20 666c 6f61 7428 7329   return float(s)
+00000ad0: 0a20 2020 2020 2020 2020 2020 2065 7863  .            exc
+00000ae0: 6570 7420 5661 6c75 6545 7272 6f72 3a0a  ept ValueError:.
+00000af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000b00: 7320 3d20 735b 305d 202b 2073 5b31 3a5d  s = s[0] + s[1:]
+00000b10: 2e72 6570 6c61 6365 2822 2b22 2c20 2265  .replace("+", "e
+00000b20: 2b22 292e 7265 706c 6163 6528 222d 222c  +").replace("-",
+00000b30: 2022 652d 2229 0a20 2020 2020 2020 2020   "e-").         
+00000b40: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
+00000b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000b60: 7265 7475 726e 2066 6c6f 6174 2873 290a  return float(s).
+00000b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00000b80: 6578 6365 7074 2056 616c 7565 4572 726f  except ValueErro
+00000b90: 723a 0a20 2020 2020 2020 2020 2020 2020  r:.             
+00000ba0: 2020 2020 2020 2069 6620 6b65 6570 5f73         if keep_s
+00000bb0: 7472 696e 673a 0a20 2020 2020 2020 2020  tring:.         
+00000bc0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00000bd0: 6574 7572 6e20 530a 2020 2020 2020 2020  eturn S.        
+00000be0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00000bf0: 726e 204e 6f6e 650a 0a0a 6465 6620 6673  rn None...def fs
+00000c00: 6561 7263 6828 662c 2073 293a 0a20 2020  earch(f, s):.   
+00000c10: 2022 2222 0a20 2020 2053 6561 7263 6820   """.    Search 
+00000c20: 666f 7220 6120 6c69 6e65 2069 6e20 6120  for a line in a 
+00000c30: 6669 6c65 2e0a 0a20 2020 2050 6172 616d  file...    Param
+00000c40: 6574 6572 730a 2020 2020 2d2d 2d2d 2d2d  eters.    ------
+00000c50: 2d2d 2d2d 0a20 2020 2066 203a 2066 696c  ----.    f : fil
+00000c60: 655f 6c69 6b65 0a20 2020 2020 2020 2046  e_like.        F
+00000c70: 696c 655f 6c69 6b65 206f 626a 6563 7420  ile_like object 
+00000c80: 746f 2073 6561 7263 6820 696e 2e0a 2020  to search in..  
+00000c90: 2020 7320 3a20 7374 7269 6e67 0a20 2020    s : string.   
+00000ca0: 2020 2020 2053 7472 696e 6720 746f 2073       String to s
+00000cb0: 6561 7263 6820 666f 722e 0a0a 2020 2020  earch for...    
+00000cc0: 5265 7475 726e 730a 2020 2020 2d2d 2d2d  Returns.    ----
+00000cd0: 2d2d 2d0a 2020 2020 6c69 6e65 203a 2073  ---.    line : s
+00000ce0: 7472 696e 6720 6f72 204e 6f6e 650a 2020  tring or None.  
+00000cf0: 2020 2020 2020 5468 6520 6669 7273 7420        The first 
+00000d00: 6c69 6e65 2074 6861 7420 636f 6e74 6169  line that contai
+00000d10: 6e73 2074 6865 2073 7472 696e 672e 204e  ns the string. N
+00000d20: 6f6e 6520 6966 206e 6f74 2066 6f75 6e64  one if not found
+00000d30: 2e0a 2020 2020 7020 3a20 696e 7465 6765  ..    p : intege
+00000d40: 7220 6f72 204e 6f6e 650a 2020 2020 2020  r or None.      
+00000d50: 2020 5468 6520 706f 7369 7469 6f6e 2077    The position w
+00000d60: 6865 7265 2060 7360 2062 6567 696e 7320  here `s` begins 
+00000d70: 696e 2060 6c69 6e65 602e 204e 6f6e 6520  in `line`. None 
+00000d80: 6966 206e 6f74 2066 6f75 6e64 2e0a 0a20  if not found... 
+00000d90: 2020 204e 6f74 6573 0a20 2020 202d 2d2d     Notes.    ---
+00000da0: 2d2d 0a20 2020 2054 6865 2073 6561 7263  --.    The searc
+00000db0: 6820 6265 6769 6e73 2061 7420 7468 6520  h begins at the 
+00000dc0: 6375 7272 656e 7420 6669 6c65 2070 6f73  current file pos
+00000dd0: 6974 696f 6e2e 0a20 2020 2022 2222 0a20  ition..    """. 
+00000de0: 2020 2066 6f72 206c 696e 6520 696e 2066     for line in f
+00000df0: 3a0a 2020 2020 2020 2020 7020 3d20 6c69  :.        p = li
+00000e00: 6e65 2e66 696e 6428 7329 0a20 2020 2020  ne.find(s).     
+00000e10: 2020 2069 6620 7020 3e20 2d31 3a0a 2020     if p > -1:.  
+00000e20: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00000e30: 206c 696e 652c 2070 0a20 2020 2072 6574   line, p.    ret
+00000e40: 7572 6e20 4e6f 6e65 2c20 4e6f 6e65 0a0a  urn None, None..
+00000e50: 0a40 6775 6974 6f6f 6c73 2e72 6561 645f  .@guitools.read_
+00000e60: 7465 7874 5f66 696c 650a 6465 6620 7264  text_file.def rd
+00000e70: 6770 7767 2866 2c20 7365 6172 6368 5f73  gpwg(f, search_s
+00000e80: 7472 696e 6773 3d4e 6f6e 6529 3a0a 2020  trings=None):.  
+00000e90: 2020 2222 220a 2020 2020 5265 6164 2061    """.    Read a
+00000ea0: 2047 5057 4720 7461 626c 6520 6672 6f6d   GPWG table from
+00000eb0: 2061 204e 6173 7472 616e 2046 3036 2066   a Nastran F06 f
+00000ec0: 696c 652e 0a0a 2020 2020 5061 7261 6d65  ile...    Parame
+00000ed0: 7465 7273 0a20 2020 202d 2d2d 2d2d 2d2d  ters.    -------
+00000ee0: 2d2d 2d0a 2020 2020 6620 3a20 7374 7269  ---.    f : stri
+00000ef0: 6e67 206f 7220 6669 6c65 5f6c 696b 6520  ng or file_like 
+00000f00: 6f72 204e 6f6e 650a 2020 2020 2020 2020  or None.        
+00000f10: 4569 7468 6572 2061 206e 616d 6520 6f66  Either a name of
+00000f20: 2061 2066 696c 652c 206f 7220 6973 2061   a file, or is a
+00000f30: 2066 696c 655f 6c69 6b65 206f 626a 6563   file_like objec
+00000f40: 7420 6173 2072 6574 7572 6e65 640a 2020  t as returned.  
+00000f50: 2020 2020 2020 6279 203a 6675 6e63 3a60        by :func:`
+00000f60: 6f70 656e 602e 2049 6620 6669 6c65 5f6c  open`. If file_l
+00000f70: 696b 6520 6f62 6a65 6374 2c20 6974 2069  ike object, it i
+00000f80: 7320 7265 776f 756e 6420 6669 7273 742e  s rewound first.
+00000f90: 2043 616e 0a20 2020 2020 2020 2061 6c73   Can.        als
+00000fa0: 6f20 6265 2074 6865 206e 616d 6520 6f66  o be the name of
+00000fb0: 2061 2064 6972 6563 746f 7279 206f 7220   a directory or 
+00000fc0: 4e6f 6e65 3b20 696e 2074 6865 7365 2063  None; in these c
+00000fd0: 6173 6573 2c20 6120 4755 490a 2020 2020  ases, a GUI.    
+00000fe0: 2020 2020 6973 206f 7065 6e65 6420 666f      is opened fo
+00000ff0: 7220 6669 6c65 2073 656c 6563 7469 6f6e  r file selection
+00001000: 2e0a 2020 2020 7365 6172 6368 5f73 7472  ..    search_str
+00001010: 696e 6773 203a 204e 6f6e 652c 2073 7472  ings : None, str
+00001020: 696e 672c 206f 7220 6c69 7374 5f6c 696b  ing, or list_lik
+00001030: 6520 6f66 2073 7472 696e 6773 0a20 2020  e of strings.   
+00001040: 2020 2020 2049 6620 6120 7374 7269 6e67       If a string
+00001050: 2c20 7468 6973 2072 6f75 7469 6e65 2077  , this routine w
+00001060: 696c 6c20 7363 616e 2074 6865 2066 696c  ill scan the fil
+00001070: 6520 756e 7469 6c20 7468 6520 7374 7269  e until the stri
+00001080: 6e67 0a20 2020 2020 2020 2069 7320 666f  ng.        is fo
+00001090: 756e 6420 6265 666f 7265 2072 6561 6469  und before readi
+000010a0: 6e67 2074 6865 2047 5057 4720 7461 626c  ng the GPWG tabl
+000010b0: 652e 2049 6620 6d75 6c74 6970 6c65 2073  e. If multiple s
+000010c0: 7472 696e 6773 2069 6e0a 2020 2020 2020  trings in.      
+000010d0: 2020 6120 6c69 7374 206f 7220 7475 706c    a list or tupl
+000010e0: 652c 2074 6865 2072 6f75 7469 6e65 2077  e, the routine w
+000010f0: 696c 6c20 7363 616e 2066 6f72 2065 6163  ill scan for eac
+00001100: 6820 7374 7269 6e67 2c20 696e 2074 6865  h string, in the
+00001110: 0a20 2020 2020 2020 206f 7264 6572 2070  .        order p
+00001120: 726f 7669 6465 642c 2062 6566 6f72 6520  rovided, before 
+00001130: 7265 6164 696e 6720 7468 6520 4750 5747  reading the GPWG
+00001140: 2074 6162 6c65 2e20 4966 204e 6f6e 652c   table. If None,
+00001150: 2074 6865 0a20 2020 2020 2020 2066 6972   the.        fir
+00001160: 7374 2047 5057 4720 7461 626c 6520 6973  st GPWG table is
+00001170: 2072 6561 642e 0a0a 2020 2020 5265 7475   read...    Retu
+00001180: 726e 730a 2020 2020 2d2d 2d2d 2d2d 2d0a  rns.    -------.
+00001190: 2020 2020 6d61 7373 203a 2032 6420 6e64      mass : 2d nd
+000011a0: 6172 7261 790a 2020 2020 2020 2020 5468  array.        Th
+000011b0: 6520 3678 3620 6d61 7373 2028 6f72 2077  e 6x6 mass (or w
+000011c0: 6569 6768 7429 206d 6174 7269 782e 0a20  eight) matrix.. 
+000011d0: 2020 2063 6720 3a20 3264 206e 6461 7272     cg : 2d ndarr
+000011e0: 6179 0a20 2020 2020 2020 2054 6865 2033  ay.        The 3
+000011f0: 7834 2063 656e 7465 722d 6f66 2d67 7261  x4 center-of-gra
+00001200: 7669 7479 2074 6162 6c65 3a3a 0a0a 2020  vity table::..  
+00001210: 2020 2020 2020 2020 2020 5b20 6d61 7373            [ mass
+00001220: 2878 2c20 792c 207a 2920 782d 6367 2079  (x, y, z) x-cg y
+00001230: 2d63 6720 7a2d 6367 205d 0a0a 2020 2020  -cg z-cg ]..    
+00001240: 7265 6670 7420 3a20 696e 7465 6765 720a  refpt : integer.
+00001250: 2020 2020 2020 2020 5468 6520 7265 6665          The refe
+00001260: 7265 6e63 6520 706f 696e 7420 6c69 7374  rence point list
+00001270: 6564 206a 7573 7420 6265 666f 7265 2074  ed just before t
+00001280: 6865 206d 6173 7320 6d61 7472 6978 2069  he mass matrix i
+00001290: 6e20 7468 650a 2020 2020 2020 2020 4630  n the.        F0
+000012a0: 3620 6669 6c65 2e0a 2020 2020 4973 203a  6 file..    Is :
+000012b0: 2032 6420 6e64 6172 7261 790a 2020 2020   2d ndarray.    
+000012c0: 2020 2020 5468 6520 4928 5329 206d 6174      The I(S) mat
+000012d0: 7269 782e 2054 6869 7320 6973 2074 6865  rix. This is the
+000012e0: 2033 2078 2033 206d 6173 7320 6d6f 6d65   3 x 3 mass mome
+000012f0: 6e74 206f 6620 696e 6572 7469 610a 2020  nt of inertia.  
+00001300: 2020 2020 2020 7061 7274 6974 696f 6e20        partition 
+00001310: 7769 7468 2072 6573 7065 6374 2074 6f20  with respect to 
+00001320: 7468 6520 6365 6e74 6572 206f 6620 6772  the center of gr
+00001330: 6176 6974 7920 7265 6665 7272 6564 2074  avity referred t
+00001340: 6f0a 2020 2020 2020 2020 7468 6520 7072  o.        the pr
+00001350: 696e 6369 7061 6c20 6d61 7373 2061 7865  incipal mass axe
+00001360: 7320 2874 6865 2053 2073 7973 7465 6d29  s (the S system)
+00001370: 2e20 5468 6973 2069 7320 6e6f 740a 2020  . This is not.  
+00001380: 2020 2020 2020 6e65 6365 7373 6172 696c        necessaril
+00001390: 7920 6120 6469 6167 6f6e 616c 206d 6174  y a diagonal mat
+000013a0: 7269 7820 6265 6361 7573 6520 7468 6520  rix because the 
+000013b0: 6465 7465 726d 696e 6174 696f 6e20 6f66  determination of
+000013c0: 2074 6865 0a20 2020 2020 2020 2053 2073   the.        S s
+000013d0: 7973 7465 6d20 646f 6573 206e 6f74 2069  ystem does not i
+000013e0: 6e76 6f6c 7665 2073 6563 6f6e 6420 6d6f  nvolve second mo
+000013f0: 6d65 6e74 732e 2054 6865 2076 616c 7565  ments. The value
+00001400: 7320 6f66 0a20 2020 2020 2020 2069 6e65  s of.        ine
+00001410: 7274 6961 7320 6174 2074 6865 2063 656e  rtias at the cen
+00001420: 7465 7220 6f66 2067 7261 7669 7479 2061  ter of gravity a
+00001430: 7265 2066 6f75 6e64 2066 726f 6d20 7468  re found from th
+00001440: 6520 7661 6c75 6573 2061 740a 2020 2020  e values at.    
+00001450: 2020 2020 7468 6520 7265 6665 7265 6e63      the referenc
+00001460: 6520 706f 696e 7420 656d 706c 6f79 696e  e point employin
+00001470: 6720 7468 6520 7061 7261 6c6c 656c 2061  g the parallel a
+00001480: 7869 7320 7275 6c65 2e0a 0a20 2020 204e  xis rule...    N
+00001490: 6f74 6573 0a20 2020 202d 2d2d 2d2d 0a20  otes.    -----. 
+000014a0: 2020 2054 6865 2072 6f75 7469 6e65 2077     The routine w
+000014b0: 696c 6c20 6c6f 6164 2074 6865 2066 6972  ill load the fir
+000014c0: 7374 2047 5057 4720 7461 626c 6520 6974  st GPWG table it
+000014d0: 2066 696e 6473 2061 6674 6572 0a20 2020   finds after.   
+000014e0: 2073 6561 7263 6869 6e67 2066 6f72 2065   searching for e
+000014f0: 6163 6820 7374 7269 6e67 2069 6e20 6073  ach string in `s
+00001500: 6561 7263 685f 7374 7269 6e67 7360 2c20  earch_strings`, 
+00001510: 6966 2070 726f 7669 6465 642e 2041 6674  if provided. Aft
+00001520: 6572 0a20 2020 2073 6561 7263 6869 6e67  er.    searching
+00001530: 2066 6f72 2074 6865 7365 2073 7472 696e   for these strin
+00001540: 6773 2c20 7468 6520 726f 7574 696e 6520  gs, the routine 
+00001550: 7769 6c6c 2073 6561 7263 6820 666f 7220  will search for 
+00001560: 7468 6520 6e65 7874 0a20 2020 2022 5720  the next.    "W 
+00001570: 4520 4920 4720 4820 5422 2073 7472 696e  E I G H T" strin
+00001580: 672e 0a0a 2020 2020 416c 6c20 6f75 7470  g...    All outp
+00001590: 7574 7320 7769 6c6c 2062 6520 7365 7420  uts will be set 
+000015a0: 746f 204e 6f6e 6520 6966 206e 6f20 4750  to None if no GP
+000015b0: 5747 2074 6162 6c65 2069 7320 666f 756e  WG table is foun
+000015c0: 6420 6f72 2069 6620 610a 2020 2020 7365  d or if a.    se
+000015d0: 6172 6368 2073 7472 696e 6720 6973 206e  arch string is n
+000015e0: 6f74 2066 6f75 6e64 2e0a 0a20 2020 2045  ot found...    E
+000015f0: 7861 6d70 6c65 2075 7361 6765 3a3a 0a0a  xample usage::..
+00001600: 2020 2020 2020 2020 6672 6f6d 2070 7979          from pyy
+00001610: 6574 6920 696d 706f 7274 206e 6173 7472  eti import nastr
+00001620: 616e 0a20 2020 2020 2020 2073 7472 3120  an.        str1 
+00001630: 3d20 2720 2020 2020 2020 2020 2020 5355  = '           SU
+00001640: 5045 5245 4c45 4d45 4e54 2031 3030 270a  PERELEMENT 100'.
+00001650: 2020 2020 2020 2020 7374 7232 203d 2027          str2 = '
+00001660: 5e5e 5e46 2d53 4554 204d 4153 5320 5441  ^^^F-SET MASS TA
+00001670: 424c 4527 0a20 2020 2020 2020 206d 6173  BLE'.        mas
+00001680: 732c 2063 672c 2072 6566 2c20 4920 3d20  s, cg, ref, I = 
+00001690: 6e61 7374 7261 6e2e 7264 6770 7767 2827  nastran.rdgpwg('
+000016a0: 6d6f 6465 732e 6630 3627 2c20 2873 7472  modes.f06', (str
+000016b0: 312c 2073 7472 3229 290a 2020 2020 2222  1, str2)).    ""
+000016c0: 220a 2020 2020 662e 7365 656b 2830 2c20  ".    f.seek(0, 
+000016d0: 3029 0a20 2020 2064 6566 6175 6c74 203d  0).    default =
+000016e0: 204e 6f6e 652c 204e 6f6e 652c 204e 6f6e   None, None, Non
+000016f0: 652c 204e 6f6e 650a 2020 2020 6966 2073  e, None.    if s
+00001700: 6561 7263 685f 7374 7269 6e67 7320 6973  earch_strings is
+00001710: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
+00001720: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+00001730: 2873 6561 7263 685f 7374 7269 6e67 732c  (search_strings,
+00001740: 2073 7472 293a 0a20 2020 2020 2020 2020   str):.         
+00001750: 2020 2073 6561 7263 685f 7374 7269 6e67     search_string
+00001760: 7320 3d20 2873 6561 7263 685f 7374 7269  s = (search_stri
+00001770: 6e67 732c 290a 2020 2020 2020 2020 666f  ngs,).        fo
+00001780: 7220 7320 696e 2073 6561 7263 685f 7374  r s in search_st
+00001790: 7269 6e67 733a 0a20 2020 2020 2020 2020  rings:.         
+000017a0: 2020 2066 6f72 206c 696e 6520 696e 2066     for line in f
+000017b0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000017c0: 2020 6966 206c 696e 652e 6669 6e64 2873    if line.find(s
+000017d0: 2920 3e20 2d31 3a0a 2020 2020 2020 2020  ) > -1:.        
+000017e0: 2020 2020 2020 2020 2020 2020 6272 6561              brea
+000017f0: 6b0a 2020 2020 2020 2020 2020 2020 656c  k.            el
+00001800: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00001810: 2020 2020 7265 7475 726e 2064 6566 6175      return defau
+00001820: 6c74 0a0a 2020 2020 6c69 6e65 2c20 7020  lt..    line, p 
+00001830: 3d20 6673 6561 7263 6828 662c 2022 5720  = fsearch(f, "W 
+00001840: 4520 4920 4720 4820 5422 290a 2020 2020  E I G H T").    
+00001850: 6966 206c 696e 6520 6973 204e 6f6e 653a  if line is None:
+00001860: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00001870: 6465 6661 756c 740a 2020 2020 6c69 6e65  default.    line
+00001880: 2c20 7020 3d20 6673 6561 7263 6828 662c  , p = fsearch(f,
+00001890: 2022 5245 4645 5245 4e43 4520 504f 494e   "REFERENCE POIN
+000018a0: 5420 3d22 290a 2020 2020 7265 6670 7420  T =").    refpt 
+000018b0: 3d20 696e 7428 6c69 6e65 5b70 202b 2031  = int(line[p + 1
+000018c0: 3720 3a5d 290a 0a20 2020 2066 2e72 6561  7 :])..    f.rea
+000018d0: 646c 696e 6528 290a 2020 2020 6d61 7373  dline().    mass
+000018e0: 203d 205b 5d0a 2020 2020 666f 7220 5f20   = [].    for _ 
+000018f0: 696e 2072 616e 6765 2836 293a 0a20 2020  in range(6):.   
+00001900: 2020 2020 206c 696e 6520 3d20 662e 7265       line = f.re
+00001910: 6164 6c69 6e65 2829 2e73 7472 6970 2829  adline().strip()
+00001920: 0a20 2020 2020 2020 206d 6173 732e 6170  .        mass.ap
+00001930: 7065 6e64 285b 666c 6f61 7428 6974 656d  pend([float(item
+00001940: 2920 666f 7220 6974 656d 2069 6e20 6c69  ) for item in li
+00001950: 6e65 5b31 3a2d 315d 2e73 706c 6974 2829  ne[1:-1].split()
+00001960: 5d29 0a20 2020 206d 6173 7320 3d20 6e70  ]).    mass = np
+00001970: 2e61 7272 6179 286d 6173 7329 0a20 2020  .array(mass).   
+00001980: 206c 696e 652c 2070 203d 2066 7365 6172   line, p = fsear
+00001990: 6368 2866 2c20 224d 4153 5320 4158 4953  ch(f, "MASS AXIS
+000019a0: 2053 5953 5445 4d22 290a 0a20 2020 2063   SYSTEM")..    c
+000019b0: 6720 3d20 5b5d 0a20 2020 2066 6f72 205f  g = [].    for _
+000019c0: 2069 6e20 7261 6e67 6528 3329 3a0a 2020   in range(3):.  
+000019d0: 2020 2020 2020 6c69 6e65 203d 2066 2e72        line = f.r
+000019e0: 6561 646c 696e 6528 292e 7374 7269 7028  eadline().strip(
+000019f0: 290a 2020 2020 2020 2020 6367 2e61 7070  ).        cg.app
+00001a00: 656e 6428 5b66 6c6f 6174 2869 7465 6d29  end([float(item)
+00001a10: 2066 6f72 2069 7465 6d20 696e 206c 696e   for item in lin
+00001a20: 655b 313a 5d2e 7370 6c69 7428 295d 290a  e[1:].split()]).
+00001a30: 2020 2020 6367 203d 206e 702e 6172 7261      cg = np.arra
+00001a40: 7928 6367 290a 0a20 2020 2066 2e72 6561  y(cg)..    f.rea
+00001a50: 646c 696e 6528 290a 2020 2020 4973 203d  dline().    Is =
+00001a60: 205b 5d0a 2020 2020 666f 7220 5f20 696e   [].    for _ in
+00001a70: 2072 616e 6765 2833 293a 0a20 2020 2020   range(3):.     
+00001a80: 2020 206c 696e 6520 3d20 662e 7265 6164     line = f.read
+00001a90: 6c69 6e65 2829 2e73 7472 6970 2829 0a20  line().strip(). 
+00001aa0: 2020 2020 2020 2049 732e 6170 7065 6e64         Is.append
+00001ab0: 285b 666c 6f61 7428 6974 656d 2920 666f  ([float(item) fo
+00001ac0: 7220 6974 656d 2069 6e20 6c69 6e65 5b31  r item in line[1
+00001ad0: 3a2d 315d 2e73 706c 6974 2829 5d29 0a20  :-1].split()]). 
+00001ae0: 2020 2049 7320 3d20 6e70 2e61 7272 6179     Is = np.array
+00001af0: 2849 7329 0a20 2020 2072 6574 7572 6e20  (Is).    return 
+00001b00: 6d61 7373 2c20 6367 2c20 7265 6670 742c  mass, cg, refpt,
+00001b10: 2049 730a 0a0a 2320 6465 6620 5f72 6561   Is...# def _rea
+00001b20: 646c 696e 655f 6b65 6570 5f63 6f6d 6d65  dline_keep_comme
+00001b30: 6e74 7328 6974 2c20 5661 6c73 293a 0a23  nts(it, Vals):.#
+00001b40: 2020 2020 2074 7279 3a0a 2320 2020 2020       try:.#     
+00001b50: 2020 2020 7320 3d20 6e65 7874 2869 7429      s = next(it)
+00001b60: 0a23 2020 2020 2020 2020 2077 6869 6c65  .#         while
+00001b70: 206c 656e 2873 2920 3e20 3020 616e 6420   len(s) > 0 and 
+00001b80: 735b 305d 203d 3d20 2224 223a 0a23 2020  s[0] == "$":.#  
+00001b90: 2020 2020 2020 2020 2020 2056 616c 732e             Vals.
+00001ba0: 6170 7065 6e64 2873 290a 2320 2020 2020  append(s).#     
+00001bb0: 2020 2020 2020 2020 7320 3d20 6e65 7874          s = next
+00001bc0: 2869 7429 0a23 2020 2020 2020 2020 2072  (it).#         r
+00001bd0: 6574 7572 6e20 730a 2320 2020 2020 6578  eturn s.#     ex
+00001be0: 6365 7074 2053 746f 7049 7465 7261 7469  cept StopIterati
+00001bf0: 6f6e 3a0a 2320 2020 2020 2020 2020 7265  on:.#         re
+00001c00: 7475 726e 204e 6f6e 650a 230a 230a 2320  turn None.#.#.# 
+00001c10: 6465 6620 5f72 6561 646c 696e 655f 736b  def _readline_sk
+00001c20: 6970 5f63 6f6d 6d65 6e74 7328 6974 2c20  ip_comments(it, 
+00001c30: 5661 6c73 293a 0a23 2020 2020 2074 7279  Vals):.#     try
+00001c40: 3a0a 2320 2020 2020 2020 2020 7320 3d20  :.#         s = 
+00001c50: 6e65 7874 2869 7429 0a23 2020 2020 2020  next(it).#      
+00001c60: 2020 2077 6869 6c65 206c 656e 2873 2920     while len(s) 
+00001c70: 3e20 3020 616e 6420 735b 305d 203d 3d20  > 0 and s[0] == 
+00001c80: 2224 223a 0a23 2020 2020 2020 2020 2020  "$":.#          
+00001c90: 2020 2073 203d 206e 6578 7428 6974 290a     s = next(it).
+00001ca0: 2320 2020 2020 2020 2020 7265 7475 726e  #         return
+00001cb0: 2073 0a23 2020 2020 2065 7863 6570 7420   s.#     except 
+00001cc0: 5374 6f70 4974 6572 6174 696f 6e3a 0a23  StopIteration:.#
+00001cd0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00001ce0: 4e6f 6e65 0a23 0a23 0a23 2064 6566 205f  None.#.#.# def _
+00001cf0: 6765 745f 6c69 6e65 2866 6974 6572 2c20  get_line(fiter, 
+00001d00: 5f72 6561 646c 696e 652c 2056 616c 732c  _readline, Vals,
+00001d10: 2073 3d4e 6f6e 652c 2074 7269 6d3d 5472   s=None, trim=Tr
+00001d20: 7565 293a 0a23 2020 2020 2069 6620 7320  ue):.#     if s 
+00001d30: 6973 204e 6f6e 653a 0a23 2020 2020 2020  is None:.#      
+00001d40: 2020 2073 203d 205f 7265 6164 6c69 6e65     s = _readline
+00001d50: 2866 6974 6572 2c20 5661 6c73 290a 2320  (fiter, Vals).# 
+00001d60: 2020 2020 2020 2020 6966 2073 2069 7320          if s is 
+00001d70: 4e6f 6e65 3a0a 2320 2020 2020 2020 2020  None:.#         
+00001d80: 2020 2020 7265 7475 726e 204e 6f6e 650a      return None.
+00001d90: 2320 2020 2020 7320 3d20 732e 6578 7061  #     s = s.expa
+00001da0: 6e64 7461 6273 2829 0a23 2020 2020 2069  ndtabs().#     i
+00001db0: 6620 7472 696d 3a0a 2320 2020 2020 2020  f trim:.#       
+00001dc0: 2020 7320 3d20 735b 3a37 325d 0a23 2020    s = s[:72].#  
+00001dd0: 2020 2070 203d 2073 2e66 696e 6428 2224     p = s.find("$
+00001de0: 2229 0a23 2020 2020 2069 6620 7020 3e20  ").#     if p > 
+00001df0: 2d31 3a0a 2320 2020 2020 2020 2020 7320  -1:.#         s 
+00001e00: 3d20 735b 3a70 5d0a 2320 2020 2020 7320  = s[:p].#     s 
+00001e10: 3d20 732e 7273 7472 6970 2829 0a23 2020  = s.rstrip().#  
+00001e20: 2020 2072 6574 7572 6e20 730a 0a0a 6465     return s...de
+00001e30: 6620 5f70 726f 635f 6c69 6e65 2873 293a  f _proc_line(s):
+00001e40: 0a20 2020 2070 203d 2073 2e66 696e 6428  .    p = s.find(
+00001e50: 2224 2229 0a20 2020 2069 6620 7020 3e20  "$").    if p > 
+00001e60: 2d31 3a0a 2020 2020 2020 2020 7320 3d20  -1:.        s = 
+00001e70: 735b 3a70 5d0a 2020 2020 7265 7475 726e  s[:p].    return
+00001e80: 2073 2e72 7374 7269 7028 290a 0a0a 6465   s.rstrip()...de
+00001e90: 6620 5f68 616e 646c 655f 636f 6d6d 656e  f _handle_commen
+00001ea0: 7473 2863 6f6d 6d65 6e74 5f6c 6973 742c  ts(comment_list,
+00001eb0: 2056 616c 7329 3a0a 2020 2020 6966 2063   Vals):.    if c
+00001ec0: 6f6d 6d65 6e74 5f6c 6973 743a 0a20 2020  omment_list:.   
+00001ed0: 2020 2020 2023 2069 6620 7468 6572 6520       # if there 
+00001ee0: 7765 7265 2063 6f6d 6d65 6e74 7320 7265  were comments re
+00001ef0: 6164 2069 6e2c 2073 746f 7265 2074 6865  ad in, store the
+00001f00: 6d0a 2020 2020 2020 2020 2320 616e 6420  m.        # and 
+00001f10: 636c 6561 7220 6361 6368 653a 0a20 2020  clear cache:.   
+00001f20: 2020 2020 2056 616c 732e 6578 7465 6e64       Vals.extend
+00001f30: 2863 6f6d 6d65 6e74 5f6c 6973 7429 0a20  (comment_list). 
+00001f40: 2020 2020 2020 2063 6f6d 6d65 6e74 5f6c         comment_l
+00001f50: 6973 742e 636c 6561 7228 290a 0a0a 6465  ist.clear()...de
+00001f60: 6620 5f6e 6578 745f 6c69 6e65 2866 2c20  f _next_line(f, 
+00001f70: 6e61 6d65 2c20 7265 6765 782c 206b 6565  name, regex, kee
+00001f80: 705f 636f 6d6d 656e 7473 2c20 5661 6c73  p_comments, Vals
+00001f90: 293a 0a20 2020 2069 6620 7265 6765 783a  ):.    if regex:
+00001fa0: 0a20 2020 2020 2020 2070 726f 6720 3d20  .        prog = 
+00001fb0: 7265 2e63 6f6d 7069 6c65 286e 616d 652c  re.compile(name,
+00001fc0: 2072 652e 4947 4e4f 5245 4341 5345 290a   re.IGNORECASE).
+00001fd0: 0a20 2020 2020 2020 2064 6566 2069 736d  .        def ism
+00001fe0: 6174 6368 286c 696e 652c 2070 726f 6729  atch(line, prog)
+00001ff0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+00002000: 7475 726e 2070 726f 672e 6d61 7463 6828  turn prog.match(
+00002010: 6c69 6e65 290a 0a20 2020 2065 6c73 653a  line)..    else:
+00002020: 0a20 2020 2020 2020 2070 726f 6720 3d20  .        prog = 
+00002030: 6e61 6d65 2e6c 6f77 6572 2829 0a0a 2020  name.lower()..  
+00002040: 2020 2020 2020 6465 6620 6973 6d61 7463        def ismatc
+00002050: 6828 6c69 6e65 2c20 7072 6f67 293a 0a20  h(line, prog):. 
+00002060: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+00002070: 6e20 6c69 6e65 2e6c 6f77 6572 2829 2e66  n line.lower().f
+00002080: 696e 6428 7072 6f67 2920 3d3d 2030 0a0a  ind(prog) == 0..
+00002090: 2020 2020 646f 5f6d 6174 6368 203d 2054      do_match = T
+000020a0: 7275 650a 2020 2020 6966 206e 6f74 206b  rue.    if not k
+000020b0: 6565 705f 636f 6d6d 656e 7473 3a0a 2020  eep_comments:.  
+000020c0: 2020 2020 2020 666f 7220 6c69 6e65 2069        for line i
+000020d0: 6e20 663a 0a20 2020 2020 2020 2020 2020  n f:.           
+000020e0: 206c 696e 6520 3d20 6c69 6e65 2e65 7870   line = line.exp
+000020f0: 616e 6474 6162 7328 290a 2020 2020 2020  andtabs().      
+00002100: 2020 2020 2020 6966 2064 6f5f 6d61 7463        if do_matc
+00002110: 683a 0a20 2020 2020 2020 2020 2020 2020  h:.             
+00002120: 2020 2069 6620 6973 6d61 7463 6828 6c69     if ismatch(li
+00002130: 6e65 2c20 7072 6f67 293a 0a20 2020 2020  ne, prog):.     
+00002140: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00002150: 2066 6f75 6e64 2074 6865 2073 7461 7274   found the start
+00002160: 206f 6620 6120 6d61 7463 6869 6e67 2063   of a matching c
+00002170: 6172 642c 2079 6965 6c64 206c 696e 650a  ard, yield line.
+00002180: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002190: 2020 2020 646f 5f6d 6174 6368 203d 2079      do_match = y
+000021a0: 6965 6c64 206c 696e 650a 2020 2020 2020  ield line.      
+000021b0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+000021c0: 6966 2063 6172 6420 636f 6e74 696e 7565  if card continue
+000021d0: 7320 6f6e 206d 756c 7469 706c 6520 6c69  s on multiple li
+000021e0: 6e65 732c 2064 6f5f 6d61 7463 680a 2020  nes, do_match.  
+000021f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002200: 2020 2320 7769 6c6c 2062 6520 7365 7420    # will be set 
+00002210: 746f 2046 616c 7365 0a20 2020 2020 2020  to False.       
+00002220: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00002230: 2020 2020 2020 2020 2020 2023 2064 6f5f             # do_
+00002240: 6d61 7463 6820 6973 2046 616c 7365 2028  match is False (
+00002250: 6d65 616e 696e 6720 7265 6164 696e 6720  meaning reading 
+00002260: 636f 6e74 696e 7561 7469 6f6e 0a20 2020  continuation.   
+00002270: 2020 2020 2020 2020 2020 2020 2023 206c               # l
+00002280: 696e 6573 292c 2073 6f20 6765 7420 6e65  ines), so get ne
+00002290: 7874 206c 696e 6520 6e6f 206d 6174 7465  xt line no matte
+000022a0: 7220 7768 6174 2069 7420 6973 3a0a 2020  r what it is:.  
+000022b0: 2020 2020 2020 2020 2020 2020 2020 646f                do
+000022c0: 5f6d 6174 6368 203d 2079 6965 6c64 206c  _match = yield l
+000022d0: 696e 650a 2020 2020 2020 2020 2020 2020  ine.            
+000022e0: 2020 2020 2320 6966 2064 6f5f 6d61 7463      # if do_matc
+000022f0: 6820 6973 206e 6f77 2054 7275 652c 2074  h is now True, t
+00002300: 6865 206c 6173 7420 6c69 6e65 2072 6561  he last line rea
+00002310: 6420 6973 2074 6865 0a20 2020 2020 2020  d is the.       
+00002320: 2020 2020 2020 2020 2023 206e 6578 7420           # next 
+00002330: 6c69 6e65 2074 6861 7420 6e65 6564 7320  line that needs 
+00002340: 746f 2062 6520 6578 616d 696e 6564 3a0a  to be examined:.
 00002350: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002360: 2020 2069 6620 6973 6d61 7463 6828 6c69     if ismatch(li
-00002370: 6e65 2c20 7072 6f67 293a 0a20 2020 2020  ne, prog):.     
-00002380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002390: 2020 2064 6f5f 6d61 7463 6820 3d20 7969     do_match = yi
-000023a0: 656c 6420 6c69 6e65 0a0a 2020 2020 2020  eld line..      
-000023b0: 2020 646f 5f6d 6174 6368 203d 2079 6965    do_match = yie
-000023c0: 6c64 204e 6f6e 6520 2023 206d 6172 6b20  ld None  # mark 
-000023d0: 7468 6520 656e 6420 6f66 2069 6e70 7574  the end of input
-000023e0: 0a20 2020 2065 6c73 653a 0a20 2020 2020  .    else:.     
-000023f0: 2020 2063 6f6d 6d65 6e74 5f6c 6973 7420     comment_list 
-00002400: 3d20 5b5d 0a20 2020 2020 2020 2066 6f72  = [].        for
-00002410: 206c 696e 6520 696e 2066 3a0a 2020 2020   line in f:.    
-00002420: 2020 2020 2020 2020 6966 206c 696e 652e          if line.
-00002430: 7374 6172 7473 7769 7468 2822 2422 293a  startswith("$"):
-00002440: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00002450: 2063 6f6d 6d65 6e74 5f6c 6973 742e 6170   comment_list.ap
-00002460: 7065 6e64 286c 696e 6529 0a20 2020 2020  pend(line).     
-00002470: 2020 2020 2020 2020 2020 2063 6f6e 7469             conti
-00002480: 6e75 650a 2020 2020 2020 2020 2020 2020  nue.            
-00002490: 6c69 6e65 203d 206c 696e 652e 6578 7061  line = line.expa
-000024a0: 6e64 7461 6273 2829 0a0a 2020 2020 2020  ndtabs()..      
-000024b0: 2020 2020 2020 2320 7468 6973 2069 7320        # this is 
-000024c0: 7665 7279 206d 7563 6820 6c69 6b65 2061  very much like a
-000024d0: 626f 7665 2c20 736f 2073 6565 2074 686f  bove, so see tho
-000024e0: 7365 0a20 2020 2020 2020 2020 2020 2023  se.            #
-000024f0: 2063 6f6d 6d65 6e74 732e 2061 6464 6564   comments. added
-00002500: 2063 6f6d 6d65 6e74 7320 7065 7274 6169   comments pertai
-00002510: 6e20 746f 2068 616e 646c 696e 6720 636f  n to handling co
-00002520: 6d6d 656e 7473 0a20 2020 2020 2020 2020  mments.         
-00002530: 2020 2069 6620 646f 5f6d 6174 6368 3a0a     if do_match:.
-00002540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002550: 6966 2069 736d 6174 6368 286c 696e 652c  if ismatch(line,
-00002560: 2070 726f 6729 3a0a 2020 2020 2020 2020   prog):.        
-00002570: 2020 2020 2020 2020 2020 2020 5f68 616e              _han
-00002580: 646c 655f 636f 6d6d 656e 7473 2863 6f6d  dle_comments(com
-00002590: 6d65 6e74 5f6c 6973 742c 2056 616c 7329  ment_list, Vals)
-000025a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000025b0: 2020 2020 2064 6f5f 6d61 7463 6820 3d20       do_match = 
-000025c0: 7969 656c 6420 6c69 6e65 0a20 2020 2020  yield line.     
-000025d0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-000025e0: 2020 2020 2020 2020 2020 2020 2064 6f5f               do_
-000025f0: 6d61 7463 6820 3d20 7969 656c 6420 6c69  match = yield li
-00002600: 6e65 0a20 2020 2020 2020 2020 2020 2020  ne.             
-00002610: 2020 2069 6620 646f 5f6d 6174 6368 3a0a     if do_match:.
-00002620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002630: 2020 2020 6966 2069 736d 6174 6368 286c      if ismatch(l
-00002640: 696e 652c 2070 726f 6729 3a0a 2020 2020  ine, prog):.    
-00002650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002660: 2020 2020 5f68 616e 646c 655f 636f 6d6d      _handle_comm
-00002670: 656e 7473 2863 6f6d 6d65 6e74 5f6c 6973  ents(comment_lis
-00002680: 742c 2056 616c 7329 0a20 2020 2020 2020  t, Vals).       
-00002690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000026a0: 2064 6f5f 6d61 7463 6820 3d20 7969 656c   do_match = yiel
-000026b0: 6420 6c69 6e65 0a0a 2020 2020 2020 2020  d line..        
-000026c0: 646f 5f6d 6174 6368 203d 2079 6965 6c64  do_match = yield
-000026d0: 204e 6f6e 6520 2023 206d 6172 6b20 7468   None  # mark th
-000026e0: 6520 656e 6420 6f66 2069 6e70 7574 0a20  e end of input. 
-000026f0: 2020 2020 2020 205f 6861 6e64 6c65 5f63         _handle_c
-00002700: 6f6d 6d65 6e74 7328 636f 6d6d 656e 745f  omments(comment_
-00002710: 6c69 7374 2c20 5661 6c73 290a 0a0a 6465  list, Vals)...de
-00002720: 6620 5f72 6466 6978 6564 2866 6974 6572  f _rdfixed(fiter
-00002730: 2c20 732c 206e 2c20 636f 6e63 6861 722c  , s, n, conchar,
-00002740: 2062 6c61 6e6b 2c20 746f 6c69 7374 2c20   blank, tolist, 
-00002750: 6b65 6570 5f6e 616d 6529 3a0a 2020 2020  keep_name):.    
-00002760: 2222 220a 2020 2020 5265 6164 2066 6978  """.    Read fix
-00002770: 6564 2066 6965 6c64 2063 6172 6473 3a0a  ed field cards:.
-00002780: 2020 2020 6669 7465 7220 3a20 6669 6c65      fiter : file
-00002790: 2069 7465 7261 746f 720a 2020 2020 7320   iterator.    s 
-000027a0: 3a20 7374 7269 6e67 2c20 6375 7272 656e  : string, curren
-000027b0: 7420 6c69 6e65 2066 726f 6d20 6669 6c65  t line from file
-000027c0: 2028 6361 7264 2073 7461 7274 290a 2020   (card start).  
-000027d0: 2020 6e20 3a20 6669 656c 6420 7769 6474    n : field widt
-000027e0: 682c 2038 206f 7220 3136 0a20 2020 2063  h, 8 or 16.    c
-000027f0: 6f6e 6368 6172 203a 2073 7472 696e 672c  onchar : string,
-00002800: 2073 6574 206f 6620 6368 6172 7320 7468   set of chars th
-00002810: 6174 206d 616b 6520 7570 2063 6f6e 7469  at make up conti
-00002820: 6e75 6174 696f 6e0a 2020 2020 2020 2020  nuation.        
-00002830: 2020 2020 2020 2d20 6569 7468 6572 2027        - either '
-00002840: 202b 2720 6f72 2027 2a27 0a20 2020 2062   +' or '*'.    b
-00002850: 6c61 6e6b 203a 2076 616c 7565 2074 6f20  lank : value to 
-00002860: 7573 6520 666f 7220 626c 616e 6b20 6669  use for blank fi
-00002870: 656c 6473 2061 6e64 2073 7472 696e 672d  elds and string-
-00002880: 7661 6c75 6564 2066 6965 6c64 730a 2020  valued fields.  
-00002890: 2020 746f 6c69 7374 203a 2069 6620 5472    tolist : if Tr
-000028a0: 7565 2c20 7265 7475 726e 206c 6973 742c  ue, return list,
-000028b0: 2065 6c73 6520 7265 7475 726e 206e 702e   else return np.
-000028c0: 6172 7261 793b 2073 7472 696e 6773 2061  array; strings a
-000028d0: 7265 0a20 2020 2020 2020 2020 2020 2020  re.             
-000028e0: 6b65 7074 2069 6e20 7468 6973 2063 6173  kept in this cas
-000028f0: 6520 2869 6e73 7465 6164 206f 6620 6265  e (instead of be
-00002900: 696e 6720 7475 726e 6564 2069 6e74 6f20  ing turned into 
-00002910: 6062 6c61 6e6b 6029 0a20 2020 206b 6565  `blank`).    kee
-00002920: 705f 6e61 6d65 203a 2069 6620 5472 7565  p_name : if True
-00002930: 2061 6e64 2074 6f6c 6973 7420 6973 2054   and tolist is T
-00002940: 7275 652c 206b 6565 7020 7468 6520 6361  rue, keep the ca
-00002950: 7264 206e 616d 6520 696e 2074 6865 0a20  rd name in the. 
-00002960: 2020 2020 2020 2020 2020 2020 2020 206f                 o
-00002970: 7574 7075 740a 2020 2020 2222 220a 2020  utput.    """.  
-00002980: 2020 7661 6c73 203d 205b 5d0a 2020 2020    vals = [].    
-00002990: 6c65 6e67 7468 203d 206c 656e 2873 290a  length = len(s).
-000029a0: 2020 2020 6920 3d20 2d31 0a20 2020 206e      i = -1.    n
-000029b0: 6669 656c 6473 203d 202d 310a 2020 2020  fields = -1.    
-000029c0: 6966 206e 203e 2038 3a0a 2020 2020 2020  if n > 8:.      
-000029d0: 2020 696e 6320 3d20 3420 2023 206e 756d    inc = 4  # num
-000029e0: 6265 7220 6f66 2076 616c 7565 7320 7065  ber of values pe
-000029f0: 7220 6c69 6e65 0a20 2020 2065 6c73 653a  r line.    else:
-00002a00: 0a20 2020 2020 2020 2069 6e63 203d 2038  .        inc = 8
-00002a10: 0a0a 2020 2020 7320 3d20 5f70 726f 635f  ..    s = _proc_
-00002a20: 6c69 6e65 2873 5b3a 3732 5d29 0a0a 2020  line(s[:72])..  
-00002a30: 2020 6966 2074 6f6c 6973 7420 616e 6420    if tolist and 
-00002a40: 6b65 6570 5f6e 616d 653a 0a20 2020 2020  keep_name:.     
-00002a50: 2020 2023 2072 6561 6420 6361 7264 206e     # read card n
-00002a60: 616d 6520 6f75 7473 6964 6520 6f66 206c  ame outside of l
-00002a70: 6f6f 703a 0a20 2020 2020 2020 2076 203d  oop:.        v =
-00002a80: 206e 6173 5f73 7363 616e 6628 735b 3a38   nas_sscanf(s[:8
-00002a90: 5d2c 2074 6f6c 6973 7429 0a20 2020 2020  ], tolist).     
-00002aa0: 2020 2076 616c 732e 6170 7065 6e64 2876     vals.append(v
-00002ab0: 290a 0a20 2020 206d 6178 7374 6172 7420  )..    maxstart 
-00002ac0: 3d20 3732 202d 206e 0a20 2020 2077 6869  = 72 - n.    whi
-00002ad0: 6c65 2031 3a0a 2020 2020 2020 2020 666f  le 1:.        fo
-00002ae0: 7220 6920 696e 2072 616e 6765 2869 2c20  r i in range(i, 
-00002af0: 6e66 6965 6c64 7329 3a0a 2020 2020 2020  nfields):.      
-00002b00: 2020 2020 2020 7661 6c73 2e61 7070 656e        vals.appen
-00002b10: 6428 626c 616e 6b29 0a20 2020 2020 2020  d(blank).       
-00002b20: 2069 203d 206e 6669 656c 6473 0a20 2020   i = nfields.   
-00002b30: 2020 2020 206a 203d 2038 0a20 2020 2020       j = 8.     
-00002b40: 2020 2077 6869 6c65 206a 203c 3d20 6d61     while j <= ma
-00002b50: 7873 7461 7274 2061 6e64 206c 656e 6774  xstart and lengt
-00002b60: 6820 3e20 6a3a 0a20 2020 2020 2020 2020  h > j:.         
-00002b70: 2020 2069 202b 3d20 310a 2020 2020 2020     i += 1.      
-00002b80: 2020 2020 2020 7620 3d20 6e61 735f 7373        v = nas_ss
-00002b90: 6361 6e66 2873 5b6a 203a 206a 202b 206e  canf(s[j : j + n
-00002ba0: 5d2c 2074 6f6c 6973 7429 0a20 2020 2020  ], tolist).     
-00002bb0: 2020 2020 2020 2069 6620 7620 6973 206e         if v is n
-00002bc0: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
-00002bd0: 2020 2020 2020 2020 2076 616c 732e 6170           vals.ap
-00002be0: 7065 6e64 2876 290a 2020 2020 2020 2020  pend(v).        
-00002bf0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00002c00: 2020 2020 2020 2020 2020 7661 6c73 2e61            vals.a
-00002c10: 7070 656e 6428 626c 616e 6b29 0a20 2020  ppend(blank).   
-00002c20: 2020 2020 2020 2020 206a 202b 3d20 6e0a           j += n.
-00002c30: 2020 2020 2020 2020 7320 3d20 6669 7465          s = fite
-00002c40: 722e 7365 6e64 2846 616c 7365 290a 2020  r.send(False).  
-00002c50: 2020 2020 2020 6966 2073 2069 7320 4e6f        if s is No
-00002c60: 6e65 206f 7220 6c65 6e28 7329 203d 3d20  ne or len(s) == 
-00002c70: 3020 6f72 2063 6f6e 6368 6172 2e66 696e  0 or conchar.fin
-00002c80: 6428 735b 305d 2920 3c20 303a 0a20 2020  d(s[0]) < 0:.   
-00002c90: 2020 2020 2020 2020 2062 7265 616b 0a20           break. 
-00002ca0: 2020 2020 2020 2073 203d 205f 7072 6f63         s = _proc
-00002cb0: 5f6c 696e 6528 735b 3a37 325d 290a 2020  _line(s[:72]).  
-00002cc0: 2020 2020 2020 6c65 6e67 7468 203d 206c        length = l
-00002cd0: 656e 2873 290a 2020 2020 2020 2020 6e66  en(s).        nf
-00002ce0: 6965 6c64 7320 2b3d 2069 6e63 0a20 2020  ields += inc.   
-00002cf0: 2072 6574 7572 6e20 7661 6c73 0a0a 0a64   return vals...d
-00002d00: 6566 205f 7264 636f 6d6d 6128 6669 7465  ef _rdcomma(fite
-00002d10: 722c 2073 2c20 636f 6e63 6861 722c 2062  r, s, conchar, b
-00002d20: 6c61 6e6b 2c20 746f 6c69 7374 2c20 6b65  lank, tolist, ke
-00002d30: 6570 5f6e 616d 6529 3a0a 2020 2020 2222  ep_name):.    ""
-00002d40: 220a 2020 2020 5265 6164 2063 6f6d 6d61  ".    Read comma
-00002d50: 2064 656c 696d 6974 6564 2063 6172 6473   delimited cards
-00002d60: 3a0a 2020 2020 6669 7465 7220 3a20 6669  :.    fiter : fi
-00002d70: 6c65 2069 7465 7261 746f 720a 2020 2020  le iterator.    
-00002d80: 7320 3a20 7374 7269 6e67 2c20 6375 7272  s : string, curr
-00002d90: 656e 7420 6c69 6e65 2066 726f 6d20 6669  ent line from fi
-00002da0: 6c65 2028 6361 7264 2073 7461 7274 290a  le (card start).
-00002db0: 2020 2020 6e20 3a20 6669 656c 6420 7769      n : field wi
-00002dc0: 6474 682c 2038 206f 7220 3136 0a20 2020  dth, 8 or 16.   
-00002dd0: 2063 6f6e 6368 6172 203a 2073 7472 696e   conchar : strin
-00002de0: 672c 2073 6574 206f 6620 6368 6172 7320  g, set of chars 
-00002df0: 7468 6174 206d 616b 6520 7570 2063 6f6e  that make up con
-00002e00: 7469 6e75 6174 696f 6e0a 2020 2020 2020  tinuation.      
-00002e10: 2020 2020 2020 2020 2d20 2720 2b2c 2027          - ' +, '
-00002e20: 0a20 2020 2062 6c61 6e6b 203a 2076 616c  .    blank : val
-00002e30: 7565 2074 6f20 7573 6520 666f 7220 626c  ue to use for bl
-00002e40: 616e 6b20 6669 656c 6473 2061 6e64 2073  ank fields and s
-00002e50: 7472 696e 672d 7661 6c75 6564 2066 6965  tring-valued fie
-00002e60: 6c64 730a 2020 2020 746f 6c69 7374 203a  lds.    tolist :
-00002e70: 2069 6620 5472 7565 2c20 7265 7475 726e   if True, return
-00002e80: 206c 6973 742c 2065 6c73 6520 7265 7475   list, else retu
-00002e90: 726e 206e 702e 6172 7261 793b 2073 7472  rn np.array; str
-00002ea0: 696e 6773 2061 7265 0a20 2020 2020 2020  ings are.       
-00002eb0: 2020 2020 2020 6b65 7074 2069 6e20 7468        kept in th
-00002ec0: 6973 2063 6173 6520 2869 6e73 7465 6164  is case (instead
-00002ed0: 206f 6620 6265 696e 6720 7475 726e 6564   of being turned
-00002ee0: 2069 6e74 6f20 6062 6c61 6e6b 6029 0a20   into `blank`). 
-00002ef0: 2020 206b 6565 705f 6e61 6d65 203a 2069     keep_name : i
-00002f00: 6620 5472 7565 2061 6e64 2074 6f6c 6973  f True and tolis
-00002f10: 7420 6973 2054 7275 652c 206b 6565 7020  t is True, keep 
-00002f20: 7468 6520 6361 7264 206e 616d 6520 696e  the card name in
-00002f30: 2074 6865 0a20 2020 2020 2020 2020 2020   the.           
-00002f40: 2020 2020 206f 7574 7075 740a 2020 2020       output.    
-00002f50: 2222 220a 2020 2020 7661 6c73 203d 205b  """.    vals = [
-00002f60: 5d0a 2020 2020 6920 3d20 2d31 0a20 2020  ].    i = -1.   
-00002f70: 206e 6669 656c 6473 203d 202d 310a 2020   nfields = -1.  
-00002f80: 2020 696e 6320 3d20 380a 2020 2020 7374    inc = 8.    st
-00002f90: 6172 745f 6669 656c 6420 3d20 3020 6966  art_field = 0 if
-00002fa0: 2028 746f 6c69 7374 2061 6e64 206b 6565   (tolist and kee
-00002fb0: 705f 6e61 6d65 2920 656c 7365 2031 0a20  p_name) else 1. 
-00002fc0: 2020 2073 203d 205f 7072 6f63 5f6c 696e     s = _proc_lin
-00002fd0: 6528 7329 0a20 2020 2077 6869 6c65 2031  e(s).    while 1
-00002fe0: 3a0a 2020 2020 2020 2020 666f 7220 6920  :.        for i 
-00002ff0: 696e 2072 616e 6765 2869 2c20 6e66 6965  in range(i, nfie
-00003000: 6c64 7329 3a0a 2020 2020 2020 2020 2020  lds):.          
-00003010: 2020 7661 6c73 2e61 7070 656e 6428 626c    vals.append(bl
-00003020: 616e 6b29 0a20 2020 2020 2020 2069 203d  ank).        i =
-00003030: 206e 6669 656c 6473 0a20 2020 2020 2020   nfields.       
-00003040: 2074 6f6b 203d 2073 2e73 706c 6974 2822   tok = s.split("
-00003050: 2c22 290a 2020 2020 2020 2020 6c65 6e74  ,").        lent
-00003060: 6f6b 203d 206d 696e 286c 656e 2874 6f6b  ok = min(len(tok
-00003070: 292c 2039 290a 2020 2020 2020 2020 666f  ), 9).        fo
-00003080: 7220 6a20 696e 2072 616e 6765 2873 7461  r j in range(sta
-00003090: 7274 5f66 6965 6c64 2c20 6c65 6e74 6f6b  rt_field, lentok
-000030a0: 293a 0a20 2020 2020 2020 2020 2020 2069  ):.            i
-000030b0: 202b 3d20 310a 2020 2020 2020 2020 2020   += 1.          
-000030c0: 2020 7620 3d20 6e61 735f 7373 6361 6e66    v = nas_sscanf
-000030d0: 2874 6f6b 5b6a 5d2c 2074 6f6c 6973 7429  (tok[j], tolist)
-000030e0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-000030f0: 7620 6973 206e 6f74 204e 6f6e 653a 0a20  v is not None:. 
-00003100: 2020 2020 2020 2020 2020 2020 2020 2076                 v
-00003110: 616c 732e 6170 7065 6e64 2876 290a 2020  als.append(v).  
-00003120: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-00003130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003140: 7661 6c73 2e61 7070 656e 6428 626c 616e  vals.append(blan
-00003150: 6b29 0a20 2020 2020 2020 2023 2066 6972  k).        # fir
-00003160: 7374 2066 6965 6c64 2066 6f72 2063 6f6e  st field for con
-00003170: 7469 6e75 6174 696f 6e20 6361 7264 7320  tinuation cards 
-00003180: 7769 6c6c 206e 6576 6572 2062 6520 7265  will never be re
-00003190: 7461 696e 6564 3a0a 2020 2020 2020 2020  tained:.        
-000031a0: 7374 6172 745f 6669 656c 6420 3d20 310a  start_field = 1.
-000031b0: 2020 2020 2020 2020 7320 3d20 6669 7465          s = fite
-000031c0: 722e 7365 6e64 2846 616c 7365 290a 2020  r.send(False).  
-000031d0: 2020 2020 2020 6966 2073 2069 7320 4e6f        if s is No
-000031e0: 6e65 206f 7220 6c65 6e28 7329 203d 3d20  ne or len(s) == 
-000031f0: 3020 6f72 2063 6f6e 6368 6172 2e66 696e  0 or conchar.fin
-00003200: 6428 735b 305d 2920 3c20 303a 0a20 2020  d(s[0]) < 0:.   
-00003210: 2020 2020 2020 2020 2062 7265 616b 0a20           break. 
-00003220: 2020 2020 2020 2073 203d 205f 7072 6f63         s = _proc
-00003230: 5f6c 696e 6528 7329 0a20 2020 2020 2020  _line(s).       
-00003240: 206e 6669 656c 6473 202b 3d20 696e 630a   nfields += inc.
-00003250: 2020 2020 7265 7475 726e 2076 616c 730a      return vals.
-00003260: 0a0a 4067 7569 746f 6f6c 732e 7265 6164  ..@guitools.read
-00003270: 5f74 6578 745f 6669 6c65 0a64 6566 2072  _text_file.def r
-00003280: 6463 6172 6473 280a 2020 2020 662c 0a20  dcards(.    f,. 
-00003290: 2020 206e 616d 652c 0a20 2020 2062 6c61     name,.    bla
-000032a0: 6e6b 3d4e 6f6e 652c 0a20 2020 2072 6574  nk=None,.    ret
-000032b0: 7572 6e5f 7661 723d 2261 7272 6179 222c  urn_var="array",
-000032c0: 0a20 2020 2064 7479 7065 3d66 6c6f 6174  .    dtype=float
-000032d0: 2c0a 2020 2020 6e6f 5f64 6174 615f 7265  ,.    no_data_re
-000032e0: 7475 726e 3d4e 6f6e 652c 0a20 2020 2072  turn=None,.    r
-000032f0: 6567 6578 3d46 616c 7365 2c0a 2020 2020  egex=False,.    
-00003300: 6b65 6570 5f6e 616d 653d 4661 6c73 652c  keep_name=False,
-00003310: 0a20 2020 206b 6565 705f 636f 6d6d 656e  .    keep_commen
-00003320: 7473 3d46 616c 7365 2c0a 293a 0a20 2020  ts=False,.):.   
-00003330: 2072 2222 220a 2020 2020 5265 6164 204e   r""".    Read N
-00003340: 6173 7472 616e 2063 6172 6473 2028 6c69  astran cards (li
-00003350: 6e65 7329 2069 6e74 6f20 6120 6d61 7472  nes) into a matr
-00003360: 6978 2c20 6469 6374 696f 6e61 7279 2c20  ix, dictionary, 
-00003370: 6f72 206c 6973 742e 0a0a 2020 2020 5061  or list...    Pa
-00003380: 7261 6d65 7465 7273 0a20 2020 202d 2d2d  rameters.    ---
-00003390: 2d2d 2d2d 2d2d 2d0a 2020 2020 6620 3a20  -------.    f : 
-000033a0: 7374 7269 6e67 206f 7220 6669 6c65 5f6c  string or file_l
-000033b0: 696b 6520 6f72 204e 6f6e 650a 2020 2020  ike or None.    
-000033c0: 2020 2020 4569 7468 6572 2061 206e 616d      Either a nam
-000033d0: 6520 6f66 2061 2066 696c 652c 206f 7220  e of a file, or 
-000033e0: 6973 2061 2066 696c 655f 6c69 6b65 206f  is a file_like o
-000033f0: 626a 6563 7420 6173 2072 6574 7572 6e65  bject as returne
-00003400: 640a 2020 2020 2020 2020 6279 203a 6675  d.        by :fu
-00003410: 6e63 3a60 6f70 656e 602e 2049 6620 6669  nc:`open`. If fi
-00003420: 6c65 5f6c 696b 6520 6f62 6a65 6374 2c20  le_like object, 
-00003430: 6974 2069 7320 7265 776f 756e 6420 6669  it is rewound fi
-00003440: 7273 742e 2043 616e 0a20 2020 2020 2020  rst. Can.       
-00003450: 2061 6c73 6f20 6265 2074 6865 206e 616d   also be the nam
-00003460: 6520 6f66 2061 2064 6972 6563 746f 7279  e of a directory
-00003470: 206f 7220 4e6f 6e65 3b20 696e 2074 6865   or None; in the
-00003480: 7365 2063 6173 6573 2c20 6120 4755 490a  se cases, a GUI.
-00003490: 2020 2020 2020 2020 6973 206f 7065 6e65          is opene
-000034a0: 6420 666f 7220 6669 6c65 2073 656c 6563  d for file selec
-000034b0: 7469 6f6e 2e0a 2020 2020 6e61 6d65 203a  tion..    name :
-000034c0: 2073 7472 696e 670a 2020 2020 2020 2020   string.        
-000034d0: 5573 7561 6c6c 7920 7468 6520 6361 7264  Usually the card
-000034e0: 206e 616d 652c 2062 7574 2069 7320 7265   name, but is re
-000034f0: 616c 6c79 206a 7573 7420 7468 6520 696e  ally just the in
-00003500: 6974 6961 6c20 7061 7274 206f 660a 2020  itial part of.  
-00003510: 2020 2020 2020 7468 6520 7374 7269 6e67        the string
-00003520: 2074 6f20 6c6f 6f6b 2066 6f72 2e20 5468   to look for. Th
-00003530: 6973 206d 6561 6e73 2074 6861 7420 606e  is means that `n
-00003540: 616d 6560 2063 616e 2073 7061 6e20 6d6f  ame` can span mo
-00003550: 7265 0a20 2020 2020 2020 2074 6861 6e20  re.        than 
-00003560: 6f6e 6520 6669 656c 642c 2069 6e20 6361  one field, in ca
-00003570: 7365 2074 6861 7420 6973 2068 616e 6479  se that is handy
-00003580: 2e20 4974 2063 616e 2061 6c73 6f20 6265  . It can also be
-00003590: 2061 0a20 2020 2020 2020 2072 6567 756c   a.        regul
-000035a0: 6172 2065 7870 7265 7373 696f 6e20 6966  ar expression if
-000035b0: 2074 6865 2060 7265 6765 7860 206f 7074   the `regex` opt
-000035c0: 696f 6e20 6973 2073 6574 2074 6f20 5472  ion is set to Tr
-000035d0: 7565 2e20 5468 6973 0a20 2020 2020 2020  ue. This.       
-000035e0: 2072 6f75 7469 6e65 2069 7320 6361 7365   routine is case
-000035f0: 2069 6e73 656e 7369 7469 7665 3a20 6966   insensitive: if
-00003600: 2060 7265 6765 7860 2069 7320 4661 6c73   `regex` is Fals
-00003610: 652c 2060 6e61 6d65 6020 6973 0a20 2020  e, `name` is.   
-00003620: 2020 2020 2063 6f6e 7665 7274 6564 2074       converted t
-00003630: 6f20 6c6f 7765 7220 6361 7365 2061 7320  o lower case as 
-00003640: 6172 6520 7468 6520 6c69 6e65 7320 7468  are the lines th
-00003650: 6174 2061 7265 2072 6561 6420 696e 2066  at are read in f
-00003660: 726f 6d0a 2020 2020 2020 2020 7468 6520  rom.        the 
-00003670: 6669 6c65 3b20 6966 2060 7265 6765 7860  file; if `regex`
-00003680: 2069 7320 5472 7565 2c20 7468 6520 6060   is True, the ``
-00003690: 7265 2e49 474e 4f52 4543 4153 4560 6020  re.IGNORECASE`` 
-000036a0: 6f70 7469 6f6e 2069 730a 2020 2020 2020  option is.      
-000036b0: 2020 7573 6564 2e0a 2020 2020 626c 616e    used..    blan
-000036c0: 6b20 3a20 4e6f 6e65 2c20 7363 616c 6172  k : None, scalar
-000036d0: 206f 7220 7374 7269 6e67 3b20 6f70 7469   or string; opti
-000036e0: 6f6e 616c 0a20 2020 2020 2020 2049 6620  onal.        If 
-000036f0: 7265 6164 696e 6720 696e 746f 2061 6e20  reading into an 
-00003700: 6172 7261 7920 6f72 2064 6963 7469 6f6e  array or diction
-00003710: 6172 7920 2873 6565 2060 7265 7475 726e  ary (see `return
-00003720: 5f76 6172 6029 2c0a 2020 2020 2020 2020  _var`),.        
-00003730: 6062 6c61 6e6b 6020 6973 2065 7870 6563  `blank` is expec
-00003740: 7465 6420 746f 2062 6520 6120 6e75 6d65  ted to be a nume
-00003750: 7269 6320 7661 6c75 6520 746f 2075 7365  ric value to use
-00003760: 2066 6f72 2062 6c61 6e6b 0a20 2020 2020   for blank.     
-00003770: 2020 2066 6965 6c64 7320 616e 6420 7374     fields and st
-00003780: 7269 6e67 2d76 616c 7565 6420 6669 656c  ring-valued fiel
-00003790: 6473 2e20 4966 2072 6561 6469 6e67 2069  ds. If reading i
-000037a0: 6e74 6f20 6120 6c69 7374 2c20 6974 0a20  nto a list, it. 
-000037b0: 2020 2020 2020 2063 616e 2061 6c73 6f20         can also 
-000037c0: 6265 2061 2073 7472 696e 6720 286c 696b  be a string (lik
-000037d0: 6520 6060 2222 6060 292e 2049 6620 4e6f  e ``""``). If No
-000037e0: 6e65 2028 7468 6520 6465 6661 756c 7429  ne (the default)
-000037f0: 2c20 6974 0a20 2020 2020 2020 2069 7320  , it.        is 
-00003800: 696e 7465 726e 616c 6c79 2072 6573 6574  internally reset
-00003810: 2074 6f20 6060 2222 6060 2069 6620 6072   to ``""`` if `r
-00003820: 6574 7572 6e5f 7661 7260 2069 7320 6060  eturn_var` is ``
-00003830: 226c 6973 7422 6060 0a20 2020 2020 2020  "list"``.       
-00003840: 2061 6e64 2074 6f20 6060 3060 6020 6f74   and to ``0`` ot
-00003850: 6865 7277 6973 652e 0a20 2020 2072 6574  herwise..    ret
-00003860: 7572 6e5f 7661 7220 3a20 7374 7269 6e67  urn_var : string
-00003870: 3b20 6f70 7469 6f6e 616c 0a20 2020 2020  ; optional.     
-00003880: 2020 2053 7065 6369 6669 6573 2077 6869     Specifies whi
-00003890: 6368 2064 6174 6120 7374 7275 6374 7572  ch data structur
-000038a0: 6520 746f 2075 7365 2066 6f72 2074 6865  e to use for the
-000038b0: 2064 6174 613a 0a0a 2020 2020 2020 2020   data:..        
-000038c0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 2020 203d  ============   =
-000038d0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-000038e0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-000038f0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d0a 2020 2020  ===========.    
-00003900: 2020 2020 6072 6574 7572 6e5f 7661 7260      `return_var`
-00003910: 2020 2052 6f75 7469 6e65 2072 6574 7572     Routine retur
-00003920: 6e73 0a20 2020 2020 2020 203d 3d3d 3d3d  ns.        =====
-00003930: 3d3d 3d3d 3d3d 3d20 2020 3d3d 3d3d 3d3d  =======   ======
-00003940: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00003950: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00003960: 3d3d 3d3d 3d3d 0a20 2020 2020 2020 2020  ======.         
-00003970: 2027 6172 7261 7927 2020 2020 2020 6120   'array'      a 
-00003980: 6e75 6d70 7920 6e64 6172 7261 7920 6f66  numpy ndarray of
-00003990: 2074 7970 6520 6064 7479 7065 603b 206e   type `dtype`; n
-000039a0: 6f6e 2d6e 756d 6572 6963 0a20 2020 2020  on-numeric.     
-000039b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000039c0: 2020 6669 656c 6473 2061 7265 2073 6574    fields are set
-000039d0: 2074 6f20 6062 6c61 6e6b 600a 2020 2020   to `blank`.    
-000039e0: 2020 2020 2020 276c 6973 7427 2020 2020        'list'    
-000039f0: 2020 2061 206c 6973 7420 6f66 206c 6973     a list of lis
-00003a00: 7473 3b20 7468 6973 2069 7320 7468 6520  ts; this is the 
-00003a10: 2274 7275 6573 7422 2072 6561 6465 720a  "truest" reader.
-00003a20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003a30: 2020 2020 2020 2073 696e 6365 2073 7472         since str
-00003a40: 696e 6720 6669 656c 6473 2061 7265 2072  ing fields are r
-00003a50: 6574 6169 6e65 6420 616e 6420 6f6e 6c79  etained and only
-00003a60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00003a70: 2020 2020 2020 2020 626c 616e 6b20 6669          blank fi
-00003a80: 656c 6473 2061 7265 2073 6574 2074 6f20  elds are set to 
-00003a90: 6062 6c61 6e6b 600a 2020 2020 2020 2020  `blank`.        
-00003aa0: 2020 2764 6963 7427 2020 2020 2020 2061    'dict'       a
-00003ab0: 2064 6963 7469 6f6e 6172 793b 2065 6163   dictionary; eac
-00003ac0: 6820 6361 7264 2062 6563 6f6d 6573 2061  h card becomes a
-00003ad0: 2064 6963 7469 6f6e 6172 790a 2020 2020   dictionary.    
-00003ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003af0: 2020 2065 6e74 7279 3a20 7468 6520 7661     entry: the va
-00003b00: 6c75 6520 6973 2061 206e 756d 7079 206e  lue is a numpy n
-00003b10: 6461 7272 6179 206f 6620 7479 7065 0a20  darray of type. 
-00003b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003b30: 2020 2020 2020 6064 7479 7065 6020 616e        `dtype` an
-00003b40: 6420 7468 6520 6b65 7920 6973 2074 6865  d the key is the
-00003b50: 2066 6972 7374 2065 6c65 6d65 6e74 206f   first element o
-00003b60: 660a 2020 2020 2020 2020 2020 2020 2020  f.              
-00003b70: 2020 2020 2020 2020 2074 6861 7420 6e64           that nd
-00003b80: 6172 7261 7920 2862 7574 2062 6566 6f72  array (but befor
-00003b90: 6520 636f 6e76 6572 7469 6e67 2074 6f0a  e converting to.
-00003ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003bb0: 2020 2020 2020 2060 6474 7970 6560 290a         `dtype`).
-00003bc0: 2020 2020 2020 2020 3d3d 3d3d 3d3d 3d3d          ========
-00003bd0: 3d3d 3d3d 2020 203d 3d3d 3d3d 3d3d 3d3d  ====   =========
-00003be0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00003bf0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00003c00: 3d3d 3d0a 0a20 2020 2064 7479 7065 203a  ===..    dtype :
-00003c10: 2064 6174 612d 7479 7065 3b20 6f70 7469   data-type; opti
-00003c20: 6f6e 616c 0a20 2020 2020 2020 2054 6865  onal.        The
-00003c30: 2064 6573 6972 6564 2061 7272 6179 2064   desired array d
-00003c40: 6174 612d 7479 7065 2066 6f72 2074 6865  ata-type for the
-00003c50: 2027 6172 7261 7927 206f 7220 2764 6963   'array' or 'dic
-00003c60: 7427 206f 7574 7075 740a 2020 2020 2020  t' output.      
-00003c70: 2020 6f70 7469 6f6e 732e 0a20 2020 206e    options..    n
-00003c80: 6f5f 6461 7461 5f72 6574 7572 6e20 3a20  o_data_return : 
-00003c90: 616e 7920 7661 7269 6162 6c65 3b20 6f70  any variable; op
-00003ca0: 7469 6f6e 616c 0a20 2020 2020 2020 2049  tional.        I
-00003cb0: 6620 6e6f 2064 6174 6120 6973 2066 6f75  f no data is fou
-00003cc0: 6e64 2c20 7468 6973 2072 6f75 7469 6e65  nd, this routine
-00003cd0: 2072 6574 7572 6e73 2060 6e6f 5f64 6174   returns `no_dat
-00003ce0: 615f 7265 7475 726e 602e 0a20 2020 2072  a_return`..    r
-00003cf0: 6567 6578 203a 2062 6f6f 6c3b 206f 7074  egex : bool; opt
-00003d00: 696f 6e61 6c0a 2020 2020 2020 2020 4966  ional.        If
-00003d10: 2073 6574 2074 6f20 5472 7565 2c20 5573   set to True, Us
-00003d20: 6520 7265 6775 6c61 7220 6578 7072 6573  e regular expres
-00003d30: 7369 6f6e 206d 6174 6368 696e 6720 696e  sion matching in
-00003d40: 7374 6561 6420 6f66 0a20 2020 2020 2020  stead of.       
-00003d50: 206c 6974 6572 616c 2073 7472 696e 6720   literal string 
-00003d60: 6d61 7463 6869 6e67 2e0a 2020 2020 6b65  matching..    ke
-00003d70: 6570 5f6e 616d 6520 3a20 626f 6f6c 3b20  ep_name : bool; 
-00003d80: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
-00003d90: 2049 6620 7265 6164 696e 6720 696e 746f   If reading into
-00003da0: 2061 206c 6973 742c 2060 6b65 6570 5f6e   a list, `keep_n
-00003db0: 616d 6560 2063 616e 2062 6520 7365 7420  ame` can be set 
-00003dc0: 746f 2054 7275 6520 746f 0a20 2020 2020  to True to.     
-00003dd0: 2020 2072 6574 6169 6e20 7468 6520 6361     retain the ca
-00003de0: 7264 206e 616d 6520 696e 2074 6865 206f  rd name in the o
-00003df0: 7574 7075 742e 2054 6869 7320 6f70 7469  utput. This opti
-00003e00: 6f6e 2069 7320 6967 6e6f 7265 6420 6966  on is ignored if
-00003e10: 0a20 2020 2020 2020 206e 6f74 2072 6561  .        not rea
-00003e20: 6469 6e67 2069 6e74 6f20 6120 6c69 7374  ding into a list
-00003e30: 2e0a 2020 2020 6b65 6570 5f63 6f6d 6d65  ..    keep_comme
-00003e40: 6e74 7320 3a20 626f 6f6c 3b20 6f70 7469  nts : bool; opti
-00003e50: 6f6e 616c 0a20 2020 2020 2020 2049 6620  onal.        If 
-00003e60: 7265 6164 696e 6720 696e 746f 2061 206c  reading into a l
-00003e70: 6973 742c 2060 6b65 6570 5f63 6f6d 6d65  ist, `keep_comme
-00003e80: 6e74 7360 2063 616e 2062 6520 7365 7420  nts` can be set 
-00003e90: 746f 2054 7275 6520 746f 0a20 2020 2020  to True to.     
-00003ea0: 2020 2072 6574 6169 6e20 616c 6c20 636f     retain all co
-00003eb0: 6d6d 656e 7420 6361 7264 7320 696e 2074  mment cards in t
-00003ec0: 6865 206f 7574 7075 742e 2054 6869 7320  he output. This 
-00003ed0: 6f70 7469 6f6e 2069 7320 6967 6e6f 7265  option is ignore
-00003ee0: 640a 2020 2020 2020 2020 6966 206e 6f74  d.        if not
-00003ef0: 2072 6561 6469 6e67 2069 6e74 6f20 6120   reading into a 
-00003f00: 6c69 7374 2e20 4e6f 7465 2074 6861 7420  list. Note that 
-00003f10: 6f6e 6c79 2074 6865 2063 6f6d 6d65 6e74  only the comment
-00003f20: 7320 7468 6174 0a20 2020 2020 2020 2073  s that.        s
-00003f30: 7461 7274 2061 7420 7468 6520 6265 6769  tart at the begi
-00003f40: 6e6e 696e 6720 6f66 2074 6865 206c 696e  nning of the lin
-00003f50: 6520 6172 6520 7265 7461 696e 6564 2e0a  e are retained..
-00003f60: 0a20 2020 2052 6574 7572 6e73 0a20 2020  .    Returns.   
-00003f70: 202d 2d2d 2d2d 2d2d 0a20 2020 2063 6172   -------.    car
-00003f80: 6473 203a 206e 6461 7272 6179 206f 7220  ds : ndarray or 
-00003f90: 6c69 7374 206f 7220 6469 6374 696f 6e61  list or dictiona
-00003fa0: 7279 206f 7220 6e6f 5f64 6174 615f 7265  ry or no_data_re
-00003fb0: 7475 726e 0a0a 2020 2020 2020 2020 2d20  turn..        - 
-00003fc0: 4966 2061 6e20 6e64 6172 7261 7920 6973  If an ndarray is
-00003fd0: 2072 6574 7572 6e65 642c 2065 6163 6820   returned, each 
-00003fe0: 726f 7720 6973 2061 2063 6172 642c 2070  row is a card, p
-00003ff0: 6164 6465 6420 7769 7468 0a20 2020 2020  added with.     
-00004000: 2020 2020 2062 6c61 6e6b 7320 6173 206e       blanks as n
-00004010: 6563 6573 7361 7279 2e0a 2020 2020 2020  ecessary..      
-00004020: 2020 2d20 4966 2061 206c 6973 7420 286f    - If a list (o
-00004030: 6620 6c69 7374 7329 2069 7320 7265 7475  f lists) is retu
-00004040: 726e 6564 2c20 6561 6368 2069 7465 6d20  rned, each item 
-00004050: 6973 2061 2063 6172 6420 616e 6420 6973  is a card and is
-00004060: 0a20 2020 2020 2020 2020 2061 206c 6973  .          a lis
-00004070: 7420 6f66 2076 616c 7565 7320 6672 6f6d  t of values from
-00004080: 2074 6865 2063 6172 642c 2074 6865 206c   the card, the l
-00004090: 656e 6774 6820 6f66 2077 6869 6368 2069  ength of which i
-000040a0: 7320 7468 650a 2020 2020 2020 2020 2020  s the.          
-000040b0: 6e75 6d62 6572 206f 6620 6974 656d 7320  number of items 
-000040c0: 6f6e 2074 6865 2063 6172 642e 0a20 2020  on the card..   
-000040d0: 2020 2020 202d 2049 6620 6120 6469 6374       - If a dict
-000040e0: 696f 6e61 7279 2069 7320 7265 7475 726e  ionary is return
-000040f0: 6564 2c20 7468 6520 6669 7273 7420 6e75  ed, the first nu
-00004100: 6d62 6572 2066 726f 6d20 6561 6368 2063  mber from each c
-00004110: 6172 640a 2020 2020 2020 2020 2020 6973  ard.          is
-00004120: 2075 7365 6420 6173 2074 6865 206b 6579   used as the key
-00004130: 2061 6e64 2074 6865 2076 616c 7565 2061   and the value a
-00004140: 7265 2061 6c6c 2074 6865 206e 756d 6265  re all the numbe
-00004150: 7273 2066 726f 6d0a 2020 2020 2020 2020  rs from.        
-00004160: 2020 7468 6520 6361 7264 2069 6e20 6120    the card in a 
-00004170: 726f 7720 7665 6374 6f72 2028 696e 636c  row vector (incl
-00004180: 7564 696e 6720 7468 6520 6669 7273 7420  uding the first 
-00004190: 7661 6c75 6529 2e0a 2020 2020 2020 2020  value)..        
-000041a0: 2d20 606e 6f5f 6461 7461 5f72 6574 7572  - `no_data_retur
-000041b0: 6e60 2069 7320 7265 7475 726e 6564 2069  n` is returned i
-000041c0: 6620 6e6f 2063 6172 6473 206f 6620 7265  f no cards of re
-000041d0: 7175 6573 7465 6420 6e61 6d65 0a20 2020  quested name.   
-000041e0: 2020 2020 2020 2077 6572 6520 666f 756e         were foun
-000041f0: 642e 0a0a 2020 2020 4e6f 7465 730a 2020  d...    Notes.  
-00004200: 2020 2d2d 2d2d 2d0a 2020 2020 5468 6973    -----.    This
-00004210: 2072 6f75 7469 6e65 2063 616e 2072 6561   routine can rea
-00004220: 6420 6669 7865 6420 6669 656c 6420 2838  d fixed field (8
-00004230: 206f 7220 3136 2063 6861 7273 2077 6964   or 16 chars wid
-00004240: 6529 206f 720a 2020 2020 636f 6d6d 612d  e) or.    comma-
-00004250: 6465 6c69 6d69 7465 6420 616e 6420 6361  delimited and ca
-00004260: 6e20 6861 6e64 6c65 2061 6e79 206e 756d  n handle any num
-00004270: 6265 7220 6f66 2063 6f6e 7469 6e75 6174  ber of continuat
-00004280: 696f 6e73 2e20 4e6f 7465 0a20 2020 2074  ions. Note.    t
-00004290: 6861 7420 7468 6520 6368 6172 6163 7465  hat the characte
-000042a0: 7273 2069 6e20 7468 6520 636f 6e74 696e  rs in the contin
-000042b0: 7561 7469 6f6e 2066 6965 6c64 7320 6172  uation fields ar
-000042c0: 6520 6967 6e6f 7265 642e 2049 740a 2020  e ignored. It.  
-000042d0: 2020 616c 736f 2075 7365 7320 3a66 756e    also uses :fun
-000042e0: 633a 606e 6173 5f73 7363 616e 6660 2074  c:`nas_sscanf` t
-000042f0: 6f20 7265 6164 2074 6865 206e 756d 6265  o read the numbe
-00004300: 7273 2c20 736f 206e 756d 6265 7273 206c  rs, so numbers l
-00004310: 696b 650a 2020 2020 312e 2d33 2028 7768  ike.    1.-3 (wh
-00004320: 6963 6820 6d65 616e 7320 312e 652d 3329  ich means 1.e-3)
-00004330: 2061 7265 206f 6b61 792e 2042 6c61 6e6b   are okay. Blank
-00004340: 2066 6965 6c64 7320 616e 6420 7374 7269   fields and stri
-00004350: 6e67 2066 6965 6c64 730a 2020 2020 6172  ng fields.    ar
-00004360: 6520 7365 7420 746f 2060 626c 616e 6b60  e set to `blank`
-00004370: 2c20 6578 6365 7074 2077 6865 6e20 6072  , except when `r
-00004380: 6574 7572 6e5f 7661 7260 2069 7320 276c  eturn_var` is 'l
-00004390: 6973 7427 3b20 696e 2074 6861 740a 2020  ist'; in that.  
-000043a0: 2020 6361 7365 2c20 7374 7269 6e67 2066    case, string f
-000043b0: 6965 6c64 7320 6172 6520 6b65 7074 2061  ields are kept a
-000043c0: 7320 6973 2061 6e64 206f 6e6c 7920 626c  s is and only bl
-000043d0: 616e 6b20 6669 656c 6473 2061 7265 2073  ank fields are s
-000043e0: 6574 0a20 2020 2074 6f20 6062 6c61 6e6b  et.    to `blank
-000043f0: 602e 0a0a 2020 2020 4e6f 7465 3a20 7468  `...    Note: th
-00004400: 6973 2072 6f75 7469 6e65 2068 6173 206e  is routine has n
-00004410: 6f20 6b6e 6f77 6c65 6467 6520 6f66 2061  o knowledge of a
-00004420: 6e79 2063 6172 642c 2077 6869 6368 206d  ny card, which m
-00004430: 6561 6e73 0a20 2020 2074 6861 7420 6974  eans.    that it
-00004440: 2077 696c 6c20 6e6f 7420 6170 7065 6e64   will not append
-00004450: 2074 7261 696c 696e 6720 626c 616e 6b73   trailing blanks
-00004460: 2074 6f20 6120 6361 7264 2e20 466f 7220   to a card. For 
-00004470: 6578 616d 706c 652c 2069 660a 2020 2020  example, if.    
-00004480: 6120 4752 4944 2063 6172 6420 6973 3a20  a GRID card is: 
-00004490: 2747 5249 442c 2031 272c 2074 6865 6e20  'GRID, 1', then 
-000044a0: 7468 6973 2072 6f75 7469 6e65 2077 6f75  this routine wou
-000044b0: 6c64 2072 6574 7572 6e20 6060 5b31 5d60  ld return ``[1]`
-000044c0: 602c 0a20 2020 206e 6f74 2060 605b 312c  `,.    not ``[1,
-000044d0: 2030 2c20 302c 2030 2c20 302c 2030 2c20   0, 0, 0, 0, 0, 
-000044e0: 302c 2030 5d60 602e 2054 6865 203a 6675  0, 0]``. The :fu
-000044f0: 6e63 3a60 7264 6772 6964 7360 2072 6f75  nc:`rdgrids` rou
-00004500: 7469 6e65 0a20 2020 2077 6f75 6c64 2072  tine.    would r
-00004510: 6574 7572 6e20 6060 5b31 2c20 302c 2030  eturn ``[1, 0, 0
-00004520: 2c20 302c 2030 2c20 302c 2030 2c20 305d  , 0, 0, 0, 0, 0]
-00004530: 6060 2073 696e 6365 2069 7420 6b6e 6f77  `` since it know
-00004540: 7320 7468 650a 2020 2020 6e75 6d62 6572  s the.    number
-00004550: 206f 6620 6669 656c 6473 2061 2047 5249   of fields a GRI
-00004560: 4420 6361 7264 2068 6173 2e0a 0a20 2020  D card has...   
-00004570: 2045 7861 6d70 6c65 730a 2020 2020 2d2d   Examples.    --
-00004580: 2d2d 2d2d 2d2d 0a20 2020 2043 7265 6174  ------.    Creat
-00004590: 6520 736f 6d65 2062 756c 6b20 6461 7461  e some bulk data
-000045a0: 2074 6f20 7265 6164 2028 6e6f 7420 6e65   to read (not ne
-000045b0: 6365 7373 6172 696c 7920 7661 6c69 6429  cessarily valid)
-000045c0: 3a0a 0a20 2020 203e 3e3e 2066 726f 6d20  :..    >>> from 
-000045d0: 696f 2069 6d70 6f72 7420 5374 7269 6e67  io import String
-000045e0: 494f 0a20 2020 203e 3e3e 2066 726f 6d20  IO.    >>> from 
-000045f0: 7079 7965 7469 2e6e 6173 7472 616e 2069  pyyeti.nastran i
-00004600: 6d70 6f72 7420 6275 6c6b 0a20 2020 203e  mport bulk.    >
-00004610: 3e3e 2066 7320 3d20 5374 7269 6e67 494f  >> fs = StringIO
-00004620: 2827 2727 0a20 2020 202e 2e2e 2044 5449  ('''.    ... DTI
-00004630: 2020 2020 2053 454c 4f41 4420 2020 2020       SELOAD     
-00004640: 2020 2020 3120 2020 2020 2020 320a 2020      1       2.  
-00004650: 2020 2e2e 2e20 6474 6920 2020 2020 7365    ... dti     se
-00004660: 6c6f 6164 2020 2020 2020 2020 2033 2020  load         3  
-00004670: 2020 2020 2034 0a20 2020 202e 2e2e 2024       4.    ... $
-00004680: 2061 2063 6f6d 6d65 6e74 2066 6f72 2074   a comment for t
-00004690: 6573 7469 6e67 0a20 2020 202e 2e2e 2064  esting.    ... d
-000046a0: 7469 2c73 656c 6f61 642c 352c 360a 2020  ti,seload,5,6.  
-000046b0: 2020 2e2e 2e20 4454 492c 2053 454c 4f41    ... DTI, SELOA
-000046c0: 442c 202c 2038 2e30 2c20 2761 270a 2020  D, , 8.0, 'a'.  
-000046d0: 2020 2e2e 2e20 4454 492c 5345 5452 4545    ... DTI,SETREE
-000046e0: 2c31 3030 2c30 0a20 2020 202e 2e2e 2027  ,100,0.    ... '
-000046f0: 2727 290a 0a20 2020 2052 6561 6420 616c  '')..    Read al
-00004700: 6c20 7468 6520 4454 4920 6361 7264 7320  l the DTI cards 
-00004710: 746f 2061 206c 6973 743a 0a0a 2020 2020  to a list:..    
-00004720: 3e3e 3e20 6c73 7420 3d20 6275 6c6b 2e72  >>> lst = bulk.r
-00004730: 6463 6172 6473 2866 732c 2027 6474 6927  dcards(fs, 'dti'
-00004740: 2c20 7265 7475 726e 5f76 6172 3d27 6c69  , return_var='li
-00004750: 7374 2729 0a20 2020 203e 3e3e 2066 6f72  st').    >>> for
-00004760: 2069 7465 6d20 696e 206c 7374 3a20 7072   item in lst: pr
-00004770: 696e 7428 6974 656d 290a 2020 2020 5b27  int(item).    ['
-00004780: 5345 4c4f 4144 272c 2031 2c20 325d 0a20  SELOAD', 1, 2]. 
-00004790: 2020 205b 2773 656c 6f61 6427 2c20 332c     ['seload', 3,
-000047a0: 2034 5d0a 2020 2020 5b27 7365 6c6f 6164   4].    ['seload
-000047b0: 272c 2035 2c20 365d 0a20 2020 205b 2753  ', 5, 6].    ['S
-000047c0: 454c 4f41 4427 2c20 2727 2c20 382e 302c  ELOAD', '', 8.0,
-000047d0: 2022 2761 2722 5d0a 2020 2020 5b27 5345   "'a'"].    ['SE
-000047e0: 5452 4545 272c 2031 3030 2c20 305d 0a0a  TREE', 100, 0]..
-000047f0: 2020 2020 5265 6164 2073 6f6d 6520 6f66      Read some of
-00004800: 2074 6865 2044 5449 2c53 454c 4f41 4420   the DTI,SELOAD 
-00004810: 6361 7264 7320 2869 7427 7320 6361 7365  cards (it's case
-00004820: 2d69 6e73 656e 7369 7469 7665 293a 0a0a  -insensitive):..
-00004830: 2020 2020 3e3e 3e20 6275 6c6b 2e72 6463      >>> bulk.rdc
-00004840: 6172 6473 2866 732c 2027 6474 6920 2020  ards(fs, 'dti   
-00004850: 2020 7365 6c6f 6164 2729 0a20 2020 2061    seload').    a
-00004860: 7272 6179 285b 5b20 302e 2c20 2031 2e2c  rray([[ 0.,  1.,
-00004870: 2020 322e 5d2c 0a20 2020 2020 2020 2020    2.],.         
-00004880: 2020 5b20 302e 2c20 2033 2e2c 2020 342e    [ 0.,  3.,  4.
-00004890: 5d5d 290a 0a20 2020 2055 7365 2061 2072  ]])..    Use a r
-000048a0: 6567 756c 6172 2065 7870 7265 7373 696f  egular expressio
-000048b0: 6e20 666f 7220 6d6f 7265 2070 6f77 6572  n for more power
-000048c0: 3a0a 0a20 2020 203e 3e3e 2062 756c 6b2e  :..    >>> bulk.
-000048d0: 7264 6361 7264 7328 6673 2c20 7227 4454  rdcards(fs, r'DT
-000048e0: 4928 2c5c 732a 7c5c 732b 2953 454c 4f41  I(,\s*|\s+)SELOA
-000048f0: 4427 2c20 7265 6765 783d 5472 7565 290a  D', regex=True).
-00004900: 2020 2020 6172 7261 7928 5b5b 2030 2e2c      array([[ 0.,
-00004910: 2020 312e 2c20 2032 2e2c 2020 302e 5d2c    1.,  2.,  0.],
-00004920: 0a20 2020 2020 2020 2020 2020 5b20 302e  .           [ 0.
-00004930: 2c20 2033 2e2c 2020 342e 2c20 2030 2e5d  ,  3.,  4.,  0.]
-00004940: 2c0a 2020 2020 2020 2020 2020 205b 2030  ,.           [ 0
-00004950: 2e2c 2020 352e 2c20 2036 2e2c 2020 302e  .,  5.,  6.,  0.
-00004960: 5d2c 0a20 2020 2020 2020 2020 2020 5b20  ],.           [ 
-00004970: 302e 2c20 2030 2e2c 2020 382e 2c20 2030  0.,  0.,  8.,  0
-00004980: 2e5d 5d29 0a0a 2020 2020 5361 6d65 2c20  .]])..    Same, 
-00004990: 6275 7420 7265 6164 2069 6e74 6f20 6120  but read into a 
-000049a0: 6c69 7374 3a0a 0a20 2020 203e 3e3e 206c  list:..    >>> l
-000049b0: 7374 203d 2062 756c 6b2e 7264 6361 7264  st = bulk.rdcard
-000049c0: 7328 6673 2c20 7227 4454 4928 2c5c 732a  s(fs, r'DTI(,\s*
-000049d0: 7c5c 732b 2953 454c 4f41 4427 2c20 7265  |\s+)SELOAD', re
-000049e0: 6765 783d 5472 7565 2c0a 2020 2020 2e2e  gex=True,.    ..
-000049f0: 2e20 2020 2020 2020 2020 2020 2020 2020  .               
-00004a00: 2020 2020 2072 6574 7572 6e5f 7661 723d       return_var=
-00004a10: 276c 6973 7427 290a 2020 2020 3e3e 3e20  'list').    >>> 
-00004a20: 666f 7220 6974 656d 2069 6e20 6c73 743a  for item in lst:
-00004a30: 2070 7269 6e74 2869 7465 6d29 0a20 2020   print(item).   
-00004a40: 205b 2753 454c 4f41 4427 2c20 312c 2032   ['SELOAD', 1, 2
-00004a50: 5d0a 2020 2020 5b27 7365 6c6f 6164 272c  ].    ['seload',
-00004a60: 2033 2c20 345d 0a20 2020 205b 2773 656c   3, 4].    ['sel
-00004a70: 6f61 6427 2c20 352c 2036 5d0a 2020 2020  oad', 5, 6].    
-00004a80: 5b27 5345 4c4f 4144 272c 2027 272c 2038  ['SELOAD', '', 8
-00004a90: 2e30 2c20 2227 6127 225d 0a0a 2020 2020  .0, "'a'"]..    
-00004aa0: 496e 636c 7564 6520 7468 6520 6361 7264  Include the card
-00004ab0: 206e 616d 6520 6173 2077 656c 6c3a 0a0a   name as well:..
-00004ac0: 2020 2020 3e3e 3e20 6c73 7420 3d20 6275      >>> lst = bu
-00004ad0: 6c6b 2e72 6463 6172 6473 2866 732c 2072  lk.rdcards(fs, r
-00004ae0: 2744 5449 282c 5c73 2a7c 5c73 2b29 5345  'DTI(,\s*|\s+)SE
-00004af0: 4c4f 4144 272c 2072 6567 6578 3d54 7275  LOAD', regex=Tru
-00004b00: 652c 0a20 2020 202e 2e2e 2020 2020 2020  e,.    ...      
-00004b10: 2020 2020 2020 2020 2020 2020 2020 7265                re
-00004b20: 7475 726e 5f76 6172 3d27 6c69 7374 272c  turn_var='list',
-00004b30: 206b 6565 705f 6e61 6d65 3d54 7275 6529   keep_name=True)
-00004b40: 0a20 2020 203e 3e3e 2066 6f72 2069 7465  .    >>> for ite
-00004b50: 6d20 696e 206c 7374 3a20 7072 696e 7428  m in lst: print(
-00004b60: 6974 656d 290a 2020 2020 5b27 4454 4927  item).    ['DTI'
-00004b70: 2c20 2753 454c 4f41 4427 2c20 312c 2032  , 'SELOAD', 1, 2
-00004b80: 5d0a 2020 2020 5b27 6474 6927 2c20 2773  ].    ['dti', 's
-00004b90: 656c 6f61 6427 2c20 332c 2034 5d0a 2020  eload', 3, 4].  
-00004ba0: 2020 5b27 6474 6927 2c20 2773 656c 6f61    ['dti', 'seloa
-00004bb0: 6427 2c20 352c 2036 5d0a 2020 2020 5b27  d', 5, 6].    ['
-00004bc0: 4454 4927 2c20 2753 454c 4f41 4427 2c20  DTI', 'SELOAD', 
-00004bd0: 2727 2c20 382e 302c 2022 2761 2722 5d0a  '', 8.0, "'a'"].
-00004be0: 0a20 2020 2046 6f72 2074 6865 206d 6f73  .    For the mos
-00004bf0: 7420 6163 6375 7261 7465 2072 6561 6420  t accurate read 
-00004c00: 6f66 2074 6865 2064 6174 612c 2069 6e63  of the data, inc
-00004c10: 6c75 6465 2063 6f6d 6d65 6e74 733a 0a0a  lude comments:..
-00004c20: 2020 2020 3e3e 3e20 6c73 7420 3d20 6275      >>> lst = bu
-00004c30: 6c6b 2e72 6463 6172 6473 2866 732c 2072  lk.rdcards(fs, r
-00004c40: 2744 5449 282c 5c73 2a7c 5c73 2b29 5345  'DTI(,\s*|\s+)SE
-00004c50: 4c4f 4144 272c 2072 6567 6578 3d54 7275  LOAD', regex=Tru
-00004c60: 652c 0a20 2020 202e 2e2e 2020 2020 2020  e,.    ...      
-00004c70: 2020 2020 2020 2020 2020 2020 2020 7265                re
-00004c80: 7475 726e 5f76 6172 3d27 6c69 7374 272c  turn_var='list',
-00004c90: 206b 6565 705f 6e61 6d65 3d54 7275 652c   keep_name=True,
-00004ca0: 0a20 2020 202e 2e2e 2020 2020 2020 2020  .    ...        
-00004cb0: 2020 2020 2020 2020 2020 2020 6b65 6570              keep
-00004cc0: 5f63 6f6d 6d65 6e74 733d 5472 7565 290a  _comments=True).
-00004cd0: 2020 2020 3e3e 3e20 666f 7220 6974 656d      >>> for item
-00004ce0: 2069 6e20 6c73 743a 2070 7269 6e74 2866   in lst: print(f
-00004cf0: 227b 6974 656d 2172 7d22 290a 2020 2020  "{item!r}").    
-00004d00: 5b27 4454 4927 2c20 2753 454c 4f41 4427  ['DTI', 'SELOAD'
-00004d10: 2c20 312c 2032 5d0a 2020 2020 5b27 6474  , 1, 2].    ['dt
-00004d20: 6927 2c20 2773 656c 6f61 6427 2c20 332c  i', 'seload', 3,
-00004d30: 2034 5d0a 2020 2020 2724 2061 2063 6f6d   4].    '$ a com
-00004d40: 6d65 6e74 2066 6f72 2074 6573 7469 6e67  ment for testing
-00004d50: 5c6e 270a 2020 2020 5b27 6474 6927 2c20  \n'.    ['dti', 
-00004d60: 2773 656c 6f61 6427 2c20 352c 2036 5d0a  'seload', 5, 6].
-00004d70: 2020 2020 5b27 4454 4927 2c20 2753 454c      ['DTI', 'SEL
-00004d80: 4f41 4427 2c20 2727 2c20 382e 302c 2022  OAD', '', 8.0, "
-00004d90: 2761 2722 5d0a 2020 2020 2222 220a 0a20  'a'"].    """.. 
-00004da0: 2020 2069 6620 7265 7475 726e 5f76 6172     if return_var
-00004db0: 206e 6f74 2069 6e20 2822 6172 7261 7922   not in ("array"
-00004dc0: 2c20 226c 6973 7422 2c20 2264 6963 7422  , "list", "dict"
-00004dd0: 293a 0a20 2020 2020 2020 2072 6169 7365  ):.        raise
-00004de0: 2056 616c 7565 4572 726f 7228 0a20 2020   ValueError(.   
-00004df0: 2020 2020 2020 2020 2027 696e 7661 6c69           'invali
-00004e00: 6420 6072 6574 7572 6e5f 7661 7260 2073  d `return_var` s
-00004e10: 6574 7469 6e67 3b20 6d75 7374 2062 6520  etting; must be 
-00004e20: 6f6e 6520 6f66 3a20 2822 6172 7261 7922  one of: ("array"
-00004e30: 2c20 226c 6973 7422 2c20 2264 6963 7422  , "list", "dict"
-00004e40: 2927 0a20 2020 2020 2020 2029 0a0a 2020  )'.        )..  
-00004e50: 2020 6966 2072 6574 7572 6e5f 7661 7220    if return_var 
-00004e60: 3d3d 2022 6469 6374 223a 0a20 2020 2020  == "dict":.     
-00004e70: 2020 2056 616c 7320 3d20 7b7d 0a20 2020     Vals = {}.   
-00004e80: 2020 2020 2074 6f64 6963 7420 3d20 5472       todict = Tr
-00004e90: 7565 0a20 2020 2020 2020 2074 6f6c 6973  ue.        tolis
-00004ea0: 7420 3d20 4661 6c73 650a 2020 2020 656c  t = False.    el
-00004eb0: 7365 3a0a 2020 2020 2020 2020 746f 6469  se:.        todi
-00004ec0: 6374 203d 2046 616c 7365 0a20 2020 2020  ct = False.     
-00004ed0: 2020 2074 6f6c 6973 7420 3d20 7265 7475     tolist = retu
-00004ee0: 726e 5f76 6172 203d 3d20 226c 6973 7422  rn_var == "list"
-00004ef0: 0a20 2020 2020 2020 2056 616c 7320 3d20  .        Vals = 
-00004f00: 5b5d 0a0a 2020 2020 6966 2062 6c61 6e6b  []..    if blank
-00004f10: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
-00004f20: 2020 626c 616e 6b20 3d20 2222 2069 6620    blank = "" if 
-00004f30: 746f 6c69 7374 2065 6c73 6520 300a 0a20  tolist else 0.. 
-00004f40: 2020 206d 786c 656e 203d 2030 0a20 2020     mxlen = 0.   
-00004f50: 2066 2e73 6565 6b28 302c 2030 290a 0a20   f.seek(0, 0).. 
-00004f60: 2020 2066 6974 6572 203d 205f 6e65 7874     fiter = _next
-00004f70: 5f6c 696e 6528 662c 206e 616d 652c 2072  _line(f, name, r
-00004f80: 6567 6578 2c20 746f 6c69 7374 2061 6e64  egex, tolist and
-00004f90: 206b 6565 705f 636f 6d6d 656e 7473 2c20   keep_comments, 
-00004fa0: 5661 6c73 290a 2020 2020 7320 3d20 6e65  Vals).    s = ne
-00004fb0: 7874 2866 6974 6572 290a 2020 2020 7768  xt(fiter).    wh
-00004fc0: 696c 6520 7320 6973 206e 6f74 204e 6f6e  ile s is not Non
-00004fd0: 653a 0a20 2020 2020 2020 2023 2069 6620  e:.        # if 
-00004fe0: 6865 7265 2c20 6861 7665 206d 6174 6368  here, have match
-00004ff0: 696e 6720 6c69 6e65 0a20 2020 2020 2020  ing line.       
-00005000: 2069 6620 732e 6669 6e64 2822 2c22 2920   if s.find(",") 
-00005010: 3e20 2d31 3a0a 2020 2020 2020 2020 2020  > -1:.          
-00005020: 2020 7661 6c73 203d 205f 7264 636f 6d6d    vals = _rdcomm
-00005030: 6128 6669 7465 722c 2073 2c20 2220 2b2c  a(fiter, s, " +,
-00005040: 222c 2062 6c61 6e6b 2c20 746f 6c69 7374  ", blank, tolist
-00005050: 2c20 6b65 6570 5f6e 616d 6529 0a20 2020  , keep_name).   
-00005060: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00005070: 2020 2020 2020 2073 203d 2073 5b3a 3732         s = s[:72
-00005080: 5d2e 7273 7472 6970 2829 0a20 2020 2020  ].rstrip().     
-00005090: 2020 2020 2020 2070 203d 2073 5b3a 385d         p = s[:8]
-000050a0: 2e66 696e 6428 222a 2229 0a20 2020 2020  .find("*").     
-000050b0: 2020 2020 2020 2066 6965 6c64 2c20 636f         field, co
-000050c0: 6e74 696e 7561 7469 6f6e 203d 2028 3136  ntinuation = (16
-000050d0: 2c20 222a 2229 2069 6620 7020 3e20 2d31  , "*") if p > -1
-000050e0: 2065 6c73 6520 2838 2c20 2220 2b22 290a   else (8, " +").
-000050f0: 2020 2020 2020 2020 2020 2020 7661 6c73              vals
-00005100: 203d 205f 7264 6669 7865 6428 6669 7465   = _rdfixed(fite
-00005110: 722c 2073 2c20 6669 656c 642c 2063 6f6e  r, s, field, con
-00005120: 7469 6e75 6174 696f 6e2c 2062 6c61 6e6b  tinuation, blank
-00005130: 2c20 746f 6c69 7374 2c20 6b65 6570 5f6e  , tolist, keep_n
-00005140: 616d 6529 0a20 2020 2020 2020 2069 6620  ame).        if 
-00005150: 746f 6c69 7374 3a0a 2020 2020 2020 2020  tolist:.        
-00005160: 2020 2020 5661 6c73 2e61 7070 656e 6428      Vals.append(
-00005170: 7661 6c73 290a 2020 2020 2020 2020 656c  vals).        el
-00005180: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00005190: 6375 7220 3d20 6c65 6e28 7661 6c73 290a  cur = len(vals).
-000051a0: 2020 2020 2020 2020 2020 2020 6d78 6c65              mxle
-000051b0: 6e20 3d20 6d61 7828 6d78 6c65 6e2c 2063  n = max(mxlen, c
-000051c0: 7572 290a 2020 2020 2020 2020 2020 2020  ur).            
-000051d0: 6b65 7920 3d20 7661 6c73 5b30 5d20 2023  key = vals[0]  #
-000051e0: 2062 6566 6f72 6520 6974 2067 6574 7320   before it gets 
-000051f0: 7475 726e 6564 2069 6e74 6f20 6474 7970  turned into dtyp
-00005200: 650a 2020 2020 2020 2020 2020 2020 7661  e.            va
-00005210: 6c73 203d 206e 702e 6172 7261 7928 7661  ls = np.array(va
-00005220: 6c73 292e 6173 7479 7065 2864 7479 7065  ls).astype(dtype
-00005230: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
-00005240: 2074 6f64 6963 743a 0a20 2020 2020 2020   todict:.       
-00005250: 2020 2020 2020 2020 2056 616c 735b 6b65           Vals[ke
-00005260: 795d 203d 2076 616c 730a 2020 2020 2020  y] = vals.      
-00005270: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-00005280: 2020 2020 2020 2020 2020 2020 5661 6c73              Vals
-00005290: 2e61 7070 656e 6428 7661 6c73 290a 2020  .append(vals).  
-000052a0: 2020 2020 2020 7472 793a 0a20 2020 2020        try:.     
-000052b0: 2020 2020 2020 2073 203d 2066 6974 6572         s = fiter
-000052c0: 2e73 656e 6428 5472 7565 290a 2020 2020  .send(True).    
-000052d0: 2020 2020 6578 6365 7074 2053 746f 7049      except StopI
-000052e0: 7465 7261 7469 6f6e 3a0a 2020 2020 2020  teration:.      
-000052f0: 2020 2020 2020 6272 6561 6b0a 0a20 2020        break..   
-00005300: 2023 2066 6c75 7368 206f 7574 2069 7465   # flush out ite
-00005310: 7261 746f 7220 6966 206e 6565 6465 6420  rator if needed 
-00005320: 2867 6574 2061 6e79 206c 6173 7420 636f  (get any last co
-00005330: 6d6d 656e 7473 290a 2020 2020 7472 793a  mments).    try:
-00005340: 0a20 2020 2020 2020 2073 203d 2066 6974  .        s = fit
-00005350: 6572 2e73 656e 6428 5472 7565 290a 2020  er.send(True).  
-00005360: 2020 6578 6365 7074 2053 746f 7049 7465    except StopIte
-00005370: 7261 7469 6f6e 3a0a 2020 2020 2020 2020  ration:.        
-00005380: 7061 7373 0a20 2020 2064 656c 2066 6974  pass.    del fit
-00005390: 6572 0a0a 2020 2020 6966 206c 656e 2856  er..    if len(V
-000053a0: 616c 7329 203e 2030 3a0a 2020 2020 2020  als) > 0:.      
-000053b0: 2020 6966 206e 6f74 2028 746f 6469 6374    if not (todict
-000053c0: 206f 7220 746f 6c69 7374 293a 0a20 2020   or tolist):.   
-000053d0: 2020 2020 2020 2020 206e 7056 616c 7320           npVals 
-000053e0: 3d20 6e70 2e65 6d70 7479 2828 6c65 6e28  = np.empty((len(
-000053f0: 5661 6c73 292c 206d 786c 656e 292c 2064  Vals), mxlen), d
-00005400: 7479 7065 3d64 7479 7065 290a 2020 2020  type=dtype).    
-00005410: 2020 2020 2020 2020 6e70 5661 6c73 5b3a          npVals[:
-00005420: 5d20 3d20 626c 616e 6b0a 2020 2020 2020  ] = blank.      
-00005430: 2020 2020 2020 666f 7220 692c 2076 616c        for i, val
-00005440: 7320 696e 2065 6e75 6d65 7261 7465 2856  s in enumerate(V
-00005450: 616c 7329 3a0a 2020 2020 2020 2020 2020  als):.          
-00005460: 2020 2020 2020 6e70 5661 6c73 5b69 2c20        npVals[i, 
-00005470: 3a20 6c65 6e28 7661 6c73 295d 203d 2076  : len(vals)] = v
-00005480: 616c 730a 2020 2020 2020 2020 2020 2020  als.            
-00005490: 5661 6c73 203d 206e 7056 616c 730a 2020  Vals = npVals.  
-000054a0: 2020 2020 2020 7265 7475 726e 2056 616c        return Val
-000054b0: 730a 2020 2020 7265 7475 726e 206e 6f5f  s.    return no_
-000054c0: 6461 7461 5f72 6574 7572 6e0a 0a0a 6465  data_return...de
-000054d0: 6620 7264 646d 6967 2866 2c20 646d 6967  f rddmig(f, dmig
-000054e0: 5f6e 616d 6573 3d4e 6f6e 652c 202a 2c20  _names=None, *, 
-000054f0: 6578 7061 6e64 6564 3d46 616c 7365 2c20  expanded=False, 
-00005500: 7371 7561 7265 3d46 616c 7365 293a 0a20  square=False):. 
-00005510: 2020 2022 2222 0a20 2020 2052 6561 6420     """.    Read 
-00005520: 444d 4947 2065 6e74 7269 6573 2066 726f  DMIG entries fro
-00005530: 6d20 6120 4e61 7374 7261 6e20 7075 6e63  m a Nastran punc
-00005540: 6820 2862 756c 6b29 206f 7220 6f75 7470  h (bulk) or outp
-00005550: 7574 3220 6669 6c65 2e0a 0a20 2020 2050  ut2 file...    P
-00005560: 6172 616d 6574 6572 730a 2020 2020 2d2d  arameters.    --
-00005570: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2066 203a  --------.    f :
-00005580: 2073 7472 696e 6720 6f72 2066 696c 655f   string or file_
-00005590: 6c69 6b65 206f 7220 4e6f 6e65 0a20 2020  like or None.   
-000055a0: 2020 2020 2045 6974 6865 7220 6120 6e61       Either a na
-000055b0: 6d65 206f 6620 6120 7075 6e63 6820 6f72  me of a punch or
-000055c0: 206f 7574 7075 7432 2066 696c 652c 206f   output2 file, o
-000055d0: 7220 6973 2061 2066 696c 655f 6c69 6b65  r is a file_like
-000055e0: 0a20 2020 2020 2020 206f 626a 6563 7420  .        object 
-000055f0: 6173 2072 6574 7572 6e65 6420 6279 203a  as returned by :
-00005600: 6675 6e63 3a60 6f70 656e 602e 2049 6620  func:`open`. If 
-00005610: 6861 6e64 6c65 2c20 7075 6e63 6820 666f  handle, punch fo
-00005620: 726d 6174 2069 730a 2020 2020 2020 2020  rmat is.        
-00005630: 6173 7375 6d65 6420 616e 6420 6669 6c65  assumed and file
-00005640: 2069 7320 7265 776f 756e 6420 6669 7273   is rewound firs
-00005650: 742e 2043 616e 2061 6c73 6f20 6265 2074  t. Can also be t
-00005660: 6865 206e 616d 6520 6f66 2061 0a20 2020  he name of a.   
-00005670: 2020 2020 2064 6972 6563 746f 7279 206f       directory o
-00005680: 7220 4e6f 6e65 3b20 696e 2074 6865 7365  r None; in these
-00005690: 2063 6173 6573 2c20 6120 4755 4920 6973   cases, a GUI is
-000056a0: 206f 7065 6e65 6420 666f 7220 6669 6c65   opened for file
-000056b0: 0a20 2020 2020 2020 2073 656c 6563 7469  .        selecti
-000056c0: 6f6e 2e0a 2020 2020 646d 6967 5f6e 616d  on..    dmig_nam
-000056d0: 6573 203a 204e 6f6e 652c 2073 7472 696e  es : None, strin
-000056e0: 672c 206f 7220 6c69 7374 5f6c 696b 6520  g, or list_like 
-000056f0: 6f66 2073 7472 696e 6773 0a20 2020 2020  of strings.     
-00005700: 2020 2049 6620 6e6f 7420 4e6f 6e65 2c20     If not None, 
-00005710: 6974 2069 7320 7468 6520 6e61 6d65 206f  it is the name o
-00005720: 7220 6e61 6d65 7320 6f66 2044 4d49 4720  r names of DMIG 
-00005730: 656e 7472 7928 7329 2074 6f0a 2020 2020  entry(s) to.    
-00005740: 2020 2020 7265 6164 2e20 4966 204e 6f6e      read. If Non
-00005750: 652c 2061 6c6c 2044 4d49 4720 656e 7472  e, all DMIG entr
-00005760: 6965 7320 7769 6c6c 2062 6520 7265 7475  ies will be retu
-00005770: 726e 6564 2e0a 2020 2020 6578 7061 6e64  rned..    expand
-00005780: 6564 203a 2062 6f6f 6c3b 206f 7074 696f  ed : bool; optio
-00005790: 6e61 6c3b 206d 7573 7420 6265 206e 616d  nal; must be nam
-000057a0: 6564 0a20 2020 2020 2020 2049 6620 5472  ed.        If Tr
-000057b0: 7565 2c20 726f 7720 616e 6420 636f 6c75  ue, row and colu
-000057c0: 6d6e 2069 6e64 6963 6573 2066 6f72 2022  mn indices for "
-000057d0: 4752 4944 2220 4944 7320 7769 6c6c 2062  GRID" IDs will b
-000057e0: 650a 2020 2020 2020 2020 6578 7061 6e64  e.        expand
-000057f0: 6564 2074 6f20 696e 636c 7564 6520 616c  ed to include al
-00005800: 6c20 3620 444f 462c 2065 7665 6e20 6966  l 6 DOF, even if
-00005810: 2073 6f6d 6520 6f66 2074 686f 7365 2044   some of those D
-00005820: 4f46 2061 7265 0a20 2020 2020 2020 206e  OF are.        n
-00005830: 6f74 2075 7365 642e 204f 7468 6572 7769  ot used. Otherwi
-00005840: 7365 2c20 6966 2060 6578 7061 6e64 6564  se, if `expanded
-00005850: 6020 6973 2046 616c 7365 2c20 6f6e 6c79  ` is False, only
-00005860: 2074 6865 2072 6f77 2061 6e64 0a20 2020   the row and.   
-00005870: 2020 2020 2063 6f6c 756d 6e20 444f 4620       column DOF 
-00005880: 6163 7475 616c 6c79 2072 6566 6572 656e  actually referen
-00005890: 6365 6420 6f6e 2074 6865 2044 4d49 4720  ced on the DMIG 
-000058a0: 7769 6c6c 2062 650a 2020 2020 2020 2020  will be.        
-000058b0: 696e 636c 7564 6564 2e0a 2020 2020 7371  included..    sq
-000058c0: 7561 7265 203a 2062 6f6f 6c3b 206f 7074  uare : bool; opt
-000058d0: 696f 6e61 6c3b 206d 7573 7420 6265 206e  ional; must be n
-000058e0: 616d 6564 0a20 2020 2020 2020 204f 6e6c  amed.        Onl
-000058f0: 7920 7573 6564 2066 6f72 2022 7371 7561  y used for "squa
-00005900: 7265 2220 6d61 7472 6963 6573 2028 6060  re" matrices (``
-00005910: 666f 726d 3d31 6060 292e 2049 6620 5472  form=1``). If Tr
-00005920: 7565 2c20 656e 7375 7265 730a 2020 2020  ue, ensures.    
-00005930: 2020 2020 7468 6174 2074 6865 2072 6f77      that the row
-00005940: 2061 6e64 2063 6f6c 756d 6e20 696e 6469   and column indi
-00005950: 6365 7320 6172 6520 7468 6520 7361 6d65  ces are the same
-00005960: 2062 7920 6669 6c6c 696e 6720 696e 0a20   by filling in. 
-00005970: 2020 2020 2020 207a 6572 6f73 2061 7320         zeros as 
-00005980: 6e65 6365 7373 6172 792e 0a0a 2020 2020  necessary...    
-00005990: 5265 7475 726e 730a 2020 2020 2d2d 2d2d  Returns.    ----
-000059a0: 2d2d 2d0a 2020 2020 6463 7420 3a20 6469  ---.    dct : di
-000059b0: 6374 696f 6e61 7279 0a20 2020 2020 2020  ctionary.       
-000059c0: 2044 6963 7469 6f6e 6172 7920 6f66 2070   Dictionary of p
-000059d0: 616e 6461 7320 4461 7461 4672 616d 6573  andas DataFrames
-000059e0: 2063 6f6e 7461 696e 696e 6720 7468 6520   containing the 
-000059f0: 444d 4947 0a20 2020 2020 2020 2065 6e74  DMIG.        ent
-00005a00: 7269 6573 2e20 5468 6520 636f 6c75 6d6e  ries. The column
-00005a10: 2061 6e64 2072 6f77 2069 6e64 6963 6573   and row indices
-00005a20: 2061 7265 2070 616e 6461 7320 4d75 6c74   are pandas Mult
-00005a30: 6949 6e64 6578 0a20 2020 2020 2020 206f  iIndex.        o
-00005a40: 626a 6563 7473 2077 6974 6820 6e6f 6465  bjects with node
-00005a50: 2049 4420 696e 206c 6576 656c 2030 2061   ID in level 0 a
-00005a60: 6e64 2044 4f46 2069 6e20 6c65 7665 6c20  nd DOF in level 
-00005a70: 3120 2874 6865 206e 616d 6573 0a20 2020  1 (the names.   
-00005a80: 2020 2020 2061 7265 2022 6964 2220 616e       are "id" an
-00005a90: 6420 2264 6f66 2229 2e20 5468 6520 6578  d "dof"). The ex
-00005aa0: 6365 7074 696f 6e20 6973 2066 6f72 2066  ception is for f
-00005ab0: 6f72 6d20 2239 2220 6d61 7472 6963 6573  orm "9" matrices
-00005ac0: 3a0a 2020 2020 2020 2020 7468 6520 636f  :.        the co
-00005ad0: 6c75 6d6e 2069 6e64 6578 2069 6e20 7468  lumn index in th
-00005ae0: 6174 2063 6173 6520 6973 206a 7573 7420  at case is just 
-00005af0: 7468 6520 636f 6c75 6d6e 206e 756d 6265  the column numbe
-00005b00: 7220 2861 730a 2020 2020 2020 2020 7370  r (as.        sp
-00005b10: 6563 6966 6965 6420 6279 204e 6173 7472  ecified by Nastr
-00005b20: 616e 292e 0a0a 2020 2020 4e6f 7465 730a  an)...    Notes.
-00005b30: 2020 2020 2d2d 2d2d 2d0a 2020 2020 466f      -----.    Fo
-00005b40: 7220 7468 6520 7075 6e63 6820 666f 726d  r the punch form
-00005b50: 6174 2c20 7468 6973 2072 6f75 7469 6e65  at, this routine
-00005b60: 2066 6972 7374 2072 6561 6473 2061 6c6c   first reads all
-00005b70: 2044 4d49 4720 656e 7472 6965 730a 2020   DMIG entries.  
-00005b80: 2020 7669 6120 3a66 756e 633a 6072 6463    via :func:`rdc
-00005b90: 6172 6473 6020 7573 696e 6720 7468 6520  ards` using the 
-00005ba0: 276c 6973 7427 206f 7574 7075 7420 6f70  'list' output op
-00005bb0: 7469 6f6e 2e20 4974 2074 6865 6e20 6275  tion. It then bu
-00005bc0: 696c 6473 0a20 2020 2061 2064 6963 7469  ilds.    a dicti
-00005bd0: 6f6e 6172 7920 6f66 2044 6174 6146 7261  onary of DataFra
-00005be0: 6d65 7320 666f 7220 6f6e 6c79 2074 686f  mes for only tho
-00005bf0: 7365 2065 6e74 7269 6573 2073 7065 6369  se entries speci
-00005c00: 6669 6564 2069 6e0a 2020 2020 6064 6d69  fied in.    `dmi
-00005c10: 675f 6e61 6d65 7360 2e20 4974 2069 7320  g_names`. It is 
-00005c20: 6173 7375 6d65 6420 7468 6174 2044 4d49  assumed that DMI
-00005c30: 4720 656e 7472 6965 7320 6172 6520 696e  G entries are in
-00005c40: 206f 7264 6572 2069 6e20 7468 650a 2020   order in the.  
-00005c50: 2020 6669 6c65 2e0a 0a20 2020 2046 6f72    file...    For
-00005c60: 2074 6865 206f 7574 7075 7432 2066 6f72   the output2 for
-00005c70: 6d61 742c 2074 6869 7320 726f 7574 696e  mat, this routin
-00005c80: 6520 7363 616e 7320 7468 726f 7567 6820  e scans through 
-00005c90: 7468 6520 6669 6c65 0a20 2020 206c 6f6f  the file.    loo
-00005ca0: 6b69 6e67 2066 6f72 206d 6174 6368 696e  king for matchin
-00005cb0: 6720 444d 4947 2064 6174 612d 626c 6f63  g DMIG data-bloc
-00005cc0: 6b73 2061 6e64 206f 6e6c 7920 7265 6164  ks and only read
-00005cd0: 7320 7468 6f73 6520 696e 2e0a 0a20 2020  s those in...   
-00005ce0: 202e 2e20 6e6f 7465 3a3a 0a20 2020 2020   .. note::.     
-00005cf0: 2020 2054 6869 7320 726f 7574 696e 6520     This routine 
-00005d00: 6973 206d 6f72 6520 6c65 6e69 656e 7420  is more lenient 
-00005d10: 7468 616e 204e 6173 7472 616e 2e20 4e61  than Nastran. Na
-00005d20: 7374 7261 6e20 7769 6c6c 2069 7373 7565  stran will issue
-00005d30: 0a20 2020 2020 2020 2061 2046 4154 414c  .        a FATAL
-00005d40: 206d 6573 7361 6765 2069 6620 6120 7379   message if a sy
-00005d50: 6d6d 6574 7269 6320 6d61 7472 6978 2068  mmetric matrix h
-00005d60: 6173 2065 6e74 7269 6573 2066 6f72 2065  as entries for e
-00005d70: 6c65 6d65 6e74 0a20 2020 2020 2020 2028  lement.        (
-00005d80: 692c 206a 2920 616e 6420 286a 2c20 6929  i, j) and (j, i)
-00005d90: 2e20 5468 6973 2072 6f75 7469 6e65 2064  . This routine d
-00005da0: 6f65 7320 6e6f 7420 6368 6563 6b20 666f  oes not check fo
-00005db0: 7220 7468 6174 2028 7468 650a 2020 2020  r that (the.    
-00005dc0: 2020 2020 6c61 7374 2076 616c 7565 2066      last value f
-00005dd0: 6f72 2028 692c 206a 2920 6f72 2028 6a2c  or (i, j) or (j,
-00005de0: 2069 2920 7769 6c6c 2062 6520 7573 6564   i) will be used
-00005df0: 2066 6f72 2062 6f74 6829 2e0a 0a20 2020   for both)...   
-00005e00: 2045 7861 6d70 6c65 730a 2020 2020 2d2d   Examples.    --
-00005e10: 2d2d 2d2d 2d2d 0a20 2020 204d 616e 7561  ------.    Manua
-00005e20: 6c6c 7920 6372 6561 7465 2061 2070 756e  lly create a pun
-00005e30: 6368 2066 6f72 6d61 7420 444d 4947 2073  ch format DMIG s
-00005e40: 7472 696e 672c 2074 7265 6174 2069 7420  tring, treat it 
-00005e50: 6173 2061 2066 696c 652c 0a20 2020 2061  as a file,.    a
-00005e60: 6e64 2072 6561 6420 6974 2069 6e20 7769  nd read it in wi
-00005e70: 7468 2061 2063 6f75 706c 6520 6469 6666  th a couple diff
-00005e80: 6572 656e 7420 6f70 7469 6f6e 733a 0a0a  erent options:..
-00005e90: 2020 2020 3e3e 3e20 696d 706f 7274 206e      >>> import n
-00005ea0: 756d 7079 2061 7320 6e70 0a20 2020 203e  umpy as np.    >
-00005eb0: 3e3e 2066 726f 6d20 7079 7965 7469 2069  >> from pyyeti i
-00005ec0: 6d70 6f72 7420 6e61 7374 7261 6e0a 2020  mport nastran.  
-00005ed0: 2020 3e3e 3e20 6672 6f6d 2069 6f20 696d    >>> from io im
-00005ee0: 706f 7274 2053 7472 696e 6749 4f0a 2020  port StringIO.  
-00005ef0: 2020 3e3e 3e20 646d 6967 203d 2028 0a20    >>> dmig = (. 
-00005f00: 2020 202e 2e2e 2020 2744 4d49 4720 2020     ...  'DMIG   
-00005f10: 204d 4154 2020 2020 2020 2020 2020 2020   MAT            
-00005f20: 3020 2020 2020 2020 3120 2020 2020 2020  0       1       
-00005f30: 3220 2020 2020 2020 3027 0a20 2020 202e  2       0'.    .
-00005f40: 2e2e 2020 2720 2020 2020 2020 2020 2020  ..  '           
-00005f50: 2020 2020 2020 2020 2020 2020 325c 5c6e              2\\n
-00005f60: 270a 2020 2020 2e2e 2e20 2027 444d 4947  '.    ...  'DMIG
-00005f70: 2a20 2020 4d41 5420 2020 2020 2020 2020  *   MAT         
-00005f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005f90: 2020 2031 2020 2020 2020 2020 2020 2020     1            
-00005fa0: 2020 2031 5c5c 6e27 0a20 2020 202e 2e2e     1\\n'.    ...
-00005fb0: 2020 272a 2020 2020 2020 2020 2020 2020    '*            
-00005fc0: 2020 2020 2020 2020 2020 3120 2020 2020            1     
-00005fd0: 2020 2020 2020 2020 2020 3320 312e 3230            3 1.20
-00005fe0: 3030 3030 3030 3044 2b30 315c 5c6e 270a  0000000D+01\\n'.
-00005ff0: 2020 2020 2e2e 2e20 2027 2a20 2020 2020      ...  '*     
-00006000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006010: 3130 2020 2020 2020 2020 2020 2020 2020  10              
-00006020: 2030 2031 2e30 3030 3030 3030 3030 442b   0 1.000000000D+
-00006030: 3032 5c5c 6e27 0a20 2020 202e 2e2e 2029  02\\n'.    ... )
-00006040: 0a20 2020 203e 3e3e 2077 6974 6820 5374  .    >>> with St
-00006050: 7269 6e67 494f 2864 6d69 6729 2061 7320  ringIO(dmig) as 
-00006060: 663a 0a20 2020 202e 2e2e 2020 2020 2064  f:.    ...     d
-00006070: 6374 3120 3d20 6e61 7374 7261 6e2e 7264  ct1 = nastran.rd
-00006080: 646d 6967 2866 290a 2020 2020 2e2e 2e20  dmig(f).    ... 
-00006090: 2020 2020 6463 7432 203d 206e 6173 7472      dct2 = nastr
-000060a0: 616e 2e72 6464 6d69 6728 662c 2065 7870  an.rddmig(f, exp
-000060b0: 616e 6465 643d 5472 7565 290a 2020 2020  anded=True).    
-000060c0: 2e2e 2e20 2020 2020 6463 7433 203d 206e  ...     dct3 = n
-000060d0: 6173 7472 616e 2e72 6464 6d69 6728 662c  astran.rddmig(f,
-000060e0: 2073 7175 6172 653d 5472 7565 290a 2020   square=True).  
-000060f0: 2020 2e2e 2e20 2020 2020 6463 7434 203d    ...     dct4 =
-00006100: 206e 6173 7472 616e 2e72 6464 6d69 6728   nastran.rddmig(
-00006110: 662c 2065 7870 616e 6465 643d 5472 7565  f, expanded=True
-00006120: 2c20 7371 7561 7265 3d54 7275 6529 0a20  , square=True). 
-00006130: 2020 203e 3e3e 2064 6374 315b 276d 6174     >>> dct1['mat
-00006140: 275d 2020 2020 2320 646f 6374 6573 743a  ']    # doctest:
-00006150: 202b 454c 4c49 5053 4953 0a20 2020 2069   +ELLIPSIS.    i
-00006160: 6420 2020 2020 2020 2020 2031 0a20 2020  d          1.   
-00006170: 2064 6f66 2020 2020 2020 2020 2031 0a20   dof         1. 
-00006180: 2020 2069 6420 646f 662e 2e2e 0a20 2020     id dof....   
-00006190: 2031 2020 3320 2020 2020 3132 2e30 0a20   1  3     12.0. 
-000061a0: 2020 2031 3020 3020 2020 2031 3030 2e30     10 0    100.0
-000061b0: 0a20 2020 203e 3e3e 2064 6374 325b 276d  .    >>> dct2['m
-000061c0: 6174 275d 2020 2020 2320 646f 6374 6573  at']    # doctes
-000061d0: 743a 202b 454c 4c49 5053 4953 0a20 2020  t: +ELLIPSIS.   
-000061e0: 2069 6420 2020 2020 2020 2020 2031 2e2e   id          1..
-000061f0: 2e0a 2020 2020 646f 6620 2020 2020 2020  ..    dof       
-00006200: 2020 3120 2020 2032 2020 2020 3320 2020    1    2    3   
-00006210: 2034 2020 2020 3520 2020 2036 0a20 2020   4    5    6.   
-00006220: 2069 6420 646f 662e 2e2e 0a20 2020 2031   id dof....    1
-00006230: 2020 3120 2020 2020 2030 2e30 2020 302e    1      0.0  0.
-00006240: 3020 2030 2e30 2020 302e 3020 2030 2e30  0  0.0  0.0  0.0
-00006250: 2020 302e 300a 2020 2020 2020 2032 2020    0.0.       2  
-00006260: 2020 2020 302e 3020 2030 2e30 2020 302e      0.0  0.0  0.
-00006270: 3020 2030 2e30 2020 302e 3020 2030 2e30  0  0.0  0.0  0.0
-00006280: 0a20 2020 2020 2020 3320 2020 2020 3132  .       3     12
-00006290: 2e30 2020 302e 3020 2030 2e30 2020 302e  .0  0.0  0.0  0.
-000062a0: 3020 2030 2e30 2020 302e 300a 2020 2020  0  0.0  0.0.    
-000062b0: 2020 2034 2020 2020 2020 302e 3020 2030     4      0.0  0
-000062c0: 2e30 2020 302e 3020 2030 2e30 2020 302e  .0  0.0  0.0  0.
-000062d0: 3020 2030 2e30 0a20 2020 2020 2020 3520  0  0.0.       5 
-000062e0: 2020 2020 2030 2e30 2020 302e 3020 2030       0.0  0.0  0
-000062f0: 2e30 2020 302e 3020 2030 2e30 2020 302e  .0  0.0  0.0  0.
-00006300: 300a 2020 2020 2020 2036 2020 2020 2020  0.       6      
-00006310: 302e 3020 2030 2e30 2020 302e 3020 2030  0.0  0.0  0.0  0
-00006320: 2e30 2020 302e 3020 2030 2e30 0a20 2020  .0  0.0  0.0.   
-00006330: 2031 3020 3020 2020 2031 3030 2e30 2020   10 0    100.0  
-00006340: 302e 3020 2030 2e30 2020 302e 3020 2030  0.0  0.0  0.0  0
-00006350: 2e30 2020 302e 300a 2020 2020 3e3e 3e20  .0  0.0.    >>> 
-00006360: 6463 7433 5b27 6d61 7427 5d20 2020 2023  dct3['mat']    #
-00006370: 2064 6f63 7465 7374 3a20 2b45 4c4c 4950   doctest: +ELLIP
-00006380: 5349 530a 2020 2020 6964 2020 2020 2020  SIS.    id      
-00006390: 2020 2031 2020 2020 2020 2020 2031 300a     1         10.
-000063a0: 2020 2020 646f 6620 2020 2020 2020 2020      dof         
-000063b0: 3120 2020 2033 2020 2020 300a 2020 2020  1    3    0.    
-000063c0: 6964 2064 6f66 2e2e 2e0a 2020 2020 3120  id dof....    1 
-000063d0: 2031 2020 2020 2020 302e 3020 2030 2e30   1      0.0  0.0
-000063e0: 2020 302e 300a 2020 2020 2020 2033 2020    0.0.       3  
-000063f0: 2020 2031 322e 3020 2030 2e30 2020 302e     12.0  0.0  0.
-00006400: 300a 2020 2020 3130 2030 2020 2020 3130  0.    10 0    10
-00006410: 302e 3020 2030 2e30 2020 302e 300a 2020  0.0  0.0  0.0.  
-00006420: 2020 3e3e 3e20 6463 7434 5b27 6d61 7427    >>> dct4['mat'
-00006430: 5d20 2020 2023 2064 6f63 7465 7374 3a20  ]    # doctest: 
-00006440: 2b45 4c4c 4950 5349 530a 2020 2020 6964  +ELLIPSIS.    id
-00006450: 2020 2020 2020 2020 2031 2020 2020 2020           1      
-00006460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006470: 2020 2020 2020 2031 300a 2020 2020 646f         10.    do
-00006480: 6620 2020 2020 2020 2020 3120 2020 2032  f         1    2
-00006490: 2020 2020 3320 2020 2034 2020 2020 3520      3    4    5 
-000064a0: 2020 2036 2020 2020 300a 2020 2020 6964     6    0.    id
-000064b0: 2064 6f66 2e2e 2e0a 2020 2020 3120 2031   dof....    1  1
-000064c0: 2020 2020 2020 302e 3020 2030 2e30 2020        0.0  0.0  
-000064d0: 302e 3020 2030 2e30 2020 302e 3020 2030  0.0  0.0  0.0  0
-000064e0: 2e30 2020 302e 300a 2020 2020 2020 2032  .0  0.0.       2
-000064f0: 2020 2020 2020 302e 3020 2030 2e30 2020        0.0  0.0  
-00006500: 302e 3020 2030 2e30 2020 302e 3020 2030  0.0  0.0  0.0  0
-00006510: 2e30 2020 302e 300a 2020 2020 2020 2033  .0  0.0.       3
-00006520: 2020 2020 2031 322e 3020 2030 2e30 2020       12.0  0.0  
-00006530: 302e 3020 2030 2e30 2020 302e 3020 2030  0.0  0.0  0.0  0
-00006540: 2e30 2020 302e 300a 2020 2020 2020 2034  .0  0.0.       4
-00006550: 2020 2020 2020 302e 3020 2030 2e30 2020        0.0  0.0  
-00006560: 302e 3020 2030 2e30 2020 302e 3020 2030  0.0  0.0  0.0  0
-00006570: 2e30 2020 302e 300a 2020 2020 2020 2035  .0  0.0.       5
-00006580: 2020 2020 2020 302e 3020 2030 2e30 2020        0.0  0.0  
-00006590: 302e 3020 2030 2e30 2020 302e 3020 2030  0.0  0.0  0.0  0
-000065a0: 2e30 2020 302e 300a 2020 2020 2020 2036  .0  0.0.       6
-000065b0: 2020 2020 2020 302e 3020 2030 2e30 2020        0.0  0.0  
-000065c0: 302e 3020 2030 2e30 2020 302e 3020 2030  0.0  0.0  0.0  0
-000065d0: 2e30 2020 302e 300a 2020 2020 3130 2030  .0  0.0.    10 0
-000065e0: 2020 2020 3130 302e 3020 2030 2e30 2020      100.0  0.0  
-000065f0: 302e 3020 2030 2e30 2020 302e 3020 2030  0.0  0.0  0.0  0
-00006600: 2e30 2020 302e 300a 2020 2020 2222 220a  .0  0.0.    """.
-00006610: 2020 2020 2320 4e6f 7465 7320 6f6e 2044      # Notes on D
-00006620: 4d49 4720 666f 726d 6174 3a0a 2020 2020  MIG format:.    
-00006630: 2320 2d20 726f 7773 2061 7265 2061 6c77  # - rows are alw
-00006640: 6179 7320 672d 7365 7420 6f72 2070 2d73  ays g-set or p-s
-00006650: 6574 2073 697a 650a 2020 2020 2320 2d20  et size.    # - 
-00006660: 7371 7561 7265 3a0a 2020 2020 2320 2020  square:.    #   
-00006670: 2d20 666f 726d 6174 2031 2069 7320 6765  - format 1 is ge
-00006680: 6e65 7261 6c20 7371 7561 7265 0a20 2020  neral square.   
-00006690: 2023 2020 202d 2066 6f72 6d61 7420 3620   #   - format 6 
-000066a0: 6973 2073 796d 6d65 7472 6963 2061 6e64  is symmetric and
-000066b0: 206f 6e6c 7920 6f6e 6520 6f66 2065 6163   only one of eac
-000066c0: 6820 2869 2c20 6a29 206f 7220 286a 2c20  h (i, j) or (j, 
-000066d0: 6929 0a20 2020 2023 2020 2020 2070 6169  i).    #     pai
-000066e0: 7220 6d61 7920 6265 2070 726f 7669 6465  r may be provide
-000066f0: 6420 284e 6173 7472 616e 2077 696c 6c20  d (Nastran will 
-00006700: 4641 5441 4c20 6f74 6865 7277 6973 6529  FATAL otherwise)
-00006710: 0a20 2020 2023 202d 2072 6563 7461 6e67  .    # - rectang
-00006720: 756c 6172 3a0a 2020 2020 2320 2020 2d20  ular:.    #   - 
-00006730: 666f 726d 6174 2032 0a20 2020 2023 2020  format 2.    #  
-00006740: 202d 2066 6f72 6d61 7420 3920 7573 6573   - format 9 uses
-00006750: 2027 6e63 6f6c 2720 616e 6420 646f 6573   'ncol' and does
-00006760: 6e27 7420 6861 7665 2061 6374 7561 6c20  n't have actual 
-00006770: 6772 6964 2f64 6f66 2070 6169 7273 0a20  grid/dof pairs. 
-00006780: 2020 2023 2020 2020 2066 6f72 2063 6f6c     #     for col
-00006790: 756d 6e73 3b20 6275 7420 7468 6520 7061  umns; but the pa
-000067a0: 6972 7320 7072 6f76 6964 6564 2064 6f20  irs provided do 
-000067b0: 6465 7465 726d 696e 6520 736f 7274 206f  determine sort o
-000067c0: 7264 6572 0a0a 2020 2020 6465 6620 5f61  rder..    def _a
-000067d0: 6464 5f69 6464 6f66 5f65 7870 616e 6465  dd_iddof_expande
-000067e0: 6428 6964 732c 2069 6464 6f66 2c20 6e69  d(ids, iddof, ni
-000067f0: 642c 2064 6f66 293a 0a20 2020 2020 2020  d, dof):.       
-00006800: 2023 2069 6464 6f66 2069 7320 6120 6c69   # iddof is a li
-00006810: 7374 0a20 2020 2020 2020 2069 6620 6e69  st.        if ni
-00006820: 6420 6e6f 7420 696e 2069 6473 3a0a 2020  d not in ids:.  
-00006830: 2020 2020 2020 2020 2020 6964 732e 6164            ids.ad
-00006840: 6428 6e69 6429 0a20 2020 2020 2020 2020  d(nid).         
-00006850: 2020 2069 6620 646f 6620 3e20 303a 0a20     if dof > 0:. 
-00006860: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00006870: 6464 6f66 2e65 7874 656e 6428 5b28 6e69  ddof.extend([(ni
-00006880: 642c 206b 2920 666f 7220 6b20 696e 2072  d, k) for k in r
-00006890: 616e 6765 2831 2c20 3729 5d29 0a20 2020  ange(1, 7)]).   
-000068a0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-000068b0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-000068c0: 6464 6f66 2e61 7070 656e 6428 286e 6964  ddof.append((nid
-000068d0: 2c20 3029 290a 0a20 2020 2064 6566 205f  , 0))..    def _
-000068e0: 6164 645f 6964 646f 665f 6d69 6e69 6d61  add_iddof_minima
-000068f0: 6c28 6964 732c 2069 6464 6f66 2c20 6e69  l(ids, iddof, ni
-00006900: 642c 2064 6f66 293a 0a20 2020 2020 2020  d, dof):.       
-00006910: 2023 2069 6464 6f66 2069 7320 6120 7365   # iddof is a se
-00006920: 740a 2020 2020 2020 2020 6964 646f 662e  t.        iddof.
-00006930: 6164 6428 286e 6964 2c20 646f 6629 290a  add((nid, dof)).
-00006940: 0a20 2020 2064 6566 205f 6d6b 5f69 6e64  .    def _mk_ind
-00006950: 6578 2869 6464 6f66 293a 0a20 2020 2020  ex(iddof):.     
-00006960: 2020 2069 6464 6f66 203d 2073 6f72 7465     iddof = sorte
-00006970: 6428 6964 646f 662c 206b 6579 3d6c 616d  d(iddof, key=lam
-00006980: 6264 6120 783a 2031 3020 2a20 785b 305d  bda x: 10 * x[0]
-00006990: 202b 2078 5b31 5d29 0a20 2020 2020 2020   + x[1]).       
-000069a0: 2072 6574 7572 6e20 7064 2e4d 756c 7469   return pd.Multi
-000069b0: 496e 6465 782e 6672 6f6d 5f74 7570 6c65  Index.from_tuple
-000069c0: 7328 6964 646f 662c 206e 616d 6573 3d5b  s(iddof, names=[
-000069d0: 2269 6422 2c20 2264 6f66 225d 290a 0a20  "id", "dof"]).. 
-000069e0: 2020 2064 6566 205f 7072 6570 5f64 6174     def _prep_dat
-000069f0: 6166 7261 6d65 286d 7479 7065 2c20 666f  aframe(mtype, fo
-00006a00: 726d 2c20 726f 775f 6964 732c 2072 6f77  rm, row_ids, row
-00006a10: 5f69 6464 6f66 2c20 636f 6c5f 6964 646f  _iddof, col_iddo
-00006a20: 662c 206e 636f 6c29 3a0a 2020 2020 2020  f, ncol):.      
-00006a30: 2020 2320 6372 6561 7465 2064 6174 6166    # create dataf
-00006a40: 7261 6d65 3a0a 2020 2020 2020 2020 6474  rame:.        dt
-00006a50: 7970 6520 3d20 666c 6f61 7420 6966 206d  ype = float if m
-00006a60: 7479 7065 203c 2033 2065 6c73 6520 636f  type < 3 else co
-00006a70: 6d70 6c65 780a 2020 2020 2020 2020 6966  mplex.        if
-00006a80: 2066 6f72 6d20 213d 2039 3a0a 2020 2020   form != 9:.    
-00006a90: 2020 2020 2020 2020 6966 2066 6f72 6d20          if form 
-00006aa0: 3d3d 2036 206f 7220 2866 6f72 6d20 3d3d  == 6 or (form ==
-00006ab0: 2031 2061 6e64 2073 7175 6172 6529 3a0a   1 and square):.
-00006ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006ad0: 666f 7220 6e69 642c 2064 6f66 2069 6e20  for nid, dof in 
-00006ae0: 636f 6c5f 6964 646f 663a 0a20 2020 2020  col_iddof:.     
-00006af0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-00006b00: 6464 5f69 6464 6f66 2872 6f77 5f69 6473  dd_iddof(row_ids
-00006b10: 2c20 726f 775f 6964 646f 662c 206e 6964  , row_iddof, nid
-00006b20: 2c20 646f 6629 0a20 2020 2020 2020 2020  , dof).         
-00006b30: 2020 2020 2020 2072 6f77 696e 6465 7820         rowindex 
-00006b40: 3d20 5f6d 6b5f 696e 6465 7828 726f 775f  = _mk_index(row_
-00006b50: 6964 646f 6629 0a20 2020 2020 2020 2020  iddof).         
-00006b60: 2020 2020 2020 2063 6f6c 696e 6465 7820         colindex 
-00006b70: 3d20 726f 7769 6e64 6578 0a20 2020 2020  = rowindex.     
-00006b80: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00006b90: 2020 2020 2020 2020 2020 2020 2072 6f77               row
-00006ba0: 696e 6465 7820 3d20 5f6d 6b5f 696e 6465  index = _mk_inde
-00006bb0: 7828 726f 775f 6964 646f 6629 0a20 2020  x(row_iddof).   
-00006bc0: 2020 2020 2020 2020 2020 2020 2063 6f6c               col
-00006bd0: 696e 6465 7820 3d20 5f6d 6b5f 696e 6465  index = _mk_inde
-00006be0: 7828 636f 6c5f 6964 646f 6629 0a20 2020  x(col_iddof).   
-00006bf0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00006c00: 2020 2020 2020 2072 6f77 696e 6465 7820         rowindex 
-00006c10: 3d20 5f6d 6b5f 696e 6465 7828 726f 775f  = _mk_index(row_
-00006c20: 6964 646f 6629 0a20 2020 2020 2020 2020  iddof).         
-00006c30: 2020 2069 6620 6578 7061 6e64 6564 3a0a     if expanded:.
-00006c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006c50: 636f 6c69 6e64 6578 203d 206e 702e 6172  colindex = np.ar
-00006c60: 616e 6765 2831 2c20 6e63 6f6c 202b 2031  ange(1, ncol + 1
-00006c70: 290a 2020 2020 2020 2020 2020 2020 656c  ).            el
-00006c80: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00006c90: 2020 2020 636f 6c69 6e64 6578 203d 2073      colindex = s
-00006ca0: 6f72 7465 6428 6e69 6420 666f 7220 6e69  orted(nid for ni
-00006cb0: 642c 2064 6f66 2069 6e20 636f 6c5f 6964  d, dof in col_id
-00006cc0: 646f 6629 0a20 2020 2020 2020 2064 6174  dof).        dat
-00006cd0: 6120 3d20 6e70 2e7a 6572 6f73 2828 6c65  a = np.zeros((le
-00006ce0: 6e28 726f 7769 6e64 6578 292c 206c 656e  n(rowindex), len
-00006cf0: 2863 6f6c 696e 6465 7829 292c 2064 7479  (colindex)), dty
-00006d00: 7065 290a 2020 2020 2020 2020 7265 7475  pe).        retu
-00006d10: 726e 2064 6174 612c 2072 6f77 696e 6465  rn data, rowinde
-00006d20: 782c 2063 6f6c 696e 6465 780a 0a20 2020  x, colindex..   
-00006d30: 2064 6566 205f 6765 745f 3164 5f69 6e64   def _get_1d_ind
-00006d40: 6578 2869 6e64 6578 293a 0a20 2020 2020  ex(index):.     
-00006d50: 2020 2069 6e64 203d 2069 6e64 6578 2e74     ind = index.t
-00006d60: 6f5f 6672 616d 6528 292e 7661 6c75 6573  o_frame().values
-00006d70: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00006d80: 696e 645b 3a2c 2030 5d20 2a20 3130 202b  ind[:, 0] * 10 +
-00006d90: 2069 6e64 5b3a 2c20 315d 0a0a 2020 2020   ind[:, 1]..    
-00006da0: 6465 6620 5f63 6172 6473 5f74 6f5f 6466  def _cards_to_df
-00006db0: 2863 2c20 646d 6967 5f6e 616d 6573 293a  (c, dmig_names):
-00006dc0: 0a20 2020 2020 2020 2023 2070 756e 6368  .        # punch
-00006dd0: 2066 696c 650a 2020 2020 2020 2020 6465   file.        de
-00006de0: 6620 5f6e 6578 745f 6928 632c 2069 293a  f _next_i(c, i):
-00006df0: 0a20 2020 2020 2020 2020 2020 2077 6869  .            whi
-00006e00: 6c65 2069 203c 206c 656e 2863 2920 616e  le i < len(c) an
-00006e10: 6420 635b 695d 5b30 5d2e 6c6f 7765 7228  d c[i][0].lower(
-00006e20: 2920 6e6f 7420 696e 2064 6d69 675f 6e61  ) not in dmig_na
-00006e30: 6d65 733a 0a20 2020 2020 2020 2020 2020  mes:.           
-00006e40: 2020 2020 2069 202b 3d20 310a 2020 2020       i += 1.    
-00006e50: 2020 2020 2020 2020 7265 7475 726e 2069          return i
-00006e60: 0a0a 2020 2020 2020 2020 6463 7420 3d20  ..        dct = 
-00006e70: 7b7d 0a20 2020 2020 2020 2069 203d 2030  {}.        i = 0
-00006e80: 0a20 2020 2020 2020 2077 6869 6c65 2069  .        while i
-00006e90: 203c 206c 656e 2863 293a 0a20 2020 2020   < len(c):.     
-00006ea0: 2020 2020 2020 2069 6620 646d 6967 5f6e         if dmig_n
-00006eb0: 616d 6573 2069 7320 6e6f 7420 4e6f 6e65  ames is not None
-00006ec0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00006ed0: 2020 6920 3d20 5f6e 6578 745f 6928 632c    i = _next_i(c,
-00006ee0: 2069 290a 2020 2020 2020 2020 2020 2020   i).            
-00006ef0: 2020 2020 6966 2069 203d 3d20 6c65 6e28      if i == len(
-00006f00: 6329 3a0a 2020 2020 2020 2020 2020 2020  c):.            
-00006f10: 2020 2020 2020 2020 6272 6561 6b0a 2020          break.  
-00006f20: 2020 2020 2020 2020 2020 6e61 6d65 203d            name =
-00006f30: 2063 5b69 5d5b 305d 2e6c 6f77 6572 2829   c[i][0].lower()
-00006f40: 0a0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
-00006f50: 666f 726d 3a20 3120 7371 7561 7265 2c20  form: 1 square, 
-00006f60: 3220 7265 6374 2c20 3620 7379 6d6d 6574  2 rect, 6 symmet
-00006f70: 7269 632c 2039 2072 6563 740a 2020 2020  ric, 9 rect.    
-00006f80: 2020 2020 2020 2020 666f 726d 203d 2063          form = c
-00006f90: 5b69 5d5b 325d 0a20 2020 2020 2020 2020  [i][2].         
-00006fa0: 2020 2023 206d 7479 7065 3a20 3120 7265     # mtype: 1 re
-00006fb0: 616c 2c20 3220 646f 7562 6c65 2c20 3320  al, 2 double, 3 
-00006fc0: 636f 6d70 6c65 782c 2034 2063 6f6d 706c  complex, 4 compl
-00006fd0: 6578 2064 6f75 626c 650a 2020 2020 2020  ex double.      
-00006fe0: 2020 2020 2020 6d74 7970 6520 3d20 635b        mtype = c[
-00006ff0: 695d 5b33 5d0a 2020 2020 2020 2020 2020  i][3].          
-00007000: 2020 6e63 6f6c 203d 2063 5b69 5d5b 375d    ncol = c[i][7]
-00007010: 2069 6620 666f 726d 203d 3d20 3920 656c   if form == 9 el
-00007020: 7365 204e 6f6e 650a 0a20 2020 2020 2020  se None..       
-00007030: 2020 2020 2023 2043 6f75 6e74 2044 4f46       # Count DOF
-00007040: 2066 6f72 2044 4d49 4720 6e61 6d65 0a20   for DMIG name. 
-00007050: 2020 2020 2020 2020 2020 206a 203d 2069             j = i
-00007060: 202b 2031 0a20 2020 2020 2020 2020 2020   + 1.           
-00007070: 2072 6f77 5f69 6473 203d 2073 6574 2829   row_ids = set()
-00007080: 0a20 2020 2020 2020 2020 2020 2063 6f6c  .            col
-00007090: 5f69 6473 203d 2073 6574 2829 0a20 2020  _ids = set().   
-000070a0: 2020 2020 2020 2020 2063 6f6c 5f69 6464           col_idd
-000070b0: 6f66 203d 2069 6464 6f66 5f69 6e69 7469  of = iddof_initi
-000070c0: 616c 697a 6572 2829 0a20 2020 2020 2020  alizer().       
-000070d0: 2020 2020 2072 6f77 5f69 6464 6f66 203d       row_iddof =
-000070e0: 2069 6464 6f66 5f69 6e69 7469 616c 697a   iddof_initializ
-000070f0: 6572 2829 0a0a 2020 2020 2020 2020 2020  er()..          
-00007100: 2020 2320 6c6f 6f6b 2061 6372 6f73 7320    # look across 
-00007110: 636f 6c75 6d6e 7320 2865 6163 6820 444d  columns (each DM
-00007120: 4947 2065 6e74 7279 2069 7320 6120 636f  IG entry is a co
-00007130: 6c75 6d6e 290a 2020 2020 2020 2020 2020  lumn).          
-00007140: 2020 7768 696c 6520 6a20 3c20 6c65 6e28    while j < len(
-00007150: 6329 2061 6e64 2063 5b6a 5d5b 305d 2e6c  c) and c[j][0].l
-00007160: 6f77 6572 2829 203d 3d20 6e61 6d65 3a0a  ower() == name:.
-00007170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007180: 6e69 642c 2064 6f66 203d 2063 5b6a 5d5b  nid, dof = c[j][
-00007190: 313a 335d 0a20 2020 2020 2020 2020 2020  1:3].           
-000071a0: 2020 2020 2061 6464 5f69 6464 6f66 2863       add_iddof(c
-000071b0: 6f6c 5f69 6473 2c20 636f 6c5f 6964 646f  ol_ids, col_iddo
-000071c0: 662c 206e 6964 2c20 646f 6629 0a0a 2020  f, nid, dof)..  
-000071d0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-000071e0: 666f 7220 6561 6368 2063 6f6c 756d 6e2c  for each column,
-000071f0: 206c 6f6f 6b20 6163 726f 7373 2072 6f77   look across row
-00007200: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
-00007210: 2020 2072 6f77 6964 7320 3d20 635b 6a5d     rowids = c[j]
-00007220: 5b34 3a3a 345d 0a20 2020 2020 2020 2020  [4::4].         
-00007230: 2020 2020 2020 2072 6f77 646f 6673 203d         rowdofs =
-00007240: 2063 5b6a 5d5b 353a 3a34 5d0a 2020 2020   c[j][5::4].    
-00007250: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00007260: 6e69 642c 2064 6f66 2069 6e20 7a69 7028  nid, dof in zip(
-00007270: 726f 7769 6473 2c20 726f 7764 6f66 7329  rowids, rowdofs)
-00007280: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00007290: 2020 2020 2020 6164 645f 6964 646f 6628        add_iddof(
-000072a0: 726f 775f 6964 732c 2072 6f77 5f69 6464  row_ids, row_idd
-000072b0: 6f66 2c20 6e69 642c 2064 6f66 290a 2020  of, nid, dof).  
-000072c0: 2020 2020 2020 2020 2020 2020 2020 6a20                j 
-000072d0: 2b3d 2031 0a0a 2020 2020 2020 2020 2020  += 1..          
-000072e0: 2020 2320 6372 6561 7465 2064 6174 6166    # create dataf
-000072f0: 7261 6d65 3a0a 2020 2020 2020 2020 2020  rame:.          
-00007300: 2020 6d61 742c 2072 6f77 696e 6465 782c    mat, rowindex,
-00007310: 2063 6f6c 696e 6465 7820 3d20 5f70 7265   colindex = _pre
-00007320: 705f 6461 7461 6672 616d 6528 0a20 2020  p_dataframe(.   
-00007330: 2020 2020 2020 2020 2020 2020 206d 7479               mty
-00007340: 7065 2c20 666f 726d 2c20 726f 775f 6964  pe, form, row_id
-00007350: 732c 2072 6f77 5f69 6464 6f66 2c20 636f  s, row_iddof, co
-00007360: 6c5f 6964 646f 662c 206e 636f 6c0a 2020  l_iddof, ncol.  
-00007370: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
-00007380: 2020 2020 2020 2020 206a 203d 2069 202b           j = i +
-00007390: 2031 0a20 2020 2020 2020 2020 2020 2023   1.            #
-000073a0: 2070 7574 2064 6174 6120 696e 746f 2064   put data into d
-000073b0: 6174 6166 7261 6d65 3a0a 2020 2020 2020  ataframe:.      
-000073c0: 2020 2020 2020 725f 6964 5f64 6f66 203d        r_id_dof =
-000073d0: 205f 6765 745f 3164 5f69 6e64 6578 2872   _get_1d_index(r
-000073e0: 6f77 696e 6465 7829 0a20 2020 2020 2020  owindex).       
-000073f0: 2020 2020 2069 6620 666f 726d 2021 3d20       if form != 
-00007400: 393a 0a20 2020 2020 2020 2020 2020 2020  9:.             
-00007410: 2020 2063 5f69 645f 646f 6620 3d20 5f67     c_id_dof = _g
-00007420: 6574 5f31 645f 696e 6465 7828 636f 6c69  et_1d_index(coli
-00007430: 6e64 6578 290a 2020 2020 2020 2020 2020  ndex).          
-00007440: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00007450: 2020 2020 2020 2020 635f 6964 5f64 6f66          c_id_dof
-00007460: 203d 2063 6f6c 696e 6465 780a 2020 2020   = colindex.    
-00007470: 2020 2020 2020 2020 7768 696c 6520 6a20          while j 
-00007480: 3c20 6c65 6e28 6329 2061 6e64 2063 5b6a  < len(c) and c[j
-00007490: 5d5b 305d 2e6c 6f77 6572 2829 203d 3d20  ][0].lower() == 
-000074a0: 6e61 6d65 3a0a 2020 2020 2020 2020 2020  name:.          
-000074b0: 2020 2020 2020 6e69 642c 2064 6f66 203d        nid, dof =
-000074c0: 2063 5b6a 5d5b 313a 335d 0a20 2020 2020   c[j][1:3].     
-000074d0: 2020 2020 2020 2020 2020 2069 6620 666f             if fo
-000074e0: 726d 2021 3d20 393a 0a20 2020 2020 2020  rm != 9:.       
-000074f0: 2020 2020 2020 2020 2020 2020 206e 6964               nid
-00007500: 203d 206e 6964 202a 2031 3020 2b20 646f   = nid * 10 + do
-00007510: 660a 2020 2020 2020 2020 2020 2020 2020  f.              
-00007520: 2020 6369 203d 206e 702e 7365 6172 6368    ci = np.search
-00007530: 736f 7274 6564 2863 5f69 645f 646f 662c  sorted(c_id_dof,
-00007540: 206e 6964 290a 0a20 2020 2020 2020 2020   nid)..         
-00007550: 2020 2020 2020 2023 2066 6f72 2065 6163         # for eac
-00007560: 6820 636f 6c75 6d6e 2c20 6c6f 6f6b 2061  h column, look a
-00007570: 6372 6f73 7320 726f 7773 3a0a 2020 2020  cross rows:.    
-00007580: 2020 2020 2020 2020 2020 2020 726f 7769              rowi
-00007590: 6473 203d 2063 5b6a 5d5b 343a 3a34 5d0a  ds = c[j][4::4].
-000075a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000075b0: 726f 7764 6f66 7320 3d20 635b 6a5d 5b35  rowdofs = c[j][5
-000075c0: 3a3a 345d 0a20 2020 2020 2020 2020 2020  ::4].           
-000075d0: 2020 2020 2072 6561 6c73 203d 2063 5b6a       reals = c[j
-000075e0: 5d5b 363a 3a34 5d0a 2020 2020 2020 2020  ][6::4].        
-000075f0: 2020 2020 2020 2020 6966 206d 7479 7065          if mtype
-00007600: 203c 2033 3a0a 2020 2020 2020 2020 2020   < 3:.          
-00007610: 2020 2020 2020 2020 2020 666f 7220 6e69            for ni
-00007620: 642c 2064 6f66 2c20 7265 616c 2069 6e20  d, dof, real in 
-00007630: 7a69 7028 726f 7769 6473 2c20 726f 7764  zip(rowids, rowd
-00007640: 6f66 732c 2072 6561 6c73 293a 0a20 2020  ofs, reals):.   
-00007650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007660: 2020 2020 2072 6920 3d20 6e70 2e73 6561       ri = np.sea
-00007670: 7263 6873 6f72 7465 6428 725f 6964 5f64  rchsorted(r_id_d
-00007680: 6f66 2c20 6e69 6420 2a20 3130 202b 2064  of, nid * 10 + d
-00007690: 6f66 290a 2020 2020 2020 2020 2020 2020  of).            
-000076a0: 2020 2020 2020 2020 2020 2020 6d61 745b              mat[
-000076b0: 7269 2c20 6369 5d20 3d20 7265 616c 0a20  ri, ci] = real. 
-000076c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000076d0: 2020 2020 2020 2069 6620 666f 726d 203d         if form =
-000076e0: 3d20 363a 0a20 2020 2020 2020 2020 2020  = 6:.           
-000076f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007700: 206d 6174 5b63 692c 2072 695d 203d 2072   mat[ci, ri] = r
-00007710: 6561 6c0a 2020 2020 2020 2020 2020 2020  eal.            
-00007720: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00007730: 2020 2020 2020 2020 2020 2020 2020 696d                im
-00007740: 6167 7320 3d20 635b 6a5d 5b37 3a3a 345d  ags = c[j][7::4]
-00007750: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00007760: 2020 2020 2066 6f72 206e 6964 2c20 646f       for nid, do
-00007770: 662c 2072 6561 6c2c 2069 6d61 6720 696e  f, real, imag in
-00007780: 207a 6970 2872 6f77 6964 732c 2072 6f77   zip(rowids, row
-00007790: 646f 6673 2c20 7265 616c 732c 2069 6d61  dofs, reals, ima
-000077a0: 6773 293a 0a20 2020 2020 2020 2020 2020  gs):.           
-000077b0: 2020 2020 2020 2020 2020 2020 2076 616c               val
-000077c0: 203d 2072 6561 6c20 2b20 316a 202a 2069   = real + 1j * i
-000077d0: 6d61 670a 2020 2020 2020 2020 2020 2020  mag.            
-000077e0: 2020 2020 2020 2020 2020 2020 7269 203d              ri =
-000077f0: 206e 702e 7365 6172 6368 736f 7274 6564   np.searchsorted
-00007800: 2872 5f69 645f 646f 662c 206e 6964 202a  (r_id_dof, nid *
-00007810: 2031 3020 2b20 646f 6629 0a20 2020 2020   10 + dof).     
-00007820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007830: 2020 206d 6174 5b72 692c 2063 695d 203d     mat[ri, ci] =
-00007840: 2076 616c 0a20 2020 2020 2020 2020 2020   val.           
-00007850: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00007860: 666f 726d 203d 3d20 363a 0a20 2020 2020  form == 6:.     
-00007870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007880: 2020 2020 2020 206d 6174 5b63 692c 2072         mat[ci, r
-00007890: 695d 203d 2076 616c 0a20 2020 2020 2020  i] = val.       
-000078a0: 2020 2020 2020 2020 206a 202b 3d20 310a           j += 1.
-000078b0: 2020 2020 2020 2020 2020 2020 6920 3d20              i = 
-000078c0: 6a0a 2020 2020 2020 2020 2020 2020 6463  j.            dc
-000078d0: 745b 6e61 6d65 5d20 3d20 7064 2e44 6174  t[name] = pd.Dat
-000078e0: 6146 7261 6d65 286d 6174 2c20 696e 6465  aFrame(mat, inde
-000078f0: 783d 726f 7769 6e64 6578 2c20 636f 6c75  x=rowindex, colu
-00007900: 6d6e 733d 636f 6c69 6e64 6578 290a 2020  mns=colindex).  
-00007910: 2020 2020 2020 7265 7475 726e 2064 6374        return dct
-00007920: 0a0a 2020 2020 6465 6620 5f72 6561 645f  ..    def _read_
-00007930: 6f70 325f 646d 6967 286f 322c 2064 6d69  op2_dmig(o2, dmi
-00007940: 675f 6e61 6d65 7329 3a0a 2020 2020 2020  g_names):.      
-00007950: 2020 6f32 2e5f 6669 6c65 682e 7365 656b    o2._fileh.seek
-00007960: 286f 322e 5f70 6f73 7468 6561 6465 7270  (o2._postheaderp
-00007970: 6f73 290a 2020 2020 2020 2020 6463 7420  os).        dct 
-00007980: 3d20 7b7d 0a20 2020 2020 2020 206e 616d  = {}.        nam
-00007990: 652c 2074 7261 696c 6572 2c20 6462 7479  e, trailer, dbty
-000079a0: 7065 203d 206f 322e 7264 6f70 326e 7428  pe = o2.rdop2nt(
-000079b0: 290a 2020 2020 2020 2020 7768 696c 6520  ).        while 
-000079c0: 6e61 6d65 2069 7320 6e6f 7420 4e6f 6e65  name is not None
-000079d0: 3a0a 2020 2020 2020 2020 2020 2020 6e61  :.            na
-000079e0: 6d65 203d 206e 616d 652e 6c6f 7765 7228  me = name.lower(
-000079f0: 290a 2020 2020 2020 2020 2020 2020 2320  ).            # 
-00007a00: 7072 696e 7428 6627 6f70 323a 2066 6f75  print(f'op2: fou
-00007a10: 6e64 207b 6e61 6d65 7d27 290a 2020 2020  nd {name}').    
-00007a20: 2020 2020 2020 2020 6966 2064 6d69 675f          if dmig_
-00007a30: 6e61 6d65 7320 6973 206e 6f74 204e 6f6e  names is not Non
-00007a40: 6520 616e 6420 6e61 6d65 2e6c 6f77 6572  e and name.lower
-00007a50: 2829 206e 6f74 2069 6e20 646d 6967 5f6e  () not in dmig_n
-00007a60: 616d 6573 3a0a 2020 2020 2020 2020 2020  ames:.          
-00007a70: 2020 2020 2020 6f32 2e73 6b69 706f 7032        o2.skipop2
-00007a80: 7461 626c 6528 290a 2020 2020 2020 2020  table().        
-00007a90: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00007aa0: 2020 2020 2020 2020 2020 7265 6320 3d20            rec = 
-00007ab0: 6f32 2e72 646f 7032 7265 636f 7264 2829  o2.rdop2record()
-00007ac0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00007ad0: 2069 6620 6e70 2e61 6c6c 2872 6563 5b3a   if np.all(rec[:
-00007ae0: 335d 203d 3d20 2831 3134 2c20 312c 2031  3] == (114, 1, 1
-00007af0: 3230 2929 3a0a 2020 2020 2020 2020 2020  20)):.          
-00007b00: 2020 2020 2020 2020 2020 6463 745b 6e61            dct[na
-00007b10: 6d65 5d20 3d20 7265 630a 2020 2020 2020  me] = rec.      
-00007b20: 2020 2020 2020 2020 2020 6f32 2e67 6f5f            o2.go_
-00007b30: 746f 5f6e 6578 745f 6462 2829 0a20 2020  to_next_db().   
-00007b40: 2020 2020 2020 2020 206e 616d 652c 2074           name, t
-00007b50: 7261 696c 6572 2c20 6462 7479 7065 203d  railer, dbtype =
-00007b60: 206f 322e 7264 6f70 326e 7428 290a 2020   o2.rdop2nt().  
-00007b70: 2020 2020 2020 7265 7475 726e 2064 6374        return dct
-00007b80: 0a0a 2020 2020 6465 6620 5f72 6563 735f  ..    def _recs_
-00007b90: 746f 5f64 6628 7265 6373 293a 0a20 2020  to_df(recs):.   
-00007ba0: 2020 2020 2064 6374 203d 207b 7d0a 2020       dct = {}.  
-00007bb0: 2020 2020 2020 666f 7220 6e61 6d65 2c20        for name, 
-00007bc0: 7265 6320 696e 2072 6563 732e 6974 656d  rec in recs.item
-00007bd0: 7328 293a 0a20 2020 2020 2020 2020 2020  s():.           
-00007be0: 2066 6f72 6d20 3d20 7265 635b 365d 0a20   form = rec[6]. 
-00007bf0: 2020 2020 2020 2020 2020 2023 206d 7479             # mty
-00007c00: 7065 3a20 3120 7265 616c 2c20 3220 646f  pe: 1 real, 2 do
-00007c10: 7562 6c65 2c20 3320 636f 6d70 6c65 782c  uble, 3 complex,
-00007c20: 2034 2063 6f6d 706c 6578 2064 6f75 626c   4 complex doubl
-00007c30: 650a 2020 2020 2020 2020 2020 2020 6d74  e.            mt
-00007c40: 7970 6520 3d20 7265 635b 375d 0a20 2020  ype = rec[7].   
-00007c50: 2020 2020 2020 2020 206e 636f 6c20 3d20           ncol = 
-00007c60: 7265 635b 3131 5d20 6966 2066 6f72 6d20  rec[11] if form 
-00007c70: 3d3d 2039 2065 6c73 6520 4e6f 6e65 0a0a  == 9 else None..
-00007c80: 2020 2020 2020 2020 2020 2020 6966 206d              if m
-00007c90: 7479 7065 203e 2032 3a0a 2020 2020 2020  type > 2:.      
-00007ca0: 2020 2020 2020 2020 2020 696e 7473 5f70            ints_p
-00007cb0: 6572 5f6e 756d 6265 7220 3d20 3220 2a20  er_number = 2 * 
-00007cc0: 286d 7479 7065 202d 2032 290a 2020 2020  (mtype - 2).    
-00007cd0: 2020 2020 2020 2020 2020 2020 6474 7970              dtyp
-00007ce0: 6520 3d20 6e70 2e63 6f6d 706c 6578 3132  e = np.complex12
-00007cf0: 3820 6966 206d 7479 7065 203d 3d20 3420  8 if mtype == 4 
-00007d00: 656c 7365 206e 702e 636f 6d70 6c65 7836  else np.complex6
-00007d10: 340a 2020 2020 2020 2020 2020 2020 656c  4.            el
-00007d20: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00007d30: 2020 2020 696e 7473 5f70 6572 5f6e 756d      ints_per_num
-00007d40: 6265 7220 3d20 6d74 7970 650a 2020 2020  ber = mtype.    
-00007d50: 2020 2020 2020 2020 2020 2020 6474 7970              dtyp
-00007d60: 6520 3d20 6e70 2e66 6c6f 6174 3634 2069  e = np.float64 i
-00007d70: 6620 6d74 7970 6520 3d3d 2032 2065 6c73  f mtype == 2 els
-00007d80: 6520 6e70 2e66 6c6f 6174 3332 0a20 2020  e np.float32.   
-00007d90: 2020 2020 2020 2020 2073 7465 7020 3d20           step = 
-00007da0: 3220 2b20 696e 7473 5f70 6572 5f6e 756d  2 + ints_per_num
-00007db0: 6265 7220 2023 2072 6f77 2069 642c 2064  ber  # row id, d
-00007dc0: 6f66 2c20 3c6e 756d 6265 723e 0a0a 2020  of, <number>..  
-00007dd0: 2020 2020 2020 2020 2020 2320 436f 756e            # Coun
-00007de0: 7420 444f 4620 666f 7220 444d 4947 0a20  t DOF for DMIG. 
-00007df0: 2020 2020 2020 2020 2020 2072 6f77 5f69             row_i
-00007e00: 6473 203d 2073 6574 2829 0a20 2020 2020  ds = set().     
-00007e10: 2020 2020 2020 2063 6f6c 5f69 6473 203d         col_ids =
-00007e20: 2073 6574 2829 0a20 2020 2020 2020 2020   set().         
-00007e30: 2020 2063 6f6c 5f69 6464 6f66 203d 2069     col_iddof = i
-00007e40: 6464 6f66 5f69 6e69 7469 616c 697a 6572  ddof_initializer
-00007e50: 2829 0a20 2020 2020 2020 2020 2020 2072  ().            r
-00007e60: 6f77 5f69 6464 6f66 203d 2069 6464 6f66  ow_iddof = iddof
-00007e70: 5f69 6e69 7469 616c 697a 6572 2829 0a0a  _initializer()..
-00007e80: 2020 2020 2020 2020 2020 2020 2320 4c6f              # Lo
-00007e90: 6f6b 2061 6372 6f73 7320 636f 6c75 6d6e  ok across column
-00007ea0: 7320 666f 7220 6964 2c20 646f 6620 7061  s for id, dof pa
-00007eb0: 6972 732e 2057 6974 6869 6e20 6561 6368  irs. Within each
-00007ec0: 0a20 2020 2020 2020 2020 2020 2023 2063  .            # c
-00007ed0: 6f6c 756d 6e2c 206c 6f6f 6b20 6163 726f  olumn, look acro
-00007ee0: 7373 2072 6f77 7320 666f 7220 6964 2c20  ss rows for id, 
-00007ef0: 646f 6620 7061 6972 732e 0a0a 2020 2020  dof pairs...    
-00007f00: 2020 2020 2020 2020 2320 2d20 6561 6368          # - each
-00007f10: 2044 4d49 4720 656e 7472 7920 6973 2061   DMIG entry is a
-00007f20: 2063 6f6c 756d 6e0a 2020 2020 2020 2020   column.        
-00007f30: 2020 2020 2320 2d20 656e 6420 6f66 2065      # - end of e
-00007f40: 6163 6820 444d 4947 2065 6e74 7279 2069  ach DMIG entry i
-00007f50: 7320 6d61 726b 6564 2077 6974 6820 726f  s marked with ro
-00007f60: 773a 0a20 2020 2020 2020 2020 2020 2023  w:.            #
-00007f70: 2020 2020 205b 6964 2c20 646f 665d 203d       [id, dof] =
-00007f80: 205b 2d31 2c20 2d31 5d0a 0a20 2020 2020   [-1, -1]..     
-00007f90: 2020 2020 2020 2023 2031 3220 2620 3133         # 12 & 13
-00007fa0: 2034 2d62 7974 6520 696e 7465 6765 7273   4-byte integers
-00007fb0: 2061 7265 2031 7374 2063 6f6c 2069 642c   are 1st col id,
-00007fc0: 2064 6f66 2070 6169 720a 2020 2020 2020   dof pair.      
-00007fd0: 2020 2020 2020 6a20 3d20 3132 0a20 2020        j = 12.   
-00007fe0: 2020 2020 2020 2020 2077 6869 6c65 206a           while j
-00007ff0: 203c 206c 656e 2872 6563 2920 2d20 323a   < len(rec) - 2:
-00008000: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00008010: 206e 6964 2c20 646f 6620 3d20 7265 635b   nid, dof = rec[
-00008020: 6a20 3a20 6a20 2b20 325d 0a20 2020 2020  j : j + 2].     
-00008030: 2020 2020 2020 2020 2020 2061 6464 5f69             add_i
-00008040: 6464 6f66 2863 6f6c 5f69 6473 2c20 636f  ddof(col_ids, co
-00008050: 6c5f 6964 646f 662c 206e 6964 2c20 646f  l_iddof, nid, do
-00008060: 6629 0a0a 2020 2020 2020 2020 2020 2020  f)..            
-00008070: 2020 2020 6a20 2b3d 2032 0a20 2020 2020      j += 2.     
-00008080: 2020 2020 2020 2020 2020 2072 6f77 6964             rowid
-00008090: 7320 3d20 7265 635b 6a3a 3a73 7465 705d  s = rec[j::step]
-000080a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000080b0: 2072 6f77 646f 6673 203d 2072 6563 5b6a   rowdofs = rec[j
-000080c0: 202b 2031 203a 3a20 7374 6570 5d0a 2020   + 1 :: step].  
-000080d0: 2020 2020 2020 2020 2020 2020 2020 666f                fo
-000080e0: 7220 692c 2028 6e69 642c 2064 6f66 2920  r i, (nid, dof) 
-000080f0: 696e 2065 6e75 6d65 7261 7465 287a 6970  in enumerate(zip
-00008100: 2872 6f77 6964 732c 2072 6f77 646f 6673  (rowids, rowdofs
-00008110: 2929 3a0a 2020 2020 2020 2020 2020 2020  )):.            
-00008120: 2020 2020 2020 2020 6966 206e 6964 203d          if nid =
-00008130: 3d20 2d31 3a0a 2020 2020 2020 2020 2020  = -1:.          
-00008140: 2020 2020 2020 2020 2020 2020 2020 6a20                j 
-00008150: 2b3d 2073 7465 7020 2a20 6920 2b20 320a  += step * i + 2.
-00008160: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008170: 2020 2020 2020 2020 6272 6561 6b0a 2020          break.  
+00002360: 6966 2064 6f5f 6d61 7463 683a 0a20 2020  if do_match:.   
+00002370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002380: 2069 6620 6973 6d61 7463 6828 6c69 6e65   if ismatch(line
+00002390: 2c20 7072 6f67 293a 0a20 2020 2020 2020  , prog):.       
+000023a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000023b0: 2064 6f5f 6d61 7463 6820 3d20 7969 656c   do_match = yiel
+000023c0: 6420 6c69 6e65 0a0a 2020 2020 2020 2020  d line..        
+000023d0: 646f 5f6d 6174 6368 203d 2079 6965 6c64  do_match = yield
+000023e0: 204e 6f6e 6520 2023 206d 6172 6b20 7468   None  # mark th
+000023f0: 6520 656e 6420 6f66 2069 6e70 7574 0a20  e end of input. 
+00002400: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00002410: 2063 6f6d 6d65 6e74 5f6c 6973 7420 3d20   comment_list = 
+00002420: 5b5d 0a20 2020 2020 2020 2066 6f72 206c  [].        for l
+00002430: 696e 6520 696e 2066 3a0a 2020 2020 2020  ine in f:.      
+00002440: 2020 2020 2020 6966 206c 696e 652e 7374        if line.st
+00002450: 6172 7473 7769 7468 2822 2422 293a 0a20  artswith("$"):. 
+00002460: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00002470: 6f6d 6d65 6e74 5f6c 6973 742e 6170 7065  omment_list.appe
+00002480: 6e64 286c 696e 6529 0a20 2020 2020 2020  nd(line).       
+00002490: 2020 2020 2020 2020 2063 6f6e 7469 6e75           continu
+000024a0: 650a 2020 2020 2020 2020 2020 2020 6c69  e.            li
+000024b0: 6e65 203d 206c 696e 652e 6578 7061 6e64  ne = line.expand
+000024c0: 7461 6273 2829 0a0a 2020 2020 2020 2020  tabs()..        
+000024d0: 2020 2020 2320 7468 6973 2069 7320 7665      # this is ve
+000024e0: 7279 206d 7563 6820 6c69 6b65 2061 626f  ry much like abo
+000024f0: 7665 2c20 736f 2073 6565 2074 686f 7365  ve, so see those
+00002500: 0a20 2020 2020 2020 2020 2020 2023 2063  .            # c
+00002510: 6f6d 6d65 6e74 732e 2061 6464 6564 2063  omments. added c
+00002520: 6f6d 6d65 6e74 7320 7065 7274 6169 6e20  omments pertain 
+00002530: 746f 2068 616e 646c 696e 6720 636f 6d6d  to handling comm
+00002540: 656e 7473 0a20 2020 2020 2020 2020 2020  ents.           
+00002550: 2069 6620 646f 5f6d 6174 6368 3a0a 2020   if do_match:.  
+00002560: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00002570: 2069 736d 6174 6368 286c 696e 652c 2070   ismatch(line, p
+00002580: 726f 6729 3a0a 2020 2020 2020 2020 2020  rog):.          
+00002590: 2020 2020 2020 2020 2020 5f68 616e 646c            _handl
+000025a0: 655f 636f 6d6d 656e 7473 2863 6f6d 6d65  e_comments(comme
+000025b0: 6e74 5f6c 6973 742c 2056 616c 7329 0a20  nt_list, Vals). 
+000025c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000025d0: 2020 2064 6f5f 6d61 7463 6820 3d20 7969     do_match = yi
+000025e0: 656c 6420 6c69 6e65 0a20 2020 2020 2020  eld line.       
+000025f0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00002600: 2020 2020 2020 2020 2020 2064 6f5f 6d61             do_ma
+00002610: 7463 6820 3d20 7969 656c 6420 6c69 6e65  tch = yield line
+00002620: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00002630: 2069 6620 646f 5f6d 6174 6368 3a0a 2020   if do_match:.  
+00002640: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002650: 2020 6966 2069 736d 6174 6368 286c 696e    if ismatch(lin
+00002660: 652c 2070 726f 6729 3a0a 2020 2020 2020  e, prog):.      
+00002670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002680: 2020 5f68 616e 646c 655f 636f 6d6d 656e    _handle_commen
+00002690: 7473 2863 6f6d 6d65 6e74 5f6c 6973 742c  ts(comment_list,
+000026a0: 2056 616c 7329 0a20 2020 2020 2020 2020   Vals).         
+000026b0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+000026c0: 6f5f 6d61 7463 6820 3d20 7969 656c 6420  o_match = yield 
+000026d0: 6c69 6e65 0a0a 2020 2020 2020 2020 646f  line..        do
+000026e0: 5f6d 6174 6368 203d 2079 6965 6c64 204e  _match = yield N
+000026f0: 6f6e 6520 2023 206d 6172 6b20 7468 6520  one  # mark the 
+00002700: 656e 6420 6f66 2069 6e70 7574 0a20 2020  end of input.   
+00002710: 2020 2020 205f 6861 6e64 6c65 5f63 6f6d       _handle_com
+00002720: 6d65 6e74 7328 636f 6d6d 656e 745f 6c69  ments(comment_li
+00002730: 7374 2c20 5661 6c73 290a 0a0a 6465 6620  st, Vals)...def 
+00002740: 5f72 6466 6978 6564 2866 6974 6572 2c20  _rdfixed(fiter, 
+00002750: 732c 206e 2c20 636f 6e63 6861 722c 2062  s, n, conchar, b
+00002760: 6c61 6e6b 2c20 746f 6c69 7374 2c20 6b65  lank, tolist, ke
+00002770: 6570 5f6e 616d 6529 3a0a 2020 2020 2222  ep_name):.    ""
+00002780: 220a 2020 2020 5265 6164 2066 6978 6564  ".    Read fixed
+00002790: 2066 6965 6c64 2063 6172 6473 3a0a 2020   field cards:.  
+000027a0: 2020 6669 7465 7220 3a20 6669 6c65 2069    fiter : file i
+000027b0: 7465 7261 746f 720a 2020 2020 7320 3a20  terator.    s : 
+000027c0: 7374 7269 6e67 2c20 6375 7272 656e 7420  string, current 
+000027d0: 6c69 6e65 2066 726f 6d20 6669 6c65 2028  line from file (
+000027e0: 6361 7264 2073 7461 7274 290a 2020 2020  card start).    
+000027f0: 6e20 3a20 6669 656c 6420 7769 6474 682c  n : field width,
+00002800: 2038 206f 7220 3136 0a20 2020 2063 6f6e   8 or 16.    con
+00002810: 6368 6172 203a 2073 7472 696e 672c 2073  char : string, s
+00002820: 6574 206f 6620 6368 6172 7320 7468 6174  et of chars that
+00002830: 206d 616b 6520 7570 2063 6f6e 7469 6e75   make up continu
+00002840: 6174 696f 6e0a 2020 2020 2020 2020 2020  ation.          
+00002850: 2020 2020 2d20 6569 7468 6572 2027 202b      - either ' +
+00002860: 2720 6f72 2027 2a27 0a20 2020 2062 6c61  ' or '*'.    bla
+00002870: 6e6b 203a 2076 616c 7565 2074 6f20 7573  nk : value to us
+00002880: 6520 666f 7220 626c 616e 6b20 6669 656c  e for blank fiel
+00002890: 6473 2061 6e64 2073 7472 696e 672d 7661  ds and string-va
+000028a0: 6c75 6564 2066 6965 6c64 730a 2020 2020  lued fields.    
+000028b0: 746f 6c69 7374 203a 2069 6620 5472 7565  tolist : if True
+000028c0: 2c20 7265 7475 726e 206c 6973 742c 2065  , return list, e
+000028d0: 6c73 6520 7265 7475 726e 206e 702e 6172  lse return np.ar
+000028e0: 7261 793b 2073 7472 696e 6773 2061 7265  ray; strings are
+000028f0: 0a20 2020 2020 2020 2020 2020 2020 6b65  .             ke
+00002900: 7074 2069 6e20 7468 6973 2063 6173 6520  pt in this case 
+00002910: 2869 6e73 7465 6164 206f 6620 6265 696e  (instead of bein
+00002920: 6720 7475 726e 6564 2069 6e74 6f20 6062  g turned into `b
+00002930: 6c61 6e6b 6029 0a20 2020 206b 6565 705f  lank`).    keep_
+00002940: 6e61 6d65 203a 2069 6620 5472 7565 2061  name : if True a
+00002950: 6e64 2074 6f6c 6973 7420 6973 2054 7275  nd tolist is Tru
+00002960: 652c 206b 6565 7020 7468 6520 6361 7264  e, keep the card
+00002970: 206e 616d 6520 696e 2074 6865 0a20 2020   name in the.   
+00002980: 2020 2020 2020 2020 2020 2020 206f 7574               out
+00002990: 7075 740a 2020 2020 2222 220a 2020 2020  put.    """.    
+000029a0: 7661 6c73 203d 205b 5d0a 2020 2020 6c65  vals = [].    le
+000029b0: 6e67 7468 203d 206c 656e 2873 290a 2020  ngth = len(s).  
+000029c0: 2020 6920 3d20 2d31 0a20 2020 206e 6669    i = -1.    nfi
+000029d0: 656c 6473 203d 202d 310a 2020 2020 6966  elds = -1.    if
+000029e0: 206e 203e 2038 3a0a 2020 2020 2020 2020   n > 8:.        
+000029f0: 696e 6320 3d20 3420 2023 206e 756d 6265  inc = 4  # numbe
+00002a00: 7220 6f66 2076 616c 7565 7320 7065 7220  r of values per 
+00002a10: 6c69 6e65 0a20 2020 2065 6c73 653a 0a20  line.    else:. 
+00002a20: 2020 2020 2020 2069 6e63 203d 2038 0a0a         inc = 8..
+00002a30: 2020 2020 7320 3d20 5f70 726f 635f 6c69      s = _proc_li
+00002a40: 6e65 2873 5b3a 3732 5d29 0a0a 2020 2020  ne(s[:72])..    
+00002a50: 6966 2074 6f6c 6973 7420 616e 6420 6b65  if tolist and ke
+00002a60: 6570 5f6e 616d 653a 0a20 2020 2020 2020  ep_name:.       
+00002a70: 2023 2072 6561 6420 6361 7264 206e 616d   # read card nam
+00002a80: 6520 6f75 7473 6964 6520 6f66 206c 6f6f  e outside of loo
+00002a90: 703a 0a20 2020 2020 2020 2076 203d 206e  p:.        v = n
+00002aa0: 6173 5f73 7363 616e 6628 735b 3a38 5d2c  as_sscanf(s[:8],
+00002ab0: 2074 6f6c 6973 7429 0a20 2020 2020 2020   tolist).       
+00002ac0: 2076 616c 732e 6170 7065 6e64 2876 290a   vals.append(v).
+00002ad0: 0a20 2020 206d 6178 7374 6172 7420 3d20  .    maxstart = 
+00002ae0: 3732 202d 206e 0a20 2020 2077 6869 6c65  72 - n.    while
+00002af0: 2031 3a0a 2020 2020 2020 2020 666f 7220   1:.        for 
+00002b00: 6920 696e 2072 616e 6765 2869 2c20 6e66  i in range(i, nf
+00002b10: 6965 6c64 7329 3a0a 2020 2020 2020 2020  ields):.        
+00002b20: 2020 2020 7661 6c73 2e61 7070 656e 6428      vals.append(
+00002b30: 626c 616e 6b29 0a20 2020 2020 2020 2069  blank).        i
+00002b40: 203d 206e 6669 656c 6473 0a20 2020 2020   = nfields.     
+00002b50: 2020 206a 203d 2038 0a20 2020 2020 2020     j = 8.       
+00002b60: 2077 6869 6c65 206a 203c 3d20 6d61 7873   while j <= maxs
+00002b70: 7461 7274 2061 6e64 206c 656e 6774 6820  tart and length 
+00002b80: 3e20 6a3a 0a20 2020 2020 2020 2020 2020  > j:.           
+00002b90: 2069 202b 3d20 310a 2020 2020 2020 2020   i += 1.        
+00002ba0: 2020 2020 7620 3d20 6e61 735f 7373 6361      v = nas_ssca
+00002bb0: 6e66 2873 5b6a 203a 206a 202b 206e 5d2c  nf(s[j : j + n],
+00002bc0: 2074 6f6c 6973 7429 0a20 2020 2020 2020   tolist).       
+00002bd0: 2020 2020 2069 6620 7620 6973 206e 6f74       if v is not
+00002be0: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+00002bf0: 2020 2020 2020 2076 616c 732e 6170 7065         vals.appe
+00002c00: 6e64 2876 290a 2020 2020 2020 2020 2020  nd(v).          
+00002c10: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00002c20: 2020 2020 2020 2020 7661 6c73 2e61 7070          vals.app
+00002c30: 656e 6428 626c 616e 6b29 0a20 2020 2020  end(blank).     
+00002c40: 2020 2020 2020 206a 202b 3d20 6e0a 2020         j += n.  
+00002c50: 2020 2020 2020 7320 3d20 6669 7465 722e        s = fiter.
+00002c60: 7365 6e64 2846 616c 7365 290a 2020 2020  send(False).    
+00002c70: 2020 2020 6966 2073 2069 7320 4e6f 6e65      if s is None
+00002c80: 206f 7220 6c65 6e28 7329 203d 3d20 3020   or len(s) == 0 
+00002c90: 6f72 2063 6f6e 6368 6172 2e66 696e 6428  or conchar.find(
+00002ca0: 735b 305d 2920 3c20 303a 0a20 2020 2020  s[0]) < 0:.     
+00002cb0: 2020 2020 2020 2062 7265 616b 0a20 2020         break.   
+00002cc0: 2020 2020 2073 203d 205f 7072 6f63 5f6c       s = _proc_l
+00002cd0: 696e 6528 735b 3a37 325d 290a 2020 2020  ine(s[:72]).    
+00002ce0: 2020 2020 6c65 6e67 7468 203d 206c 656e      length = len
+00002cf0: 2873 290a 2020 2020 2020 2020 6e66 6965  (s).        nfie
+00002d00: 6c64 7320 2b3d 2069 6e63 0a20 2020 2072  lds += inc.    r
+00002d10: 6574 7572 6e20 7661 6c73 0a0a 0a64 6566  eturn vals...def
+00002d20: 205f 7264 636f 6d6d 6128 6669 7465 722c   _rdcomma(fiter,
+00002d30: 2073 2c20 636f 6e63 6861 722c 2062 6c61   s, conchar, bla
+00002d40: 6e6b 2c20 746f 6c69 7374 2c20 6b65 6570  nk, tolist, keep
+00002d50: 5f6e 616d 6529 3a0a 2020 2020 2222 220a  _name):.    """.
+00002d60: 2020 2020 5265 6164 2063 6f6d 6d61 2064      Read comma d
+00002d70: 656c 696d 6974 6564 2063 6172 6473 3a0a  elimited cards:.
+00002d80: 2020 2020 6669 7465 7220 3a20 6669 6c65      fiter : file
+00002d90: 2069 7465 7261 746f 720a 2020 2020 7320   iterator.    s 
+00002da0: 3a20 7374 7269 6e67 2c20 6375 7272 656e  : string, curren
+00002db0: 7420 6c69 6e65 2066 726f 6d20 6669 6c65  t line from file
+00002dc0: 2028 6361 7264 2073 7461 7274 290a 2020   (card start).  
+00002dd0: 2020 6e20 3a20 6669 656c 6420 7769 6474    n : field widt
+00002de0: 682c 2038 206f 7220 3136 0a20 2020 2063  h, 8 or 16.    c
+00002df0: 6f6e 6368 6172 203a 2073 7472 696e 672c  onchar : string,
+00002e00: 2073 6574 206f 6620 6368 6172 7320 7468   set of chars th
+00002e10: 6174 206d 616b 6520 7570 2063 6f6e 7469  at make up conti
+00002e20: 6e75 6174 696f 6e0a 2020 2020 2020 2020  nuation.        
+00002e30: 2020 2020 2020 2d20 2720 2b2c 2027 0a20        - ' +, '. 
+00002e40: 2020 2062 6c61 6e6b 203a 2076 616c 7565     blank : value
+00002e50: 2074 6f20 7573 6520 666f 7220 626c 616e   to use for blan
+00002e60: 6b20 6669 656c 6473 2061 6e64 2073 7472  k fields and str
+00002e70: 696e 672d 7661 6c75 6564 2066 6965 6c64  ing-valued field
+00002e80: 730a 2020 2020 746f 6c69 7374 203a 2069  s.    tolist : i
+00002e90: 6620 5472 7565 2c20 7265 7475 726e 206c  f True, return l
+00002ea0: 6973 742c 2065 6c73 6520 7265 7475 726e  ist, else return
+00002eb0: 206e 702e 6172 7261 793b 2073 7472 696e   np.array; strin
+00002ec0: 6773 2061 7265 0a20 2020 2020 2020 2020  gs are.         
+00002ed0: 2020 2020 6b65 7074 2069 6e20 7468 6973      kept in this
+00002ee0: 2063 6173 6520 2869 6e73 7465 6164 206f   case (instead o
+00002ef0: 6620 6265 696e 6720 7475 726e 6564 2069  f being turned i
+00002f00: 6e74 6f20 6062 6c61 6e6b 6029 0a20 2020  nto `blank`).   
+00002f10: 206b 6565 705f 6e61 6d65 203a 2069 6620   keep_name : if 
+00002f20: 5472 7565 2061 6e64 2074 6f6c 6973 7420  True and tolist 
+00002f30: 6973 2054 7275 652c 206b 6565 7020 7468  is True, keep th
+00002f40: 6520 6361 7264 206e 616d 6520 696e 2074  e card name in t
+00002f50: 6865 0a20 2020 2020 2020 2020 2020 2020  he.             
+00002f60: 2020 206f 7574 7075 740a 2020 2020 2222     output.    ""
+00002f70: 220a 2020 2020 7661 6c73 203d 205b 5d0a  ".    vals = [].
+00002f80: 2020 2020 6920 3d20 2d31 0a20 2020 206e      i = -1.    n
+00002f90: 6669 656c 6473 203d 202d 310a 2020 2020  fields = -1.    
+00002fa0: 696e 6320 3d20 380a 2020 2020 7374 6172  inc = 8.    star
+00002fb0: 745f 6669 656c 6420 3d20 3020 6966 2028  t_field = 0 if (
+00002fc0: 746f 6c69 7374 2061 6e64 206b 6565 705f  tolist and keep_
+00002fd0: 6e61 6d65 2920 656c 7365 2031 0a20 2020  name) else 1.   
+00002fe0: 2073 203d 205f 7072 6f63 5f6c 696e 6528   s = _proc_line(
+00002ff0: 7329 0a20 2020 2077 6869 6c65 2031 3a0a  s).    while 1:.
+00003000: 2020 2020 2020 2020 666f 7220 6920 696e          for i in
+00003010: 2072 616e 6765 2869 2c20 6e66 6965 6c64   range(i, nfield
+00003020: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
+00003030: 7661 6c73 2e61 7070 656e 6428 626c 616e  vals.append(blan
+00003040: 6b29 0a20 2020 2020 2020 2069 203d 206e  k).        i = n
+00003050: 6669 656c 6473 0a20 2020 2020 2020 2074  fields.        t
+00003060: 6f6b 203d 2073 2e73 706c 6974 2822 2c22  ok = s.split(","
+00003070: 290a 2020 2020 2020 2020 6c65 6e74 6f6b  ).        lentok
+00003080: 203d 206d 696e 286c 656e 2874 6f6b 292c   = min(len(tok),
+00003090: 2039 290a 2020 2020 2020 2020 666f 7220   9).        for 
+000030a0: 6a20 696e 2072 616e 6765 2873 7461 7274  j in range(start
+000030b0: 5f66 6965 6c64 2c20 6c65 6e74 6f6b 293a  _field, lentok):
+000030c0: 0a20 2020 2020 2020 2020 2020 2069 202b  .            i +
+000030d0: 3d20 310a 2020 2020 2020 2020 2020 2020  = 1.            
+000030e0: 7620 3d20 6e61 735f 7373 6361 6e66 2874  v = nas_sscanf(t
+000030f0: 6f6b 5b6a 5d2c 2074 6f6c 6973 7429 0a20  ok[j], tolist). 
+00003100: 2020 2020 2020 2020 2020 2069 6620 7620             if v 
+00003110: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+00003120: 2020 2020 2020 2020 2020 2020 2076 616c               val
+00003130: 732e 6170 7065 6e64 2876 290a 2020 2020  s.append(v).    
+00003140: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00003150: 2020 2020 2020 2020 2020 2020 2020 7661                va
+00003160: 6c73 2e61 7070 656e 6428 626c 616e 6b29  ls.append(blank)
+00003170: 0a20 2020 2020 2020 2023 2066 6972 7374  .        # first
+00003180: 2066 6965 6c64 2066 6f72 2063 6f6e 7469   field for conti
+00003190: 6e75 6174 696f 6e20 6361 7264 7320 7769  nuation cards wi
+000031a0: 6c6c 206e 6576 6572 2062 6520 7265 7461  ll never be reta
+000031b0: 696e 6564 3a0a 2020 2020 2020 2020 7374  ined:.        st
+000031c0: 6172 745f 6669 656c 6420 3d20 310a 2020  art_field = 1.  
+000031d0: 2020 2020 2020 7320 3d20 6669 7465 722e        s = fiter.
+000031e0: 7365 6e64 2846 616c 7365 290a 2020 2020  send(False).    
+000031f0: 2020 2020 6966 2073 2069 7320 4e6f 6e65      if s is None
+00003200: 206f 7220 6c65 6e28 7329 203d 3d20 3020   or len(s) == 0 
+00003210: 6f72 2063 6f6e 6368 6172 2e66 696e 6428  or conchar.find(
+00003220: 735b 305d 2920 3c20 303a 0a20 2020 2020  s[0]) < 0:.     
+00003230: 2020 2020 2020 2062 7265 616b 0a20 2020         break.   
+00003240: 2020 2020 2073 203d 205f 7072 6f63 5f6c       s = _proc_l
+00003250: 696e 6528 7329 0a20 2020 2020 2020 206e  ine(s).        n
+00003260: 6669 656c 6473 202b 3d20 696e 630a 2020  fields += inc.  
+00003270: 2020 7265 7475 726e 2076 616c 730a 0a0a    return vals...
+00003280: 4067 7569 746f 6f6c 732e 7265 6164 5f74  @guitools.read_t
+00003290: 6578 745f 6669 6c65 0a64 6566 2072 6463  ext_file.def rdc
+000032a0: 6172 6473 280a 2020 2020 662c 0a20 2020  ards(.    f,.   
+000032b0: 206e 616d 652c 0a20 2020 2062 6c61 6e6b   name,.    blank
+000032c0: 3d4e 6f6e 652c 0a20 2020 2072 6574 7572  =None,.    retur
+000032d0: 6e5f 7661 723d 2261 7272 6179 222c 0a20  n_var="array",. 
+000032e0: 2020 2064 7479 7065 3d66 6c6f 6174 2c0a     dtype=float,.
+000032f0: 2020 2020 6e6f 5f64 6174 615f 7265 7475      no_data_retu
+00003300: 726e 3d4e 6f6e 652c 0a20 2020 2072 6567  rn=None,.    reg
+00003310: 6578 3d46 616c 7365 2c0a 2020 2020 6b65  ex=False,.    ke
+00003320: 6570 5f6e 616d 653d 4661 6c73 652c 0a20  ep_name=False,. 
+00003330: 2020 206b 6565 705f 636f 6d6d 656e 7473     keep_comments
+00003340: 3d46 616c 7365 2c0a 293a 0a20 2020 2072  =False,.):.    r
+00003350: 2222 220a 2020 2020 5265 6164 204e 6173  """.    Read Nas
+00003360: 7472 616e 2063 6172 6473 2028 6c69 6e65  tran cards (line
+00003370: 7329 2069 6e74 6f20 6120 6d61 7472 6978  s) into a matrix
+00003380: 2c20 6469 6374 696f 6e61 7279 2c20 6f72  , dictionary, or
+00003390: 206c 6973 742e 0a0a 2020 2020 5061 7261   list...    Para
+000033a0: 6d65 7465 7273 0a20 2020 202d 2d2d 2d2d  meters.    -----
+000033b0: 2d2d 2d2d 2d0a 2020 2020 6620 3a20 7374  -----.    f : st
+000033c0: 7269 6e67 206f 7220 6669 6c65 5f6c 696b  ring or file_lik
+000033d0: 6520 6f72 204e 6f6e 650a 2020 2020 2020  e or None.      
+000033e0: 2020 4569 7468 6572 2061 206e 616d 6520    Either a name 
+000033f0: 6f66 2061 2066 696c 652c 206f 7220 6973  of a file, or is
+00003400: 2061 2066 696c 655f 6c69 6b65 206f 626a   a file_like obj
+00003410: 6563 7420 6173 2072 6574 7572 6e65 640a  ect as returned.
+00003420: 2020 2020 2020 2020 6279 203a 6675 6e63          by :func
+00003430: 3a60 6f70 656e 602e 2049 6620 6669 6c65  :`open`. If file
+00003440: 5f6c 696b 6520 6f62 6a65 6374 2c20 6974  _like object, it
+00003450: 2069 7320 7265 776f 756e 6420 6669 7273   is rewound firs
+00003460: 742e 2043 616e 0a20 2020 2020 2020 2061  t. Can.        a
+00003470: 6c73 6f20 6265 2074 6865 206e 616d 6520  lso be the name 
+00003480: 6f66 2061 2064 6972 6563 746f 7279 206f  of a directory o
+00003490: 7220 4e6f 6e65 3b20 696e 2074 6865 7365  r None; in these
+000034a0: 2063 6173 6573 2c20 6120 4755 490a 2020   cases, a GUI.  
+000034b0: 2020 2020 2020 6973 206f 7065 6e65 6420        is opened 
+000034c0: 666f 7220 6669 6c65 2073 656c 6563 7469  for file selecti
+000034d0: 6f6e 2e0a 2020 2020 6e61 6d65 203a 2073  on..    name : s
+000034e0: 7472 696e 670a 2020 2020 2020 2020 5573  tring.        Us
+000034f0: 7561 6c6c 7920 7468 6520 6361 7264 206e  ually the card n
+00003500: 616d 652c 2062 7574 2069 7320 7265 616c  ame, but is real
+00003510: 6c79 206a 7573 7420 7468 6520 696e 6974  ly just the init
+00003520: 6961 6c20 7061 7274 206f 660a 2020 2020  ial part of.    
+00003530: 2020 2020 7468 6520 7374 7269 6e67 2074      the string t
+00003540: 6f20 6c6f 6f6b 2066 6f72 2e20 5468 6973  o look for. This
+00003550: 206d 6561 6e73 2074 6861 7420 606e 616d   means that `nam
+00003560: 6560 2063 616e 2073 7061 6e20 6d6f 7265  e` can span more
+00003570: 0a20 2020 2020 2020 2074 6861 6e20 6f6e  .        than on
+00003580: 6520 6669 656c 642c 2069 6e20 6361 7365  e field, in case
+00003590: 2074 6861 7420 6973 2068 616e 6479 2e20   that is handy. 
+000035a0: 4974 2063 616e 2061 6c73 6f20 6265 2061  It can also be a
+000035b0: 0a20 2020 2020 2020 2072 6567 756c 6172  .        regular
+000035c0: 2065 7870 7265 7373 696f 6e20 6966 2074   expression if t
+000035d0: 6865 2060 7265 6765 7860 206f 7074 696f  he `regex` optio
+000035e0: 6e20 6973 2073 6574 2074 6f20 5472 7565  n is set to True
+000035f0: 2e20 5468 6973 0a20 2020 2020 2020 2072  . This.        r
+00003600: 6f75 7469 6e65 2069 7320 6361 7365 2069  outine is case i
+00003610: 6e73 656e 7369 7469 7665 3a20 6966 2060  nsensitive: if `
+00003620: 7265 6765 7860 2069 7320 4661 6c73 652c  regex` is False,
+00003630: 2060 6e61 6d65 6020 6973 0a20 2020 2020   `name` is.     
+00003640: 2020 2063 6f6e 7665 7274 6564 2074 6f20     converted to 
+00003650: 6c6f 7765 7220 6361 7365 2061 7320 6172  lower case as ar
+00003660: 6520 7468 6520 6c69 6e65 7320 7468 6174  e the lines that
+00003670: 2061 7265 2072 6561 6420 696e 2066 726f   are read in fro
+00003680: 6d0a 2020 2020 2020 2020 7468 6520 6669  m.        the fi
+00003690: 6c65 3b20 6966 2060 7265 6765 7860 2069  le; if `regex` i
+000036a0: 7320 5472 7565 2c20 7468 6520 6060 7265  s True, the ``re
+000036b0: 2e49 474e 4f52 4543 4153 4560 6020 6f70  .IGNORECASE`` op
+000036c0: 7469 6f6e 2069 730a 2020 2020 2020 2020  tion is.        
+000036d0: 7573 6564 2e0a 2020 2020 626c 616e 6b20  used..    blank 
+000036e0: 3a20 4e6f 6e65 2c20 7363 616c 6172 206f  : None, scalar o
+000036f0: 7220 7374 7269 6e67 3b20 6f70 7469 6f6e  r string; option
+00003700: 616c 0a20 2020 2020 2020 2049 6620 7265  al.        If re
+00003710: 6164 696e 6720 696e 746f 2061 6e20 6172  ading into an ar
+00003720: 7261 7920 6f72 2064 6963 7469 6f6e 6172  ray or dictionar
+00003730: 7920 2873 6565 2060 7265 7475 726e 5f76  y (see `return_v
+00003740: 6172 6029 2c0a 2020 2020 2020 2020 6062  ar`),.        `b
+00003750: 6c61 6e6b 6020 6973 2065 7870 6563 7465  lank` is expecte
+00003760: 6420 746f 2062 6520 6120 6e75 6d65 7269  d to be a numeri
+00003770: 6320 7661 6c75 6520 746f 2075 7365 2066  c value to use f
+00003780: 6f72 2062 6c61 6e6b 0a20 2020 2020 2020  or blank.       
+00003790: 2066 6965 6c64 7320 616e 6420 7374 7269   fields and stri
+000037a0: 6e67 2d76 616c 7565 6420 6669 656c 6473  ng-valued fields
+000037b0: 2e20 4966 2072 6561 6469 6e67 2069 6e74  . If reading int
+000037c0: 6f20 6120 6c69 7374 2c20 6974 0a20 2020  o a list, it.   
+000037d0: 2020 2020 2063 616e 2061 6c73 6f20 6265       can also be
+000037e0: 2061 2073 7472 696e 6720 286c 696b 6520   a string (like 
+000037f0: 6060 2222 6060 292e 2049 6620 4e6f 6e65  ``""``). If None
+00003800: 2028 7468 6520 6465 6661 756c 7429 2c20   (the default), 
+00003810: 6974 0a20 2020 2020 2020 2069 7320 696e  it.        is in
+00003820: 7465 726e 616c 6c79 2072 6573 6574 2074  ternally reset t
+00003830: 6f20 6060 2222 6060 2069 6620 6072 6574  o ``""`` if `ret
+00003840: 7572 6e5f 7661 7260 2069 7320 6060 226c  urn_var` is ``"l
+00003850: 6973 7422 6060 0a20 2020 2020 2020 2061  ist"``.        a
+00003860: 6e64 2074 6f20 6060 3060 6020 6f74 6865  nd to ``0`` othe
+00003870: 7277 6973 652e 0a20 2020 2072 6574 7572  rwise..    retur
+00003880: 6e5f 7661 7220 3a20 7374 7269 6e67 3b20  n_var : string; 
+00003890: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
+000038a0: 2053 7065 6369 6669 6573 2077 6869 6368   Specifies which
+000038b0: 2064 6174 6120 7374 7275 6374 7572 6520   data structure 
+000038c0: 746f 2075 7365 2066 6f72 2074 6865 2064  to use for the d
+000038d0: 6174 613a 0a0a 2020 2020 2020 2020 3d3d  ata:..        ==
+000038e0: 3d3d 3d3d 3d3d 3d3d 3d3d 2020 203d 3d3d  ==========   ===
+000038f0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00003900: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00003910: 3d3d 3d3d 3d3d 3d3d 3d0a 2020 2020 2020  =========.      
+00003920: 2020 6072 6574 7572 6e5f 7661 7260 2020    `return_var`  
+00003930: 2052 6f75 7469 6e65 2072 6574 7572 6e73   Routine returns
+00003940: 0a20 2020 2020 2020 203d 3d3d 3d3d 3d3d  .        =======
+00003950: 3d3d 3d3d 3d20 2020 3d3d 3d3d 3d3d 3d3d  =====   ========
+00003960: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00003970: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00003980: 3d3d 3d3d 0a20 2020 2020 2020 2020 2027  ====.          '
+00003990: 6172 7261 7927 2020 2020 2020 6120 6e75  array'      a nu
+000039a0: 6d70 7920 6e64 6172 7261 7920 6f66 2074  mpy ndarray of t
+000039b0: 7970 6520 6064 7479 7065 603b 206e 6f6e  ype `dtype`; non
+000039c0: 2d6e 756d 6572 6963 0a20 2020 2020 2020  -numeric.       
+000039d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000039e0: 6669 656c 6473 2061 7265 2073 6574 2074  fields are set t
+000039f0: 6f20 6062 6c61 6e6b 600a 2020 2020 2020  o `blank`.      
+00003a00: 2020 2020 276c 6973 7427 2020 2020 2020      'list'      
+00003a10: 2061 206c 6973 7420 6f66 206c 6973 7473   a list of lists
+00003a20: 3b20 7468 6973 2069 7320 7468 6520 2274  ; this is the "t
+00003a30: 7275 6573 7422 2072 6561 6465 720a 2020  ruest" reader.  
+00003a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003a50: 2020 2020 2073 696e 6365 2073 7472 696e       since strin
+00003a60: 6720 6669 656c 6473 2061 7265 2072 6574  g fields are ret
+00003a70: 6169 6e65 6420 616e 6420 6f6e 6c79 0a20  ained and only. 
+00003a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003a90: 2020 2020 2020 626c 616e 6b20 6669 656c        blank fiel
+00003aa0: 6473 2061 7265 2073 6574 2074 6f20 6062  ds are set to `b
+00003ab0: 6c61 6e6b 600a 2020 2020 2020 2020 2020  lank`.          
+00003ac0: 2764 6963 7427 2020 2020 2020 2061 2064  'dict'       a d
+00003ad0: 6963 7469 6f6e 6172 793b 2065 6163 6820  ictionary; each 
+00003ae0: 6361 7264 2062 6563 6f6d 6573 2061 2064  card becomes a d
+00003af0: 6963 7469 6f6e 6172 790a 2020 2020 2020  ictionary.      
+00003b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003b10: 2065 6e74 7279 3a20 7468 6520 7661 6c75   entry: the valu
+00003b20: 6520 6973 2061 206e 756d 7079 206e 6461  e is a numpy nda
+00003b30: 7272 6179 206f 6620 7479 7065 0a20 2020  rray of type.   
+00003b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003b50: 2020 2020 6064 7479 7065 6020 616e 6420      `dtype` and 
+00003b60: 7468 6520 6b65 7920 6973 2074 6865 2066  the key is the f
+00003b70: 6972 7374 2065 6c65 6d65 6e74 206f 660a  irst element of.
+00003b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003b90: 2020 2020 2020 2074 6861 7420 6e64 6172         that ndar
+00003ba0: 7261 7920 2862 7574 2062 6566 6f72 6520  ray (but before 
+00003bb0: 636f 6e76 6572 7469 6e67 2074 6f0a 2020  converting to.  
+00003bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003bd0: 2020 2020 2060 6474 7970 6560 290a 2020       `dtype`).  
+00003be0: 2020 2020 2020 3d3d 3d3d 3d3d 3d3d 3d3d        ==========
+00003bf0: 3d3d 2020 203d 3d3d 3d3d 3d3d 3d3d 3d3d  ==   ===========
+00003c00: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00003c10: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00003c20: 3d0a 0a20 2020 2064 7479 7065 203a 2064  =..    dtype : d
+00003c30: 6174 612d 7479 7065 3b20 6f70 7469 6f6e  ata-type; option
+00003c40: 616c 0a20 2020 2020 2020 2054 6865 2064  al.        The d
+00003c50: 6573 6972 6564 2061 7272 6179 2064 6174  esired array dat
+00003c60: 612d 7479 7065 2066 6f72 2074 6865 2027  a-type for the '
+00003c70: 6172 7261 7927 206f 7220 2764 6963 7427  array' or 'dict'
+00003c80: 206f 7574 7075 740a 2020 2020 2020 2020   output.        
+00003c90: 6f70 7469 6f6e 732e 0a20 2020 206e 6f5f  options..    no_
+00003ca0: 6461 7461 5f72 6574 7572 6e20 3a20 616e  data_return : an
+00003cb0: 7920 7661 7269 6162 6c65 3b20 6f70 7469  y variable; opti
+00003cc0: 6f6e 616c 0a20 2020 2020 2020 2049 6620  onal.        If 
+00003cd0: 6e6f 2064 6174 6120 6973 2066 6f75 6e64  no data is found
+00003ce0: 2c20 7468 6973 2072 6f75 7469 6e65 2072  , this routine r
+00003cf0: 6574 7572 6e73 2060 6e6f 5f64 6174 615f  eturns `no_data_
+00003d00: 7265 7475 726e 602e 0a20 2020 2072 6567  return`..    reg
+00003d10: 6578 203a 2062 6f6f 6c3b 206f 7074 696f  ex : bool; optio
+00003d20: 6e61 6c0a 2020 2020 2020 2020 4966 2073  nal.        If s
+00003d30: 6574 2074 6f20 5472 7565 2c20 5573 6520  et to True, Use 
+00003d40: 7265 6775 6c61 7220 6578 7072 6573 7369  regular expressi
+00003d50: 6f6e 206d 6174 6368 696e 6720 696e 7374  on matching inst
+00003d60: 6561 6420 6f66 0a20 2020 2020 2020 206c  ead of.        l
+00003d70: 6974 6572 616c 2073 7472 696e 6720 6d61  iteral string ma
+00003d80: 7463 6869 6e67 2e0a 2020 2020 6b65 6570  tching..    keep
+00003d90: 5f6e 616d 6520 3a20 626f 6f6c 3b20 6f70  _name : bool; op
+00003da0: 7469 6f6e 616c 0a20 2020 2020 2020 2049  tional.        I
+00003db0: 6620 7265 6164 696e 6720 696e 746f 2061  f reading into a
+00003dc0: 206c 6973 742c 2060 6b65 6570 5f6e 616d   list, `keep_nam
+00003dd0: 6560 2063 616e 2062 6520 7365 7420 746f  e` can be set to
+00003de0: 2054 7275 6520 746f 0a20 2020 2020 2020   True to.       
+00003df0: 2072 6574 6169 6e20 7468 6520 6361 7264   retain the card
+00003e00: 206e 616d 6520 696e 2074 6865 206f 7574   name in the out
+00003e10: 7075 742e 2054 6869 7320 6f70 7469 6f6e  put. This option
+00003e20: 2069 7320 6967 6e6f 7265 6420 6966 0a20   is ignored if. 
+00003e30: 2020 2020 2020 206e 6f74 2072 6561 6469         not readi
+00003e40: 6e67 2069 6e74 6f20 6120 6c69 7374 2e0a  ng into a list..
+00003e50: 2020 2020 6b65 6570 5f63 6f6d 6d65 6e74      keep_comment
+00003e60: 7320 3a20 626f 6f6c 3b20 6f70 7469 6f6e  s : bool; option
+00003e70: 616c 0a20 2020 2020 2020 2049 6620 7265  al.        If re
+00003e80: 6164 696e 6720 696e 746f 2061 206c 6973  ading into a lis
+00003e90: 742c 2060 6b65 6570 5f63 6f6d 6d65 6e74  t, `keep_comment
+00003ea0: 7360 2063 616e 2062 6520 7365 7420 746f  s` can be set to
+00003eb0: 2054 7275 6520 746f 0a20 2020 2020 2020   True to.       
+00003ec0: 2072 6574 6169 6e20 616c 6c20 636f 6d6d   retain all comm
+00003ed0: 656e 7420 6361 7264 7320 696e 2074 6865  ent cards in the
+00003ee0: 206f 7574 7075 742e 2054 6869 7320 6f70   output. This op
+00003ef0: 7469 6f6e 2069 7320 6967 6e6f 7265 640a  tion is ignored.
+00003f00: 2020 2020 2020 2020 6966 206e 6f74 2072          if not r
+00003f10: 6561 6469 6e67 2069 6e74 6f20 6120 6c69  eading into a li
+00003f20: 7374 2e20 4e6f 7465 2074 6861 7420 6f6e  st. Note that on
+00003f30: 6c79 2074 6865 2063 6f6d 6d65 6e74 7320  ly the comments 
+00003f40: 7468 6174 0a20 2020 2020 2020 2073 7461  that.        sta
+00003f50: 7274 2061 7420 7468 6520 6265 6769 6e6e  rt at the beginn
+00003f60: 696e 6720 6f66 2074 6865 206c 696e 6520  ing of the line 
+00003f70: 6172 6520 7265 7461 696e 6564 2e0a 0a20  are retained... 
+00003f80: 2020 2052 6574 7572 6e73 0a20 2020 202d     Returns.    -
+00003f90: 2d2d 2d2d 2d2d 0a20 2020 2063 6172 6473  ------.    cards
+00003fa0: 203a 206e 6461 7272 6179 206f 7220 6c69   : ndarray or li
+00003fb0: 7374 206f 7220 6469 6374 696f 6e61 7279  st or dictionary
+00003fc0: 206f 7220 6e6f 5f64 6174 615f 7265 7475   or no_data_retu
+00003fd0: 726e 0a0a 2020 2020 2020 2020 2d20 4966  rn..        - If
+00003fe0: 2061 6e20 6e64 6172 7261 7920 6973 2072   an ndarray is r
+00003ff0: 6574 7572 6e65 642c 2065 6163 6820 726f  eturned, each ro
+00004000: 7720 6973 2061 2063 6172 642c 2070 6164  w is a card, pad
+00004010: 6465 6420 7769 7468 0a20 2020 2020 2020  ded with.       
+00004020: 2020 2062 6c61 6e6b 7320 6173 206e 6563     blanks as nec
+00004030: 6573 7361 7279 2e0a 2020 2020 2020 2020  essary..        
+00004040: 2d20 4966 2061 206c 6973 7420 286f 6620  - If a list (of 
+00004050: 6c69 7374 7329 2069 7320 7265 7475 726e  lists) is return
+00004060: 6564 2c20 6561 6368 2069 7465 6d20 6973  ed, each item is
+00004070: 2061 2063 6172 6420 616e 6420 6973 0a20   a card and is. 
+00004080: 2020 2020 2020 2020 2061 206c 6973 7420           a list 
+00004090: 6f66 2076 616c 7565 7320 6672 6f6d 2074  of values from t
+000040a0: 6865 2063 6172 642c 2074 6865 206c 656e  he card, the len
+000040b0: 6774 6820 6f66 2077 6869 6368 2069 7320  gth of which is 
+000040c0: 7468 650a 2020 2020 2020 2020 2020 6e75  the.          nu
+000040d0: 6d62 6572 206f 6620 6974 656d 7320 6f6e  mber of items on
+000040e0: 2074 6865 2063 6172 642e 0a20 2020 2020   the card..     
+000040f0: 2020 202d 2049 6620 6120 6469 6374 696f     - If a dictio
+00004100: 6e61 7279 2069 7320 7265 7475 726e 6564  nary is returned
+00004110: 2c20 7468 6520 6669 7273 7420 6e75 6d62  , the first numb
+00004120: 6572 2066 726f 6d20 6561 6368 2063 6172  er from each car
+00004130: 640a 2020 2020 2020 2020 2020 6973 2075  d.          is u
+00004140: 7365 6420 6173 2074 6865 206b 6579 2061  sed as the key a
+00004150: 6e64 2074 6865 2076 616c 7565 2061 7265  nd the value are
+00004160: 2061 6c6c 2074 6865 206e 756d 6265 7273   all the numbers
+00004170: 2066 726f 6d0a 2020 2020 2020 2020 2020   from.          
+00004180: 7468 6520 6361 7264 2069 6e20 6120 726f  the card in a ro
+00004190: 7720 7665 6374 6f72 2028 696e 636c 7564  w vector (includ
+000041a0: 696e 6720 7468 6520 6669 7273 7420 7661  ing the first va
+000041b0: 6c75 6529 2e0a 2020 2020 2020 2020 2d20  lue)..        - 
+000041c0: 606e 6f5f 6461 7461 5f72 6574 7572 6e60  `no_data_return`
+000041d0: 2069 7320 7265 7475 726e 6564 2069 6620   is returned if 
+000041e0: 6e6f 2063 6172 6473 206f 6620 7265 7175  no cards of requ
+000041f0: 6573 7465 6420 6e61 6d65 0a20 2020 2020  ested name.     
+00004200: 2020 2020 2077 6572 6520 666f 756e 642e       were found.
+00004210: 0a0a 2020 2020 4e6f 7465 730a 2020 2020  ..    Notes.    
+00004220: 2d2d 2d2d 2d0a 2020 2020 5468 6973 2072  -----.    This r
+00004230: 6f75 7469 6e65 2063 616e 2072 6561 6420  outine can read 
+00004240: 6669 7865 6420 6669 656c 6420 2838 206f  fixed field (8 o
+00004250: 7220 3136 2063 6861 7273 2077 6964 6529  r 16 chars wide)
+00004260: 206f 720a 2020 2020 636f 6d6d 612d 6465   or.    comma-de
+00004270: 6c69 6d69 7465 6420 616e 6420 6361 6e20  limited and can 
+00004280: 6861 6e64 6c65 2061 6e79 206e 756d 6265  handle any numbe
+00004290: 7220 6f66 2063 6f6e 7469 6e75 6174 696f  r of continuatio
+000042a0: 6e73 2e20 4e6f 7465 0a20 2020 2074 6861  ns. Note.    tha
+000042b0: 7420 7468 6520 6368 6172 6163 7465 7273  t the characters
+000042c0: 2069 6e20 7468 6520 636f 6e74 696e 7561   in the continua
+000042d0: 7469 6f6e 2066 6965 6c64 7320 6172 6520  tion fields are 
+000042e0: 6967 6e6f 7265 642e 2049 740a 2020 2020  ignored. It.    
+000042f0: 616c 736f 2075 7365 7320 3a66 756e 633a  also uses :func:
+00004300: 606e 6173 5f73 7363 616e 6660 2074 6f20  `nas_sscanf` to 
+00004310: 7265 6164 2074 6865 206e 756d 6265 7273  read the numbers
+00004320: 2c20 736f 206e 756d 6265 7273 206c 696b  , so numbers lik
+00004330: 650a 2020 2020 312e 2d33 2028 7768 6963  e.    1.-3 (whic
+00004340: 6820 6d65 616e 7320 312e 652d 3329 2061  h means 1.e-3) a
+00004350: 7265 206f 6b61 792e 2042 6c61 6e6b 2066  re okay. Blank f
+00004360: 6965 6c64 7320 616e 6420 7374 7269 6e67  ields and string
+00004370: 2066 6965 6c64 730a 2020 2020 6172 6520   fields.    are 
+00004380: 7365 7420 746f 2060 626c 616e 6b60 2c20  set to `blank`, 
+00004390: 6578 6365 7074 2077 6865 6e20 6072 6574  except when `ret
+000043a0: 7572 6e5f 7661 7260 2069 7320 276c 6973  urn_var` is 'lis
+000043b0: 7427 3b20 696e 2074 6861 740a 2020 2020  t'; in that.    
+000043c0: 6361 7365 2c20 7374 7269 6e67 2066 6965  case, string fie
+000043d0: 6c64 7320 6172 6520 6b65 7074 2061 7320  lds are kept as 
+000043e0: 6973 2061 6e64 206f 6e6c 7920 626c 616e  is and only blan
+000043f0: 6b20 6669 656c 6473 2061 7265 2073 6574  k fields are set
+00004400: 0a20 2020 2074 6f20 6062 6c61 6e6b 602e  .    to `blank`.
+00004410: 0a0a 2020 2020 4e6f 7465 3a20 7468 6973  ..    Note: this
+00004420: 2072 6f75 7469 6e65 2068 6173 206e 6f20   routine has no 
+00004430: 6b6e 6f77 6c65 6467 6520 6f66 2061 6e79  knowledge of any
+00004440: 2063 6172 642c 2077 6869 6368 206d 6561   card, which mea
+00004450: 6e73 0a20 2020 2074 6861 7420 6974 2077  ns.    that it w
+00004460: 696c 6c20 6e6f 7420 6170 7065 6e64 2074  ill not append t
+00004470: 7261 696c 696e 6720 626c 616e 6b73 2074  railing blanks t
+00004480: 6f20 6120 6361 7264 2e20 466f 7220 6578  o a card. For ex
+00004490: 616d 706c 652c 2069 660a 2020 2020 6120  ample, if.    a 
+000044a0: 4752 4944 2063 6172 6420 6973 3a20 2747  GRID card is: 'G
+000044b0: 5249 442c 2031 272c 2074 6865 6e20 7468  RID, 1', then th
+000044c0: 6973 2072 6f75 7469 6e65 2077 6f75 6c64  is routine would
+000044d0: 2072 6574 7572 6e20 6060 5b31 5d60 602c   return ``[1]``,
+000044e0: 0a20 2020 206e 6f74 2060 605b 312c 2030  .    not ``[1, 0
+000044f0: 2c20 302c 2030 2c20 302c 2030 2c20 302c  , 0, 0, 0, 0, 0,
+00004500: 2030 5d60 602e 2054 6865 203a 6675 6e63   0]``. The :func
+00004510: 3a60 7264 6772 6964 7360 2072 6f75 7469  :`rdgrids` routi
+00004520: 6e65 0a20 2020 2077 6f75 6c64 2072 6574  ne.    would ret
+00004530: 7572 6e20 6060 5b31 2c20 302c 2030 2c20  urn ``[1, 0, 0, 
+00004540: 302c 2030 2c20 302c 2030 2c20 305d 6060  0, 0, 0, 0, 0]``
+00004550: 2073 696e 6365 2069 7420 6b6e 6f77 7320   since it knows 
+00004560: 7468 650a 2020 2020 6e75 6d62 6572 206f  the.    number o
+00004570: 6620 6669 656c 6473 2061 2047 5249 4420  f fields a GRID 
+00004580: 6361 7264 2068 6173 2e0a 0a20 2020 2045  card has...    E
+00004590: 7861 6d70 6c65 730a 2020 2020 2d2d 2d2d  xamples.    ----
+000045a0: 2d2d 2d2d 0a20 2020 2043 7265 6174 6520  ----.    Create 
+000045b0: 736f 6d65 2062 756c 6b20 6461 7461 2074  some bulk data t
+000045c0: 6f20 7265 6164 2028 6e6f 7420 6e65 6365  o read (not nece
+000045d0: 7373 6172 696c 7920 7661 6c69 6429 3a0a  ssarily valid):.
+000045e0: 0a20 2020 203e 3e3e 2066 726f 6d20 696f  .    >>> from io
+000045f0: 2069 6d70 6f72 7420 5374 7269 6e67 494f   import StringIO
+00004600: 0a20 2020 203e 3e3e 2066 726f 6d20 7079  .    >>> from py
+00004610: 7965 7469 2e6e 6173 7472 616e 2069 6d70  yeti.nastran imp
+00004620: 6f72 7420 6275 6c6b 0a20 2020 203e 3e3e  ort bulk.    >>>
+00004630: 2066 7320 3d20 5374 7269 6e67 494f 2827   fs = StringIO('
+00004640: 2727 0a20 2020 202e 2e2e 2044 5449 2020  ''.    ... DTI  
+00004650: 2020 2053 454c 4f41 4420 2020 2020 2020     SELOAD       
+00004660: 2020 3120 2020 2020 2020 320a 2020 2020    1       2.    
+00004670: 2e2e 2e20 6474 6920 2020 2020 7365 6c6f  ... dti     selo
+00004680: 6164 2020 2020 2020 2020 2033 2020 2020  ad         3    
+00004690: 2020 2034 0a20 2020 202e 2e2e 2024 2061     4.    ... $ a
+000046a0: 2063 6f6d 6d65 6e74 2066 6f72 2074 6573   comment for tes
+000046b0: 7469 6e67 0a20 2020 202e 2e2e 2064 7469  ting.    ... dti
+000046c0: 2c73 656c 6f61 642c 352c 360a 2020 2020  ,seload,5,6.    
+000046d0: 2e2e 2e20 4454 492c 2053 454c 4f41 442c  ... DTI, SELOAD,
+000046e0: 202c 2038 2e30 2c20 2761 270a 2020 2020   , 8.0, 'a'.    
+000046f0: 2e2e 2e20 4454 492c 5345 5452 4545 2c31  ... DTI,SETREE,1
+00004700: 3030 2c30 0a20 2020 202e 2e2e 2027 2727  00,0.    ... '''
+00004710: 290a 0a20 2020 2052 6561 6420 616c 6c20  )..    Read all 
+00004720: 7468 6520 4454 4920 6361 7264 7320 746f  the DTI cards to
+00004730: 2061 206c 6973 743a 0a0a 2020 2020 3e3e   a list:..    >>
+00004740: 3e20 6c73 7420 3d20 6275 6c6b 2e72 6463  > lst = bulk.rdc
+00004750: 6172 6473 2866 732c 2027 6474 6927 2c20  ards(fs, 'dti', 
+00004760: 7265 7475 726e 5f76 6172 3d27 6c69 7374  return_var='list
+00004770: 2729 0a20 2020 203e 3e3e 2066 6f72 2069  ').    >>> for i
+00004780: 7465 6d20 696e 206c 7374 3a20 7072 696e  tem in lst: prin
+00004790: 7428 6974 656d 290a 2020 2020 5b27 5345  t(item).    ['SE
+000047a0: 4c4f 4144 272c 2031 2c20 325d 0a20 2020  LOAD', 1, 2].   
+000047b0: 205b 2773 656c 6f61 6427 2c20 332c 2034   ['seload', 3, 4
+000047c0: 5d0a 2020 2020 5b27 7365 6c6f 6164 272c  ].    ['seload',
+000047d0: 2035 2c20 365d 0a20 2020 205b 2753 454c   5, 6].    ['SEL
+000047e0: 4f41 4427 2c20 2727 2c20 382e 302c 2022  OAD', '', 8.0, "
+000047f0: 2761 2722 5d0a 2020 2020 5b27 5345 5452  'a'"].    ['SETR
+00004800: 4545 272c 2031 3030 2c20 305d 0a0a 2020  EE', 100, 0]..  
+00004810: 2020 5265 6164 2073 6f6d 6520 6f66 2074    Read some of t
+00004820: 6865 2044 5449 2c53 454c 4f41 4420 6361  he DTI,SELOAD ca
+00004830: 7264 7320 2869 7427 7320 6361 7365 2d69  rds (it's case-i
+00004840: 6e73 656e 7369 7469 7665 293a 0a0a 2020  nsensitive):..  
+00004850: 2020 3e3e 3e20 6275 6c6b 2e72 6463 6172    >>> bulk.rdcar
+00004860: 6473 2866 732c 2027 6474 6920 2020 2020  ds(fs, 'dti     
+00004870: 7365 6c6f 6164 2729 0a20 2020 2061 7272  seload').    arr
+00004880: 6179 285b 5b20 302e 2c20 2031 2e2c 2020  ay([[ 0.,  1.,  
+00004890: 322e 5d2c 0a20 2020 2020 2020 2020 2020  2.],.           
+000048a0: 5b20 302e 2c20 2033 2e2c 2020 342e 5d5d  [ 0.,  3.,  4.]]
+000048b0: 290a 0a20 2020 2055 7365 2061 2072 6567  )..    Use a reg
+000048c0: 756c 6172 2065 7870 7265 7373 696f 6e20  ular expression 
+000048d0: 666f 7220 6d6f 7265 2070 6f77 6572 3a0a  for more power:.
+000048e0: 0a20 2020 203e 3e3e 2062 756c 6b2e 7264  .    >>> bulk.rd
+000048f0: 6361 7264 7328 6673 2c20 7227 4454 4928  cards(fs, r'DTI(
+00004900: 2c5c 732a 7c5c 732b 2953 454c 4f41 4427  ,\s*|\s+)SELOAD'
+00004910: 2c20 7265 6765 783d 5472 7565 290a 2020  , regex=True).  
+00004920: 2020 6172 7261 7928 5b5b 2030 2e2c 2020    array([[ 0.,  
+00004930: 312e 2c20 2032 2e2c 2020 302e 5d2c 0a20  1.,  2.,  0.],. 
+00004940: 2020 2020 2020 2020 2020 5b20 302e 2c20            [ 0., 
+00004950: 2033 2e2c 2020 342e 2c20 2030 2e5d 2c0a   3.,  4.,  0.],.
+00004960: 2020 2020 2020 2020 2020 205b 2030 2e2c             [ 0.,
+00004970: 2020 352e 2c20 2036 2e2c 2020 302e 5d2c    5.,  6.,  0.],
+00004980: 0a20 2020 2020 2020 2020 2020 5b20 302e  .           [ 0.
+00004990: 2c20 2030 2e2c 2020 382e 2c20 2030 2e5d  ,  0.,  8.,  0.]
+000049a0: 5d29 0a0a 2020 2020 5361 6d65 2c20 6275  ])..    Same, bu
+000049b0: 7420 7265 6164 2069 6e74 6f20 6120 6c69  t read into a li
+000049c0: 7374 3a0a 0a20 2020 203e 3e3e 206c 7374  st:..    >>> lst
+000049d0: 203d 2062 756c 6b2e 7264 6361 7264 7328   = bulk.rdcards(
+000049e0: 6673 2c20 7227 4454 4928 2c5c 732a 7c5c  fs, r'DTI(,\s*|\
+000049f0: 732b 2953 454c 4f41 4427 2c20 7265 6765  s+)SELOAD', rege
+00004a00: 783d 5472 7565 2c0a 2020 2020 2e2e 2e20  x=True,.    ... 
+00004a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004a20: 2020 2072 6574 7572 6e5f 7661 723d 276c     return_var='l
+00004a30: 6973 7427 290a 2020 2020 3e3e 3e20 666f  ist').    >>> fo
+00004a40: 7220 6974 656d 2069 6e20 6c73 743a 2070  r item in lst: p
+00004a50: 7269 6e74 2869 7465 6d29 0a20 2020 205b  rint(item).    [
+00004a60: 2753 454c 4f41 4427 2c20 312c 2032 5d0a  'SELOAD', 1, 2].
+00004a70: 2020 2020 5b27 7365 6c6f 6164 272c 2033      ['seload', 3
+00004a80: 2c20 345d 0a20 2020 205b 2773 656c 6f61  , 4].    ['seloa
+00004a90: 6427 2c20 352c 2036 5d0a 2020 2020 5b27  d', 5, 6].    ['
+00004aa0: 5345 4c4f 4144 272c 2027 272c 2038 2e30  SELOAD', '', 8.0
+00004ab0: 2c20 2227 6127 225d 0a0a 2020 2020 496e  , "'a'"]..    In
+00004ac0: 636c 7564 6520 7468 6520 6361 7264 206e  clude the card n
+00004ad0: 616d 6520 6173 2077 656c 6c3a 0a0a 2020  ame as well:..  
+00004ae0: 2020 3e3e 3e20 6c73 7420 3d20 6275 6c6b    >>> lst = bulk
+00004af0: 2e72 6463 6172 6473 2866 732c 2072 2744  .rdcards(fs, r'D
+00004b00: 5449 282c 5c73 2a7c 5c73 2b29 5345 4c4f  TI(,\s*|\s+)SELO
+00004b10: 4144 272c 2072 6567 6578 3d54 7275 652c  AD', regex=True,
+00004b20: 0a20 2020 202e 2e2e 2020 2020 2020 2020  .    ...        
+00004b30: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00004b40: 726e 5f76 6172 3d27 6c69 7374 272c 206b  rn_var='list', k
+00004b50: 6565 705f 6e61 6d65 3d54 7275 6529 0a20  eep_name=True). 
+00004b60: 2020 203e 3e3e 2066 6f72 2069 7465 6d20     >>> for item 
+00004b70: 696e 206c 7374 3a20 7072 696e 7428 6974  in lst: print(it
+00004b80: 656d 290a 2020 2020 5b27 4454 4927 2c20  em).    ['DTI', 
+00004b90: 2753 454c 4f41 4427 2c20 312c 2032 5d0a  'SELOAD', 1, 2].
+00004ba0: 2020 2020 5b27 6474 6927 2c20 2773 656c      ['dti', 'sel
+00004bb0: 6f61 6427 2c20 332c 2034 5d0a 2020 2020  oad', 3, 4].    
+00004bc0: 5b27 6474 6927 2c20 2773 656c 6f61 6427  ['dti', 'seload'
+00004bd0: 2c20 352c 2036 5d0a 2020 2020 5b27 4454  , 5, 6].    ['DT
+00004be0: 4927 2c20 2753 454c 4f41 4427 2c20 2727  I', 'SELOAD', ''
+00004bf0: 2c20 382e 302c 2022 2761 2722 5d0a 0a20  , 8.0, "'a'"].. 
+00004c00: 2020 2046 6f72 2074 6865 206d 6f73 7420     For the most 
+00004c10: 6163 6375 7261 7465 2072 6561 6420 6f66  accurate read of
+00004c20: 2074 6865 2064 6174 612c 2069 6e63 6c75   the data, inclu
+00004c30: 6465 2063 6f6d 6d65 6e74 733a 0a0a 2020  de comments:..  
+00004c40: 2020 3e3e 3e20 6c73 7420 3d20 6275 6c6b    >>> lst = bulk
+00004c50: 2e72 6463 6172 6473 2866 732c 2072 2744  .rdcards(fs, r'D
+00004c60: 5449 282c 5c73 2a7c 5c73 2b29 5345 4c4f  TI(,\s*|\s+)SELO
+00004c70: 4144 272c 2072 6567 6578 3d54 7275 652c  AD', regex=True,
+00004c80: 0a20 2020 202e 2e2e 2020 2020 2020 2020  .    ...        
+00004c90: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00004ca0: 726e 5f76 6172 3d27 6c69 7374 272c 206b  rn_var='list', k
+00004cb0: 6565 705f 6e61 6d65 3d54 7275 652c 0a20  eep_name=True,. 
+00004cc0: 2020 202e 2e2e 2020 2020 2020 2020 2020     ...          
+00004cd0: 2020 2020 2020 2020 2020 6b65 6570 5f63            keep_c
+00004ce0: 6f6d 6d65 6e74 733d 5472 7565 290a 2020  omments=True).  
+00004cf0: 2020 3e3e 3e20 666f 7220 6974 656d 2069    >>> for item i
+00004d00: 6e20 6c73 743a 2070 7269 6e74 2866 227b  n lst: print(f"{
+00004d10: 6974 656d 2172 7d22 290a 2020 2020 5b27  item!r}").    ['
+00004d20: 4454 4927 2c20 2753 454c 4f41 4427 2c20  DTI', 'SELOAD', 
+00004d30: 312c 2032 5d0a 2020 2020 5b27 6474 6927  1, 2].    ['dti'
+00004d40: 2c20 2773 656c 6f61 6427 2c20 332c 2034  , 'seload', 3, 4
+00004d50: 5d0a 2020 2020 2724 2061 2063 6f6d 6d65  ].    '$ a comme
+00004d60: 6e74 2066 6f72 2074 6573 7469 6e67 5c6e  nt for testing\n
+00004d70: 270a 2020 2020 5b27 6474 6927 2c20 2773  '.    ['dti', 's
+00004d80: 656c 6f61 6427 2c20 352c 2036 5d0a 2020  eload', 5, 6].  
+00004d90: 2020 5b27 4454 4927 2c20 2753 454c 4f41    ['DTI', 'SELOA
+00004da0: 4427 2c20 2727 2c20 382e 302c 2022 2761  D', '', 8.0, "'a
+00004db0: 2722 5d0a 2020 2020 2222 220a 0a20 2020  '"].    """..   
+00004dc0: 2069 6620 7265 7475 726e 5f76 6172 206e   if return_var n
+00004dd0: 6f74 2069 6e20 2822 6172 7261 7922 2c20  ot in ("array", 
+00004de0: 226c 6973 7422 2c20 2264 6963 7422 293a  "list", "dict"):
+00004df0: 0a20 2020 2020 2020 2072 6169 7365 2056  .        raise V
+00004e00: 616c 7565 4572 726f 7228 0a20 2020 2020  alueError(.     
+00004e10: 2020 2020 2020 2027 696e 7661 6c69 6420         'invalid 
+00004e20: 6072 6574 7572 6e5f 7661 7260 2073 6574  `return_var` set
+00004e30: 7469 6e67 3b20 6d75 7374 2062 6520 6f6e  ting; must be on
+00004e40: 6520 6f66 3a20 2822 6172 7261 7922 2c20  e of: ("array", 
+00004e50: 226c 6973 7422 2c20 2264 6963 7422 2927  "list", "dict")'
+00004e60: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+00004e70: 6966 2072 6574 7572 6e5f 7661 7220 3d3d  if return_var ==
+00004e80: 2022 6469 6374 223a 0a20 2020 2020 2020   "dict":.       
+00004e90: 2056 616c 7320 3d20 7b7d 0a20 2020 2020   Vals = {}.     
+00004ea0: 2020 2074 6f64 6963 7420 3d20 5472 7565     todict = True
+00004eb0: 0a20 2020 2020 2020 2074 6f6c 6973 7420  .        tolist 
+00004ec0: 3d20 4661 6c73 650a 2020 2020 656c 7365  = False.    else
+00004ed0: 3a0a 2020 2020 2020 2020 746f 6469 6374  :.        todict
+00004ee0: 203d 2046 616c 7365 0a20 2020 2020 2020   = False.       
+00004ef0: 2074 6f6c 6973 7420 3d20 7265 7475 726e   tolist = return
+00004f00: 5f76 6172 203d 3d20 226c 6973 7422 0a20  _var == "list". 
+00004f10: 2020 2020 2020 2056 616c 7320 3d20 5b5d         Vals = []
+00004f20: 0a0a 2020 2020 6966 2062 6c61 6e6b 2069  ..    if blank i
+00004f30: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
+00004f40: 626c 616e 6b20 3d20 2222 2069 6620 746f  blank = "" if to
+00004f50: 6c69 7374 2065 6c73 6520 300a 0a20 2020  list else 0..   
+00004f60: 206d 786c 656e 203d 2030 0a20 2020 2066   mxlen = 0.    f
+00004f70: 2e73 6565 6b28 302c 2030 290a 0a20 2020  .seek(0, 0)..   
+00004f80: 2066 6974 6572 203d 205f 6e65 7874 5f6c   fiter = _next_l
+00004f90: 696e 6528 662c 206e 616d 652c 2072 6567  ine(f, name, reg
+00004fa0: 6578 2c20 746f 6c69 7374 2061 6e64 206b  ex, tolist and k
+00004fb0: 6565 705f 636f 6d6d 656e 7473 2c20 5661  eep_comments, Va
+00004fc0: 6c73 290a 2020 2020 7320 3d20 6e65 7874  ls).    s = next
+00004fd0: 2866 6974 6572 290a 2020 2020 7768 696c  (fiter).    whil
+00004fe0: 6520 7320 6973 206e 6f74 204e 6f6e 653a  e s is not None:
+00004ff0: 0a20 2020 2020 2020 2023 2069 6620 6865  .        # if he
+00005000: 7265 2c20 6861 7665 206d 6174 6368 696e  re, have matchin
+00005010: 6720 6c69 6e65 0a20 2020 2020 2020 2069  g line.        i
+00005020: 6620 732e 6669 6e64 2822 2c22 2920 3e20  f s.find(",") > 
+00005030: 2d31 3a0a 2020 2020 2020 2020 2020 2020  -1:.            
+00005040: 7661 6c73 203d 205f 7264 636f 6d6d 6128  vals = _rdcomma(
+00005050: 6669 7465 722c 2073 2c20 2220 2b2c 222c  fiter, s, " +,",
+00005060: 2062 6c61 6e6b 2c20 746f 6c69 7374 2c20   blank, tolist, 
+00005070: 6b65 6570 5f6e 616d 6529 0a20 2020 2020  keep_name).     
+00005080: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00005090: 2020 2020 2073 203d 2073 5b3a 3732 5d2e       s = s[:72].
+000050a0: 7273 7472 6970 2829 0a20 2020 2020 2020  rstrip().       
+000050b0: 2020 2020 2070 203d 2073 5b3a 385d 2e66       p = s[:8].f
+000050c0: 696e 6428 222a 2229 0a20 2020 2020 2020  ind("*").       
+000050d0: 2020 2020 2066 6965 6c64 2c20 636f 6e74       field, cont
+000050e0: 696e 7561 7469 6f6e 203d 2028 3136 2c20  inuation = (16, 
+000050f0: 222a 2229 2069 6620 7020 3e20 2d31 2065  "*") if p > -1 e
+00005100: 6c73 6520 2838 2c20 2220 2b22 290a 2020  lse (8, " +").  
+00005110: 2020 2020 2020 2020 2020 7661 6c73 203d            vals =
+00005120: 205f 7264 6669 7865 6428 6669 7465 722c   _rdfixed(fiter,
+00005130: 2073 2c20 6669 656c 642c 2063 6f6e 7469   s, field, conti
+00005140: 6e75 6174 696f 6e2c 2062 6c61 6e6b 2c20  nuation, blank, 
+00005150: 746f 6c69 7374 2c20 6b65 6570 5f6e 616d  tolist, keep_nam
+00005160: 6529 0a20 2020 2020 2020 2069 6620 746f  e).        if to
+00005170: 6c69 7374 3a0a 2020 2020 2020 2020 2020  list:.          
+00005180: 2020 5661 6c73 2e61 7070 656e 6428 7661    Vals.append(va
+00005190: 6c73 290a 2020 2020 2020 2020 656c 7365  ls).        else
+000051a0: 3a0a 2020 2020 2020 2020 2020 2020 6375  :.            cu
+000051b0: 7220 3d20 6c65 6e28 7661 6c73 290a 2020  r = len(vals).  
+000051c0: 2020 2020 2020 2020 2020 6d78 6c65 6e20            mxlen 
+000051d0: 3d20 6d61 7828 6d78 6c65 6e2c 2063 7572  = max(mxlen, cur
+000051e0: 290a 2020 2020 2020 2020 2020 2020 6b65  ).            ke
+000051f0: 7920 3d20 7661 6c73 5b30 5d20 2023 2062  y = vals[0]  # b
+00005200: 6566 6f72 6520 6974 2067 6574 7320 7475  efore it gets tu
+00005210: 726e 6564 2069 6e74 6f20 6474 7970 650a  rned into dtype.
+00005220: 2020 2020 2020 2020 2020 2020 7661 6c73              vals
+00005230: 203d 206e 702e 6172 7261 7928 7661 6c73   = np.array(vals
+00005240: 292e 6173 7479 7065 2864 7479 7065 290a  ).astype(dtype).
+00005250: 2020 2020 2020 2020 2020 2020 6966 2074              if t
+00005260: 6f64 6963 743a 0a20 2020 2020 2020 2020  odict:.         
+00005270: 2020 2020 2020 2056 616c 735b 6b65 795d         Vals[key]
+00005280: 203d 2076 616c 730a 2020 2020 2020 2020   = vals.        
+00005290: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+000052a0: 2020 2020 2020 2020 2020 5661 6c73 2e61            Vals.a
+000052b0: 7070 656e 6428 7661 6c73 290a 2020 2020  ppend(vals).    
+000052c0: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
+000052d0: 2020 2020 2073 203d 2066 6974 6572 2e73       s = fiter.s
+000052e0: 656e 6428 5472 7565 290a 2020 2020 2020  end(True).      
+000052f0: 2020 6578 6365 7074 2053 746f 7049 7465    except StopIte
+00005300: 7261 7469 6f6e 3a0a 2020 2020 2020 2020  ration:.        
+00005310: 2020 2020 6272 6561 6b0a 0a20 2020 2023      break..    #
+00005320: 2066 6c75 7368 206f 7574 2069 7465 7261   flush out itera
+00005330: 746f 7220 6966 206e 6565 6465 6420 2867  tor if needed (g
+00005340: 6574 2061 6e79 206c 6173 7420 636f 6d6d  et any last comm
+00005350: 656e 7473 290a 2020 2020 7472 793a 0a20  ents).    try:. 
+00005360: 2020 2020 2020 2073 203d 2066 6974 6572         s = fiter
+00005370: 2e73 656e 6428 5472 7565 290a 2020 2020  .send(True).    
+00005380: 6578 6365 7074 2053 746f 7049 7465 7261  except StopItera
+00005390: 7469 6f6e 3a0a 2020 2020 2020 2020 7061  tion:.        pa
+000053a0: 7373 0a20 2020 2064 656c 2066 6974 6572  ss.    del fiter
+000053b0: 0a0a 2020 2020 6966 206c 656e 2856 616c  ..    if len(Val
+000053c0: 7329 203e 2030 3a0a 2020 2020 2020 2020  s) > 0:.        
+000053d0: 6966 206e 6f74 2028 746f 6469 6374 206f  if not (todict o
+000053e0: 7220 746f 6c69 7374 293a 0a20 2020 2020  r tolist):.     
+000053f0: 2020 2020 2020 206e 7056 616c 7320 3d20         npVals = 
+00005400: 6e70 2e65 6d70 7479 2828 6c65 6e28 5661  np.empty((len(Va
+00005410: 6c73 292c 206d 786c 656e 292c 2064 7479  ls), mxlen), dty
+00005420: 7065 3d64 7479 7065 290a 2020 2020 2020  pe=dtype).      
+00005430: 2020 2020 2020 6e70 5661 6c73 5b3a 5d20        npVals[:] 
+00005440: 3d20 626c 616e 6b0a 2020 2020 2020 2020  = blank.        
+00005450: 2020 2020 666f 7220 692c 2076 616c 7320      for i, vals 
+00005460: 696e 2065 6e75 6d65 7261 7465 2856 616c  in enumerate(Val
+00005470: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
+00005480: 2020 2020 6e70 5661 6c73 5b69 2c20 3a20      npVals[i, : 
+00005490: 6c65 6e28 7661 6c73 295d 203d 2076 616c  len(vals)] = val
+000054a0: 730a 2020 2020 2020 2020 2020 2020 5661  s.            Va
+000054b0: 6c73 203d 206e 7056 616c 730a 2020 2020  ls = npVals.    
+000054c0: 2020 2020 7265 7475 726e 2056 616c 730a      return Vals.
+000054d0: 2020 2020 7265 7475 726e 206e 6f5f 6461      return no_da
+000054e0: 7461 5f72 6574 7572 6e0a 0a0a 6465 6620  ta_return...def 
+000054f0: 7264 646d 6967 2866 2c20 646d 6967 5f6e  rddmig(f, dmig_n
+00005500: 616d 6573 3d4e 6f6e 652c 202a 2c20 6578  ames=None, *, ex
+00005510: 7061 6e64 6564 3d46 616c 7365 2c20 7371  panded=False, sq
+00005520: 7561 7265 3d46 616c 7365 293a 0a20 2020  uare=False):.   
+00005530: 2022 2222 0a20 2020 2052 6561 6420 444d   """.    Read DM
+00005540: 4947 2065 6e74 7269 6573 2066 726f 6d20  IG entries from 
+00005550: 6120 4e61 7374 7261 6e20 7075 6e63 6820  a Nastran punch 
+00005560: 2862 756c 6b29 206f 7220 6f75 7470 7574  (bulk) or output
+00005570: 3220 6669 6c65 2e0a 0a20 2020 2050 6172  2 file...    Par
+00005580: 616d 6574 6572 730a 2020 2020 2d2d 2d2d  ameters.    ----
+00005590: 2d2d 2d2d 2d2d 0a20 2020 2066 203a 2073  ------.    f : s
+000055a0: 7472 696e 6720 6f72 2066 696c 655f 6c69  tring or file_li
+000055b0: 6b65 206f 7220 4e6f 6e65 0a20 2020 2020  ke or None.     
+000055c0: 2020 2045 6974 6865 7220 6120 6e61 6d65     Either a name
+000055d0: 206f 6620 6120 7075 6e63 6820 6f72 206f   of a punch or o
+000055e0: 7574 7075 7432 2066 696c 652c 206f 7220  utput2 file, or 
+000055f0: 6973 2061 2066 696c 655f 6c69 6b65 0a20  is a file_like. 
+00005600: 2020 2020 2020 206f 626a 6563 7420 6173         object as
+00005610: 2072 6574 7572 6e65 6420 6279 203a 6675   returned by :fu
+00005620: 6e63 3a60 6f70 656e 602e 2049 6620 6861  nc:`open`. If ha
+00005630: 6e64 6c65 2c20 7075 6e63 6820 666f 726d  ndle, punch form
+00005640: 6174 2069 730a 2020 2020 2020 2020 6173  at is.        as
+00005650: 7375 6d65 6420 616e 6420 6669 6c65 2069  sumed and file i
+00005660: 7320 7265 776f 756e 6420 6669 7273 742e  s rewound first.
+00005670: 2043 616e 2061 6c73 6f20 6265 2074 6865   Can also be the
+00005680: 206e 616d 6520 6f66 2061 0a20 2020 2020   name of a.     
+00005690: 2020 2064 6972 6563 746f 7279 206f 7220     directory or 
+000056a0: 4e6f 6e65 3b20 696e 2074 6865 7365 2063  None; in these c
+000056b0: 6173 6573 2c20 6120 4755 4920 6973 206f  ases, a GUI is o
+000056c0: 7065 6e65 6420 666f 7220 6669 6c65 0a20  pened for file. 
+000056d0: 2020 2020 2020 2073 656c 6563 7469 6f6e         selection
+000056e0: 2e0a 2020 2020 646d 6967 5f6e 616d 6573  ..    dmig_names
+000056f0: 203a 204e 6f6e 652c 2073 7472 696e 672c   : None, string,
+00005700: 206f 7220 6c69 7374 5f6c 696b 6520 6f66   or list_like of
+00005710: 2073 7472 696e 6773 0a20 2020 2020 2020   strings.       
+00005720: 2049 6620 6e6f 7420 4e6f 6e65 2c20 6974   If not None, it
+00005730: 2069 7320 7468 6520 6e61 6d65 206f 7220   is the name or 
+00005740: 6e61 6d65 7320 6f66 2044 4d49 4720 656e  names of DMIG en
+00005750: 7472 7928 7329 2074 6f0a 2020 2020 2020  try(s) to.      
+00005760: 2020 7265 6164 2e20 4966 204e 6f6e 652c    read. If None,
+00005770: 2061 6c6c 2044 4d49 4720 656e 7472 6965   all DMIG entrie
+00005780: 7320 7769 6c6c 2062 6520 7265 7475 726e  s will be return
+00005790: 6564 2e0a 2020 2020 6578 7061 6e64 6564  ed..    expanded
+000057a0: 203a 2062 6f6f 6c3b 206f 7074 696f 6e61   : bool; optiona
+000057b0: 6c3b 206d 7573 7420 6265 206e 616d 6564  l; must be named
+000057c0: 0a20 2020 2020 2020 2049 6620 5472 7565  .        If True
+000057d0: 2c20 726f 7720 616e 6420 636f 6c75 6d6e  , row and column
+000057e0: 2069 6e64 6963 6573 2066 6f72 2022 4752   indices for "GR
+000057f0: 4944 2220 4944 7320 7769 6c6c 2062 650a  ID" IDs will be.
+00005800: 2020 2020 2020 2020 6578 7061 6e64 6564          expanded
+00005810: 2074 6f20 696e 636c 7564 6520 616c 6c20   to include all 
+00005820: 3620 444f 462c 2065 7665 6e20 6966 2073  6 DOF, even if s
+00005830: 6f6d 6520 6f66 2074 686f 7365 2044 4f46  ome of those DOF
+00005840: 2061 7265 0a20 2020 2020 2020 206e 6f74   are.        not
+00005850: 2075 7365 642e 204f 7468 6572 7769 7365   used. Otherwise
+00005860: 2c20 6966 2060 6578 7061 6e64 6564 6020  , if `expanded` 
+00005870: 6973 2046 616c 7365 2c20 6f6e 6c79 2074  is False, only t
+00005880: 6865 2072 6f77 2061 6e64 0a20 2020 2020  he row and.     
+00005890: 2020 2063 6f6c 756d 6e20 444f 4620 6163     column DOF ac
+000058a0: 7475 616c 6c79 2072 6566 6572 656e 6365  tually reference
+000058b0: 6420 6f6e 2074 6865 2044 4d49 4720 7769  d on the DMIG wi
+000058c0: 6c6c 2062 650a 2020 2020 2020 2020 696e  ll be.        in
+000058d0: 636c 7564 6564 2e0a 2020 2020 7371 7561  cluded..    squa
+000058e0: 7265 203a 2062 6f6f 6c3b 206f 7074 696f  re : bool; optio
+000058f0: 6e61 6c3b 206d 7573 7420 6265 206e 616d  nal; must be nam
+00005900: 6564 0a20 2020 2020 2020 204f 6e6c 7920  ed.        Only 
+00005910: 7573 6564 2066 6f72 2022 7371 7561 7265  used for "square
+00005920: 2220 6d61 7472 6963 6573 2028 6060 666f  " matrices (``fo
+00005930: 726d 3d31 6060 292e 2049 6620 5472 7565  rm=1``). If True
+00005940: 2c20 656e 7375 7265 730a 2020 2020 2020  , ensures.      
+00005950: 2020 7468 6174 2074 6865 2072 6f77 2061    that the row a
+00005960: 6e64 2063 6f6c 756d 6e20 696e 6469 6365  nd column indice
+00005970: 7320 6172 6520 7468 6520 7361 6d65 2062  s are the same b
+00005980: 7920 6669 6c6c 696e 6720 696e 0a20 2020  y filling in.   
+00005990: 2020 2020 207a 6572 6f73 2061 7320 6e65       zeros as ne
+000059a0: 6365 7373 6172 792e 0a0a 2020 2020 5265  cessary...    Re
+000059b0: 7475 726e 730a 2020 2020 2d2d 2d2d 2d2d  turns.    ------
+000059c0: 2d0a 2020 2020 6463 7420 3a20 6469 6374  -.    dct : dict
+000059d0: 696f 6e61 7279 0a20 2020 2020 2020 2044  ionary.        D
+000059e0: 6963 7469 6f6e 6172 7920 6f66 2070 616e  ictionary of pan
+000059f0: 6461 7320 4461 7461 4672 616d 6573 2063  das DataFrames c
+00005a00: 6f6e 7461 696e 696e 6720 7468 6520 444d  ontaining the DM
+00005a10: 4947 0a20 2020 2020 2020 2065 6e74 7269  IG.        entri
+00005a20: 6573 2e20 5468 6520 636f 6c75 6d6e 2061  es. The column a
+00005a30: 6e64 2072 6f77 2069 6e64 6963 6573 2061  nd row indices a
+00005a40: 7265 2070 616e 6461 7320 4d75 6c74 6949  re pandas MultiI
+00005a50: 6e64 6578 0a20 2020 2020 2020 206f 626a  ndex.        obj
+00005a60: 6563 7473 2077 6974 6820 6e6f 6465 2049  ects with node I
+00005a70: 4420 696e 206c 6576 656c 2030 2061 6e64  D in level 0 and
+00005a80: 2044 4f46 2069 6e20 6c65 7665 6c20 3120   DOF in level 1 
+00005a90: 2874 6865 206e 616d 6573 0a20 2020 2020  (the names.     
+00005aa0: 2020 2061 7265 2022 6964 2220 616e 6420     are "id" and 
+00005ab0: 2264 6f66 2229 2e20 5468 6520 6578 6365  "dof"). The exce
+00005ac0: 7074 696f 6e20 6973 2066 6f72 2066 6f72  ption is for for
+00005ad0: 6d20 2239 2220 6d61 7472 6963 6573 3a0a  m "9" matrices:.
+00005ae0: 2020 2020 2020 2020 7468 6520 636f 6c75          the colu
+00005af0: 6d6e 2069 6e64 6578 2069 6e20 7468 6174  mn index in that
+00005b00: 2063 6173 6520 6973 206a 7573 7420 7468   case is just th
+00005b10: 6520 636f 6c75 6d6e 206e 756d 6265 7220  e column number 
+00005b20: 2861 730a 2020 2020 2020 2020 7370 6563  (as.        spec
+00005b30: 6966 6965 6420 6279 204e 6173 7472 616e  ified by Nastran
+00005b40: 292e 0a0a 2020 2020 4e6f 7465 730a 2020  )...    Notes.  
+00005b50: 2020 2d2d 2d2d 2d0a 2020 2020 466f 7220    -----.    For 
+00005b60: 7468 6520 7075 6e63 6820 666f 726d 6174  the punch format
+00005b70: 2c20 7468 6973 2072 6f75 7469 6e65 2066  , this routine f
+00005b80: 6972 7374 2072 6561 6473 2061 6c6c 2044  irst reads all D
+00005b90: 4d49 4720 656e 7472 6965 730a 2020 2020  MIG entries.    
+00005ba0: 7669 6120 3a66 756e 633a 6072 6463 6172  via :func:`rdcar
+00005bb0: 6473 6020 7573 696e 6720 7468 6520 276c  ds` using the 'l
+00005bc0: 6973 7427 206f 7574 7075 7420 6f70 7469  ist' output opti
+00005bd0: 6f6e 2e20 4974 2074 6865 6e20 6275 696c  on. It then buil
+00005be0: 6473 0a20 2020 2061 2064 6963 7469 6f6e  ds.    a diction
+00005bf0: 6172 7920 6f66 2044 6174 6146 7261 6d65  ary of DataFrame
+00005c00: 7320 666f 7220 6f6e 6c79 2074 686f 7365  s for only those
+00005c10: 2065 6e74 7269 6573 2073 7065 6369 6669   entries specifi
+00005c20: 6564 2069 6e0a 2020 2020 6064 6d69 675f  ed in.    `dmig_
+00005c30: 6e61 6d65 7360 2e20 4974 2069 7320 6173  names`. It is as
+00005c40: 7375 6d65 6420 7468 6174 2044 4d49 4720  sumed that DMIG 
+00005c50: 656e 7472 6965 7320 6172 6520 696e 206f  entries are in o
+00005c60: 7264 6572 2069 6e20 7468 650a 2020 2020  rder in the.    
+00005c70: 6669 6c65 2e0a 0a20 2020 2046 6f72 2074  file...    For t
+00005c80: 6865 206f 7574 7075 7432 2066 6f72 6d61  he output2 forma
+00005c90: 742c 2074 6869 7320 726f 7574 696e 6520  t, this routine 
+00005ca0: 7363 616e 7320 7468 726f 7567 6820 7468  scans through th
+00005cb0: 6520 6669 6c65 0a20 2020 206c 6f6f 6b69  e file.    looki
+00005cc0: 6e67 2066 6f72 206d 6174 6368 696e 6720  ng for matching 
+00005cd0: 444d 4947 2064 6174 612d 626c 6f63 6b73  DMIG data-blocks
+00005ce0: 2061 6e64 206f 6e6c 7920 7265 6164 7320   and only reads 
+00005cf0: 7468 6f73 6520 696e 2e0a 0a20 2020 202e  those in...    .
+00005d00: 2e20 6e6f 7465 3a3a 0a20 2020 2020 2020  . note::.       
+00005d10: 2054 6869 7320 726f 7574 696e 6520 6973   This routine is
+00005d20: 206d 6f72 6520 6c65 6e69 656e 7420 7468   more lenient th
+00005d30: 616e 204e 6173 7472 616e 2e20 4e61 7374  an Nastran. Nast
+00005d40: 7261 6e20 7769 6c6c 2069 7373 7565 0a20  ran will issue. 
+00005d50: 2020 2020 2020 2061 2046 4154 414c 206d         a FATAL m
+00005d60: 6573 7361 6765 2069 6620 6120 7379 6d6d  essage if a symm
+00005d70: 6574 7269 6320 6d61 7472 6978 2068 6173  etric matrix has
+00005d80: 2065 6e74 7269 6573 2066 6f72 2065 6c65   entries for ele
+00005d90: 6d65 6e74 0a20 2020 2020 2020 2028 692c  ment.        (i,
+00005da0: 206a 2920 616e 6420 286a 2c20 6929 2e20   j) and (j, i). 
+00005db0: 5468 6973 2072 6f75 7469 6e65 2064 6f65  This routine doe
+00005dc0: 7320 6e6f 7420 6368 6563 6b20 666f 7220  s not check for 
+00005dd0: 7468 6174 2028 7468 650a 2020 2020 2020  that (the.      
+00005de0: 2020 6c61 7374 2076 616c 7565 2066 6f72    last value for
+00005df0: 2028 692c 206a 2920 6f72 2028 6a2c 2069   (i, j) or (j, i
+00005e00: 2920 7769 6c6c 2062 6520 7573 6564 2066  ) will be used f
+00005e10: 6f72 2062 6f74 6829 2e0a 0a20 2020 2045  or both)...    E
+00005e20: 7861 6d70 6c65 730a 2020 2020 2d2d 2d2d  xamples.    ----
+00005e30: 2d2d 2d2d 0a20 2020 204d 616e 7561 6c6c  ----.    Manuall
+00005e40: 7920 6372 6561 7465 2061 2070 756e 6368  y create a punch
+00005e50: 2066 6f72 6d61 7420 444d 4947 2073 7472   format DMIG str
+00005e60: 696e 672c 2074 7265 6174 2069 7420 6173  ing, treat it as
+00005e70: 2061 2066 696c 652c 0a20 2020 2061 6e64   a file,.    and
+00005e80: 2072 6561 6420 6974 2069 6e20 7769 7468   read it in with
+00005e90: 2061 2063 6f75 706c 6520 6469 6666 6572   a couple differ
+00005ea0: 656e 7420 6f70 7469 6f6e 733a 0a0a 2020  ent options:..  
+00005eb0: 2020 3e3e 3e20 696d 706f 7274 206e 756d    >>> import num
+00005ec0: 7079 2061 7320 6e70 0a20 2020 203e 3e3e  py as np.    >>>
+00005ed0: 2066 726f 6d20 7079 7965 7469 2069 6d70   from pyyeti imp
+00005ee0: 6f72 7420 6e61 7374 7261 6e0a 2020 2020  ort nastran.    
+00005ef0: 3e3e 3e20 6672 6f6d 2069 6f20 696d 706f  >>> from io impo
+00005f00: 7274 2053 7472 696e 6749 4f0a 2020 2020  rt StringIO.    
+00005f10: 3e3e 3e20 646d 6967 203d 2028 0a20 2020  >>> dmig = (.   
+00005f20: 202e 2e2e 2020 2744 4d49 4720 2020 204d   ...  'DMIG    M
+00005f30: 4154 2020 2020 2020 2020 2020 2020 3020  AT            0 
+00005f40: 2020 2020 2020 3120 2020 2020 2020 3220        1       2 
+00005f50: 2020 2020 2020 3027 0a20 2020 202e 2e2e        0'.    ...
+00005f60: 2020 2720 2020 2020 2020 2020 2020 2020    '             
+00005f70: 2020 2020 2020 2020 2020 325c 5c6e 270a            2\\n'.
+00005f80: 2020 2020 2e2e 2e20 2027 444d 4947 2a20      ...  'DMIG* 
+00005f90: 2020 4d41 5420 2020 2020 2020 2020 2020    MAT           
+00005fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005fb0: 2031 2020 2020 2020 2020 2020 2020 2020   1              
+00005fc0: 2031 5c5c 6e27 0a20 2020 202e 2e2e 2020   1\\n'.    ...  
+00005fd0: 272a 2020 2020 2020 2020 2020 2020 2020  '*              
+00005fe0: 2020 2020 2020 2020 3120 2020 2020 2020          1       
+00005ff0: 2020 2020 2020 2020 3320 312e 3230 3030          3 1.2000
+00006000: 3030 3030 3044 2b30 315c 5c6e 270a 2020  00000D+01\\n'.  
+00006010: 2020 2e2e 2e20 2027 2a20 2020 2020 2020    ...  '*       
+00006020: 2020 2020 2020 2020 2020 2020 2020 3130                10
+00006030: 2020 2020 2020 2020 2020 2020 2020 2030                 0
+00006040: 2031 2e30 3030 3030 3030 3030 442b 3032   1.000000000D+02
+00006050: 5c5c 6e27 0a20 2020 202e 2e2e 2029 0a20  \\n'.    ... ). 
+00006060: 2020 203e 3e3e 2077 6974 6820 5374 7269     >>> with Stri
+00006070: 6e67 494f 2864 6d69 6729 2061 7320 663a  ngIO(dmig) as f:
+00006080: 0a20 2020 202e 2e2e 2020 2020 2064 6374  .    ...     dct
+00006090: 3120 3d20 6e61 7374 7261 6e2e 7264 646d  1 = nastran.rddm
+000060a0: 6967 2866 290a 2020 2020 2e2e 2e20 2020  ig(f).    ...   
+000060b0: 2020 6463 7432 203d 206e 6173 7472 616e    dct2 = nastran
+000060c0: 2e72 6464 6d69 6728 662c 2065 7870 616e  .rddmig(f, expan
+000060d0: 6465 643d 5472 7565 290a 2020 2020 2e2e  ded=True).    ..
+000060e0: 2e20 2020 2020 6463 7433 203d 206e 6173  .     dct3 = nas
+000060f0: 7472 616e 2e72 6464 6d69 6728 662c 2073  tran.rddmig(f, s
+00006100: 7175 6172 653d 5472 7565 290a 2020 2020  quare=True).    
+00006110: 2e2e 2e20 2020 2020 6463 7434 203d 206e  ...     dct4 = n
+00006120: 6173 7472 616e 2e72 6464 6d69 6728 662c  astran.rddmig(f,
+00006130: 2065 7870 616e 6465 643d 5472 7565 2c20   expanded=True, 
+00006140: 7371 7561 7265 3d54 7275 6529 0a20 2020  square=True).   
+00006150: 203e 3e3e 2064 6374 315b 276d 6174 275d   >>> dct1['mat']
+00006160: 2020 2020 2320 646f 6374 6573 743a 202b      # doctest: +
+00006170: 454c 4c49 5053 4953 0a20 2020 2069 6420  ELLIPSIS.    id 
+00006180: 2020 2020 2020 2020 2031 0a20 2020 2064           1.    d
+00006190: 6f66 2020 2020 2020 2020 2031 0a20 2020  of         1.   
+000061a0: 2069 6420 646f 662e 2e2e 0a20 2020 2031   id dof....    1
+000061b0: 2020 3320 2020 2020 3132 2e30 0a20 2020    3     12.0.   
+000061c0: 2031 3020 3020 2020 2031 3030 2e30 0a20   10 0    100.0. 
+000061d0: 2020 203e 3e3e 2064 6374 325b 276d 6174     >>> dct2['mat
+000061e0: 275d 2020 2020 2320 646f 6374 6573 743a  ']    # doctest:
+000061f0: 202b 454c 4c49 5053 4953 0a20 2020 2069   +ELLIPSIS.    i
+00006200: 6420 2020 2020 2020 2020 2031 2e2e 2e0a  d          1....
+00006210: 2020 2020 646f 6620 2020 2020 2020 2020      dof         
+00006220: 3120 2020 2032 2020 2020 3320 2020 2034  1    2    3    4
+00006230: 2020 2020 3520 2020 2036 0a20 2020 2069      5    6.    i
+00006240: 6420 646f 662e 2e2e 0a20 2020 2031 2020  d dof....    1  
+00006250: 3120 2020 2020 2030 2e30 2020 302e 3020  1      0.0  0.0 
+00006260: 2030 2e30 2020 302e 3020 2030 2e30 2020   0.0  0.0  0.0  
+00006270: 302e 300a 2020 2020 2020 2032 2020 2020  0.0.       2    
+00006280: 2020 302e 3020 2030 2e30 2020 302e 3020    0.0  0.0  0.0 
+00006290: 2030 2e30 2020 302e 3020 2030 2e30 0a20   0.0  0.0  0.0. 
+000062a0: 2020 2020 2020 3320 2020 2020 3132 2e30        3     12.0
+000062b0: 2020 302e 3020 2030 2e30 2020 302e 3020    0.0  0.0  0.0 
+000062c0: 2030 2e30 2020 302e 300a 2020 2020 2020   0.0  0.0.      
+000062d0: 2034 2020 2020 2020 302e 3020 2030 2e30   4      0.0  0.0
+000062e0: 2020 302e 3020 2030 2e30 2020 302e 3020    0.0  0.0  0.0 
+000062f0: 2030 2e30 0a20 2020 2020 2020 3520 2020   0.0.       5   
+00006300: 2020 2030 2e30 2020 302e 3020 2030 2e30     0.0  0.0  0.0
+00006310: 2020 302e 3020 2030 2e30 2020 302e 300a    0.0  0.0  0.0.
+00006320: 2020 2020 2020 2036 2020 2020 2020 302e         6      0.
+00006330: 3020 2030 2e30 2020 302e 3020 2030 2e30  0  0.0  0.0  0.0
+00006340: 2020 302e 3020 2030 2e30 0a20 2020 2031    0.0  0.0.    1
+00006350: 3020 3020 2020 2031 3030 2e30 2020 302e  0 0    100.0  0.
+00006360: 3020 2030 2e30 2020 302e 3020 2030 2e30  0  0.0  0.0  0.0
+00006370: 2020 302e 300a 2020 2020 3e3e 3e20 6463    0.0.    >>> dc
+00006380: 7433 5b27 6d61 7427 5d20 2020 2023 2064  t3['mat']    # d
+00006390: 6f63 7465 7374 3a20 2b45 4c4c 4950 5349  octest: +ELLIPSI
+000063a0: 530a 2020 2020 6964 2020 2020 2020 2020  S.    id        
+000063b0: 2031 2020 2020 2020 2020 2031 300a 2020   1         10.  
+000063c0: 2020 646f 6620 2020 2020 2020 2020 3120    dof         1 
+000063d0: 2020 2033 2020 2020 300a 2020 2020 6964     3    0.    id
+000063e0: 2064 6f66 2e2e 2e0a 2020 2020 3120 2031   dof....    1  1
+000063f0: 2020 2020 2020 302e 3020 2030 2e30 2020        0.0  0.0  
+00006400: 302e 300a 2020 2020 2020 2033 2020 2020  0.0.       3    
+00006410: 2031 322e 3020 2030 2e30 2020 302e 300a   12.0  0.0  0.0.
+00006420: 2020 2020 3130 2030 2020 2020 3130 302e      10 0    100.
+00006430: 3020 2030 2e30 2020 302e 300a 2020 2020  0  0.0  0.0.    
+00006440: 3e3e 3e20 6463 7434 5b27 6d61 7427 5d20  >>> dct4['mat'] 
+00006450: 2020 2023 2064 6f63 7465 7374 3a20 2b45     # doctest: +E
+00006460: 4c4c 4950 5349 530a 2020 2020 6964 2020  LLIPSIS.    id  
+00006470: 2020 2020 2020 2031 2020 2020 2020 2020         1        
+00006480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006490: 2020 2020 2031 300a 2020 2020 646f 6620       10.    dof 
+000064a0: 2020 2020 2020 2020 3120 2020 2032 2020          1    2  
+000064b0: 2020 3320 2020 2034 2020 2020 3520 2020    3    4    5   
+000064c0: 2036 2020 2020 300a 2020 2020 6964 2064   6    0.    id d
+000064d0: 6f66 2e2e 2e0a 2020 2020 3120 2031 2020  of....    1  1  
+000064e0: 2020 2020 302e 3020 2030 2e30 2020 302e      0.0  0.0  0.
+000064f0: 3020 2030 2e30 2020 302e 3020 2030 2e30  0  0.0  0.0  0.0
+00006500: 2020 302e 300a 2020 2020 2020 2032 2020    0.0.       2  
+00006510: 2020 2020 302e 3020 2030 2e30 2020 302e      0.0  0.0  0.
+00006520: 3020 2030 2e30 2020 302e 3020 2030 2e30  0  0.0  0.0  0.0
+00006530: 2020 302e 300a 2020 2020 2020 2033 2020    0.0.       3  
+00006540: 2020 2031 322e 3020 2030 2e30 2020 302e     12.0  0.0  0.
+00006550: 3020 2030 2e30 2020 302e 3020 2030 2e30  0  0.0  0.0  0.0
+00006560: 2020 302e 300a 2020 2020 2020 2034 2020    0.0.       4  
+00006570: 2020 2020 302e 3020 2030 2e30 2020 302e      0.0  0.0  0.
+00006580: 3020 2030 2e30 2020 302e 3020 2030 2e30  0  0.0  0.0  0.0
+00006590: 2020 302e 300a 2020 2020 2020 2035 2020    0.0.       5  
+000065a0: 2020 2020 302e 3020 2030 2e30 2020 302e      0.0  0.0  0.
+000065b0: 3020 2030 2e30 2020 302e 3020 2030 2e30  0  0.0  0.0  0.0
+000065c0: 2020 302e 300a 2020 2020 2020 2036 2020    0.0.       6  
+000065d0: 2020 2020 302e 3020 2030 2e30 2020 302e      0.0  0.0  0.
+000065e0: 3020 2030 2e30 2020 302e 3020 2030 2e30  0  0.0  0.0  0.0
+000065f0: 2020 302e 300a 2020 2020 3130 2030 2020    0.0.    10 0  
+00006600: 2020 3130 302e 3020 2030 2e30 2020 302e    100.0  0.0  0.
+00006610: 3020 2030 2e30 2020 302e 3020 2030 2e30  0  0.0  0.0  0.0
+00006620: 2020 302e 300a 2020 2020 2222 220a 2020    0.0.    """.  
+00006630: 2020 2320 4e6f 7465 7320 6f6e 2044 4d49    # Notes on DMI
+00006640: 4720 666f 726d 6174 3a0a 2020 2020 2320  G format:.    # 
+00006650: 2d20 726f 7773 2061 7265 2061 6c77 6179  - rows are alway
+00006660: 7320 672d 7365 7420 6f72 2070 2d73 6574  s g-set or p-set
+00006670: 2073 697a 650a 2020 2020 2320 2d20 7371   size.    # - sq
+00006680: 7561 7265 3a0a 2020 2020 2320 2020 2d20  uare:.    #   - 
+00006690: 666f 726d 6174 2031 2069 7320 6765 6e65  format 1 is gene
+000066a0: 7261 6c20 7371 7561 7265 0a20 2020 2023  ral square.    #
+000066b0: 2020 202d 2066 6f72 6d61 7420 3620 6973     - format 6 is
+000066c0: 2073 796d 6d65 7472 6963 2061 6e64 206f   symmetric and o
+000066d0: 6e6c 7920 6f6e 6520 6f66 2065 6163 6820  nly one of each 
+000066e0: 2869 2c20 6a29 206f 7220 286a 2c20 6929  (i, j) or (j, i)
+000066f0: 0a20 2020 2023 2020 2020 2070 6169 7220  .    #     pair 
+00006700: 6d61 7920 6265 2070 726f 7669 6465 6420  may be provided 
+00006710: 284e 6173 7472 616e 2077 696c 6c20 4641  (Nastran will FA
+00006720: 5441 4c20 6f74 6865 7277 6973 6529 0a20  TAL otherwise). 
+00006730: 2020 2023 202d 2072 6563 7461 6e67 756c     # - rectangul
+00006740: 6172 3a0a 2020 2020 2320 2020 2d20 666f  ar:.    #   - fo
+00006750: 726d 6174 2032 0a20 2020 2023 2020 202d  rmat 2.    #   -
+00006760: 2066 6f72 6d61 7420 3920 7573 6573 2027   format 9 uses '
+00006770: 6e63 6f6c 2720 616e 6420 646f 6573 6e27  ncol' and doesn'
+00006780: 7420 6861 7665 2061 6374 7561 6c20 6772  t have actual gr
+00006790: 6964 2f64 6f66 2070 6169 7273 0a20 2020  id/dof pairs.   
+000067a0: 2023 2020 2020 2066 6f72 2063 6f6c 756d   #     for colum
+000067b0: 6e73 3b20 6275 7420 7468 6520 7061 6972  ns; but the pair
+000067c0: 7320 7072 6f76 6964 6564 2064 6f20 6465  s provided do de
+000067d0: 7465 726d 696e 6520 736f 7274 206f 7264  termine sort ord
+000067e0: 6572 0a0a 2020 2020 6465 6620 5f61 6464  er..    def _add
+000067f0: 5f69 6464 6f66 5f65 7870 616e 6465 6428  _iddof_expanded(
+00006800: 6964 732c 2069 6464 6f66 2c20 6e69 642c  ids, iddof, nid,
+00006810: 2064 6f66 293a 0a20 2020 2020 2020 2023   dof):.        #
+00006820: 2069 6464 6f66 2069 7320 6120 6c69 7374   iddof is a list
+00006830: 0a20 2020 2020 2020 2069 6620 6e69 6420  .        if nid 
+00006840: 6e6f 7420 696e 2069 6473 3a0a 2020 2020  not in ids:.    
+00006850: 2020 2020 2020 2020 6964 732e 6164 6428          ids.add(
+00006860: 6e69 6429 0a20 2020 2020 2020 2020 2020  nid).           
+00006870: 2069 6620 646f 6620 3e20 303a 0a20 2020   if dof > 0:.   
+00006880: 2020 2020 2020 2020 2020 2020 2069 6464               idd
+00006890: 6f66 2e65 7874 656e 6428 5b28 6e69 642c  of.extend([(nid,
+000068a0: 206b 2920 666f 7220 6b20 696e 2072 616e   k) for k in ran
+000068b0: 6765 2831 2c20 3729 5d29 0a20 2020 2020  ge(1, 7)]).     
+000068c0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+000068d0: 2020 2020 2020 2020 2020 2020 2069 6464               idd
+000068e0: 6f66 2e61 7070 656e 6428 286e 6964 2c20  of.append((nid, 
+000068f0: 3029 290a 0a20 2020 2064 6566 205f 6164  0))..    def _ad
+00006900: 645f 6964 646f 665f 6d69 6e69 6d61 6c28  d_iddof_minimal(
+00006910: 6964 732c 2069 6464 6f66 2c20 6e69 642c  ids, iddof, nid,
+00006920: 2064 6f66 293a 0a20 2020 2020 2020 2023   dof):.        #
+00006930: 2069 6464 6f66 2069 7320 6120 7365 740a   iddof is a set.
+00006940: 2020 2020 2020 2020 6964 646f 662e 6164          iddof.ad
+00006950: 6428 286e 6964 2c20 646f 6629 290a 0a20  d((nid, dof)).. 
+00006960: 2020 2064 6566 205f 6d6b 5f69 6e64 6578     def _mk_index
+00006970: 2869 6464 6f66 293a 0a20 2020 2020 2020  (iddof):.       
+00006980: 2069 6464 6f66 203d 2073 6f72 7465 6428   iddof = sorted(
+00006990: 6964 646f 662c 206b 6579 3d6c 616d 6264  iddof, key=lambd
+000069a0: 6120 783a 2031 3020 2a20 785b 305d 202b  a x: 10 * x[0] +
+000069b0: 2078 5b31 5d29 0a20 2020 2020 2020 2072   x[1]).        r
+000069c0: 6574 7572 6e20 7064 2e4d 756c 7469 496e  eturn pd.MultiIn
+000069d0: 6465 782e 6672 6f6d 5f74 7570 6c65 7328  dex.from_tuples(
+000069e0: 6964 646f 662c 206e 616d 6573 3d5b 2269  iddof, names=["i
+000069f0: 6422 2c20 2264 6f66 225d 290a 0a20 2020  d", "dof"])..   
+00006a00: 2064 6566 205f 7072 6570 5f64 6174 6166   def _prep_dataf
+00006a10: 7261 6d65 286d 7479 7065 2c20 666f 726d  rame(mtype, form
+00006a20: 2c20 726f 775f 6964 732c 2072 6f77 5f69  , row_ids, row_i
+00006a30: 6464 6f66 2c20 636f 6c5f 6964 646f 662c  ddof, col_iddof,
+00006a40: 206e 636f 6c29 3a0a 2020 2020 2020 2020   ncol):.        
+00006a50: 2320 6372 6561 7465 2064 6174 6166 7261  # create datafra
+00006a60: 6d65 3a0a 2020 2020 2020 2020 6474 7970  me:.        dtyp
+00006a70: 6520 3d20 666c 6f61 7420 6966 206d 7479  e = float if mty
+00006a80: 7065 203c 2033 2065 6c73 6520 636f 6d70  pe < 3 else comp
+00006a90: 6c65 780a 2020 2020 2020 2020 6966 2066  lex.        if f
+00006aa0: 6f72 6d20 213d 2039 3a0a 2020 2020 2020  orm != 9:.      
+00006ab0: 2020 2020 2020 6966 2066 6f72 6d20 3d3d        if form ==
+00006ac0: 2036 206f 7220 2866 6f72 6d20 3d3d 2031   6 or (form == 1
+00006ad0: 2061 6e64 2073 7175 6172 6529 3a0a 2020   and square):.  
+00006ae0: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+00006af0: 7220 6e69 642c 2064 6f66 2069 6e20 636f  r nid, dof in co
+00006b00: 6c5f 6964 646f 663a 0a20 2020 2020 2020  l_iddof:.       
+00006b10: 2020 2020 2020 2020 2020 2020 2061 6464               add
+00006b20: 5f69 6464 6f66 2872 6f77 5f69 6473 2c20  _iddof(row_ids, 
+00006b30: 726f 775f 6964 646f 662c 206e 6964 2c20  row_iddof, nid, 
+00006b40: 646f 6629 0a20 2020 2020 2020 2020 2020  dof).           
+00006b50: 2020 2020 2072 6f77 696e 6465 7820 3d20       rowindex = 
+00006b60: 5f6d 6b5f 696e 6465 7828 726f 775f 6964  _mk_index(row_id
+00006b70: 646f 6629 0a20 2020 2020 2020 2020 2020  dof).           
+00006b80: 2020 2020 2063 6f6c 696e 6465 7820 3d20       colindex = 
+00006b90: 726f 7769 6e64 6578 0a20 2020 2020 2020  rowindex.       
+00006ba0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00006bb0: 2020 2020 2020 2020 2020 2072 6f77 696e             rowin
+00006bc0: 6465 7820 3d20 5f6d 6b5f 696e 6465 7828  dex = _mk_index(
+00006bd0: 726f 775f 6964 646f 6629 0a20 2020 2020  row_iddof).     
+00006be0: 2020 2020 2020 2020 2020 2063 6f6c 696e             colin
+00006bf0: 6465 7820 3d20 5f6d 6b5f 696e 6465 7828  dex = _mk_index(
+00006c00: 636f 6c5f 6964 646f 6629 0a20 2020 2020  col_iddof).     
+00006c10: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00006c20: 2020 2020 2072 6f77 696e 6465 7820 3d20       rowindex = 
+00006c30: 5f6d 6b5f 696e 6465 7828 726f 775f 6964  _mk_index(row_id
+00006c40: 646f 6629 0a20 2020 2020 2020 2020 2020  dof).           
+00006c50: 2069 6620 6578 7061 6e64 6564 3a0a 2020   if expanded:.  
+00006c60: 2020 2020 2020 2020 2020 2020 2020 636f                co
+00006c70: 6c69 6e64 6578 203d 206e 702e 6172 616e  lindex = np.aran
+00006c80: 6765 2831 2c20 6e63 6f6c 202b 2031 290a  ge(1, ncol + 1).
+00006c90: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00006ca0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00006cb0: 2020 636f 6c69 6e64 6578 203d 2073 6f72    colindex = sor
+00006cc0: 7465 6428 6e69 6420 666f 7220 6e69 642c  ted(nid for nid,
+00006cd0: 2064 6f66 2069 6e20 636f 6c5f 6964 646f   dof in col_iddo
+00006ce0: 6629 0a20 2020 2020 2020 2064 6174 6120  f).        data 
+00006cf0: 3d20 6e70 2e7a 6572 6f73 2828 6c65 6e28  = np.zeros((len(
+00006d00: 726f 7769 6e64 6578 292c 206c 656e 2863  rowindex), len(c
+00006d10: 6f6c 696e 6465 7829 292c 2064 7479 7065  olindex)), dtype
+00006d20: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+00006d30: 2064 6174 612c 2072 6f77 696e 6465 782c   data, rowindex,
+00006d40: 2063 6f6c 696e 6465 780a 0a20 2020 2064   colindex..    d
+00006d50: 6566 205f 6765 745f 3164 5f69 6e64 6578  ef _get_1d_index
+00006d60: 2869 6e64 6578 293a 0a20 2020 2020 2020  (index):.       
+00006d70: 2069 6e64 203d 2069 6e64 6578 2e74 6f5f   ind = index.to_
+00006d80: 6672 616d 6528 292e 7661 6c75 6573 0a20  frame().values. 
+00006d90: 2020 2020 2020 2072 6574 7572 6e20 696e         return in
+00006da0: 645b 3a2c 2030 5d20 2a20 3130 202b 2069  d[:, 0] * 10 + i
+00006db0: 6e64 5b3a 2c20 315d 0a0a 2020 2020 6465  nd[:, 1]..    de
+00006dc0: 6620 5f63 6172 6473 5f74 6f5f 6466 2863  f _cards_to_df(c
+00006dd0: 2c20 646d 6967 5f6e 616d 6573 293a 0a20  , dmig_names):. 
+00006de0: 2020 2020 2020 2023 2070 756e 6368 2066         # punch f
+00006df0: 696c 650a 2020 2020 2020 2020 6465 6620  ile.        def 
+00006e00: 5f6e 6578 745f 6928 632c 2069 293a 0a20  _next_i(c, i):. 
+00006e10: 2020 2020 2020 2020 2020 2077 6869 6c65             while
+00006e20: 2069 203c 206c 656e 2863 2920 616e 6420   i < len(c) and 
+00006e30: 635b 695d 5b30 5d2e 6c6f 7765 7228 2920  c[i][0].lower() 
+00006e40: 6e6f 7420 696e 2064 6d69 675f 6e61 6d65  not in dmig_name
+00006e50: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
+00006e60: 2020 2069 202b 3d20 310a 2020 2020 2020     i += 1.      
+00006e70: 2020 2020 2020 7265 7475 726e 2069 0a0a        return i..
+00006e80: 2020 2020 2020 2020 6463 7420 3d20 7b7d          dct = {}
+00006e90: 0a20 2020 2020 2020 2069 203d 2030 0a20  .        i = 0. 
+00006ea0: 2020 2020 2020 2077 6869 6c65 2069 203c         while i <
+00006eb0: 206c 656e 2863 293a 0a20 2020 2020 2020   len(c):.       
+00006ec0: 2020 2020 2069 6620 646d 6967 5f6e 616d       if dmig_nam
+00006ed0: 6573 2069 7320 6e6f 7420 4e6f 6e65 3a0a  es is not None:.
+00006ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006ef0: 6920 3d20 5f6e 6578 745f 6928 632c 2069  i = _next_i(c, i
+00006f00: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00006f10: 2020 6966 2069 203d 3d20 6c65 6e28 6329    if i == len(c)
+00006f20: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00006f30: 2020 2020 2020 6272 6561 6b0a 2020 2020        break.    
+00006f40: 2020 2020 2020 2020 6e61 6d65 203d 2063          name = c
+00006f50: 5b69 5d5b 305d 2e6c 6f77 6572 2829 0a0a  [i][0].lower()..
+00006f60: 2020 2020 2020 2020 2020 2020 2320 666f              # fo
+00006f70: 726d 3a20 3120 7371 7561 7265 2c20 3220  rm: 1 square, 2 
+00006f80: 7265 6374 2c20 3620 7379 6d6d 6574 7269  rect, 6 symmetri
+00006f90: 632c 2039 2072 6563 740a 2020 2020 2020  c, 9 rect.      
+00006fa0: 2020 2020 2020 666f 726d 203d 2063 5b69        form = c[i
+00006fb0: 5d5b 325d 0a20 2020 2020 2020 2020 2020  ][2].           
+00006fc0: 2023 206d 7479 7065 3a20 3120 7265 616c   # mtype: 1 real
+00006fd0: 2c20 3220 646f 7562 6c65 2c20 3320 636f  , 2 double, 3 co
+00006fe0: 6d70 6c65 782c 2034 2063 6f6d 706c 6578  mplex, 4 complex
+00006ff0: 2064 6f75 626c 650a 2020 2020 2020 2020   double.        
+00007000: 2020 2020 6d74 7970 6520 3d20 635b 695d      mtype = c[i]
+00007010: 5b33 5d0a 2020 2020 2020 2020 2020 2020  [3].            
+00007020: 6e63 6f6c 203d 2063 5b69 5d5b 375d 2069  ncol = c[i][7] i
+00007030: 6620 666f 726d 203d 3d20 3920 656c 7365  f form == 9 else
+00007040: 204e 6f6e 650a 0a20 2020 2020 2020 2020   None..         
+00007050: 2020 2023 2043 6f75 6e74 2044 4f46 2066     # Count DOF f
+00007060: 6f72 2044 4d49 4720 6e61 6d65 0a20 2020  or DMIG name.   
+00007070: 2020 2020 2020 2020 206a 203d 2069 202b           j = i +
+00007080: 2031 0a20 2020 2020 2020 2020 2020 2072   1.            r
+00007090: 6f77 5f69 6473 203d 2073 6574 2829 0a20  ow_ids = set(). 
+000070a0: 2020 2020 2020 2020 2020 2063 6f6c 5f69             col_i
+000070b0: 6473 203d 2073 6574 2829 0a20 2020 2020  ds = set().     
+000070c0: 2020 2020 2020 2063 6f6c 5f69 6464 6f66         col_iddof
+000070d0: 203d 2069 6464 6f66 5f69 6e69 7469 616c   = iddof_initial
+000070e0: 697a 6572 2829 0a20 2020 2020 2020 2020  izer().         
+000070f0: 2020 2072 6f77 5f69 6464 6f66 203d 2069     row_iddof = i
+00007100: 6464 6f66 5f69 6e69 7469 616c 697a 6572  ddof_initializer
+00007110: 2829 0a0a 2020 2020 2020 2020 2020 2020  ()..            
+00007120: 2320 6c6f 6f6b 2061 6372 6f73 7320 636f  # look across co
+00007130: 6c75 6d6e 7320 2865 6163 6820 444d 4947  lumns (each DMIG
+00007140: 2065 6e74 7279 2069 7320 6120 636f 6c75   entry is a colu
+00007150: 6d6e 290a 2020 2020 2020 2020 2020 2020  mn).            
+00007160: 7768 696c 6520 6a20 3c20 6c65 6e28 6329  while j < len(c)
+00007170: 2061 6e64 2063 5b6a 5d5b 305d 2e6c 6f77   and c[j][0].low
+00007180: 6572 2829 203d 3d20 6e61 6d65 3a0a 2020  er() == name:.  
+00007190: 2020 2020 2020 2020 2020 2020 2020 6e69                ni
+000071a0: 642c 2064 6f66 203d 2063 5b6a 5d5b 313a  d, dof = c[j][1:
+000071b0: 335d 0a20 2020 2020 2020 2020 2020 2020  3].             
+000071c0: 2020 2061 6464 5f69 6464 6f66 2863 6f6c     add_iddof(col
+000071d0: 5f69 6473 2c20 636f 6c5f 6964 646f 662c  _ids, col_iddof,
+000071e0: 206e 6964 2c20 646f 6629 0a0a 2020 2020   nid, dof)..    
+000071f0: 2020 2020 2020 2020 2020 2020 2320 666f              # fo
+00007200: 7220 6561 6368 2063 6f6c 756d 6e2c 206c  r each column, l
+00007210: 6f6f 6b20 6163 726f 7373 2072 6f77 733a  ook across rows:
+00007220: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00007230: 2072 6f77 6964 7320 3d20 635b 6a5d 5b34   rowids = c[j][4
+00007240: 3a3a 345d 0a20 2020 2020 2020 2020 2020  ::4].           
+00007250: 2020 2020 2072 6f77 646f 6673 203d 2063       rowdofs = c
+00007260: 5b6a 5d5b 353a 3a34 5d0a 2020 2020 2020  [j][5::4].      
+00007270: 2020 2020 2020 2020 2020 666f 7220 6e69            for ni
+00007280: 642c 2064 6f66 2069 6e20 7a69 7028 726f  d, dof in zip(ro
+00007290: 7769 6473 2c20 726f 7764 6f66 7329 3a0a  wids, rowdofs):.
+000072a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000072b0: 2020 2020 6164 645f 6964 646f 6628 726f      add_iddof(ro
+000072c0: 775f 6964 732c 2072 6f77 5f69 6464 6f66  w_ids, row_iddof
+000072d0: 2c20 6e69 642c 2064 6f66 290a 2020 2020  , nid, dof).    
+000072e0: 2020 2020 2020 2020 2020 2020 6a20 2b3d              j +=
+000072f0: 2031 0a0a 2020 2020 2020 2020 2020 2020   1..            
+00007300: 2320 6372 6561 7465 2064 6174 6166 7261  # create datafra
+00007310: 6d65 3a0a 2020 2020 2020 2020 2020 2020  me:.            
+00007320: 6d61 742c 2072 6f77 696e 6465 782c 2063  mat, rowindex, c
+00007330: 6f6c 696e 6465 7820 3d20 5f70 7265 705f  olindex = _prep_
+00007340: 6461 7461 6672 616d 6528 0a20 2020 2020  dataframe(.     
+00007350: 2020 2020 2020 2020 2020 206d 7479 7065             mtype
+00007360: 2c20 666f 726d 2c20 726f 775f 6964 732c  , form, row_ids,
+00007370: 2072 6f77 5f69 6464 6f66 2c20 636f 6c5f   row_iddof, col_
+00007380: 6964 646f 662c 206e 636f 6c0a 2020 2020  iddof, ncol.    
+00007390: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+000073a0: 2020 2020 2020 206a 203d 2069 202b 2031         j = i + 1
+000073b0: 0a20 2020 2020 2020 2020 2020 2023 2070  .            # p
+000073c0: 7574 2064 6174 6120 696e 746f 2064 6174  ut data into dat
+000073d0: 6166 7261 6d65 3a0a 2020 2020 2020 2020  aframe:.        
+000073e0: 2020 2020 725f 6964 5f64 6f66 203d 205f      r_id_dof = _
+000073f0: 6765 745f 3164 5f69 6e64 6578 2872 6f77  get_1d_index(row
+00007400: 696e 6465 7829 0a20 2020 2020 2020 2020  index).         
+00007410: 2020 2069 6620 666f 726d 2021 3d20 393a     if form != 9:
+00007420: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00007430: 2063 5f69 645f 646f 6620 3d20 5f67 6574   c_id_dof = _get
+00007440: 5f31 645f 696e 6465 7828 636f 6c69 6e64  _1d_index(colind
+00007450: 6578 290a 2020 2020 2020 2020 2020 2020  ex).            
+00007460: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+00007470: 2020 2020 2020 635f 6964 5f64 6f66 203d        c_id_dof =
+00007480: 2063 6f6c 696e 6465 780a 2020 2020 2020   colindex.      
+00007490: 2020 2020 2020 7768 696c 6520 6a20 3c20        while j < 
+000074a0: 6c65 6e28 6329 2061 6e64 2063 5b6a 5d5b  len(c) and c[j][
+000074b0: 305d 2e6c 6f77 6572 2829 203d 3d20 6e61  0].lower() == na
+000074c0: 6d65 3a0a 2020 2020 2020 2020 2020 2020  me:.            
+000074d0: 2020 2020 6e69 642c 2064 6f66 203d 2063      nid, dof = c
+000074e0: 5b6a 5d5b 313a 335d 0a20 2020 2020 2020  [j][1:3].       
+000074f0: 2020 2020 2020 2020 2069 6620 666f 726d           if form
+00007500: 2021 3d20 393a 0a20 2020 2020 2020 2020   != 9:.         
+00007510: 2020 2020 2020 2020 2020 206e 6964 203d             nid =
+00007520: 206e 6964 202a 2031 3020 2b20 646f 660a   nid * 10 + dof.
+00007530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007540: 6369 203d 206e 702e 7365 6172 6368 736f  ci = np.searchso
+00007550: 7274 6564 2863 5f69 645f 646f 662c 206e  rted(c_id_dof, n
+00007560: 6964 290a 0a20 2020 2020 2020 2020 2020  id)..           
+00007570: 2020 2020 2023 2066 6f72 2065 6163 6820       # for each 
+00007580: 636f 6c75 6d6e 2c20 6c6f 6f6b 2061 6372  column, look acr
+00007590: 6f73 7320 726f 7773 3a0a 2020 2020 2020  oss rows:.      
+000075a0: 2020 2020 2020 2020 2020 726f 7769 6473            rowids
+000075b0: 203d 2063 5b6a 5d5b 343a 3a34 5d0a 2020   = c[j][4::4].  
+000075c0: 2020 2020 2020 2020 2020 2020 2020 726f                ro
+000075d0: 7764 6f66 7320 3d20 635b 6a5d 5b35 3a3a  wdofs = c[j][5::
+000075e0: 345d 0a20 2020 2020 2020 2020 2020 2020  4].             
+000075f0: 2020 2072 6561 6c73 203d 2063 5b6a 5d5b     reals = c[j][
+00007600: 363a 3a34 5d0a 2020 2020 2020 2020 2020  6::4].          
+00007610: 2020 2020 2020 6966 206d 7479 7065 203c        if mtype <
+00007620: 2033 3a0a 2020 2020 2020 2020 2020 2020   3:.            
+00007630: 2020 2020 2020 2020 666f 7220 6e69 642c          for nid,
+00007640: 2064 6f66 2c20 7265 616c 2069 6e20 7a69   dof, real in zi
+00007650: 7028 726f 7769 6473 2c20 726f 7764 6f66  p(rowids, rowdof
+00007660: 732c 2072 6561 6c73 293a 0a20 2020 2020  s, reals):.     
+00007670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007680: 2020 2072 6920 3d20 6e70 2e73 6561 7263     ri = np.searc
+00007690: 6873 6f72 7465 6428 725f 6964 5f64 6f66  hsorted(r_id_dof
+000076a0: 2c20 6e69 6420 2a20 3130 202b 2064 6f66  , nid * 10 + dof
+000076b0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+000076c0: 2020 2020 2020 2020 2020 6d61 745b 7269            mat[ri
+000076d0: 2c20 6369 5d20 3d20 7265 616c 0a20 2020  , ci] = real.   
+000076e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000076f0: 2020 2020 2069 6620 666f 726d 203d 3d20       if form == 
+00007700: 363a 0a20 2020 2020 2020 2020 2020 2020  6:.             
+00007710: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+00007720: 6174 5b63 692c 2072 695d 203d 2072 6561  at[ci, ri] = rea
+00007730: 6c0a 2020 2020 2020 2020 2020 2020 2020  l.              
+00007740: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00007750: 2020 2020 2020 2020 2020 2020 696d 6167              imag
+00007760: 7320 3d20 635b 6a5d 5b37 3a3a 345d 0a20  s = c[j][7::4]. 
+00007770: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007780: 2020 2066 6f72 206e 6964 2c20 646f 662c     for nid, dof,
+00007790: 2072 6561 6c2c 2069 6d61 6720 696e 207a   real, imag in z
+000077a0: 6970 2872 6f77 6964 732c 2072 6f77 646f  ip(rowids, rowdo
+000077b0: 6673 2c20 7265 616c 732c 2069 6d61 6773  fs, reals, imags
+000077c0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+000077d0: 2020 2020 2020 2020 2020 2076 616c 203d             val =
+000077e0: 2072 6561 6c20 2b20 316a 202a 2069 6d61   real + 1j * ima
+000077f0: 670a 2020 2020 2020 2020 2020 2020 2020  g.              
+00007800: 2020 2020 2020 2020 2020 7269 203d 206e            ri = n
+00007810: 702e 7365 6172 6368 736f 7274 6564 2872  p.searchsorted(r
+00007820: 5f69 645f 646f 662c 206e 6964 202a 2031  _id_dof, nid * 1
+00007830: 3020 2b20 646f 6629 0a20 2020 2020 2020  0 + dof).       
+00007840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007850: 206d 6174 5b72 692c 2063 695d 203d 2076   mat[ri, ci] = v
+00007860: 616c 0a20 2020 2020 2020 2020 2020 2020  al.             
+00007870: 2020 2020 2020 2020 2020 2069 6620 666f             if fo
+00007880: 726d 203d 3d20 363a 0a20 2020 2020 2020  rm == 6:.       
+00007890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000078a0: 2020 2020 206d 6174 5b63 692c 2072 695d       mat[ci, ri]
+000078b0: 203d 2076 616c 0a20 2020 2020 2020 2020   = val.         
+000078c0: 2020 2020 2020 206a 202b 3d20 310a 2020         j += 1.  
+000078d0: 2020 2020 2020 2020 2020 6920 3d20 6a0a            i = j.
+000078e0: 2020 2020 2020 2020 2020 2020 6463 745b              dct[
+000078f0: 6e61 6d65 5d20 3d20 7064 2e44 6174 6146  name] = pd.DataF
+00007900: 7261 6d65 286d 6174 2c20 696e 6465 783d  rame(mat, index=
+00007910: 726f 7769 6e64 6578 2c20 636f 6c75 6d6e  rowindex, column
+00007920: 733d 636f 6c69 6e64 6578 290a 2020 2020  s=colindex).    
+00007930: 2020 2020 7265 7475 726e 2064 6374 0a0a      return dct..
+00007940: 2020 2020 6465 6620 5f72 6561 645f 6f70      def _read_op
+00007950: 325f 646d 6967 286f 322c 2064 6d69 675f  2_dmig(o2, dmig_
+00007960: 6e61 6d65 7329 3a0a 2020 2020 2020 2020  names):.        
+00007970: 6f32 2e5f 6669 6c65 682e 7365 656b 286f  o2._fileh.seek(o
+00007980: 322e 5f70 6f73 7468 6561 6465 7270 6f73  2._postheaderpos
+00007990: 290a 2020 2020 2020 2020 6463 7420 3d20  ).        dct = 
+000079a0: 7b7d 0a20 2020 2020 2020 206e 616d 652c  {}.        name,
+000079b0: 2074 7261 696c 6572 2c20 6462 7479 7065   trailer, dbtype
+000079c0: 203d 206f 322e 7264 6f70 326e 7428 290a   = o2.rdop2nt().
+000079d0: 2020 2020 2020 2020 7768 696c 6520 6e61          while na
+000079e0: 6d65 2069 7320 6e6f 7420 4e6f 6e65 3a0a  me is not None:.
+000079f0: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
+00007a00: 203d 206e 616d 652e 6c6f 7765 7228 290a   = name.lower().
+00007a10: 2020 2020 2020 2020 2020 2020 2320 7072              # pr
+00007a20: 696e 7428 6627 6f70 323a 2066 6f75 6e64  int(f'op2: found
+00007a30: 207b 6e61 6d65 7d27 290a 2020 2020 2020   {name}').      
+00007a40: 2020 2020 2020 6966 2064 6d69 675f 6e61        if dmig_na
+00007a50: 6d65 7320 6973 206e 6f74 204e 6f6e 6520  mes is not None 
+00007a60: 616e 6420 6e61 6d65 2e6c 6f77 6572 2829  and name.lower()
+00007a70: 206e 6f74 2069 6e20 646d 6967 5f6e 616d   not in dmig_nam
+00007a80: 6573 3a0a 2020 2020 2020 2020 2020 2020  es:.            
+00007a90: 2020 2020 6f32 2e73 6b69 706f 7032 7461      o2.skipop2ta
+00007aa0: 626c 6528 290a 2020 2020 2020 2020 2020  ble().          
+00007ab0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00007ac0: 2020 2020 2020 2020 7265 6320 3d20 6f32          rec = o2
+00007ad0: 2e72 646f 7032 7265 636f 7264 2829 0a20  .rdop2record(). 
+00007ae0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00007af0: 6620 6e70 2e61 6c6c 2872 6563 5b3a 335d  f np.all(rec[:3]
+00007b00: 203d 3d20 2831 3134 2c20 312c 2031 3230   == (114, 1, 120
+00007b10: 2929 3a0a 2020 2020 2020 2020 2020 2020  )):.            
+00007b20: 2020 2020 2020 2020 6463 745b 6e61 6d65          dct[name
+00007b30: 5d20 3d20 7265 630a 2020 2020 2020 2020  ] = rec.        
+00007b40: 2020 2020 2020 2020 6f32 2e67 6f5f 746f          o2.go_to
+00007b50: 5f6e 6578 745f 6462 2829 0a20 2020 2020  _next_db().     
+00007b60: 2020 2020 2020 206e 616d 652c 2074 7261         name, tra
+00007b70: 696c 6572 2c20 6462 7479 7065 203d 206f  iler, dbtype = o
+00007b80: 322e 7264 6f70 326e 7428 290a 2020 2020  2.rdop2nt().    
+00007b90: 2020 2020 7265 7475 726e 2064 6374 0a0a      return dct..
+00007ba0: 2020 2020 6465 6620 5f72 6563 735f 746f      def _recs_to
+00007bb0: 5f64 6628 7265 6373 293a 0a20 2020 2020  _df(recs):.     
+00007bc0: 2020 2064 6374 203d 207b 7d0a 2020 2020     dct = {}.    
+00007bd0: 2020 2020 666f 7220 6e61 6d65 2c20 7265      for name, re
+00007be0: 6320 696e 2072 6563 732e 6974 656d 7328  c in recs.items(
+00007bf0: 293a 0a20 2020 2020 2020 2020 2020 2066  ):.            f
+00007c00: 6f72 6d20 3d20 7265 635b 365d 0a20 2020  orm = rec[6].   
+00007c10: 2020 2020 2020 2020 2023 206d 7479 7065           # mtype
+00007c20: 3a20 3120 7265 616c 2c20 3220 646f 7562  : 1 real, 2 doub
+00007c30: 6c65 2c20 3320 636f 6d70 6c65 782c 2034  le, 3 complex, 4
+00007c40: 2063 6f6d 706c 6578 2064 6f75 626c 650a   complex double.
+00007c50: 2020 2020 2020 2020 2020 2020 6d74 7970              mtyp
+00007c60: 6520 3d20 7265 635b 375d 0a20 2020 2020  e = rec[7].     
+00007c70: 2020 2020 2020 206e 636f 6c20 3d20 7265         ncol = re
+00007c80: 635b 3131 5d20 6966 2066 6f72 6d20 3d3d  c[11] if form ==
+00007c90: 2039 2065 6c73 6520 4e6f 6e65 0a0a 2020   9 else None..  
+00007ca0: 2020 2020 2020 2020 2020 6966 206d 7479            if mty
+00007cb0: 7065 203e 2032 3a0a 2020 2020 2020 2020  pe > 2:.        
+00007cc0: 2020 2020 2020 2020 696e 7473 5f70 6572          ints_per
+00007cd0: 5f6e 756d 6265 7220 3d20 3220 2a20 286d  _number = 2 * (m
+00007ce0: 7479 7065 202d 2032 290a 2020 2020 2020  type - 2).      
+00007cf0: 2020 2020 2020 2020 2020 6474 7970 6520            dtype 
+00007d00: 3d20 6e70 2e63 6f6d 706c 6578 3132 3820  = np.complex128 
+00007d10: 6966 206d 7479 7065 203d 3d20 3420 656c  if mtype == 4 el
+00007d20: 7365 206e 702e 636f 6d70 6c65 7836 340a  se np.complex64.
+00007d30: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00007d40: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00007d50: 2020 696e 7473 5f70 6572 5f6e 756d 6265    ints_per_numbe
+00007d60: 7220 3d20 6d74 7970 650a 2020 2020 2020  r = mtype.      
+00007d70: 2020 2020 2020 2020 2020 6474 7970 6520            dtype 
+00007d80: 3d20 6e70 2e66 6c6f 6174 3634 2069 6620  = np.float64 if 
+00007d90: 6d74 7970 6520 3d3d 2032 2065 6c73 6520  mtype == 2 else 
+00007da0: 6e70 2e66 6c6f 6174 3332 0a20 2020 2020  np.float32.     
+00007db0: 2020 2020 2020 2073 7465 7020 3d20 3220         step = 2 
+00007dc0: 2b20 696e 7473 5f70 6572 5f6e 756d 6265  + ints_per_numbe
+00007dd0: 7220 2023 2072 6f77 2069 642c 2064 6f66  r  # row id, dof
+00007de0: 2c20 3c6e 756d 6265 723e 0a0a 2020 2020  , <number>..    
+00007df0: 2020 2020 2020 2020 2320 436f 756e 7420          # Count 
+00007e00: 444f 4620 666f 7220 444d 4947 0a20 2020  DOF for DMIG.   
+00007e10: 2020 2020 2020 2020 2072 6f77 5f69 6473           row_ids
+00007e20: 203d 2073 6574 2829 0a20 2020 2020 2020   = set().       
+00007e30: 2020 2020 2063 6f6c 5f69 6473 203d 2073       col_ids = s
+00007e40: 6574 2829 0a20 2020 2020 2020 2020 2020  et().           
+00007e50: 2063 6f6c 5f69 6464 6f66 203d 2069 6464   col_iddof = idd
+00007e60: 6f66 5f69 6e69 7469 616c 697a 6572 2829  of_initializer()
+00007e70: 0a20 2020 2020 2020 2020 2020 2072 6f77  .            row
+00007e80: 5f69 6464 6f66 203d 2069 6464 6f66 5f69  _iddof = iddof_i
+00007e90: 6e69 7469 616c 697a 6572 2829 0a0a 2020  nitializer()..  
+00007ea0: 2020 2020 2020 2020 2020 2320 4c6f 6f6b            # Look
+00007eb0: 2061 6372 6f73 7320 636f 6c75 6d6e 7320   across columns 
+00007ec0: 666f 7220 6964 2c20 646f 6620 7061 6972  for id, dof pair
+00007ed0: 732e 2057 6974 6869 6e20 6561 6368 0a20  s. Within each. 
+00007ee0: 2020 2020 2020 2020 2020 2023 2063 6f6c             # col
+00007ef0: 756d 6e2c 206c 6f6f 6b20 6163 726f 7373  umn, look across
+00007f00: 2072 6f77 7320 666f 7220 6964 2c20 646f   rows for id, do
+00007f10: 6620 7061 6972 732e 0a0a 2020 2020 2020  f pairs...      
+00007f20: 2020 2020 2020 2320 2d20 6561 6368 2044        # - each D
+00007f30: 4d49 4720 656e 7472 7920 6973 2061 2063  MIG entry is a c
+00007f40: 6f6c 756d 6e0a 2020 2020 2020 2020 2020  olumn.          
+00007f50: 2020 2320 2d20 656e 6420 6f66 2065 6163    # - end of eac
+00007f60: 6820 444d 4947 2065 6e74 7279 2069 7320  h DMIG entry is 
+00007f70: 6d61 726b 6564 2077 6974 6820 726f 773a  marked with row:
+00007f80: 0a20 2020 2020 2020 2020 2020 2023 2020  .            #  
+00007f90: 2020 205b 6964 2c20 646f 665d 203d 205b     [id, dof] = [
+00007fa0: 2d31 2c20 2d31 5d0a 0a20 2020 2020 2020  -1, -1]..       
+00007fb0: 2020 2020 2023 2031 3220 2620 3133 2034       # 12 & 13 4
+00007fc0: 2d62 7974 6520 696e 7465 6765 7273 2061  -byte integers a
+00007fd0: 7265 2031 7374 2063 6f6c 2069 642c 2064  re 1st col id, d
+00007fe0: 6f66 2070 6169 720a 2020 2020 2020 2020  of pair.        
+00007ff0: 2020 2020 6a20 3d20 3132 0a20 2020 2020      j = 12.     
+00008000: 2020 2020 2020 2077 6869 6c65 206a 203c         while j <
+00008010: 206c 656e 2872 6563 2920 2d20 323a 0a20   len(rec) - 2:. 
+00008020: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+00008030: 6964 2c20 646f 6620 3d20 7265 635b 6a20  id, dof = rec[j 
+00008040: 3a20 6a20 2b20 325d 0a20 2020 2020 2020  : j + 2].       
+00008050: 2020 2020 2020 2020 2061 6464 5f69 6464           add_idd
+00008060: 6f66 2863 6f6c 5f69 6473 2c20 636f 6c5f  of(col_ids, col_
+00008070: 6964 646f 662c 206e 6964 2c20 646f 6629  iddof, nid, dof)
+00008080: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00008090: 2020 6a20 2b3d 2032 0a20 2020 2020 2020    j += 2.       
+000080a0: 2020 2020 2020 2020 2072 6f77 6964 7320           rowids 
+000080b0: 3d20 7265 635b 6a3a 3a73 7465 705d 0a20  = rec[j::step]. 
+000080c0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+000080d0: 6f77 646f 6673 203d 2072 6563 5b6a 202b  owdofs = rec[j +
+000080e0: 2031 203a 3a20 7374 6570 5d0a 2020 2020   1 :: step].    
+000080f0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00008100: 692c 2028 6e69 642c 2064 6f66 2920 696e  i, (nid, dof) in
+00008110: 2065 6e75 6d65 7261 7465 287a 6970 2872   enumerate(zip(r
+00008120: 6f77 6964 732c 2072 6f77 646f 6673 2929  owids, rowdofs))
+00008130: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00008140: 2020 2020 2020 6966 206e 6964 203d 3d20        if nid == 
+00008150: 2d31 3a0a 2020 2020 2020 2020 2020 2020  -1:.            
+00008160: 2020 2020 2020 2020 2020 2020 6a20 2b3d              j +=
+00008170: 2073 7465 7020 2a20 6920 2b20 320a 2020   step * i + 2.  
 00008180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008190: 2020 6164 645f 6964 646f 6628 726f 775f    add_iddof(row_
-000081a0: 6964 732c 2072 6f77 5f69 6464 6f66 2c20  ids, row_iddof, 
-000081b0: 6e69 642c 2064 6f66 290a 0a20 2020 2020  nid, dof)..     
-000081c0: 2020 2020 2020 2023 2063 7265 6174 6520         # create 
-000081d0: 6461 7461 6672 616d 653a 0a20 2020 2020  dataframe:.     
-000081e0: 2020 2020 2020 206d 6174 2c20 726f 7769         mat, rowi
-000081f0: 6e64 6578 2c20 636f 6c69 6e64 6578 203d  ndex, colindex =
-00008200: 205f 7072 6570 5f64 6174 6166 7261 6d65   _prep_dataframe
-00008210: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00008220: 2020 6d74 7970 652c 2066 6f72 6d2c 2072    mtype, form, r
-00008230: 6f77 5f69 6473 2c20 726f 775f 6964 646f  ow_ids, row_iddo
-00008240: 662c 2063 6f6c 5f69 6464 6f66 2c20 6e63  f, col_iddof, nc
-00008250: 6f6c 0a20 2020 2020 2020 2020 2020 2029  ol.            )
-00008260: 0a0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
-00008270: 7075 7420 6461 7461 2069 6e74 6f20 6461  put data into da
-00008280: 7461 6672 616d 653a 0a20 2020 2020 2020  taframe:.       
-00008290: 2020 2020 2023 2064 6620 3d20 6463 745b       # df = dct[
-000082a0: 6e61 6d65 5d0a 2020 2020 2020 2020 2020  name].          
-000082b0: 2020 725f 6964 5f64 6f66 203d 205f 6765    r_id_dof = _ge
-000082c0: 745f 3164 5f69 6e64 6578 2872 6f77 696e  t_1d_index(rowin
-000082d0: 6465 7829 0a20 2020 2020 2020 2020 2020  dex).           
-000082e0: 2069 6620 666f 726d 2021 3d20 393a 0a20   if form != 9:. 
-000082f0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00008300: 5f69 645f 646f 6620 3d20 5f67 6574 5f31  _id_dof = _get_1
-00008310: 645f 696e 6465 7828 636f 6c69 6e64 6578  d_index(colindex
-00008320: 290a 2020 2020 2020 2020 2020 2020 656c  ).            el
-00008330: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00008340: 2020 2020 635f 6964 5f64 6f66 203d 2063      c_id_dof = c
-00008350: 6f6c 696e 6465 780a 2020 2020 2020 2020  olindex.        
-00008360: 2020 2020 6a20 3d20 3132 0a20 2020 2020      j = 12.     
-00008370: 2020 2020 2020 2077 6869 6c65 206a 203c         while j <
-00008380: 206c 656e 2872 6563 2920 2d20 323a 0a20   len(rec) - 2:. 
-00008390: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-000083a0: 6964 2c20 646f 6620 3d20 7265 635b 6a20  id, dof = rec[j 
-000083b0: 3a20 6a20 2b20 325d 0a20 2020 2020 2020  : j + 2].       
-000083c0: 2020 2020 2020 2020 2069 6620 666f 726d           if form
-000083d0: 2021 3d20 393a 0a20 2020 2020 2020 2020   != 9:.         
-000083e0: 2020 2020 2020 2020 2020 206e 6964 203d             nid =
-000083f0: 206e 6964 202a 2031 3020 2b20 646f 660a   nid * 10 + dof.
-00008400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008410: 6369 203d 206e 702e 7365 6172 6368 736f  ci = np.searchso
-00008420: 7274 6564 2863 5f69 645f 646f 662c 206e  rted(c_id_dof, n
-00008430: 6964 290a 0a20 2020 2020 2020 2020 2020  id)..           
-00008440: 2020 2020 206a 202b 3d20 320a 2020 2020       j += 2.    
-00008450: 2020 2020 2020 2020 2020 2020 6e69 6420              nid 
-00008460: 3d20 7265 635b 6a5d 0a20 2020 2020 2020  = rec[j].       
-00008470: 2020 2020 2020 2020 2077 6869 6c65 206e           while n
-00008480: 6964 2021 3d20 2d31 3a0a 2020 2020 2020  id != -1:.      
-00008490: 2020 2020 2020 2020 2020 2020 2020 646f                do
-000084a0: 6620 3d20 7265 635b 6a20 2b20 315d 0a20  f = rec[j + 1]. 
-000084b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000084c0: 2020 206a 202b 3d20 320a 2020 2020 2020     j += 2.      
-000084d0: 2020 2020 2020 2020 2020 2020 2020 7661                va
-000084e0: 6c20 3d20 7265 635b 6a20 3a20 6a20 2b20  l = rec[j : j + 
-000084f0: 696e 7473 5f70 6572 5f6e 756d 6265 725d  ints_per_number]
-00008500: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00008510: 2020 2020 2076 616c 2e64 7479 7065 203d       val.dtype =
-00008520: 2064 7479 7065 0a20 2020 2020 2020 2020   dtype.         
-00008530: 2020 2020 2020 2020 2020 206a 202b 3d20             j += 
-00008540: 696e 7473 5f70 6572 5f6e 756d 6265 720a  ints_per_number.
-00008550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008560: 2020 2020 7269 203d 206e 702e 7365 6172      ri = np.sear
-00008570: 6368 736f 7274 6564 2872 5f69 645f 646f  chsorted(r_id_do
-00008580: 662c 206e 6964 202a 2031 3020 2b20 646f  f, nid * 10 + do
-00008590: 6629 0a20 2020 2020 2020 2020 2020 2020  f).             
-000085a0: 2020 2020 2020 206d 6174 5b72 692c 2063         mat[ri, c
-000085b0: 695d 203d 2076 616c 0a20 2020 2020 2020  i] = val.       
-000085c0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-000085d0: 666f 726d 203d 3d20 363a 0a20 2020 2020  form == 6:.     
-000085e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000085f0: 2020 206d 6174 5b63 692c 2072 695d 203d     mat[ci, ri] =
-00008600: 2076 616c 0a20 2020 2020 2020 2020 2020   val.           
-00008610: 2020 2020 2020 2020 206e 6964 203d 2072           nid = r
-00008620: 6563 5b6a 5d0a 2020 2020 2020 2020 2020  ec[j].          
-00008630: 2020 2020 2020 6a20 2b3d 2032 0a20 2020        j += 2.   
-00008640: 2020 2020 2020 2020 2064 6374 5b6e 616d           dct[nam
-00008650: 655d 203d 2070 642e 4461 7461 4672 616d  e] = pd.DataFram
-00008660: 6528 6d61 742c 2069 6e64 6578 3d72 6f77  e(mat, index=row
-00008670: 696e 6465 782c 2063 6f6c 756d 6e73 3d63  index, columns=c
-00008680: 6f6c 696e 6465 7829 0a20 2020 2020 2020  olindex).       
-00008690: 2072 6574 7572 6e20 6463 740a 0a20 2020   return dct..   
-000086a0: 2023 204d 4149 4e20 726f 7574 696e 650a   # MAIN routine.
-000086b0: 2020 2020 6966 2065 7870 616e 6465 643a      if expanded:
-000086c0: 0a20 2020 2020 2020 2061 6464 5f69 6464  .        add_idd
-000086d0: 6f66 203d 205f 6164 645f 6964 646f 665f  of = _add_iddof_
-000086e0: 6578 7061 6e64 6564 0a20 2020 2020 2020  expanded.       
-000086f0: 2069 6464 6f66 5f69 6e69 7469 616c 697a   iddof_initializ
-00008700: 6572 203d 206c 6973 740a 2020 2020 656c  er = list.    el
-00008710: 7365 3a0a 2020 2020 2020 2020 6164 645f  se:.        add_
-00008720: 6964 646f 6620 3d20 5f61 6464 5f69 6464  iddof = _add_idd
-00008730: 6f66 5f6d 696e 696d 616c 0a20 2020 2020  of_minimal.     
-00008740: 2020 2069 6464 6f66 5f69 6e69 7469 616c     iddof_initial
-00008750: 697a 6572 203d 2073 6574 0a0a 2020 2020  izer = set..    
-00008760: 6966 2064 6d69 675f 6e61 6d65 7320 6973  if dmig_names is
-00008770: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
-00008780: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-00008790: 2864 6d69 675f 6e61 6d65 732c 2073 7472  (dmig_names, str
-000087a0: 293a 0a20 2020 2020 2020 2020 2020 2064  ):.            d
-000087b0: 6d69 675f 6e61 6d65 7320 3d20 2864 6d69  mig_names = (dmi
-000087c0: 675f 6e61 6d65 732c 290a 2020 2020 2020  g_names,).      
-000087d0: 2020 646d 6967 5f6e 616d 6573 203d 205b    dmig_names = [
-000087e0: 692e 6c6f 7765 7228 2920 666f 7220 6920  i.lower() for i 
-000087f0: 696e 2064 6d69 675f 6e61 6d65 735d 0a0a  in dmig_names]..
-00008800: 2020 2020 6966 2066 2069 7320 6e6f 7420      if f is not 
-00008810: 4e6f 6e65 2061 6e64 206e 6f74 2069 7369  None and not isi
-00008820: 6e73 7461 6e63 6528 662c 2073 7472 293a  nstance(f, str):
-00008830: 0a20 2020 2020 2020 2023 2061 7373 756d  .        # assum
-00008840: 6520 6669 6c65 2068 616e 646c 652c 2061  e file handle, a
-00008850: 7373 756d 6520 7075 6e63 680a 2020 2020  ssume punch.    
-00008860: 2020 2020 6361 7264 7320 3d20 7264 6361      cards = rdca
-00008870: 7264 7328 662c 206e 616d 653d 2264 6d69  rds(f, name="dmi
-00008880: 6722 2c20 7265 7475 726e 5f76 6172 3d22  g", return_var="
-00008890: 6c69 7374 222c 2062 6c61 6e6b 3d22 2229  list", blank="")
-000088a0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-000088b0: 5f63 6172 6473 5f74 6f5f 6466 2863 6172  _cards_to_df(car
-000088c0: 6473 2c20 646d 6967 5f6e 616d 6573 290a  ds, dmig_names).
-000088d0: 0a20 2020 2023 2072 6561 6420 6f70 3220  .    # read op2 
-000088e0: 6f72 2070 756e 6368 202e 2e2e 2074 7279  or punch ... try
-000088f0: 206f 7032 2c20 6966 2074 6861 7420 6661   op2, if that fa
-00008900: 696c 732c 2061 7373 756d 6520 7075 6e63  ils, assume punc
-00008910: 683a 0a20 2020 2064 6d69 6766 696c 6520  h:.    dmigfile 
-00008920: 3d20 6775 6974 6f6f 6c73 2e67 6574 5f66  = guitools.get_f
-00008930: 696c 655f 6e61 6d65 2866 2c20 7265 6164  ile_name(f, read
-00008940: 3d54 7275 6529 0a20 2020 2074 7279 3a0a  =True).    try:.
-00008950: 2020 2020 2020 2020 6f32 203d 206f 7032          o2 = op2
-00008960: 2e4f 5032 2864 6d69 6766 696c 6529 0a20  .OP2(dmigfile). 
-00008970: 2020 2065 7863 6570 7420 5661 6c75 6545     except ValueE
-00008980: 7272 6f72 3a0a 2020 2020 2020 2020 6361  rror:.        ca
-00008990: 7264 7320 3d20 7264 6361 7264 7328 646d  rds = rdcards(dm
-000089a0: 6967 6669 6c65 2c20 6e61 6d65 3d22 646d  igfile, name="dm
-000089b0: 6967 222c 2072 6574 7572 6e5f 7661 723d  ig", return_var=
-000089c0: 226c 6973 7422 2c20 626c 616e 6b3d 2222  "list", blank=""
-000089d0: 290a 2020 2020 2020 2020 6463 7420 3d20  ).        dct = 
-000089e0: 5f63 6172 6473 5f74 6f5f 6466 2863 6172  _cards_to_df(car
-000089f0: 6473 2c20 646d 6967 5f6e 616d 6573 290a  ds, dmig_names).
-00008a00: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00008a10: 2020 6f32 6463 7420 3d20 5f72 6561 645f    o2dct = _read_
-00008a20: 6f70 325f 646d 6967 286f 322c 2064 6d69  op2_dmig(o2, dmi
-00008a30: 675f 6e61 6d65 7329 0a20 2020 2020 2020  g_names).       
-00008a40: 2064 656c 206f 320a 2020 2020 2020 2020   del o2.        
-00008a50: 6463 7420 3d20 5f72 6563 735f 746f 5f64  dct = _recs_to_d
-00008a60: 6628 6f32 6463 7429 0a20 2020 2072 6574  f(o2dct).    ret
-00008a70: 7572 6e20 6463 740a 0a0a 6465 6620 6d6b  urn dct...def mk
-00008a80: 636f 6d6d 656e 7428 636f 6d6d 656e 742c  comment(comment,
-00008a90: 2077 6964 7468 3d37 322c 2073 7461 7274   width=72, start
-00008aa0: 3d22 2420 222c 2073 7572 726f 756e 643d  ="$ ", surround=
-00008ab0: 5472 7565 293a 0a20 2020 2072 2222 220a  True):.    r""".
-00008ac0: 2020 2020 466f 726d 6174 7320 6120 7374      Formats a st
-00008ad0: 7269 6e67 2069 6e74 6f20 6120 4e61 7374  ring into a Nast
-00008ae0: 7261 6e20 636f 6d6d 656e 7420 7769 7468  ran comment with
-00008af0: 2077 7261 7070 696e 672e 0a0a 2020 2020   wrapping...    
-00008b00: 5061 7261 6d65 7465 7273 0a20 2020 202d  Parameters.    -
-00008b10: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 636f  ---------.    co
-00008b20: 6d6d 656e 7420 3a20 7374 7269 6e67 0a20  mment : string. 
-00008b30: 2020 2020 2020 2054 6865 2073 7472 696e         The strin
-00008b40: 6720 746f 2077 7269 7465 206f 7574 2c20  g to write out, 
-00008b50: 7772 6170 7069 6e67 2074 6f20 6077 6964  wrapping to `wid
-00008b60: 7468 6020 6368 6172 6163 7465 7273 2e0a  th` characters..
-00008b70: 2020 2020 7769 6474 6820 3a20 696e 7465      width : inte
-00008b80: 6765 723b 206f 7074 696f 6e61 6c0a 2020  ger; optional.  
-00008b90: 2020 2020 2020 5370 6563 6966 7920 6d61        Specify ma
-00008ba0: 7869 6d75 6d20 6c69 6e65 206c 656e 6774  ximum line lengt
-00008bb0: 682e 0a20 2020 2073 7461 7274 203a 2073  h..    start : s
-00008bc0: 7472 696e 673b 206f 7074 696f 6e61 6c0a  tring; optional.
-00008bd0: 2020 2020 2020 2020 5374 7269 6e67 2028          String (
-00008be0: 692e 652e 2022 2420 222c 2022 2320 2229  i.e. "$ ", "# ")
-00008bf0: 2074 6f20 7374 6172 7420 6561 6368 2063   to start each c
-00008c00: 6f6d 6d65 6e74 206c 696e 6520 7769 7468  omment line with
-00008c10: 2e0a 2020 2020 7375 7272 6f75 6e64 203a  ..    surround :
-00008c20: 2062 6f6f 6c3b 206f 7074 696f 6e61 6c0a   bool; optional.
-00008c30: 2020 2020 2020 2020 4966 2054 7275 652c          If True,
-00008c40: 2061 206c 6561 6469 6e67 2061 6e64 2074   a leading and t
-00008c50: 7261 696c 696e 6720 626c 616e 6b20 636f  railing blank co
-00008c60: 6d6d 656e 7420 6c69 6e65 2077 696c 6c20  mment line will 
-00008c70: 6265 0a20 2020 2020 2020 2069 6e63 6c75  be.        inclu
-00008c80: 6465 642e 0a0a 2020 2020 5265 7475 726e  ded...    Return
-00008c90: 730a 2020 2020 2d2d 2d2d 2d2d 2d0a 2020  s.    -------.  
-00008ca0: 2020 7374 7269 6e67 0a20 2020 2020 2020    string.       
-00008cb0: 2054 6865 2066 6f72 6d61 7474 6564 2063   The formatted c
-00008cc0: 6f6d 6d65 6e74 2e0a 0a20 2020 204e 6f74  omment...    Not
-00008cd0: 6573 0a20 2020 202d 2d2d 2d2d 0a20 2020  es.    -----.   
-00008ce0: 2055 7365 7320 7468 6520 5079 7468 6f6e   Uses the Python
-00008cf0: 2066 756e 6374 696f 6e20 3a66 756e 633a   function :func:
-00008d00: 6074 6578 7477 7261 702e 6669 6c6c 6020  `textwrap.fill` 
-00008d10: 746f 2066 6f72 6d61 7420 7468 650a 2020  to format the.  
-00008d20: 2020 7374 7269 6e67 2e0a 0a20 2020 2045    string...    E
-00008d30: 7861 6d70 6c65 730a 2020 2020 2d2d 2d2d  xamples.    ----
-00008d40: 2d2d 2d2d 0a20 2020 203e 3e3e 2066 726f  ----.    >>> fro
-00008d50: 6d20 7079 7965 7469 2069 6d70 6f72 7420  m pyyeti import 
-00008d60: 6e61 7374 7261 6e0a 2020 2020 3e3e 3e20  nastran.    >>> 
-00008d70: 7320 3d20 2827 5468 6973 2069 7320 6120  s = ('This is a 
-00008d80: 6c6f 6e67 2063 6f6d 6d65 6e74 2073 7472  long comment str
-00008d90: 696e 6720 746f 2027 0a20 2020 202e 2e2e  ing to '.    ...
-00008da0: 2020 2020 2020 2764 656d 6f6e 7374 7261        'demonstra
-00008db0: 7465 2074 6865 2077 7261 7070 696e 6720  te the wrapping 
-00008dc0: 6665 6174 7572 6520 6f66 2027 0a20 2020  feature of '.   
-00008dd0: 202e 2e2e 2020 2020 2020 2774 6869 7320   ...      'this 
-00008de0: 616c 676f 7269 7468 6d2e 2049 7420 7772  algorithm. It wr
-00008df0: 6170 7320 746f 2037 3220 270a 2020 2020  aps to 72 '.    
-00008e00: 2e2e 2e20 2020 2020 2027 6368 6172 6163  ...      'charac
-00008e10: 7465 7273 2062 7920 6465 6661 756c 742c  ters by default,
-00008e20: 2062 7574 2074 6861 7420 6361 6e20 270a   but that can '.
-00008e30: 2020 2020 2e2e 2e20 2020 2020 2027 6368      ...      'ch
-00008e40: 616e 6765 6420 6279 2074 6865 2075 7365  anged by the use
-00008e50: 7220 7669 6120 7468 6520 6077 6964 7468  r via the `width
-00008e60: 6020 270a 2020 2020 2e2e 2e20 2020 2020  ` '.    ...     
-00008e70: 2027 6f70 7469 6f6e 2e20 5468 6520 6465   'option. The de
-00008e80: 6661 756c 7420 7374 6172 7420 666f 7220  fault start for 
-00008e90: 6561 6368 2027 0a20 2020 202e 2e2e 2020  each '.    ...  
-00008ea0: 2020 2020 276c 696e 6520 6973 2022 2420      'line is "$ 
-00008eb0: 222c 2062 7574 2074 6861 7420 6361 6e20  ", but that can 
-00008ec0: 6265 2063 6861 6e67 6564 2027 0a20 2020  be changed '.   
-00008ed0: 202e 2e2e 2020 2020 2020 2761 7320 7765   ...      'as we
-00008ee0: 6c6c 2e27 290a 2020 2020 3e3e 3e20 7072  ll.').    >>> pr
-00008ef0: 696e 7428 6e61 7374 7261 6e2e 6d6b 636f  int(nastran.mkco
-00008f00: 6d6d 656e 7428 732c 2077 6964 7468 3d35  mment(s, width=5
-00008f10: 3529 2c20 656e 643d 2727 290a 2020 2020  5), end='').    
-00008f20: 240a 2020 2020 2420 5468 6973 2069 7320  $.    $ This is 
-00008f30: 6120 6c6f 6e67 2063 6f6d 6d65 6e74 2073  a long comment s
-00008f40: 7472 696e 6720 746f 2064 656d 6f6e 7374  tring to demonst
-00008f50: 7261 7465 2074 6865 0a20 2020 2024 2077  rate the.    $ w
-00008f60: 7261 7070 696e 6720 6665 6174 7572 6520  rapping feature 
-00008f70: 6f66 2074 6869 7320 616c 676f 7269 7468  of this algorith
-00008f80: 6d2e 2049 7420 7772 6170 7320 746f 2037  m. It wraps to 7
-00008f90: 320a 2020 2020 2420 6368 6172 6163 7465  2.    $ characte
-00008fa0: 7273 2062 7920 6465 6661 756c 742c 2062  rs by default, b
-00008fb0: 7574 2074 6861 7420 6361 6e20 6368 616e  ut that can chan
-00008fc0: 6765 6420 6279 2074 6865 0a20 2020 2024  ged by the.    $
-00008fd0: 2075 7365 7220 7669 6120 7468 6520 6077   user via the `w
-00008fe0: 6964 7468 6020 6f70 7469 6f6e 2e20 5468  idth` option. Th
-00008ff0: 6520 6465 6661 756c 7420 7374 6172 7420  e default start 
-00009000: 666f 720a 2020 2020 2420 6561 6368 206c  for.    $ each l
-00009010: 696e 6520 6973 2022 2420 222c 2062 7574  ine is "$ ", but
-00009020: 2074 6861 7420 6361 6e20 6265 2063 6861   that can be cha
-00009030: 6e67 6564 2061 7320 7765 6c6c 2e0a 2020  nged as well..  
-00009040: 2020 240a 2020 2020 2222 220a 2020 2020    $.    """.    
-00009050: 7320 3d20 280a 2020 2020 2020 2020 7465  s = (.        te
-00009060: 7874 7772 6170 2e66 696c 6c28 0a20 2020  xtwrap.fill(.   
-00009070: 2020 2020 2020 2020 2063 6f6d 6d65 6e74           comment
-00009080: 2c20 7769 6474 683d 7769 6474 682c 2069  , width=width, i
-00009090: 6e69 7469 616c 5f69 6e64 656e 743d 7374  nitial_indent=st
-000090a0: 6172 742c 2073 7562 7365 7175 656e 745f  art, subsequent_
-000090b0: 696e 6465 6e74 3d73 7461 7274 0a20 2020  indent=start.   
-000090c0: 2020 2020 2029 0a20 2020 2020 2020 202b       ).        +
-000090d0: 2022 5c6e 220a 2020 2020 290a 2020 2020   "\n".    ).    
-000090e0: 6966 2073 7572 726f 756e 643a 0a20 2020  if surround:.   
-000090f0: 2020 2020 2073 203d 2022 245c 6e22 202b       s = "$\n" +
-00009100: 2073 202b 2022 245c 6e22 0a20 2020 2072   s + "$\n".    r
-00009110: 6574 7572 6e20 730a 0a0a 4067 7569 746f  eturn s...@guito
-00009120: 6f6c 732e 7772 6974 655f 7465 7874 5f66  ols.write_text_f
-00009130: 696c 650a 6465 6620 7774 646d 6967 2866  ile.def wtdmig(f
-00009140: 2c20 6463 7429 3a0a 2020 2020 2222 220a  , dct):.    """.
-00009150: 2020 2020 5772 6974 6573 204e 6173 7472      Writes Nastr
-00009160: 616e 2044 4d49 4720 6361 7264 7320 746f  an DMIG cards to
-00009170: 2061 2066 696c 652e 0a0a 2020 2020 5061   a file...    Pa
-00009180: 7261 6d65 7465 7273 0a20 2020 202d 2d2d  rameters.    ---
-00009190: 2d2d 2d2d 2d2d 2d0a 2020 2020 6620 3a20  -------.    f : 
-000091a0: 7374 7269 6e67 206f 7220 6669 6c65 5f6c  string or file_l
-000091b0: 696b 6520 6f72 2031 206f 7220 4e6f 6e65  ike or 1 or None
-000091c0: 0a20 2020 2020 2020 2045 6974 6865 7220  .        Either 
-000091d0: 6120 6e61 6d65 206f 6620 6120 6669 6c65  a name of a file
-000091e0: 2c20 6f72 2069 7320 6120 6669 6c65 5f6c  , or is a file_l
-000091f0: 696b 6520 6f62 6a65 6374 2061 7320 7265  ike object as re
-00009200: 7475 726e 6564 0a20 2020 2020 2020 2062  turned.        b
-00009210: 7920 3a66 756e 633a 606f 7065 6e60 206f  y :func:`open` o
-00009220: 7220 3a63 6c61 7373 3a60 696f 2e53 7472  r :class:`io.Str
-00009230: 696e 6749 4f60 2e20 496e 7075 7420 6173  ingIO`. Input as
-00009240: 2069 6e74 6567 6572 2031 2074 6f0a 2020   integer 1 to.  
-00009250: 2020 2020 2020 7772 6974 6520 746f 2073        write to s
-00009260: 7464 6f75 742e 2043 616e 2061 6c73 6f20  tdout. Can also 
-00009270: 6265 2074 6865 206e 616d 6520 6f66 2061  be the name of a
-00009280: 2064 6972 6563 746f 7279 206f 7220 4e6f   directory or No
-00009290: 6e65 3b0a 2020 2020 2020 2020 696e 2074  ne;.        in t
-000092a0: 6865 7365 2063 6173 6573 2c20 6120 4755  hese cases, a GU
-000092b0: 4920 6973 206f 7065 6e65 6420 666f 7220  I is opened for 
-000092c0: 6669 6c65 2073 656c 6563 7469 6f6e 2e0a  file selection..
-000092d0: 2020 2020 6463 7420 3a20 6469 6374 696f      dct : dictio
-000092e0: 6e61 7279 0a20 2020 2020 2020 2044 6963  nary.        Dic
-000092f0: 7469 6f6e 6172 7920 6f66 2070 616e 6461  tionary of panda
-00009300: 7320 4461 7461 4672 616d 6573 2e20 5468  s DataFrames. Th
-00009310: 6520 6b65 7973 2077 696c 6c20 6265 2075  e keys will be u
-00009320: 7365 6420 6173 2074 6865 0a20 2020 2020  sed as the.     
-00009330: 2020 206e 616d 6573 206f 6620 7468 6520     names of the 
-00009340: 444d 4947 2065 6e74 7269 6573 2e20 5769  DMIG entries. Wi
-00009350: 7468 206f 6e65 2065 7863 6570 7469 6f6e  th one exception
-00009360: 2c20 7468 6520 636f 6c75 6d6e 2061 6e64  , the column and
-00009370: 0a20 2020 2020 2020 2072 6f77 2069 6e64  .        row ind
-00009380: 6963 6573 206f 6620 6561 6368 2044 6174  ices of each Dat
-00009390: 6146 7261 6d65 2061 7265 2070 616e 6461  aFrame are panda
-000093a0: 7320 4d75 6c74 6949 6e64 6578 206f 626a  s MultiIndex obj
-000093b0: 6563 7473 0a20 2020 2020 2020 2077 6974  ects.        wit
-000093c0: 6820 6e6f 6465 2049 4420 696e 206c 6576  h node ID in lev
-000093d0: 656c 2030 2061 6e64 2044 4f46 2069 6e20  el 0 and DOF in 
-000093e0: 6c65 7665 6c20 3120 2874 6865 206e 616d  level 1 (the nam
-000093f0: 6573 2061 7265 2022 6964 220a 2020 2020  es are "id".    
-00009400: 2020 2020 616e 6420 2264 6f66 2229 2e20      and "dof"). 
-00009410: 5468 6520 6578 6365 7074 696f 6e20 6973  The exception is
-00009420: 2066 6f72 2066 6f72 6d20 2239 2220 6d61   for form "9" ma
-00009430: 7472 6963 6573 3a20 7468 6520 636f 6c75  trices: the colu
-00009440: 6d6e 0a20 2020 2020 2020 2069 6e64 6578  mn.        index
-00009450: 2069 6e20 7468 6174 2063 6173 6520 6973   in that case is
-00009460: 206a 7573 7420 7468 6520 636f 6c75 6d6e   just the column
-00009470: 206e 756d 6265 7220 2873 7461 7274 696e   number (startin
-00009480: 6720 6174 206f 6e65 0a20 2020 2020 2020  g at one.       
-00009490: 2066 6f72 204e 6173 7472 616e 292e 2055   for Nastran). U
-000094a0: 7365 2061 6e20 4f72 6465 7265 6444 6963  se an OrderedDic
-000094b0: 7420 6672 6f6d 2074 6865 2073 7461 6e64  t from the stand
-000094c0: 6172 6420 5079 7468 6f6e 0a20 2020 2020  ard Python.     
-000094d0: 2020 2022 636f 6c6c 6563 7469 6f6e 7322     "collections"
-000094e0: 206d 6f64 756c 6520 746f 2077 7269 7465   module to write
-000094f0: 2074 6865 2065 6e74 7269 6573 2069 6e20   the entries in 
-00009500: 6120 7370 6563 6966 6963 206f 7264 6572  a specific order
-00009510: 2e0a 0a20 2020 2052 6574 7572 6e73 0a20  ...    Returns. 
-00009520: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 204e     -------.    N
-00009530: 6f6e 650a 0a20 2020 204e 6f74 6573 0a20  one..    Notes. 
-00009540: 2020 202d 2d2d 2d2d 0a20 2020 2049 6620     -----.    If 
-00009550: 6120 4461 7461 4672 616d 6520 6861 7320  a DataFrame has 
-00009560: 6120 7369 6e67 6c65 206c 6576 656c 2027  a single level '
-00009570: 636f 6c75 6d6e 7327 2061 7474 7269 6275  columns' attribu
-00009580: 7465 2c20 7468 6520 666f 726d 0a20 2020  te, the form.   
-00009590: 2066 6f72 2074 6861 7420 6d61 7472 6978   for that matrix
-000095a0: 2069 7320 392e 2049 6e20 7468 6174 2063   is 9. In that c
-000095b0: 6173 652c 2074 6865 2027 4e43 4f4c 2720  ase, the 'NCOL' 
-000095c0: 444d 4947 2068 6561 6465 7220 6361 7264  DMIG header card
-000095d0: 0a20 2020 2076 616c 7565 2069 7320 6465  .    value is de
-000095e0: 7465 726d 696e 6564 2062 7920 6d61 7869  termined by maxi
-000095f0: 6d75 6d20 7661 6c75 6520 696e 2074 6865  mum value in the
-00009600: 2027 636f 6c75 6d6e 7327 2061 7474 7269   'columns' attri
-00009610: 6275 7465 2e0a 0a20 2020 204f 7468 6572  bute...    Other
-00009620: 7769 7365 2c20 6966 2061 2044 6174 6146  wise, if a DataF
-00009630: 7261 6d65 2068 6173 2061 2032 2d6c 6576  rame has a 2-lev
-00009640: 656c 2027 636f 6c75 6d6e 7327 2061 7474  el 'columns' att
-00009650: 7269 6275 7465 2c20 7468 650a 2020 2020  ribute, the.    
-00009660: 666f 726d 2069 7320 6465 7465 726d 696e  form is determin
-00009670: 6564 2062 7920 6368 6563 6b69 6e67 2074  ed by checking t
-00009680: 6865 206d 6174 7269 7820 7368 6170 6520  he matrix shape 
-00009690: 616e 642c 2069 6620 7371 7561 7265 2c0a  and, if square,.
-000096a0: 2020 2020 7768 6574 6865 7220 7468 6520      whether the 
-000096b0: 6d61 7472 6978 2069 7320 7379 6d6d 6574  matrix is symmet
-000096c0: 7269 6320 6f72 206e 6f74 2e20 274e 434f  ric or not. 'NCO
-000096d0: 4c27 2069 7320 7365 7420 746f 2074 6865  L' is set to the
-000096e0: 0a20 2020 206e 756d 6265 7220 6f66 2063  .    number of c
-000096f0: 6f6c 756d 6e73 2069 6e20 7468 6520 6d61  olumns in the ma
-00009700: 7472 6978 2028 6275 7420 6973 2069 676e  trix (but is ign
-00009710: 6f72 6564 2062 7920 4e61 7374 7261 6e29  ored by Nastran)
-00009720: 2e0a 0a20 2020 2054 6865 2074 7970 6520  ...    The type 
-00009730: 6973 2064 6574 6572 6d69 6e65 6420 6279  is determined by
-00009740: 2074 6865 206e 756d 7079 2027 6474 7970   the numpy 'dtyp
-00009750: 6527 2061 7474 7269 6275 7465 2e0a 0a20  e' attribute... 
-00009760: 2020 2043 7572 7265 6e74 6c79 2c20 626f     Currently, bo
-00009770: 7468 2027 504f 4c41 5227 2061 6e64 2027  th 'POLAR' and '
-00009780: 544f 5554 2720 6865 6164 6572 2063 6172  TOUT' header car
-00009790: 6420 7661 6c75 6573 2061 7265 2073 6574  d values are set
-000097a0: 2074 6f0a 2020 2020 302e 2054 6861 7420   to.    0. That 
-000097b0: 6d65 616e 7320 7468 6174 2063 6f6d 706c  means that compl
-000097c0: 6578 206e 756d 6265 7273 2061 7265 2077  ex numbers are w
-000097d0: 7269 7474 656e 2069 6e20 7265 616c 2f69  ritten in real/i
-000097e0: 6d61 6769 6e61 7279 0a20 2020 2070 6172  maginary.    par
-000097f0: 7473 2061 6e64 2074 6865 2072 6573 756c  ts and the resul
-00009800: 7469 6e67 2070 7265 6369 7369 6f6e 2069  ting precision i
-00009810: 6e20 4e61 7374 7261 6e20 6973 2061 7574  n Nastran is aut
-00009820: 6f6d 6174 6963 616c 6c79 0a20 2020 2073  omatically.    s
-00009830: 6574 2e0a 0a20 2020 2052 6169 7365 730a  et...    Raises.
-00009840: 2020 2020 2d2d 2d2d 2d2d 0a20 2020 2056      ------.    V
-00009850: 616c 7565 4572 726f 720a 2020 2020 2020  alueError.      
-00009860: 2020 5768 656e 2061 2044 6174 6146 7261    When a DataFra
-00009870: 6d65 2072 6f77 2069 6e64 6578 2069 7320  me row index is 
-00009880: 6e6f 7420 3220 6c65 7665 6c73 2c20 6f72  not 2 levels, or
-00009890: 2077 6865 6e20 6120 636f 6c75 6d6e 0a20   when a column. 
-000098a0: 2020 2020 2020 2069 6e64 6578 2069 7320         index is 
-000098b0: 6e6f 7420 3120 6f72 2032 206c 6576 656c  not 1 or 2 level
-000098c0: 732e 0a0a 2020 2020 4578 616d 706c 6573  s...    Examples
-000098d0: 0a20 2020 202d 2d2d 2d2d 2d2d 2d0a 2020  .    --------.  
-000098e0: 2020 4372 6561 7465 2061 2073 796d 6d65    Create a symme
-000098f0: 7472 6963 206d 6174 7269 7820 616e 6420  tric matrix and 
-00009900: 7772 6974 6520 444d 4947 2074 6f20 7363  write DMIG to sc
-00009910: 7265 656e 3a0a 0a20 2020 203e 3e3e 2069  reen:..    >>> i
-00009920: 6d70 6f72 7420 6e75 6d70 7920 6173 206e  mport numpy as n
-00009930: 700a 2020 2020 3e3e 3e20 696d 706f 7274  p.    >>> import
-00009940: 2070 616e 6461 7320 6173 2070 640a 2020   pandas as pd.  
-00009950: 2020 3e3e 3e20 6672 6f6d 2070 7979 6574    >>> from pyyet
-00009960: 6920 696d 706f 7274 206e 6173 7472 616e  i import nastran
-00009970: 0a20 2020 203e 3e3e 2061 203d 206e 702e  .    >>> a = np.
-00009980: 6172 7261 7928 5b5b 332e 352c 202d 312e  array([[3.5, -1.
-00009990: 322c 202d 322e 345d 2c0a 2020 2020 2e2e  2, -2.4],.    ..
-000099a0: 2e20 2020 2020 2020 2020 2020 2020 2020  .               
-000099b0: 5b2d 312e 322c 2038 2e38 2c20 362e 355d  [-1.2, 8.8, 6.5]
-000099c0: 2c0a 2020 2020 2e2e 2e20 2020 2020 2020  ,.    ...       
-000099d0: 2020 2020 2020 2020 5b2d 322e 342c 2036          [-2.4, 6
-000099e0: 2e35 2c20 392e 395d 5d29 0a20 2020 203e  .5, 9.9]]).    >
-000099f0: 3e3e 2069 6e64 203d 2070 642e 4d75 6c74  >> ind = pd.Mult
-00009a00: 6949 6e64 6578 2e66 726f 6d5f 7072 6f64  iIndex.from_prod
-00009a10: 7563 7428 5b5b 3130 305d 2c20 5b31 2c20  uct([[100], [1, 
-00009a20: 322c 2036 5d5d 290a 2020 2020 3e3e 3e20  2, 6]]).    >>> 
-00009a30: 6b20 3d20 7064 2e44 6174 6146 7261 6d65  k = pd.DataFrame
-00009a40: 2861 2c20 696e 6465 783d 696e 642c 2063  (a, index=ind, c
-00009a50: 6f6c 756d 6e73 3d69 6e64 290a 2020 2020  olumns=ind).    
-00009a60: 3e3e 3e20 6b20 2020 2020 2020 2020 2020  >>> k           
-00009a70: 2020 2023 2064 6f63 7465 7374 3a20 2b45     # doctest: +E
-00009a80: 4c4c 4950 5349 530a 2020 2020 2020 2020  LLIPSIS.        
-00009a90: 2020 2031 3030 2e2e 2e0a 2020 2020 2020     100....      
-00009aa0: 2020 2020 2020 2031 2020 2020 3220 2020         1    2   
-00009ab0: 2036 0a20 2020 2031 3030 2031 2020 332e   6.    100 1  3.
-00009ac0: 3520 2d31 2e32 202d 322e 340a 2020 2020  5 -1.2 -2.4.    
-00009ad0: 2020 2020 3220 2d31 2e32 2020 382e 3820      2 -1.2  8.8 
-00009ae0: 2036 2e35 0a20 2020 2020 2020 2036 202d   6.5.        6 -
-00009af0: 322e 3420 2036 2e35 2020 392e 390a 2020  2.4  6.5  9.9.  
-00009b00: 2020 3e3e 3e20 6e61 7374 7261 6e2e 7774    >>> nastran.wt
-00009b10: 646d 6967 2831 2c20 7b27 6b27 3a20 6b7d  dmig(1, {'k': k}
-00009b20: 290a 2020 2020 444d 4947 2020 2020 4b20  ).    DMIG    K 
-00009b30: 2020 2020 2020 2020 2020 2020 2030 2020               0  
-00009b40: 2020 2020 2036 2020 2020 2020 2032 2020       6       2  
-00009b50: 2020 2020 2030 2020 2020 2020 2030 2020       0       0  
-00009b60: 2020 2020 2020 2020 2020 2020 2033 0a20               3. 
-00009b70: 2020 2044 4d49 472a 2020 204b 2020 2020     DMIG*   K    
-00009b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009b90: 2020 2020 2020 2020 3130 3020 2020 2020          100     
-00009ba0: 2020 2020 2020 2020 2020 310a 2020 2020            1.    
-00009bb0: 2a20 2020 2020 2020 2020 2020 2020 2020  *               
-00009bc0: 2020 2020 2031 3030 2020 2020 2020 2020       100        
-00009bd0: 2020 2020 2020 2031 2033 2e35 3030 3030         1 3.50000
-00009be0: 3030 3030 442b 3030 0a20 2020 202a 2020  0000D+00.    *  
-00009bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009c00: 2020 3130 3020 2020 2020 2020 2020 2020    100           
-00009c10: 2020 2020 322d 312e 3230 3030 3030 3030      2-1.20000000
-00009c20: 3044 2b30 300a 2020 2020 2a20 2020 2020  0D+00.    *     
-00009c30: 2020 2020 2020 2020 2020 2020 2020 2031                 1
-00009c40: 3030 2020 2020 2020 2020 2020 2020 2020  00              
-00009c50: 2036 2d32 2e34 3030 3030 3030 3030 442b   6-2.400000000D+
-00009c60: 3030 0a20 2020 2044 4d49 472a 2020 204b  00.    DMIG*   K
-00009c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009c80: 2020 2020 2020 2020 2020 2020 3130 3020              100 
-00009c90: 2020 2020 2020 2020 2020 2020 2020 320a                2.
-00009ca0: 2020 2020 2a20 2020 2020 2020 2020 2020      *           
-00009cb0: 2020 2020 2020 2020 2031 3030 2020 2020           100    
-00009cc0: 2020 2020 2020 2020 2020 2032 2038 2e38             2 8.8
-00009cd0: 3030 3030 3030 3030 442b 3030 0a20 2020  00000000D+00.   
-00009ce0: 202a 2020 2020 2020 2020 2020 2020 2020   *              
-00009cf0: 2020 2020 2020 3130 3020 2020 2020 2020        100       
-00009d00: 2020 2020 2020 2020 3620 362e 3530 3030          6 6.5000
-00009d10: 3030 3030 3044 2b30 300a 2020 2020 444d  00000D+00.    DM
-00009d20: 4947 2a20 2020 4b20 2020 2020 2020 2020  IG*   K         
-00009d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009d40: 2020 2031 3030 2020 2020 2020 2020 2020     100          
-00009d50: 2020 2020 2036 0a20 2020 202a 2020 2020       6.    *    
-00009d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009d70: 3130 3020 2020 2020 2020 2020 2020 2020  100             
-00009d80: 2020 3620 392e 3930 3030 3030 3030 3044    6 9.900000000D
-00009d90: 2b30 300a 0a20 2020 2041 7320 616e 6f74  +00..    As anot
-00009da0: 6865 7220 6465 6d6f 2c20 7772 6974 6520  her demo, write 
-00009db0: 746f 2061 2073 7472 696e 6720 616e 6420  to a string and 
-00009dc0: 7573 6520 3a66 756e 633a 6072 6464 6d69  use :func:`rddmi
-00009dd0: 6760 2074 6f20 7265 6164 0a20 2020 2062  g` to read.    b
-00009de0: 6163 6b20 696e 3a0a 0a20 2020 203e 3e3e  ack in:..    >>>
-00009df0: 2069 6d70 6f72 7420 696f 0a20 2020 203e   import io.    >
-00009e00: 3e3e 2077 6974 6820 696f 2e53 7472 696e  >> with io.Strin
-00009e10: 6749 4f28 2920 6173 2073 696f 3a0a 2020  gIO() as sio:.  
-00009e20: 2020 2e2e 2e20 2020 2020 6e61 7374 7261    ...     nastra
-00009e30: 6e2e 7774 646d 6967 2873 696f 2c20 7b27  n.wtdmig(sio, {'
-00009e40: 6b27 3a20 6b7d 290a 2020 2020 2e2e 2e20  k': k}).    ... 
-00009e50: 2020 2020 6b32 203d 206e 6173 7472 616e      k2 = nastran
-00009e60: 2e72 6464 6d69 6728 7369 6f29 5b27 6b27  .rddmig(sio)['k'
-00009e70: 5d0a 2020 2020 3e3e 3e20 6b32 2020 2020  ].    >>> k2    
-00009e80: 2020 2020 2020 2020 2020 2320 646f 6374            # doct
-00009e90: 6573 743a 202b 454c 4c49 5053 4953 0a20  est: +ELLIPSIS. 
-00009ea0: 2020 2069 6420 2020 2020 2020 3130 302e     id       100.
-00009eb0: 2e2e 0a20 2020 2064 6f66 2020 2020 2020  ...    dof      
-00009ec0: 2020 3120 2020 2032 2020 2020 360a 2020    1    2    6.  
-00009ed0: 2020 6964 2020 646f 662e 2e2e 0a20 2020    id  dof....   
-00009ee0: 2031 3030 2031 2020 2020 332e 3520 2d31   100 1    3.5 -1
-00009ef0: 2e32 202d 322e 340a 2020 2020 2020 2020  .2 -2.4.        
-00009f00: 3220 2020 2d31 2e32 2020 382e 3820 2036  2   -1.2  8.8  6
-00009f10: 2e35 0a20 2020 2020 2020 2036 2020 202d  .5.        6   -
-00009f20: 322e 3420 2036 2e35 2020 392e 390a 2020  2.4  6.5  9.9.  
-00009f30: 2020 3e3e 3e20 6e70 2e61 6c6c 2828 6b32    >>> np.all((k2
-00009f40: 203d 3d20 6b29 2e76 616c 7565 7329 0a20   == k).values). 
-00009f50: 2020 2054 7275 650a 2020 2020 2222 220a     True.    """.
-00009f60: 2020 2020 666f 7220 6e61 6d65 2c20 7661      for name, va
-00009f70: 6c75 6520 696e 2064 6374 2e69 7465 6d73  lue in dct.items
-00009f80: 2829 3a0a 2020 2020 2020 2020 6e61 6d65  ():.        name
-00009f90: 203d 206e 616d 652e 7570 7065 7228 290a   = name.upper().
-00009fa0: 2020 2020 2020 2020 726f 7769 6473 203d          rowids =
-00009fb0: 2076 616c 7565 2e69 6e64 6578 0a20 2020   value.index.   
-00009fc0: 2020 2020 2063 6f6c 6964 7320 3d20 7661       colids = va
-00009fd0: 6c75 652e 636f 6c75 6d6e 730a 2020 2020  lue.columns.    
-00009fe0: 2020 2020 2320 726f 7720 696e 6465 7820      # row index 
-00009ff0: 6d75 7374 2062 6520 322d 6c65 7665 6c20  must be 2-level 
-0000a000: 4d75 6c74 6949 6e64 6578 3a0a 2020 2020  MultiIndex:.    
-0000a010: 2020 2020 6966 2072 6f77 6964 732e 6e6c      if rowids.nl
-0000a020: 6576 656c 7320 213d 2032 3a0a 2020 2020  evels != 2:.    
-0000a030: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-0000a040: 6c75 6545 7272 6f72 280a 2020 2020 2020  lueError(.      
-0000a050: 2020 2020 2020 2020 2020 6627 227b 6e61            f'"{na
-0000a060: 6d65 7d22 206d 7573 7420 6861 7665 2061  me}" must have a
-0000a070: 2032 2d6c 6576 656c 2072 6f77 2069 6e64   2-level row ind
-0000a080: 6578 2062 7574 2068 6173 2027 0a20 2020  ex but has '.   
-0000a090: 2020 2020 2020 2020 2020 2020 2066 227b               f"{
-0000a0a0: 726f 7769 6473 2e6e 6c65 7665 6c73 7d20  rowids.nlevels} 
-0000a0b0: 6c65 7665 6c73 220a 2020 2020 2020 2020  levels".        
-0000a0c0: 2020 2020 290a 0a20 2020 2020 2020 2069      )..        i
-0000a0d0: 6620 636f 6c69 6473 2e6e 6c65 7665 6c73  f colids.nlevels
-0000a0e0: 203e 2032 3a0a 2020 2020 2020 2020 2020   > 2:.          
-0000a0f0: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-0000a100: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
-0000a110: 2020 2020 6627 227b 6e61 6d65 7d22 206d      f'"{name}" m
-0000a120: 7573 7420 6861 7665 2061 2031 206f 7220  ust have a 1 or 
-0000a130: 322d 6c65 7665 6c20 636f 6c75 6d6e 2069  2-level column i
-0000a140: 6e64 6578 2062 7574 2068 6173 2027 0a20  ndex but has '. 
-0000a150: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0000a160: 227b 636f 6c69 6473 2e6e 6c65 7665 6c73  "{colids.nlevels
-0000a170: 7d20 6c65 7665 6c73 220a 2020 2020 2020  } levels".      
-0000a180: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-0000a190: 206d 203d 2076 616c 7565 2e76 616c 7565   m = value.value
-0000a1a0: 730a 2020 2020 2020 2020 6e63 6f6c 203d  s.        ncol =
-0000a1b0: 2076 616c 7565 2e73 6861 7065 5b31 5d0a   value.shape[1].
-0000a1c0: 0a20 2020 2020 2020 2023 2064 6574 6572  .        # deter
-0000a1d0: 6d69 6e65 2066 6f72 6d20 6f66 206d 6174  mine form of mat
-0000a1e0: 7269 783a 0a20 2020 2020 2020 2069 6620  rix:.        if 
-0000a1f0: 636f 6c69 6473 2e6e 6c65 7665 6c73 203d  colids.nlevels =
-0000a200: 3d20 313a 0a20 2020 2020 2020 2020 2020  = 1:.           
-0000a210: 2066 6f72 6d20 3d20 390a 2020 2020 2020   form = 9.      
-0000a220: 2020 2020 2020 6e63 6f6c 203d 2063 6f6c        ncol = col
-0000a230: 6964 732e 6d61 7828 290a 2020 2020 2020  ids.max().      
-0000a240: 2020 656c 6966 2076 616c 7565 2e73 6861    elif value.sha
-0000a250: 7065 5b30 5d20 213d 2076 616c 7565 2e73  pe[0] != value.s
-0000a260: 6861 7065 5b31 5d3a 0a20 2020 2020 2020  hape[1]:.       
-0000a270: 2020 2020 2066 6f72 6d20 3d20 320a 2020       form = 2.  
-0000a280: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-0000a290: 2020 2020 2020 2020 6966 206e 702e 616c          if np.al
-0000a2a0: 6c63 6c6f 7365 286d 2e74 7261 6e73 706f  lclose(m.transpo
-0000a2b0: 7365 2829 2c20 6d29 3a0a 2020 2020 2020  se(), m):.      
-0000a2c0: 2020 2020 2020 2020 2020 666f 726d 203d            form =
-0000a2d0: 2036 0a20 2020 2020 2020 2020 2020 2065   6.            e
-0000a2e0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0000a2f0: 2020 2020 2066 6f72 6d20 3d20 310a 0a20       form = 1.. 
-0000a300: 2020 2020 2020 2023 2064 6574 6572 6d69         # determi
-0000a310: 6e65 2074 7970 6520 6f66 206d 6174 7269  ne type of matri
-0000a320: 783a 0a20 2020 2020 2020 2069 6620 6e70  x:.        if np
-0000a330: 2e69 7363 6f6d 706c 6578 6f62 6a28 6d29  .iscomplexobj(m)
-0000a340: 3a0a 2020 2020 2020 2020 2020 2020 6d74  :.            mt
-0000a350: 7970 6520 3d20 3420 6966 206d 2e64 7479  ype = 4 if m.dty
-0000a360: 7065 2e69 7465 6d73 697a 6520 3e20 3820  pe.itemsize > 8 
-0000a370: 656c 7365 2033 0a20 2020 2020 2020 2065  else 3.        e
-0000a380: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0000a390: 206d 7479 7065 203d 2032 2069 6620 6d2e   mtype = 2 if m.
-0000a3a0: 6474 7970 652e 6974 656d 7369 7a65 203e  dtype.itemsize >
-0000a3b0: 2034 2065 6c73 6520 310a 0a20 2020 2020   4 else 1..     
-0000a3c0: 2020 2023 2077 7269 7465 2068 6561 6465     # write heade
-0000a3d0: 7220 6361 7264 3a0a 2020 2020 2020 2020  r card:.        
-0000a3e0: 706f 6c61 7220 3d20 300a 2020 2020 2020  polar = 0.      
-0000a3f0: 2020 746f 7574 203d 2030 0a0a 2020 2020    tout = 0..    
-0000a400: 2020 2020 2320 2020 2020 2020 2044 4d49      #        DMI
-0000a410: 4720 204e 414d 4520 2030 2020 2020 4946  G  NAME  0    IF
-0000a420: 4f20 2054 494e 2020 544f 5554 2050 4f4c  O  TIN  TOUT POL
-0000a430: 4152 2020 2020 204e 434f 4c0a 2020 2020  AR     NCOL.    
-0000a440: 2020 2020 662e 7772 6974 6528 0a20 2020      f.write(.   
-0000a450: 2020 2020 2020 2020 2066 227b 2744 4d49           f"{'DMI
-0000a460: 4727 3a3c 3873 7d7b 6e61 6d65 3a3c 3873  G':<8s}{name:<8s
-0000a470: 7d7b 303a 3864 7d7b 666f 726d 3a38 647d  }{0:8d}{form:8d}
-0000a480: 7b6d 7479 7065 3a38 647d 7b74 6f75 743a  {mtype:8d}{tout:
-0000a490: 3864 7d22 0a20 2020 2020 2020 2020 2020  8d}".           
-0000a4a0: 2066 227b 706f 6c61 723a 3864 7d7b 2727   f"{polar:8d}{''
-0000a4b0: 3a38 737d 7b6e 636f 6c3a 3864 7d5c 6e22  :8s}{ncol:8d}\n"
-0000a4c0: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-0000a4d0: 2020 2020 2320 7772 6974 6520 6120 636f      # write a co
-0000a4e0: 6c75 6d6e 2061 7420 6120 7469 6d65 3a0a  lumn at a time:.
-0000a4f0: 2020 2020 2020 2020 666f 7220 636f 6c20          for col 
-0000a500: 696e 2072 616e 6765 286d 2e73 6861 7065  in range(m.shape
-0000a510: 5b31 5d29 3a0a 2020 2020 2020 2020 2020  [1]):.          
-0000a520: 2020 6966 206d 5b3a 2c20 636f 6c5d 2e61    if m[:, col].a
-0000a530: 6e79 2829 3a0a 2020 2020 2020 2020 2020  ny():.          
-0000a540: 2020 2020 2020 7374 6172 745f 726f 7720        start_row 
-0000a550: 3d20 636f 6c20 6966 2066 6f72 6d20 3d3d  = col if form ==
-0000a560: 2036 2065 6c73 6520 300a 2020 2020 2020   6 else 0.      
-0000a570: 2020 2020 2020 2020 2020 6966 2063 6f6c            if col
-0000a580: 6964 732e 6e6c 6576 656c 7320 3d3d 2032  ids.nlevels == 2
-0000a590: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0000a5a0: 2020 2020 2020 676a 2c20 636a 203d 2063        gj, cj = c
-0000a5b0: 6f6c 6964 735b 636f 6c5d 0a20 2020 2020  olids[col].     
-0000a5c0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-0000a5d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000a5e0: 2020 2020 2067 6a20 3d20 636f 6c69 6473       gj = colids
-0000a5f0: 5b63 6f6c 5d0a 2020 2020 2020 2020 2020  [col].          
-0000a600: 2020 2020 2020 2020 2020 636a 203d 2030            cj = 0
-0000a610: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000a620: 2066 2e77 7269 7465 2866 227b 2744 4d49   f.write(f"{'DMI
-0000a630: 472a 273a 3c38 737d 7b6e 616d 653a 3c31  G*':<8s}{name:<1
-0000a640: 3673 7d7b 676a 3a31 3664 7d7b 636a 3a31  6s}{gj:16d}{cj:1
-0000a650: 3664 7d5c 6e22 290a 2020 2020 2020 2020  6d}\n").        
-0000a660: 2020 2020 2020 2020 666f 7220 726f 7720          for row 
-0000a670: 696e 2072 616e 6765 2873 7461 7274 5f72  in range(start_r
-0000a680: 6f77 2c20 6d2e 7368 6170 655b 305d 293a  ow, m.shape[0]):
-0000a690: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000a6a0: 2020 2020 206e 756d 203d 206d 5b72 6f77       num = m[row
-0000a6b0: 2c20 636f 6c5d 0a20 2020 2020 2020 2020  , col].         
-0000a6c0: 2020 2020 2020 2020 2020 2069 6620 6e75             if nu
-0000a6d0: 6d20 213d 2030 2e30 3a0a 2020 2020 2020  m != 0.0:.      
-0000a6e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a6f0: 2020 6769 2c20 6369 203d 2072 6f77 6964    gi, ci = rowid
-0000a700: 735b 726f 775d 0a20 2020 2020 2020 2020  s[row].         
-0000a710: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0000a720: 6620 6d74 7970 6520 3c20 333a 2020 2320  f mtype < 3:  # 
-0000a730: 7265 616c 0a20 2020 2020 2020 2020 2020  real.           
-0000a740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a750: 206e 756d 5f73 7472 203d 2066 227b 6e75   num_str = f"{nu
-0000a760: 6d3a 3136 2e39 457d 220a 2020 2020 2020  m:16.9E}".      
-0000a770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a780: 2020 656c 7365 3a20 2023 2063 6f6d 706c    else:  # compl
-0000a790: 6578 0a20 2020 2020 2020 2020 2020 2020  ex.             
-0000a7a0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-0000a7b0: 756d 5f73 7472 203d 2066 227b 6e75 6d2e  um_str = f"{num.
-0000a7c0: 7265 616c 3a31 362e 3945 7d7b 6e75 6d2e  real:16.9E}{num.
-0000a7d0: 696d 6167 3a31 362e 3945 7d22 0a20 2020  imag:16.9E}".   
-0000a7e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a7f0: 2020 2020 2069 6620 6d74 7970 6520 2620       if mtype & 
-0000a800: 3120 3d3d 2030 3a20 2023 2069 6620 6576  1 == 0:  # if ev
-0000a810: 656e 0a20 2020 2020 2020 2020 2020 2020  en.             
-0000a820: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-0000a830: 756d 5f73 7472 203d 206e 756d 5f73 7472  um_str = num_str
-0000a840: 2e72 6570 6c61 6365 2822 4522 2c20 2244  .replace("E", "D
-0000a850: 2229 0a20 2020 2020 2020 2020 2020 2020  ").             
-0000a860: 2020 2020 2020 2020 2020 2066 2e77 7269             f.wri
-0000a870: 7465 2866 227b 272a 273a 3c38 737d 7b67  te(f"{'*':<8s}{g
-0000a880: 693a 3136 647d 7b63 693a 3136 647d 7b6e  i:16d}{ci:16d}{n
-0000a890: 756d 5f73 7472 3a73 7d5c 6e22 290a 0a0a  um_str:s}\n")...
-0000a8a0: 6465 6620 7264 6772 6964 7328 6629 3a0a  def rdgrids(f):.
-0000a8b0: 2020 2020 2222 220a 2020 2020 5265 6164      """.    Read
-0000a8c0: 204e 6173 7472 616e 2047 5249 4420 6361   Nastran GRID ca
-0000a8d0: 7264 7320 6672 6f6d 2061 204e 6173 7472  rds from a Nastr
-0000a8e0: 616e 2062 756c 6b20 6669 6c65 2e0a 0a20  an bulk file... 
-0000a8f0: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
-0000a900: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
-0000a910: 2066 203a 2073 7472 696e 6720 6f72 2066   f : string or f
-0000a920: 696c 655f 6c69 6b65 206f 7220 4e6f 6e65  ile_like or None
-0000a930: 0a20 2020 2020 2020 2045 6974 6865 7220  .        Either 
-0000a940: 6120 6e61 6d65 206f 6620 6120 6669 6c65  a name of a file
-0000a950: 2c20 6f72 2069 7320 6120 6669 6c65 5f6c  , or is a file_l
-0000a960: 696b 6520 6f62 6a65 6374 2061 7320 7265  ike object as re
-0000a970: 7475 726e 6564 0a20 2020 2020 2020 2062  turned.        b
-0000a980: 7920 3a66 756e 633a 606f 7065 6e60 2e20  y :func:`open`. 
-0000a990: 4966 2066 696c 655f 6c69 6b65 206f 626a  If file_like obj
-0000a9a0: 6563 742c 2069 7420 6973 2072 6577 6f75  ect, it is rewou
-0000a9b0: 6e64 2066 6972 7374 2e20 4361 6e0a 2020  nd first. Can.  
-0000a9c0: 2020 2020 2020 616c 736f 2062 6520 7468        also be th
-0000a9d0: 6520 6e61 6d65 206f 6620 6120 6469 7265  e name of a dire
-0000a9e0: 6374 6f72 7920 6f72 204e 6f6e 653b 2069  ctory or None; i
-0000a9f0: 6e20 7468 6573 6520 6361 7365 732c 2061  n these cases, a
-0000aa00: 2047 5549 0a20 2020 2020 2020 2069 7320   GUI.        is 
-0000aa10: 6f70 656e 6564 2066 6f72 2066 696c 6520  opened for file 
-0000aa20: 7365 6c65 6374 696f 6e2e 0a0a 2020 2020  selection...    
-0000aa30: 5265 7475 726e 730a 2020 2020 2d2d 2d2d  Returns.    ----
-0000aa40: 2d2d 2d0a 2020 2020 6772 6964 7320 3a20  ---.    grids : 
-0000aa50: 6e64 6172 7261 7920 6f72 204e 6f6e 650a  ndarray or None.
-0000aa60: 2020 2020 2020 2020 382d 636f 6c75 6d6e          8-column
-0000aa70: 206e 6461 7272 6179 3a20 5b20 6964 2c20   ndarray: [ id, 
-0000aa80: 6373 2c20 782c 2079 2c20 7a2c 2063 732c  cs, x, y, z, cs,
-0000aa90: 2073 7063 2c20 7365 6964 205d 2e20 5265   spc, seid ]. Re
-0000aaa0: 7475 726e 730a 2020 2020 2020 2020 4e6f  turns.        No
-0000aab0: 6e65 2069 6620 6e6f 2067 7269 6420 6361  ne if no grid ca
-0000aac0: 7264 7320 666f 756e 640a 0a20 2020 204e  rds found..    N
-0000aad0: 6f74 6573 0a20 2020 202d 2d2d 2d2d 0a20  otes.    -----. 
-0000aae0: 2020 2054 6869 7320 726f 7574 696e 6520     This routine 
-0000aaf0: 7573 6573 203a 6675 6e63 3a60 7264 6361  uses :func:`rdca
-0000ab00: 7264 7360 2074 6f20 6c6f 6164 2074 6865  rds` to load the
-0000ab10: 2064 6174 6120 2863 616e 2072 6561 6420   data (can read 
-0000ab20: 3820 6f72 0a20 2020 2031 3620 6669 7865  8 or.    16 fixe
-0000ab30: 6420 6669 656c 6420 6f72 2063 6f6d 6d61  d field or comma
-0000ab40: 2d64 656c 696d 6974 6564 292e 0a0a 2020  -delimited)...  
-0000ab50: 2020 4578 616d 706c 6573 0a20 2020 202d    Examples.    -
-0000ab60: 2d2d 2d2d 2d2d 2d0a 2020 2020 3e3e 3e20  -------.    >>> 
-0000ab70: 696d 706f 7274 206e 756d 7079 2061 7320  import numpy as 
-0000ab80: 6e70 0a20 2020 203e 3e3e 2066 726f 6d20  np.    >>> from 
-0000ab90: 7079 7965 7469 2069 6d70 6f72 7420 6e61  pyyeti import na
-0000aba0: 7374 7261 6e0a 2020 2020 3e3e 3e20 6672  stran.    >>> fr
-0000abb0: 6f6d 2069 6f20 696d 706f 7274 2053 7472  om io import Str
-0000abc0: 696e 6749 4f0a 2020 2020 3e3e 3e20 6672  ingIO.    >>> fr
-0000abd0: 6f6d 2070 616e 6461 7320 696d 706f 7274  om pandas import
-0000abe0: 2044 6174 6146 7261 6d65 0a20 2020 203e   DataFrame.    >
-0000abf0: 3e3e 2078 797a 203d 206e 702e 6172 7261  >> xyz = np.arra
-0000ac00: 7928 5b5b 2e31 2c20 2e32 2c20 2e33 5d2c  y([[.1, .2, .3],
-0000ac10: 205b 312e 312c 2031 2e32 2c20 312e 335d   [1.1, 1.2, 1.3]
-0000ac20: 5d29 0a20 2020 203e 3e3e 2077 6974 6820  ]).    >>> with 
-0000ac30: 5374 7269 6e67 494f 2829 2061 7320 663a  StringIO() as f:
-0000ac40: 0a20 2020 202e 2e2e 2020 2020 206e 6173  .    ...     nas
-0000ac50: 7472 616e 2e77 7467 7269 6473 2866 2c20  tran.wtgrids(f, 
-0000ac60: 5b31 3030 2c20 3230 305d 2c20 7879 7a3d  [100, 200], xyz=
-0000ac70: 7879 7a2c 2063 643d 3130 290a 2020 2020  xyz, cd=10).    
-0000ac80: 2e2e 2e20 2020 2020 6720 3d20 6e61 7374  ...     g = nast
-0000ac90: 7261 6e2e 7264 6772 6964 7328 6629 0a20  ran.rdgrids(f). 
-0000aca0: 2020 203e 3e3e 2064 6620 3d20 4461 7461     >>> df = Data
-0000acb0: 4672 616d 6528 6729 0a20 2020 203e 3e3e  Frame(g).    >>>
-0000acc0: 2069 6e74 636f 6c73 203d 205b 302c 2031   intcols = [0, 1
-0000acd0: 2c20 352c 2036 2c20 375d 0a20 2020 203e  , 5, 6, 7].    >
-0000ace0: 3e3e 2064 665b 696e 7463 6f6c 735d 203d  >> df[intcols] =
-0000acf0: 2064 665b 696e 7463 6f6c 735d 2e61 7374   df[intcols].ast
-0000ad00: 7970 6528 696e 7429 0a20 2020 203e 3e3e  ype(int).    >>>
-0000ad10: 2064 660a 2020 2020 2020 2020 2030 2020   df.         0  
-0000ad20: 3120 2020 2032 2020 2020 3320 2020 2034  1    2    3    4
-0000ad30: 2020 2035 2020 3620 2037 0a20 2020 2030     5  6  7.    0
-0000ad40: 2020 3130 3020 2030 2020 302e 3120 2030    100  0  0.1  0
-0000ad50: 2e32 2020 302e 3320 2031 3020 2030 2020  .2  0.3  10  0  
-0000ad60: 300a 2020 2020 3120 2032 3030 2020 3020  0.    1  200  0 
-0000ad70: 2031 2e31 2020 312e 3220 2031 2e33 2020   1.1  1.2  1.3  
-0000ad80: 3130 2020 3020 2030 0a20 2020 2022 2222  10  0  0.    """
-0000ad90: 0a20 2020 2076 203d 2072 6463 6172 6473  .    v = rdcards
-0000ada0: 2866 2c20 2267 7269 6422 290a 2020 2020  (f, "grid").    
-0000adb0: 6966 2076 2069 7320 6e6f 7420 4e6f 6e65  if v is not None
-0000adc0: 3a0a 2020 2020 2020 2020 6320 3d20 6e70  :.        c = np
-0000add0: 2e73 697a 6528 762c 2031 290a 2020 2020  .size(v, 1).    
-0000ade0: 2020 2020 6966 2063 203c 2038 3a0a 2020      if c < 8:.  
-0000adf0: 2020 2020 2020 2020 2020 7620 3d20 6e70            v = np
-0000ae00: 2e68 7374 6163 6b28 2876 2c20 6e70 2e7a  .hstack((v, np.z
-0000ae10: 6572 6f73 2828 6e70 2e73 697a 6528 762c  eros((np.size(v,
-0000ae20: 2030 292c 2038 202d 2063 2929 2929 0a20   0), 8 - c)))). 
-0000ae30: 2020 2020 2020 2072 6574 7572 6e20 760a         return v.
-0000ae40: 0a0a 6465 6620 5f63 6f6e 7665 7274 5f63  ..def _convert_c
-0000ae50: 6172 6428 6361 7264 293a 0a20 2020 2069  ard(card):.    i
-0000ae60: 6620 6c65 6e28 6361 7264 2920 213d 2031  f len(card) != 1
-0000ae70: 323a 0a20 2020 2020 2020 2069 6620 6c65  2:.        if le
-0000ae80: 6e28 6361 7264 2920 3d3d 2031 3320 616e  n(card) == 13 an
-0000ae90: 6420 6361 7264 5b31 325d 203d 3d20 3020  d card[12] == 0 
-0000aea0: 616e 6420 6973 696e 7374 616e 6365 2863  and isinstance(c
-0000aeb0: 6172 645b 3132 5d2c 2069 6e74 293a 0a20  ard[12], int):. 
-0000aec0: 2020 2020 2020 2020 2020 2063 6172 6420             card 
-0000aed0: 3d20 6361 7264 5b3a 3132 5d0a 2020 2020  = card[:12].    
-0000aee0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-0000aef0: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-0000af00: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
-0000af10: 2020 2020 2020 2020 6622 6578 7065 6374          f"expect
-0000af20: 6564 2031 3220 6669 656c 6473 2062 7574  ed 12 fields but
-0000af30: 2067 6f74 207b 6c65 6e28 6361 7264 297d   got {len(card)}
-0000af40: 2c20 6368 6563 6b3a 207b 6361 7264 5b30  , check: {card[0
-0000af50: 5d7d 2c20 7b63 6172 645b 315d 7d22 0a20  ]}, {card[1]}". 
-0000af60: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-0000af70: 2063 6861 7220 3d20 6361 7264 5b30 5d5b   char = card[0][
-0000af80: 355d 0a20 2020 2069 6620 6368 6172 2069  5].    if char i
-0000af90: 6e20 2272 5222 3a0a 2020 2020 2020 2020  n "rR":.        
-0000afa0: 6374 7970 6520 3d20 310a 2020 2020 656c  ctype = 1.    el
-0000afb0: 6966 2063 6861 7220 696e 2022 6343 223a  if char in "cC":
-0000afc0: 0a20 2020 2020 2020 2063 7479 7065 203d  .        ctype =
-0000afd0: 2032 0a20 2020 2065 6c73 653a 0a20 2020   2.    else:.   
-0000afe0: 2020 2020 2063 7479 7065 203d 2033 0a0a       ctype = 3..
-0000aff0: 2020 2020 2320 666f 7220 6572 726f 7220      # for error 
-0000b000: 6d65 7373 6167 652c 2069 6e20 6361 7365  message, in case
-0000b010: 2069 7427 7320 6e65 6564 6564 3a0a 2020   it's needed:.  
-0000b020: 2020 6e61 6d65 2c20 6964 656e 7420 3d20    name, ident = 
-0000b030: 6361 7264 5b30 5d2c 2063 6172 645b 315d  card[0], card[1]
-0000b040: 0a0a 2020 2020 6361 7264 5b30 5d2c 2063  ..    card[0], c
-0000b050: 6172 645b 315d 203d 2063 6172 645b 315d  ard[1] = card[1]
-0000b060: 2c20 6374 7970 650a 2020 2020 7472 793a  , ctype.    try:
-0000b070: 0a20 2020 2020 2020 2063 6172 6420 3d20  .        card = 
-0000b080: 6e70 2e61 7272 6179 2863 6172 6429 2e61  np.array(card).a
-0000b090: 7374 7970 6528 666c 6f61 7429 0a20 2020  stype(float).   
-0000b0a0: 2065 7863 6570 7420 5661 6c75 6545 7272   except ValueErr
-0000b0b0: 6f72 2061 7320 653a 0a20 2020 2020 2020  or as e:.       
-0000b0c0: 206d 7367 203d 2066 227b 652e 6172 6773   msg = f"{e.args
-0000b0d0: 5b30 5d7d 2c20 6368 6563 6b3a 207b 6e61  [0]}, check: {na
-0000b0e0: 6d65 7d2c 207b 6964 656e 747d 220a 2020  me}, {ident}".  
-0000b0f0: 2020 2020 2020 652e 6172 6773 203d 2028        e.args = (
-0000b100: 6d73 672c 290a 2020 2020 2020 2020 7261  msg,).        ra
-0000b110: 6973 650a 0a20 2020 2072 6574 7572 6e20  ise..    return 
-0000b120: 6361 7264 0a0a 0a64 6566 2072 6463 6f72  card...def rdcor
-0000b130: 6432 6361 7264 7328 6629 3a0a 2020 2020  d2cards(f):.    
-0000b140: 2222 220a 2020 2020 5265 6164 2043 4f52  """.    Read COR
-0000b150: 4432 2a20 6361 7264 7320 6672 6f6d 2061  D2* cards from a
-0000b160: 204e 6173 7472 616e 2062 756c 6b20 6669   Nastran bulk fi
-0000b170: 6c65 0a0a 2020 2020 5061 7261 6d65 7465  le..    Paramete
-0000b180: 7273 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d  rs.    ---------
-0000b190: 2d0a 2020 2020 6620 3a20 7374 7269 6e67  -.    f : string
-0000b1a0: 206f 7220 6669 6c65 5f6c 696b 6520 6f72   or file_like or
-0000b1b0: 204e 6f6e 650a 2020 2020 2020 2020 4569   None.        Ei
-0000b1c0: 7468 6572 2061 206e 616d 6520 6f66 2061  ther a name of a
-0000b1d0: 2066 696c 652c 206f 7220 6973 2061 2066   file, or is a f
-0000b1e0: 696c 655f 6c69 6b65 206f 626a 6563 7420  ile_like object 
-0000b1f0: 6173 2072 6574 7572 6e65 640a 2020 2020  as returned.    
-0000b200: 2020 2020 6279 203a 6675 6e63 3a60 6f70      by :func:`op
-0000b210: 656e 602e 2049 6620 6669 6c65 5f6c 696b  en`. If file_lik
-0000b220: 6520 6f62 6a65 6374 2c20 6974 2069 7320  e object, it is 
-0000b230: 7265 776f 756e 6420 6669 7273 742e 2043  rewound first. C
-0000b240: 616e 0a20 2020 2020 2020 2061 6c73 6f20  an.        also 
-0000b250: 6265 2074 6865 206e 616d 6520 6f66 2061  be the name of a
-0000b260: 2064 6972 6563 746f 7279 206f 7220 4e6f   directory or No
-0000b270: 6e65 3b20 696e 2074 6865 7365 2063 6173  ne; in these cas
-0000b280: 6573 2c20 6120 4755 490a 2020 2020 2020  es, a GUI.      
-0000b290: 2020 6973 206f 7065 6e65 6420 666f 7220    is opened for 
-0000b2a0: 6669 6c65 2073 656c 6563 7469 6f6e 2e0a  file selection..
-0000b2b0: 0a20 2020 2052 6574 7572 6e73 0a20 2020  .    Returns.   
-0000b2c0: 202d 2d2d 2d2d 2d2d 0a20 2020 2064 6963   -------.    dic
-0000b2d0: 7469 6f6e 6172 790a 2020 2020 2020 2020  tionary.        
-0000b2e0: 4469 6374 696f 6e61 7279 2077 6974 6820  Dictionary with 
-0000b2f0: 7468 6520 6b65 7973 2062 6569 6e67 2074  the keys being t
-0000b300: 6865 2063 6f6f 7264 696e 6174 6520 7379  he coordinate sy
-0000b310: 7374 656d 2069 6420 616e 640a 2020 2020  stem id and.    
-0000b320: 2020 2020 7468 6520 7661 6c75 6573 2062      the values b
-0000b330: 6569 6e67 2074 6865 2035 7833 206d 6174  eing the 5x3 mat
-0000b340: 7269 783a 3a0a 0a20 2020 2020 2020 2020  rix::..         
-0000b350: 2020 205b 6964 2020 7479 7065 2030 5d20     [id  type 0] 
-0000b360: 2023 206f 7574 7075 7420 636f 6f72 642e   # output coord.
-0000b370: 2073 7973 2e20 6964 2061 6e64 2074 7970   sys. id and typ
-0000b380: 650a 2020 2020 2020 2020 2020 2020 5b78  e.            [x
-0000b390: 6f20 2079 6f20 207a 6f5d 2020 2320 6f72  o  yo  zo]  # or
-0000b3a0: 6967 696e 206f 6620 636f 6f72 642e 2073  igin of coord. s
-0000b3b0: 7973 7465 6d0a 2020 2020 2020 2020 2020  ystem.          
-0000b3c0: 2020 5b20 2020 2054 2020 2020 205d 2020    [    T     ]  
-0000b3d0: 2320 3378 3320 7472 616e 7366 6f72 6d61  # 3x3 transforma
-0000b3e0: 7469 6f6e 2074 6f20 6261 7369 630a 2020  tion to basic.  
-0000b3f0: 2020 2020 2020 2020 2020 4e6f 7465 2074            Note t
-0000b400: 6861 7420 5420 6973 2066 6f72 2074 6865  hat T is for the
-0000b410: 2063 6f6f 7264 696e 6174 6520 7379 7374   coordinate syst
-0000b420: 656d 2c20 6e6f 7420 6120 6772 6964 0a20  em, not a grid. 
-0000b430: 2020 2020 2020 2020 2020 2028 756e 6c65             (unle
-0000b440: 7373 2074 7970 6520 3d20 3120 7768 6963  ss type = 1 whic
-0000b450: 6820 6d65 616e 7320 7265 6374 616e 6775  h means rectangu
-0000b460: 6c61 7229 0a0a 2020 2020 4e6f 7465 730a  lar)..    Notes.
-0000b470: 2020 2020 2d2d 2d2d 2d0a 2020 2020 5468      -----.    Th
-0000b480: 6973 2072 6f75 7469 6e65 2075 7365 7320  is routine uses 
-0000b490: 3a66 756e 633a 6070 7979 6574 692e 6e61  :func:`pyyeti.na
-0000b4a0: 7374 7261 6e2e 6e32 702e 6275 696c 645f  stran.n2p.build_
-0000b4b0: 636f 6f72 6473 6020 746f 2062 7569 6c64  coords` to build
-0000b4c0: 0a20 2020 2074 6865 206f 7574 7075 742e  .    the output.
-0000b4d0: 0a0a 2020 2020 5365 6520 616c 736f 0a20  ..    See also. 
-0000b4e0: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
-0000b4f0: 3a66 756e 633a 6061 736d 3275 7365 7460  :func:`asm2uset`
-0000b500: 2c20 3a66 756e 633a 6062 756c 6b32 7573  , :func:`bulk2us
-0000b510: 6574 602c 203a 6675 6e63 3a60 7264 6361  et`, :func:`rdca
-0000b520: 7264 7360 2c0a 2020 2020 3a66 756e 633a  rds`,.    :func:
-0000b530: 6070 7979 6574 692e 6e61 7374 7261 6e2e  `pyyeti.nastran.
-0000b540: 6e32 702e 6275 696c 645f 636f 6f72 6473  n2p.build_coords
-0000b550: 600a 2020 2020 2222 220a 2020 2020 6361  `.    """.    ca
-0000b560: 7264 7320 3d20 7264 6361 7264 7328 0a20  rds = rdcards(. 
-0000b570: 2020 2020 2020 2066 2c20 7222 2863 6f72         f, r"(cor
-0000b580: 6432 5b72 6373 5d29 5c62 222c 2072 6574  d2[rcs])\b", ret
-0000b590: 7572 6e5f 7661 723d 226c 6973 7422 2c20  urn_var="list", 
-0000b5a0: 7265 6765 783d 5472 7565 2c20 6b65 6570  regex=True, keep
-0000b5b0: 5f6e 616d 653d 5472 7565 2c20 626c 616e  _name=True, blan
-0000b5c0: 6b3d 300a 2020 2020 290a 0a20 2020 2069  k=0.    )..    i
-0000b5d0: 6620 6361 7264 7320 6973 204e 6f6e 653a  f cards is None:
-0000b5e0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0000b5f0: 7b7d 0a0a 2020 2020 7265 7475 726e 206e  {}..    return n
-0000b600: 3270 2e62 7569 6c64 5f63 6f6f 7264 7328  2p.build_coords(
-0000b610: 6e70 2e61 7272 6179 285b 5f63 6f6e 7665  np.array([_conve
-0000b620: 7274 5f63 6172 6428 6361 7264 2920 666f  rt_card(card) fo
-0000b630: 7220 6361 7264 2069 6e20 6361 7264 735d  r card in cards]
-0000b640: 2929 0a0a 0a64 6566 2077 7467 7269 6473  ))...def wtgrids
-0000b650: 280a 2020 2020 662c 0a20 2020 2067 7269  (.    f,.    gri
-0000b660: 6473 2c0a 2020 2020 6370 3d30 2c0a 2020  ds,.    cp=0,.  
-0000b670: 2020 7879 7a3d 6e70 2e61 7272 6179 285b    xyz=np.array([
-0000b680: 5b30 2e30 2c20 302e 302c 2030 2e30 5d5d  [0.0, 0.0, 0.0]]
-0000b690: 292c 0a20 2020 2063 643d 302c 0a20 2020  ),.    cd=0,.   
-0000b6a0: 2070 733d 2222 2c0a 2020 2020 7365 6964   ps="",.    seid
-0000b6b0: 3d22 222c 0a20 2020 2066 6f72 6d3d 227b  ="",.    form="{
-0000b6c0: 3a31 362e 3866 7d22 2c0a 293a 0a20 2020  :16.8f}",.):.   
-0000b6d0: 2022 2222 0a20 2020 2057 7269 7465 7320   """.    Writes 
-0000b6e0: 4e61 7374 7261 6e20 4752 4944 2063 6172  Nastran GRID car
-0000b6f0: 6473 2074 6f20 6120 6669 6c65 2e0a 0a20  ds to a file... 
-0000b700: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
-0000b710: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
-0000b720: 2066 203a 2073 7472 696e 6720 6f72 2066   f : string or f
-0000b730: 696c 655f 6c69 6b65 206f 7220 3120 6f72  ile_like or 1 or
-0000b740: 204e 6f6e 650a 2020 2020 2020 2020 4569   None.        Ei
-0000b750: 7468 6572 2061 206e 616d 6520 6f66 2061  ther a name of a
-0000b760: 2066 696c 652c 206f 7220 6973 2061 2066   file, or is a f
-0000b770: 696c 655f 6c69 6b65 206f 626a 6563 7420  ile_like object 
-0000b780: 6173 2072 6574 7572 6e65 640a 2020 2020  as returned.    
-0000b790: 2020 2020 6279 203a 6675 6e63 3a60 6f70      by :func:`op
-0000b7a0: 656e 6020 6f72 203a 636c 6173 733a 6069  en` or :class:`i
-0000b7b0: 6f2e 5374 7269 6e67 494f 602e 2049 6e70  o.StringIO`. Inp
-0000b7c0: 7574 2061 7320 696e 7465 6765 7220 3120  ut as integer 1 
-0000b7d0: 746f 0a20 2020 2020 2020 2077 7269 7465  to.        write
-0000b7e0: 2074 6f20 7374 646f 7574 2e20 4361 6e20   to stdout. Can 
-0000b7f0: 616c 736f 2062 6520 7468 6520 6e61 6d65  also be the name
-0000b800: 206f 6620 6120 6469 7265 6374 6f72 7920   of a directory 
-0000b810: 6f72 204e 6f6e 653b 0a20 2020 2020 2020  or None;.       
-0000b820: 2069 6e20 7468 6573 6520 6361 7365 732c   in these cases,
-0000b830: 2061 2047 5549 2069 7320 6f70 656e 6564   a GUI is opened
-0000b840: 2066 6f72 2066 696c 6520 7365 6c65 6374   for file select
-0000b850: 696f 6e2e 0a20 2020 2067 7269 6473 203a  ion..    grids :
-0000b860: 2031 6420 6172 7261 795f 6c69 6b65 3b20   1d array_like; 
-0000b870: 6c65 6e67 7468 204e 0a20 2020 2020 2020  length N.       
-0000b880: 2056 6563 746f 7220 6f66 2067 7269 6420   Vector of grid 
-0000b890: 6964 732e 2054 6865 206c 656e 6774 6820  ids. The length 
-0000b8a0: 6f66 2060 6772 6964 7360 2077 696c 6c20  of `grids` will 
-0000b8b0: 6265 2072 6566 6572 656e 6365 640a 2020  be referenced.  
-0000b8c0: 2020 2020 2020 6173 2060 604e 6060 2069        as ``N`` i
-0000b8d0: 6e20 6578 706c 616e 6174 696f 6e73 2062  n explanations b
-0000b8e0: 656c 6f77 2e0a 2020 2020 6370 203a 2069  elow..    cp : i
-0000b8f0: 6e74 6567 6572 2073 6361 6c61 7220 6f72  nteger scalar or
-0000b900: 2076 6563 746f 720a 2020 2020 2020 2020   vector.        
-0000b910: 4964 206f 6620 636f 6f72 6469 6e61 7465  Id of coordinate
-0000b920: 2073 7973 7465 6d28 7329 2067 7269 6473   system(s) grids
-0000b930: 2061 7265 2064 6566 696e 6564 2069 6e3b   are defined in;
-0000b940: 2065 6974 6865 7220 7363 616c 6172 0a20   either scalar. 
-0000b950: 2020 2020 2020 206f 7220 7665 6374 6f72         or vector
-0000b960: 2077 6974 6820 4e20 726f 7773 2e0a 2020   with N rows..  
-0000b970: 2020 7879 7a20 3a20 3264 2061 7272 6179    xyz : 2d array
-0000b980: 5f6c 696b 650a 2020 2020 2020 2020 332d  _like.        3-
-0000b990: 636f 6c75 6d6e 206d 6174 7269 7820 6f66  column matrix of
-0000b9a0: 2067 7269 6420 6c6f 6361 7469 6f6e 733b   grid locations;
-0000b9b0: 2031 2072 6f77 206f 7220 4e20 726f 7773   1 row or N rows
-0000b9c0: 2e0a 2020 2020 6364 203a 2069 6e74 6567  ..    cd : integ
-0000b9d0: 6572 2073 6361 6c61 7220 6f72 2076 6563  er scalar or vec
-0000b9e0: 746f 720a 2020 2020 2020 2020 4964 206f  tor.        Id o
-0000b9f0: 6620 6469 7370 6c61 6365 6d65 6e74 2063  f displacement c
-0000ba00: 6f6f 7264 696e 6174 6520 7379 7374 656d  oordinate system
-0000ba10: 2066 6f72 2067 7269 6473 3b20 6569 7468   for grids; eith
-0000ba20: 6572 2073 6361 6c61 720a 2020 2020 2020  er scalar.      
-0000ba30: 2020 6f72 2076 6563 746f 7220 7769 7468    or vector with
-0000ba40: 204e 2072 6f77 732e 0a20 2020 2070 7320   N rows..    ps 
-0000ba50: 3a20 696e 7465 6765 7220 7363 616c 6172  : integer scalar
-0000ba60: 206f 7220 7665 6374 6f72 0a20 2020 2020   or vector.     
-0000ba70: 2020 2050 6572 6d61 6e65 6e74 2063 6f6e     Permanent con
-0000ba80: 7374 7261 696e 7473 2066 6f72 2067 7269  straints for gri
-0000ba90: 6473 2c20 6567 3a20 3132 3334 3536 3b20  ds, eg: 123456; 
-0000baa0: 6569 7468 6572 2073 6361 6c61 7220 6f72  either scalar or
-0000bab0: 0a20 2020 2020 2020 2076 6563 746f 7220  .        vector 
-0000bac0: 7769 7468 204e 2072 6f77 732e 0a20 2020  with N rows..   
-0000bad0: 2073 6569 6420 3a20 696e 7465 6765 7220   seid : integer 
-0000bae0: 7363 616c 6172 206f 7220 7665 6374 6f72  scalar or vector
-0000baf0: 0a20 2020 2020 2020 2053 7570 6572 656c  .        Superel
-0000bb00: 656d 656e 7420 6964 3b20 6569 7468 6572  ement id; either
-0000bb10: 2073 6361 6c61 7220 6f72 2076 6563 746f   scalar or vecto
-0000bb20: 7220 7769 7468 204e 2072 6f77 732e 0a20  r with N rows.. 
-0000bb30: 2020 2066 6f72 6d61 7420 3a20 7374 7269     format : stri
-0000bb40: 6e67 0a20 2020 2020 2020 2053 7472 696e  ng.        Strin
-0000bb50: 6720 7370 6563 6966 7969 6e67 2066 6f72  g specifying for
-0000bb60: 6d61 7420 6f66 2058 595a 2076 616c 7565  mat of XYZ value
-0000bb70: 733b 206d 7573 7420 7072 6f64 7563 6520  s; must produce 
-0000bb80: 3820 6f72 2031 360a 2020 2020 2020 2020  8 or 16.        
-0000bb90: 6368 6172 6163 7465 7220 7374 7269 6e67  character string
-0000bba0: 732e 0a0a 2020 2020 5265 7475 726e 730a  s...    Returns.
-0000bbb0: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
-0000bbc0: 4e6f 6e65 0a0a 2020 2020 4578 616d 706c  None..    Exampl
-0000bbd0: 6573 0a20 2020 202d 2d2d 2d2d 2d2d 2d0a  es.    --------.
-0000bbe0: 2020 2020 3e3e 3e20 6672 6f6d 2070 7979      >>> from pyy
-0000bbf0: 6574 6920 696d 706f 7274 206e 6173 7472  eti import nastr
-0000bc00: 616e 0a20 2020 203e 3e3e 2069 6d70 6f72  an.    >>> impor
-0000bc10: 7420 6e75 6d70 7920 6173 206e 700a 2020  t numpy as np.  
-0000bc20: 2020 3e3e 3e20 6e61 7374 7261 6e2e 7774    >>> nastran.wt
-0000bc30: 6772 6964 7328 312c 206e 702e 6172 616e  grids(1, np.aran
-0000bc40: 6765 2831 2c20 3429 290a 2020 2020 4752  ge(1, 4)).    GR
-0000bc50: 4944 2a20 2020 2020 2020 2020 2020 2020  ID*             
-0000bc60: 2020 2020 2031 2020 2020 2020 2020 2020       1          
-0000bc70: 2020 2020 2030 2020 2020 2020 302e 3030       0      0.00
-0000bc80: 3030 3030 3030 2020 2020 2020 302e 3030  000000      0.00
-0000bc90: 3030 3030 3030 0a20 2020 202a 2020 2020  000000.    *    
-0000bca0: 2020 2020 2020 2020 2030 2e30 3030 3030           0.00000
-0000bcb0: 3030 3020 2020 2020 2020 2020 2020 2020  000             
-0000bcc0: 2020 300a 2020 2020 4752 4944 2a20 2020    0.    GRID*   
-0000bcd0: 2020 2020 2020 2020 2020 2020 2020 2032                 2
-0000bce0: 2020 2020 2020 2020 2020 2020 2020 2030                 0
-0000bcf0: 2020 2020 2020 302e 3030 3030 3030 3030        0.00000000
-0000bd00: 2020 2020 2020 302e 3030 3030 3030 3030        0.00000000
-0000bd10: 0a20 2020 202a 2020 2020 2020 2020 2020  .    *          
-0000bd20: 2020 2030 2e30 3030 3030 3030 3020 2020     0.00000000   
-0000bd30: 2020 2020 2020 2020 2020 2020 300a 2020              0.  
-0000bd40: 2020 4752 4944 2a20 2020 2020 2020 2020    GRID*         
-0000bd50: 2020 2020 2020 2020 2033 2020 2020 2020           3      
-0000bd60: 2020 2020 2020 2020 2030 2020 2020 2020           0      
-0000bd70: 302e 3030 3030 3030 3030 2020 2020 2020  0.00000000      
-0000bd80: 302e 3030 3030 3030 3030 0a20 2020 202a  0.00000000.    *
-0000bd90: 2020 2020 2020 2020 2020 2020 2030 2e30               0.0
-0000bda0: 3030 3030 3030 3020 2020 2020 2020 2020  0000000         
-0000bdb0: 2020 2020 2020 300a 2020 2020 3e3e 3e20        0.    >>> 
-0000bdc0: 7879 7a20 3d20 6e70 2e61 7272 6179 285b  xyz = np.array([
-0000bdd0: 5b2e 312c 202e 322c 202e 335d 2c20 5b31  [.1, .2, .3], [1
-0000bde0: 2e31 2c20 312e 322c 2031 2e33 5d5d 290a  .1, 1.2, 1.3]]).
-0000bdf0: 2020 2020 3e3e 3e20 6e61 7374 7261 6e2e      >>> nastran.
-0000be00: 7774 6772 6964 7328 312c 205b 3130 302c  wtgrids(1, [100,
-0000be10: 2032 3030 5d2c 2078 797a 3d78 797a 2c20   200], xyz=xyz, 
-0000be20: 6364 3d31 302c 0a20 2020 202e 2e2e 2020  cd=10,.    ...  
-0000be30: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0000be40: 6f72 6d3d 277b 3a38 2e32 667d 2729 0a20  orm='{:8.2f}'). 
-0000be50: 2020 2047 5249 4420 2020 2020 2020 2020     GRID         
-0000be60: 3130 3020 2020 2020 2020 3020 2020 2030  100       0    0
-0000be70: 2e31 3020 2020 2030 2e32 3020 2020 2030  .10    0.20    0
-0000be80: 2e33 3020 2020 2020 2031 300a 2020 2020  .30      10.    
-0000be90: 4752 4944 2020 2020 2020 2020 2032 3030  GRID         200
-0000bea0: 2020 2020 2020 2030 2020 2020 312e 3130         0    1.10
-0000beb0: 2020 2020 312e 3230 2020 2020 312e 3330      1.20    1.30
-0000bec0: 2020 2020 2020 3130 0a20 2020 2022 2222        10.    """
-0000bed0: 0a20 2020 2067 7269 6473 203d 206e 702e  .    grids = np.
-0000bee0: 6174 6c65 6173 745f 3164 2867 7269 6473  atleast_1d(grids
-0000bef0: 292e 7261 7665 6c28 290a 2020 2020 7879  ).ravel().    xy
-0000bf00: 7a20 3d20 6e70 2e61 746c 6561 7374 5f32  z = np.atleast_2
-0000bf10: 6428 7879 7a29 0a20 2020 2074 6573 7473  d(xyz).    tests
-0000bf20: 7472 203d 2066 6f72 6d2e 666f 726d 6174  tr = form.format
-0000bf30: 2831 2e30 290a 2020 2020 6c65 6e67 7468  (1.0).    length
-0000bf40: 203d 206c 656e 2874 6573 7473 7472 290a   = len(teststr).
-0000bf50: 2020 2020 6966 206c 656e 6774 6820 213d      if length !=
-0000bf60: 2038 2061 6e64 206c 656e 6774 6820 213d   8 and length !=
-0000bf70: 2031 363a 0a20 2020 2020 2020 2072 6169   16:.        rai
-0000bf80: 7365 2056 616c 7565 4572 726f 7228 0a20  se ValueError(. 
-0000bf90: 2020 2020 2020 2020 2020 2066 2260 666f             f"`fo
-0000bfa0: 726d 6020 7072 6f64 7563 6573 2061 207b  rm` produces a {
-0000bfb0: 6c65 6e67 7468 7d20 6c65 6e67 7468 2073  length} length s
-0000bfc0: 7472 696e 672e 2049 7420 6d75 7374 2062  tring. It must b
-0000bfd0: 6520 3820 6f72 2031 362e 5c6e 220a 2020  e 8 or 16.\n".  
-0000bfe0: 2020 2020 2020 290a 2020 2020 6966 2070        ).    if p
-0000bff0: 7320 3d3d 2073 6569 6420 3d3d 2022 223a  s == seid == "":
-0000c000: 0a20 2020 2020 2020 2069 6620 6c65 6e28  .        if len(
-0000c010: 7465 7374 7374 7229 203e 2038 3a0a 2020  teststr) > 8:.  
-0000c020: 2020 2020 2020 2020 2020 7374 7269 6e67            string
-0000c030: 203d 2028 0a20 2020 2020 2020 2020 2020   = (.           
-0000c040: 2020 2020 2022 4752 4944 2a20 2020 7b3a       "GRID*   {:
-0000c050: 3136 647d 7b3a 3136 647d 2220 2b20 666f  16d}{:16d}" + fo
-0000c060: 726d 202a 2032 202b 2022 5c6e 2a20 2020  rm * 2 + "\n*   
-0000c070: 2020 2020 2220 2b20 666f 726d 202b 2022      " + form + "
-0000c080: 7b3a 3136 647d 5c6e 220a 2020 2020 2020  {:16d}\n".      
-0000c090: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-0000c0a0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-0000c0b0: 2020 7374 7269 6e67 203d 2022 4752 4944    string = "GRID
-0000c0c0: 2020 2020 7b3a 3864 7d7b 3a38 647d 2220      {:8d}{:8d}" 
-0000c0d0: 2b20 666f 726d 202a 2033 202b 2022 7b3a  + form * 3 + "{:
-0000c0e0: 3864 7d5c 6e22 0a20 2020 2020 2020 2077  8d}\n".        w
-0000c0f0: 7269 7465 722e 7665 6377 7269 7465 2866  riter.vecwrite(f
-0000c100: 2c20 7374 7269 6e67 2c20 6772 6964 732c  , string, grids,
-0000c110: 2063 702c 2078 797a 5b3a 2c20 305d 2c20   cp, xyz[:, 0], 
-0000c120: 7879 7a5b 3a2c 2031 5d2c 2078 797a 5b3a  xyz[:, 1], xyz[:
-0000c130: 2c20 325d 2c20 6364 290a 2020 2020 656c  , 2], cd).    el
-0000c140: 7365 3a0a 2020 2020 2020 2020 6966 206c  se:.        if l
-0000c150: 656e 2874 6573 7473 7472 2920 3e20 383a  en(teststr) > 8:
-0000c160: 0a20 2020 2020 2020 2020 2020 2073 7472  .            str
-0000c170: 696e 6720 3d20 280a 2020 2020 2020 2020  ing = (.        
-0000c180: 2020 2020 2020 2020 2247 5249 442a 2020          "GRID*  
-0000c190: 207b 3a31 3664 7d7b 3a31 3664 7d22 0a20   {:16d}{:16d}". 
-0000c1a0: 2020 2020 2020 2020 2020 2020 2020 202b                 +
-0000c1b0: 2066 6f72 6d20 2a20 320a 2020 2020 2020   form * 2.      
-0000c1c0: 2020 2020 2020 2020 2020 2b20 225c 6e2a            + "\n*
-0000c1d0: 2020 2020 2020 2022 0a20 2020 2020 2020         ".       
-0000c1e0: 2020 2020 2020 2020 202b 2066 6f72 6d0a           + form.
-0000c1f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c200: 2b20 227b 3a31 3664 7d7b 3a3e 3136 7d7b  + "{:16d}{:>16}{
-0000c210: 3a3e 3136 7d5c 6e22 0a20 2020 2020 2020  :>16}\n".       
-0000c220: 2020 2020 2029 0a20 2020 2020 2020 2065       ).        e
-0000c230: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0000c240: 2073 7472 696e 6720 3d20 2247 5249 4420   string = "GRID 
-0000c250: 2020 207b 3a38 647d 7b3a 3864 7d22 202b     {:8d}{:8d}" +
-0000c260: 2066 6f72 6d20 2a20 3320 2b20 227b 3a38   form * 3 + "{:8
-0000c270: 647d 7b3a 3e38 7d7b 3a3e 387d 5c6e 220a  d}{:>8}{:>8}\n".
-0000c280: 2020 2020 2020 2020 7772 6974 6572 2e76          writer.v
-0000c290: 6563 7772 6974 6528 0a20 2020 2020 2020  ecwrite(.       
-0000c2a0: 2020 2020 2066 2c20 7374 7269 6e67 2c20       f, string, 
-0000c2b0: 6772 6964 732c 2063 702c 2078 797a 5b3a  grids, cp, xyz[:
-0000c2c0: 2c20 305d 2c20 7879 7a5b 3a2c 2031 5d2c  , 0], xyz[:, 1],
-0000c2d0: 2078 797a 5b3a 2c20 325d 2c20 6364 2c20   xyz[:, 2], cd, 
-0000c2e0: 7073 2c20 7365 6964 0a20 2020 2020 2020  ps, seid.       
-0000c2f0: 2029 0a0a 0a64 6566 2072 6474 6162 6c65   )...def rdtable
-0000c300: 6431 2866 2c20 6e61 6d65 3d22 7461 626c  d1(f, name="tabl
-0000c310: 6564 3122 293a 0a20 2020 2022 2222 0a20  ed1"):.    """. 
-0000c320: 2020 2052 6561 6420 4e61 7374 7261 6e20     Read Nastran 
-0000c330: 5441 424c 4544 3120 6f72 206f 7468 6572  TABLED1 or other
-0000c340: 2069 6465 6e74 6963 616c 6c79 2066 6f72   identically for
-0000c350: 6d61 7474 6564 2063 6172 6473 2066 726f  matted cards fro
-0000c360: 6d20 610a 2020 2020 4e61 7374 7261 6e20  m a.    Nastran 
-0000c370: 6275 6c6b 2066 696c 652e 0a0a 2020 2020  bulk file...    
-0000c380: 5061 7261 6d65 7465 7273 0a20 2020 202d  Parameters.    -
-0000c390: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 6620  ---------.    f 
-0000c3a0: 3a20 7374 7269 6e67 206f 7220 6669 6c65  : string or file
-0000c3b0: 5f6c 696b 6520 6f72 204e 6f6e 650a 2020  _like or None.  
-0000c3c0: 2020 2020 2020 4569 7468 6572 2061 206e        Either a n
-0000c3d0: 616d 6520 6f66 2061 2066 696c 652c 206f  ame of a file, o
-0000c3e0: 7220 6973 2061 2066 696c 655f 6c69 6b65  r is a file_like
-0000c3f0: 206f 626a 6563 7420 6173 2072 6574 7572   object as retur
-0000c400: 6e65 640a 2020 2020 2020 2020 6279 203a  ned.        by :
-0000c410: 6675 6e63 3a60 6f70 656e 602e 2049 6620  func:`open`. If 
-0000c420: 6669 6c65 5f6c 696b 6520 6f62 6a65 6374  file_like object
-0000c430: 2c20 6974 2069 7320 7265 776f 756e 6420  , it is rewound 
-0000c440: 6669 7273 742e 2043 616e 0a20 2020 2020  first. Can.     
-0000c450: 2020 2061 6c73 6f20 6265 2074 6865 206e     also be the n
-0000c460: 616d 6520 6f66 2061 2064 6972 6563 746f  ame of a directo
-0000c470: 7279 206f 7220 4e6f 6e65 3b20 696e 2074  ry or None; in t
-0000c480: 6865 7365 2063 6173 6573 2c20 6120 4755  hese cases, a GU
-0000c490: 490a 2020 2020 2020 2020 6973 206f 7065  I.        is ope
-0000c4a0: 6e65 6420 666f 7220 6669 6c65 2073 656c  ned for file sel
-0000c4b0: 6563 7469 6f6e 2e0a 2020 2020 6e61 6d65  ection..    name
-0000c4c0: 203a 2073 7472 696e 673b 206f 7074 696f   : string; optio
-0000c4d0: 6e61 6c0a 2020 2020 2020 2020 4e61 6d65  nal.        Name
-0000c4e0: 206f 6620 6361 7264 7320 746f 2072 6561   of cards to rea
-0000c4f0: 642e 0a0a 2020 2020 5265 7475 726e 730a  d...    Returns.
-0000c500: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
-0000c510: 6463 7420 3a20 6469 6374 696f 6e61 7279  dct : dictionary
-0000c520: 0a20 2020 2020 2020 2044 6963 7469 6f6e  .        Diction
-0000c530: 6172 7920 6f66 2054 4142 4c45 4431 2028  ary of TABLED1 (
-0000c540: 6f72 2073 696d 696c 6172 2920 6361 7264  or similar) card
-0000c550: 733a 0a0a 2020 2020 2020 2020 2e2e 2063  s:..        .. c
-0000c560: 6f64 652d 626c 6f63 6b3a 3a20 6e6f 6e65  ode-block:: none
-0000c570: 0a0a 2020 2020 2020 2020 2020 2020 7b49  ..            {I
-0000c580: 4431 3a20 5b74 696d 652c 2064 6174 615d  D1: [time, data]
-0000c590: 2c0a 2020 2020 2020 2020 2020 2020 2049  ,.             I
-0000c5a0: 4432 3a20 5b74 696d 652c 2064 6174 615d  D2: [time, data]
-0000c5b0: 2c20 2e2e 2e7d 0a0a 2020 2020 4e6f 7465  , ...}..    Note
-0000c5c0: 730a 2020 2020 2d2d 2d2d 2d0a 2020 2020  s.    -----.    
-0000c5d0: 5468 6973 2072 6f75 7469 6e65 2075 7365  This routine use
-0000c5e0: 7320 3a66 756e 633a 6072 6463 6172 6473  s :func:`rdcards
-0000c5f0: 6020 746f 206c 6f61 6420 7468 6520 6461  ` to load the da
-0000c600: 7461 2028 6361 6e20 7265 6164 2038 0a20  ta (can read 8. 
-0000c610: 2020 206f 7220 3136 2066 6978 6564 2066     or 16 fixed f
-0000c620: 6965 6c64 206f 7220 636f 6d6d 612d 6465  ield or comma-de
-0000c630: 6c69 6d69 7465 6429 2e0a 0a20 2020 2053  limited)...    S
-0000c640: 6565 2061 6c73 6f0a 2020 2020 2d2d 2d2d  ee also.    ----
-0000c650: 2d2d 2d2d 0a20 2020 203a 6675 6e63 3a60  ----.    :func:`
-0000c660: 7774 7461 626c 6564 3160 0a0a 2020 2020  wttabled1`..    
-0000c670: 4578 616d 706c 6573 0a20 2020 202d 2d2d  Examples.    ---
-0000c680: 2d2d 2d2d 2d0a 2020 2020 3e3e 3e20 6672  -----.    >>> fr
-0000c690: 6f6d 2070 7979 6574 6920 696d 706f 7274  om pyyeti import
-0000c6a0: 206e 6173 7472 616e 0a20 2020 203e 3e3e   nastran.    >>>
-0000c6b0: 2069 6d70 6f72 7420 6e75 6d70 7920 6173   import numpy as
-0000c6c0: 206e 700a 2020 2020 3e3e 3e20 6672 6f6d   np.    >>> from
-0000c6d0: 2069 6f20 696d 706f 7274 2053 7472 696e   io import Strin
-0000c6e0: 6749 4f0a 2020 2020 3e3e 3e20 7420 3d20  gIO.    >>> t = 
-0000c6f0: 6e70 2e61 7261 6e67 6528 302c 2031 2c20  np.arange(0, 1, 
-0000c700: 2e30 3529 0a20 2020 203e 3e3e 2064 203d  .05).    >>> d =
-0000c710: 206e 702e 7369 6e28 322a 6e70 2e70 692a   np.sin(2*np.pi*
-0000c720: 332a 7429 0a20 2020 203e 3e3e 2077 6974  3*t).    >>> wit
-0000c730: 6820 5374 7269 6e67 494f 2829 2061 7320  h StringIO() as 
-0000c740: 663a 0a20 2020 202e 2e2e 2020 2020 206e  f:.    ...     n
-0000c750: 6173 7472 616e 2e77 7474 6162 6c65 6431  astran.wttabled1
-0000c760: 2866 2c20 3430 3030 2c20 742c 2064 2c20  (f, 4000, t, d, 
-0000c770: 2733 2048 7a20 5369 6e65 2057 6176 6527  '3 Hz Sine Wave'
-0000c780: 2c0a 2020 2020 2e2e 2e20 2020 2020 2020  ,.    ...       
-0000c790: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c7a0: 666f 726d 3d27 7b3a 382e 3266 7d7b 3a38  form='{:8.2f}{:8
-0000c7b0: 2e35 667d 2729 0a20 2020 202e 2e2e 2020  .5f}').    ...  
-0000c7c0: 2020 2064 6374 203d 206e 6173 7472 616e     dct = nastran
-0000c7d0: 2e72 6474 6162 6c65 6431 2866 290a 2020  .rdtabled1(f).  
-0000c7e0: 2020 3e3e 3e20 6e70 2e61 6c6c 636c 6f73    >>> np.allclos
-0000c7f0: 6528 742c 2064 6374 5b34 3030 305d 5b3a  e(t, dct[4000][:
-0000c800: 2c20 305d 290a 2020 2020 5472 7565 0a20  , 0]).    True. 
-0000c810: 2020 203e 3e3e 206e 702e 616c 6c63 6c6f     >>> np.allclo
-0000c820: 7365 2864 2c20 6463 745b 3430 3030 5d5b  se(d, dct[4000][
-0000c830: 3a2c 2031 5d29 0a20 2020 2054 7275 650a  :, 1]).    True.
-0000c840: 2020 2020 2222 220a 2020 2020 6420 3d20      """.    d = 
-0000c850: 7264 6361 7264 7328 662c 206e 616d 652c  rdcards(f, name,
-0000c860: 2072 6574 7572 6e5f 7661 723d 2264 6963   return_var="dic
-0000c870: 7422 290a 2020 2020 666f 7220 7469 6420  t").    for tid 
-0000c880: 696e 2064 3a0a 2020 2020 2020 2020 7665  in d:.        ve
-0000c890: 6320 3d20 645b 7469 645d 0a20 2020 2020  c = d[tid].     
-0000c8a0: 2020 2064 5b74 6964 5d20 3d20 6e70 2e76     d[tid] = np.v
-0000c8b0: 7374 6163 6b28 5b76 6563 5b38 3a2d 313a  stack([vec[8:-1:
-0000c8c0: 325d 2c20 7665 635b 393a 2d31 3a32 5d5d  2], vec[9:-1:2]]
-0000c8d0: 292e 540a 2020 2020 7265 7475 726e 2064  ).T.    return d
-0000c8e0: 0a0a 0a40 6775 6974 6f6f 6c73 2e77 7269  ...@guitools.wri
-0000c8f0: 7465 5f74 6578 745f 6669 6c65 0a64 6566  te_text_file.def
-0000c900: 2077 7474 6162 6c65 6431 2866 2c20 7469   wttabled1(f, ti
-0000c910: 642c 2074 2c20 642c 2074 6974 6c65 3d4e  d, t, d, title=N
-0000c920: 6f6e 652c 2066 6f72 6d3d 227b 3a31 362e  one, form="{:16.
-0000c930: 3945 7d7b 3a31 362e 3945 7d22 2c20 7461  9E}{:16.9E}", ta
-0000c940: 626c 6573 7472 3d22 5441 424c 4544 3122  blestr="TABLED1"
-0000c950: 293a 0a20 2020 2022 2222 0a20 2020 2057  ):.    """.    W
-0000c960: 7269 7465 7320 6120 4e61 7374 7261 6e20  rites a Nastran 
-0000c970: 5441 424c 4544 3120 286f 7220 7369 6d69  TABLED1 (or simi
-0000c980: 6c61 7229 2063 6172 6420 746f 2061 2066  lar) card to a f
-0000c990: 696c 652e 0a0a 2020 2020 5061 7261 6d65  ile...    Parame
-0000c9a0: 7465 7273 0a20 2020 202d 2d2d 2d2d 2d2d  ters.    -------
-0000c9b0: 2d2d 2d0a 2020 2020 6620 3a20 7374 7269  ---.    f : stri
-0000c9c0: 6e67 206f 7220 6669 6c65 5f6c 696b 6520  ng or file_like 
-0000c9d0: 6f72 2031 206f 7220 4e6f 6e65 0a20 2020  or 1 or None.   
-0000c9e0: 2020 2020 2045 6974 6865 7220 6120 6e61       Either a na
-0000c9f0: 6d65 206f 6620 6120 6669 6c65 2c20 6f72  me of a file, or
-0000ca00: 2069 7320 6120 6669 6c65 5f6c 696b 6520   is a file_like 
-0000ca10: 6f62 6a65 6374 2061 7320 7265 7475 726e  object as return
-0000ca20: 6564 0a20 2020 2020 2020 2062 7920 3a66  ed.        by :f
-0000ca30: 756e 633a 606f 7065 6e60 206f 7220 3a63  unc:`open` or :c
-0000ca40: 6c61 7373 3a60 696f 2e53 7472 696e 6749  lass:`io.StringI
-0000ca50: 4f60 2e20 496e 7075 7420 6173 2069 6e74  O`. Input as int
-0000ca60: 6567 6572 2031 2074 6f0a 2020 2020 2020  eger 1 to.      
-0000ca70: 2020 7772 6974 6520 746f 2073 7464 6f75    write to stdou
-0000ca80: 742e 2043 616e 2061 6c73 6f20 6265 2074  t. Can also be t
-0000ca90: 6865 206e 616d 6520 6f66 2061 2064 6972  he name of a dir
-0000caa0: 6563 746f 7279 206f 7220 4e6f 6e65 3b0a  ectory or None;.
-0000cab0: 2020 2020 2020 2020 696e 2074 6865 7365          in these
-0000cac0: 2063 6173 6573 2c20 6120 4755 4920 6973   cases, a GUI is
-0000cad0: 206f 7065 6e65 6420 666f 7220 6669 6c65   opened for file
-0000cae0: 2073 656c 6563 7469 6f6e 2e0a 2020 2020   selection..    
-0000caf0: 7469 6420 3a20 696e 7465 6765 720a 2020  tid : integer.  
-0000cb00: 2020 2020 2020 4944 2066 6f72 2054 4142        ID for TAB
-0000cb10: 4c45 4431 2063 6172 640a 2020 2020 7420  LED1 card.    t 
-0000cb20: 3a20 3164 2061 7272 6179 5f6c 696b 650a  : 1d array_like.
-0000cb30: 2020 2020 2020 2020 7469 6d65 2076 6563          time vec
-0000cb40: 746f 720a 2020 2020 6420 3a20 3164 2061  tor.    d : 1d a
-0000cb50: 7272 6179 5f6c 696b 650a 2020 2020 2020  rray_like.      
-0000cb60: 2020 6461 7461 2076 6563 746f 720a 2020    data vector.  
-0000cb70: 2020 7469 746c 6520 3a20 7374 7269 6e67    title : string
-0000cb80: 206f 7220 4e6f 6e65 3b20 6f70 7469 6f6e   or None; option
-0000cb90: 616c 0a20 2020 2020 2020 2049 6620 6120  al.        If a 
-0000cba0: 7374 7269 6e67 2c20 6974 2069 7320 7772  string, it is wr
-0000cbb0: 6974 7465 6e20 6173 2061 2063 6f6d 6d65  itten as a comme
-0000cbc0: 6e74 2062 6566 6f72 6520 7461 626c 652e  nt before table.
-0000cbd0: 2049 6620 4e6f 6e65 2c0a 2020 2020 2020   If None,.      
-0000cbe0: 2020 6e6f 2073 7472 696e 6720 6973 2077    no string is w
-0000cbf0: 7269 7474 656e 2e0a 2020 2020 666f 726d  ritten..    form
-0000cc00: 203a 2073 7472 696e 673b 206f 7074 696f   : string; optio
-0000cc10: 6e61 6c0a 2020 2020 2020 2020 5374 7269  nal.        Stri
-0000cc20: 6e67 2073 7065 6369 6679 696e 6720 7468  ng specifying th
-0000cc30: 6520 666f 726d 6174 206f 6620 6120 7369  e format of a si
-0000cc40: 6e67 6c65 205b 7469 6d65 2c20 6461 7461  ngle [time, data
-0000cc50: 5d20 7061 6972 2e0a 2020 2020 2020 2020  ] pair..        
-0000cc60: 4578 7065 6374 6564 2074 6f20 7265 7375  Expected to resu
-0000cc70: 6c74 2069 6e20 6120 7374 7269 6e67 2065  lt in a string e
-0000cc80: 6974 6865 7220 3136 206f 7220 3332 2063  ither 16 or 32 c
-0000cc90: 6861 7261 6374 6572 730a 2020 2020 2020  haracters.      
-0000cca0: 2020 6c6f 6e67 2e0a 2020 2020 7461 626c    long..    tabl
-0000ccb0: 6573 7472 203a 2073 7472 696e 673b 206f  estr : string; o
-0000ccc0: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
-0000ccd0: 4e61 6d65 206f 6620 6361 7264 2074 6f20  Name of card to 
-0000cce0: 7772 6974 653b 206d 7573 7420 6265 2073  write; must be s
-0000ccf0: 616d 6520 666f 726d 6174 2061 7320 5441  ame format as TA
-0000cd00: 424c 4544 312e 0a0a 2020 2020 5265 7475  BLED1...    Retu
-0000cd10: 726e 730a 2020 2020 2d2d 2d2d 2d2d 2d0a  rns.    -------.
-0000cd20: 2020 2020 4e6f 6e65 0a0a 2020 2020 4e6f      None..    No
-0000cd30: 7465 730a 2020 2020 2d2d 2d2d 2d0a 2020  tes.    -----.  
-0000cd40: 2020 496e 2074 6865 2066 6f72 6d61 7420    In the format 
-0000cd50: 7374 7269 6e67 2c20 696e 636c 7564 6520  string, include 
-0000cd60: 6120 2320 7369 676e 2074 6f20 666f 7263  a # sign to forc
-0000cd70: 6520 6120 6465 6369 6d61 6c20 706f 696e  e a decimal poin
-0000cd80: 7420 746f 0a20 2020 2061 7070 6561 7220  t to.    appear 
-0000cd90: 7769 7468 6f75 7420 7472 6169 6c69 6e67  without trailing
-0000cda0: 2064 6967 6974 732e 2046 6f72 2065 7861   digits. For exa
-0000cdb0: 6d70 6c65 2c20 277b 3a38 2e32 667d 7b3a  mple, '{:8.2f}{:
-0000cdc0: 2338 2e30 667d 270a 2020 2020 776f 756c  #8.0f}'.    woul
-0000cdd0: 6420 7072 696e 7420 6c69 6b65 2074 6869  d print like thi
-0000cde0: 733a 2027 2031 322e 3334 2031 3233 3435  s: ' 12.34 12345
-0000cdf0: 362e 272e 0a0a 2020 2020 5365 6520 616c  6.'...    See al
-0000ce00: 736f 0a20 2020 202d 2d2d 2d2d 2d2d 2d0a  so.    --------.
-0000ce10: 2020 2020 3a66 756e 633a 6072 6474 6162      :func:`rdtab
-0000ce20: 6c65 6431 600a 0a20 2020 2045 7861 6d70  led1`..    Examp
-0000ce30: 6c65 730a 2020 2020 2d2d 2d2d 2d2d 2d2d  les.    --------
-0000ce40: 0a20 2020 203e 3e3e 2066 726f 6d20 7079  .    >>> from py
-0000ce50: 7965 7469 2069 6d70 6f72 7420 6e61 7374  yeti import nast
-0000ce60: 7261 6e0a 2020 2020 3e3e 3e20 696d 706f  ran.    >>> impo
-0000ce70: 7274 206e 756d 7079 2061 7320 6e70 0a20  rt numpy as np. 
-0000ce80: 2020 203e 3e3e 2074 203d 206e 702e 6172     >>> t = np.ar
-0000ce90: 616e 6765 2830 2c20 2e39 312c 202e 3035  ange(0, .91, .05
-0000cea0: 290a 2020 2020 3e3e 3e20 6420 3d20 6e70  ).    >>> d = np
-0000ceb0: 2e73 696e 2832 2a6e 702e 7069 2a33 2a74  .sin(2*np.pi*3*t
-0000cec0: 290a 2020 2020 3e3e 3e20 6e61 7374 7261  ).    >>> nastra
-0000ced0: 6e2e 7774 7461 626c 6564 3128 312c 2034  n.wttabled1(1, 4
-0000cee0: 3030 302c 2074 2c20 642c 2027 3320 487a  000, t, d, '3 Hz
-0000cef0: 2053 696e 6520 5761 7665 272c 0a20 2020   Sine Wave',.   
-0000cf00: 202e 2e2e 2020 2020 2020 2020 2020 2020   ...            
-0000cf10: 2020 2020 2020 2066 6f72 6d3d 277b 3a38         form='{:8
-0000cf20: 2e32 667d 7b3a 382e 3566 7d27 290a 2020  .2f}{:8.5f}').  
-0000cf30: 2020 2420 3320 487a 2053 696e 6520 5761    $ 3 Hz Sine Wa
-0000cf40: 7665 0a20 2020 2054 4142 4c45 4431 2020  ve.    TABLED1  
-0000cf50: 2020 2034 3030 300a 2020 2020 2020 2020     4000.        
-0000cf60: 2020 2020 2020 2020 302e 3030 2030 2e30          0.00 0.0
-0000cf70: 3030 3030 2020 2020 302e 3035 2030 2e38  0000    0.05 0.8
-0000cf80: 3039 3032 2020 2020 302e 3130 2030 2e39  0902    0.10 0.9
-0000cf90: 3531 3036 2020 2020 302e 3135 2030 2e33  5106    0.15 0.3
-0000cfa0: 3039 3032 0a20 2020 2020 2020 2020 2020  0902.           
-0000cfb0: 2020 2020 2030 2e32 302d 302e 3538 3737       0.20-0.5877
-0000cfc0: 3920 2020 2030 2e32 352d 312e 3030 3030  9    0.25-1.0000
-0000cfd0: 3020 2020 2030 2e33 302d 302e 3538 3737  0    0.30-0.5877
-0000cfe0: 3920 2020 2030 2e33 3520 302e 3330 3930  9    0.35 0.3090
-0000cff0: 320a 2020 2020 2020 2020 2020 2020 2020  2.              
-0000d000: 2020 302e 3430 2030 2e39 3531 3036 2020    0.40 0.95106  
-0000d010: 2020 302e 3435 2030 2e38 3039 3032 2020    0.45 0.80902  
-0000d020: 2020 302e 3530 2030 2e30 3030 3030 2020    0.50 0.00000  
-0000d030: 2020 302e 3535 2d30 2e38 3039 3032 0a20    0.55-0.80902. 
-0000d040: 2020 2020 2020 2020 2020 2020 2020 2030                 0
-0000d050: 2e36 302d 302e 3935 3130 3620 2020 2030  .60-0.95106    0
-0000d060: 2e36 352d 302e 3330 3930 3220 2020 2030  .65-0.30902    0
-0000d070: 2e37 3020 302e 3538 3737 3920 2020 2030  .70 0.58779    0
-0000d080: 2e37 3520 312e 3030 3030 300a 2020 2020  .75 1.00000.    
-0000d090: 2020 2020 2020 2020 2020 2020 302e 3830              0.80
-0000d0a0: 2030 2e35 3837 3739 2020 2020 302e 3835   0.58779    0.85
-0000d0b0: 2d30 2e33 3039 3032 2020 2020 302e 3930  -0.30902    0.90
-0000d0c0: 2d30 2e39 3531 3036 454e 4454 0a20 2020  -0.95106ENDT.   
-0000d0d0: 203e 3e3e 206e 6173 7472 616e 2e77 7474   >>> nastran.wtt
-0000d0e0: 6162 6c65 6431 2831 2c20 3430 3030 2c20  abled1(1, 4000, 
-0000d0f0: 5b31 2c20 322c 2033 5d2c 205b 312c 2032  [1, 2, 3], [1, 2
-0000d100: 2c20 335d 2c0a 2020 2020 2e2e 2e20 2020  , 3],.    ...   
-0000d110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d120: 666f 726d 3d27 7b3a 3136 2e32 667d 7b3a  form='{:16.2f}{:
-0000d130: 3136 2e35 667d 2729 0a20 2020 2054 4142  16.5f}').    TAB
-0000d140: 4c45 4431 2a20 2020 2020 2020 2020 2020  LED1*           
-0000d150: 2034 3030 300a 2020 2020 2a0a 2020 2020   4000.    *.    
-0000d160: 2a20 2020 2020 2020 2020 2020 2020 2020  *               
-0000d170: 2020 2020 312e 3030 2020 2020 2020 2020      1.00        
-0000d180: 2031 2e30 3030 3030 2020 2020 2020 2020   1.00000        
-0000d190: 2020 2020 322e 3030 2020 2020 2020 2020      2.00        
-0000d1a0: 2032 2e30 3030 3030 0a20 2020 202a 2020   2.00000.    *  
-0000d1b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d1c0: 2033 2e30 3020 2020 2020 2020 2020 332e   3.00         3.
-0000d1d0: 3030 3030 3045 4e44 540a 2020 2020 2222  00000ENDT.    ""
-0000d1e0: 220a 2020 2020 742c 2064 203d 206e 702e  ".    t, d = np.
-0000d1f0: 6174 6c65 6173 745f 3164 2874 2c20 6429  atleast_1d(t, d)
-0000d200: 0a20 2020 2074 203d 2074 2e72 6176 656c  .    t = t.ravel
-0000d210: 2829 0a20 2020 2064 203d 2064 2e72 6176  ().    d = d.rav
-0000d220: 656c 2829 0a20 2020 206e 7074 7320 3d20  el().    npts = 
-0000d230: 6c65 6e28 7429 0a20 2020 2069 6620 6c65  len(t).    if le
-0000d240: 6e28 6429 2021 3d20 6e70 7473 3a0a 2020  n(d) != npts:.  
-0000d250: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-0000d260: 6545 7272 6f72 2866 226c 656e 2864 2920  eError(f"len(d) 
-0000d270: 6973 207b 6c65 6e28 6429 7d20 6275 7420  is {len(d)} but 
-0000d280: 6c65 6e28 7429 2069 7320 7b6e 7074 737d  len(t) is {npts}
-0000d290: 2229 0a0a 2020 2020 2320 6465 7465 726d  ")..    # determ
-0000d2a0: 696e 6520 6966 2075 7369 6e67 2073 696e  ine if using sin
-0000d2b0: 676c 6520 6f72 2064 6f75 626c 6520 6669  gle or double fi
-0000d2c0: 656c 643a 0a20 2020 206e 203d 206c 656e  eld:.    n = len
-0000d2d0: 2866 6f72 6d2e 666f 726d 6174 2831 2c20  (form.format(1, 
-0000d2e0: 3129 290a 2020 2020 6966 206e 2021 3d20  1)).    if n != 
-0000d2f0: 3136 2061 6e64 206e 2021 3d20 3332 3a0a  16 and n != 32:.
-0000d300: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-0000d310: 6c75 6545 7272 6f72 2866 2260 666f 726d  lueError(f"`form
-0000d320: 6020 7072 6f64 7563 6573 2061 207b 6e7d  ` produces a {n}
-0000d330: 206c 656e 6774 6820 7374 7269 6e67 2e20   length string. 
-0000d340: 4974 206d 7573 7420 6265 2031 3620 6f72  It must be 16 or
-0000d350: 2033 322e 2229 0a20 2020 2069 6620 7469   32.").    if ti
-0000d360: 746c 653a 0a20 2020 2020 2020 2066 2e77  tle:.        f.w
-0000d370: 7269 7465 2866 2224 207b 7469 746c 653a  rite(f"$ {title:
-0000d380: 737d 5c6e 2229 0a20 2020 2069 6620 6e20  s}\n").    if n 
-0000d390: 3d3d 2033 323a 0a20 2020 2020 2020 2074  == 32:.        t
-0000d3a0: 6162 6c65 7374 7220 3d20 7461 626c 6573  ablestr = tables
-0000d3b0: 7472 202b 2022 2a22 0a20 2020 2020 2020  tr + "*".       
-0000d3c0: 2066 2e77 7269 7465 2866 227b 7461 626c   f.write(f"{tabl
-0000d3d0: 6573 7472 3a3c 3873 7d7b 7469 643a 3136  estr:<8s}{tid:16
-0000d3e0: 647d 5c6e 2a5c 6e22 290a 2020 2020 2020  d}\n*\n").      
-0000d3f0: 2020 726f 7773 203d 206e 7074 7320 2f2f    rows = npts //
-0000d400: 2032 0a20 2020 2020 2020 2072 203d 2072   2.        r = r
-0000d410: 6f77 7320 2a20 320a 2020 2020 2020 2020  ows * 2.        
-0000d420: 7772 6974 6572 2e76 6563 7772 6974 6528  writer.vecwrite(
-0000d430: 0a20 2020 2020 2020 2020 2020 2066 2c20  .            f, 
-0000d440: 222a 2020 2020 2020 2022 202b 2066 6f72  "*       " + for
-0000d450: 6d20 2a20 3220 2b20 225c 6e22 2c20 745b  m * 2 + "\n", t[
-0000d460: 3a72 3a32 5d2c 2064 5b3a 723a 325d 2c20  :r:2], d[:r:2], 
-0000d470: 745b 313a 723a 325d 2c20 645b 313a 723a  t[1:r:2], d[1:r:
-0000d480: 325d 0a20 2020 2020 2020 2029 0a20 2020  2].        ).   
-0000d490: 2020 2020 2066 2e77 7269 7465 2822 2a20       f.write("* 
-0000d4a0: 2020 2020 2020 2229 0a20 2020 2020 2020        ").       
-0000d4b0: 2066 6f72 206a 2069 6e20 7261 6e67 6528   for j in range(
-0000d4c0: 722c 206e 7074 7329 3a0a 2020 2020 2020  r, npts):.      
-0000d4d0: 2020 2020 2020 662e 7772 6974 6528 666f        f.write(fo
-0000d4e0: 726d 2e66 6f72 6d61 7428 745b 6a5d 2c20  rm.format(t[j], 
-0000d4f0: 645b 6a5d 2929 0a20 2020 2065 6c73 653a  d[j])).    else:
-0000d500: 0a20 2020 2020 2020 2066 2e77 7269 7465  .        f.write
-0000d510: 2866 227b 7461 626c 6573 7472 3a3c 3873  (f"{tablestr:<8s
-0000d520: 7d7b 7469 643a 3864 7d5c 6e22 290a 2020  }{tid:8d}\n").  
-0000d530: 2020 2020 2020 726f 7773 203d 206e 7074        rows = npt
-0000d540: 7320 2f2f 2034 0a20 2020 2020 2020 2072  s // 4.        r
-0000d550: 203d 2072 6f77 7320 2a20 340a 2020 2020   = rows * 4.    
-0000d560: 2020 2020 7772 6974 6572 2e76 6563 7772      writer.vecwr
-0000d570: 6974 6528 0a20 2020 2020 2020 2020 2020  ite(.           
-0000d580: 2066 2c0a 2020 2020 2020 2020 2020 2020   f,.            
-0000d590: 2220 2020 2020 2020 2022 202b 2066 6f72  "        " + for
-0000d5a0: 6d20 2a20 3420 2b20 225c 6e22 2c0a 2020  m * 4 + "\n",.  
-0000d5b0: 2020 2020 2020 2020 2020 745b 3a72 3a34            t[:r:4
-0000d5c0: 5d2c 0a20 2020 2020 2020 2020 2020 2064  ],.            d
-0000d5d0: 5b3a 723a 345d 2c0a 2020 2020 2020 2020  [:r:4],.        
-0000d5e0: 2020 2020 745b 313a 723a 345d 2c0a 2020      t[1:r:4],.  
-0000d5f0: 2020 2020 2020 2020 2020 645b 313a 723a            d[1:r:
-0000d600: 345d 2c0a 2020 2020 2020 2020 2020 2020  4],.            
-0000d610: 745b 323a 723a 345d 2c0a 2020 2020 2020  t[2:r:4],.      
-0000d620: 2020 2020 2020 645b 323a 723a 345d 2c0a        d[2:r:4],.
-0000d630: 2020 2020 2020 2020 2020 2020 745b 333a              t[3:
-0000d640: 723a 345d 2c0a 2020 2020 2020 2020 2020  r:4],.          
-0000d650: 2020 645b 333a 723a 345d 2c0a 2020 2020    d[3:r:4],.    
-0000d660: 2020 2020 290a 2020 2020 2020 2020 662e      ).        f.
-0000d670: 7772 6974 6528 2220 2020 2020 2020 2022  write("        "
-0000d680: 290a 2020 2020 2020 2020 666f 7220 6a20  ).        for j 
-0000d690: 696e 2072 616e 6765 2872 2c20 6e70 7473  in range(r, npts
-0000d6a0: 293a 0a20 2020 2020 2020 2020 2020 2066  ):.            f
-0000d6b0: 2e77 7269 7465 2866 6f72 6d2e 666f 726d  .write(form.form
-0000d6c0: 6174 2874 5b6a 5d2c 2064 5b6a 5d29 290a  at(t[j], d[j])).
-0000d6d0: 2020 2020 662e 7772 6974 6528 2245 4e44      f.write("END
-0000d6e0: 545c 6e22 290a 0a0a 6465 6620 6275 6c6b  T\n")...def bulk
-0000d6f0: 3275 7365 7428 2a61 7267 7329 3a0a 2020  2uset(*args):.  
-0000d700: 2020 2222 220a 2020 2020 5265 6164 2043    """.    Read C
-0000d710: 4f52 4432 2a20 616e 6420 4752 4944 2063  ORD2* and GRID c
-0000d720: 6172 6473 2066 726f 6d20 6669 6c65 2873  ards from file(s
-0000d730: 2920 746f 206d 616b 6520 6120 5553 4554  ) to make a USET
-0000d740: 2074 6162 6c65 0a0a 2020 2020 5061 7261   table..    Para
-0000d750: 6d65 7465 7273 0a20 2020 202d 2d2d 2d2d  meters.    -----
-0000d760: 2d2d 2d2d 2d0a 2020 2020 2a61 7267 730a  -----.    *args.
-0000d770: 2020 2020 2020 2020 4669 6c65 206e 616d          File nam
-0000d780: 6573 206f 7220 6669 6c65 2068 616e 646c  es or file handl
-0000d790: 6573 2061 7320 7265 7475 726e 6564 2062  es as returned b
-0000d7a0: 7920 3a66 756e 633a 606f 7065 6e60 2e20  y :func:`open`. 
-0000d7b0: 4669 6c65 730a 2020 2020 2020 2020 7265  Files.        re
-0000d7c0: 6665 7272 6564 2074 6f20 6279 2068 616e  ferred to by han
-0000d7d0: 646c 6520 6172 6520 7265 776f 756e 6420  dle are rewound 
-0000d7e0: 6669 7273 742e 2041 2047 5549 2069 7320  first. A GUI is 
-0000d7f0: 6f70 656e 2066 6f72 0a20 2020 2020 2020  open for.       
-0000d800: 2066 696c 6520 7365 6c65 6374 696f 6e20   file selection 
-0000d810: 6966 206e 6f20 6172 6775 6d65 6e74 7320  if no arguments 
-0000d820: 6172 6520 7072 6f76 6964 6564 206f 7220  are provided or 
-0000d830: 6966 2061 6e20 6172 6775 6d65 6e74 0a20  if an argument. 
-0000d840: 2020 2020 2020 2069 7320 6569 7468 6572         is either
-0000d850: 2061 2064 6972 6563 746f 7279 206e 616d   a directory nam
-0000d860: 6520 6f72 204e 6f6e 652e 0a0a 2020 2020  e or None...    
-0000d870: 5265 7475 726e 730a 2020 2020 2d2d 2d2d  Returns.    ----
-0000d880: 2d2d 2d0a 2020 2020 7573 6574 203a 2070  ---.    uset : p
-0000d890: 616e 6461 7320 4461 7461 4672 616d 650a  andas DataFrame.
-0000d8a0: 2020 2020 2020 2020 4120 4461 7461 4672          A DataFr
-0000d8b0: 616d 6520 6173 206f 7574 7075 7420 6279  ame as output by
-0000d8c0: 0a20 2020 2020 2020 203a 6675 6e63 3a60  .        :func:`
-0000d8d0: 7079 7965 7469 2e6e 6173 7472 616e 2e6f  pyyeti.nastran.o
-0000d8e0: 7032 2e4f 5032 2e72 646e 3263 6f70 3260  p2.OP2.rdn2cop2`
-0000d8f0: 0a20 2020 2063 6f6f 7264 7265 6620 3a20  .    coordref : 
-0000d900: 6469 6374 696f 6e61 7279 0a20 2020 2020  dictionary.     
-0000d910: 2020 2044 6963 7469 6f6e 6172 7920 7769     Dictionary wi
-0000d920: 7468 2074 6865 206b 6579 7320 6265 696e  th the keys bein
-0000d930: 6720 7468 6520 636f 6f72 6469 6e61 7465  g the coordinate
-0000d940: 2073 7973 7465 6d20 6964 2061 6e64 0a20   system id and. 
-0000d950: 2020 2020 2020 2074 6865 2076 616c 7565         the value
-0000d960: 7320 6265 696e 6720 7468 6520 3578 3320  s being the 5x3 
-0000d970: 6d61 7472 6978 3a3a 0a0a 2020 2020 2020  matrix::..      
-0000d980: 2020 2020 2020 5b69 6420 2074 7970 6520        [id  type 
-0000d990: 305d 2020 2320 6f75 7470 7574 2063 6f6f  0]  # output coo
-0000d9a0: 7264 2e20 7379 732e 2069 6420 616e 6420  rd. sys. id and 
-0000d9b0: 7479 7065 0a20 2020 2020 2020 2020 2020  type.           
-0000d9c0: 205b 786f 2020 796f 2020 7a6f 5d20 2023   [xo  yo  zo]  #
-0000d9d0: 206f 7269 6769 6e20 6f66 2063 6f6f 7264   origin of coord
-0000d9e0: 2e20 7379 7374 656d 0a20 2020 2020 2020  . system.       
-0000d9f0: 2020 2020 205b 2020 2020 5420 2020 2020       [    T     
-0000da00: 5d20 2023 2033 7833 2074 7261 6e73 666f  ]  # 3x3 transfo
-0000da10: 726d 6174 696f 6e20 746f 2062 6173 6963  rmation to basic
-0000da20: 0a20 2020 2020 2020 2020 2020 204e 6f74  .            Not
-0000da30: 6520 7468 6174 2054 2069 7320 666f 7220  e that T is for 
-0000da40: 7468 6520 636f 6f72 6469 6e61 7465 2073  the coordinate s
-0000da50: 7973 7465 6d2c 206e 6f74 2061 2067 7269  ystem, not a gri
-0000da60: 640a 2020 2020 2020 2020 2020 2020 2875  d.            (u
-0000da70: 6e6c 6573 7320 7479 7065 203d 2031 2077  nless type = 1 w
-0000da80: 6869 6368 206d 6561 6e73 2072 6563 7461  hich means recta
-0000da90: 6e67 756c 6172 290a 0a20 2020 204e 6f74  ngular)..    Not
-0000daa0: 6573 0a20 2020 202d 2d2d 2d2d 0a20 2020  es.    -----.   
-0000dab0: 2054 6869 7320 6973 2074 6865 2072 6576   This is the rev
-0000dac0: 6572 7365 206f 6620 3a66 756e 633a 6075  erse of :func:`u
-0000dad0: 7365 7432 6275 6c6b 602e 0a0a 2020 2020  set2bulk`...    
-0000dae0: 4e6f 7465 2074 6861 7420 3a66 756e 633a  Note that :func:
-0000daf0: 6061 736d 3275 7365 7460 2069 7320 7369  `asm2uset` is si
-0000db00: 6d69 6c61 7220 746f 2074 6869 7320 726f  milar to this ro
-0000db10: 7574 696e 6520 6275 7420 7772 6974 7465  utine but writte
-0000db20: 6e0a 2020 2020 7370 6563 6966 6963 616c  n.    specifical
-0000db30: 6c79 2066 6f72 204e 6173 7472 616e 202e  ly for Nastran .
-0000db40: 6173 6d20 6669 6c65 732e 2054 6861 7420  asm files. That 
-0000db50: 726f 7574 696e 6520 7769 6c6c 2072 6574  routine will ret
-0000db60: 7572 6e20 610a 2020 2020 5553 4554 2074  urn a.    USET t
-0000db70: 6162 6c65 206f 7264 6572 6564 2074 6f20  able ordered to 
-0000db80: 6d61 7463 6820 7468 6520 6d6f 6465 6c20  match the model 
-0000db90: 2861 6363 6f72 6469 6e67 2074 6f20 7468  (according to th
-0000dba0: 6520 5345 434f 4e43 540a 2020 2020 6361  e SECONCT.    ca
-0000dbb0: 7264 293b 2069 7420 616c 736f 2072 6574  rd); it also ret
-0000dbc0: 7572 6e73 2061 2062 2d73 6574 2062 6f6f  urns a b-set boo
-0000dbd0: 6c65 616e 2070 6172 7469 7469 6f6e 2076  lean partition v
-0000dbe0: 6563 746f 722e 0a0a 2020 2020 416c 6c20  ector...    All 
-0000dbf0: 6772 6964 7320 6172 6520 7075 7420 696e  grids are put in
-0000dc00: 2074 6865 2027 6227 2073 6574 2e20 5468   the 'b' set. Th
-0000dc10: 6973 2072 6f75 7469 6e65 2075 7365 730a  is routine uses.
-0000dc20: 2020 2020 3a66 756e 633a 6070 7979 6574      :func:`pyyet
-0000dc30: 692e 6e61 7374 7261 6e2e 6e32 702e 6164  i.nastran.n2p.ad
-0000dc40: 6467 7269 6460 2074 6f20 6275 696c 6420  dgrid` to build 
-0000dc50: 7468 6520 6f75 7470 7574 2e0a 0a20 2020  the output...   
-0000dc60: 2053 6565 2061 6c73 6f0a 2020 2020 2d2d   See also.    --
-0000dc70: 2d2d 2d2d 2d2d 0a20 2020 203a 6675 6e63  ------.    :func
-0000dc80: 3a60 6173 6d32 7573 6574 602c 203a 6675  :`asm2uset`, :fu
-0000dc90: 6e63 3a60 7573 6574 3262 756c 6b60 2c20  nc:`uset2bulk`, 
-0000dca0: 3a66 756e 633a 6072 6463 6172 6473 602c  :func:`rdcards`,
-0000dcb0: 0a20 2020 203a 6675 6e63 3a60 7264 6772  .    :func:`rdgr
-0000dcc0: 6964 7360 2c20 3a66 756e 633a 6070 7979  ids`, :func:`pyy
-0000dcd0: 6574 692e 6e61 7374 7261 6e2e 6f70 322e  eti.nastran.op2.
-0000dce0: 4f50 322e 7264 6e32 636f 7032 602c 0a20  OP2.rdn2cop2`,. 
-0000dcf0: 2020 203a 6675 6e63 3a60 7079 7965 7469     :func:`pyyeti
-0000dd00: 2e6e 6173 7472 616e 2e6e 3270 2e61 6464  .nastran.n2p.add
-0000dd10: 6772 6964 602c 203a 6d6f 643a 6070 7979  grid`, :mod:`pyy
-0000dd20: 6574 692e 6e61 7374 7261 6e2e 6e32 7060  eti.nastran.n2p`
-0000dd30: 2e0a 2020 2020 2222 220a 2020 2020 6772  ..    """.    gr
-0000dd40: 6964 7320 3d20 6e70 2e7a 6572 6f73 2828  ids = np.zeros((
-0000dd50: 302c 2038 2929 0a20 2020 2063 6f6f 7264  0, 8)).    coord
-0000dd60: 7320 3d20 7b7d 0a0a 2020 2020 6966 206c  s = {}..    if l
-0000dd70: 656e 2861 7267 7329 203d 3d20 303a 0a20  en(args) == 0:. 
-0000dd80: 2020 2020 2020 2061 7267 7320 3d20 5b4e         args = [N
-0000dd90: 6f6e 655d 0a0a 2020 2020 666f 7220 6620  one]..    for f 
-0000dda0: 696e 2061 7267 733a 0a20 2020 2020 2020  in args:.       
-0000ddb0: 2066 203d 2067 7569 746f 6f6c 732e 6765   f = guitools.ge
-0000ddc0: 745f 6669 6c65 5f6e 616d 6528 662c 2072  t_file_name(f, r
-0000ddd0: 6561 643d 5472 7565 290a 2020 2020 2020  ead=True).      
-0000dde0: 2020 636f 6f72 6473 2e75 7064 6174 6528    coords.update(
-0000ddf0: 7264 636f 7264 3263 6172 6473 2866 2929  rdcord2cards(f))
-0000de00: 0a20 2020 2020 2020 2067 203d 2072 6467  .        g = rdg
-0000de10: 7269 6473 2866 290a 2020 2020 2020 2020  rids(f).        
-0000de20: 6966 2067 2069 7320 6e6f 7420 4e6f 6e65  if g is not None
-0000de30: 3a0a 2020 2020 2020 2020 2020 2020 6772  :.            gr
-0000de40: 6964 7320 3d20 6e70 2e76 7374 6163 6b28  ids = np.vstack(
-0000de50: 2867 7269 6473 2c20 6729 290a 0a20 2020  (grids, g))..   
-0000de60: 2069 203d 206e 702e 6172 6773 6f72 7428   i = np.argsort(
-0000de70: 6772 6964 735b 3a2c 2030 5d29 0a20 2020  grids[:, 0]).   
-0000de80: 2067 7269 6473 203d 2067 7269 6473 5b69   grids = grids[i
-0000de90: 2c20 3a5d 0a20 2020 2075 7365 7420 3d20  , :].    uset = 
-0000dea0: 6e32 702e 6164 6467 7269 6428 0a20 2020  n2p.addgrid(.   
-0000deb0: 2020 2020 204e 6f6e 652c 0a20 2020 2020       None,.     
-0000dec0: 2020 2067 7269 6473 5b3a 2c20 305d 2e61     grids[:, 0].a
-0000ded0: 7374 7970 6528 6e70 2e69 6e74 3634 292c  stype(np.int64),
-0000dee0: 0a20 2020 2020 2020 2022 6222 2c0a 2020  .        "b",.  
-0000def0: 2020 2020 2020 6772 6964 735b 3a2c 2031        grids[:, 1
-0000df00: 5d2c 0a20 2020 2020 2020 2067 7269 6473  ],.        grids
-0000df10: 5b3a 2c20 323a 355d 2c0a 2020 2020 2020  [:, 2:5],.      
-0000df20: 2020 6772 6964 735b 3a2c 2035 5d2c 0a20    grids[:, 5],. 
-0000df30: 2020 2020 2020 2063 6f6f 7264 732c 0a20         coords,. 
-0000df40: 2020 2029 0a20 2020 2072 6574 7572 6e20     ).    return 
-0000df50: 7573 6574 2c20 636f 6f72 6473 0a0a 0a40  uset, coords...@
-0000df60: 6775 6974 6f6f 6c73 2e77 7269 7465 5f74  guitools.write_t
-0000df70: 6578 745f 6669 6c65 0a64 6566 2075 7365  ext_file.def use
-0000df80: 7432 6275 6c6b 2866 2c20 7573 6574 293a  t2bulk(f, uset):
-0000df90: 0a20 2020 2022 2222 0a20 2020 2057 7269  .    """.    Wri
-0000dfa0: 7465 2043 4f52 4432 2a20 616e 6420 4752  te CORD2* and GR
-0000dfb0: 4944 2063 6172 6473 2066 726f 6d20 6120  ID cards from a 
-0000dfc0: 5553 4554 2074 6162 6c65 0a0a 2020 2020  USET table..    
-0000dfd0: 5061 7261 6d65 7465 7273 0a20 2020 202d  Parameters.    -
-0000dfe0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 6620  ---------.    f 
-0000dff0: 3a20 7374 7269 6e67 206f 7220 6669 6c65  : string or file
-0000e000: 5f6c 696b 6520 6f72 2031 206f 7220 4e6f  _like or 1 or No
-0000e010: 6e65 0a20 2020 2020 2020 2045 6974 6865  ne.        Eithe
-0000e020: 7220 6120 6e61 6d65 206f 6620 6120 6669  r a name of a fi
-0000e030: 6c65 2c20 6f72 2069 7320 6120 6669 6c65  le, or is a file
-0000e040: 5f6c 696b 6520 6f62 6a65 6374 2061 7320  _like object as 
-0000e050: 7265 7475 726e 6564 0a20 2020 2020 2020  returned.       
-0000e060: 2062 7920 3a66 756e 633a 606f 7065 6e60   by :func:`open`
-0000e070: 206f 7220 3a63 6c61 7373 3a60 696f 2e53   or :class:`io.S
-0000e080: 7472 696e 6749 4f60 2e20 496e 7075 7420  tringIO`. Input 
-0000e090: 6173 2069 6e74 6567 6572 2031 2074 6f0a  as integer 1 to.
-0000e0a0: 2020 2020 2020 2020 7772 6974 6520 746f          write to
-0000e0b0: 2073 7464 6f75 742e 2043 616e 2061 6c73   stdout. Can als
-0000e0c0: 6f20 6265 2074 6865 206e 616d 6520 6f66  o be the name of
-0000e0d0: 2061 2064 6972 6563 746f 7279 206f 7220   a directory or 
-0000e0e0: 4e6f 6e65 3b0a 2020 2020 2020 2020 696e  None;.        in
-0000e0f0: 2074 6865 7365 2063 6173 6573 2c20 6120   these cases, a 
-0000e100: 4755 4920 6973 206f 7065 6e65 6420 666f  GUI is opened fo
-0000e110: 7220 6669 6c65 2073 656c 6563 7469 6f6e  r file selection
-0000e120: 2e0a 2020 2020 7573 6574 203a 2070 616e  ..    uset : pan
-0000e130: 6461 7320 4461 7461 4672 616d 650a 2020  das DataFrame.  
-0000e140: 2020 2020 2020 4120 4461 7461 4672 616d        A DataFram
-0000e150: 6520 6173 206f 7574 7075 7420 6279 0a20  e as output by. 
-0000e160: 2020 2020 2020 203a 6675 6e63 3a60 7079         :func:`py
-0000e170: 7965 7469 2e6e 6173 7472 616e 2e6f 7032  yeti.nastran.op2
-0000e180: 2e4f 5032 2e72 646e 3263 6f70 3260 0a0a  .OP2.rdn2cop2`..
-0000e190: 2020 2020 5265 7475 726e 730a 2020 2020      Returns.    
-0000e1a0: 2d2d 2d2d 2d2d 2d0a 2020 2020 4e6f 6e65  -------.    None
-0000e1b0: 0a0a 2020 2020 4e6f 7465 730a 2020 2020  ..    Notes.    
-0000e1c0: 2d2d 2d2d 2d0a 2020 2020 5468 6973 2069  -----.    This i
-0000e1d0: 7320 7468 6520 7265 7665 7273 6520 6f66  s the reverse of
-0000e1e0: 203a 6675 6e63 3a60 6275 6c6b 3275 7365   :func:`bulk2use
-0000e1f0: 7460 2e0a 0a20 2020 2053 6565 2061 6c73  t`...    See als
-0000e200: 6f0a 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20  o.    --------. 
-0000e210: 2020 203a 6675 6e63 3a60 6275 6c6b 3275     :func:`bulk2u
-0000e220: 7365 7460 2c20 3a66 756e 633a 6070 7979  set`, :func:`pyy
-0000e230: 6574 692e 6e61 7374 7261 6e2e 6e32 702e  eti.nastran.n2p.
-0000e240: 6d6b 636f 7264 6361 7264 696e 666f 602c  mkcordcardinfo`,
-0000e250: 0a20 2020 203a 6675 6e63 3a60 7774 636f  .    :func:`wtco
-0000e260: 6f72 6463 6172 6473 602c 203a 6675 6e63  ordcards`, :func
-0000e270: 3a60 7774 6772 6964 7360 2e0a 2020 2020  :`wtgrids`..    
-0000e280: 2222 220a 0a20 2020 2023 2047 6574 2073  """..    # Get s
-0000e290: 6f6d 6520 6461 7461 2066 726f 6d20 7468  ome data from th
-0000e2a0: 6520 7573 6574 2074 6162 6c65 3a0a 2020  e uset table:.  
-0000e2b0: 2020 6369 203d 206e 3270 2e6d 6b63 6f72    ci = n2p.mkcor
-0000e2c0: 6463 6172 6469 6e66 6f28 7573 6574 290a  dcardinfo(uset).
-0000e2d0: 2020 2020 6772 6964 7320 3d20 7573 6574      grids = uset
-0000e2e0: 2e69 6e64 6578 2e67 6574 5f6c 6576 656c  .index.get_level
-0000e2f0: 5f76 616c 7565 7328 2269 6422 290a 2020  _values("id").  
-0000e300: 2020 646f 6620 3d20 7573 6574 2e69 6e64    dof = uset.ind
-0000e310: 6578 2e67 6574 5f6c 6576 656c 5f76 616c  ex.get_level_val
-0000e320: 7565 7328 2264 6f66 2229 0a20 2020 2070  ues("dof").    p
-0000e330: 7620 3d20 646f 6620 3d3d 2031 0a20 2020  v = dof == 1.   
-0000e340: 2067 7269 6473 203d 2067 7269 6473 5b70   grids = grids[p
-0000e350: 765d 0a20 2020 2078 797a 203d 2075 7365  v].    xyz = use
-0000e360: 742e 6c6f 635b 7076 2c20 2278 223a 227a  t.loc[pv, "x":"z
-0000e370: 225d 2e76 616c 7565 730a 2020 2020 7076  "].values.    pv
-0000e380: 203d 2064 6f66 203d 3d20 320a 2020 2020   = dof == 2.    
-0000e390: 6364 203d 2075 7365 742e 6c6f 635b 7076  cd = uset.loc[pv
-0000e3a0: 2c20 2278 225d 2e76 616c 7565 732e 6173  , "x"].values.as
-0000e3b0: 7479 7065 2869 6e74 290a 0a20 2020 2023  type(int)..    #
-0000e3c0: 2057 7269 7465 2063 6f6f 7264 696e 6174   Write coordinat
-0000e3d0: 6520 7379 7374 656d 2063 6172 6473 2069  e system cards i
-0000e3e0: 6620 6e65 6564 6564 3a0a 2020 2020 6966  f needed:.    if
-0000e3f0: 2063 693a 0a20 2020 2020 2020 2066 2e77   ci:.        f.w
-0000e400: 7269 7465 2822 245c 6e24 2043 4f4f 5244  rite("$\n$ COORD
-0000e410: 494e 4154 4520 5359 5354 454d 2044 4154  INATE SYSTEM DAT
-0000e420: 415c 6e24 5c6e 2229 0a20 2020 2020 2020  A\n$\n").       
-0000e430: 2077 7463 6f6f 7264 6361 7264 7328 662c   wtcoordcards(f,
-0000e440: 2063 6929 0a0a 2020 2020 2320 5772 6974   ci)..    # Writ
-0000e450: 6520 4772 6964 2064 6174 613a 0a20 2020  e Grid data:.   
-0000e460: 2066 2e77 7269 7465 2822 245c 6e24 2047   f.write("$\n$ G
-0000e470: 5249 4420 4441 5441 5c6e 245c 6e22 290a  RID DATA\n$\n").
-0000e480: 2020 2020 7774 6772 6964 7328 662c 2067      wtgrids(f, g
-0000e490: 7269 6473 2c20 302c 2078 797a 2c20 6364  rids, 0, xyz, cd
-0000e4a0: 290a 0a0a 6465 6620 7264 7370 6f69 6e74  )...def rdspoint
-0000e4b0: 7328 6629 3a0a 2020 2020 7222 2222 0a20  s(f):.    r""". 
-0000e4c0: 2020 2052 6561 6420 4e61 7374 7261 6e20     Read Nastran 
-0000e4d0: 5350 4f49 4e54 2063 6172 6473 2066 726f  SPOINT cards fro
-0000e4e0: 6d20 6120 4e61 7374 7261 6e20 6275 6c6b  m a Nastran bulk
-0000e4f0: 2066 696c 652e 0a0a 2020 2020 5061 7261   file...    Para
-0000e500: 6d65 7465 7273 0a20 2020 202d 2d2d 2d2d  meters.    -----
-0000e510: 2d2d 2d2d 2d0a 2020 2020 6620 3a20 7374  -----.    f : st
-0000e520: 7269 6e67 206f 7220 6669 6c65 5f6c 696b  ring or file_lik
-0000e530: 6520 6f72 204e 6f6e 650a 2020 2020 2020  e or None.      
-0000e540: 2020 4569 7468 6572 2061 206e 616d 6520    Either a name 
-0000e550: 6f66 2061 2066 696c 652c 206f 7220 6973  of a file, or is
-0000e560: 2061 2066 696c 655f 6c69 6b65 206f 626a   a file_like obj
-0000e570: 6563 7420 6173 2072 6574 7572 6e65 640a  ect as returned.
-0000e580: 2020 2020 2020 2020 6279 203a 6675 6e63          by :func
-0000e590: 3a60 6f70 656e 602e 2049 6620 6669 6c65  :`open`. If file
-0000e5a0: 5f6c 696b 6520 6f62 6a65 6374 2c20 6974  _like object, it
-0000e5b0: 2069 7320 7265 776f 756e 6420 6669 7273   is rewound firs
-0000e5c0: 742e 2043 616e 0a20 2020 2020 2020 2061  t. Can.        a
-0000e5d0: 6c73 6f20 6265 2074 6865 206e 616d 6520  lso be the name 
-0000e5e0: 6f66 2061 2064 6972 6563 746f 7279 206f  of a directory o
-0000e5f0: 7220 4e6f 6e65 3b20 696e 2074 6865 7365  r None; in these
-0000e600: 2063 6173 6573 2c20 6120 4755 490a 2020   cases, a GUI.  
-0000e610: 2020 2020 2020 6973 206f 7065 6e65 6420        is opened 
-0000e620: 666f 7220 6669 6c65 2073 656c 6563 7469  for file selecti
-0000e630: 6f6e 2e0a 0a20 2020 2052 6574 7572 6e73  on...    Returns
-0000e640: 0a20 2020 202d 2d2d 2d2d 2d2d 0a20 2020  .    -------.   
-0000e650: 2073 706f 696e 7473 203a 2031 6420 6e64   spoints : 1d nd
-0000e660: 6172 7261 790a 2020 2020 2020 2020 4172  array.        Ar
-0000e670: 7261 7920 6f66 2053 504f 494e 5420 6964  ray of SPOINT id
-0000e680: 732e 2057 696c 6c20 6265 2065 6d70 7479  s. Will be empty
-0000e690: 2069 6620 6e6f 2053 504f 494e 5420 6361   if no SPOINT ca
-0000e6a0: 7264 7320 666f 756e 642e 0a0a 2020 2020  rds found...    
-0000e6b0: 4e6f 7465 730a 2020 2020 2d2d 2d2d 2d0a  Notes.    -----.
-0000e6c0: 2020 2020 5468 6973 2072 6f75 7469 6e65      This routine
-0000e6d0: 2075 7365 7320 3a66 756e 633a 6072 6463   uses :func:`rdc
-0000e6e0: 6172 6473 6020 746f 206c 6f61 6420 7468  ards` to load th
-0000e6f0: 6520 6461 7461 2e0a 0a20 2020 2045 7861  e data...    Exa
-0000e700: 6d70 6c65 730a 2020 2020 2d2d 2d2d 2d2d  mples.    ------
-0000e710: 2d2d 0a20 2020 203e 3e3e 2066 726f 6d20  --.    >>> from 
-0000e720: 7079 7965 7469 2069 6d70 6f72 7420 6e61  pyyeti import na
-0000e730: 7374 7261 6e0a 2020 2020 3e3e 3e20 6672  stran.    >>> fr
-0000e740: 6f6d 2069 6f20 696d 706f 7274 2053 7472  om io import Str
-0000e750: 696e 6749 4f0a 2020 2020 3e3e 3e20 6275  ingIO.    >>> bu
-0000e760: 6c6b 6461 7461 203d 2028 0a20 2020 202e  lkdata = (.    .
-0000e770: 2e2e 2020 2020 2022 5350 4f49 4e54 2c31  ..     "SPOINT,1
-0000e780: 2c32 2c31 3030 5c6e 220a 2020 2020 2e2e  ,2,100\n".    ..
-0000e790: 2e20 2020 2020 2253 504f 494e 542c 3230  .     "SPOINT,20
-0000e7a0: 302c 5448 5255 2c32 3032 5c6e 220a 2020  0,THRU,202\n".  
-0000e7b0: 2020 2e2e 2e20 2020 2020 2253 504f 494e    ...     "SPOIN
-0000e7c0: 542c 355c 6e22 0a20 2020 202e 2e2e 2029  T,5\n".    ... )
-0000e7d0: 0a20 2020 203e 3e3e 2077 6974 6820 5374  .    >>> with St
-0000e7e0: 7269 6e67 494f 2862 756c 6b64 6174 6129  ringIO(bulkdata)
-0000e7f0: 2061 7320 663a 0a20 2020 202e 2e2e 2020   as f:.    ...  
-0000e800: 2020 2073 706f 696e 7473 203d 206e 6173     spoints = nas
-0000e810: 7472 616e 2e72 6473 706f 696e 7473 2866  tran.rdspoints(f
-0000e820: 290a 2020 2020 3e3e 3e20 7370 6f69 6e74  ).    >>> spoint
-0000e830: 7320 2020 2020 2020 2020 2020 2020 2020  s               
-0000e840: 2020 2020 2020 2023 2064 6f63 7465 7374         # doctest
-0000e850: 3a20 2b45 4c4c 4950 5349 530a 2020 2020  : +ELLIPSIS.    
-0000e860: 6172 7261 7928 5b20 2031 2c20 2020 322c  array([  1,   2,
-0000e870: 2031 3030 2c20 3230 302c 2032 3031 2c20   100, 200, 201, 
-0000e880: 3230 322c 2020 2035 5d2e 2e2e 290a 2020  202,   5]...).  
-0000e890: 2020 3e3e 3e20 7769 7468 2053 7472 696e    >>> with Strin
-0000e8a0: 6749 4f28 226e 6f20 6461 7461 2229 2061  gIO("no data") a
-0000e8b0: 7320 663a 0a20 2020 202e 2e2e 2020 2020  s f:.    ...    
-0000e8c0: 2073 706f 696e 7473 203d 206e 6173 7472   spoints = nastr
-0000e8d0: 616e 2e72 6473 706f 696e 7473 2866 290a  an.rdspoints(f).
-0000e8e0: 2020 2020 3e3e 3e20 7370 6f69 6e74 7320      >>> spoints 
-0000e8f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e900: 2020 2020 2023 2064 6f63 7465 7374 3a20       # doctest: 
-0000e910: 2b45 4c4c 4950 5349 530a 2020 2020 6172  +ELLIPSIS.    ar
-0000e920: 7261 7928 5b5d 2e2e 2e29 0a0a 2020 2020  ray([]...)..    
-0000e930: 2222 220a 2020 2020 7370 6f69 6e74 5f64  """.    spoint_d
-0000e940: 6174 6120 3d20 7264 6361 7264 7328 662c  ata = rdcards(f,
-0000e950: 2022 7370 6f69 6e74 222c 2072 6574 7572   "spoint", retur
-0000e960: 6e5f 7661 723d 226c 6973 7422 290a 2020  n_var="list").  
-0000e970: 2020 7370 6f69 6e74 7320 3d20 5b5d 0a20    spoints = []. 
-0000e980: 2020 2069 6620 7370 6f69 6e74 5f64 6174     if spoint_dat
-0000e990: 6120 6973 206e 6f74 204e 6f6e 653a 0a20  a is not None:. 
-0000e9a0: 2020 2020 2020 2066 6f72 2063 6172 6420         for card 
-0000e9b0: 696e 2073 706f 696e 745f 6461 7461 3a0a  in spoint_data:.
-0000e9c0: 2020 2020 2020 2020 2020 2020 6966 206c              if l
-0000e9d0: 656e 2863 6172 6429 203e 2032 2061 6e64  en(card) > 2 and
-0000e9e0: 2069 7369 6e73 7461 6e63 6528 6361 7264   isinstance(card
-0000e9f0: 5b31 5d2c 2073 7472 2920 616e 6420 6361  [1], str) and ca
-0000ea00: 7264 5b31 5d2e 6c6f 7765 7228 2920 3d3d  rd[1].lower() ==
-0000ea10: 2022 7468 7275 223a 0a20 2020 2020 2020   "thru":.       
-0000ea20: 2020 2020 2020 2020 2073 706f 696e 7473           spoints
-0000ea30: 2e65 7874 656e 6428 5b69 2066 6f72 2069  .extend([i for i
-0000ea40: 2069 6e20 7261 6e67 6528 6361 7264 5b30   in range(card[0
-0000ea50: 5d2c 2063 6172 645b 325d 202b 2031 295d  ], card[2] + 1)]
-0000ea60: 290a 2020 2020 2020 2020 2020 2020 656c  ).            el
-0000ea70: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-0000ea80: 2020 2020 7370 6f69 6e74 732e 6578 7465      spoints.exte
-0000ea90: 6e64 2863 6172 6429 0a20 2020 2072 6574  nd(card).    ret
-0000eaa0: 7572 6e20 6e70 2e61 7272 6179 2873 706f  urn np.array(spo
-0000eab0: 696e 7473 2c20 6474 7970 653d 6e70 2e69  ints, dtype=np.i
-0000eac0: 6e74 3634 290a 0a0a 6465 6620 7264 7365  nt64)...def rdse
-0000ead0: 636f 6e63 7428 6629 3a0a 2020 2020 7222  conct(f):.    r"
-0000eae0: 2222 0a20 2020 2052 6561 6420 4e61 7374  "".    Read Nast
-0000eaf0: 7261 6e20 5345 434f 4e43 5420 6361 7264  ran SECONCT card
-0000eb00: 7320 6672 6f6d 2061 204e 6173 7472 616e  s from a Nastran
-0000eb10: 2062 756c 6b20 6669 6c65 2e0a 0a20 2020   bulk file...   
-0000eb20: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
-0000eb30: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2066  ----------.    f
-0000eb40: 203a 2073 7472 696e 6720 6f72 2066 696c   : string or fil
-0000eb50: 655f 6c69 6b65 206f 7220 4e6f 6e65 0a20  e_like or None. 
-0000eb60: 2020 2020 2020 2045 6974 6865 7220 6120         Either a 
-0000eb70: 6e61 6d65 206f 6620 6120 6669 6c65 2c20  name of a file, 
-0000eb80: 6f72 2069 7320 6120 6669 6c65 5f6c 696b  or is a file_lik
-0000eb90: 6520 6f62 6a65 6374 2061 7320 7265 7475  e object as retu
-0000eba0: 726e 6564 0a20 2020 2020 2020 2062 7920  rned.        by 
-0000ebb0: 3a66 756e 633a 606f 7065 6e60 2e20 4966  :func:`open`. If
-0000ebc0: 2066 696c 655f 6c69 6b65 206f 626a 6563   file_like objec
-0000ebd0: 742c 2069 7420 6973 2072 6577 6f75 6e64  t, it is rewound
-0000ebe0: 2066 6972 7374 2e20 4361 6e0a 2020 2020   first. Can.    
-0000ebf0: 2020 2020 616c 736f 2062 6520 7468 6520      also be the 
-0000ec00: 6e61 6d65 206f 6620 6120 6469 7265 6374  name of a direct
-0000ec10: 6f72 7920 6f72 204e 6f6e 653b 2069 6e20  ory or None; in 
-0000ec20: 7468 6573 6520 6361 7365 732c 2061 2047  these cases, a G
-0000ec30: 5549 0a20 2020 2020 2020 2069 7320 6f70  UI.        is op
-0000ec40: 656e 6564 2066 6f72 2066 696c 6520 7365  ened for file se
-0000ec50: 6c65 6374 696f 6e2e 0a0a 2020 2020 5265  lection...    Re
-0000ec60: 7475 726e 730a 2020 2020 2d2d 2d2d 2d2d  turns.    ------
-0000ec70: 2d0a 2020 2020 615f 6964 732c 2062 5f69  -.    a_ids, b_i
-0000ec80: 6473 203a 2031 6420 6e64 6172 7261 7973  ds : 1d ndarrays
-0000ec90: 0a20 2020 2020 2020 2041 7272 6179 206f  .        Array o
-0000eca0: 6620 4752 4944 2061 6e64 2053 504f 494e  f GRID and SPOIN
-0000ecb0: 5420 6964 7320 666f 7220 7375 7065 7265  T ids for supere
-0000ecc0: 6c65 6d65 6e74 2041 2061 6e64 0a20 2020  lement A and.   
-0000ecd0: 2020 2020 2073 7570 6572 656c 656d 656e       superelemen
-0000ece0: 7420 422c 2072 6573 7065 6374 6976 656c  t B, respectivel
-0000ecf0: 792e 2042 6f74 6820 6f75 7470 7574 7320  y. Both outputs 
-0000ed00: 7769 6c6c 2062 6520 656d 7074 7920 6966  will be empty if
-0000ed10: 206e 6f0a 2020 2020 2020 2020 5345 434f   no.        SECO
-0000ed20: 4e43 5420 6361 7264 7320 666f 756e 642e  NCT cards found.
-0000ed30: 0a0a 2020 2020 4e6f 7465 730a 2020 2020  ..    Notes.    
-0000ed40: 2d2d 2d2d 2d0a 2020 2020 5468 6973 2072  -----.    This r
-0000ed50: 6f75 7469 6e65 2075 7365 7320 3a66 756e  outine uses :fun
-0000ed60: 633a 6072 6463 6172 6473 6020 746f 206c  c:`rdcards` to l
-0000ed70: 6f61 6420 7468 6520 6461 7461 2e0a 0a20  oad the data... 
-0000ed80: 2020 2045 7861 6d70 6c65 730a 2020 2020     Examples.    
-0000ed90: 2d2d 2d2d 2d2d 2d2d 0a20 2020 203e 3e3e  --------.    >>>
-0000eda0: 2066 726f 6d20 696f 2069 6d70 6f72 7420   from io import 
-0000edb0: 5374 7269 6e67 494f 0a20 2020 203e 3e3e  StringIO.    >>>
-0000edc0: 2066 726f 6d20 7079 7965 7469 2069 6d70   from pyyeti imp
-0000edd0: 6f72 7420 6e61 7374 7261 6e0a 2020 2020  ort nastran.    
-0000ede0: 3e3e 3e20 6275 6c6b 6461 7461 203d 2028  >>> bulkdata = (
-0000edf0: 0a20 2020 202e 2e2e 2020 2020 2022 5345  .    ...     "SE
-0000ee00: 434f 4e43 542c 3130 312c 302c 2c4e 4f5c  CONCT,101,0,,NO\
-0000ee10: 6e22 0a20 2020 202e 2e2e 2020 2020 2022  n".    ...     "
-0000ee20: 2c33 2c33 302c 3131 2c31 3130 2c31 392c  ,3,30,11,110,19,
-0000ee30: 3139 302c 3237 2c32 3730 5c6e 220a 2020  190,27,270\n".  
-0000ee40: 2020 2e2e 2e20 2020 2020 2224 5c6e 220a    ...     "$\n".
-0000ee50: 2020 2020 2e2e 2e20 2020 2020 2253 4543      ...     "SEC
-0000ee60: 4f4e 4354 2c31 3031 2c30 2c2c 4e4f 5c6e  ONCT,101,0,,NO\n
-0000ee70: 220a 2020 2020 2e2e 2e20 2020 2020 222c  ".    ...     ",
-0000ee80: 3131 3031 2c54 4852 552c 3131 3034 2c32  1101,THRU,1104,2
-0000ee90: 3130 312c 5448 5255 2c32 3130 345c 6e22  101,THRU,2104\n"
-0000eea0: 0a20 2020 202e 2e2e 2029 0a20 2020 203e  .    ... ).    >
-0000eeb0: 3e3e 2077 6974 6820 5374 7269 6e67 494f  >> with StringIO
-0000eec0: 2862 756c 6b64 6174 6129 2061 7320 663a  (bulkdata) as f:
-0000eed0: 0a20 2020 202e 2e2e 2020 2020 2061 5f69  .    ...     a_i
-0000eee0: 6473 2c20 625f 6964 7320 3d20 6e61 7374  ds, b_ids = nast
-0000eef0: 7261 6e2e 7264 7365 636f 6e63 7428 6629  ran.rdseconct(f)
-0000ef00: 0a20 2020 203e 3e3e 2061 5f69 6473 2020  .    >>> a_ids  
-0000ef10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ef20: 2020 2020 2320 646f 6374 6573 743a 202b      # doctest: +
-0000ef30: 454c 4c49 5053 4953 0a20 2020 2061 7272  ELLIPSIS.    arr
-0000ef40: 6179 285b 2020 2033 2c20 2020 3131 2c20  ay([   3,   11, 
-0000ef50: 2020 3139 2c20 2020 3237 2c20 3131 3031    19,   27, 1101
-0000ef60: 2c20 3131 3032 2c20 3131 3033 2c20 3131  , 1102, 1103, 11
-0000ef70: 3034 5d2e 2e2e 290a 2020 2020 3e3e 3e20  04]...).    >>> 
-0000ef80: 625f 6964 7320 2020 2020 2020 2020 2020  b_ids           
-0000ef90: 2020 2020 2020 2020 2020 2023 2064 6f63             # doc
-0000efa0: 7465 7374 3a20 2b45 4c4c 4950 5349 530a  test: +ELLIPSIS.
-0000efb0: 2020 2020 6172 7261 7928 5b20 2033 302c      array([  30,
-0000efc0: 2020 3131 302c 2020 3139 302c 2020 3237    110,  190,  27
-0000efd0: 302c 2032 3130 312c 2032 3130 322c 2032  0, 2101, 2102, 2
-0000efe0: 3130 332c 2032 3130 345d 2e2e 2e29 0a20  103, 2104]...). 
-0000eff0: 2020 2022 2222 0a0a 2020 2020 6465 6620     """..    def 
-0000f000: 5f67 6574 5f70 6169 7273 2863 6172 6429  _get_pairs(card)
-0000f010: 3a0a 2020 2020 2020 2020 2320 7472 756e  :.        # trun
-0000f020: 6361 7465 2061 6e64 2066 696c 7465 7220  cate and filter 
-0000f030: 6f75 7420 626c 616e 6b73 3a0a 2020 2020  out blanks:.    
-0000f040: 2020 2020 6361 7264 203d 205b 6920 666f      card = [i fo
-0000f050: 7220 6920 696e 2063 6172 645b 383a 5d20  r i in card[8:] 
-0000f060: 6966 2069 5d0a 2020 2020 2020 2020 6974  if i].        it
-0000f070: 203d 2069 7465 7228 6361 7264 290a 2020   = iter(card).  
-0000f080: 2020 2020 2020 666f 7220 612c 2062 2069        for a, b i
-0000f090: 6e20 7a69 7028 6974 2c20 6974 293a 0a20  n zip(it, it):. 
-0000f0a0: 2020 2020 2020 2020 2020 2079 6965 6c64             yield
-0000f0b0: 2061 2c20 620a 0a20 2020 2073 6563 6f6e   a, b..    secon
-0000f0c0: 6374 5f64 6174 6120 3d20 7264 6361 7264  ct_data = rdcard
-0000f0d0: 7328 662c 2022 7365 636f 6e63 7422 2c20  s(f, "seconct", 
-0000f0e0: 7265 7475 726e 5f76 6172 3d22 6c69 7374  return_var="list
-0000f0f0: 2229 0a20 2020 2061 5f69 6473 203d 205b  ").    a_ids = [
-0000f100: 5d0a 2020 2020 625f 6964 7320 3d20 5b5d  ].    b_ids = []
-0000f110: 0a20 2020 2069 6620 7365 636f 6e63 745f  .    if seconct_
-0000f120: 6461 7461 2069 7320 6e6f 7420 4e6f 6e65  data is not None
-0000f130: 3a0a 2020 2020 2020 2020 666f 7220 6361  :.        for ca
-0000f140: 7264 2069 6e20 7365 636f 6e63 745f 6461  rd in seconct_da
-0000f150: 7461 3a0a 2020 2020 2020 2020 2020 2020  ta:.            
-0000f160: 6974 203d 2069 7465 7228 5f67 6574 5f70  it = iter(_get_p
-0000f170: 6169 7273 2863 6172 6429 290a 2020 2020  airs(card)).    
-0000f180: 2020 2020 2020 2020 666f 7220 612c 2062          for a, b
-0000f190: 2069 6e20 6974 3a0a 2020 2020 2020 2020   in it:.        
-0000f1a0: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
-0000f1b0: 7461 6e63 6528 622c 2073 7472 293a 2020  tance(b, str):  
-0000f1c0: 2320 6974 206d 7573 7420 6265 2022 5448  # it must be "TH
-0000f1d0: 5255 220a 2020 2020 2020 2020 2020 2020  RU".            
-0000f1e0: 2020 2020 2020 2020 2320 4254 4120 7361          # BTA sa
-0000f1f0: 7973 2049 276d 2061 206a 6572 6b20 6966  ys I'm a jerk if
-0000f200: 2049 2064 6f6e 2774 2063 6865 636b 2066   I don't check f
-0000f210: 6f72 2022 5448 5255 2220 3a29 0a20 2020  or "THRU" :).   
-0000f220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f230: 2061 322c 2062 3120 3d20 6e65 7874 2869   a2, b1 = next(i
-0000f240: 7429 0a20 2020 2020 2020 2020 2020 2020  t).             
-0000f250: 2020 2020 2020 2074 6872 752c 2062 3220         thru, b2 
-0000f260: 3d20 6e65 7874 2869 7429 0a20 2020 2020  = next(it).     
-0000f270: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-0000f280: 5f69 6473 2e65 7874 656e 6428 5b69 2066  _ids.extend([i f
-0000f290: 6f72 2069 2069 6e20 7261 6e67 6528 612c  or i in range(a,
-0000f2a0: 2061 3220 2b20 3129 5d29 0a20 2020 2020   a2 + 1)]).     
-0000f2b0: 2020 2020 2020 2020 2020 2020 2020 2062                 b
-0000f2c0: 5f69 6473 2e65 7874 656e 6428 5b69 2066  _ids.extend([i f
-0000f2d0: 6f72 2069 2069 6e20 7261 6e67 6528 6231  or i in range(b1
-0000f2e0: 2c20 6232 202b 2031 295d 290a 2020 2020  , b2 + 1)]).    
-0000f2f0: 2020 2020 2020 2020 2020 2020 656c 7365              else
-0000f300: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0000f310: 2020 2020 2020 615f 6964 732e 6170 7065        a_ids.appe
-0000f320: 6e64 2861 290a 2020 2020 2020 2020 2020  nd(a).          
-0000f330: 2020 2020 2020 2020 2020 625f 6964 732e            b_ids.
-0000f340: 6170 7065 6e64 2862 290a 2020 2020 7265  append(b).    re
-0000f350: 7475 726e 206e 702e 6172 7261 7928 615f  turn np.array(a_
-0000f360: 6964 732c 2064 7479 7065 3d6e 702e 696e  ids, dtype=np.in
-0000f370: 7436 3429 2c20 6e70 2e61 7272 6179 2862  t64), np.array(b
-0000f380: 5f69 6473 2c20 6474 7970 653d 6e70 2e69  _ids, dtype=np.i
-0000f390: 6e74 3634 290a 0a0a 4067 7569 746f 6f6c  nt64)...@guitool
-0000f3a0: 732e 7265 6164 5f74 6578 745f 6669 6c65  s.read_text_file
-0000f3b0: 0a64 6566 2061 736d 3275 7365 7428 662c  .def asm2uset(f,
-0000f3c0: 2074 7279 5f72 6465 7874 726e 3d54 7275   try_rdextrn=Tru
-0000f3d0: 6529 3a0a 2020 2020 7222 2222 0a20 2020  e):.    r""".   
-0000f3e0: 2052 6561 6420 434f 5244 322a 2061 6e64   Read CORD2* and
-0000f3f0: 2047 5249 4420 6361 7264 7320 6672 6f6d   GRID cards from
-0000f400: 2061 2022 2e61 736d 2220 6669 6c65 2074   a ".asm" file t
-0000f410: 6f20 6d61 6b65 2061 2055 5345 5420 7461  o make a USET ta
-0000f420: 626c 650a 0a20 2020 2050 6172 616d 6574  ble..    Paramet
-0000f430: 6572 730a 2020 2020 2d2d 2d2d 2d2d 2d2d  ers.    --------
-0000f440: 2d2d 0a20 2020 2066 203a 2073 7472 696e  --.    f : strin
-0000f450: 6720 6f72 2066 696c 655f 6c69 6b65 206f  g or file_like o
-0000f460: 7220 4e6f 6e65 0a20 2020 2020 2020 2045  r None.        E
-0000f470: 6974 6865 7220 6120 6e61 6d65 206f 6620  ither a name of 
-0000f480: 6120 6669 6c65 2c20 6f72 2069 7320 6120  a file, or is a 
-0000f490: 6669 6c65 5f6c 696b 6520 6f62 6a65 6374  file_like object
-0000f4a0: 2061 7320 7265 7475 726e 6564 0a20 2020   as returned.   
-0000f4b0: 2020 2020 2062 7920 3a66 756e 633a 606f       by :func:`o
-0000f4c0: 7065 6e60 2e20 4966 2066 696c 655f 6c69  pen`. If file_li
-0000f4d0: 6b65 206f 626a 6563 742c 2069 7420 6973  ke object, it is
-0000f4e0: 2072 6577 6f75 6e64 2066 6972 7374 2e20   rewound first. 
-0000f4f0: 4361 6e0a 2020 2020 2020 2020 616c 736f  Can.        also
-0000f500: 2062 6520 7468 6520 6e61 6d65 206f 6620   be the name of 
-0000f510: 6120 6469 7265 6374 6f72 7920 6f72 204e  a directory or N
-0000f520: 6f6e 653b 2069 6e20 7468 6573 6520 6361  one; in these ca
-0000f530: 7365 732c 2061 2047 5549 0a20 2020 2020  ses, a GUI.     
-0000f540: 2020 2069 7320 6f70 656e 6564 2066 6f72     is opened for
-0000f550: 2066 696c 6520 7365 6c65 6374 696f 6e2e   file selection.
-0000f560: 0a20 2020 2074 7279 5f72 6465 7874 726e  .    try_rdextrn
-0000f570: 203a 2062 6f6f 6c3b 206f 7074 696f 6e61   : bool; optiona
-0000f580: 6c0a 2020 2020 2020 2020 4966 2054 7275  l.        If Tru
-0000f590: 652c 2072 6f75 7469 6e65 2077 696c 6c20  e, routine will 
-0000f5a0: 6174 7465 6d70 7420 746f 2072 6561 6420  attempt to read 
-0000f5b0: 7468 6520 2245 5854 524e 2220 6361 7264  the "EXTRN" card
-0000f5c0: 2066 726f 6d0a 2020 2020 2020 2020 7468   from.        th
-0000f5d0: 6520 222e 7063 6822 2066 696c 652e 2049  e ".pch" file. I
-0000f5e0: 6620 6120 6669 6c65 6e61 6d65 2063 616e  f a filename can
-0000f5f0: 6e6f 7420 6265 2064 6574 6572 6d69 6e65  not be determine
-0000f600: 6420 6672 6f6d 2060 6660 2c0a 2020 2020  d from `f`,.    
-0000f610: 2020 2020 7468 6520 6174 7465 6d70 7420      the attempt 
-0000f620: 746f 2074 6865 2022 4558 5452 4e22 2063  to the "EXTRN" c
-0000f630: 6172 6420 6973 2071 7569 6574 6c79 2073  ard is quietly s
-0000f640: 6b69 7070 6564 2061 6e64 2065 6163 680a  kipped and each.
-0000f650: 2020 2020 2020 2020 622d 7365 7420 6e6f          b-set no
-0000f660: 6465 2069 7320 6173 7375 6d65 6420 746f  de is assumed to
-0000f670: 2068 6176 6520 616c 6c20 3620 444f 462e   have all 6 DOF.
-0000f680: 2053 6565 204e 6f74 6573 2062 656c 6f77   See Notes below
-0000f690: 2e0a 0a20 2020 2052 6574 7572 6e73 0a20  ...    Returns. 
-0000f6a0: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 2075     -------.    u
-0000f6b0: 7365 7420 3a20 7061 6e64 6173 2044 6174  set : pandas Dat
-0000f6c0: 6146 7261 6d65 0a20 2020 2020 2020 2041  aFrame.        A
-0000f6d0: 2044 6174 6146 7261 6d65 2061 7320 6f75   DataFrame as ou
-0000f6e0: 7470 7574 2062 790a 2020 2020 2020 2020  tput by.        
-0000f6f0: 3a66 756e 633a 6070 7979 6574 692e 6e61  :func:`pyyeti.na
-0000f700: 7374 7261 6e2e 6f70 322e 4f50 322e 7264  stran.op2.OP2.rd
-0000f710: 6e32 636f 7032 602e 2043 6f6e 7461 696e  n2cop2`. Contain
-0000f720: 7320 616c 6c20 4752 4944 2061 6e64 0a20  s all GRID and. 
-0000f730: 2020 2020 2020 2053 504f 494e 5420 444f         SPOINT DO
-0000f740: 4620 696e 2074 6865 202e 6173 6d20 6669  F in the .asm fi
-0000f750: 6c65 2069 6e20 7468 6520 6f72 6465 7220  le in the order 
-0000f760: 7370 6563 6966 6965 6420 6f6e 2074 6865  specified on the
-0000f770: 0a20 2020 2020 2020 2053 4543 4f4e 4354  .        SECONCT
-0000f780: 2063 6172 642e 2054 6869 7320 6973 2063   card. This is c
-0000f790: 6f6d 7061 7469 626c 6520 7769 7468 2074  ompatible with t
-0000f7a0: 6865 206d 6f64 656c 206d 6174 7269 6365  he model matrice
-0000f7b0: 7320 2865 672c 0a20 2020 2020 2020 2069  s (eg,.        i
-0000f7c0: 6e20 7468 6520 2e6f 7034 2066 696c 6529  n the .op4 file)
-0000f7d0: 2e0a 2020 2020 636f 6f72 6472 6566 203a  ..    coordref :
-0000f7e0: 2064 6963 7469 6f6e 6172 790a 2020 2020   dictionary.    
-0000f7f0: 2020 2020 4469 6374 696f 6e61 7279 2077      Dictionary w
-0000f800: 6974 6820 7468 6520 6b65 7973 2062 6569  ith the keys bei
-0000f810: 6e67 2074 6865 2063 6f6f 7264 696e 6174  ng the coordinat
-0000f820: 6520 7379 7374 656d 2069 6420 616e 640a  e system id and.
-0000f830: 2020 2020 2020 2020 7468 6520 7661 6c75          the valu
-0000f840: 6573 2062 6569 6e67 2074 6865 2035 7833  es being the 5x3
-0000f850: 206d 6174 7269 783a 3a0a 0a20 2020 2020   matrix::..     
-0000f860: 2020 2020 2020 205b 6964 2020 7479 7065         [id  type
-0000f870: 2030 5d20 2023 206f 7574 7075 7420 636f   0]  # output co
-0000f880: 6f72 642e 2073 7973 2e20 6964 2061 6e64  ord. sys. id and
-0000f890: 2074 7970 650a 2020 2020 2020 2020 2020   type.          
-0000f8a0: 2020 5b78 6f20 2079 6f20 207a 6f5d 2020    [xo  yo  zo]  
-0000f8b0: 2320 6f72 6967 696e 206f 6620 636f 6f72  # origin of coor
-0000f8c0: 642e 2073 7973 7465 6d0a 2020 2020 2020  d. system.      
-0000f8d0: 2020 2020 2020 5b20 2020 2054 2020 2020        [    T    
-0000f8e0: 205d 2020 2320 3378 3320 7472 616e 7366   ]  # 3x3 transf
-0000f8f0: 6f72 6d61 7469 6f6e 2074 6f20 6261 7369  ormation to basi
-0000f900: 630a 2020 2020 2020 2020 2020 2020 4e6f  c.            No
-0000f910: 7465 2074 6861 7420 5420 6973 2066 6f72  te that T is for
-0000f920: 2074 6865 2063 6f6f 7264 696e 6174 6520   the coordinate 
-0000f930: 7379 7374 656d 2c20 6e6f 7420 6120 6772  system, not a gr
-0000f940: 6964 0a20 2020 2020 2020 2020 2020 2028  id.            (
-0000f950: 756e 6c65 7373 2074 7970 6520 3d20 3120  unless type = 1 
-0000f960: 7768 6963 6820 6d65 616e 7320 7265 6374  which means rect
-0000f970: 616e 6775 6c61 7229 0a0a 2020 2020 6273  angular)..    bs
-0000f980: 6574 5f62 6f6f 6c20 3a20 3164 206e 6461  et_bool : 1d nda
-0000f990: 7272 6179 0a20 2020 2020 2020 2041 2062  rray.        A b
-0000f9a0: 6f6f 6c65 616e 2070 6172 7469 7469 6f6e  oolean partition
-0000f9b0: 2076 6563 746f 7220 7769 7468 2054 7275   vector with Tru
-0000f9c0: 6520 666f 7220 7468 6520 622d 7365 742e  e for the b-set.
-0000f9d0: 2054 6869 7320 6973 0a20 2020 2020 2020   This is.       
-0000f9e0: 2063 7265 6174 6564 2066 6f72 2063 6f6e   created for con
-0000f9f0: 7665 6e69 656e 6365 2062 793a 3a0a 0a20  venience by::.. 
-0000fa00: 2020 2020 2020 2020 2020 2066 726f 6d20             from 
-0000fa10: 7079 7965 7469 2069 6d70 6f72 7420 6e61  pyyeti import na
-0000fa20: 7374 7261 6e0a 2020 2020 2020 2020 2020  stran.          
-0000fa30: 2020 6273 6574 5f62 6f6f 6c20 3d20 6e61    bset_bool = na
-0000fa40: 7374 7261 6e2e 6d6b 7365 7470 7628 7573  stran.mksetpv(us
-0000fa50: 6574 2c20 2761 272c 2027 6227 290a 0a20  et, 'a', 'b').. 
-0000fa60: 2020 204e 6f74 6573 0a20 2020 202d 2d2d     Notes.    ---
-0000fa70: 2d2d 0a20 2020 2054 6869 7320 726f 7574  --.    This rout
-0000fa80: 696e 6520 7769 6c6c 2061 7474 656d 7074  ine will attempt
-0000fa90: 2074 6f20 7265 6164 2074 6865 2022 4558   to read the "EX
-0000faa0: 5452 4e22 2063 6172 6420 6672 6f6d 2074  TRN" card from t
-0000fab0: 6865 202e 7063 680a 2020 2020 6669 6c65  he .pch.    file
-0000fac0: 2069 6e20 6361 7365 2073 6f6d 6520 622d   in case some b-
-0000fad0: 7365 7420 6e6f 6465 7320 646f 206e 6f74  set nodes do not
-0000fae0: 2069 6e63 6c75 6465 2061 6c6c 2036 2044   include all 6 D
-0000faf0: 4f46 2e20 466f 720a 2020 2020 6578 616d  OF. For.    exam
-0000fb00: 706c 652c 2061 206d 6f64 656c 2063 6f75  ple, a model cou
-0000fb10: 6c64 2068 6176 6520 3720 622d 7365 7420  ld have 7 b-set 
-0000fb20: 444f 4620 616e 6420 3120 712d 7365 7420  DOF and 1 q-set 
-0000fb30: 444f 462e 2049 6620 7468 6520 370a 2020  DOF. If the 7.  
-0000fb40: 2020 622d 7365 7420 444f 4620 6172 6520    b-set DOF are 
-0000fb50: 636f 6d70 6f73 6564 206f 6620 616c 6c20  composed of all 
-0000fb60: 3620 444f 4620 666f 7220 6e6f 6465 2031  6 DOF for node 1
-0000fb70: 3030 2061 6e64 206a 7573 7420 7468 650a  00 and just the.
-0000fb80: 2020 2020 7365 636f 6e64 2044 4f46 2066      second DOF f
-0000fb90: 6f72 206e 6f64 6520 3230 302c 2074 6865  or node 200, the
-0000fba0: 2045 5854 524e 2063 6172 6420 776f 756c   EXTRN card woul
-0000fbb0: 6420 6c69 6b65 2074 6869 733a 3a0a 0a20  d like this::.. 
-0000fbc0: 2020 2020 2020 2045 5854 524e 2c31 3030         EXTRN,100
-0000fbd0: 2c31 3233 3435 362c 3230 302c 322c 3130  ,123456,200,2,10
-0000fbe0: 3031 2c30 0a0a 2020 2020 4578 616d 706c  01,0..    Exampl
-0000fbf0: 6573 0a20 2020 202d 2d2d 2d2d 2d2d 2d0a  es.    --------.
-0000fc00: 2020 2020 3e3e 3e20 696d 706f 7274 206e      >>> import n
-0000fc10: 756d 7079 2061 7320 6e70 0a20 2020 203e  umpy as np.    >
-0000fc20: 3e3e 2066 726f 6d20 696f 2069 6d70 6f72  >> from io impor
-0000fc30: 7420 5374 7269 6e67 494f 0a20 2020 203e  t StringIO.    >
-0000fc40: 3e3e 2066 726f 6d20 7079 7965 7469 2069  >> from pyyeti i
-0000fc50: 6d70 6f72 7420 6e61 7374 7261 6e0a 2020  mport nastran.  
-0000fc60: 2020 3e3e 3e20 6173 6d5f 6275 6c6b 203d    >>> asm_bulk =
-0000fc70: 2028 0a20 2020 202e 2e2e 2020 2020 2224   (.    ...    "$
-0000fc80: 2053 4531 3031 2041 5353 454d 424c 5920   SE101 ASSEMBLY 
-0000fc90: 4649 4c45 5c6e 220a 2020 2020 2e2e 2e20  FILE\n".    ... 
-0000fca0: 2020 2022 5345 4255 4c4b 2c31 3031 2c45     "SEBULK,101,E
-0000fcb0: 5854 4f50 342c 2c4d 414e 5541 4c2c 2c2c  XTOP4,,MANUAL,,,
-0000fcc0: 3130 315c 6e22 0a20 2020 202e 2e2e 2020  101\n".    ...  
-0000fcd0: 2020 2253 4543 4f4e 4354 2c31 3031 2c30    "SECONCT,101,0
-0000fce0: 2c2c 4e4f 5c6e 220a 2020 2020 2e2e 2e20  ,,NO\n".    ... 
-0000fcf0: 2020 2022 2c33 2c33 2c31 3130 2c31 3130     ",3,3,110,110
-0000fd00: 2c31 392c 3139 2c32 372c 3237 5c6e 220a  ,19,19,27,27\n".
-0000fd10: 2020 2020 2e2e 2e20 2020 2022 2420 436f      ...    "$ Co
-0000fd20: 6f72 6469 6e61 7465 2031 303a 5c6e 220a  ordinate 10:\n".
-0000fd30: 2020 2020 2e2e 2e20 2020 2022 434f 5244      ...    "CORD
-0000fd40: 3252 2c31 302c 302c 302e 302c 302e 302c  2R,10,0,0.0,0.0,
-0000fd50: 302e 302c 312e 302c 302e 302c 302e 305c  0.0,1.0,0.0,0.0\
-0000fd60: 6e22 0a20 2020 202e 2e2e 2020 2020 222c  n".    ...    ",
-0000fd70: 302e 302c 312e 302c 302e 305c 6e22 0a20  0.0,1.0,0.0\n". 
-0000fd80: 2020 202e 2e2e 2020 2020 2247 5249 442c     ...    "GRID,
-0000fd90: 332c 302c 3630 302e 2c30 2e2c 3330 302e  3,0,600.,0.,300.
-0000fda0: 2c30 5c6e 220a 2020 2020 2e2e 2e20 2020  ,0\n".    ...   
-0000fdb0: 2022 4752 4944 2c31 392c 302c 3630 302e   "GRID,19,0,600.
-0000fdc0: 2c33 3030 2e2c 302e 2c30 5c6e 220a 2020  ,300.,0.,0\n".  
-0000fdd0: 2020 2e2e 2e20 2020 2022 4752 4944 2c32    ...    "GRID,2
-0000fde0: 372c 302c 3630 302e 2c30 2e2c 302e 5c6e  7,0,600.,0.,0.\n
-0000fdf0: 220a 2020 2020 2e2e 2e20 2020 2022 5350  ".    ...    "SP
-0000fe00: 4f49 4e54 2c31 3130 5c6e 220a 2020 2020  OINT,110\n".    
-0000fe10: 2e2e 2e20 290a 2020 2020 3e3e 3e20 7769  ... ).    >>> wi
-0000fe20: 7468 2053 7472 696e 6749 4f28 6173 6d5f  th StringIO(asm_
-0000fe30: 6275 6c6b 2920 6173 2066 3a0a 2020 2020  bulk) as f:.    
-0000fe40: 2e2e 2e20 2020 2020 752c 2063 2c20 6220  ...     u, c, b 
-0000fe50: 3d20 6e61 7374 7261 6e2e 6173 6d32 7573  = nastran.asm2us
-0000fe60: 6574 2866 290a 2020 2020 3e3e 3e20 7520  et(f).    >>> u 
-0000fe70: 2020 2020 2020 2020 2020 2023 2064 6f63             # doc
-0000fe80: 7465 7374 3a20 2b45 4c4c 4950 5349 530a  test: +ELLIPSIS.
-0000fe90: 2020 2020 2020 2020 2020 2020 2020 6e61                na
-0000fea0: 7373 6574 2020 2020 2020 7820 2020 2020  sset      x     
-0000feb0: 2079 2020 2020 2020 7a0a 2020 2020 6964   y      z.    id
-0000fec0: 2020 646f 662e 2e2e 0a20 2020 2033 2020    dof....    3  
-0000fed0: 2031 2020 2020 3230 3937 3135 3420 2036   1    2097154  6
-0000fee0: 3030 2e30 2020 2020 302e 3020 2033 3030  00.0    0.0  300
-0000fef0: 2e30 0a20 2020 2020 2020 2032 2020 2020  .0.        2    
-0000ff00: 3230 3937 3135 3420 2020 2030 2e30 2020  2097154    0.0  
-0000ff10: 2020 312e 3020 2020 2030 2e30 0a20 2020    1.0    0.0.   
-0000ff20: 2020 2020 2033 2020 2020 3230 3937 3135       3    209715
-0000ff30: 3420 2020 2030 2e30 2020 2020 302e 3020  4    0.0    0.0 
-0000ff40: 2020 2030 2e30 0a20 2020 2020 2020 2034     0.0.        4
-0000ff50: 2020 2020 3230 3937 3135 3420 2020 2031      2097154    1
-0000ff60: 2e30 2020 2020 302e 3020 2020 2030 2e30  .0    0.0    0.0
-0000ff70: 0a20 2020 2020 2020 2035 2020 2020 3230  .        5    20
-0000ff80: 3937 3135 3420 2020 2030 2e30 2020 2020  97154    0.0    
-0000ff90: 312e 3020 2020 2030 2e30 0a20 2020 2020  1.0    0.0.     
-0000ffa0: 2020 2036 2020 2020 3230 3937 3135 3420     6    2097154 
-0000ffb0: 2020 2030 2e30 2020 2020 302e 3020 2020     0.0    0.0   
-0000ffc0: 2031 2e30 0a20 2020 2031 3130 2030 2020   1.0.    110 0  
-0000ffd0: 2020 3431 3934 3330 3420 2020 2030 2e30    4194304    0.0
-0000ffe0: 2020 2020 302e 3020 2020 2030 2e30 0a20      0.0    0.0. 
-0000fff0: 2020 2031 3920 2031 2020 2020 3230 3937     19  1    2097
-00010000: 3135 3420 2036 3030 2e30 2020 3330 302e  154  600.0  300.
-00010010: 3020 2020 2030 2e30 0a20 2020 2020 2020  0    0.0.       
-00010020: 2032 2020 2020 3230 3937 3135 3420 2020   2    2097154   
-00010030: 2030 2e30 2020 2020 312e 3020 2020 2030   0.0    1.0    0
-00010040: 2e30 0a20 2020 2020 2020 2033 2020 2020  .0.        3    
-00010050: 3230 3937 3135 3420 2020 2030 2e30 2020  2097154    0.0  
-00010060: 2020 302e 3020 2020 2030 2e30 0a20 2020    0.0    0.0.   
-00010070: 2020 2020 2034 2020 2020 3230 3937 3135       4    209715
-00010080: 3420 2020 2031 2e30 2020 2020 302e 3020  4    1.0    0.0 
-00010090: 2020 2030 2e30 0a20 2020 2020 2020 2035     0.0.        5
-000100a0: 2020 2020 3230 3937 3135 3420 2020 2030      2097154    0
-000100b0: 2e30 2020 2020 312e 3020 2020 2030 2e30  .0    1.0    0.0
-000100c0: 0a20 2020 2020 2020 2036 2020 2020 3230  .        6    20
-000100d0: 3937 3135 3420 2020 2030 2e30 2020 2020  97154    0.0    
-000100e0: 302e 3020 2020 2031 2e30 0a20 2020 2032  0.0    1.0.    2
-000100f0: 3720 2031 2020 2020 3230 3937 3135 3420  7  1    2097154 
-00010100: 2036 3030 2e30 2020 2020 302e 3020 2020   600.0    0.0   
-00010110: 2030 2e30 0a20 2020 2020 2020 2032 2020   0.0.        2  
-00010120: 2020 3230 3937 3135 3420 2020 2030 2e30    2097154    0.0
-00010130: 2020 2020 312e 3020 2020 2030 2e30 0a20      1.0    0.0. 
-00010140: 2020 2020 2020 2033 2020 2020 3230 3937         3    2097
-00010150: 3135 3420 2020 2030 2e30 2020 2020 302e  154    0.0    0.
-00010160: 3020 2020 2030 2e30 0a20 2020 2020 2020  0    0.0.       
-00010170: 2034 2020 2020 3230 3937 3135 3420 2020   4    2097154   
-00010180: 2031 2e30 2020 2020 302e 3020 2020 2030   1.0    0.0    0
-00010190: 2e30 0a20 2020 2020 2020 2035 2020 2020  .0.        5    
-000101a0: 3230 3937 3135 3420 2020 2030 2e30 2020  2097154    0.0  
-000101b0: 2020 312e 3020 2020 2030 2e30 0a20 2020    1.0    0.0.   
-000101c0: 2020 2020 2036 2020 2020 3230 3937 3135       6    209715
-000101d0: 3420 2020 2030 2e30 2020 2020 302e 3020  4    0.0    0.0 
-000101e0: 2020 2031 2e30 0a20 2020 203e 3e3e 2063     1.0.    >>> c
-000101f0: 2020 2020 2020 2020 2020 2020 2320 646f              # do
-00010200: 6374 6573 743a 202b 534b 4950 0a20 2020  ctest: +SKIP.   
-00010210: 207b 303a 2061 7272 6179 285b 5b20 302e   {0: array([[ 0.
-00010220: 2c20 2031 2e2c 2020 302e 5d2c 0a20 2020  ,  1.,  0.],.   
-00010230: 2020 2020 2020 2020 205b 2030 2e2c 2020           [ 0.,  
-00010240: 302e 2c20 2030 2e5d 2c0a 2020 2020 2020  0.,  0.],.      
-00010250: 2020 2020 2020 5b20 312e 2c20 2030 2e2c        [ 1.,  0.,
-00010260: 2020 302e 5d2c 0a20 2020 2020 2020 2020    0.],.         
-00010270: 2020 205b 2030 2e2c 2020 312e 2c20 2030     [ 0.,  1.,  0
-00010280: 2e5d 2c0a 2020 2020 2020 2020 2020 2020  .],.            
-00010290: 5b20 302e 2c20 2030 2e2c 2020 312e 5d5d  [ 0.,  0.,  1.]]
-000102a0: 292c 0a20 2020 2020 3130 3a20 6172 7261  ),.     10: arra
-000102b0: 7928 5b5b 2031 302e 2c20 2020 312e 2c20  y([[ 10.,   1., 
-000102c0: 2020 302e 5d2c 0a20 2020 2020 2020 2020    0.],.         
-000102d0: 2020 205b 2020 302e 2c20 2020 302e 2c20     [  0.,   0., 
-000102e0: 2020 302e 5d2c 0a20 2020 2020 2020 2020    0.],.         
-000102f0: 2020 205b 2020 302e 2c20 2020 302e 2c20     [  0.,   0., 
-00010300: 2020 312e 5d2c 0a20 2020 2020 2020 2020    1.],.         
-00010310: 2020 205b 2020 312e 2c20 2020 302e 2c20     [  1.,   0., 
-00010320: 2020 302e 5d2c 0a20 2020 2020 2020 2020    0.],.         
-00010330: 2020 205b 2020 302e 2c20 2020 312e 2c20     [  0.,   1., 
-00010340: 2020 302e 5d5d 297d 0a20 2020 203e 3e3e    0.]])}.    >>>
-00010350: 206e 702e 7365 745f 7072 696e 746f 7074   np.set_printopt
-00010360: 696f 6e73 286c 696e 6577 6964 7468 3d35  ions(linewidth=5
-00010370: 3529 0a20 2020 203e 3e3e 2062 0a20 2020  5).    >>> b.   
-00010380: 2061 7272 6179 285b 2054 7275 652c 2020   array([ True,  
-00010390: 5472 7565 2c20 2054 7275 652c 2020 5472  True,  True,  Tr
-000103a0: 7565 2c20 2054 7275 652c 2020 5472 7565  ue,  True,  True
-000103b0: 2c20 4661 6c73 652c 0a20 2020 2020 2020  , False,.       
-000103c0: 2020 2020 2054 7275 652c 2020 5472 7565       True,  True
-000103d0: 2c20 2054 7275 652c 2020 5472 7565 2c20  ,  True,  True, 
-000103e0: 2054 7275 652c 2020 5472 7565 2c20 2054   True,  True,  T
-000103f0: 7275 652c 0a20 2020 2020 2020 2020 2020  rue,.           
-00010400: 2054 7275 652c 2020 5472 7565 2c20 2054   True,  True,  T
-00010410: 7275 652c 2020 5472 7565 2c20 2054 7275  rue,  True,  Tru
-00010420: 655d 2c20 6474 7970 653d 626f 6f6c 290a  e], dtype=bool).
-00010430: 2020 2020 2222 220a 2020 2020 7573 6574      """.    uset
-00010440: 2c20 636f 6f72 6473 203d 2062 756c 6b32  , coords = bulk2
-00010450: 7573 6574 2866 290a 0a20 2020 2023 2061  uset(f)..    # a
-00010460: 6464 2073 706f 696e 7473 2074 6f20 7573  dd spoints to us
-00010470: 6574 2074 6162 6c65 3a0a 2020 2020 7370  et table:.    sp
-00010480: 6f69 6e74 7320 3d20 7264 7370 6f69 6e74  oints = rdspoint
-00010490: 7328 6629 0a20 2020 2069 6620 7370 6f69  s(f).    if spoi
-000104a0: 6e74 7320 6973 206e 6f74 204e 6f6e 653a  nts is not None:
-000104b0: 0a20 2020 2020 2020 206e 203d 206c 656e  .        n = len
-000104c0: 2873 706f 696e 7473 290a 2020 2020 2020  (spoints).      
-000104d0: 2020 646f 6620 3d20 6e70 2e7a 6572 6f73    dof = np.zeros
-000104e0: 2828 6e2c 2032 292c 206e 702e 696e 7436  ((n, 2), np.int6
-000104f0: 3429 0a20 2020 2020 2020 2064 6f66 5b3a  4).        dof[:
-00010500: 2c20 305d 203d 2073 706f 696e 7473 0a20  , 0] = spoints. 
-00010510: 2020 2020 2020 2075 7365 745f 7370 6f69         uset_spoi
-00010520: 6e74 7320 3d20 6e32 702e 6d61 6b65 5f75  nts = n2p.make_u
-00010530: 7365 7428 646f 662c 206e 3270 2e6d 6b75  set(dof, n2p.mku
-00010540: 7365 746d 6173 6b28 2271 2229 2c20 6e70  setmask("q"), np
-00010550: 2e7a 6572 6f73 2828 6e2c 2033 2929 290a  .zeros((n, 3))).
-00010560: 2020 2020 2020 2020 7573 6574 203d 2070          uset = p
-00010570: 642e 636f 6e63 6174 285b 7573 6574 2c20  d.concat([uset, 
-00010580: 7573 6574 5f73 706f 696e 7473 5d2c 2061  uset_spoints], a
-00010590: 7869 733d 3029 0a0a 2020 2020 6966 2074  xis=0)..    if t
-000105a0: 7279 5f72 6465 7874 726e 3a0a 2020 2020  ry_rdextrn:.    
-000105b0: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
-000105c0: 2020 2020 2066 696c 656e 616d 6520 3d20       filename = 
-000105d0: 662e 6e61 6d65 0a20 2020 2020 2020 2065  f.name.        e
-000105e0: 7863 6570 7420 4174 7472 6962 7574 6545  xcept AttributeE
-000105f0: 7272 6f72 3a0a 2020 2020 2020 2020 2020  rror:.          
-00010600: 2020 7061 7373 0a20 2020 2020 2020 2065    pass.        e
-00010610: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00010620: 2064 6f66 203d 2072 6465 7874 726e 2866   dof = rdextrn(f
-00010630: 696c 656e 616d 652e 7265 706c 6163 6528  ilename.replace(
-00010640: 222e 6173 6d22 2c20 222e 7063 6822 2929  ".asm", ".pch"))
-00010650: 0a20 2020 2020 2020 2020 2020 2075 7365  .            use
-00010660: 745f 6f72 6465 7265 6420 3d20 7573 6574  t_ordered = uset
-00010670: 2e6c 6f63 5b6c 6973 7428 646f 6629 5d0a  .loc[list(dof)].
-00010680: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-00010690: 726e 2075 7365 745f 6f72 6465 7265 642c  rn uset_ordered,
-000106a0: 2063 6f6f 7264 732c 206e 3270 2e6d 6b73   coords, n2p.mks
-000106b0: 6574 7076 2875 7365 745f 6f72 6465 7265  etpv(uset_ordere
-000106c0: 642c 2022 6122 2c20 2262 2229 0a0a 2020  d, "a", "b")..  
-000106d0: 2020 615f 6964 7320 3d20 7264 7365 636f    a_ids = rdseco
-000106e0: 6e63 7428 6629 5b30 5d0a 2020 2020 7573  nct(f)[0].    us
-000106f0: 6574 5f6f 7264 6572 6564 203d 2075 7365  et_ordered = use
-00010700: 742e 6c6f 635b 615f 6964 735d 0a20 2020  t.loc[a_ids].   
-00010710: 2069 6620 7573 6574 5f6f 7264 6572 6564   if uset_ordered
-00010720: 2e73 6861 7065 5b30 5d20 213d 2075 7365  .shape[0] != use
-00010730: 742e 7368 6170 655b 305d 3a0a 2020 2020  t.shape[0]:.    
-00010740: 2020 2020 7261 6973 6520 5275 6e74 696d      raise Runtim
-00010750: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
-00010760: 2020 2020 224e 756d 6265 7220 6f66 2053      "Number of S
-00010770: 4543 4f4e 4354 2073 7570 6572 656c 656d  ECONCT superelem
-00010780: 656e 7420 2741 2720 444f 4620 646f 206e  ent 'A' DOF do n
-00010790: 6f74 206d 6174 6368 2047 5249 4420 616e  ot match GRID an
-000107a0: 6422 0a20 2020 2020 2020 2020 2020 2022  d".            "
-000107b0: 2053 504f 494e 5420 6361 7264 7320 696e   SPOINT cards in
-000107c0: 2066 696c 653a 5c6e 220a 2020 2020 2020   file:\n".      
-000107d0: 2020 2020 2020 6622 2020 2020 2320 444f        f"    # DO
-000107e0: 4620 6f6e 2053 4543 4f4e 4354 203d 207b  F on SECONCT = {
-000107f0: 7573 6574 5f6f 7264 6572 6564 2e73 6861  uset_ordered.sha
-00010800: 7065 5b30 5d7d 5c6e 220a 2020 2020 2020  pe[0]}\n".      
-00010810: 2020 2020 2020 6622 2020 2020 2320 444f        f"    # DO
-00010820: 4620 6f6e 2047 5249 4453 2f53 504f 494e  F on GRIDS/SPOIN
-00010830: 5453 203d 207b 7573 6574 2e73 6861 7065  TS = {uset.shape
-00010840: 5b30 5d7d 220a 2020 2020 2020 2020 290a  [0]}".        ).
-00010850: 0a20 2020 2072 6574 7572 6e20 7573 6574  .    return uset
-00010860: 5f6f 7264 6572 6564 2c20 636f 6f72 6473  _ordered, coords
-00010870: 2c20 6e32 702e 6d6b 7365 7470 7628 7573  , n2p.mksetpv(us
-00010880: 6574 5f6f 7264 6572 6564 2c20 2261 222c  et_ordered, "a",
-00010890: 2022 6222 290a 0a0a 6465 6620 7264 7774   "b")...def rdwt
-000108a0: 6275 6c6b 2866 696e 2c20 666f 7574 293a  bulk(fin, fout):
-000108b0: 0a20 2020 2022 2222 0a20 2020 2047 6574  .    """.    Get
-000108c0: 2062 756c 6b20 6461 7461 2066 726f 6d20   bulk data from 
-000108d0: 6120 736f 7274 6564 204e 6173 7472 616e  a sorted Nastran
-000108e0: 206f 7574 7075 7420 6669 6c65 2e0a 0a20   output file... 
-000108f0: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
-00010900: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
-00010910: 2066 696e 203a 2073 7472 696e 6720 6f72   fin : string or
-00010920: 2066 696c 655f 6c69 6b65 206f 7220 4e6f   file_like or No
-00010930: 6e65 0a20 2020 2020 2020 2045 6974 6865  ne.        Eithe
-00010940: 7220 6120 6e61 6d65 206f 6620 6120 6669  r a name of a fi
-00010950: 6c65 2c20 6f72 2069 7320 6120 6669 6c65  le, or is a file
-00010960: 5f6c 696b 6520 6f62 6a65 6374 2061 7320  _like object as 
-00010970: 7265 7475 726e 6564 0a20 2020 2020 2020  returned.       
-00010980: 2062 7920 3a66 756e 633a 606f 7065 6e60   by :func:`open`
-00010990: 2e20 4966 2066 696c 655f 6c69 6b65 206f  . If file_like o
-000109a0: 626a 6563 742c 2069 7420 6973 2072 6577  bject, it is rew
-000109b0: 6f75 6e64 2066 6972 7374 2e20 4361 6e0a  ound first. Can.
-000109c0: 2020 2020 2020 2020 616c 736f 2062 6520          also be 
-000109d0: 7468 6520 6e61 6d65 206f 6620 6120 6469  the name of a di
-000109e0: 7265 6374 6f72 7920 6f72 204e 6f6e 653b  rectory or None;
-000109f0: 2069 6e20 7468 6573 6520 6361 7365 732c   in these cases,
-00010a00: 2061 2047 5549 0a20 2020 2020 2020 2069   a GUI.        i
-00010a10: 7320 6f70 656e 6564 2066 6f72 2066 696c  s opened for fil
-00010a20: 6520 7365 6c65 6374 696f 6e2e 0a20 2020  e selection..   
-00010a30: 2066 6f75 7420 3a20 7374 7269 6e67 206f   fout : string o
-00010a40: 7220 6669 6c65 5f6c 696b 6520 6f72 2031  r file_like or 1
-00010a50: 206f 7220 4e6f 6e65 0a20 2020 2020 2020   or None.       
-00010a60: 2045 6974 6865 7220 6120 6e61 6d65 206f   Either a name o
-00010a70: 6620 6120 6669 6c65 2c20 6f72 2069 7320  f a file, or is 
-00010a80: 6120 6669 6c65 5f6c 696b 6520 6f62 6a65  a file_like obje
-00010a90: 6374 2061 7320 7265 7475 726e 6564 0a20  ct as returned. 
-00010aa0: 2020 2020 2020 2062 7920 3a66 756e 633a         by :func:
-00010ab0: 606f 7065 6e60 206f 7220 3a63 6c61 7373  `open` or :class
-00010ac0: 3a60 696f 2e53 7472 696e 6749 4f60 2e20  :`io.StringIO`. 
-00010ad0: 496e 7075 7420 6173 2069 6e74 6567 6572  Input as integer
-00010ae0: 2031 2074 6f0a 2020 2020 2020 2020 7772   1 to.        wr
-00010af0: 6974 6520 746f 2073 7464 6f75 742e 2043  ite to stdout. C
-00010b00: 616e 2061 6c73 6f20 6265 2074 6865 206e  an also be the n
-00010b10: 616d 6520 6f66 2061 2064 6972 6563 746f  ame of a directo
-00010b20: 7279 206f 7220 4e6f 6e65 3b0a 2020 2020  ry or None;.    
-00010b30: 2020 2020 696e 2074 6865 7365 2063 6173      in these cas
-00010b40: 6573 2c20 6120 4755 4920 6973 206f 7065  es, a GUI is ope
-00010b50: 6e65 6420 666f 7220 6669 6c65 2073 656c  ned for file sel
-00010b60: 6563 7469 6f6e 2e0a 0a20 2020 2052 6574  ection...    Ret
-00010b70: 7572 6e73 0a20 2020 202d 2d2d 2d2d 2d2d  urns.    -------
-00010b80: 0a20 2020 204e 6f6e 650a 0a20 2020 204e  .    None..    N
-00010b90: 6f74 6573 0a20 2020 202d 2d2d 2d2d 0a20  otes.    -----. 
-00010ba0: 2020 2052 6561 6473 2074 6865 2062 756c     Reads the bul
-00010bb0: 6b20 6461 7461 2066 726f 6d20 696e 7075  k data from inpu
-00010bc0: 7420 6669 6c65 2061 6e64 2077 7269 7465  t file and write
-00010bd0: 7320 6974 2074 6f20 7468 6520 6f75 7470  s it to the outp
-00010be0: 7574 0a20 2020 2066 696c 652e 2041 6c6c  ut.    file. All
-00010bf0: 2063 6f6e 7469 6e75 6174 696f 6e20 636f   continuation co
-00010c00: 6465 7320 6172 6520 7374 7269 7070 6564  des are stripped
-00010c10: 206f 6666 2e0a 0a20 2020 2048 6173 206e   off...    Has n
-00010c20: 6f74 2062 6565 6e20 7465 7374 6564 206f  ot been tested o
-00010c30: 6e20 756e 736f 7274 6564 2062 756c 6b2e  n unsorted bulk.
-00010c40: 0a0a 2020 2020 4578 616d 706c 6520 7573  ..    Example us
-00010c50: 6167 653a 3a0a 0a20 2020 2020 2020 2066  age::..        f
-00010c60: 726f 6d20 7079 7965 7469 2069 6d70 6f72  rom pyyeti impor
-00010c70: 7420 6e61 7374 7261 6e0a 2020 2020 2020  t nastran.      
-00010c80: 2020 6e61 7374 7261 6e2e 7264 7774 6275    nastran.rdwtbu
-00010c90: 6c6b 2827 6d65 636f 312e 6f75 7427 2c20  lk('meco1.out', 
-00010ca0: 276d 6563 6f31 2e62 6c6b 2729 0a20 2020  'meco1.blk').   
-00010cb0: 2022 2222 0a0a 2020 2020 4067 7569 746f   """..    @guito
-00010cc0: 6f6c 732e 7265 6164 5f74 6578 745f 6669  ols.read_text_fi
-00010cd0: 6c65 0a20 2020 2064 6566 205f 7264 6275  le.    def _rdbu
-00010ce0: 6c6b 2866 293a 0a20 2020 2020 2020 2066  lk(f):.        f
-00010cf0: 7365 6172 6368 2866 2c20 2243 4f55 4e54  search(f, "COUNT
-00010d00: 2020 2020 2020 2020 2e20 2020 3120 202e          .   1  .
-00010d10: 2e20 2020 3220 202e 2e20 2020 3322 290a  .   2  ..   3").
-00010d20: 2020 2020 2020 2020 7320 3d20 5b5d 0a20          s = []. 
-00010d30: 2020 2020 2020 2070 726f 6720 3d20 7265         prog = re
-00010d40: 2e63 6f6d 7069 6c65 2872 225b 205d 7b31  .compile(r"[ ]{1
-00010d50: 337d 5b20 302d 395d 7b38 7d2d 5b20 5d7b  3}[ 0-9]{8}-[ ]{
-00010d60: 387d 282e 7b37 327d 2922 290a 2020 2020  8}(.{72})").    
-00010d70: 2020 2020 666f 7220 6c69 6e65 2069 6e20      for line in 
-00010d80: 663a 0a20 2020 2020 2020 2020 2020 2069  f:.            i
-00010d90: 6620 6c69 6e65 2e73 7461 7274 7377 6974  f line.startswit
-00010da0: 6828 2220 2020 2020 2020 2020 2020 2020  h("             
-00010db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010dc0: 2045 4e44 4441 5441 2229 3a0a 2020 2020   ENDDATA"):.    
-00010dd0: 2020 2020 2020 2020 2020 2020 6272 6561              brea
-00010de0: 6b0a 2020 2020 2020 2020 2020 2020 6d20  k.            m 
-00010df0: 3d20 7072 6f67 2e6d 6174 6368 286c 696e  = prog.match(lin
-00010e00: 6529 0a20 2020 2020 2020 2020 2020 2069  e).            i
-00010e10: 6620 6d3a 0a20 2020 2020 2020 2020 2020  f m:.           
-00010e20: 2020 2020 206d 6174 6368 203d 206d 2e67       match = m.g
-00010e30: 726f 7570 2831 292e 7374 7269 7028 290a  roup(1).strip().
-00010e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010e50: 6966 206d 6174 6368 5b30 5d20 3d3d 2022  if match[0] == "
-00010e60: 2b22 206f 7220 6d61 7463 685b 305d 203d  +" or match[0] =
-00010e70: 3d20 222a 223a 0a20 2020 2020 2020 2020  = "*":.         
-00010e80: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
-00010e90: 6e28 6d61 7463 6829 203e 2038 3a0a 2020  n(match) > 8:.  
-00010ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010eb0: 2020 2020 2020 6d61 7463 6820 3d20 6d61        match = ma
-00010ec0: 7463 685b 305d 202b 2022 2020 2020 2020  tch[0] + "      
-00010ed0: 2022 202b 206d 6174 6368 5b38 3a5d 0a20   " + match[8:]. 
-00010ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010ef0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00008190: 2020 2020 2020 6272 6561 6b0a 2020 2020        break.    
+000081a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000081b0: 6164 645f 6964 646f 6628 726f 775f 6964  add_iddof(row_id
+000081c0: 732c 2072 6f77 5f69 6464 6f66 2c20 6e69  s, row_iddof, ni
+000081d0: 642c 2064 6f66 290a 0a20 2020 2020 2020  d, dof)..       
+000081e0: 2020 2020 2023 2063 7265 6174 6520 6461       # create da
+000081f0: 7461 6672 616d 653a 0a20 2020 2020 2020  taframe:.       
+00008200: 2020 2020 206d 6174 2c20 726f 7769 6e64       mat, rowind
+00008210: 6578 2c20 636f 6c69 6e64 6578 203d 205f  ex, colindex = _
+00008220: 7072 6570 5f64 6174 6166 7261 6d65 280a  prep_dataframe(.
+00008230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008240: 6d74 7970 652c 2066 6f72 6d2c 2072 6f77  mtype, form, row
+00008250: 5f69 6473 2c20 726f 775f 6964 646f 662c  _ids, row_iddof,
+00008260: 2063 6f6c 5f69 6464 6f66 2c20 6e63 6f6c   col_iddof, ncol
+00008270: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
+00008280: 2020 2020 2020 2020 2020 2020 2320 7075              # pu
+00008290: 7420 6461 7461 2069 6e74 6f20 6461 7461  t data into data
+000082a0: 6672 616d 653a 0a20 2020 2020 2020 2020  frame:.         
+000082b0: 2020 2023 2064 6620 3d20 6463 745b 6e61     # df = dct[na
+000082c0: 6d65 5d0a 2020 2020 2020 2020 2020 2020  me].            
+000082d0: 725f 6964 5f64 6f66 203d 205f 6765 745f  r_id_dof = _get_
+000082e0: 3164 5f69 6e64 6578 2872 6f77 696e 6465  1d_index(rowinde
+000082f0: 7829 0a20 2020 2020 2020 2020 2020 2069  x).            i
+00008300: 6620 666f 726d 2021 3d20 393a 0a20 2020  f form != 9:.   
+00008310: 2020 2020 2020 2020 2020 2020 2063 5f69               c_i
+00008320: 645f 646f 6620 3d20 5f67 6574 5f31 645f  d_dof = _get_1d_
+00008330: 696e 6465 7828 636f 6c69 6e64 6578 290a  index(colindex).
+00008340: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00008350: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00008360: 2020 635f 6964 5f64 6f66 203d 2063 6f6c    c_id_dof = col
+00008370: 696e 6465 780a 2020 2020 2020 2020 2020  index.          
+00008380: 2020 6a20 3d20 3132 0a20 2020 2020 2020    j = 12.       
+00008390: 2020 2020 2077 6869 6c65 206a 203c 206c       while j < l
+000083a0: 656e 2872 6563 2920 2d20 323a 0a20 2020  en(rec) - 2:.   
+000083b0: 2020 2020 2020 2020 2020 2020 206e 6964               nid
+000083c0: 2c20 646f 6620 3d20 7265 635b 6a20 3a20  , dof = rec[j : 
+000083d0: 6a20 2b20 325d 0a20 2020 2020 2020 2020  j + 2].         
+000083e0: 2020 2020 2020 2069 6620 666f 726d 2021         if form !
+000083f0: 3d20 393a 0a20 2020 2020 2020 2020 2020  = 9:.           
+00008400: 2020 2020 2020 2020 206e 6964 203d 206e           nid = n
+00008410: 6964 202a 2031 3020 2b20 646f 660a 2020  id * 10 + dof.  
+00008420: 2020 2020 2020 2020 2020 2020 2020 6369                ci
+00008430: 203d 206e 702e 7365 6172 6368 736f 7274   = np.searchsort
+00008440: 6564 2863 5f69 645f 646f 662c 206e 6964  ed(c_id_dof, nid
+00008450: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
+00008460: 2020 206a 202b 3d20 320a 2020 2020 2020     j += 2.      
+00008470: 2020 2020 2020 2020 2020 6e69 6420 3d20            nid = 
+00008480: 7265 635b 6a5d 0a20 2020 2020 2020 2020  rec[j].         
+00008490: 2020 2020 2020 2077 6869 6c65 206e 6964         while nid
+000084a0: 2021 3d20 2d31 3a0a 2020 2020 2020 2020   != -1:.        
+000084b0: 2020 2020 2020 2020 2020 2020 646f 6620              dof 
+000084c0: 3d20 7265 635b 6a20 2b20 315d 0a20 2020  = rec[j + 1].   
+000084d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000084e0: 206a 202b 3d20 320a 2020 2020 2020 2020   j += 2.        
+000084f0: 2020 2020 2020 2020 2020 2020 7661 6c20              val 
+00008500: 3d20 7265 635b 6a20 3a20 6a20 2b20 696e  = rec[j : j + in
+00008510: 7473 5f70 6572 5f6e 756d 6265 725d 0a20  ts_per_number]. 
+00008520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008530: 2020 2076 616c 2e64 7479 7065 203d 2064     val.dtype = d
+00008540: 7479 7065 0a20 2020 2020 2020 2020 2020  type.           
+00008550: 2020 2020 2020 2020 206a 202b 3d20 696e           j += in
+00008560: 7473 5f70 6572 5f6e 756d 6265 720a 2020  ts_per_number.  
+00008570: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008580: 2020 7269 203d 206e 702e 7365 6172 6368    ri = np.search
+00008590: 736f 7274 6564 2872 5f69 645f 646f 662c  sorted(r_id_dof,
+000085a0: 206e 6964 202a 2031 3020 2b20 646f 6629   nid * 10 + dof)
+000085b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000085c0: 2020 2020 206d 6174 5b72 692c 2063 695d       mat[ri, ci]
+000085d0: 203d 2076 616c 0a20 2020 2020 2020 2020   = val.         
+000085e0: 2020 2020 2020 2020 2020 2069 6620 666f             if fo
+000085f0: 726d 203d 3d20 363a 0a20 2020 2020 2020  rm == 6:.       
+00008600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008610: 206d 6174 5b63 692c 2072 695d 203d 2076   mat[ci, ri] = v
+00008620: 616c 0a20 2020 2020 2020 2020 2020 2020  al.             
+00008630: 2020 2020 2020 206e 6964 203d 2072 6563         nid = rec
+00008640: 5b6a 5d0a 2020 2020 2020 2020 2020 2020  [j].            
+00008650: 2020 2020 6a20 2b3d 2032 0a20 2020 2020      j += 2.     
+00008660: 2020 2020 2020 2064 6374 5b6e 616d 655d         dct[name]
+00008670: 203d 2070 642e 4461 7461 4672 616d 6528   = pd.DataFrame(
+00008680: 6d61 742c 2069 6e64 6578 3d72 6f77 696e  mat, index=rowin
+00008690: 6465 782c 2063 6f6c 756d 6e73 3d63 6f6c  dex, columns=col
+000086a0: 696e 6465 7829 0a20 2020 2020 2020 2072  index).        r
+000086b0: 6574 7572 6e20 6463 740a 0a20 2020 2023  eturn dct..    #
+000086c0: 204d 4149 4e20 726f 7574 696e 650a 2020   MAIN routine.  
+000086d0: 2020 6966 2065 7870 616e 6465 643a 0a20    if expanded:. 
+000086e0: 2020 2020 2020 2061 6464 5f69 6464 6f66         add_iddof
+000086f0: 203d 205f 6164 645f 6964 646f 665f 6578   = _add_iddof_ex
+00008700: 7061 6e64 6564 0a20 2020 2020 2020 2069  panded.        i
+00008710: 6464 6f66 5f69 6e69 7469 616c 697a 6572  ddof_initializer
+00008720: 203d 206c 6973 740a 2020 2020 656c 7365   = list.    else
+00008730: 3a0a 2020 2020 2020 2020 6164 645f 6964  :.        add_id
+00008740: 646f 6620 3d20 5f61 6464 5f69 6464 6f66  dof = _add_iddof
+00008750: 5f6d 696e 696d 616c 0a20 2020 2020 2020  _minimal.       
+00008760: 2069 6464 6f66 5f69 6e69 7469 616c 697a   iddof_initializ
+00008770: 6572 203d 2073 6574 0a0a 2020 2020 6966  er = set..    if
+00008780: 2064 6d69 675f 6e61 6d65 7320 6973 206e   dmig_names is n
+00008790: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
+000087a0: 2069 6620 6973 696e 7374 616e 6365 2864   if isinstance(d
+000087b0: 6d69 675f 6e61 6d65 732c 2073 7472 293a  mig_names, str):
+000087c0: 0a20 2020 2020 2020 2020 2020 2064 6d69  .            dmi
+000087d0: 675f 6e61 6d65 7320 3d20 2864 6d69 675f  g_names = (dmig_
+000087e0: 6e61 6d65 732c 290a 2020 2020 2020 2020  names,).        
+000087f0: 646d 6967 5f6e 616d 6573 203d 205b 692e  dmig_names = [i.
+00008800: 6c6f 7765 7228 2920 666f 7220 6920 696e  lower() for i in
+00008810: 2064 6d69 675f 6e61 6d65 735d 0a0a 2020   dmig_names]..  
+00008820: 2020 6966 2066 2069 7320 6e6f 7420 4e6f    if f is not No
+00008830: 6e65 2061 6e64 206e 6f74 2069 7369 6e73  ne and not isins
+00008840: 7461 6e63 6528 662c 2073 7472 293a 0a20  tance(f, str):. 
+00008850: 2020 2020 2020 2023 2061 7373 756d 6520         # assume 
+00008860: 6669 6c65 2068 616e 646c 652c 2061 7373  file handle, ass
+00008870: 756d 6520 7075 6e63 680a 2020 2020 2020  ume punch.      
+00008880: 2020 6361 7264 7320 3d20 7264 6361 7264    cards = rdcard
+00008890: 7328 662c 206e 616d 653d 2264 6d69 6722  s(f, name="dmig"
+000088a0: 2c20 7265 7475 726e 5f76 6172 3d22 6c69  , return_var="li
+000088b0: 7374 222c 2062 6c61 6e6b 3d22 2229 0a20  st", blank=""). 
+000088c0: 2020 2020 2020 2072 6574 7572 6e20 5f63         return _c
+000088d0: 6172 6473 5f74 6f5f 6466 2863 6172 6473  ards_to_df(cards
+000088e0: 2c20 646d 6967 5f6e 616d 6573 290a 0a20  , dmig_names).. 
+000088f0: 2020 2023 2072 6561 6420 6f70 3220 6f72     # read op2 or
+00008900: 2070 756e 6368 202e 2e2e 2074 7279 206f   punch ... try o
+00008910: 7032 2c20 6966 2074 6861 7420 6661 696c  p2, if that fail
+00008920: 732c 2061 7373 756d 6520 7075 6e63 683a  s, assume punch:
+00008930: 0a20 2020 2064 6d69 6766 696c 6520 3d20  .    dmigfile = 
+00008940: 6775 6974 6f6f 6c73 2e67 6574 5f66 696c  guitools.get_fil
+00008950: 655f 6e61 6d65 2866 2c20 7265 6164 3d54  e_name(f, read=T
+00008960: 7275 6529 0a20 2020 2074 7279 3a0a 2020  rue).    try:.  
+00008970: 2020 2020 2020 6f32 203d 206f 7032 2e4f        o2 = op2.O
+00008980: 5032 2864 6d69 6766 696c 6529 0a20 2020  P2(dmigfile).   
+00008990: 2065 7863 6570 7420 5661 6c75 6545 7272   except ValueErr
+000089a0: 6f72 3a0a 2020 2020 2020 2020 6361 7264  or:.        card
+000089b0: 7320 3d20 7264 6361 7264 7328 646d 6967  s = rdcards(dmig
+000089c0: 6669 6c65 2c20 6e61 6d65 3d22 646d 6967  file, name="dmig
+000089d0: 222c 2072 6574 7572 6e5f 7661 723d 226c  ", return_var="l
+000089e0: 6973 7422 2c20 626c 616e 6b3d 2222 290a  ist", blank="").
+000089f0: 2020 2020 2020 2020 6463 7420 3d20 5f63          dct = _c
+00008a00: 6172 6473 5f74 6f5f 6466 2863 6172 6473  ards_to_df(cards
+00008a10: 2c20 646d 6967 5f6e 616d 6573 290a 2020  , dmig_names).  
+00008a20: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00008a30: 6f32 6463 7420 3d20 5f72 6561 645f 6f70  o2dct = _read_op
+00008a40: 325f 646d 6967 286f 322c 2064 6d69 675f  2_dmig(o2, dmig_
+00008a50: 6e61 6d65 7329 0a20 2020 2020 2020 2064  names).        d
+00008a60: 656c 206f 320a 2020 2020 2020 2020 6463  el o2.        dc
+00008a70: 7420 3d20 5f72 6563 735f 746f 5f64 6628  t = _recs_to_df(
+00008a80: 6f32 6463 7429 0a20 2020 2072 6574 7572  o2dct).    retur
+00008a90: 6e20 6463 740a 0a0a 6465 6620 6d6b 636f  n dct...def mkco
+00008aa0: 6d6d 656e 7428 636f 6d6d 656e 742c 2077  mment(comment, w
+00008ab0: 6964 7468 3d37 322c 2073 7461 7274 3d22  idth=72, start="
+00008ac0: 2420 222c 2073 7572 726f 756e 643d 5472  $ ", surround=Tr
+00008ad0: 7565 293a 0a20 2020 2072 2222 220a 2020  ue):.    r""".  
+00008ae0: 2020 466f 726d 6174 7320 6120 7374 7269    Formats a stri
+00008af0: 6e67 2069 6e74 6f20 6120 4e61 7374 7261  ng into a Nastra
+00008b00: 6e20 636f 6d6d 656e 7420 7769 7468 2077  n comment with w
+00008b10: 7261 7070 696e 672e 0a0a 2020 2020 5061  rapping...    Pa
+00008b20: 7261 6d65 7465 7273 0a20 2020 202d 2d2d  rameters.    ---
+00008b30: 2d2d 2d2d 2d2d 2d0a 2020 2020 636f 6d6d  -------.    comm
+00008b40: 656e 7420 3a20 7374 7269 6e67 0a20 2020  ent : string.   
+00008b50: 2020 2020 2054 6865 2073 7472 696e 6720       The string 
+00008b60: 746f 2077 7269 7465 206f 7574 2c20 7772  to write out, wr
+00008b70: 6170 7069 6e67 2074 6f20 6077 6964 7468  apping to `width
+00008b80: 6020 6368 6172 6163 7465 7273 2e0a 2020  ` characters..  
+00008b90: 2020 7769 6474 6820 3a20 696e 7465 6765    width : intege
+00008ba0: 723b 206f 7074 696f 6e61 6c0a 2020 2020  r; optional.    
+00008bb0: 2020 2020 5370 6563 6966 7920 6d61 7869      Specify maxi
+00008bc0: 6d75 6d20 6c69 6e65 206c 656e 6774 682e  mum line length.
+00008bd0: 0a20 2020 2073 7461 7274 203a 2073 7472  .    start : str
+00008be0: 696e 673b 206f 7074 696f 6e61 6c0a 2020  ing; optional.  
+00008bf0: 2020 2020 2020 5374 7269 6e67 2028 692e        String (i.
+00008c00: 652e 2022 2420 222c 2022 2320 2229 2074  e. "$ ", "# ") t
+00008c10: 6f20 7374 6172 7420 6561 6368 2063 6f6d  o start each com
+00008c20: 6d65 6e74 206c 696e 6520 7769 7468 2e0a  ment line with..
+00008c30: 2020 2020 7375 7272 6f75 6e64 203a 2062      surround : b
+00008c40: 6f6f 6c3b 206f 7074 696f 6e61 6c0a 2020  ool; optional.  
+00008c50: 2020 2020 2020 4966 2054 7275 652c 2061        If True, a
+00008c60: 206c 6561 6469 6e67 2061 6e64 2074 7261   leading and tra
+00008c70: 696c 696e 6720 626c 616e 6b20 636f 6d6d  iling blank comm
+00008c80: 656e 7420 6c69 6e65 2077 696c 6c20 6265  ent line will be
+00008c90: 0a20 2020 2020 2020 2069 6e63 6c75 6465  .        include
+00008ca0: 642e 0a0a 2020 2020 5265 7475 726e 730a  d...    Returns.
+00008cb0: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
+00008cc0: 7374 7269 6e67 0a20 2020 2020 2020 2054  string.        T
+00008cd0: 6865 2066 6f72 6d61 7474 6564 2063 6f6d  he formatted com
+00008ce0: 6d65 6e74 2e0a 0a20 2020 204e 6f74 6573  ment...    Notes
+00008cf0: 0a20 2020 202d 2d2d 2d2d 0a20 2020 2055  .    -----.    U
+00008d00: 7365 7320 7468 6520 5079 7468 6f6e 2066  ses the Python f
+00008d10: 756e 6374 696f 6e20 3a66 756e 633a 6074  unction :func:`t
+00008d20: 6578 7477 7261 702e 6669 6c6c 6020 746f  extwrap.fill` to
+00008d30: 2066 6f72 6d61 7420 7468 650a 2020 2020   format the.    
+00008d40: 7374 7269 6e67 2e0a 0a20 2020 2045 7861  string...    Exa
+00008d50: 6d70 6c65 730a 2020 2020 2d2d 2d2d 2d2d  mples.    ------
+00008d60: 2d2d 0a20 2020 203e 3e3e 2066 726f 6d20  --.    >>> from 
+00008d70: 7079 7965 7469 2069 6d70 6f72 7420 6e61  pyyeti import na
+00008d80: 7374 7261 6e0a 2020 2020 3e3e 3e20 7320  stran.    >>> s 
+00008d90: 3d20 2827 5468 6973 2069 7320 6120 6c6f  = ('This is a lo
+00008da0: 6e67 2063 6f6d 6d65 6e74 2073 7472 696e  ng comment strin
+00008db0: 6720 746f 2027 0a20 2020 202e 2e2e 2020  g to '.    ...  
+00008dc0: 2020 2020 2764 656d 6f6e 7374 7261 7465      'demonstrate
+00008dd0: 2074 6865 2077 7261 7070 696e 6720 6665   the wrapping fe
+00008de0: 6174 7572 6520 6f66 2027 0a20 2020 202e  ature of '.    .
+00008df0: 2e2e 2020 2020 2020 2774 6869 7320 616c  ..      'this al
+00008e00: 676f 7269 7468 6d2e 2049 7420 7772 6170  gorithm. It wrap
+00008e10: 7320 746f 2037 3220 270a 2020 2020 2e2e  s to 72 '.    ..
+00008e20: 2e20 2020 2020 2027 6368 6172 6163 7465  .      'characte
+00008e30: 7273 2062 7920 6465 6661 756c 742c 2062  rs by default, b
+00008e40: 7574 2074 6861 7420 6361 6e20 270a 2020  ut that can '.  
+00008e50: 2020 2e2e 2e20 2020 2020 2027 6368 616e    ...      'chan
+00008e60: 6765 6420 6279 2074 6865 2075 7365 7220  ged by the user 
+00008e70: 7669 6120 7468 6520 6077 6964 7468 6020  via the `width` 
+00008e80: 270a 2020 2020 2e2e 2e20 2020 2020 2027  '.    ...      '
+00008e90: 6f70 7469 6f6e 2e20 5468 6520 6465 6661  option. The defa
+00008ea0: 756c 7420 7374 6172 7420 666f 7220 6561  ult start for ea
+00008eb0: 6368 2027 0a20 2020 202e 2e2e 2020 2020  ch '.    ...    
+00008ec0: 2020 276c 696e 6520 6973 2022 2420 222c    'line is "$ ",
+00008ed0: 2062 7574 2074 6861 7420 6361 6e20 6265   but that can be
+00008ee0: 2063 6861 6e67 6564 2027 0a20 2020 202e   changed '.    .
+00008ef0: 2e2e 2020 2020 2020 2761 7320 7765 6c6c  ..      'as well
+00008f00: 2e27 290a 2020 2020 3e3e 3e20 7072 696e  .').    >>> prin
+00008f10: 7428 6e61 7374 7261 6e2e 6d6b 636f 6d6d  t(nastran.mkcomm
+00008f20: 656e 7428 732c 2077 6964 7468 3d35 3529  ent(s, width=55)
+00008f30: 2c20 656e 643d 2727 290a 2020 2020 240a  , end='').    $.
+00008f40: 2020 2020 2420 5468 6973 2069 7320 6120      $ This is a 
+00008f50: 6c6f 6e67 2063 6f6d 6d65 6e74 2073 7472  long comment str
+00008f60: 696e 6720 746f 2064 656d 6f6e 7374 7261  ing to demonstra
+00008f70: 7465 2074 6865 0a20 2020 2024 2077 7261  te the.    $ wra
+00008f80: 7070 696e 6720 6665 6174 7572 6520 6f66  pping feature of
+00008f90: 2074 6869 7320 616c 676f 7269 7468 6d2e   this algorithm.
+00008fa0: 2049 7420 7772 6170 7320 746f 2037 320a   It wraps to 72.
+00008fb0: 2020 2020 2420 6368 6172 6163 7465 7273      $ characters
+00008fc0: 2062 7920 6465 6661 756c 742c 2062 7574   by default, but
+00008fd0: 2074 6861 7420 6361 6e20 6368 616e 6765   that can change
+00008fe0: 6420 6279 2074 6865 0a20 2020 2024 2075  d by the.    $ u
+00008ff0: 7365 7220 7669 6120 7468 6520 6077 6964  ser via the `wid
+00009000: 7468 6020 6f70 7469 6f6e 2e20 5468 6520  th` option. The 
+00009010: 6465 6661 756c 7420 7374 6172 7420 666f  default start fo
+00009020: 720a 2020 2020 2420 6561 6368 206c 696e  r.    $ each lin
+00009030: 6520 6973 2022 2420 222c 2062 7574 2074  e is "$ ", but t
+00009040: 6861 7420 6361 6e20 6265 2063 6861 6e67  hat can be chang
+00009050: 6564 2061 7320 7765 6c6c 2e0a 2020 2020  ed as well..    
+00009060: 240a 2020 2020 2222 220a 2020 2020 7320  $.    """.    s 
+00009070: 3d20 280a 2020 2020 2020 2020 7465 7874  = (.        text
+00009080: 7772 6170 2e66 696c 6c28 0a20 2020 2020  wrap.fill(.     
+00009090: 2020 2020 2020 2063 6f6d 6d65 6e74 2c20         comment, 
+000090a0: 7769 6474 683d 7769 6474 682c 2069 6e69  width=width, ini
+000090b0: 7469 616c 5f69 6e64 656e 743d 7374 6172  tial_indent=star
+000090c0: 742c 2073 7562 7365 7175 656e 745f 696e  t, subsequent_in
+000090d0: 6465 6e74 3d73 7461 7274 0a20 2020 2020  dent=start.     
+000090e0: 2020 2029 0a20 2020 2020 2020 202b 2022     ).        + "
+000090f0: 5c6e 220a 2020 2020 290a 2020 2020 6966  \n".    ).    if
+00009100: 2073 7572 726f 756e 643a 0a20 2020 2020   surround:.     
+00009110: 2020 2073 203d 2022 245c 6e22 202b 2073     s = "$\n" + s
+00009120: 202b 2022 245c 6e22 0a20 2020 2072 6574   + "$\n".    ret
+00009130: 7572 6e20 730a 0a0a 4067 7569 746f 6f6c  urn s...@guitool
+00009140: 732e 7772 6974 655f 7465 7874 5f66 696c  s.write_text_fil
+00009150: 650a 6465 6620 7774 646d 6967 2866 2c20  e.def wtdmig(f, 
+00009160: 6463 7429 3a0a 2020 2020 2222 220a 2020  dct):.    """.  
+00009170: 2020 5772 6974 6573 204e 6173 7472 616e    Writes Nastran
+00009180: 2044 4d49 4720 6361 7264 7320 746f 2061   DMIG cards to a
+00009190: 2066 696c 652e 0a0a 2020 2020 5061 7261   file...    Para
+000091a0: 6d65 7465 7273 0a20 2020 202d 2d2d 2d2d  meters.    -----
+000091b0: 2d2d 2d2d 2d0a 2020 2020 6620 3a20 7374  -----.    f : st
+000091c0: 7269 6e67 206f 7220 6669 6c65 5f6c 696b  ring or file_lik
+000091d0: 6520 6f72 2031 206f 7220 4e6f 6e65 0a20  e or 1 or None. 
+000091e0: 2020 2020 2020 2045 6974 6865 7220 6120         Either a 
+000091f0: 6e61 6d65 206f 6620 6120 6669 6c65 2c20  name of a file, 
+00009200: 6f72 2069 7320 6120 6669 6c65 5f6c 696b  or is a file_lik
+00009210: 6520 6f62 6a65 6374 2061 7320 7265 7475  e object as retu
+00009220: 726e 6564 0a20 2020 2020 2020 2062 7920  rned.        by 
+00009230: 3a66 756e 633a 606f 7065 6e60 206f 7220  :func:`open` or 
+00009240: 3a63 6c61 7373 3a60 696f 2e53 7472 696e  :class:`io.Strin
+00009250: 6749 4f60 2e20 496e 7075 7420 6173 2069  gIO`. Input as i
+00009260: 6e74 6567 6572 2031 2074 6f0a 2020 2020  nteger 1 to.    
+00009270: 2020 2020 7772 6974 6520 746f 2073 7464      write to std
+00009280: 6f75 742e 2043 616e 2061 6c73 6f20 6265  out. Can also be
+00009290: 2074 6865 206e 616d 6520 6f66 2061 2064   the name of a d
+000092a0: 6972 6563 746f 7279 206f 7220 4e6f 6e65  irectory or None
+000092b0: 3b0a 2020 2020 2020 2020 696e 2074 6865  ;.        in the
+000092c0: 7365 2063 6173 6573 2c20 6120 4755 4920  se cases, a GUI 
+000092d0: 6973 206f 7065 6e65 6420 666f 7220 6669  is opened for fi
+000092e0: 6c65 2073 656c 6563 7469 6f6e 2e0a 2020  le selection..  
+000092f0: 2020 6463 7420 3a20 6469 6374 696f 6e61    dct : dictiona
+00009300: 7279 0a20 2020 2020 2020 2044 6963 7469  ry.        Dicti
+00009310: 6f6e 6172 7920 6f66 2070 616e 6461 7320  onary of pandas 
+00009320: 4461 7461 4672 616d 6573 2e20 5468 6520  DataFrames. The 
+00009330: 6b65 7973 2077 696c 6c20 6265 2075 7365  keys will be use
+00009340: 6420 6173 2074 6865 0a20 2020 2020 2020  d as the.       
+00009350: 206e 616d 6573 206f 6620 7468 6520 444d   names of the DM
+00009360: 4947 2065 6e74 7269 6573 2e20 5769 7468  IG entries. With
+00009370: 206f 6e65 2065 7863 6570 7469 6f6e 2c20   one exception, 
+00009380: 7468 6520 636f 6c75 6d6e 2061 6e64 0a20  the column and. 
+00009390: 2020 2020 2020 2072 6f77 2069 6e64 6963         row indic
+000093a0: 6573 206f 6620 6561 6368 2044 6174 6146  es of each DataF
+000093b0: 7261 6d65 2061 7265 2070 616e 6461 7320  rame are pandas 
+000093c0: 4d75 6c74 6949 6e64 6578 206f 626a 6563  MultiIndex objec
+000093d0: 7473 0a20 2020 2020 2020 2077 6974 6820  ts.        with 
+000093e0: 6e6f 6465 2049 4420 696e 206c 6576 656c  node ID in level
+000093f0: 2030 2061 6e64 2044 4f46 2069 6e20 6c65   0 and DOF in le
+00009400: 7665 6c20 3120 2874 6865 206e 616d 6573  vel 1 (the names
+00009410: 2061 7265 2022 6964 220a 2020 2020 2020   are "id".      
+00009420: 2020 616e 6420 2264 6f66 2229 2e20 5468    and "dof"). Th
+00009430: 6520 6578 6365 7074 696f 6e20 6973 2066  e exception is f
+00009440: 6f72 2066 6f72 6d20 2239 2220 6d61 7472  or form "9" matr
+00009450: 6963 6573 3a20 7468 6520 636f 6c75 6d6e  ices: the column
+00009460: 0a20 2020 2020 2020 2069 6e64 6578 2069  .        index i
+00009470: 6e20 7468 6174 2063 6173 6520 6973 206a  n that case is j
+00009480: 7573 7420 7468 6520 636f 6c75 6d6e 206e  ust the column n
+00009490: 756d 6265 7220 2873 7461 7274 696e 6720  umber (starting 
+000094a0: 6174 206f 6e65 0a20 2020 2020 2020 2066  at one.        f
+000094b0: 6f72 204e 6173 7472 616e 292e 2055 7365  or Nastran). Use
+000094c0: 2061 6e20 4f72 6465 7265 6444 6963 7420   an OrderedDict 
+000094d0: 6672 6f6d 2074 6865 2073 7461 6e64 6172  from the standar
+000094e0: 6420 5079 7468 6f6e 0a20 2020 2020 2020  d Python.       
+000094f0: 2022 636f 6c6c 6563 7469 6f6e 7322 206d   "collections" m
+00009500: 6f64 756c 6520 746f 2077 7269 7465 2074  odule to write t
+00009510: 6865 2065 6e74 7269 6573 2069 6e20 6120  he entries in a 
+00009520: 7370 6563 6966 6963 206f 7264 6572 2e0a  specific order..
+00009530: 0a20 2020 2052 6574 7572 6e73 0a20 2020  .    Returns.   
+00009540: 202d 2d2d 2d2d 2d2d 0a20 2020 204e 6f6e   -------.    Non
+00009550: 650a 0a20 2020 204e 6f74 6573 0a20 2020  e..    Notes.   
+00009560: 202d 2d2d 2d2d 0a20 2020 2049 6620 6120   -----.    If a 
+00009570: 4461 7461 4672 616d 6520 6861 7320 6120  DataFrame has a 
+00009580: 7369 6e67 6c65 206c 6576 656c 2027 636f  single level 'co
+00009590: 6c75 6d6e 7327 2061 7474 7269 6275 7465  lumns' attribute
+000095a0: 2c20 7468 6520 666f 726d 0a20 2020 2066  , the form.    f
+000095b0: 6f72 2074 6861 7420 6d61 7472 6978 2069  or that matrix i
+000095c0: 7320 392e 2049 6e20 7468 6174 2063 6173  s 9. In that cas
+000095d0: 652c 2074 6865 2027 4e43 4f4c 2720 444d  e, the 'NCOL' DM
+000095e0: 4947 2068 6561 6465 7220 6361 7264 0a20  IG header card. 
+000095f0: 2020 2076 616c 7565 2069 7320 6465 7465     value is dete
+00009600: 726d 696e 6564 2062 7920 6d61 7869 6d75  rmined by maximu
+00009610: 6d20 7661 6c75 6520 696e 2074 6865 2027  m value in the '
+00009620: 636f 6c75 6d6e 7327 2061 7474 7269 6275  columns' attribu
+00009630: 7465 2e0a 0a20 2020 204f 7468 6572 7769  te...    Otherwi
+00009640: 7365 2c20 6966 2061 2044 6174 6146 7261  se, if a DataFra
+00009650: 6d65 2068 6173 2061 2032 2d6c 6576 656c  me has a 2-level
+00009660: 2027 636f 6c75 6d6e 7327 2061 7474 7269   'columns' attri
+00009670: 6275 7465 2c20 7468 650a 2020 2020 666f  bute, the.    fo
+00009680: 726d 2069 7320 6465 7465 726d 696e 6564  rm is determined
+00009690: 2062 7920 6368 6563 6b69 6e67 2074 6865   by checking the
+000096a0: 206d 6174 7269 7820 7368 6170 6520 616e   matrix shape an
+000096b0: 642c 2069 6620 7371 7561 7265 2c0a 2020  d, if square,.  
+000096c0: 2020 7768 6574 6865 7220 7468 6520 6d61    whether the ma
+000096d0: 7472 6978 2069 7320 7379 6d6d 6574 7269  trix is symmetri
+000096e0: 6320 6f72 206e 6f74 2e20 274e 434f 4c27  c or not. 'NCOL'
+000096f0: 2069 7320 7365 7420 746f 2074 6865 0a20   is set to the. 
+00009700: 2020 206e 756d 6265 7220 6f66 2063 6f6c     number of col
+00009710: 756d 6e73 2069 6e20 7468 6520 6d61 7472  umns in the matr
+00009720: 6978 2028 6275 7420 6973 2069 676e 6f72  ix (but is ignor
+00009730: 6564 2062 7920 4e61 7374 7261 6e29 2e0a  ed by Nastran)..
+00009740: 0a20 2020 2054 6865 2074 7970 6520 6973  .    The type is
+00009750: 2064 6574 6572 6d69 6e65 6420 6279 2074   determined by t
+00009760: 6865 206e 756d 7079 2027 6474 7970 6527  he numpy 'dtype'
+00009770: 2061 7474 7269 6275 7465 2e0a 0a20 2020   attribute...   
+00009780: 2043 7572 7265 6e74 6c79 2c20 626f 7468   Currently, both
+00009790: 2027 504f 4c41 5227 2061 6e64 2027 544f   'POLAR' and 'TO
+000097a0: 5554 2720 6865 6164 6572 2063 6172 6420  UT' header card 
+000097b0: 7661 6c75 6573 2061 7265 2073 6574 2074  values are set t
+000097c0: 6f0a 2020 2020 302e 2054 6861 7420 6d65  o.    0. That me
+000097d0: 616e 7320 7468 6174 2063 6f6d 706c 6578  ans that complex
+000097e0: 206e 756d 6265 7273 2061 7265 2077 7269   numbers are wri
+000097f0: 7474 656e 2069 6e20 7265 616c 2f69 6d61  tten in real/ima
+00009800: 6769 6e61 7279 0a20 2020 2070 6172 7473  ginary.    parts
+00009810: 2061 6e64 2074 6865 2072 6573 756c 7469   and the resulti
+00009820: 6e67 2070 7265 6369 7369 6f6e 2069 6e20  ng precision in 
+00009830: 4e61 7374 7261 6e20 6973 2061 7574 6f6d  Nastran is autom
+00009840: 6174 6963 616c 6c79 0a20 2020 2073 6574  atically.    set
+00009850: 2e0a 0a20 2020 2052 6169 7365 730a 2020  ...    Raises.  
+00009860: 2020 2d2d 2d2d 2d2d 0a20 2020 2056 616c    ------.    Val
+00009870: 7565 4572 726f 720a 2020 2020 2020 2020  ueError.        
+00009880: 5768 656e 2061 2044 6174 6146 7261 6d65  When a DataFrame
+00009890: 2072 6f77 2069 6e64 6578 2069 7320 6e6f   row index is no
+000098a0: 7420 3220 6c65 7665 6c73 2c20 6f72 2077  t 2 levels, or w
+000098b0: 6865 6e20 6120 636f 6c75 6d6e 0a20 2020  hen a column.   
+000098c0: 2020 2020 2069 6e64 6578 2069 7320 6e6f       index is no
+000098d0: 7420 3120 6f72 2032 206c 6576 656c 732e  t 1 or 2 levels.
+000098e0: 0a0a 2020 2020 4578 616d 706c 6573 0a20  ..    Examples. 
+000098f0: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
+00009900: 4372 6561 7465 2061 2073 796d 6d65 7472  Create a symmetr
+00009910: 6963 206d 6174 7269 7820 616e 6420 7772  ic matrix and wr
+00009920: 6974 6520 444d 4947 2074 6f20 7363 7265  ite DMIG to scre
+00009930: 656e 3a0a 0a20 2020 203e 3e3e 2069 6d70  en:..    >>> imp
+00009940: 6f72 7420 6e75 6d70 7920 6173 206e 700a  ort numpy as np.
+00009950: 2020 2020 3e3e 3e20 696d 706f 7274 2070      >>> import p
+00009960: 616e 6461 7320 6173 2070 640a 2020 2020  andas as pd.    
+00009970: 3e3e 3e20 6672 6f6d 2070 7979 6574 6920  >>> from pyyeti 
+00009980: 696d 706f 7274 206e 6173 7472 616e 0a20  import nastran. 
+00009990: 2020 203e 3e3e 2061 203d 206e 702e 6172     >>> a = np.ar
+000099a0: 7261 7928 5b5b 332e 352c 202d 312e 322c  ray([[3.5, -1.2,
+000099b0: 202d 322e 345d 2c0a 2020 2020 2e2e 2e20   -2.4],.    ... 
+000099c0: 2020 2020 2020 2020 2020 2020 2020 5b2d                [-
+000099d0: 312e 322c 2038 2e38 2c20 362e 355d 2c0a  1.2, 8.8, 6.5],.
+000099e0: 2020 2020 2e2e 2e20 2020 2020 2020 2020      ...         
+000099f0: 2020 2020 2020 5b2d 322e 342c 2036 2e35        [-2.4, 6.5
+00009a00: 2c20 392e 395d 5d29 0a20 2020 203e 3e3e  , 9.9]]).    >>>
+00009a10: 2069 6e64 203d 2070 642e 4d75 6c74 6949   ind = pd.MultiI
+00009a20: 6e64 6578 2e66 726f 6d5f 7072 6f64 7563  ndex.from_produc
+00009a30: 7428 5b5b 3130 305d 2c20 5b31 2c20 322c  t([[100], [1, 2,
+00009a40: 2036 5d5d 290a 2020 2020 3e3e 3e20 6b20   6]]).    >>> k 
+00009a50: 3d20 7064 2e44 6174 6146 7261 6d65 2861  = pd.DataFrame(a
+00009a60: 2c20 696e 6465 783d 696e 642c 2063 6f6c  , index=ind, col
+00009a70: 756d 6e73 3d69 6e64 290a 2020 2020 3e3e  umns=ind).    >>
+00009a80: 3e20 6b20 2020 2020 2020 2020 2020 2020  > k             
+00009a90: 2023 2064 6f63 7465 7374 3a20 2b45 4c4c   # doctest: +ELL
+00009aa0: 4950 5349 530a 2020 2020 2020 2020 2020  IPSIS.          
+00009ab0: 2031 3030 2e2e 2e0a 2020 2020 2020 2020   100....        
+00009ac0: 2020 2020 2031 2020 2020 3220 2020 2036       1    2    6
+00009ad0: 0a20 2020 2031 3030 2031 2020 332e 3520  .    100 1  3.5 
+00009ae0: 2d31 2e32 202d 322e 340a 2020 2020 2020  -1.2 -2.4.      
+00009af0: 2020 3220 2d31 2e32 2020 382e 3820 2036    2 -1.2  8.8  6
+00009b00: 2e35 0a20 2020 2020 2020 2036 202d 322e  .5.        6 -2.
+00009b10: 3420 2036 2e35 2020 392e 390a 2020 2020  4  6.5  9.9.    
+00009b20: 3e3e 3e20 6e61 7374 7261 6e2e 7774 646d  >>> nastran.wtdm
+00009b30: 6967 2831 2c20 7b27 6b27 3a20 6b7d 290a  ig(1, {'k': k}).
+00009b40: 2020 2020 444d 4947 2020 2020 4b20 2020      DMIG    K   
+00009b50: 2020 2020 2020 2020 2020 2030 2020 2020             0    
+00009b60: 2020 2036 2020 2020 2020 2032 2020 2020     6       2    
+00009b70: 2020 2030 2020 2020 2020 2030 2020 2020     0       0    
+00009b80: 2020 2020 2020 2020 2020 2033 0a20 2020             3.   
+00009b90: 2044 4d49 472a 2020 204b 2020 2020 2020   DMIG*   K      
+00009ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009bb0: 2020 2020 2020 3130 3020 2020 2020 2020        100       
+00009bc0: 2020 2020 2020 2020 310a 2020 2020 2a20          1.    * 
+00009bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009be0: 2020 2031 3030 2020 2020 2020 2020 2020     100          
+00009bf0: 2020 2020 2031 2033 2e35 3030 3030 3030       1 3.5000000
+00009c00: 3030 442b 3030 0a20 2020 202a 2020 2020  00D+00.    *    
+00009c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009c20: 3130 3020 2020 2020 2020 2020 2020 2020  100             
+00009c30: 2020 322d 312e 3230 3030 3030 3030 3044    2-1.200000000D
+00009c40: 2b30 300a 2020 2020 2a20 2020 2020 2020  +00.    *       
+00009c50: 2020 2020 2020 2020 2020 2020 2031 3030               100
+00009c60: 2020 2020 2020 2020 2020 2020 2020 2036                 6
+00009c70: 2d32 2e34 3030 3030 3030 3030 442b 3030  -2.400000000D+00
+00009c80: 0a20 2020 2044 4d49 472a 2020 204b 2020  .    DMIG*   K  
+00009c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009ca0: 2020 2020 2020 2020 2020 3130 3020 2020            100   
+00009cb0: 2020 2020 2020 2020 2020 2020 320a 2020              2.  
+00009cc0: 2020 2a20 2020 2020 2020 2020 2020 2020    *             
+00009cd0: 2020 2020 2020 2031 3030 2020 2020 2020         100      
+00009ce0: 2020 2020 2020 2020 2032 2038 2e38 3030           2 8.800
+00009cf0: 3030 3030 3030 442b 3030 0a20 2020 202a  000000D+00.    *
+00009d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009d10: 2020 2020 3130 3020 2020 2020 2020 2020      100         
+00009d20: 2020 2020 2020 3620 362e 3530 3030 3030        6 6.500000
+00009d30: 3030 3044 2b30 300a 2020 2020 444d 4947  000D+00.    DMIG
+00009d40: 2a20 2020 4b20 2020 2020 2020 2020 2020  *   K           
+00009d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009d60: 2031 3030 2020 2020 2020 2020 2020 2020   100            
+00009d70: 2020 2036 0a20 2020 202a 2020 2020 2020     6.    *      
+00009d80: 2020 2020 2020 2020 2020 2020 2020 3130                10
+00009d90: 3020 2020 2020 2020 2020 2020 2020 2020  0               
+00009da0: 3620 392e 3930 3030 3030 3030 3044 2b30  6 9.900000000D+0
+00009db0: 300a 0a20 2020 2041 7320 616e 6f74 6865  0..    As anothe
+00009dc0: 7220 6465 6d6f 2c20 7772 6974 6520 746f  r demo, write to
+00009dd0: 2061 2073 7472 696e 6720 616e 6420 7573   a string and us
+00009de0: 6520 3a66 756e 633a 6072 6464 6d69 6760  e :func:`rddmig`
+00009df0: 2074 6f20 7265 6164 0a20 2020 2062 6163   to read.    bac
+00009e00: 6b20 696e 3a0a 0a20 2020 203e 3e3e 2069  k in:..    >>> i
+00009e10: 6d70 6f72 7420 696f 0a20 2020 203e 3e3e  mport io.    >>>
+00009e20: 2077 6974 6820 696f 2e53 7472 696e 6749   with io.StringI
+00009e30: 4f28 2920 6173 2073 696f 3a0a 2020 2020  O() as sio:.    
+00009e40: 2e2e 2e20 2020 2020 6e61 7374 7261 6e2e  ...     nastran.
+00009e50: 7774 646d 6967 2873 696f 2c20 7b27 6b27  wtdmig(sio, {'k'
+00009e60: 3a20 6b7d 290a 2020 2020 2e2e 2e20 2020  : k}).    ...   
+00009e70: 2020 6b32 203d 206e 6173 7472 616e 2e72    k2 = nastran.r
+00009e80: 6464 6d69 6728 7369 6f29 5b27 6b27 5d0a  ddmig(sio)['k'].
+00009e90: 2020 2020 3e3e 3e20 6b32 2020 2020 2020      >>> k2      
+00009ea0: 2020 2020 2020 2020 2320 646f 6374 6573          # doctes
+00009eb0: 743a 202b 454c 4c49 5053 4953 0a20 2020  t: +ELLIPSIS.   
+00009ec0: 2069 6420 2020 2020 2020 3130 302e 2e2e   id       100...
+00009ed0: 0a20 2020 2064 6f66 2020 2020 2020 2020  .    dof        
+00009ee0: 3120 2020 2032 2020 2020 360a 2020 2020  1    2    6.    
+00009ef0: 6964 2020 646f 662e 2e2e 0a20 2020 2031  id  dof....    1
+00009f00: 3030 2031 2020 2020 332e 3520 2d31 2e32  00 1    3.5 -1.2
+00009f10: 202d 322e 340a 2020 2020 2020 2020 3220   -2.4.        2 
+00009f20: 2020 2d31 2e32 2020 382e 3820 2036 2e35    -1.2  8.8  6.5
+00009f30: 0a20 2020 2020 2020 2036 2020 202d 322e  .        6   -2.
+00009f40: 3420 2036 2e35 2020 392e 390a 2020 2020  4  6.5  9.9.    
+00009f50: 3e3e 3e20 6e70 2e61 6c6c 2828 6b32 203d  >>> np.all((k2 =
+00009f60: 3d20 6b29 2e76 616c 7565 7329 0a20 2020  = k).values).   
+00009f70: 2054 7275 650a 2020 2020 2222 220a 2020   True.    """.  
+00009f80: 2020 666f 7220 6e61 6d65 2c20 7661 6c75    for name, valu
+00009f90: 6520 696e 2064 6374 2e69 7465 6d73 2829  e in dct.items()
+00009fa0: 3a0a 2020 2020 2020 2020 6e61 6d65 203d  :.        name =
+00009fb0: 206e 616d 652e 7570 7065 7228 290a 2020   name.upper().  
+00009fc0: 2020 2020 2020 726f 7769 6473 203d 2076        rowids = v
+00009fd0: 616c 7565 2e69 6e64 6578 0a20 2020 2020  alue.index.     
+00009fe0: 2020 2063 6f6c 6964 7320 3d20 7661 6c75     colids = valu
+00009ff0: 652e 636f 6c75 6d6e 730a 2020 2020 2020  e.columns.      
+0000a000: 2020 2320 726f 7720 696e 6465 7820 6d75    # row index mu
+0000a010: 7374 2062 6520 322d 6c65 7665 6c20 4d75  st be 2-level Mu
+0000a020: 6c74 6949 6e64 6578 3a0a 2020 2020 2020  ltiIndex:.      
+0000a030: 2020 6966 2072 6f77 6964 732e 6e6c 6576    if rowids.nlev
+0000a040: 656c 7320 213d 2032 3a0a 2020 2020 2020  els != 2:.      
+0000a050: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+0000a060: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
+0000a070: 2020 2020 2020 2020 6627 227b 6e61 6d65          f'"{name
+0000a080: 7d22 206d 7573 7420 6861 7665 2061 2032  }" must have a 2
+0000a090: 2d6c 6576 656c 2072 6f77 2069 6e64 6578  -level row index
+0000a0a0: 2062 7574 2068 6173 2027 0a20 2020 2020   but has '.     
+0000a0b0: 2020 2020 2020 2020 2020 2066 227b 726f             f"{ro
+0000a0c0: 7769 6473 2e6e 6c65 7665 6c73 7d20 6c65  wids.nlevels} le
+0000a0d0: 7665 6c73 220a 2020 2020 2020 2020 2020  vels".          
+0000a0e0: 2020 290a 0a20 2020 2020 2020 2069 6620    )..        if 
+0000a0f0: 636f 6c69 6473 2e6e 6c65 7665 6c73 203e  colids.nlevels >
+0000a100: 2032 3a0a 2020 2020 2020 2020 2020 2020   2:.            
+0000a110: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+0000a120: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0000a130: 2020 6627 227b 6e61 6d65 7d22 206d 7573    f'"{name}" mus
+0000a140: 7420 6861 7665 2061 2031 206f 7220 322d  t have a 1 or 2-
+0000a150: 6c65 7665 6c20 636f 6c75 6d6e 2069 6e64  level column ind
+0000a160: 6578 2062 7574 2068 6173 2027 0a20 2020  ex but has '.   
+0000a170: 2020 2020 2020 2020 2020 2020 2066 227b               f"{
+0000a180: 636f 6c69 6473 2e6e 6c65 7665 6c73 7d20  colids.nlevels} 
+0000a190: 6c65 7665 6c73 220a 2020 2020 2020 2020  levels".        
+0000a1a0: 2020 2020 290a 0a20 2020 2020 2020 206d      )..        m
+0000a1b0: 203d 2076 616c 7565 2e76 616c 7565 730a   = value.values.
+0000a1c0: 2020 2020 2020 2020 6e63 6f6c 203d 2076          ncol = v
+0000a1d0: 616c 7565 2e73 6861 7065 5b31 5d0a 0a20  alue.shape[1].. 
+0000a1e0: 2020 2020 2020 2023 2064 6574 6572 6d69         # determi
+0000a1f0: 6e65 2066 6f72 6d20 6f66 206d 6174 7269  ne form of matri
+0000a200: 783a 0a20 2020 2020 2020 2069 6620 636f  x:.        if co
+0000a210: 6c69 6473 2e6e 6c65 7665 6c73 203d 3d20  lids.nlevels == 
+0000a220: 313a 0a20 2020 2020 2020 2020 2020 2066  1:.            f
+0000a230: 6f72 6d20 3d20 390a 2020 2020 2020 2020  orm = 9.        
+0000a240: 2020 2020 6e63 6f6c 203d 2063 6f6c 6964      ncol = colid
+0000a250: 732e 6d61 7828 290a 2020 2020 2020 2020  s.max().        
+0000a260: 656c 6966 2076 616c 7565 2e73 6861 7065  elif value.shape
+0000a270: 5b30 5d20 213d 2076 616c 7565 2e73 6861  [0] != value.sha
+0000a280: 7065 5b31 5d3a 0a20 2020 2020 2020 2020  pe[1]:.         
+0000a290: 2020 2066 6f72 6d20 3d20 320a 2020 2020     form = 2.    
+0000a2a0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0000a2b0: 2020 2020 2020 6966 206e 702e 616c 6c63        if np.allc
+0000a2c0: 6c6f 7365 286d 2e74 7261 6e73 706f 7365  lose(m.transpose
+0000a2d0: 2829 2c20 6d29 3a0a 2020 2020 2020 2020  (), m):.        
+0000a2e0: 2020 2020 2020 2020 666f 726d 203d 2036          form = 6
+0000a2f0: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+0000a300: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+0000a310: 2020 2066 6f72 6d20 3d20 310a 0a20 2020     form = 1..   
+0000a320: 2020 2020 2023 2064 6574 6572 6d69 6e65       # determine
+0000a330: 2074 7970 6520 6f66 206d 6174 7269 783a   type of matrix:
+0000a340: 0a20 2020 2020 2020 2069 6620 6e70 2e69  .        if np.i
+0000a350: 7363 6f6d 706c 6578 6f62 6a28 6d29 3a0a  scomplexobj(m):.
+0000a360: 2020 2020 2020 2020 2020 2020 6d74 7970              mtyp
+0000a370: 6520 3d20 3420 6966 206d 2e64 7479 7065  e = 4 if m.dtype
+0000a380: 2e69 7465 6d73 697a 6520 3e20 3820 656c  .itemsize > 8 el
+0000a390: 7365 2033 0a20 2020 2020 2020 2065 6c73  se 3.        els
+0000a3a0: 653a 0a20 2020 2020 2020 2020 2020 206d  e:.            m
+0000a3b0: 7479 7065 203d 2032 2069 6620 6d2e 6474  type = 2 if m.dt
+0000a3c0: 7970 652e 6974 656d 7369 7a65 203e 2034  ype.itemsize > 4
+0000a3d0: 2065 6c73 6520 310a 0a20 2020 2020 2020   else 1..       
+0000a3e0: 2023 2077 7269 7465 2068 6561 6465 7220   # write header 
+0000a3f0: 6361 7264 3a0a 2020 2020 2020 2020 706f  card:.        po
+0000a400: 6c61 7220 3d20 300a 2020 2020 2020 2020  lar = 0.        
+0000a410: 746f 7574 203d 2030 0a0a 2020 2020 2020  tout = 0..      
+0000a420: 2020 2320 2020 2020 2020 2044 4d49 4720    #        DMIG 
+0000a430: 204e 414d 4520 2030 2020 2020 4946 4f20   NAME  0    IFO 
+0000a440: 2054 494e 2020 544f 5554 2050 4f4c 4152   TIN  TOUT POLAR
+0000a450: 2020 2020 204e 434f 4c0a 2020 2020 2020       NCOL.      
+0000a460: 2020 662e 7772 6974 6528 0a20 2020 2020    f.write(.     
+0000a470: 2020 2020 2020 2066 227b 2744 4d49 4727         f"{'DMIG'
+0000a480: 3a3c 3873 7d7b 6e61 6d65 3a3c 3873 7d7b  :<8s}{name:<8s}{
+0000a490: 303a 3864 7d7b 666f 726d 3a38 647d 7b6d  0:8d}{form:8d}{m
+0000a4a0: 7479 7065 3a38 647d 7b74 6f75 743a 3864  type:8d}{tout:8d
+0000a4b0: 7d22 0a20 2020 2020 2020 2020 2020 2066  }".            f
+0000a4c0: 227b 706f 6c61 723a 3864 7d7b 2727 3a38  "{polar:8d}{'':8
+0000a4d0: 737d 7b6e 636f 6c3a 3864 7d5c 6e22 0a20  s}{ncol:8d}\n". 
+0000a4e0: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+0000a4f0: 2020 2320 7772 6974 6520 6120 636f 6c75    # write a colu
+0000a500: 6d6e 2061 7420 6120 7469 6d65 3a0a 2020  mn at a time:.  
+0000a510: 2020 2020 2020 666f 7220 636f 6c20 696e        for col in
+0000a520: 2072 616e 6765 286d 2e73 6861 7065 5b31   range(m.shape[1
+0000a530: 5d29 3a0a 2020 2020 2020 2020 2020 2020  ]):.            
+0000a540: 6966 206d 5b3a 2c20 636f 6c5d 2e61 6e79  if m[:, col].any
+0000a550: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
+0000a560: 2020 2020 7374 6172 745f 726f 7720 3d20      start_row = 
+0000a570: 636f 6c20 6966 2066 6f72 6d20 3d3d 2036  col if form == 6
+0000a580: 2065 6c73 6520 300a 2020 2020 2020 2020   else 0.        
+0000a590: 2020 2020 2020 2020 6966 2063 6f6c 6964          if colid
+0000a5a0: 732e 6e6c 6576 656c 7320 3d3d 2032 3a0a  s.nlevels == 2:.
+0000a5b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a5c0: 2020 2020 676a 2c20 636a 203d 2063 6f6c      gj, cj = col
+0000a5d0: 6964 735b 636f 6c5d 0a20 2020 2020 2020  ids[col].       
+0000a5e0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+0000a5f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a600: 2020 2067 6a20 3d20 636f 6c69 6473 5b63     gj = colids[c
+0000a610: 6f6c 5d0a 2020 2020 2020 2020 2020 2020  ol].            
+0000a620: 2020 2020 2020 2020 636a 203d 2030 0a20          cj = 0. 
+0000a630: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0000a640: 2e77 7269 7465 2866 227b 2744 4d49 472a  .write(f"{'DMIG*
+0000a650: 273a 3c38 737d 7b6e 616d 653a 3c31 3673  ':<8s}{name:<16s
+0000a660: 7d7b 676a 3a31 3664 7d7b 636a 3a31 3664  }{gj:16d}{cj:16d
+0000a670: 7d5c 6e22 290a 2020 2020 2020 2020 2020  }\n").          
+0000a680: 2020 2020 2020 666f 7220 726f 7720 696e        for row in
+0000a690: 2072 616e 6765 2873 7461 7274 5f72 6f77   range(start_row
+0000a6a0: 2c20 6d2e 7368 6170 655b 305d 293a 0a20  , m.shape[0]):. 
+0000a6b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a6c0: 2020 206e 756d 203d 206d 5b72 6f77 2c20     num = m[row, 
+0000a6d0: 636f 6c5d 0a20 2020 2020 2020 2020 2020  col].           
+0000a6e0: 2020 2020 2020 2020 2069 6620 6e75 6d20           if num 
+0000a6f0: 213d 2030 2e30 3a0a 2020 2020 2020 2020  != 0.0:.        
+0000a700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a710: 6769 2c20 6369 203d 2072 6f77 6964 735b  gi, ci = rowids[
+0000a720: 726f 775d 0a20 2020 2020 2020 2020 2020  row].           
+0000a730: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+0000a740: 6d74 7970 6520 3c20 333a 2020 2320 7265  mtype < 3:  # re
+0000a750: 616c 0a20 2020 2020 2020 2020 2020 2020  al.             
+0000a760: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+0000a770: 756d 5f73 7472 203d 2066 227b 6e75 6d3a  um_str = f"{num:
+0000a780: 3136 2e39 457d 220a 2020 2020 2020 2020  16.9E}".        
+0000a790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a7a0: 656c 7365 3a20 2023 2063 6f6d 706c 6578  else:  # complex
+0000a7b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000a7c0: 2020 2020 2020 2020 2020 2020 206e 756d               num
+0000a7d0: 5f73 7472 203d 2066 227b 6e75 6d2e 7265  _str = f"{num.re
+0000a7e0: 616c 3a31 362e 3945 7d7b 6e75 6d2e 696d  al:16.9E}{num.im
+0000a7f0: 6167 3a31 362e 3945 7d22 0a20 2020 2020  ag:16.9E}".     
+0000a800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a810: 2020 2069 6620 6d74 7970 6520 2620 3120     if mtype & 1 
+0000a820: 3d3d 2030 3a20 2023 2069 6620 6576 656e  == 0:  # if even
+0000a830: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000a840: 2020 2020 2020 2020 2020 2020 206e 756d               num
+0000a850: 5f73 7472 203d 206e 756d 5f73 7472 2e72  _str = num_str.r
+0000a860: 6570 6c61 6365 2822 4522 2c20 2244 2229  eplace("E", "D")
+0000a870: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000a880: 2020 2020 2020 2020 2066 2e77 7269 7465           f.write
+0000a890: 2866 227b 272a 273a 3c38 737d 7b67 693a  (f"{'*':<8s}{gi:
+0000a8a0: 3136 647d 7b63 693a 3136 647d 7b6e 756d  16d}{ci:16d}{num
+0000a8b0: 5f73 7472 3a73 7d5c 6e22 290a 0a0a 6465  _str:s}\n")...de
+0000a8c0: 6620 7264 6772 6964 7328 6629 3a0a 2020  f rdgrids(f):.  
+0000a8d0: 2020 2222 220a 2020 2020 5265 6164 204e    """.    Read N
+0000a8e0: 6173 7472 616e 2047 5249 4420 6361 7264  astran GRID card
+0000a8f0: 7320 6672 6f6d 2061 204e 6173 7472 616e  s from a Nastran
+0000a900: 2062 756c 6b20 6669 6c65 2e0a 0a20 2020   bulk file...   
+0000a910: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
+0000a920: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2066  ----------.    f
+0000a930: 203a 2073 7472 696e 6720 6f72 2066 696c   : string or fil
+0000a940: 655f 6c69 6b65 206f 7220 4e6f 6e65 0a20  e_like or None. 
+0000a950: 2020 2020 2020 2045 6974 6865 7220 6120         Either a 
+0000a960: 6e61 6d65 206f 6620 6120 6669 6c65 2c20  name of a file, 
+0000a970: 6f72 2069 7320 6120 6669 6c65 5f6c 696b  or is a file_lik
+0000a980: 6520 6f62 6a65 6374 2061 7320 7265 7475  e object as retu
+0000a990: 726e 6564 0a20 2020 2020 2020 2062 7920  rned.        by 
+0000a9a0: 3a66 756e 633a 606f 7065 6e60 2e20 4966  :func:`open`. If
+0000a9b0: 2066 696c 655f 6c69 6b65 206f 626a 6563   file_like objec
+0000a9c0: 742c 2069 7420 6973 2072 6577 6f75 6e64  t, it is rewound
+0000a9d0: 2066 6972 7374 2e20 4361 6e0a 2020 2020   first. Can.    
+0000a9e0: 2020 2020 616c 736f 2062 6520 7468 6520      also be the 
+0000a9f0: 6e61 6d65 206f 6620 6120 6469 7265 6374  name of a direct
+0000aa00: 6f72 7920 6f72 204e 6f6e 653b 2069 6e20  ory or None; in 
+0000aa10: 7468 6573 6520 6361 7365 732c 2061 2047  these cases, a G
+0000aa20: 5549 0a20 2020 2020 2020 2069 7320 6f70  UI.        is op
+0000aa30: 656e 6564 2066 6f72 2066 696c 6520 7365  ened for file se
+0000aa40: 6c65 6374 696f 6e2e 0a0a 2020 2020 5265  lection...    Re
+0000aa50: 7475 726e 730a 2020 2020 2d2d 2d2d 2d2d  turns.    ------
+0000aa60: 2d0a 2020 2020 6772 6964 7320 3a20 6e64  -.    grids : nd
+0000aa70: 6172 7261 7920 6f72 204e 6f6e 650a 2020  array or None.  
+0000aa80: 2020 2020 2020 382d 636f 6c75 6d6e 206e        8-column n
+0000aa90: 6461 7272 6179 3a20 5b20 6964 2c20 6373  darray: [ id, cs
+0000aaa0: 2c20 782c 2079 2c20 7a2c 2063 732c 2073  , x, y, z, cs, s
+0000aab0: 7063 2c20 7365 6964 205d 2e20 5265 7475  pc, seid ]. Retu
+0000aac0: 726e 730a 2020 2020 2020 2020 4e6f 6e65  rns.        None
+0000aad0: 2069 6620 6e6f 2067 7269 6420 6361 7264   if no grid card
+0000aae0: 7320 666f 756e 640a 0a20 2020 204e 6f74  s found..    Not
+0000aaf0: 6573 0a20 2020 202d 2d2d 2d2d 0a20 2020  es.    -----.   
+0000ab00: 2054 6869 7320 726f 7574 696e 6520 7573   This routine us
+0000ab10: 6573 203a 6675 6e63 3a60 7264 6361 7264  es :func:`rdcard
+0000ab20: 7360 2074 6f20 6c6f 6164 2074 6865 2064  s` to load the d
+0000ab30: 6174 6120 2863 616e 2072 6561 6420 3820  ata (can read 8 
+0000ab40: 6f72 0a20 2020 2031 3620 6669 7865 6420  or.    16 fixed 
+0000ab50: 6669 656c 6420 6f72 2063 6f6d 6d61 2d64  field or comma-d
+0000ab60: 656c 696d 6974 6564 292e 0a0a 2020 2020  elimited)...    
+0000ab70: 4578 616d 706c 6573 0a20 2020 202d 2d2d  Examples.    ---
+0000ab80: 2d2d 2d2d 2d0a 2020 2020 3e3e 3e20 696d  -----.    >>> im
+0000ab90: 706f 7274 206e 756d 7079 2061 7320 6e70  port numpy as np
+0000aba0: 0a20 2020 203e 3e3e 2066 726f 6d20 7079  .    >>> from py
+0000abb0: 7965 7469 2069 6d70 6f72 7420 6e61 7374  yeti import nast
+0000abc0: 7261 6e0a 2020 2020 3e3e 3e20 6672 6f6d  ran.    >>> from
+0000abd0: 2069 6f20 696d 706f 7274 2053 7472 696e   io import Strin
+0000abe0: 6749 4f0a 2020 2020 3e3e 3e20 6672 6f6d  gIO.    >>> from
+0000abf0: 2070 616e 6461 7320 696d 706f 7274 2044   pandas import D
+0000ac00: 6174 6146 7261 6d65 0a20 2020 203e 3e3e  ataFrame.    >>>
+0000ac10: 2078 797a 203d 206e 702e 6172 7261 7928   xyz = np.array(
+0000ac20: 5b5b 2e31 2c20 2e32 2c20 2e33 5d2c 205b  [[.1, .2, .3], [
+0000ac30: 312e 312c 2031 2e32 2c20 312e 335d 5d29  1.1, 1.2, 1.3]])
+0000ac40: 0a20 2020 203e 3e3e 2077 6974 6820 5374  .    >>> with St
+0000ac50: 7269 6e67 494f 2829 2061 7320 663a 0a20  ringIO() as f:. 
+0000ac60: 2020 202e 2e2e 2020 2020 206e 6173 7472     ...     nastr
+0000ac70: 616e 2e77 7467 7269 6473 2866 2c20 5b31  an.wtgrids(f, [1
+0000ac80: 3030 2c20 3230 305d 2c20 7879 7a3d 7879  00, 200], xyz=xy
+0000ac90: 7a2c 2063 643d 3130 290a 2020 2020 2e2e  z, cd=10).    ..
+0000aca0: 2e20 2020 2020 6720 3d20 6e61 7374 7261  .     g = nastra
+0000acb0: 6e2e 7264 6772 6964 7328 6629 0a20 2020  n.rdgrids(f).   
+0000acc0: 203e 3e3e 2064 6620 3d20 4461 7461 4672   >>> df = DataFr
+0000acd0: 616d 6528 6729 0a20 2020 203e 3e3e 2069  ame(g).    >>> i
+0000ace0: 6e74 636f 6c73 203d 205b 302c 2031 2c20  ntcols = [0, 1, 
+0000acf0: 352c 2036 2c20 375d 0a20 2020 203e 3e3e  5, 6, 7].    >>>
+0000ad00: 2064 665b 696e 7463 6f6c 735d 203d 2064   df[intcols] = d
+0000ad10: 665b 696e 7463 6f6c 735d 2e61 7374 7970  f[intcols].astyp
+0000ad20: 6528 696e 7429 0a20 2020 203e 3e3e 2064  e(int).    >>> d
+0000ad30: 660a 2020 2020 2020 2020 2030 2020 3120  f.         0  1 
+0000ad40: 2020 2032 2020 2020 3320 2020 2034 2020     2    3    4  
+0000ad50: 2035 2020 3620 2037 0a20 2020 2030 2020   5  6  7.    0  
+0000ad60: 3130 3020 2030 2020 302e 3120 2030 2e32  100  0  0.1  0.2
+0000ad70: 2020 302e 3320 2031 3020 2030 2020 300a    0.3  10  0  0.
+0000ad80: 2020 2020 3120 2032 3030 2020 3020 2031      1  200  0  1
+0000ad90: 2e31 2020 312e 3220 2031 2e33 2020 3130  .1  1.2  1.3  10
+0000ada0: 2020 3020 2030 0a20 2020 2022 2222 0a20    0  0.    """. 
+0000adb0: 2020 2076 203d 2072 6463 6172 6473 2866     v = rdcards(f
+0000adc0: 2c20 2267 7269 6422 290a 2020 2020 6966  , "grid").    if
+0000add0: 2076 2069 7320 6e6f 7420 4e6f 6e65 3a0a   v is not None:.
+0000ade0: 2020 2020 2020 2020 6320 3d20 6e70 2e73          c = np.s
+0000adf0: 697a 6528 762c 2031 290a 2020 2020 2020  ize(v, 1).      
+0000ae00: 2020 6966 2063 203c 2038 3a0a 2020 2020    if c < 8:.    
+0000ae10: 2020 2020 2020 2020 7620 3d20 6e70 2e68          v = np.h
+0000ae20: 7374 6163 6b28 2876 2c20 6e70 2e7a 6572  stack((v, np.zer
+0000ae30: 6f73 2828 6e70 2e73 697a 6528 762c 2030  os((np.size(v, 0
+0000ae40: 292c 2038 202d 2063 2929 2929 0a20 2020  ), 8 - c)))).   
+0000ae50: 2020 2020 2072 6574 7572 6e20 760a 0a0a       return v...
+0000ae60: 6465 6620 5f63 6f6e 7665 7274 5f63 6172  def _convert_car
+0000ae70: 6428 6361 7264 293a 0a20 2020 2069 6620  d(card):.    if 
+0000ae80: 6c65 6e28 6361 7264 2920 213d 2031 323a  len(card) != 12:
+0000ae90: 0a20 2020 2020 2020 2069 6620 6c65 6e28  .        if len(
+0000aea0: 6361 7264 2920 3d3d 2031 3320 616e 6420  card) == 13 and 
+0000aeb0: 6361 7264 5b31 325d 203d 3d20 3020 616e  card[12] == 0 an
+0000aec0: 6420 6973 696e 7374 616e 6365 2863 6172  d isinstance(car
+0000aed0: 645b 3132 5d2c 2069 6e74 293a 0a20 2020  d[12], int):.   
+0000aee0: 2020 2020 2020 2020 2063 6172 6420 3d20           card = 
+0000aef0: 6361 7264 5b3a 3132 5d0a 2020 2020 2020  card[:12].      
+0000af00: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+0000af10: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+0000af20: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
+0000af30: 2020 2020 2020 6622 6578 7065 6374 6564        f"expected
+0000af40: 2031 3220 6669 656c 6473 2062 7574 2067   12 fields but g
+0000af50: 6f74 207b 6c65 6e28 6361 7264 297d 2c20  ot {len(card)}, 
+0000af60: 6368 6563 6b3a 207b 6361 7264 5b30 5d7d  check: {card[0]}
+0000af70: 2c20 7b63 6172 645b 315d 7d22 0a20 2020  , {card[1]}".   
+0000af80: 2020 2020 2020 2020 2029 0a20 2020 2063           ).    c
+0000af90: 6861 7220 3d20 6361 7264 5b30 5d5b 355d  har = card[0][5]
+0000afa0: 0a20 2020 2069 6620 6368 6172 2069 6e20  .    if char in 
+0000afb0: 2272 5222 3a0a 2020 2020 2020 2020 6374  "rR":.        ct
+0000afc0: 7970 6520 3d20 310a 2020 2020 656c 6966  ype = 1.    elif
+0000afd0: 2063 6861 7220 696e 2022 6343 223a 0a20   char in "cC":. 
+0000afe0: 2020 2020 2020 2063 7479 7065 203d 2032         ctype = 2
+0000aff0: 0a20 2020 2065 6c73 653a 0a20 2020 2020  .    else:.     
+0000b000: 2020 2063 7479 7065 203d 2033 0a0a 2020     ctype = 3..  
+0000b010: 2020 2320 666f 7220 6572 726f 7220 6d65    # for error me
+0000b020: 7373 6167 652c 2069 6e20 6361 7365 2069  ssage, in case i
+0000b030: 7427 7320 6e65 6564 6564 3a0a 2020 2020  t's needed:.    
+0000b040: 6e61 6d65 2c20 6964 656e 7420 3d20 6361  name, ident = ca
+0000b050: 7264 5b30 5d2c 2063 6172 645b 315d 0a0a  rd[0], card[1]..
+0000b060: 2020 2020 6361 7264 5b30 5d2c 2063 6172      card[0], car
+0000b070: 645b 315d 203d 2063 6172 645b 315d 2c20  d[1] = card[1], 
+0000b080: 6374 7970 650a 2020 2020 7472 793a 0a20  ctype.    try:. 
+0000b090: 2020 2020 2020 2063 6172 6420 3d20 6e70         card = np
+0000b0a0: 2e61 7272 6179 2863 6172 6429 2e61 7374  .array(card).ast
+0000b0b0: 7970 6528 666c 6f61 7429 0a20 2020 2065  ype(float).    e
+0000b0c0: 7863 6570 7420 5661 6c75 6545 7272 6f72  xcept ValueError
+0000b0d0: 2061 7320 653a 0a20 2020 2020 2020 206d   as e:.        m
+0000b0e0: 7367 203d 2066 227b 652e 6172 6773 5b30  sg = f"{e.args[0
+0000b0f0: 5d7d 2c20 6368 6563 6b3a 207b 6e61 6d65  ]}, check: {name
+0000b100: 7d2c 207b 6964 656e 747d 220a 2020 2020  }, {ident}".    
+0000b110: 2020 2020 652e 6172 6773 203d 2028 6d73      e.args = (ms
+0000b120: 672c 290a 2020 2020 2020 2020 7261 6973  g,).        rais
+0000b130: 650a 0a20 2020 2072 6574 7572 6e20 6361  e..    return ca
+0000b140: 7264 0a0a 0a64 6566 2072 6463 6f72 6432  rd...def rdcord2
+0000b150: 6361 7264 7328 6629 3a0a 2020 2020 2222  cards(f):.    ""
+0000b160: 220a 2020 2020 5265 6164 2043 4f52 4432  ".    Read CORD2
+0000b170: 2a20 6361 7264 7320 6672 6f6d 2061 204e  * cards from a N
+0000b180: 6173 7472 616e 2062 756c 6b20 6669 6c65  astran bulk file
+0000b190: 0a0a 2020 2020 5061 7261 6d65 7465 7273  ..    Parameters
+0000b1a0: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a  .    ----------.
+0000b1b0: 2020 2020 6620 3a20 7374 7269 6e67 206f      f : string o
+0000b1c0: 7220 6669 6c65 5f6c 696b 6520 6f72 204e  r file_like or N
+0000b1d0: 6f6e 650a 2020 2020 2020 2020 4569 7468  one.        Eith
+0000b1e0: 6572 2061 206e 616d 6520 6f66 2061 2066  er a name of a f
+0000b1f0: 696c 652c 206f 7220 6973 2061 2066 696c  ile, or is a fil
+0000b200: 655f 6c69 6b65 206f 626a 6563 7420 6173  e_like object as
+0000b210: 2072 6574 7572 6e65 640a 2020 2020 2020   returned.      
+0000b220: 2020 6279 203a 6675 6e63 3a60 6f70 656e    by :func:`open
+0000b230: 602e 2049 6620 6669 6c65 5f6c 696b 6520  `. If file_like 
+0000b240: 6f62 6a65 6374 2c20 6974 2069 7320 7265  object, it is re
+0000b250: 776f 756e 6420 6669 7273 742e 2043 616e  wound first. Can
+0000b260: 0a20 2020 2020 2020 2061 6c73 6f20 6265  .        also be
+0000b270: 2074 6865 206e 616d 6520 6f66 2061 2064   the name of a d
+0000b280: 6972 6563 746f 7279 206f 7220 4e6f 6e65  irectory or None
+0000b290: 3b20 696e 2074 6865 7365 2063 6173 6573  ; in these cases
+0000b2a0: 2c20 6120 4755 490a 2020 2020 2020 2020  , a GUI.        
+0000b2b0: 6973 206f 7065 6e65 6420 666f 7220 6669  is opened for fi
+0000b2c0: 6c65 2073 656c 6563 7469 6f6e 2e0a 0a20  le selection... 
+0000b2d0: 2020 2052 6574 7572 6e73 0a20 2020 202d     Returns.    -
+0000b2e0: 2d2d 2d2d 2d2d 0a20 2020 2064 6963 7469  ------.    dicti
+0000b2f0: 6f6e 6172 790a 2020 2020 2020 2020 4469  onary.        Di
+0000b300: 6374 696f 6e61 7279 2077 6974 6820 7468  ctionary with th
+0000b310: 6520 6b65 7973 2062 6569 6e67 2074 6865  e keys being the
+0000b320: 2063 6f6f 7264 696e 6174 6520 7379 7374   coordinate syst
+0000b330: 656d 2069 6420 616e 640a 2020 2020 2020  em id and.      
+0000b340: 2020 7468 6520 7661 6c75 6573 2062 6569    the values bei
+0000b350: 6e67 2074 6865 2035 7833 206d 6174 7269  ng the 5x3 matri
+0000b360: 783a 3a0a 0a20 2020 2020 2020 2020 2020  x::..           
+0000b370: 205b 6964 2020 7479 7065 2030 5d20 2023   [id  type 0]  #
+0000b380: 206f 7574 7075 7420 636f 6f72 642e 2073   output coord. s
+0000b390: 7973 2e20 6964 2061 6e64 2074 7970 650a  ys. id and type.
+0000b3a0: 2020 2020 2020 2020 2020 2020 5b78 6f20              [xo 
+0000b3b0: 2079 6f20 207a 6f5d 2020 2320 6f72 6967   yo  zo]  # orig
+0000b3c0: 696e 206f 6620 636f 6f72 642e 2073 7973  in of coord. sys
+0000b3d0: 7465 6d0a 2020 2020 2020 2020 2020 2020  tem.            
+0000b3e0: 5b20 2020 2054 2020 2020 205d 2020 2320  [    T     ]  # 
+0000b3f0: 3378 3320 7472 616e 7366 6f72 6d61 7469  3x3 transformati
+0000b400: 6f6e 2074 6f20 6261 7369 630a 2020 2020  on to basic.    
+0000b410: 2020 2020 2020 2020 4e6f 7465 2074 6861          Note tha
+0000b420: 7420 5420 6973 2066 6f72 2074 6865 2063  t T is for the c
+0000b430: 6f6f 7264 696e 6174 6520 7379 7374 656d  oordinate system
+0000b440: 2c20 6e6f 7420 6120 6772 6964 0a20 2020  , not a grid.   
+0000b450: 2020 2020 2020 2020 2028 756e 6c65 7373           (unless
+0000b460: 2074 7970 6520 3d20 3120 7768 6963 6820   type = 1 which 
+0000b470: 6d65 616e 7320 7265 6374 616e 6775 6c61  means rectangula
+0000b480: 7229 0a0a 2020 2020 4e6f 7465 730a 2020  r)..    Notes.  
+0000b490: 2020 2d2d 2d2d 2d0a 2020 2020 5468 6973    -----.    This
+0000b4a0: 2072 6f75 7469 6e65 2075 7365 7320 3a66   routine uses :f
+0000b4b0: 756e 633a 6070 7979 6574 692e 6e61 7374  unc:`pyyeti.nast
+0000b4c0: 7261 6e2e 6e32 702e 6275 696c 645f 636f  ran.n2p.build_co
+0000b4d0: 6f72 6473 6020 746f 2062 7569 6c64 0a20  ords` to build. 
+0000b4e0: 2020 2074 6865 206f 7574 7075 742e 0a0a     the output...
+0000b4f0: 2020 2020 5365 6520 616c 736f 0a20 2020      See also.   
+0000b500: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 3a66   --------.    :f
+0000b510: 756e 633a 6061 736d 3275 7365 7460 2c20  unc:`asm2uset`, 
+0000b520: 3a66 756e 633a 6062 756c 6b32 7573 6574  :func:`bulk2uset
+0000b530: 602c 203a 6675 6e63 3a60 7264 6361 7264  `, :func:`rdcard
+0000b540: 7360 2c0a 2020 2020 3a66 756e 633a 6070  s`,.    :func:`p
+0000b550: 7979 6574 692e 6e61 7374 7261 6e2e 6e32  yyeti.nastran.n2
+0000b560: 702e 6275 696c 645f 636f 6f72 6473 600a  p.build_coords`.
+0000b570: 2020 2020 2222 220a 2020 2020 6361 7264      """.    card
+0000b580: 7320 3d20 7264 6361 7264 7328 0a20 2020  s = rdcards(.   
+0000b590: 2020 2020 2066 2c20 7222 2863 6f72 6432       f, r"(cord2
+0000b5a0: 5b72 6373 5d29 5c62 222c 2072 6574 7572  [rcs])\b", retur
+0000b5b0: 6e5f 7661 723d 226c 6973 7422 2c20 7265  n_var="list", re
+0000b5c0: 6765 783d 5472 7565 2c20 6b65 6570 5f6e  gex=True, keep_n
+0000b5d0: 616d 653d 5472 7565 2c20 626c 616e 6b3d  ame=True, blank=
+0000b5e0: 300a 2020 2020 290a 0a20 2020 2069 6620  0.    )..    if 
+0000b5f0: 6361 7264 7320 6973 204e 6f6e 653a 0a20  cards is None:. 
+0000b600: 2020 2020 2020 2072 6574 7572 6e20 7b7d         return {}
+0000b610: 0a0a 2020 2020 7265 7475 726e 206e 3270  ..    return n2p
+0000b620: 2e62 7569 6c64 5f63 6f6f 7264 7328 6e70  .build_coords(np
+0000b630: 2e61 7272 6179 285b 5f63 6f6e 7665 7274  .array([_convert
+0000b640: 5f63 6172 6428 6361 7264 2920 666f 7220  _card(card) for 
+0000b650: 6361 7264 2069 6e20 6361 7264 735d 2929  card in cards]))
+0000b660: 0a0a 0a64 6566 2077 7467 7269 6473 280a  ...def wtgrids(.
+0000b670: 2020 2020 662c 0a20 2020 2067 7269 6473      f,.    grids
+0000b680: 2c0a 2020 2020 6370 3d30 2c0a 2020 2020  ,.    cp=0,.    
+0000b690: 7879 7a3d 6e70 2e61 7272 6179 285b 5b30  xyz=np.array([[0
+0000b6a0: 2e30 2c20 302e 302c 2030 2e30 5d5d 292c  .0, 0.0, 0.0]]),
+0000b6b0: 0a20 2020 2063 643d 302c 0a20 2020 2070  .    cd=0,.    p
+0000b6c0: 733d 2222 2c0a 2020 2020 7365 6964 3d22  s="",.    seid="
+0000b6d0: 222c 0a20 2020 2066 6f72 6d3d 227b 3a31  ",.    form="{:1
+0000b6e0: 362e 3866 7d22 2c0a 293a 0a20 2020 2022  6.8f}",.):.    "
+0000b6f0: 2222 0a20 2020 2057 7269 7465 7320 4e61  "".    Writes Na
+0000b700: 7374 7261 6e20 4752 4944 2063 6172 6473  stran GRID cards
+0000b710: 2074 6f20 6120 6669 6c65 2e0a 0a20 2020   to a file...   
+0000b720: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
+0000b730: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2066  ----------.    f
+0000b740: 203a 2073 7472 696e 6720 6f72 2066 696c   : string or fil
+0000b750: 655f 6c69 6b65 206f 7220 3120 6f72 204e  e_like or 1 or N
+0000b760: 6f6e 650a 2020 2020 2020 2020 4569 7468  one.        Eith
+0000b770: 6572 2061 206e 616d 6520 6f66 2061 2066  er a name of a f
+0000b780: 696c 652c 206f 7220 6973 2061 2066 696c  ile, or is a fil
+0000b790: 655f 6c69 6b65 206f 626a 6563 7420 6173  e_like object as
+0000b7a0: 2072 6574 7572 6e65 640a 2020 2020 2020   returned.      
+0000b7b0: 2020 6279 203a 6675 6e63 3a60 6f70 656e    by :func:`open
+0000b7c0: 6020 6f72 203a 636c 6173 733a 6069 6f2e  ` or :class:`io.
+0000b7d0: 5374 7269 6e67 494f 602e 2049 6e70 7574  StringIO`. Input
+0000b7e0: 2061 7320 696e 7465 6765 7220 3120 746f   as integer 1 to
+0000b7f0: 0a20 2020 2020 2020 2077 7269 7465 2074  .        write t
+0000b800: 6f20 7374 646f 7574 2e20 4361 6e20 616c  o stdout. Can al
+0000b810: 736f 2062 6520 7468 6520 6e61 6d65 206f  so be the name o
+0000b820: 6620 6120 6469 7265 6374 6f72 7920 6f72  f a directory or
+0000b830: 204e 6f6e 653b 0a20 2020 2020 2020 2069   None;.        i
+0000b840: 6e20 7468 6573 6520 6361 7365 732c 2061  n these cases, a
+0000b850: 2047 5549 2069 7320 6f70 656e 6564 2066   GUI is opened f
+0000b860: 6f72 2066 696c 6520 7365 6c65 6374 696f  or file selectio
+0000b870: 6e2e 0a20 2020 2067 7269 6473 203a 2031  n..    grids : 1
+0000b880: 6420 6172 7261 795f 6c69 6b65 3b20 6c65  d array_like; le
+0000b890: 6e67 7468 204e 0a20 2020 2020 2020 2056  ngth N.        V
+0000b8a0: 6563 746f 7220 6f66 2067 7269 6420 6964  ector of grid id
+0000b8b0: 732e 2054 6865 206c 656e 6774 6820 6f66  s. The length of
+0000b8c0: 2060 6772 6964 7360 2077 696c 6c20 6265   `grids` will be
+0000b8d0: 2072 6566 6572 656e 6365 640a 2020 2020   referenced.    
+0000b8e0: 2020 2020 6173 2060 604e 6060 2069 6e20      as ``N`` in 
+0000b8f0: 6578 706c 616e 6174 696f 6e73 2062 656c  explanations bel
+0000b900: 6f77 2e0a 2020 2020 6370 203a 2069 6e74  ow..    cp : int
+0000b910: 6567 6572 2073 6361 6c61 7220 6f72 2076  eger scalar or v
+0000b920: 6563 746f 720a 2020 2020 2020 2020 4964  ector.        Id
+0000b930: 206f 6620 636f 6f72 6469 6e61 7465 2073   of coordinate s
+0000b940: 7973 7465 6d28 7329 2067 7269 6473 2061  ystem(s) grids a
+0000b950: 7265 2064 6566 696e 6564 2069 6e3b 2065  re defined in; e
+0000b960: 6974 6865 7220 7363 616c 6172 0a20 2020  ither scalar.   
+0000b970: 2020 2020 206f 7220 7665 6374 6f72 2077       or vector w
+0000b980: 6974 6820 4e20 726f 7773 2e0a 2020 2020  ith N rows..    
+0000b990: 7879 7a20 3a20 3264 2061 7272 6179 5f6c  xyz : 2d array_l
+0000b9a0: 696b 650a 2020 2020 2020 2020 332d 636f  ike.        3-co
+0000b9b0: 6c75 6d6e 206d 6174 7269 7820 6f66 2067  lumn matrix of g
+0000b9c0: 7269 6420 6c6f 6361 7469 6f6e 733b 2031  rid locations; 1
+0000b9d0: 2072 6f77 206f 7220 4e20 726f 7773 2e0a   row or N rows..
+0000b9e0: 2020 2020 6364 203a 2069 6e74 6567 6572      cd : integer
+0000b9f0: 2073 6361 6c61 7220 6f72 2076 6563 746f   scalar or vecto
+0000ba00: 720a 2020 2020 2020 2020 4964 206f 6620  r.        Id of 
+0000ba10: 6469 7370 6c61 6365 6d65 6e74 2063 6f6f  displacement coo
+0000ba20: 7264 696e 6174 6520 7379 7374 656d 2066  rdinate system f
+0000ba30: 6f72 2067 7269 6473 3b20 6569 7468 6572  or grids; either
+0000ba40: 2073 6361 6c61 720a 2020 2020 2020 2020   scalar.        
+0000ba50: 6f72 2076 6563 746f 7220 7769 7468 204e  or vector with N
+0000ba60: 2072 6f77 732e 0a20 2020 2070 7320 3a20   rows..    ps : 
+0000ba70: 696e 7465 6765 7220 7363 616c 6172 206f  integer scalar o
+0000ba80: 7220 7665 6374 6f72 0a20 2020 2020 2020  r vector.       
+0000ba90: 2050 6572 6d61 6e65 6e74 2063 6f6e 7374   Permanent const
+0000baa0: 7261 696e 7473 2066 6f72 2067 7269 6473  raints for grids
+0000bab0: 2c20 6567 3a20 3132 3334 3536 3b20 6569  , eg: 123456; ei
+0000bac0: 7468 6572 2073 6361 6c61 7220 6f72 0a20  ther scalar or. 
+0000bad0: 2020 2020 2020 2076 6563 746f 7220 7769         vector wi
+0000bae0: 7468 204e 2072 6f77 732e 0a20 2020 2073  th N rows..    s
+0000baf0: 6569 6420 3a20 696e 7465 6765 7220 7363  eid : integer sc
+0000bb00: 616c 6172 206f 7220 7665 6374 6f72 0a20  alar or vector. 
+0000bb10: 2020 2020 2020 2053 7570 6572 656c 656d         Superelem
+0000bb20: 656e 7420 6964 3b20 6569 7468 6572 2073  ent id; either s
+0000bb30: 6361 6c61 7220 6f72 2076 6563 746f 7220  calar or vector 
+0000bb40: 7769 7468 204e 2072 6f77 732e 0a20 2020  with N rows..   
+0000bb50: 2066 6f72 6d61 7420 3a20 7374 7269 6e67   format : string
+0000bb60: 0a20 2020 2020 2020 2053 7472 696e 6720  .        String 
+0000bb70: 7370 6563 6966 7969 6e67 2066 6f72 6d61  specifying forma
+0000bb80: 7420 6f66 2058 595a 2076 616c 7565 733b  t of XYZ values;
+0000bb90: 206d 7573 7420 7072 6f64 7563 6520 3820   must produce 8 
+0000bba0: 6f72 2031 360a 2020 2020 2020 2020 6368  or 16.        ch
+0000bbb0: 6172 6163 7465 7220 7374 7269 6e67 732e  aracter strings.
+0000bbc0: 0a0a 2020 2020 5265 7475 726e 730a 2020  ..    Returns.  
+0000bbd0: 2020 2d2d 2d2d 2d2d 2d0a 2020 2020 4e6f    -------.    No
+0000bbe0: 6e65 0a0a 2020 2020 4578 616d 706c 6573  ne..    Examples
+0000bbf0: 0a20 2020 202d 2d2d 2d2d 2d2d 2d0a 2020  .    --------.  
+0000bc00: 2020 3e3e 3e20 6672 6f6d 2070 7979 6574    >>> from pyyet
+0000bc10: 6920 696d 706f 7274 206e 6173 7472 616e  i import nastran
+0000bc20: 0a20 2020 203e 3e3e 2069 6d70 6f72 7420  .    >>> import 
+0000bc30: 6e75 6d70 7920 6173 206e 700a 2020 2020  numpy as np.    
+0000bc40: 3e3e 3e20 6e61 7374 7261 6e2e 7774 6772  >>> nastran.wtgr
+0000bc50: 6964 7328 312c 206e 702e 6172 616e 6765  ids(1, np.arange
+0000bc60: 2831 2c20 3429 290a 2020 2020 4752 4944  (1, 4)).    GRID
+0000bc70: 2a20 2020 2020 2020 2020 2020 2020 2020  *               
+0000bc80: 2020 2031 2020 2020 2020 2020 2020 2020     1            
+0000bc90: 2020 2030 2020 2020 2020 302e 3030 3030     0      0.0000
+0000bca0: 3030 3030 2020 2020 2020 302e 3030 3030  0000      0.0000
+0000bcb0: 3030 3030 0a20 2020 202a 2020 2020 2020  0000.    *      
+0000bcc0: 2020 2020 2020 2030 2e30 3030 3030 3030         0.0000000
+0000bcd0: 3020 2020 2020 2020 2020 2020 2020 2020  0               
+0000bce0: 300a 2020 2020 4752 4944 2a20 2020 2020  0.    GRID*     
+0000bcf0: 2020 2020 2020 2020 2020 2020 2032 2020               2  
+0000bd00: 2020 2020 2020 2020 2020 2020 2030 2020               0  
+0000bd10: 2020 2020 302e 3030 3030 3030 3030 2020      0.00000000  
+0000bd20: 2020 2020 302e 3030 3030 3030 3030 0a20      0.00000000. 
+0000bd30: 2020 202a 2020 2020 2020 2020 2020 2020     *            
+0000bd40: 2030 2e30 3030 3030 3030 3020 2020 2020   0.00000000     
+0000bd50: 2020 2020 2020 2020 2020 300a 2020 2020            0.    
+0000bd60: 4752 4944 2a20 2020 2020 2020 2020 2020  GRID*           
+0000bd70: 2020 2020 2020 2033 2020 2020 2020 2020         3        
+0000bd80: 2020 2020 2020 2030 2020 2020 2020 302e         0      0.
+0000bd90: 3030 3030 3030 3030 2020 2020 2020 302e  00000000      0.
+0000bda0: 3030 3030 3030 3030 0a20 2020 202a 2020  00000000.    *  
+0000bdb0: 2020 2020 2020 2020 2020 2030 2e30 3030             0.000
+0000bdc0: 3030 3030 3020 2020 2020 2020 2020 2020  00000           
+0000bdd0: 2020 2020 300a 2020 2020 3e3e 3e20 7879      0.    >>> xy
+0000bde0: 7a20 3d20 6e70 2e61 7272 6179 285b 5b2e  z = np.array([[.
+0000bdf0: 312c 202e 322c 202e 335d 2c20 5b31 2e31  1, .2, .3], [1.1
+0000be00: 2c20 312e 322c 2031 2e33 5d5d 290a 2020  , 1.2, 1.3]]).  
+0000be10: 2020 3e3e 3e20 6e61 7374 7261 6e2e 7774    >>> nastran.wt
+0000be20: 6772 6964 7328 312c 205b 3130 302c 2032  grids(1, [100, 2
+0000be30: 3030 5d2c 2078 797a 3d78 797a 2c20 6364  00], xyz=xyz, cd
+0000be40: 3d31 302c 0a20 2020 202e 2e2e 2020 2020  =10,.    ...    
+0000be50: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+0000be60: 6d3d 277b 3a38 2e32 667d 2729 0a20 2020  m='{:8.2f}').   
+0000be70: 2047 5249 4420 2020 2020 2020 2020 3130   GRID         10
+0000be80: 3020 2020 2020 2020 3020 2020 2030 2e31  0       0    0.1
+0000be90: 3020 2020 2030 2e32 3020 2020 2030 2e33  0    0.20    0.3
+0000bea0: 3020 2020 2020 2031 300a 2020 2020 4752  0      10.    GR
+0000beb0: 4944 2020 2020 2020 2020 2032 3030 2020  ID         200  
+0000bec0: 2020 2020 2030 2020 2020 312e 3130 2020       0    1.10  
+0000bed0: 2020 312e 3230 2020 2020 312e 3330 2020    1.20    1.30  
+0000bee0: 2020 2020 3130 0a20 2020 2022 2222 0a20      10.    """. 
+0000bef0: 2020 2067 7269 6473 203d 206e 702e 6174     grids = np.at
+0000bf00: 6c65 6173 745f 3164 2867 7269 6473 292e  least_1d(grids).
+0000bf10: 7261 7665 6c28 290a 2020 2020 7879 7a20  ravel().    xyz 
+0000bf20: 3d20 6e70 2e61 746c 6561 7374 5f32 6428  = np.atleast_2d(
+0000bf30: 7879 7a29 0a20 2020 2074 6573 7473 7472  xyz).    teststr
+0000bf40: 203d 2066 6f72 6d2e 666f 726d 6174 2831   = form.format(1
+0000bf50: 2e30 290a 2020 2020 6c65 6e67 7468 203d  .0).    length =
+0000bf60: 206c 656e 2874 6573 7473 7472 290a 2020   len(teststr).  
+0000bf70: 2020 6966 206c 656e 6774 6820 213d 2038    if length != 8
+0000bf80: 2061 6e64 206c 656e 6774 6820 213d 2031   and length != 1
+0000bf90: 363a 0a20 2020 2020 2020 2072 6169 7365  6:.        raise
+0000bfa0: 2056 616c 7565 4572 726f 7228 0a20 2020   ValueError(.   
+0000bfb0: 2020 2020 2020 2020 2066 2260 666f 726d           f"`form
+0000bfc0: 6020 7072 6f64 7563 6573 2061 207b 6c65  ` produces a {le
+0000bfd0: 6e67 7468 7d20 6c65 6e67 7468 2073 7472  ngth} length str
+0000bfe0: 696e 672e 2049 7420 6d75 7374 2062 6520  ing. It must be 
+0000bff0: 3820 6f72 2031 362e 5c6e 220a 2020 2020  8 or 16.\n".    
+0000c000: 2020 2020 290a 2020 2020 6966 2070 7320      ).    if ps 
+0000c010: 3d3d 2073 6569 6420 3d3d 2022 223a 0a20  == seid == "":. 
+0000c020: 2020 2020 2020 2069 6620 6c65 6e28 7465         if len(te
+0000c030: 7374 7374 7229 203e 2038 3a0a 2020 2020  ststr) > 8:.    
+0000c040: 2020 2020 2020 2020 7374 7269 6e67 203d          string =
+0000c050: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
+0000c060: 2020 2022 4752 4944 2a20 2020 7b3a 3136     "GRID*   {:16
+0000c070: 647d 7b3a 3136 647d 2220 2b20 666f 726d  d}{:16d}" + form
+0000c080: 202a 2032 202b 2022 5c6e 2a20 2020 2020   * 2 + "\n*     
+0000c090: 2020 2220 2b20 666f 726d 202b 2022 7b3a    " + form + "{:
+0000c0a0: 3136 647d 5c6e 220a 2020 2020 2020 2020  16d}\n".        
+0000c0b0: 2020 2020 290a 2020 2020 2020 2020 656c      ).        el
+0000c0c0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+0000c0d0: 7374 7269 6e67 203d 2022 4752 4944 2020  string = "GRID  
+0000c0e0: 2020 7b3a 3864 7d7b 3a38 647d 2220 2b20    {:8d}{:8d}" + 
+0000c0f0: 666f 726d 202a 2033 202b 2022 7b3a 3864  form * 3 + "{:8d
+0000c100: 7d5c 6e22 0a20 2020 2020 2020 2077 7269  }\n".        wri
+0000c110: 7465 722e 7665 6377 7269 7465 2866 2c20  ter.vecwrite(f, 
+0000c120: 7374 7269 6e67 2c20 6772 6964 732c 2063  string, grids, c
+0000c130: 702c 2078 797a 5b3a 2c20 305d 2c20 7879  p, xyz[:, 0], xy
+0000c140: 7a5b 3a2c 2031 5d2c 2078 797a 5b3a 2c20  z[:, 1], xyz[:, 
+0000c150: 325d 2c20 6364 290a 2020 2020 656c 7365  2], cd).    else
+0000c160: 3a0a 2020 2020 2020 2020 6966 206c 656e  :.        if len
+0000c170: 2874 6573 7473 7472 2920 3e20 383a 0a20  (teststr) > 8:. 
+0000c180: 2020 2020 2020 2020 2020 2073 7472 696e             strin
+0000c190: 6720 3d20 280a 2020 2020 2020 2020 2020  g = (.          
+0000c1a0: 2020 2020 2020 2247 5249 442a 2020 207b        "GRID*   {
+0000c1b0: 3a31 3664 7d7b 3a31 3664 7d22 0a20 2020  :16d}{:16d}".   
+0000c1c0: 2020 2020 2020 2020 2020 2020 202b 2066               + f
+0000c1d0: 6f72 6d20 2a20 320a 2020 2020 2020 2020  orm * 2.        
+0000c1e0: 2020 2020 2020 2020 2b20 225c 6e2a 2020          + "\n*  
+0000c1f0: 2020 2020 2022 0a20 2020 2020 2020 2020       ".         
+0000c200: 2020 2020 2020 202b 2066 6f72 6d0a 2020         + form.  
+0000c210: 2020 2020 2020 2020 2020 2020 2020 2b20                + 
+0000c220: 227b 3a31 3664 7d7b 3a3e 3136 7d7b 3a3e  "{:16d}{:>16}{:>
+0000c230: 3136 7d5c 6e22 0a20 2020 2020 2020 2020  16}\n".         
+0000c240: 2020 2029 0a20 2020 2020 2020 2065 6c73     ).        els
+0000c250: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
+0000c260: 7472 696e 6720 3d20 2247 5249 4420 2020  tring = "GRID   
+0000c270: 207b 3a38 647d 7b3a 3864 7d22 202b 2066   {:8d}{:8d}" + f
+0000c280: 6f72 6d20 2a20 3320 2b20 227b 3a38 647d  orm * 3 + "{:8d}
+0000c290: 7b3a 3e38 7d7b 3a3e 387d 5c6e 220a 2020  {:>8}{:>8}\n".  
+0000c2a0: 2020 2020 2020 7772 6974 6572 2e76 6563        writer.vec
+0000c2b0: 7772 6974 6528 0a20 2020 2020 2020 2020  write(.         
+0000c2c0: 2020 2066 2c20 7374 7269 6e67 2c20 6772     f, string, gr
+0000c2d0: 6964 732c 2063 702c 2078 797a 5b3a 2c20  ids, cp, xyz[:, 
+0000c2e0: 305d 2c20 7879 7a5b 3a2c 2031 5d2c 2078  0], xyz[:, 1], x
+0000c2f0: 797a 5b3a 2c20 325d 2c20 6364 2c20 7073  yz[:, 2], cd, ps
+0000c300: 2c20 7365 6964 0a20 2020 2020 2020 2029  , seid.        )
+0000c310: 0a0a 0a64 6566 2072 6474 6162 6c65 6431  ...def rdtabled1
+0000c320: 2866 2c20 6e61 6d65 3d22 7461 626c 6564  (f, name="tabled
+0000c330: 3122 293a 0a20 2020 2022 2222 0a20 2020  1"):.    """.   
+0000c340: 2052 6561 6420 4e61 7374 7261 6e20 5441   Read Nastran TA
+0000c350: 424c 4544 3120 6f72 206f 7468 6572 2069  BLED1 or other i
+0000c360: 6465 6e74 6963 616c 6c79 2066 6f72 6d61  dentically forma
+0000c370: 7474 6564 2063 6172 6473 2066 726f 6d20  tted cards from 
+0000c380: 610a 2020 2020 4e61 7374 7261 6e20 6275  a.    Nastran bu
+0000c390: 6c6b 2066 696c 652e 0a0a 2020 2020 5061  lk file...    Pa
+0000c3a0: 7261 6d65 7465 7273 0a20 2020 202d 2d2d  rameters.    ---
+0000c3b0: 2d2d 2d2d 2d2d 2d0a 2020 2020 6620 3a20  -------.    f : 
+0000c3c0: 7374 7269 6e67 206f 7220 6669 6c65 5f6c  string or file_l
+0000c3d0: 696b 6520 6f72 204e 6f6e 650a 2020 2020  ike or None.    
+0000c3e0: 2020 2020 4569 7468 6572 2061 206e 616d      Either a nam
+0000c3f0: 6520 6f66 2061 2066 696c 652c 206f 7220  e of a file, or 
+0000c400: 6973 2061 2066 696c 655f 6c69 6b65 206f  is a file_like o
+0000c410: 626a 6563 7420 6173 2072 6574 7572 6e65  bject as returne
+0000c420: 640a 2020 2020 2020 2020 6279 203a 6675  d.        by :fu
+0000c430: 6e63 3a60 6f70 656e 602e 2049 6620 6669  nc:`open`. If fi
+0000c440: 6c65 5f6c 696b 6520 6f62 6a65 6374 2c20  le_like object, 
+0000c450: 6974 2069 7320 7265 776f 756e 6420 6669  it is rewound fi
+0000c460: 7273 742e 2043 616e 0a20 2020 2020 2020  rst. Can.       
+0000c470: 2061 6c73 6f20 6265 2074 6865 206e 616d   also be the nam
+0000c480: 6520 6f66 2061 2064 6972 6563 746f 7279  e of a directory
+0000c490: 206f 7220 4e6f 6e65 3b20 696e 2074 6865   or None; in the
+0000c4a0: 7365 2063 6173 6573 2c20 6120 4755 490a  se cases, a GUI.
+0000c4b0: 2020 2020 2020 2020 6973 206f 7065 6e65          is opene
+0000c4c0: 6420 666f 7220 6669 6c65 2073 656c 6563  d for file selec
+0000c4d0: 7469 6f6e 2e0a 2020 2020 6e61 6d65 203a  tion..    name :
+0000c4e0: 2073 7472 696e 673b 206f 7074 696f 6e61   string; optiona
+0000c4f0: 6c0a 2020 2020 2020 2020 4e61 6d65 206f  l.        Name o
+0000c500: 6620 6361 7264 7320 746f 2072 6561 642e  f cards to read.
+0000c510: 0a0a 2020 2020 5265 7475 726e 730a 2020  ..    Returns.  
+0000c520: 2020 2d2d 2d2d 2d2d 2d0a 2020 2020 6463    -------.    dc
+0000c530: 7420 3a20 6469 6374 696f 6e61 7279 0a20  t : dictionary. 
+0000c540: 2020 2020 2020 2044 6963 7469 6f6e 6172         Dictionar
+0000c550: 7920 6f66 2054 4142 4c45 4431 2028 6f72  y of TABLED1 (or
+0000c560: 2073 696d 696c 6172 2920 6361 7264 733a   similar) cards:
+0000c570: 0a0a 2020 2020 2020 2020 2e2e 2063 6f64  ..        .. cod
+0000c580: 652d 626c 6f63 6b3a 3a20 6e6f 6e65 0a0a  e-block:: none..
+0000c590: 2020 2020 2020 2020 2020 2020 7b49 4431              {ID1
+0000c5a0: 3a20 5b74 696d 652c 2064 6174 615d 2c0a  : [time, data],.
+0000c5b0: 2020 2020 2020 2020 2020 2020 2049 4432               ID2
+0000c5c0: 3a20 5b74 696d 652c 2064 6174 615d 2c20  : [time, data], 
+0000c5d0: 2e2e 2e7d 0a0a 2020 2020 4e6f 7465 730a  ...}..    Notes.
+0000c5e0: 2020 2020 2d2d 2d2d 2d0a 2020 2020 5468      -----.    Th
+0000c5f0: 6973 2072 6f75 7469 6e65 2075 7365 7320  is routine uses 
+0000c600: 3a66 756e 633a 6072 6463 6172 6473 6020  :func:`rdcards` 
+0000c610: 746f 206c 6f61 6420 7468 6520 6461 7461  to load the data
+0000c620: 2028 6361 6e20 7265 6164 2038 0a20 2020   (can read 8.   
+0000c630: 206f 7220 3136 2066 6978 6564 2066 6965   or 16 fixed fie
+0000c640: 6c64 206f 7220 636f 6d6d 612d 6465 6c69  ld or comma-deli
+0000c650: 6d69 7465 6429 2e0a 0a20 2020 2053 6565  mited)...    See
+0000c660: 2061 6c73 6f0a 2020 2020 2d2d 2d2d 2d2d   also.    ------
+0000c670: 2d2d 0a20 2020 203a 6675 6e63 3a60 7774  --.    :func:`wt
+0000c680: 7461 626c 6564 3160 0a0a 2020 2020 4578  tabled1`..    Ex
+0000c690: 616d 706c 6573 0a20 2020 202d 2d2d 2d2d  amples.    -----
+0000c6a0: 2d2d 2d0a 2020 2020 3e3e 3e20 6672 6f6d  ---.    >>> from
+0000c6b0: 2070 7979 6574 6920 696d 706f 7274 206e   pyyeti import n
+0000c6c0: 6173 7472 616e 0a20 2020 203e 3e3e 2069  astran.    >>> i
+0000c6d0: 6d70 6f72 7420 6e75 6d70 7920 6173 206e  mport numpy as n
+0000c6e0: 700a 2020 2020 3e3e 3e20 6672 6f6d 2069  p.    >>> from i
+0000c6f0: 6f20 696d 706f 7274 2053 7472 696e 6749  o import StringI
+0000c700: 4f0a 2020 2020 3e3e 3e20 7420 3d20 6e70  O.    >>> t = np
+0000c710: 2e61 7261 6e67 6528 302c 2031 2c20 2e30  .arange(0, 1, .0
+0000c720: 3529 0a20 2020 203e 3e3e 2064 203d 206e  5).    >>> d = n
+0000c730: 702e 7369 6e28 322a 6e70 2e70 692a 332a  p.sin(2*np.pi*3*
+0000c740: 7429 0a20 2020 203e 3e3e 2077 6974 6820  t).    >>> with 
+0000c750: 5374 7269 6e67 494f 2829 2061 7320 663a  StringIO() as f:
+0000c760: 0a20 2020 202e 2e2e 2020 2020 206e 6173  .    ...     nas
+0000c770: 7472 616e 2e77 7474 6162 6c65 6431 2866  tran.wttabled1(f
+0000c780: 2c20 3430 3030 2c20 742c 2064 2c20 2733  , 4000, t, d, '3
+0000c790: 2048 7a20 5369 6e65 2057 6176 6527 2c0a   Hz Sine Wave',.
+0000c7a0: 2020 2020 2e2e 2e20 2020 2020 2020 2020      ...         
+0000c7b0: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+0000c7c0: 726d 3d27 7b3a 382e 3266 7d7b 3a38 2e35  rm='{:8.2f}{:8.5
+0000c7d0: 667d 2729 0a20 2020 202e 2e2e 2020 2020  f}').    ...    
+0000c7e0: 2064 6374 203d 206e 6173 7472 616e 2e72   dct = nastran.r
+0000c7f0: 6474 6162 6c65 6431 2866 290a 2020 2020  dtabled1(f).    
+0000c800: 3e3e 3e20 6e70 2e61 6c6c 636c 6f73 6528  >>> np.allclose(
+0000c810: 742c 2064 6374 5b34 3030 305d 5b3a 2c20  t, dct[4000][:, 
+0000c820: 305d 290a 2020 2020 5472 7565 0a20 2020  0]).    True.   
+0000c830: 203e 3e3e 206e 702e 616c 6c63 6c6f 7365   >>> np.allclose
+0000c840: 2864 2c20 6463 745b 3430 3030 5d5b 3a2c  (d, dct[4000][:,
+0000c850: 2031 5d29 0a20 2020 2054 7275 650a 2020   1]).    True.  
+0000c860: 2020 2222 220a 2020 2020 6420 3d20 7264    """.    d = rd
+0000c870: 6361 7264 7328 662c 206e 616d 652c 2072  cards(f, name, r
+0000c880: 6574 7572 6e5f 7661 723d 2264 6963 7422  eturn_var="dict"
+0000c890: 290a 2020 2020 666f 7220 7469 6420 696e  ).    for tid in
+0000c8a0: 2064 3a0a 2020 2020 2020 2020 7665 6320   d:.        vec 
+0000c8b0: 3d20 645b 7469 645d 0a20 2020 2020 2020  = d[tid].       
+0000c8c0: 2064 5b74 6964 5d20 3d20 6e70 2e76 7374   d[tid] = np.vst
+0000c8d0: 6163 6b28 5b76 6563 5b38 3a2d 313a 325d  ack([vec[8:-1:2]
+0000c8e0: 2c20 7665 635b 393a 2d31 3a32 5d5d 292e  , vec[9:-1:2]]).
+0000c8f0: 540a 2020 2020 7265 7475 726e 2064 0a0a  T.    return d..
+0000c900: 0a40 6775 6974 6f6f 6c73 2e77 7269 7465  .@guitools.write
+0000c910: 5f74 6578 745f 6669 6c65 0a64 6566 2077  _text_file.def w
+0000c920: 7474 6162 6c65 6431 2866 2c20 7469 642c  ttabled1(f, tid,
+0000c930: 2074 2c20 642c 2074 6974 6c65 3d4e 6f6e   t, d, title=Non
+0000c940: 652c 2066 6f72 6d3d 227b 3a31 362e 3945  e, form="{:16.9E
+0000c950: 7d7b 3a31 362e 3945 7d22 2c20 7461 626c  }{:16.9E}", tabl
+0000c960: 6573 7472 3d22 5441 424c 4544 3122 293a  estr="TABLED1"):
+0000c970: 0a20 2020 2022 2222 0a20 2020 2057 7269  .    """.    Wri
+0000c980: 7465 7320 6120 4e61 7374 7261 6e20 5441  tes a Nastran TA
+0000c990: 424c 4544 3120 286f 7220 7369 6d69 6c61  BLED1 (or simila
+0000c9a0: 7229 2063 6172 6420 746f 2061 2066 696c  r) card to a fil
+0000c9b0: 652e 0a0a 2020 2020 5061 7261 6d65 7465  e...    Paramete
+0000c9c0: 7273 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d  rs.    ---------
+0000c9d0: 2d0a 2020 2020 6620 3a20 7374 7269 6e67  -.    f : string
+0000c9e0: 206f 7220 6669 6c65 5f6c 696b 6520 6f72   or file_like or
+0000c9f0: 2031 206f 7220 4e6f 6e65 0a20 2020 2020   1 or None.     
+0000ca00: 2020 2045 6974 6865 7220 6120 6e61 6d65     Either a name
+0000ca10: 206f 6620 6120 6669 6c65 2c20 6f72 2069   of a file, or i
+0000ca20: 7320 6120 6669 6c65 5f6c 696b 6520 6f62  s a file_like ob
+0000ca30: 6a65 6374 2061 7320 7265 7475 726e 6564  ject as returned
+0000ca40: 0a20 2020 2020 2020 2062 7920 3a66 756e  .        by :fun
+0000ca50: 633a 606f 7065 6e60 206f 7220 3a63 6c61  c:`open` or :cla
+0000ca60: 7373 3a60 696f 2e53 7472 696e 6749 4f60  ss:`io.StringIO`
+0000ca70: 2e20 496e 7075 7420 6173 2069 6e74 6567  . Input as integ
+0000ca80: 6572 2031 2074 6f0a 2020 2020 2020 2020  er 1 to.        
+0000ca90: 7772 6974 6520 746f 2073 7464 6f75 742e  write to stdout.
+0000caa0: 2043 616e 2061 6c73 6f20 6265 2074 6865   Can also be the
+0000cab0: 206e 616d 6520 6f66 2061 2064 6972 6563   name of a direc
+0000cac0: 746f 7279 206f 7220 4e6f 6e65 3b0a 2020  tory or None;.  
+0000cad0: 2020 2020 2020 696e 2074 6865 7365 2063        in these c
+0000cae0: 6173 6573 2c20 6120 4755 4920 6973 206f  ases, a GUI is o
+0000caf0: 7065 6e65 6420 666f 7220 6669 6c65 2073  pened for file s
+0000cb00: 656c 6563 7469 6f6e 2e0a 2020 2020 7469  election..    ti
+0000cb10: 6420 3a20 696e 7465 6765 720a 2020 2020  d : integer.    
+0000cb20: 2020 2020 4944 2066 6f72 2054 4142 4c45      ID for TABLE
+0000cb30: 4431 2063 6172 640a 2020 2020 7420 3a20  D1 card.    t : 
+0000cb40: 3164 2061 7272 6179 5f6c 696b 650a 2020  1d array_like.  
+0000cb50: 2020 2020 2020 7469 6d65 2076 6563 746f        time vecto
+0000cb60: 720a 2020 2020 6420 3a20 3164 2061 7272  r.    d : 1d arr
+0000cb70: 6179 5f6c 696b 650a 2020 2020 2020 2020  ay_like.        
+0000cb80: 6461 7461 2076 6563 746f 720a 2020 2020  data vector.    
+0000cb90: 7469 746c 6520 3a20 7374 7269 6e67 206f  title : string o
+0000cba0: 7220 4e6f 6e65 3b20 6f70 7469 6f6e 616c  r None; optional
+0000cbb0: 0a20 2020 2020 2020 2049 6620 6120 7374  .        If a st
+0000cbc0: 7269 6e67 2c20 6974 2069 7320 7772 6974  ring, it is writ
+0000cbd0: 7465 6e20 6173 2061 2063 6f6d 6d65 6e74  ten as a comment
+0000cbe0: 2062 6566 6f72 6520 7461 626c 652e 2049   before table. I
+0000cbf0: 6620 4e6f 6e65 2c0a 2020 2020 2020 2020  f None,.        
+0000cc00: 6e6f 2073 7472 696e 6720 6973 2077 7269  no string is wri
+0000cc10: 7474 656e 2e0a 2020 2020 666f 726d 203a  tten..    form :
+0000cc20: 2073 7472 696e 673b 206f 7074 696f 6e61   string; optiona
+0000cc30: 6c0a 2020 2020 2020 2020 5374 7269 6e67  l.        String
+0000cc40: 2073 7065 6369 6679 696e 6720 7468 6520   specifying the 
+0000cc50: 666f 726d 6174 206f 6620 6120 7369 6e67  format of a sing
+0000cc60: 6c65 205b 7469 6d65 2c20 6461 7461 5d20  le [time, data] 
+0000cc70: 7061 6972 2e0a 2020 2020 2020 2020 4578  pair..        Ex
+0000cc80: 7065 6374 6564 2074 6f20 7265 7375 6c74  pected to result
+0000cc90: 2069 6e20 6120 7374 7269 6e67 2065 6974   in a string eit
+0000cca0: 6865 7220 3136 206f 7220 3332 2063 6861  her 16 or 32 cha
+0000ccb0: 7261 6374 6572 730a 2020 2020 2020 2020  racters.        
+0000ccc0: 6c6f 6e67 2e0a 2020 2020 7461 626c 6573  long..    tables
+0000ccd0: 7472 203a 2073 7472 696e 673b 206f 7074  tr : string; opt
+0000cce0: 696f 6e61 6c0a 2020 2020 2020 2020 4e61  ional.        Na
+0000ccf0: 6d65 206f 6620 6361 7264 2074 6f20 7772  me of card to wr
+0000cd00: 6974 653b 206d 7573 7420 6265 2073 616d  ite; must be sam
+0000cd10: 6520 666f 726d 6174 2061 7320 5441 424c  e format as TABL
+0000cd20: 4544 312e 0a0a 2020 2020 5265 7475 726e  ED1...    Return
+0000cd30: 730a 2020 2020 2d2d 2d2d 2d2d 2d0a 2020  s.    -------.  
+0000cd40: 2020 4e6f 6e65 0a0a 2020 2020 4e6f 7465    None..    Note
+0000cd50: 730a 2020 2020 2d2d 2d2d 2d0a 2020 2020  s.    -----.    
+0000cd60: 496e 2074 6865 2066 6f72 6d61 7420 7374  In the format st
+0000cd70: 7269 6e67 2c20 696e 636c 7564 6520 6120  ring, include a 
+0000cd80: 2320 7369 676e 2074 6f20 666f 7263 6520  # sign to force 
+0000cd90: 6120 6465 6369 6d61 6c20 706f 696e 7420  a decimal point 
+0000cda0: 746f 0a20 2020 2061 7070 6561 7220 7769  to.    appear wi
+0000cdb0: 7468 6f75 7420 7472 6169 6c69 6e67 2064  thout trailing d
+0000cdc0: 6967 6974 732e 2046 6f72 2065 7861 6d70  igits. For examp
+0000cdd0: 6c65 2c20 277b 3a38 2e32 667d 7b3a 2338  le, '{:8.2f}{:#8
+0000cde0: 2e30 667d 270a 2020 2020 776f 756c 6420  .0f}'.    would 
+0000cdf0: 7072 696e 7420 6c69 6b65 2074 6869 733a  print like this:
+0000ce00: 2027 2031 322e 3334 2031 3233 3435 362e   ' 12.34 123456.
+0000ce10: 272e 0a0a 2020 2020 5365 6520 616c 736f  '...    See also
+0000ce20: 0a20 2020 202d 2d2d 2d2d 2d2d 2d0a 2020  .    --------.  
+0000ce30: 2020 3a66 756e 633a 6072 6474 6162 6c65    :func:`rdtable
+0000ce40: 6431 600a 0a20 2020 2045 7861 6d70 6c65  d1`..    Example
+0000ce50: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20  s.    --------. 
+0000ce60: 2020 203e 3e3e 2066 726f 6d20 7079 7965     >>> from pyye
+0000ce70: 7469 2069 6d70 6f72 7420 6e61 7374 7261  ti import nastra
+0000ce80: 6e0a 2020 2020 3e3e 3e20 696d 706f 7274  n.    >>> import
+0000ce90: 206e 756d 7079 2061 7320 6e70 0a20 2020   numpy as np.   
+0000cea0: 203e 3e3e 2074 203d 206e 702e 6172 616e   >>> t = np.aran
+0000ceb0: 6765 2830 2c20 2e39 312c 202e 3035 290a  ge(0, .91, .05).
+0000cec0: 2020 2020 3e3e 3e20 6420 3d20 6e70 2e73      >>> d = np.s
+0000ced0: 696e 2832 2a6e 702e 7069 2a33 2a74 290a  in(2*np.pi*3*t).
+0000cee0: 2020 2020 3e3e 3e20 6e61 7374 7261 6e2e      >>> nastran.
+0000cef0: 7774 7461 626c 6564 3128 312c 2034 3030  wttabled1(1, 400
+0000cf00: 302c 2074 2c20 642c 2027 3320 487a 2053  0, t, d, '3 Hz S
+0000cf10: 696e 6520 5761 7665 272c 0a20 2020 202e  ine Wave',.    .
+0000cf20: 2e2e 2020 2020 2020 2020 2020 2020 2020  ..              
+0000cf30: 2020 2020 2066 6f72 6d3d 277b 3a38 2e32       form='{:8.2
+0000cf40: 667d 7b3a 382e 3566 7d27 290a 2020 2020  f}{:8.5f}').    
+0000cf50: 2420 3320 487a 2053 696e 6520 5761 7665  $ 3 Hz Sine Wave
+0000cf60: 0a20 2020 2054 4142 4c45 4431 2020 2020  .    TABLED1    
+0000cf70: 2034 3030 300a 2020 2020 2020 2020 2020   4000.          
+0000cf80: 2020 2020 2020 302e 3030 2030 2e30 3030        0.00 0.000
+0000cf90: 3030 2020 2020 302e 3035 2030 2e38 3039  00    0.05 0.809
+0000cfa0: 3032 2020 2020 302e 3130 2030 2e39 3531  02    0.10 0.951
+0000cfb0: 3036 2020 2020 302e 3135 2030 2e33 3039  06    0.15 0.309
+0000cfc0: 3032 0a20 2020 2020 2020 2020 2020 2020  02.             
+0000cfd0: 2020 2030 2e32 302d 302e 3538 3737 3920     0.20-0.58779 
+0000cfe0: 2020 2030 2e32 352d 312e 3030 3030 3020     0.25-1.00000 
+0000cff0: 2020 2030 2e33 302d 302e 3538 3737 3920     0.30-0.58779 
+0000d000: 2020 2030 2e33 3520 302e 3330 3930 320a     0.35 0.30902.
+0000d010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d020: 302e 3430 2030 2e39 3531 3036 2020 2020  0.40 0.95106    
+0000d030: 302e 3435 2030 2e38 3039 3032 2020 2020  0.45 0.80902    
+0000d040: 302e 3530 2030 2e30 3030 3030 2020 2020  0.50 0.00000    
+0000d050: 302e 3535 2d30 2e38 3039 3032 0a20 2020  0.55-0.80902.   
+0000d060: 2020 2020 2020 2020 2020 2020 2030 2e36               0.6
+0000d070: 302d 302e 3935 3130 3620 2020 2030 2e36  0-0.95106    0.6
+0000d080: 352d 302e 3330 3930 3220 2020 2030 2e37  5-0.30902    0.7
+0000d090: 3020 302e 3538 3737 3920 2020 2030 2e37  0 0.58779    0.7
+0000d0a0: 3520 312e 3030 3030 300a 2020 2020 2020  5 1.00000.      
+0000d0b0: 2020 2020 2020 2020 2020 302e 3830 2030            0.80 0
+0000d0c0: 2e35 3837 3739 2020 2020 302e 3835 2d30  .58779    0.85-0
+0000d0d0: 2e33 3039 3032 2020 2020 302e 3930 2d30  .30902    0.90-0
+0000d0e0: 2e39 3531 3036 454e 4454 0a20 2020 203e  .95106ENDT.    >
+0000d0f0: 3e3e 206e 6173 7472 616e 2e77 7474 6162  >> nastran.wttab
+0000d100: 6c65 6431 2831 2c20 3430 3030 2c20 5b31  led1(1, 4000, [1
+0000d110: 2c20 322c 2033 5d2c 205b 312c 2032 2c20  , 2, 3], [1, 2, 
+0000d120: 335d 2c0a 2020 2020 2e2e 2e20 2020 2020  3],.    ...     
+0000d130: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+0000d140: 726d 3d27 7b3a 3136 2e32 667d 7b3a 3136  rm='{:16.2f}{:16
+0000d150: 2e35 667d 2729 0a20 2020 2054 4142 4c45  .5f}').    TABLE
+0000d160: 4431 2a20 2020 2020 2020 2020 2020 2034  D1*            4
+0000d170: 3030 300a 2020 2020 2a0a 2020 2020 2a20  000.    *.    * 
+0000d180: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d190: 2020 312e 3030 2020 2020 2020 2020 2031    1.00         1
+0000d1a0: 2e30 3030 3030 2020 2020 2020 2020 2020  .00000          
+0000d1b0: 2020 322e 3030 2020 2020 2020 2020 2032    2.00         2
+0000d1c0: 2e30 3030 3030 0a20 2020 202a 2020 2020  .00000.    *    
+0000d1d0: 2020 2020 2020 2020 2020 2020 2020 2033                 3
+0000d1e0: 2e30 3020 2020 2020 2020 2020 332e 3030  .00         3.00
+0000d1f0: 3030 3045 4e44 540a 2020 2020 2222 220a  000ENDT.    """.
+0000d200: 2020 2020 742c 2064 203d 206e 702e 6174      t, d = np.at
+0000d210: 6c65 6173 745f 3164 2874 2c20 6429 0a20  least_1d(t, d). 
+0000d220: 2020 2074 203d 2074 2e72 6176 656c 2829     t = t.ravel()
+0000d230: 0a20 2020 2064 203d 2064 2e72 6176 656c  .    d = d.ravel
+0000d240: 2829 0a20 2020 206e 7074 7320 3d20 6c65  ().    npts = le
+0000d250: 6e28 7429 0a20 2020 2069 6620 6c65 6e28  n(t).    if len(
+0000d260: 6429 2021 3d20 6e70 7473 3a0a 2020 2020  d) != npts:.    
+0000d270: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+0000d280: 7272 6f72 2866 226c 656e 2864 2920 6973  rror(f"len(d) is
+0000d290: 207b 6c65 6e28 6429 7d20 6275 7420 6c65   {len(d)} but le
+0000d2a0: 6e28 7429 2069 7320 7b6e 7074 737d 2229  n(t) is {npts}")
+0000d2b0: 0a0a 2020 2020 2320 6465 7465 726d 696e  ..    # determin
+0000d2c0: 6520 6966 2075 7369 6e67 2073 696e 676c  e if using singl
+0000d2d0: 6520 6f72 2064 6f75 626c 6520 6669 656c  e or double fiel
+0000d2e0: 643a 0a20 2020 206e 203d 206c 656e 2866  d:.    n = len(f
+0000d2f0: 6f72 6d2e 666f 726d 6174 2831 2c20 3129  orm.format(1, 1)
+0000d300: 290a 2020 2020 6966 206e 2021 3d20 3136  ).    if n != 16
+0000d310: 2061 6e64 206e 2021 3d20 3332 3a0a 2020   and n != 32:.  
+0000d320: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+0000d330: 6545 7272 6f72 2866 2260 666f 726d 6020  eError(f"`form` 
+0000d340: 7072 6f64 7563 6573 2061 207b 6e7d 206c  produces a {n} l
+0000d350: 656e 6774 6820 7374 7269 6e67 2e20 4974  ength string. It
+0000d360: 206d 7573 7420 6265 2031 3620 6f72 2033   must be 16 or 3
+0000d370: 322e 2229 0a20 2020 2069 6620 7469 746c  2.").    if titl
+0000d380: 653a 0a20 2020 2020 2020 2066 2e77 7269  e:.        f.wri
+0000d390: 7465 2866 2224 207b 7469 746c 653a 737d  te(f"$ {title:s}
+0000d3a0: 5c6e 2229 0a20 2020 2069 6620 6e20 3d3d  \n").    if n ==
+0000d3b0: 2033 323a 0a20 2020 2020 2020 2074 6162   32:.        tab
+0000d3c0: 6c65 7374 7220 3d20 7461 626c 6573 7472  lestr = tablestr
+0000d3d0: 202b 2022 2a22 0a20 2020 2020 2020 2066   + "*".        f
+0000d3e0: 2e77 7269 7465 2866 227b 7461 626c 6573  .write(f"{tables
+0000d3f0: 7472 3a3c 3873 7d7b 7469 643a 3136 647d  tr:<8s}{tid:16d}
+0000d400: 5c6e 2a5c 6e22 290a 2020 2020 2020 2020  \n*\n").        
+0000d410: 726f 7773 203d 206e 7074 7320 2f2f 2032  rows = npts // 2
+0000d420: 0a20 2020 2020 2020 2072 203d 2072 6f77  .        r = row
+0000d430: 7320 2a20 320a 2020 2020 2020 2020 7772  s * 2.        wr
+0000d440: 6974 6572 2e76 6563 7772 6974 6528 0a20  iter.vecwrite(. 
+0000d450: 2020 2020 2020 2020 2020 2066 2c20 222a             f, "*
+0000d460: 2020 2020 2020 2022 202b 2066 6f72 6d20         " + form 
+0000d470: 2a20 3220 2b20 225c 6e22 2c20 745b 3a72  * 2 + "\n", t[:r
+0000d480: 3a32 5d2c 2064 5b3a 723a 325d 2c20 745b  :2], d[:r:2], t[
+0000d490: 313a 723a 325d 2c20 645b 313a 723a 325d  1:r:2], d[1:r:2]
+0000d4a0: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+0000d4b0: 2020 2066 2e77 7269 7465 2822 2a20 2020     f.write("*   
+0000d4c0: 2020 2020 2229 0a20 2020 2020 2020 2066      ").        f
+0000d4d0: 6f72 206a 2069 6e20 7261 6e67 6528 722c  or j in range(r,
+0000d4e0: 206e 7074 7329 3a0a 2020 2020 2020 2020   npts):.        
+0000d4f0: 2020 2020 662e 7772 6974 6528 666f 726d      f.write(form
+0000d500: 2e66 6f72 6d61 7428 745b 6a5d 2c20 645b  .format(t[j], d[
+0000d510: 6a5d 2929 0a20 2020 2065 6c73 653a 0a20  j])).    else:. 
+0000d520: 2020 2020 2020 2066 2e77 7269 7465 2866         f.write(f
+0000d530: 227b 7461 626c 6573 7472 3a3c 3873 7d7b  "{tablestr:<8s}{
+0000d540: 7469 643a 3864 7d5c 6e22 290a 2020 2020  tid:8d}\n").    
+0000d550: 2020 2020 726f 7773 203d 206e 7074 7320      rows = npts 
+0000d560: 2f2f 2034 0a20 2020 2020 2020 2072 203d  // 4.        r =
+0000d570: 2072 6f77 7320 2a20 340a 2020 2020 2020   rows * 4.      
+0000d580: 2020 7772 6974 6572 2e76 6563 7772 6974    writer.vecwrit
+0000d590: 6528 0a20 2020 2020 2020 2020 2020 2066  e(.            f
+0000d5a0: 2c0a 2020 2020 2020 2020 2020 2020 2220  ,.            " 
+0000d5b0: 2020 2020 2020 2022 202b 2066 6f72 6d20         " + form 
+0000d5c0: 2a20 3420 2b20 225c 6e22 2c0a 2020 2020  * 4 + "\n",.    
+0000d5d0: 2020 2020 2020 2020 745b 3a72 3a34 5d2c          t[:r:4],
+0000d5e0: 0a20 2020 2020 2020 2020 2020 2064 5b3a  .            d[:
+0000d5f0: 723a 345d 2c0a 2020 2020 2020 2020 2020  r:4],.          
+0000d600: 2020 745b 313a 723a 345d 2c0a 2020 2020    t[1:r:4],.    
+0000d610: 2020 2020 2020 2020 645b 313a 723a 345d          d[1:r:4]
+0000d620: 2c0a 2020 2020 2020 2020 2020 2020 745b  ,.            t[
+0000d630: 323a 723a 345d 2c0a 2020 2020 2020 2020  2:r:4],.        
+0000d640: 2020 2020 645b 323a 723a 345d 2c0a 2020      d[2:r:4],.  
+0000d650: 2020 2020 2020 2020 2020 745b 333a 723a            t[3:r:
+0000d660: 345d 2c0a 2020 2020 2020 2020 2020 2020  4],.            
+0000d670: 645b 333a 723a 345d 2c0a 2020 2020 2020  d[3:r:4],.      
+0000d680: 2020 290a 2020 2020 2020 2020 662e 7772    ).        f.wr
+0000d690: 6974 6528 2220 2020 2020 2020 2022 290a  ite("        ").
+0000d6a0: 2020 2020 2020 2020 666f 7220 6a20 696e          for j in
+0000d6b0: 2072 616e 6765 2872 2c20 6e70 7473 293a   range(r, npts):
+0000d6c0: 0a20 2020 2020 2020 2020 2020 2066 2e77  .            f.w
+0000d6d0: 7269 7465 2866 6f72 6d2e 666f 726d 6174  rite(form.format
+0000d6e0: 2874 5b6a 5d2c 2064 5b6a 5d29 290a 2020  (t[j], d[j])).  
+0000d6f0: 2020 662e 7772 6974 6528 2245 4e44 545c    f.write("ENDT\
+0000d700: 6e22 290a 0a0a 6465 6620 6275 6c6b 3275  n")...def bulk2u
+0000d710: 7365 7428 2a61 7267 7329 3a0a 2020 2020  set(*args):.    
+0000d720: 2222 220a 2020 2020 5265 6164 2043 4f52  """.    Read COR
+0000d730: 4432 2a20 616e 6420 4752 4944 2063 6172  D2* and GRID car
+0000d740: 6473 2066 726f 6d20 6669 6c65 2873 2920  ds from file(s) 
+0000d750: 746f 206d 616b 6520 6120 5553 4554 2074  to make a USET t
+0000d760: 6162 6c65 0a0a 2020 2020 5061 7261 6d65  able..    Parame
+0000d770: 7465 7273 0a20 2020 202d 2d2d 2d2d 2d2d  ters.    -------
+0000d780: 2d2d 2d0a 2020 2020 2a61 7267 730a 2020  ---.    *args.  
+0000d790: 2020 2020 2020 4669 6c65 206e 616d 6573        File names
+0000d7a0: 206f 7220 6669 6c65 2068 616e 646c 6573   or file handles
+0000d7b0: 2061 7320 7265 7475 726e 6564 2062 7920   as returned by 
+0000d7c0: 3a66 756e 633a 606f 7065 6e60 2e20 4669  :func:`open`. Fi
+0000d7d0: 6c65 730a 2020 2020 2020 2020 7265 6665  les.        refe
+0000d7e0: 7272 6564 2074 6f20 6279 2068 616e 646c  rred to by handl
+0000d7f0: 6520 6172 6520 7265 776f 756e 6420 6669  e are rewound fi
+0000d800: 7273 742e 2041 2047 5549 2069 7320 6f70  rst. A GUI is op
+0000d810: 656e 2066 6f72 0a20 2020 2020 2020 2066  en for.        f
+0000d820: 696c 6520 7365 6c65 6374 696f 6e20 6966  ile selection if
+0000d830: 206e 6f20 6172 6775 6d65 6e74 7320 6172   no arguments ar
+0000d840: 6520 7072 6f76 6964 6564 206f 7220 6966  e provided or if
+0000d850: 2061 6e20 6172 6775 6d65 6e74 0a20 2020   an argument.   
+0000d860: 2020 2020 2069 7320 6569 7468 6572 2061       is either a
+0000d870: 2064 6972 6563 746f 7279 206e 616d 6520   directory name 
+0000d880: 6f72 204e 6f6e 652e 0a0a 2020 2020 5265  or None...    Re
+0000d890: 7475 726e 730a 2020 2020 2d2d 2d2d 2d2d  turns.    ------
+0000d8a0: 2d0a 2020 2020 7573 6574 203a 2070 616e  -.    uset : pan
+0000d8b0: 6461 7320 4461 7461 4672 616d 650a 2020  das DataFrame.  
+0000d8c0: 2020 2020 2020 4120 4461 7461 4672 616d        A DataFram
+0000d8d0: 6520 6173 206f 7574 7075 7420 6279 0a20  e as output by. 
+0000d8e0: 2020 2020 2020 203a 6675 6e63 3a60 7079         :func:`py
+0000d8f0: 7965 7469 2e6e 6173 7472 616e 2e6f 7032  yeti.nastran.op2
+0000d900: 2e4f 5032 2e72 646e 3263 6f70 3260 0a20  .OP2.rdn2cop2`. 
+0000d910: 2020 2063 6f6f 7264 7265 6620 3a20 6469     coordref : di
+0000d920: 6374 696f 6e61 7279 0a20 2020 2020 2020  ctionary.       
+0000d930: 2044 6963 7469 6f6e 6172 7920 7769 7468   Dictionary with
+0000d940: 2074 6865 206b 6579 7320 6265 696e 6720   the keys being 
+0000d950: 7468 6520 636f 6f72 6469 6e61 7465 2073  the coordinate s
+0000d960: 7973 7465 6d20 6964 2061 6e64 0a20 2020  ystem id and.   
+0000d970: 2020 2020 2074 6865 2076 616c 7565 7320       the values 
+0000d980: 6265 696e 6720 7468 6520 3578 3320 6d61  being the 5x3 ma
+0000d990: 7472 6978 3a3a 0a0a 2020 2020 2020 2020  trix::..        
+0000d9a0: 2020 2020 5b69 6420 2074 7970 6520 305d      [id  type 0]
+0000d9b0: 2020 2320 6f75 7470 7574 2063 6f6f 7264    # output coord
+0000d9c0: 2e20 7379 732e 2069 6420 616e 6420 7479  . sys. id and ty
+0000d9d0: 7065 0a20 2020 2020 2020 2020 2020 205b  pe.            [
+0000d9e0: 786f 2020 796f 2020 7a6f 5d20 2023 206f  xo  yo  zo]  # o
+0000d9f0: 7269 6769 6e20 6f66 2063 6f6f 7264 2e20  rigin of coord. 
+0000da00: 7379 7374 656d 0a20 2020 2020 2020 2020  system.         
+0000da10: 2020 205b 2020 2020 5420 2020 2020 5d20     [    T     ] 
+0000da20: 2023 2033 7833 2074 7261 6e73 666f 726d   # 3x3 transform
+0000da30: 6174 696f 6e20 746f 2062 6173 6963 0a20  ation to basic. 
+0000da40: 2020 2020 2020 2020 2020 204e 6f74 6520             Note 
+0000da50: 7468 6174 2054 2069 7320 666f 7220 7468  that T is for th
+0000da60: 6520 636f 6f72 6469 6e61 7465 2073 7973  e coordinate sys
+0000da70: 7465 6d2c 206e 6f74 2061 2067 7269 640a  tem, not a grid.
+0000da80: 2020 2020 2020 2020 2020 2020 2875 6e6c              (unl
+0000da90: 6573 7320 7479 7065 203d 2031 2077 6869  ess type = 1 whi
+0000daa0: 6368 206d 6561 6e73 2072 6563 7461 6e67  ch means rectang
+0000dab0: 756c 6172 290a 0a20 2020 204e 6f74 6573  ular)..    Notes
+0000dac0: 0a20 2020 202d 2d2d 2d2d 0a20 2020 2054  .    -----.    T
+0000dad0: 6869 7320 6973 2074 6865 2072 6576 6572  his is the rever
+0000dae0: 7365 206f 6620 3a66 756e 633a 6075 7365  se of :func:`use
+0000daf0: 7432 6275 6c6b 602e 0a0a 2020 2020 4e6f  t2bulk`...    No
+0000db00: 7465 2074 6861 7420 3a66 756e 633a 6061  te that :func:`a
+0000db10: 736d 3275 7365 7460 2069 7320 7369 6d69  sm2uset` is simi
+0000db20: 6c61 7220 746f 2074 6869 7320 726f 7574  lar to this rout
+0000db30: 696e 6520 6275 7420 7772 6974 7465 6e0a  ine but written.
+0000db40: 2020 2020 7370 6563 6966 6963 616c 6c79      specifically
+0000db50: 2066 6f72 204e 6173 7472 616e 202e 6173   for Nastran .as
+0000db60: 6d20 6669 6c65 732e 2054 6861 7420 726f  m files. That ro
+0000db70: 7574 696e 6520 7769 6c6c 2072 6574 7572  utine will retur
+0000db80: 6e20 610a 2020 2020 5553 4554 2074 6162  n a.    USET tab
+0000db90: 6c65 206f 7264 6572 6564 2074 6f20 6d61  le ordered to ma
+0000dba0: 7463 6820 7468 6520 6d6f 6465 6c20 2861  tch the model (a
+0000dbb0: 6363 6f72 6469 6e67 2074 6f20 7468 6520  ccording to the 
+0000dbc0: 5345 434f 4e43 540a 2020 2020 6361 7264  SECONCT.    card
+0000dbd0: 293b 2069 7420 616c 736f 2072 6574 7572  ); it also retur
+0000dbe0: 6e73 2061 2062 2d73 6574 2062 6f6f 6c65  ns a b-set boole
+0000dbf0: 616e 2070 6172 7469 7469 6f6e 2076 6563  an partition vec
+0000dc00: 746f 722e 0a0a 2020 2020 416c 6c20 6772  tor...    All gr
+0000dc10: 6964 7320 6172 6520 7075 7420 696e 2074  ids are put in t
+0000dc20: 6865 2027 6227 2073 6574 2e20 5468 6973  he 'b' set. This
+0000dc30: 2072 6f75 7469 6e65 2075 7365 730a 2020   routine uses.  
+0000dc40: 2020 3a66 756e 633a 6070 7979 6574 692e    :func:`pyyeti.
+0000dc50: 6e61 7374 7261 6e2e 6e32 702e 6164 6467  nastran.n2p.addg
+0000dc60: 7269 6460 2074 6f20 6275 696c 6420 7468  rid` to build th
+0000dc70: 6520 6f75 7470 7574 2e0a 0a20 2020 2053  e output...    S
+0000dc80: 6565 2061 6c73 6f0a 2020 2020 2d2d 2d2d  ee also.    ----
+0000dc90: 2d2d 2d2d 0a20 2020 203a 6675 6e63 3a60  ----.    :func:`
+0000dca0: 6173 6d32 7573 6574 602c 203a 6675 6e63  asm2uset`, :func
+0000dcb0: 3a60 7573 6574 3262 756c 6b60 2c20 3a66  :`uset2bulk`, :f
+0000dcc0: 756e 633a 6072 6463 6172 6473 602c 0a20  unc:`rdcards`,. 
+0000dcd0: 2020 203a 6675 6e63 3a60 7264 6772 6964     :func:`rdgrid
+0000dce0: 7360 2c20 3a66 756e 633a 6070 7979 6574  s`, :func:`pyyet
+0000dcf0: 692e 6e61 7374 7261 6e2e 6f70 322e 4f50  i.nastran.op2.OP
+0000dd00: 322e 7264 6e32 636f 7032 602c 0a20 2020  2.rdn2cop2`,.   
+0000dd10: 203a 6675 6e63 3a60 7079 7965 7469 2e6e   :func:`pyyeti.n
+0000dd20: 6173 7472 616e 2e6e 3270 2e61 6464 6772  astran.n2p.addgr
+0000dd30: 6964 602c 203a 6d6f 643a 6070 7979 6574  id`, :mod:`pyyet
+0000dd40: 692e 6e61 7374 7261 6e2e 6e32 7060 2e0a  i.nastran.n2p`..
+0000dd50: 2020 2020 2222 220a 2020 2020 6772 6964      """.    grid
+0000dd60: 7320 3d20 6e70 2e7a 6572 6f73 2828 302c  s = np.zeros((0,
+0000dd70: 2038 2929 0a20 2020 2063 6f6f 7264 7320   8)).    coords 
+0000dd80: 3d20 7b7d 0a0a 2020 2020 6966 206c 656e  = {}..    if len
+0000dd90: 2861 7267 7329 203d 3d20 303a 0a20 2020  (args) == 0:.   
+0000dda0: 2020 2020 2061 7267 7320 3d20 5b4e 6f6e       args = [Non
+0000ddb0: 655d 0a0a 2020 2020 666f 7220 6620 696e  e]..    for f in
+0000ddc0: 2061 7267 733a 0a20 2020 2020 2020 2066   args:.        f
+0000ddd0: 203d 2067 7569 746f 6f6c 732e 6765 745f   = guitools.get_
+0000dde0: 6669 6c65 5f6e 616d 6528 662c 2072 6561  file_name(f, rea
+0000ddf0: 643d 5472 7565 290a 2020 2020 2020 2020  d=True).        
+0000de00: 636f 6f72 6473 2e75 7064 6174 6528 7264  coords.update(rd
+0000de10: 636f 7264 3263 6172 6473 2866 2929 0a20  cord2cards(f)). 
+0000de20: 2020 2020 2020 2067 203d 2072 6467 7269         g = rdgri
+0000de30: 6473 2866 290a 2020 2020 2020 2020 6966  ds(f).        if
+0000de40: 2067 2069 7320 6e6f 7420 4e6f 6e65 3a0a   g is not None:.
+0000de50: 2020 2020 2020 2020 2020 2020 6772 6964              grid
+0000de60: 7320 3d20 6e70 2e76 7374 6163 6b28 2867  s = np.vstack((g
+0000de70: 7269 6473 2c20 6729 290a 0a20 2020 2069  rids, g))..    i
+0000de80: 203d 206e 702e 6172 6773 6f72 7428 6772   = np.argsort(gr
+0000de90: 6964 735b 3a2c 2030 5d29 0a20 2020 2067  ids[:, 0]).    g
+0000dea0: 7269 6473 203d 2067 7269 6473 5b69 2c20  rids = grids[i, 
+0000deb0: 3a5d 0a20 2020 2075 7365 7420 3d20 6e32  :].    uset = n2
+0000dec0: 702e 6164 6467 7269 6428 0a20 2020 2020  p.addgrid(.     
+0000ded0: 2020 204e 6f6e 652c 0a20 2020 2020 2020     None,.       
+0000dee0: 2067 7269 6473 5b3a 2c20 305d 2e61 7374   grids[:, 0].ast
+0000def0: 7970 6528 6e70 2e69 6e74 3634 292c 0a20  ype(np.int64),. 
+0000df00: 2020 2020 2020 2022 6222 2c0a 2020 2020         "b",.    
+0000df10: 2020 2020 6772 6964 735b 3a2c 2031 5d2c      grids[:, 1],
+0000df20: 0a20 2020 2020 2020 2067 7269 6473 5b3a  .        grids[:
+0000df30: 2c20 323a 355d 2c0a 2020 2020 2020 2020  , 2:5],.        
+0000df40: 6772 6964 735b 3a2c 2035 5d2c 0a20 2020  grids[:, 5],.   
+0000df50: 2020 2020 2063 6f6f 7264 732c 0a20 2020       coords,.   
+0000df60: 2029 0a20 2020 2072 6574 7572 6e20 7573   ).    return us
+0000df70: 6574 2c20 636f 6f72 6473 0a0a 0a40 6775  et, coords...@gu
+0000df80: 6974 6f6f 6c73 2e77 7269 7465 5f74 6578  itools.write_tex
+0000df90: 745f 6669 6c65 0a64 6566 2075 7365 7432  t_file.def uset2
+0000dfa0: 6275 6c6b 2866 2c20 7573 6574 293a 0a20  bulk(f, uset):. 
+0000dfb0: 2020 2022 2222 0a20 2020 2057 7269 7465     """.    Write
+0000dfc0: 2043 4f52 4432 2a20 616e 6420 4752 4944   CORD2* and GRID
+0000dfd0: 2063 6172 6473 2066 726f 6d20 6120 5553   cards from a US
+0000dfe0: 4554 2074 6162 6c65 0a0a 2020 2020 5061  ET table..    Pa
+0000dff0: 7261 6d65 7465 7273 0a20 2020 202d 2d2d  rameters.    ---
+0000e000: 2d2d 2d2d 2d2d 2d0a 2020 2020 6620 3a20  -------.    f : 
+0000e010: 7374 7269 6e67 206f 7220 6669 6c65 5f6c  string or file_l
+0000e020: 696b 6520 6f72 2031 206f 7220 4e6f 6e65  ike or 1 or None
+0000e030: 0a20 2020 2020 2020 2045 6974 6865 7220  .        Either 
+0000e040: 6120 6e61 6d65 206f 6620 6120 6669 6c65  a name of a file
+0000e050: 2c20 6f72 2069 7320 6120 6669 6c65 5f6c  , or is a file_l
+0000e060: 696b 6520 6f62 6a65 6374 2061 7320 7265  ike object as re
+0000e070: 7475 726e 6564 0a20 2020 2020 2020 2062  turned.        b
+0000e080: 7920 3a66 756e 633a 606f 7065 6e60 206f  y :func:`open` o
+0000e090: 7220 3a63 6c61 7373 3a60 696f 2e53 7472  r :class:`io.Str
+0000e0a0: 696e 6749 4f60 2e20 496e 7075 7420 6173  ingIO`. Input as
+0000e0b0: 2069 6e74 6567 6572 2031 2074 6f0a 2020   integer 1 to.  
+0000e0c0: 2020 2020 2020 7772 6974 6520 746f 2073        write to s
+0000e0d0: 7464 6f75 742e 2043 616e 2061 6c73 6f20  tdout. Can also 
+0000e0e0: 6265 2074 6865 206e 616d 6520 6f66 2061  be the name of a
+0000e0f0: 2064 6972 6563 746f 7279 206f 7220 4e6f   directory or No
+0000e100: 6e65 3b0a 2020 2020 2020 2020 696e 2074  ne;.        in t
+0000e110: 6865 7365 2063 6173 6573 2c20 6120 4755  hese cases, a GU
+0000e120: 4920 6973 206f 7065 6e65 6420 666f 7220  I is opened for 
+0000e130: 6669 6c65 2073 656c 6563 7469 6f6e 2e0a  file selection..
+0000e140: 2020 2020 7573 6574 203a 2070 616e 6461      uset : panda
+0000e150: 7320 4461 7461 4672 616d 650a 2020 2020  s DataFrame.    
+0000e160: 2020 2020 4120 4461 7461 4672 616d 6520      A DataFrame 
+0000e170: 6173 206f 7574 7075 7420 6279 0a20 2020  as output by.   
+0000e180: 2020 2020 203a 6675 6e63 3a60 7079 7965       :func:`pyye
+0000e190: 7469 2e6e 6173 7472 616e 2e6f 7032 2e4f  ti.nastran.op2.O
+0000e1a0: 5032 2e72 646e 3263 6f70 3260 0a0a 2020  P2.rdn2cop2`..  
+0000e1b0: 2020 5265 7475 726e 730a 2020 2020 2d2d    Returns.    --
+0000e1c0: 2d2d 2d2d 2d0a 2020 2020 4e6f 6e65 0a0a  -----.    None..
+0000e1d0: 2020 2020 4e6f 7465 730a 2020 2020 2d2d      Notes.    --
+0000e1e0: 2d2d 2d0a 2020 2020 5468 6973 2069 7320  ---.    This is 
+0000e1f0: 7468 6520 7265 7665 7273 6520 6f66 203a  the reverse of :
+0000e200: 6675 6e63 3a60 6275 6c6b 3275 7365 7460  func:`bulk2uset`
+0000e210: 2e0a 0a20 2020 2053 6565 2061 6c73 6f0a  ...    See also.
+0000e220: 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020      --------.   
+0000e230: 203a 6675 6e63 3a60 6275 6c6b 3275 7365   :func:`bulk2use
+0000e240: 7460 2c20 3a66 756e 633a 6070 7979 6574  t`, :func:`pyyet
+0000e250: 692e 6e61 7374 7261 6e2e 6e32 702e 6d6b  i.nastran.n2p.mk
+0000e260: 636f 7264 6361 7264 696e 666f 602c 0a20  cordcardinfo`,. 
+0000e270: 2020 203a 6675 6e63 3a60 7774 636f 6f72     :func:`wtcoor
+0000e280: 6463 6172 6473 602c 203a 6675 6e63 3a60  dcards`, :func:`
+0000e290: 7774 6772 6964 7360 2e0a 2020 2020 2222  wtgrids`..    ""
+0000e2a0: 220a 0a20 2020 2023 2047 6574 2073 6f6d  "..    # Get som
+0000e2b0: 6520 6461 7461 2066 726f 6d20 7468 6520  e data from the 
+0000e2c0: 7573 6574 2074 6162 6c65 3a0a 2020 2020  uset table:.    
+0000e2d0: 6369 203d 206e 3270 2e6d 6b63 6f72 6463  ci = n2p.mkcordc
+0000e2e0: 6172 6469 6e66 6f28 7573 6574 290a 2020  ardinfo(uset).  
+0000e2f0: 2020 6772 6964 7320 3d20 7573 6574 2e69    grids = uset.i
+0000e300: 6e64 6578 2e67 6574 5f6c 6576 656c 5f76  ndex.get_level_v
+0000e310: 616c 7565 7328 2269 6422 290a 2020 2020  alues("id").    
+0000e320: 646f 6620 3d20 7573 6574 2e69 6e64 6578  dof = uset.index
+0000e330: 2e67 6574 5f6c 6576 656c 5f76 616c 7565  .get_level_value
+0000e340: 7328 2264 6f66 2229 0a20 2020 2070 7620  s("dof").    pv 
+0000e350: 3d20 646f 6620 3d3d 2031 0a20 2020 2067  = dof == 1.    g
+0000e360: 7269 6473 203d 2067 7269 6473 5b70 765d  rids = grids[pv]
+0000e370: 0a20 2020 2078 797a 203d 2075 7365 742e  .    xyz = uset.
+0000e380: 6c6f 635b 7076 2c20 2278 223a 227a 225d  loc[pv, "x":"z"]
+0000e390: 2e76 616c 7565 730a 2020 2020 7076 203d  .values.    pv =
+0000e3a0: 2064 6f66 203d 3d20 320a 2020 2020 6364   dof == 2.    cd
+0000e3b0: 203d 2075 7365 742e 6c6f 635b 7076 2c20   = uset.loc[pv, 
+0000e3c0: 2278 225d 2e76 616c 7565 732e 6173 7479  "x"].values.asty
+0000e3d0: 7065 2869 6e74 290a 0a20 2020 2023 2057  pe(int)..    # W
+0000e3e0: 7269 7465 2063 6f6f 7264 696e 6174 6520  rite coordinate 
+0000e3f0: 7379 7374 656d 2063 6172 6473 2069 6620  system cards if 
+0000e400: 6e65 6564 6564 3a0a 2020 2020 6966 2063  needed:.    if c
+0000e410: 693a 0a20 2020 2020 2020 2066 2e77 7269  i:.        f.wri
+0000e420: 7465 2822 245c 6e24 2043 4f4f 5244 494e  te("$\n$ COORDIN
+0000e430: 4154 4520 5359 5354 454d 2044 4154 415c  ATE SYSTEM DATA\
+0000e440: 6e24 5c6e 2229 0a20 2020 2020 2020 2077  n$\n").        w
+0000e450: 7463 6f6f 7264 6361 7264 7328 662c 2063  tcoordcards(f, c
+0000e460: 6929 0a0a 2020 2020 2320 5772 6974 6520  i)..    # Write 
+0000e470: 4772 6964 2064 6174 613a 0a20 2020 2066  Grid data:.    f
+0000e480: 2e77 7269 7465 2822 245c 6e24 2047 5249  .write("$\n$ GRI
+0000e490: 4420 4441 5441 5c6e 245c 6e22 290a 2020  D DATA\n$\n").  
+0000e4a0: 2020 7774 6772 6964 7328 662c 2067 7269    wtgrids(f, gri
+0000e4b0: 6473 2c20 302c 2078 797a 2c20 6364 290a  ds, 0, xyz, cd).
+0000e4c0: 0a0a 6465 6620 7264 7370 6f69 6e74 7328  ..def rdspoints(
+0000e4d0: 6629 3a0a 2020 2020 7222 2222 0a20 2020  f):.    r""".   
+0000e4e0: 2052 6561 6420 4e61 7374 7261 6e20 5350   Read Nastran SP
+0000e4f0: 4f49 4e54 2063 6172 6473 2066 726f 6d20  OINT cards from 
+0000e500: 6120 4e61 7374 7261 6e20 6275 6c6b 2066  a Nastran bulk f
+0000e510: 696c 652e 0a0a 2020 2020 5061 7261 6d65  ile...    Parame
+0000e520: 7465 7273 0a20 2020 202d 2d2d 2d2d 2d2d  ters.    -------
+0000e530: 2d2d 2d0a 2020 2020 6620 3a20 7374 7269  ---.    f : stri
+0000e540: 6e67 206f 7220 6669 6c65 5f6c 696b 6520  ng or file_like 
+0000e550: 6f72 204e 6f6e 650a 2020 2020 2020 2020  or None.        
+0000e560: 4569 7468 6572 2061 206e 616d 6520 6f66  Either a name of
+0000e570: 2061 2066 696c 652c 206f 7220 6973 2061   a file, or is a
+0000e580: 2066 696c 655f 6c69 6b65 206f 626a 6563   file_like objec
+0000e590: 7420 6173 2072 6574 7572 6e65 640a 2020  t as returned.  
+0000e5a0: 2020 2020 2020 6279 203a 6675 6e63 3a60        by :func:`
+0000e5b0: 6f70 656e 602e 2049 6620 6669 6c65 5f6c  open`. If file_l
+0000e5c0: 696b 6520 6f62 6a65 6374 2c20 6974 2069  ike object, it i
+0000e5d0: 7320 7265 776f 756e 6420 6669 7273 742e  s rewound first.
+0000e5e0: 2043 616e 0a20 2020 2020 2020 2061 6c73   Can.        als
+0000e5f0: 6f20 6265 2074 6865 206e 616d 6520 6f66  o be the name of
+0000e600: 2061 2064 6972 6563 746f 7279 206f 7220   a directory or 
+0000e610: 4e6f 6e65 3b20 696e 2074 6865 7365 2063  None; in these c
+0000e620: 6173 6573 2c20 6120 4755 490a 2020 2020  ases, a GUI.    
+0000e630: 2020 2020 6973 206f 7065 6e65 6420 666f      is opened fo
+0000e640: 7220 6669 6c65 2073 656c 6563 7469 6f6e  r file selection
+0000e650: 2e0a 0a20 2020 2052 6574 7572 6e73 0a20  ...    Returns. 
+0000e660: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 2073     -------.    s
+0000e670: 706f 696e 7473 203a 2031 6420 6e64 6172  points : 1d ndar
+0000e680: 7261 790a 2020 2020 2020 2020 4172 7261  ray.        Arra
+0000e690: 7920 6f66 2053 504f 494e 5420 6964 732e  y of SPOINT ids.
+0000e6a0: 2057 696c 6c20 6265 2065 6d70 7479 2069   Will be empty i
+0000e6b0: 6620 6e6f 2053 504f 494e 5420 6361 7264  f no SPOINT card
+0000e6c0: 7320 666f 756e 642e 0a0a 2020 2020 4e6f  s found...    No
+0000e6d0: 7465 730a 2020 2020 2d2d 2d2d 2d0a 2020  tes.    -----.  
+0000e6e0: 2020 5468 6973 2072 6f75 7469 6e65 2075    This routine u
+0000e6f0: 7365 7320 3a66 756e 633a 6072 6463 6172  ses :func:`rdcar
+0000e700: 6473 6020 746f 206c 6f61 6420 7468 6520  ds` to load the 
+0000e710: 6461 7461 2e0a 0a20 2020 2045 7861 6d70  data...    Examp
+0000e720: 6c65 730a 2020 2020 2d2d 2d2d 2d2d 2d2d  les.    --------
+0000e730: 0a20 2020 203e 3e3e 2066 726f 6d20 7079  .    >>> from py
+0000e740: 7965 7469 2069 6d70 6f72 7420 6e61 7374  yeti import nast
+0000e750: 7261 6e0a 2020 2020 3e3e 3e20 6672 6f6d  ran.    >>> from
+0000e760: 2069 6f20 696d 706f 7274 2053 7472 696e   io import Strin
+0000e770: 6749 4f0a 2020 2020 3e3e 3e20 6275 6c6b  gIO.    >>> bulk
+0000e780: 6461 7461 203d 2028 0a20 2020 202e 2e2e  data = (.    ...
+0000e790: 2020 2020 2022 5350 4f49 4e54 2c31 2c32       "SPOINT,1,2
+0000e7a0: 2c31 3030 5c6e 220a 2020 2020 2e2e 2e20  ,100\n".    ... 
+0000e7b0: 2020 2020 2253 504f 494e 542c 3230 302c      "SPOINT,200,
+0000e7c0: 5448 5255 2c32 3032 5c6e 220a 2020 2020  THRU,202\n".    
+0000e7d0: 2e2e 2e20 2020 2020 2253 504f 494e 542c  ...     "SPOINT,
+0000e7e0: 355c 6e22 0a20 2020 202e 2e2e 2029 0a20  5\n".    ... ). 
+0000e7f0: 2020 203e 3e3e 2077 6974 6820 5374 7269     >>> with Stri
+0000e800: 6e67 494f 2862 756c 6b64 6174 6129 2061  ngIO(bulkdata) a
+0000e810: 7320 663a 0a20 2020 202e 2e2e 2020 2020  s f:.    ...    
+0000e820: 2073 706f 696e 7473 203d 206e 6173 7472   spoints = nastr
+0000e830: 616e 2e72 6473 706f 696e 7473 2866 290a  an.rdspoints(f).
+0000e840: 2020 2020 3e3e 3e20 7370 6f69 6e74 7320      >>> spoints 
+0000e850: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e860: 2020 2020 2023 2064 6f63 7465 7374 3a20       # doctest: 
+0000e870: 2b45 4c4c 4950 5349 530a 2020 2020 6172  +ELLIPSIS.    ar
+0000e880: 7261 7928 5b20 2031 2c20 2020 322c 2031  ray([  1,   2, 1
+0000e890: 3030 2c20 3230 302c 2032 3031 2c20 3230  00, 200, 201, 20
+0000e8a0: 322c 2020 2035 5d2e 2e2e 290a 2020 2020  2,   5]...).    
+0000e8b0: 3e3e 3e20 7769 7468 2053 7472 696e 6749  >>> with StringI
+0000e8c0: 4f28 226e 6f20 6461 7461 2229 2061 7320  O("no data") as 
+0000e8d0: 663a 0a20 2020 202e 2e2e 2020 2020 2073  f:.    ...     s
+0000e8e0: 706f 696e 7473 203d 206e 6173 7472 616e  points = nastran
+0000e8f0: 2e72 6473 706f 696e 7473 2866 290a 2020  .rdspoints(f).  
+0000e900: 2020 3e3e 3e20 7370 6f69 6e74 7320 2020    >>> spoints   
+0000e910: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e920: 2020 2023 2064 6f63 7465 7374 3a20 2b45     # doctest: +E
+0000e930: 4c4c 4950 5349 530a 2020 2020 6172 7261  LLIPSIS.    arra
+0000e940: 7928 5b5d 2e2e 2e29 0a0a 2020 2020 2222  y([]...)..    ""
+0000e950: 220a 2020 2020 7370 6f69 6e74 5f64 6174  ".    spoint_dat
+0000e960: 6120 3d20 7264 6361 7264 7328 662c 2022  a = rdcards(f, "
+0000e970: 7370 6f69 6e74 222c 2072 6574 7572 6e5f  spoint", return_
+0000e980: 7661 723d 226c 6973 7422 290a 2020 2020  var="list").    
+0000e990: 7370 6f69 6e74 7320 3d20 5b5d 0a20 2020  spoints = [].   
+0000e9a0: 2069 6620 7370 6f69 6e74 5f64 6174 6120   if spoint_data 
+0000e9b0: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+0000e9c0: 2020 2020 2066 6f72 2063 6172 6420 696e       for card in
+0000e9d0: 2073 706f 696e 745f 6461 7461 3a0a 2020   spoint_data:.  
+0000e9e0: 2020 2020 2020 2020 2020 6966 206c 656e            if len
+0000e9f0: 2863 6172 6429 203e 2032 2061 6e64 2069  (card) > 2 and i
+0000ea00: 7369 6e73 7461 6e63 6528 6361 7264 5b31  sinstance(card[1
+0000ea10: 5d2c 2073 7472 2920 616e 6420 6361 7264  ], str) and card
+0000ea20: 5b31 5d2e 6c6f 7765 7228 2920 3d3d 2022  [1].lower() == "
+0000ea30: 7468 7275 223a 0a20 2020 2020 2020 2020  thru":.         
+0000ea40: 2020 2020 2020 2073 706f 696e 7473 2e65         spoints.e
+0000ea50: 7874 656e 6428 5b69 2066 6f72 2069 2069  xtend([i for i i
+0000ea60: 6e20 7261 6e67 6528 6361 7264 5b30 5d2c  n range(card[0],
+0000ea70: 2063 6172 645b 325d 202b 2031 295d 290a   card[2] + 1)]).
+0000ea80: 2020 2020 2020 2020 2020 2020 656c 7365              else
+0000ea90: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0000eaa0: 2020 7370 6f69 6e74 732e 6578 7465 6e64    spoints.extend
+0000eab0: 2863 6172 6429 0a20 2020 2072 6574 7572  (card).    retur
+0000eac0: 6e20 6e70 2e61 7272 6179 2873 706f 696e  n np.array(spoin
+0000ead0: 7473 2c20 6474 7970 653d 6e70 2e69 6e74  ts, dtype=np.int
+0000eae0: 3634 290a 0a0a 6465 6620 7264 7365 636f  64)...def rdseco
+0000eaf0: 6e63 7428 6629 3a0a 2020 2020 7222 2222  nct(f):.    r"""
+0000eb00: 0a20 2020 2052 6561 6420 4e61 7374 7261  .    Read Nastra
+0000eb10: 6e20 5345 434f 4e43 5420 6361 7264 7320  n SECONCT cards 
+0000eb20: 6672 6f6d 2061 204e 6173 7472 616e 2062  from a Nastran b
+0000eb30: 756c 6b20 6669 6c65 2e0a 0a20 2020 2050  ulk file...    P
+0000eb40: 6172 616d 6574 6572 730a 2020 2020 2d2d  arameters.    --
+0000eb50: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2066 203a  --------.    f :
+0000eb60: 2073 7472 696e 6720 6f72 2066 696c 655f   string or file_
+0000eb70: 6c69 6b65 206f 7220 4e6f 6e65 0a20 2020  like or None.   
+0000eb80: 2020 2020 2045 6974 6865 7220 6120 6e61       Either a na
+0000eb90: 6d65 206f 6620 6120 6669 6c65 2c20 6f72  me of a file, or
+0000eba0: 2069 7320 6120 6669 6c65 5f6c 696b 6520   is a file_like 
+0000ebb0: 6f62 6a65 6374 2061 7320 7265 7475 726e  object as return
+0000ebc0: 6564 0a20 2020 2020 2020 2062 7920 3a66  ed.        by :f
+0000ebd0: 756e 633a 606f 7065 6e60 2e20 4966 2066  unc:`open`. If f
+0000ebe0: 696c 655f 6c69 6b65 206f 626a 6563 742c  ile_like object,
+0000ebf0: 2069 7420 6973 2072 6577 6f75 6e64 2066   it is rewound f
+0000ec00: 6972 7374 2e20 4361 6e0a 2020 2020 2020  irst. Can.      
+0000ec10: 2020 616c 736f 2062 6520 7468 6520 6e61    also be the na
+0000ec20: 6d65 206f 6620 6120 6469 7265 6374 6f72  me of a director
+0000ec30: 7920 6f72 204e 6f6e 653b 2069 6e20 7468  y or None; in th
+0000ec40: 6573 6520 6361 7365 732c 2061 2047 5549  ese cases, a GUI
+0000ec50: 0a20 2020 2020 2020 2069 7320 6f70 656e  .        is open
+0000ec60: 6564 2066 6f72 2066 696c 6520 7365 6c65  ed for file sele
+0000ec70: 6374 696f 6e2e 0a0a 2020 2020 5265 7475  ction...    Retu
+0000ec80: 726e 730a 2020 2020 2d2d 2d2d 2d2d 2d0a  rns.    -------.
+0000ec90: 2020 2020 615f 6964 732c 2062 5f69 6473      a_ids, b_ids
+0000eca0: 203a 2031 6420 6e64 6172 7261 7973 0a20   : 1d ndarrays. 
+0000ecb0: 2020 2020 2020 2041 7272 6179 206f 6620         Array of 
+0000ecc0: 4752 4944 2061 6e64 2053 504f 494e 5420  GRID and SPOINT 
+0000ecd0: 6964 7320 666f 7220 7375 7065 7265 6c65  ids for superele
+0000ece0: 6d65 6e74 2041 2061 6e64 0a20 2020 2020  ment A and.     
+0000ecf0: 2020 2073 7570 6572 656c 656d 656e 7420     superelement 
+0000ed00: 422c 2072 6573 7065 6374 6976 656c 792e  B, respectively.
+0000ed10: 2042 6f74 6820 6f75 7470 7574 7320 7769   Both outputs wi
+0000ed20: 6c6c 2062 6520 656d 7074 7920 6966 206e  ll be empty if n
+0000ed30: 6f0a 2020 2020 2020 2020 5345 434f 4e43  o.        SECONC
+0000ed40: 5420 6361 7264 7320 666f 756e 642e 0a0a  T cards found...
+0000ed50: 2020 2020 4e6f 7465 730a 2020 2020 2d2d      Notes.    --
+0000ed60: 2d2d 2d0a 2020 2020 5468 6973 2072 6f75  ---.    This rou
+0000ed70: 7469 6e65 2075 7365 7320 3a66 756e 633a  tine uses :func:
+0000ed80: 6072 6463 6172 6473 6020 746f 206c 6f61  `rdcards` to loa
+0000ed90: 6420 7468 6520 6461 7461 2e0a 0a20 2020  d the data...   
+0000eda0: 2045 7861 6d70 6c65 730a 2020 2020 2d2d   Examples.    --
+0000edb0: 2d2d 2d2d 2d2d 0a20 2020 203e 3e3e 2066  ------.    >>> f
+0000edc0: 726f 6d20 696f 2069 6d70 6f72 7420 5374  rom io import St
+0000edd0: 7269 6e67 494f 0a20 2020 203e 3e3e 2066  ringIO.    >>> f
+0000ede0: 726f 6d20 7079 7965 7469 2069 6d70 6f72  rom pyyeti impor
+0000edf0: 7420 6e61 7374 7261 6e0a 2020 2020 3e3e  t nastran.    >>
+0000ee00: 3e20 6275 6c6b 6461 7461 203d 2028 0a20  > bulkdata = (. 
+0000ee10: 2020 202e 2e2e 2020 2020 2022 5345 434f     ...     "SECO
+0000ee20: 4e43 542c 3130 312c 302c 2c4e 4f5c 6e22  NCT,101,0,,NO\n"
+0000ee30: 0a20 2020 202e 2e2e 2020 2020 2022 2c33  .    ...     ",3
+0000ee40: 2c33 302c 3131 2c31 3130 2c31 392c 3139  ,30,11,110,19,19
+0000ee50: 302c 3237 2c32 3730 5c6e 220a 2020 2020  0,27,270\n".    
+0000ee60: 2e2e 2e20 2020 2020 2224 5c6e 220a 2020  ...     "$\n".  
+0000ee70: 2020 2e2e 2e20 2020 2020 2253 4543 4f4e    ...     "SECON
+0000ee80: 4354 2c31 3031 2c30 2c2c 4e4f 5c6e 220a  CT,101,0,,NO\n".
+0000ee90: 2020 2020 2e2e 2e20 2020 2020 222c 3131      ...     ",11
+0000eea0: 3031 2c54 4852 552c 3131 3034 2c32 3130  01,THRU,1104,210
+0000eeb0: 312c 5448 5255 2c32 3130 345c 6e22 0a20  1,THRU,2104\n". 
+0000eec0: 2020 202e 2e2e 2029 0a20 2020 203e 3e3e     ... ).    >>>
+0000eed0: 2077 6974 6820 5374 7269 6e67 494f 2862   with StringIO(b
+0000eee0: 756c 6b64 6174 6129 2061 7320 663a 0a20  ulkdata) as f:. 
+0000eef0: 2020 202e 2e2e 2020 2020 2061 5f69 6473     ...     a_ids
+0000ef00: 2c20 625f 6964 7320 3d20 6e61 7374 7261  , b_ids = nastra
+0000ef10: 6e2e 7264 7365 636f 6e63 7428 6629 0a20  n.rdseconct(f). 
+0000ef20: 2020 203e 3e3e 2061 5f69 6473 2020 2020     >>> a_ids    
+0000ef30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ef40: 2020 2320 646f 6374 6573 743a 202b 454c    # doctest: +EL
+0000ef50: 4c49 5053 4953 0a20 2020 2061 7272 6179  LIPSIS.    array
+0000ef60: 285b 2020 2033 2c20 2020 3131 2c20 2020  ([   3,   11,   
+0000ef70: 3139 2c20 2020 3237 2c20 3131 3031 2c20  19,   27, 1101, 
+0000ef80: 3131 3032 2c20 3131 3033 2c20 3131 3034  1102, 1103, 1104
+0000ef90: 5d2e 2e2e 290a 2020 2020 3e3e 3e20 625f  ]...).    >>> b_
+0000efa0: 6964 7320 2020 2020 2020 2020 2020 2020  ids             
+0000efb0: 2020 2020 2020 2020 2023 2064 6f63 7465           # docte
+0000efc0: 7374 3a20 2b45 4c4c 4950 5349 530a 2020  st: +ELLIPSIS.  
+0000efd0: 2020 6172 7261 7928 5b20 2033 302c 2020    array([  30,  
+0000efe0: 3131 302c 2020 3139 302c 2020 3237 302c  110,  190,  270,
+0000eff0: 2032 3130 312c 2032 3130 322c 2032 3130   2101, 2102, 210
+0000f000: 332c 2032 3130 345d 2e2e 2e29 0a20 2020  3, 2104]...).   
+0000f010: 2022 2222 0a0a 2020 2020 6465 6620 5f67   """..    def _g
+0000f020: 6574 5f70 6169 7273 2863 6172 6429 3a0a  et_pairs(card):.
+0000f030: 2020 2020 2020 2020 2320 7472 756e 6361          # trunca
+0000f040: 7465 2061 6e64 2066 696c 7465 7220 6f75  te and filter ou
+0000f050: 7420 626c 616e 6b73 3a0a 2020 2020 2020  t blanks:.      
+0000f060: 2020 6361 7264 203d 205b 6920 666f 7220    card = [i for 
+0000f070: 6920 696e 2063 6172 645b 383a 5d20 6966  i in card[8:] if
+0000f080: 2069 5d0a 2020 2020 2020 2020 6974 203d   i].        it =
+0000f090: 2069 7465 7228 6361 7264 290a 2020 2020   iter(card).    
+0000f0a0: 2020 2020 666f 7220 612c 2062 2069 6e20      for a, b in 
+0000f0b0: 7a69 7028 6974 2c20 6974 293a 0a20 2020  zip(it, it):.   
+0000f0c0: 2020 2020 2020 2020 2079 6965 6c64 2061           yield a
+0000f0d0: 2c20 620a 0a20 2020 2073 6563 6f6e 6374  , b..    seconct
+0000f0e0: 5f64 6174 6120 3d20 7264 6361 7264 7328  _data = rdcards(
+0000f0f0: 662c 2022 7365 636f 6e63 7422 2c20 7265  f, "seconct", re
+0000f100: 7475 726e 5f76 6172 3d22 6c69 7374 2229  turn_var="list")
+0000f110: 0a20 2020 2061 5f69 6473 203d 205b 5d0a  .    a_ids = [].
+0000f120: 2020 2020 625f 6964 7320 3d20 5b5d 0a20      b_ids = []. 
+0000f130: 2020 2069 6620 7365 636f 6e63 745f 6461     if seconct_da
+0000f140: 7461 2069 7320 6e6f 7420 4e6f 6e65 3a0a  ta is not None:.
+0000f150: 2020 2020 2020 2020 666f 7220 6361 7264          for card
+0000f160: 2069 6e20 7365 636f 6e63 745f 6461 7461   in seconct_data
+0000f170: 3a0a 2020 2020 2020 2020 2020 2020 6974  :.            it
+0000f180: 203d 2069 7465 7228 5f67 6574 5f70 6169   = iter(_get_pai
+0000f190: 7273 2863 6172 6429 290a 2020 2020 2020  rs(card)).      
+0000f1a0: 2020 2020 2020 666f 7220 612c 2062 2069        for a, b i
+0000f1b0: 6e20 6974 3a0a 2020 2020 2020 2020 2020  n it:.          
+0000f1c0: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
+0000f1d0: 6e63 6528 622c 2073 7472 293a 2020 2320  nce(b, str):  # 
+0000f1e0: 6974 206d 7573 7420 6265 2022 5448 5255  it must be "THRU
+0000f1f0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+0000f200: 2020 2020 2020 2320 4254 4120 7361 7973        # BTA says
+0000f210: 2049 276d 2061 206a 6572 6b20 6966 2049   I'm a jerk if I
+0000f220: 2064 6f6e 2774 2063 6865 636b 2066 6f72   don't check for
+0000f230: 2022 5448 5255 2220 3a29 0a20 2020 2020   "THRU" :).     
+0000f240: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+0000f250: 322c 2062 3120 3d20 6e65 7874 2869 7429  2, b1 = next(it)
+0000f260: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000f270: 2020 2020 2074 6872 752c 2062 3220 3d20       thru, b2 = 
+0000f280: 6e65 7874 2869 7429 0a20 2020 2020 2020  next(it).       
+0000f290: 2020 2020 2020 2020 2020 2020 2061 5f69               a_i
+0000f2a0: 6473 2e65 7874 656e 6428 5b69 2066 6f72  ds.extend([i for
+0000f2b0: 2069 2069 6e20 7261 6e67 6528 612c 2061   i in range(a, a
+0000f2c0: 3220 2b20 3129 5d29 0a20 2020 2020 2020  2 + 1)]).       
+0000f2d0: 2020 2020 2020 2020 2020 2020 2062 5f69               b_i
+0000f2e0: 6473 2e65 7874 656e 6428 5b69 2066 6f72  ds.extend([i for
+0000f2f0: 2069 2069 6e20 7261 6e67 6528 6231 2c20   i in range(b1, 
+0000f300: 6232 202b 2031 295d 290a 2020 2020 2020  b2 + 1)]).      
+0000f310: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+0000f320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f330: 2020 2020 615f 6964 732e 6170 7065 6e64      a_ids.append
+0000f340: 2861 290a 2020 2020 2020 2020 2020 2020  (a).            
+0000f350: 2020 2020 2020 2020 625f 6964 732e 6170          b_ids.ap
+0000f360: 7065 6e64 2862 290a 2020 2020 7265 7475  pend(b).    retu
+0000f370: 726e 206e 702e 6172 7261 7928 615f 6964  rn np.array(a_id
+0000f380: 732c 2064 7479 7065 3d6e 702e 696e 7436  s, dtype=np.int6
+0000f390: 3429 2c20 6e70 2e61 7272 6179 2862 5f69  4), np.array(b_i
+0000f3a0: 6473 2c20 6474 7970 653d 6e70 2e69 6e74  ds, dtype=np.int
+0000f3b0: 3634 290a 0a0a 4067 7569 746f 6f6c 732e  64)...@guitools.
+0000f3c0: 7265 6164 5f74 6578 745f 6669 6c65 0a64  read_text_file.d
+0000f3d0: 6566 2061 736d 3275 7365 7428 662c 2074  ef asm2uset(f, t
+0000f3e0: 7279 5f72 6465 7874 726e 3d54 7275 6529  ry_rdextrn=True)
+0000f3f0: 3a0a 2020 2020 7222 2222 0a20 2020 2052  :.    r""".    R
+0000f400: 6561 6420 434f 5244 322a 2061 6e64 2047  ead CORD2* and G
+0000f410: 5249 4420 6361 7264 7320 6672 6f6d 2061  RID cards from a
+0000f420: 2022 2e61 736d 2220 6669 6c65 2074 6f20   ".asm" file to 
+0000f430: 6d61 6b65 2061 2055 5345 5420 7461 626c  make a USET tabl
+0000f440: 650a 0a20 2020 2050 6172 616d 6574 6572  e..    Parameter
+0000f450: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  s.    ----------
+0000f460: 0a20 2020 2066 203a 2073 7472 696e 6720  .    f : string 
+0000f470: 6f72 2066 696c 655f 6c69 6b65 206f 7220  or file_like or 
+0000f480: 4e6f 6e65 0a20 2020 2020 2020 2045 6974  None.        Eit
+0000f490: 6865 7220 6120 6e61 6d65 206f 6620 6120  her a name of a 
+0000f4a0: 6669 6c65 2c20 6f72 2069 7320 6120 6669  file, or is a fi
+0000f4b0: 6c65 5f6c 696b 6520 6f62 6a65 6374 2061  le_like object a
+0000f4c0: 7320 7265 7475 726e 6564 0a20 2020 2020  s returned.     
+0000f4d0: 2020 2062 7920 3a66 756e 633a 606f 7065     by :func:`ope
+0000f4e0: 6e60 2e20 4966 2066 696c 655f 6c69 6b65  n`. If file_like
+0000f4f0: 206f 626a 6563 742c 2069 7420 6973 2072   object, it is r
+0000f500: 6577 6f75 6e64 2066 6972 7374 2e20 4361  ewound first. Ca
+0000f510: 6e0a 2020 2020 2020 2020 616c 736f 2062  n.        also b
+0000f520: 6520 7468 6520 6e61 6d65 206f 6620 6120  e the name of a 
+0000f530: 6469 7265 6374 6f72 7920 6f72 204e 6f6e  directory or Non
+0000f540: 653b 2069 6e20 7468 6573 6520 6361 7365  e; in these case
+0000f550: 732c 2061 2047 5549 0a20 2020 2020 2020  s, a GUI.       
+0000f560: 2069 7320 6f70 656e 6564 2066 6f72 2066   is opened for f
+0000f570: 696c 6520 7365 6c65 6374 696f 6e2e 0a20  ile selection.. 
+0000f580: 2020 2074 7279 5f72 6465 7874 726e 203a     try_rdextrn :
+0000f590: 2062 6f6f 6c3b 206f 7074 696f 6e61 6c0a   bool; optional.
+0000f5a0: 2020 2020 2020 2020 4966 2054 7275 652c          If True,
+0000f5b0: 2072 6f75 7469 6e65 2077 696c 6c20 6174   routine will at
+0000f5c0: 7465 6d70 7420 746f 2072 6561 6420 7468  tempt to read th
+0000f5d0: 6520 2245 5854 524e 2220 6361 7264 2066  e "EXTRN" card f
+0000f5e0: 726f 6d0a 2020 2020 2020 2020 7468 6520  rom.        the 
+0000f5f0: 222e 7063 6822 2066 696c 652e 2049 6620  ".pch" file. If 
+0000f600: 6120 6669 6c65 6e61 6d65 2063 616e 6e6f  a filename canno
+0000f610: 7420 6265 2064 6574 6572 6d69 6e65 6420  t be determined 
+0000f620: 6672 6f6d 2060 6660 2c0a 2020 2020 2020  from `f`,.      
+0000f630: 2020 7468 6520 6174 7465 6d70 7420 746f    the attempt to
+0000f640: 2074 6865 2022 4558 5452 4e22 2063 6172   the "EXTRN" car
+0000f650: 6420 6973 2071 7569 6574 6c79 2073 6b69  d is quietly ski
+0000f660: 7070 6564 2061 6e64 2065 6163 680a 2020  pped and each.  
+0000f670: 2020 2020 2020 622d 7365 7420 6e6f 6465        b-set node
+0000f680: 2069 7320 6173 7375 6d65 6420 746f 2068   is assumed to h
+0000f690: 6176 6520 616c 6c20 3620 444f 462e 2053  ave all 6 DOF. S
+0000f6a0: 6565 204e 6f74 6573 2062 656c 6f77 2e0a  ee Notes below..
+0000f6b0: 0a20 2020 2052 6574 7572 6e73 0a20 2020  .    Returns.   
+0000f6c0: 202d 2d2d 2d2d 2d2d 0a20 2020 2075 7365   -------.    use
+0000f6d0: 7420 3a20 7061 6e64 6173 2044 6174 6146  t : pandas DataF
+0000f6e0: 7261 6d65 0a20 2020 2020 2020 2041 2044  rame.        A D
+0000f6f0: 6174 6146 7261 6d65 2061 7320 6f75 7470  ataFrame as outp
+0000f700: 7574 2062 790a 2020 2020 2020 2020 3a66  ut by.        :f
+0000f710: 756e 633a 6070 7979 6574 692e 6e61 7374  unc:`pyyeti.nast
+0000f720: 7261 6e2e 6f70 322e 4f50 322e 7264 6e32  ran.op2.OP2.rdn2
+0000f730: 636f 7032 602e 2043 6f6e 7461 696e 7320  cop2`. Contains 
+0000f740: 616c 6c20 4752 4944 2061 6e64 0a20 2020  all GRID and.   
+0000f750: 2020 2020 2053 504f 494e 5420 444f 4620       SPOINT DOF 
+0000f760: 696e 2074 6865 202e 6173 6d20 6669 6c65  in the .asm file
+0000f770: 2069 6e20 7468 6520 6f72 6465 7220 7370   in the order sp
+0000f780: 6563 6966 6965 6420 6f6e 2074 6865 0a20  ecified on the. 
+0000f790: 2020 2020 2020 2053 4543 4f4e 4354 2063         SECONCT c
+0000f7a0: 6172 642e 2054 6869 7320 6973 2063 6f6d  ard. This is com
+0000f7b0: 7061 7469 626c 6520 7769 7468 2074 6865  patible with the
+0000f7c0: 206d 6f64 656c 206d 6174 7269 6365 7320   model matrices 
+0000f7d0: 2865 672c 0a20 2020 2020 2020 2069 6e20  (eg,.        in 
+0000f7e0: 7468 6520 2e6f 7034 2066 696c 6529 2e0a  the .op4 file)..
+0000f7f0: 2020 2020 636f 6f72 6472 6566 203a 2064      coordref : d
+0000f800: 6963 7469 6f6e 6172 790a 2020 2020 2020  ictionary.      
+0000f810: 2020 4469 6374 696f 6e61 7279 2077 6974    Dictionary wit
+0000f820: 6820 7468 6520 6b65 7973 2062 6569 6e67  h the keys being
+0000f830: 2074 6865 2063 6f6f 7264 696e 6174 6520   the coordinate 
+0000f840: 7379 7374 656d 2069 6420 616e 640a 2020  system id and.  
+0000f850: 2020 2020 2020 7468 6520 7661 6c75 6573        the values
+0000f860: 2062 6569 6e67 2074 6865 2035 7833 206d   being the 5x3 m
+0000f870: 6174 7269 783a 3a0a 0a20 2020 2020 2020  atrix::..       
+0000f880: 2020 2020 205b 6964 2020 7479 7065 2030       [id  type 0
+0000f890: 5d20 2023 206f 7574 7075 7420 636f 6f72  ]  # output coor
+0000f8a0: 642e 2073 7973 2e20 6964 2061 6e64 2074  d. sys. id and t
+0000f8b0: 7970 650a 2020 2020 2020 2020 2020 2020  ype.            
+0000f8c0: 5b78 6f20 2079 6f20 207a 6f5d 2020 2320  [xo  yo  zo]  # 
+0000f8d0: 6f72 6967 696e 206f 6620 636f 6f72 642e  origin of coord.
+0000f8e0: 2073 7973 7465 6d0a 2020 2020 2020 2020   system.        
+0000f8f0: 2020 2020 5b20 2020 2054 2020 2020 205d      [    T     ]
+0000f900: 2020 2320 3378 3320 7472 616e 7366 6f72    # 3x3 transfor
+0000f910: 6d61 7469 6f6e 2074 6f20 6261 7369 630a  mation to basic.
+0000f920: 2020 2020 2020 2020 2020 2020 4e6f 7465              Note
+0000f930: 2074 6861 7420 5420 6973 2066 6f72 2074   that T is for t
+0000f940: 6865 2063 6f6f 7264 696e 6174 6520 7379  he coordinate sy
+0000f950: 7374 656d 2c20 6e6f 7420 6120 6772 6964  stem, not a grid
+0000f960: 0a20 2020 2020 2020 2020 2020 2028 756e  .            (un
+0000f970: 6c65 7373 2074 7970 6520 3d20 3120 7768  less type = 1 wh
+0000f980: 6963 6820 6d65 616e 7320 7265 6374 616e  ich means rectan
+0000f990: 6775 6c61 7229 0a0a 2020 2020 6273 6574  gular)..    bset
+0000f9a0: 5f62 6f6f 6c20 3a20 3164 206e 6461 7272  _bool : 1d ndarr
+0000f9b0: 6179 0a20 2020 2020 2020 2041 2062 6f6f  ay.        A boo
+0000f9c0: 6c65 616e 2070 6172 7469 7469 6f6e 2076  lean partition v
+0000f9d0: 6563 746f 7220 7769 7468 2054 7275 6520  ector with True 
+0000f9e0: 666f 7220 7468 6520 622d 7365 742e 2054  for the b-set. T
+0000f9f0: 6869 7320 6973 0a20 2020 2020 2020 2063  his is.        c
+0000fa00: 7265 6174 6564 2066 6f72 2063 6f6e 7665  reated for conve
+0000fa10: 6e69 656e 6365 2062 793a 3a0a 0a20 2020  nience by::..   
+0000fa20: 2020 2020 2020 2020 2066 726f 6d20 7079           from py
+0000fa30: 7965 7469 2069 6d70 6f72 7420 6e61 7374  yeti import nast
+0000fa40: 7261 6e0a 2020 2020 2020 2020 2020 2020  ran.            
+0000fa50: 6273 6574 5f62 6f6f 6c20 3d20 6e61 7374  bset_bool = nast
+0000fa60: 7261 6e2e 6d6b 7365 7470 7628 7573 6574  ran.mksetpv(uset
+0000fa70: 2c20 2761 272c 2027 6227 290a 0a20 2020  , 'a', 'b')..   
+0000fa80: 204e 6f74 6573 0a20 2020 202d 2d2d 2d2d   Notes.    -----
+0000fa90: 0a20 2020 2054 6869 7320 726f 7574 696e  .    This routin
+0000faa0: 6520 7769 6c6c 2061 7474 656d 7074 2074  e will attempt t
+0000fab0: 6f20 7265 6164 2074 6865 2022 4558 5452  o read the "EXTR
+0000fac0: 4e22 2063 6172 6420 6672 6f6d 2074 6865  N" card from the
+0000fad0: 202e 7063 680a 2020 2020 6669 6c65 2069   .pch.    file i
+0000fae0: 6e20 6361 7365 2073 6f6d 6520 622d 7365  n case some b-se
+0000faf0: 7420 6e6f 6465 7320 646f 206e 6f74 2069  t nodes do not i
+0000fb00: 6e63 6c75 6465 2061 6c6c 2036 2044 4f46  nclude all 6 DOF
+0000fb10: 2e20 466f 720a 2020 2020 6578 616d 706c  . For.    exampl
+0000fb20: 652c 2061 206d 6f64 656c 2063 6f75 6c64  e, a model could
+0000fb30: 2068 6176 6520 3720 622d 7365 7420 444f   have 7 b-set DO
+0000fb40: 4620 616e 6420 3120 712d 7365 7420 444f  F and 1 q-set DO
+0000fb50: 462e 2049 6620 7468 6520 370a 2020 2020  F. If the 7.    
+0000fb60: 622d 7365 7420 444f 4620 6172 6520 636f  b-set DOF are co
+0000fb70: 6d70 6f73 6564 206f 6620 616c 6c20 3620  mposed of all 6 
+0000fb80: 444f 4620 666f 7220 6e6f 6465 2031 3030  DOF for node 100
+0000fb90: 2061 6e64 206a 7573 7420 7468 650a 2020   and just the.  
+0000fba0: 2020 7365 636f 6e64 2044 4f46 2066 6f72    second DOF for
+0000fbb0: 206e 6f64 6520 3230 302c 2074 6865 2045   node 200, the E
+0000fbc0: 5854 524e 2063 6172 6420 776f 756c 6420  XTRN card would 
+0000fbd0: 6c69 6b65 2074 6869 733a 3a0a 0a20 2020  like this::..   
+0000fbe0: 2020 2020 2045 5854 524e 2c31 3030 2c31       EXTRN,100,1
+0000fbf0: 3233 3435 362c 3230 302c 322c 3130 3031  23456,200,2,1001
+0000fc00: 2c30 0a0a 2020 2020 4578 616d 706c 6573  ,0..    Examples
+0000fc10: 0a20 2020 202d 2d2d 2d2d 2d2d 2d0a 2020  .    --------.  
+0000fc20: 2020 3e3e 3e20 696d 706f 7274 206e 756d    >>> import num
+0000fc30: 7079 2061 7320 6e70 0a20 2020 203e 3e3e  py as np.    >>>
+0000fc40: 2066 726f 6d20 696f 2069 6d70 6f72 7420   from io import 
+0000fc50: 5374 7269 6e67 494f 0a20 2020 203e 3e3e  StringIO.    >>>
+0000fc60: 2066 726f 6d20 7079 7965 7469 2069 6d70   from pyyeti imp
+0000fc70: 6f72 7420 6e61 7374 7261 6e0a 2020 2020  ort nastran.    
+0000fc80: 3e3e 3e20 6173 6d5f 6275 6c6b 203d 2028  >>> asm_bulk = (
+0000fc90: 0a20 2020 202e 2e2e 2020 2020 2224 2053  .    ...    "$ S
+0000fca0: 4531 3031 2041 5353 454d 424c 5920 4649  E101 ASSEMBLY FI
+0000fcb0: 4c45 5c6e 220a 2020 2020 2e2e 2e20 2020  LE\n".    ...   
+0000fcc0: 2022 5345 4255 4c4b 2c31 3031 2c45 5854   "SEBULK,101,EXT
+0000fcd0: 4f50 342c 2c4d 414e 5541 4c2c 2c2c 3130  OP4,,MANUAL,,,10
+0000fce0: 315c 6e22 0a20 2020 202e 2e2e 2020 2020  1\n".    ...    
+0000fcf0: 2253 4543 4f4e 4354 2c31 3031 2c30 2c2c  "SECONCT,101,0,,
+0000fd00: 4e4f 5c6e 220a 2020 2020 2e2e 2e20 2020  NO\n".    ...   
+0000fd10: 2022 2c33 2c33 2c31 3130 2c31 3130 2c31   ",3,3,110,110,1
+0000fd20: 392c 3139 2c32 372c 3237 5c6e 220a 2020  9,19,27,27\n".  
+0000fd30: 2020 2e2e 2e20 2020 2022 2420 436f 6f72    ...    "$ Coor
+0000fd40: 6469 6e61 7465 2031 303a 5c6e 220a 2020  dinate 10:\n".  
+0000fd50: 2020 2e2e 2e20 2020 2022 434f 5244 3252    ...    "CORD2R
+0000fd60: 2c31 302c 302c 302e 302c 302e 302c 302e  ,10,0,0.0,0.0,0.
+0000fd70: 302c 312e 302c 302e 302c 302e 305c 6e22  0,1.0,0.0,0.0\n"
+0000fd80: 0a20 2020 202e 2e2e 2020 2020 222c 302e  .    ...    ",0.
+0000fd90: 302c 312e 302c 302e 305c 6e22 0a20 2020  0,1.0,0.0\n".   
+0000fda0: 202e 2e2e 2020 2020 2247 5249 442c 332c   ...    "GRID,3,
+0000fdb0: 302c 3630 302e 2c30 2e2c 3330 302e 2c30  0,600.,0.,300.,0
+0000fdc0: 5c6e 220a 2020 2020 2e2e 2e20 2020 2022  \n".    ...    "
+0000fdd0: 4752 4944 2c31 392c 302c 3630 302e 2c33  GRID,19,0,600.,3
+0000fde0: 3030 2e2c 302e 2c30 5c6e 220a 2020 2020  00.,0.,0\n".    
+0000fdf0: 2e2e 2e20 2020 2022 4752 4944 2c32 372c  ...    "GRID,27,
+0000fe00: 302c 3630 302e 2c30 2e2c 302e 5c6e 220a  0,600.,0.,0.\n".
+0000fe10: 2020 2020 2e2e 2e20 2020 2022 5350 4f49      ...    "SPOI
+0000fe20: 4e54 2c31 3130 5c6e 220a 2020 2020 2e2e  NT,110\n".    ..
+0000fe30: 2e20 290a 2020 2020 3e3e 3e20 7769 7468  . ).    >>> with
+0000fe40: 2053 7472 696e 6749 4f28 6173 6d5f 6275   StringIO(asm_bu
+0000fe50: 6c6b 2920 6173 2066 3a0a 2020 2020 2e2e  lk) as f:.    ..
+0000fe60: 2e20 2020 2020 752c 2063 2c20 6220 3d20  .     u, c, b = 
+0000fe70: 6e61 7374 7261 6e2e 6173 6d32 7573 6574  nastran.asm2uset
+0000fe80: 2866 290a 2020 2020 3e3e 3e20 7520 2020  (f).    >>> u   
+0000fe90: 2020 2020 2020 2020 2023 2064 6f63 7465           # docte
+0000fea0: 7374 3a20 2b45 4c4c 4950 5349 530a 2020  st: +ELLIPSIS.  
+0000feb0: 2020 2020 2020 2020 2020 2020 6e61 7373              nass
+0000fec0: 6574 2020 2020 2020 7820 2020 2020 2079  et      x      y
+0000fed0: 2020 2020 2020 7a0a 2020 2020 6964 2020        z.    id  
+0000fee0: 646f 662e 2e2e 0a20 2020 2033 2020 2031  dof....    3   1
+0000fef0: 2020 2020 3230 3937 3135 3420 2036 3030      2097154  600
+0000ff00: 2e30 2020 2020 302e 3020 2033 3030 2e30  .0    0.0  300.0
+0000ff10: 0a20 2020 2020 2020 2032 2020 2020 3230  .        2    20
+0000ff20: 3937 3135 3420 2020 2030 2e30 2020 2020  97154    0.0    
+0000ff30: 312e 3020 2020 2030 2e30 0a20 2020 2020  1.0    0.0.     
+0000ff40: 2020 2033 2020 2020 3230 3937 3135 3420     3    2097154 
+0000ff50: 2020 2030 2e30 2020 2020 302e 3020 2020     0.0    0.0   
+0000ff60: 2030 2e30 0a20 2020 2020 2020 2034 2020   0.0.        4  
+0000ff70: 2020 3230 3937 3135 3420 2020 2031 2e30    2097154    1.0
+0000ff80: 2020 2020 302e 3020 2020 2030 2e30 0a20      0.0    0.0. 
+0000ff90: 2020 2020 2020 2035 2020 2020 3230 3937         5    2097
+0000ffa0: 3135 3420 2020 2030 2e30 2020 2020 312e  154    0.0    1.
+0000ffb0: 3020 2020 2030 2e30 0a20 2020 2020 2020  0    0.0.       
+0000ffc0: 2036 2020 2020 3230 3937 3135 3420 2020   6    2097154   
+0000ffd0: 2030 2e30 2020 2020 302e 3020 2020 2031   0.0    0.0    1
+0000ffe0: 2e30 0a20 2020 2031 3130 2030 2020 2020  .0.    110 0    
+0000fff0: 3431 3934 3330 3420 2020 2030 2e30 2020  4194304    0.0  
+00010000: 2020 302e 3020 2020 2030 2e30 0a20 2020    0.0    0.0.   
+00010010: 2031 3920 2031 2020 2020 3230 3937 3135   19  1    209715
+00010020: 3420 2036 3030 2e30 2020 3330 302e 3020  4  600.0  300.0 
+00010030: 2020 2030 2e30 0a20 2020 2020 2020 2032     0.0.        2
+00010040: 2020 2020 3230 3937 3135 3420 2020 2030      2097154    0
+00010050: 2e30 2020 2020 312e 3020 2020 2030 2e30  .0    1.0    0.0
+00010060: 0a20 2020 2020 2020 2033 2020 2020 3230  .        3    20
+00010070: 3937 3135 3420 2020 2030 2e30 2020 2020  97154    0.0    
+00010080: 302e 3020 2020 2030 2e30 0a20 2020 2020  0.0    0.0.     
+00010090: 2020 2034 2020 2020 3230 3937 3135 3420     4    2097154 
+000100a0: 2020 2031 2e30 2020 2020 302e 3020 2020     1.0    0.0   
+000100b0: 2030 2e30 0a20 2020 2020 2020 2035 2020   0.0.        5  
+000100c0: 2020 3230 3937 3135 3420 2020 2030 2e30    2097154    0.0
+000100d0: 2020 2020 312e 3020 2020 2030 2e30 0a20      1.0    0.0. 
+000100e0: 2020 2020 2020 2036 2020 2020 3230 3937         6    2097
+000100f0: 3135 3420 2020 2030 2e30 2020 2020 302e  154    0.0    0.
+00010100: 3020 2020 2031 2e30 0a20 2020 2032 3720  0    1.0.    27 
+00010110: 2031 2020 2020 3230 3937 3135 3420 2036   1    2097154  6
+00010120: 3030 2e30 2020 2020 302e 3020 2020 2030  00.0    0.0    0
+00010130: 2e30 0a20 2020 2020 2020 2032 2020 2020  .0.        2    
+00010140: 3230 3937 3135 3420 2020 2030 2e30 2020  2097154    0.0  
+00010150: 2020 312e 3020 2020 2030 2e30 0a20 2020    1.0    0.0.   
+00010160: 2020 2020 2033 2020 2020 3230 3937 3135       3    209715
+00010170: 3420 2020 2030 2e30 2020 2020 302e 3020  4    0.0    0.0 
+00010180: 2020 2030 2e30 0a20 2020 2020 2020 2034     0.0.        4
+00010190: 2020 2020 3230 3937 3135 3420 2020 2031      2097154    1
+000101a0: 2e30 2020 2020 302e 3020 2020 2030 2e30  .0    0.0    0.0
+000101b0: 0a20 2020 2020 2020 2035 2020 2020 3230  .        5    20
+000101c0: 3937 3135 3420 2020 2030 2e30 2020 2020  97154    0.0    
+000101d0: 312e 3020 2020 2030 2e30 0a20 2020 2020  1.0    0.0.     
+000101e0: 2020 2036 2020 2020 3230 3937 3135 3420     6    2097154 
+000101f0: 2020 2030 2e30 2020 2020 302e 3020 2020     0.0    0.0   
+00010200: 2031 2e30 0a20 2020 203e 3e3e 2063 2020   1.0.    >>> c  
+00010210: 2020 2020 2020 2020 2020 2320 646f 6374            # doct
+00010220: 6573 743a 202b 534b 4950 0a20 2020 207b  est: +SKIP.    {
+00010230: 303a 2061 7272 6179 285b 5b20 302e 2c20  0: array([[ 0., 
+00010240: 2031 2e2c 2020 302e 5d2c 0a20 2020 2020   1.,  0.],.     
+00010250: 2020 2020 2020 205b 2030 2e2c 2020 302e         [ 0.,  0.
+00010260: 2c20 2030 2e5d 2c0a 2020 2020 2020 2020  ,  0.],.        
+00010270: 2020 2020 5b20 312e 2c20 2030 2e2c 2020      [ 1.,  0.,  
+00010280: 302e 5d2c 0a20 2020 2020 2020 2020 2020  0.],.           
+00010290: 205b 2030 2e2c 2020 312e 2c20 2030 2e5d   [ 0.,  1.,  0.]
+000102a0: 2c0a 2020 2020 2020 2020 2020 2020 5b20  ,.            [ 
+000102b0: 302e 2c20 2030 2e2c 2020 312e 5d5d 292c  0.,  0.,  1.]]),
+000102c0: 0a20 2020 2020 3130 3a20 6172 7261 7928  .     10: array(
+000102d0: 5b5b 2031 302e 2c20 2020 312e 2c20 2020  [[ 10.,   1.,   
+000102e0: 302e 5d2c 0a20 2020 2020 2020 2020 2020  0.],.           
+000102f0: 205b 2020 302e 2c20 2020 302e 2c20 2020   [  0.,   0.,   
+00010300: 302e 5d2c 0a20 2020 2020 2020 2020 2020  0.],.           
+00010310: 205b 2020 302e 2c20 2020 302e 2c20 2020   [  0.,   0.,   
+00010320: 312e 5d2c 0a20 2020 2020 2020 2020 2020  1.],.           
+00010330: 205b 2020 312e 2c20 2020 302e 2c20 2020   [  1.,   0.,   
+00010340: 302e 5d2c 0a20 2020 2020 2020 2020 2020  0.],.           
+00010350: 205b 2020 302e 2c20 2020 312e 2c20 2020   [  0.,   1.,   
+00010360: 302e 5d5d 297d 0a20 2020 203e 3e3e 206e  0.]])}.    >>> n
+00010370: 702e 7365 745f 7072 696e 746f 7074 696f  p.set_printoptio
+00010380: 6e73 286c 696e 6577 6964 7468 3d35 3529  ns(linewidth=55)
+00010390: 0a20 2020 203e 3e3e 2062 0a20 2020 2061  .    >>> b.    a
+000103a0: 7272 6179 285b 2054 7275 652c 2020 5472  rray([ True,  Tr
+000103b0: 7565 2c20 2054 7275 652c 2020 5472 7565  ue,  True,  True
+000103c0: 2c20 2054 7275 652c 2020 5472 7565 2c20  ,  True,  True, 
+000103d0: 4661 6c73 652c 0a20 2020 2020 2020 2020  False,.         
+000103e0: 2020 2054 7275 652c 2020 5472 7565 2c20     True,  True, 
+000103f0: 2054 7275 652c 2020 5472 7565 2c20 2054   True,  True,  T
+00010400: 7275 652c 2020 5472 7565 2c20 2054 7275  rue,  True,  Tru
+00010410: 652c 0a20 2020 2020 2020 2020 2020 2054  e,.            T
+00010420: 7275 652c 2020 5472 7565 2c20 2054 7275  rue,  True,  Tru
+00010430: 652c 2020 5472 7565 2c20 2054 7275 655d  e,  True,  True]
+00010440: 2c20 6474 7970 653d 626f 6f6c 290a 2020  , dtype=bool).  
+00010450: 2020 2222 220a 2020 2020 7573 6574 2c20    """.    uset, 
+00010460: 636f 6f72 6473 203d 2062 756c 6b32 7573  coords = bulk2us
+00010470: 6574 2866 290a 0a20 2020 2023 2061 6464  et(f)..    # add
+00010480: 2073 706f 696e 7473 2074 6f20 7573 6574   spoints to uset
+00010490: 2074 6162 6c65 3a0a 2020 2020 7370 6f69   table:.    spoi
+000104a0: 6e74 7320 3d20 7264 7370 6f69 6e74 7328  nts = rdspoints(
+000104b0: 6629 0a20 2020 2069 6620 7370 6f69 6e74  f).    if spoint
+000104c0: 7320 6973 206e 6f74 204e 6f6e 653a 0a20  s is not None:. 
+000104d0: 2020 2020 2020 206e 203d 206c 656e 2873         n = len(s
+000104e0: 706f 696e 7473 290a 2020 2020 2020 2020  points).        
+000104f0: 646f 6620 3d20 6e70 2e7a 6572 6f73 2828  dof = np.zeros((
+00010500: 6e2c 2032 292c 206e 702e 696e 7436 3429  n, 2), np.int64)
+00010510: 0a20 2020 2020 2020 2064 6f66 5b3a 2c20  .        dof[:, 
+00010520: 305d 203d 2073 706f 696e 7473 0a20 2020  0] = spoints.   
+00010530: 2020 2020 2075 7365 745f 7370 6f69 6e74       uset_spoint
+00010540: 7320 3d20 6e32 702e 6d61 6b65 5f75 7365  s = n2p.make_use
+00010550: 7428 646f 662c 206e 3270 2e6d 6b75 7365  t(dof, n2p.mkuse
+00010560: 746d 6173 6b28 2271 2229 2c20 6e70 2e7a  tmask("q"), np.z
+00010570: 6572 6f73 2828 6e2c 2033 2929 290a 2020  eros((n, 3))).  
+00010580: 2020 2020 2020 7573 6574 203d 2070 642e        uset = pd.
+00010590: 636f 6e63 6174 285b 7573 6574 2c20 7573  concat([uset, us
+000105a0: 6574 5f73 706f 696e 7473 5d2c 2061 7869  et_spoints], axi
+000105b0: 733d 3029 0a0a 2020 2020 6966 2074 7279  s=0)..    if try
+000105c0: 5f72 6465 7874 726e 3a0a 2020 2020 2020  _rdextrn:.      
+000105d0: 2020 7472 793a 0a20 2020 2020 2020 2020    try:.         
+000105e0: 2020 2066 696c 656e 616d 6520 3d20 662e     filename = f.
+000105f0: 6e61 6d65 0a20 2020 2020 2020 2065 7863  name.        exc
+00010600: 6570 7420 4174 7472 6962 7574 6545 7272  ept AttributeErr
+00010610: 6f72 3a0a 2020 2020 2020 2020 2020 2020  or:.            
+00010620: 7061 7373 0a20 2020 2020 2020 2065 6c73  pass.        els
+00010630: 653a 0a20 2020 2020 2020 2020 2020 2064  e:.            d
+00010640: 6f66 203d 2072 6465 7874 726e 2866 696c  of = rdextrn(fil
+00010650: 656e 616d 652e 7265 706c 6163 6528 222e  ename.replace(".
+00010660: 6173 6d22 2c20 222e 7063 6822 2929 0a20  asm", ".pch")). 
+00010670: 2020 2020 2020 2020 2020 2075 7365 745f             uset_
+00010680: 6f72 6465 7265 6420 3d20 7573 6574 2e6c  ordered = uset.l
+00010690: 6f63 5b6c 6973 7428 646f 6629 5d0a 2020  oc[list(dof)].  
+000106a0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+000106b0: 2075 7365 745f 6f72 6465 7265 642c 2063   uset_ordered, c
+000106c0: 6f6f 7264 732c 206e 3270 2e6d 6b73 6574  oords, n2p.mkset
+000106d0: 7076 2875 7365 745f 6f72 6465 7265 642c  pv(uset_ordered,
+000106e0: 2022 6122 2c20 2262 2229 0a0a 2020 2020   "a", "b")..    
+000106f0: 615f 6964 7320 3d20 7264 7365 636f 6e63  a_ids = rdseconc
+00010700: 7428 6629 5b30 5d0a 2020 2020 7573 6574  t(f)[0].    uset
+00010710: 5f6f 7264 6572 6564 203d 2075 7365 742e  _ordered = uset.
+00010720: 6c6f 635b 615f 6964 735d 0a20 2020 2069  loc[a_ids].    i
+00010730: 6620 7573 6574 5f6f 7264 6572 6564 2e73  f uset_ordered.s
+00010740: 6861 7065 5b30 5d20 213d 2075 7365 742e  hape[0] != uset.
+00010750: 7368 6170 655b 305d 3a0a 2020 2020 2020  shape[0]:.      
+00010760: 2020 7261 6973 6520 5275 6e74 696d 6545    raise RuntimeE
+00010770: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
+00010780: 2020 224e 756d 6265 7220 6f66 2053 4543    "Number of SEC
+00010790: 4f4e 4354 2073 7570 6572 656c 656d 656e  ONCT superelemen
+000107a0: 7420 2741 2720 444f 4620 646f 206e 6f74  t 'A' DOF do not
+000107b0: 206d 6174 6368 2047 5249 4420 616e 6422   match GRID and"
+000107c0: 0a20 2020 2020 2020 2020 2020 2022 2053  .            " S
+000107d0: 504f 494e 5420 6361 7264 7320 696e 2066  POINT cards in f
+000107e0: 696c 653a 5c6e 220a 2020 2020 2020 2020  ile:\n".        
+000107f0: 2020 2020 6622 2020 2020 2320 444f 4620      f"    # DOF 
+00010800: 6f6e 2053 4543 4f4e 4354 203d 207b 7573  on SECONCT = {us
+00010810: 6574 5f6f 7264 6572 6564 2e73 6861 7065  et_ordered.shape
+00010820: 5b30 5d7d 5c6e 220a 2020 2020 2020 2020  [0]}\n".        
+00010830: 2020 2020 6622 2020 2020 2320 444f 4620      f"    # DOF 
+00010840: 6f6e 2047 5249 4453 2f53 504f 494e 5453  on GRIDS/SPOINTS
+00010850: 203d 207b 7573 6574 2e73 6861 7065 5b30   = {uset.shape[0
+00010860: 5d7d 220a 2020 2020 2020 2020 290a 0a20  ]}".        ).. 
+00010870: 2020 2072 6574 7572 6e20 7573 6574 5f6f     return uset_o
+00010880: 7264 6572 6564 2c20 636f 6f72 6473 2c20  rdered, coords, 
+00010890: 6e32 702e 6d6b 7365 7470 7628 7573 6574  n2p.mksetpv(uset
+000108a0: 5f6f 7264 6572 6564 2c20 2261 222c 2022  _ordered, "a", "
+000108b0: 6222 290a 0a0a 6465 6620 7264 7774 6275  b")...def rdwtbu
+000108c0: 6c6b 2866 696e 2c20 666f 7574 293a 0a20  lk(fin, fout):. 
+000108d0: 2020 2022 2222 0a20 2020 2047 6574 2062     """.    Get b
+000108e0: 756c 6b20 6461 7461 2066 726f 6d20 6120  ulk data from a 
+000108f0: 736f 7274 6564 204e 6173 7472 616e 206f  sorted Nastran o
+00010900: 7574 7075 7420 6669 6c65 2e0a 0a20 2020  utput file...   
+00010910: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
+00010920: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2066  ----------.    f
+00010930: 696e 203a 2073 7472 696e 6720 6f72 2066  in : string or f
+00010940: 696c 655f 6c69 6b65 206f 7220 4e6f 6e65  ile_like or None
+00010950: 0a20 2020 2020 2020 2045 6974 6865 7220  .        Either 
+00010960: 6120 6e61 6d65 206f 6620 6120 6669 6c65  a name of a file
+00010970: 2c20 6f72 2069 7320 6120 6669 6c65 5f6c  , or is a file_l
+00010980: 696b 6520 6f62 6a65 6374 2061 7320 7265  ike object as re
+00010990: 7475 726e 6564 0a20 2020 2020 2020 2062  turned.        b
+000109a0: 7920 3a66 756e 633a 606f 7065 6e60 2e20  y :func:`open`. 
+000109b0: 4966 2066 696c 655f 6c69 6b65 206f 626a  If file_like obj
+000109c0: 6563 742c 2069 7420 6973 2072 6577 6f75  ect, it is rewou
+000109d0: 6e64 2066 6972 7374 2e20 4361 6e0a 2020  nd first. Can.  
+000109e0: 2020 2020 2020 616c 736f 2062 6520 7468        also be th
+000109f0: 6520 6e61 6d65 206f 6620 6120 6469 7265  e name of a dire
+00010a00: 6374 6f72 7920 6f72 204e 6f6e 653b 2069  ctory or None; i
+00010a10: 6e20 7468 6573 6520 6361 7365 732c 2061  n these cases, a
+00010a20: 2047 5549 0a20 2020 2020 2020 2069 7320   GUI.        is 
+00010a30: 6f70 656e 6564 2066 6f72 2066 696c 6520  opened for file 
+00010a40: 7365 6c65 6374 696f 6e2e 0a20 2020 2066  selection..    f
+00010a50: 6f75 7420 3a20 7374 7269 6e67 206f 7220  out : string or 
+00010a60: 6669 6c65 5f6c 696b 6520 6f72 2031 206f  file_like or 1 o
+00010a70: 7220 4e6f 6e65 0a20 2020 2020 2020 2045  r None.        E
+00010a80: 6974 6865 7220 6120 6e61 6d65 206f 6620  ither a name of 
+00010a90: 6120 6669 6c65 2c20 6f72 2069 7320 6120  a file, or is a 
+00010aa0: 6669 6c65 5f6c 696b 6520 6f62 6a65 6374  file_like object
+00010ab0: 2061 7320 7265 7475 726e 6564 0a20 2020   as returned.   
+00010ac0: 2020 2020 2062 7920 3a66 756e 633a 606f       by :func:`o
+00010ad0: 7065 6e60 206f 7220 3a63 6c61 7373 3a60  pen` or :class:`
+00010ae0: 696f 2e53 7472 696e 6749 4f60 2e20 496e  io.StringIO`. In
+00010af0: 7075 7420 6173 2069 6e74 6567 6572 2031  put as integer 1
+00010b00: 2074 6f0a 2020 2020 2020 2020 7772 6974   to.        writ
+00010b10: 6520 746f 2073 7464 6f75 742e 2043 616e  e to stdout. Can
+00010b20: 2061 6c73 6f20 6265 2074 6865 206e 616d   also be the nam
+00010b30: 6520 6f66 2061 2064 6972 6563 746f 7279  e of a directory
+00010b40: 206f 7220 4e6f 6e65 3b0a 2020 2020 2020   or None;.      
+00010b50: 2020 696e 2074 6865 7365 2063 6173 6573    in these cases
+00010b60: 2c20 6120 4755 4920 6973 206f 7065 6e65  , a GUI is opene
+00010b70: 6420 666f 7220 6669 6c65 2073 656c 6563  d for file selec
+00010b80: 7469 6f6e 2e0a 0a20 2020 2052 6574 7572  tion...    Retur
+00010b90: 6e73 0a20 2020 202d 2d2d 2d2d 2d2d 0a20  ns.    -------. 
+00010ba0: 2020 204e 6f6e 650a 0a20 2020 204e 6f74     None..    Not
+00010bb0: 6573 0a20 2020 202d 2d2d 2d2d 0a20 2020  es.    -----.   
+00010bc0: 2052 6561 6473 2074 6865 2062 756c 6b20   Reads the bulk 
+00010bd0: 6461 7461 2066 726f 6d20 696e 7075 7420  data from input 
+00010be0: 6669 6c65 2061 6e64 2077 7269 7465 7320  file and writes 
+00010bf0: 6974 2074 6f20 7468 6520 6f75 7470 7574  it to the output
+00010c00: 0a20 2020 2066 696c 652e 2041 6c6c 2063  .    file. All c
+00010c10: 6f6e 7469 6e75 6174 696f 6e20 636f 6465  ontinuation code
+00010c20: 7320 6172 6520 7374 7269 7070 6564 206f  s are stripped o
+00010c30: 6666 2e0a 0a20 2020 2048 6173 206e 6f74  ff...    Has not
+00010c40: 2062 6565 6e20 7465 7374 6564 206f 6e20   been tested on 
+00010c50: 756e 736f 7274 6564 2062 756c 6b2e 0a0a  unsorted bulk...
+00010c60: 2020 2020 4578 616d 706c 6520 7573 6167      Example usag
+00010c70: 653a 3a0a 0a20 2020 2020 2020 2066 726f  e::..        fro
+00010c80: 6d20 7079 7965 7469 2069 6d70 6f72 7420  m pyyeti import 
+00010c90: 6e61 7374 7261 6e0a 2020 2020 2020 2020  nastran.        
+00010ca0: 6e61 7374 7261 6e2e 7264 7774 6275 6c6b  nastran.rdwtbulk
+00010cb0: 2827 6d65 636f 312e 6f75 7427 2c20 276d  ('meco1.out', 'm
+00010cc0: 6563 6f31 2e62 6c6b 2729 0a20 2020 2022  eco1.blk').    "
+00010cd0: 2222 0a0a 2020 2020 4067 7569 746f 6f6c  ""..    @guitool
+00010ce0: 732e 7265 6164 5f74 6578 745f 6669 6c65  s.read_text_file
+00010cf0: 0a20 2020 2064 6566 205f 7264 6275 6c6b  .    def _rdbulk
+00010d00: 2866 293a 0a20 2020 2020 2020 2066 7365  (f):.        fse
+00010d10: 6172 6368 2866 2c20 2243 4f55 4e54 2020  arch(f, "COUNT  
+00010d20: 2020 2020 2020 2e20 2020 3120 202e 2e20        .   1  .. 
+00010d30: 2020 3220 202e 2e20 2020 3322 290a 2020    2  ..   3").  
+00010d40: 2020 2020 2020 7320 3d20 5b5d 0a20 2020        s = [].   
+00010d50: 2020 2020 2070 726f 6720 3d20 7265 2e63       prog = re.c
+00010d60: 6f6d 7069 6c65 2872 225b 205d 7b31 337d  ompile(r"[ ]{13}
+00010d70: 5b20 302d 395d 7b38 7d2d 5b20 5d7b 387d  [ 0-9]{8}-[ ]{8}
+00010d80: 282e 7b37 327d 2922 290a 2020 2020 2020  (.{72})").      
+00010d90: 2020 666f 7220 6c69 6e65 2069 6e20 663a    for line in f:
+00010da0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00010db0: 6c69 6e65 2e73 7461 7274 7377 6974 6828  line.startswith(
+00010dc0: 2220 2020 2020 2020 2020 2020 2020 2020  "               
+00010dd0: 2020 2020 2020 2020 2020 2020 2020 2045                 E
+00010de0: 4e44 4441 5441 2229 3a0a 2020 2020 2020  NDDATA"):.      
+00010df0: 2020 2020 2020 2020 2020 6272 6561 6b0a            break.
+00010e00: 2020 2020 2020 2020 2020 2020 6d20 3d20              m = 
+00010e10: 7072 6f67 2e6d 6174 6368 286c 696e 6529  prog.match(line)
+00010e20: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00010e30: 6d3a 0a20 2020 2020 2020 2020 2020 2020  m:.             
+00010e40: 2020 206d 6174 6368 203d 206d 2e67 726f     match = m.gro
+00010e50: 7570 2831 292e 7374 7269 7028 290a 2020  up(1).strip().  
+00010e60: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00010e70: 206d 6174 6368 5b30 5d20 3d3d 2022 2b22   match[0] == "+"
+00010e80: 206f 7220 6d61 7463 685b 305d 203d 3d20   or match[0] == 
+00010e90: 222a 223a 0a20 2020 2020 2020 2020 2020  "*":.           
+00010ea0: 2020 2020 2020 2020 2069 6620 6c65 6e28           if len(
+00010eb0: 6d61 7463 6829 203e 2038 3a0a 2020 2020  match) > 8:.    
+00010ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010ed0: 2020 2020 6d61 7463 6820 3d20 6d61 7463      match = matc
+00010ee0: 685b 305d 202b 2022 2020 2020 2020 2022  h[0] + "       "
+00010ef0: 202b 206d 6174 6368 5b38 3a5d 0a20 2020   + match[8:].   
 00010f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010f10: 206d 6174 6368 203d 206d 6174 6368 5b30   match = match[0
-00010f20: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-00010f30: 2020 732e 6170 7065 6e64 286d 6174 6368    s.append(match
-00010f40: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-00010f50: 2022 5c6e 222e 6a6f 696e 2873 2920 2b20   "\n".join(s) + 
-00010f60: 225c 6e22 0a0a 2020 2020 4067 7569 746f  "\n"..    @guito
-00010f70: 6f6c 732e 7772 6974 655f 7465 7874 5f66  ols.write_text_f
-00010f80: 696c 650a 2020 2020 6465 6620 5f77 7462  ile.    def _wtb
-00010f90: 756c 6b28 662c 2062 6c6b 293a 0a20 2020  ulk(f, blk):.   
-00010fa0: 2020 2020 2066 2e77 7269 7465 2862 6c6b       f.write(blk
-00010fb0: 290a 0a20 2020 205f 7774 6275 6c6b 2866  )..    _wtbulk(f
-00010fc0: 6f75 742c 205f 7264 6275 6c6b 2866 696e  out, _rdbulk(fin
-00010fd0: 2929 0a0a 0a40 6775 6974 6f6f 6c73 2e72  ))...@guitools.r
-00010fe0: 6561 645f 7465 7874 5f66 696c 650a 6465  ead_text_file.de
-00010ff0: 6620 7264 6569 6765 6e28 662c 2075 7365  f rdeigen(f, use
-00011000: 5f70 616e 6461 733d 5472 7565 293a 0a20  _pandas=True):. 
-00011010: 2020 2022 2222 0a20 2020 2052 6561 6420     """.    Read 
-00011020: 6569 6765 6e76 616c 7565 2074 6162 6c65  eigenvalue table
-00011030: 7320 6672 6f6d 2061 204e 6173 7472 616e  s from a Nastran
-00011040: 2066 3036 2066 696c 652e 0a0a 2020 2020   f06 file...    
-00011050: 5061 7261 6d65 7465 7273 0a20 2020 202d  Parameters.    -
-00011060: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 6620  ---------.    f 
-00011070: 3a20 7374 7269 6e67 206f 7220 6669 6c65  : string or file
-00011080: 5f6c 696b 6520 6f72 204e 6f6e 650a 2020  _like or None.  
-00011090: 2020 2020 2020 4569 7468 6572 2061 206e        Either a n
-000110a0: 616d 6520 6f66 2061 2066 696c 652c 206f  ame of a file, o
-000110b0: 7220 6973 2061 2066 696c 655f 6c69 6b65  r is a file_like
-000110c0: 206f 626a 6563 7420 6173 2072 6574 7572   object as retur
-000110d0: 6e65 640a 2020 2020 2020 2020 6279 203a  ned.        by :
-000110e0: 6675 6e63 3a60 6f70 656e 602e 2049 6620  func:`open`. If 
-000110f0: 6669 6c65 5f6c 696b 6520 6f62 6a65 6374  file_like object
-00011100: 2c20 6974 2069 7320 7265 776f 756e 6420  , it is rewound 
-00011110: 6669 7273 742e 2043 616e 0a20 2020 2020  first. Can.     
-00011120: 2020 2061 6c73 6f20 6265 2074 6865 206e     also be the n
-00011130: 616d 6520 6f66 2061 2064 6972 6563 746f  ame of a directo
-00011140: 7279 206f 7220 4e6f 6e65 3b20 696e 2074  ry or None; in t
-00011150: 6865 7365 2063 6173 6573 2c20 6120 4755  hese cases, a GU
-00011160: 490a 2020 2020 2020 2020 6973 206f 7065  I.        is ope
-00011170: 6e65 6420 666f 7220 6669 6c65 2073 656c  ned for file sel
-00011180: 6563 7469 6f6e 2e0a 2020 2020 7573 655f  ection..    use_
-00011190: 7061 6e64 6173 203a 2062 6f6f 6c3b 206f  pandas : bool; o
-000111a0: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
-000111b0: 4966 2054 7275 652c 2074 6865 2076 616c  If True, the val
-000111c0: 7565 7320 7265 7475 726e 6564 2069 6e20  ues returned in 
-000111d0: 7468 6520 6469 6374 696f 6e61 7279 2077  the dictionary w
-000111e0: 696c 6c20 6265 2070 616e 6461 730a 2020  ill be pandas.  
-000111f0: 2020 2020 2020 4461 7461 4672 616d 6573        DataFrames
-00011200: 0a0a 2020 2020 5265 7475 726e 730a 2020  ..    Returns.  
-00011210: 2020 2d2d 2d2d 2d2d 2d0a 2020 2020 6469    -------.    di
-00011220: 6374 696f 6e61 7279 0a20 2020 2020 2020  ctionary.       
-00011230: 2054 6865 206b 6579 7320 6172 6520 7468   The keys are th
-00011240: 6520 7375 7065 7265 6c65 6d65 6e74 2049  e superelement I
-00011250: 4473 2061 6e64 2074 6865 2076 616c 7565  Ds and the value
-00011260: 7320 6973 2074 6865 2037 0a20 2020 2020  s is the 7.     
-00011270: 2020 2063 6f6c 756d 6e20 6569 6765 6e76     column eigenv
-00011280: 616c 7565 2074 6162 6c65 3a20 5b6d 6f64  alue table: [mod
-00011290: 6520 6e75 6d62 6572 2c20 6578 7472 6163  e number, extrac
-000112a0: 7469 6f6e 206f 7264 6572 2c0a 2020 2020  tion order,.    
-000112b0: 2020 2020 6569 6765 6e76 616c 7565 2c20      eigenvalue, 
-000112c0: 7261 6469 616e 732c 2063 7963 6c65 732c  radians, cycles,
-000112d0: 2067 656e 6572 616c 697a 6564 206d 6173   generalized mas
-000112e0: 732c 2067 656e 6572 616c 697a 6564 0a20  s, generalized. 
-000112f0: 2020 2020 2020 2073 7469 6666 6e65 7373         stiffness
-00011300: 5d0a 0a20 2020 204e 6f74 6573 0a20 2020  ]..    Notes.   
-00011310: 202d 2d2d 2d2d 0a20 2020 2054 6865 206c   -----.    The l
-00011320: 6173 7420 7461 626c 6520 7265 6164 2066  ast table read f
-00011330: 6f72 2061 2073 7570 6572 656c 656d 656e  or a superelemen
-00011340: 7420 7265 706c 6163 6573 2074 6162 6c65  t replaces table
-00011350: 7320 7072 6576 696f 7573 6c79 0a20 2020  s previously.   
-00011360: 2072 6561 6420 696e 2e0a 0a20 2020 2049   read in...    I
-00011370: 6620 7468 6520 7061 6e64 6173 206f 7574  f the pandas out
-00011380: 7075 7420 6973 2063 686f 7365 6e20 2874  put is chosen (t
-00011390: 6865 2064 6566 6175 6c74 2920 7468 6520  he default) the 
-000113a0: 6d6f 6465 206e 756d 6265 7220 6973 0a20  mode number is. 
-000113b0: 2020 2075 7365 6420 6173 2074 6865 2060     used as the `
-000113c0: 696e 6465 7860 2061 6e64 2060 636f 6c75  index` and `colu
-000113d0: 6d6e 7360 2069 733a 3a0a 0a20 2020 2020  mns` is::..     
-000113e0: 2020 2063 203d 205b 274d 6f64 6520 2327     c = ['Mode #'
-000113f0: 2c20 2765 7874 2023 272c 2027 6569 6765  , 'ext #', 'eige
-00011400: 6e76 616c 7565 272c 2027 7261 6469 616e  nvalue', 'radian
-00011410: 7327 2c0a 2020 2020 2020 2020 2020 2020  s',.            
-00011420: 2027 6379 636c 6573 272c 2027 6765 6e6d   'cycles', 'genm
-00011430: 6173 7327 2c20 2767 656e 7374 6966 275d  ass', 'genstif']
-00011440: 0a20 2020 2022 2222 0a0a 2020 2020 6465  .    """..    de
-00011450: 6620 5f66 696e 645f 6569 6765 6e28 6629  f _find_eigen(f)
-00011460: 3a0a 2020 2020 2020 2020 5345 203d 2022  :.        SE = "
-00011470: 5355 5045 5245 4c45 4d45 4e54 2022 0a20  SUPERELEMENT ". 
-00011480: 2020 2020 2020 2045 4947 203d 2022 5220         EIG = "R 
-00011490: 4520 4120 4c20 2020 4520 4920 4720 4520  E A L   E I G E 
-000114a0: 4e20 5620 4120 4c20 5520 4520 5322 0a20  N V A L U E S". 
-000114b0: 2020 2020 2020 2073 6520 3d20 300a 2020         se = 0.  
-000114c0: 2020 2020 2020 666f 7220 6c69 6e65 2069        for line i
-000114d0: 6e20 663a 0a20 2020 2020 2020 2020 2020  n f:.           
-000114e0: 2069 6620 6c65 6e28 6c69 6e65 2920 3e20   if len(line) > 
-000114f0: 3131 3620 616e 6420 6c69 6e65 5b31 3034  116 and line[104
-00011500: 3a5d 2e73 7461 7274 7377 6974 6828 5345  :].startswith(SE
-00011510: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-00011520: 2020 2073 6520 3d20 696e 7428 6c69 6e65     se = int(line
-00011530: 5b31 3136 3a5d 290a 2020 2020 2020 2020  [116:]).        
-00011540: 2020 2020 6966 206c 656e 286c 696e 6529      if len(line)
-00011550: 203e 2037 3620 616e 6420 6c69 6e65 5b34   > 76 and line[4
-00011560: 363a 5d2e 7374 6172 7473 7769 7468 2845  6:].startswith(E
-00011570: 4947 293a 0a20 2020 2020 2020 2020 2020  IG):.           
-00011580: 2020 2020 2072 6574 7572 6e20 7365 0a20       return se. 
-00011590: 2020 2020 2020 2072 6574 7572 6e20 4e6f         return No
-000115a0: 6e65 0a0a 2020 2020 6465 6620 5f72 645f  ne..    def _rd_
-000115b0: 6569 6765 6e5f 7461 626c 6528 6629 3a0a  eigen_table(f):.
-000115c0: 2020 2020 2020 2020 2222 2245 6967 656e          """Eigen
-000115d0: 7661 6c75 6520 7461 626c 6520 666f 756e  value table foun
-000115e0: 642c 2072 6561 6420 6974 2e22 2222 0a20  d, read it.""". 
-000115f0: 2020 2020 2020 2066 6f72 206c 696e 6520         for line 
-00011600: 696e 2066 3a0a 2020 2020 2020 2020 2020  in f:.          
-00011610: 2020 6966 206c 696e 652e 7374 6172 7473    if line.starts
-00011620: 7769 7468 2822 2020 2020 4e4f 2e22 293a  with("    NO."):
-00011630: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00011640: 2062 7265 616b 0a20 2020 2020 2020 2074   break.        t
-00011650: 6162 6c65 203d 205b 5d0a 2020 2020 2020  able = [].      
-00011660: 2020 636f 6e74 696e 7565 6420 3d20 5472    continued = Tr
-00011670: 7565 0a20 2020 2020 2020 2077 6869 6c65  ue.        while
-00011680: 2063 6f6e 7469 6e75 6564 3a0a 2020 2020   continued:.    
-00011690: 2020 2020 2020 2020 666f 7220 6c69 6e65          for line
-000116a0: 2069 6e20 663a 0a20 2020 2020 2020 2020   in f:.         
-000116b0: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
-000116c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000116d0: 726f 7720 3d20 5b66 6c6f 6174 2869 2920  row = [float(i) 
-000116e0: 666f 7220 6920 696e 206c 696e 652e 7370  for i in line.sp
-000116f0: 6c69 7428 295d 0a20 2020 2020 2020 2020  lit()].         
-00011700: 2020 2020 2020 2065 7863 6570 7420 5661         except Va
-00011710: 6c75 6545 7272 6f72 3a0a 2020 2020 2020  lueError:.      
-00011720: 2020 2020 2020 2020 2020 2020 2020 6272                br
-00011730: 6561 6b0a 2020 2020 2020 2020 2020 2020  eak.            
-00011740: 2020 2020 6966 206c 656e 2872 6f77 2920      if len(row) 
-00011750: 3d3d 2037 3a0a 2020 2020 2020 2020 2020  == 7:.          
-00011760: 2020 2020 2020 2020 2020 7461 626c 652e            table.
-00011770: 6170 7065 6e64 2872 6f77 290a 2020 2020  append(row).    
-00011780: 2020 2020 2020 2020 666f 7220 5f20 696e          for _ in
-00011790: 2072 616e 6765 2838 293a 0a20 2020 2020   range(8):.     
-000117a0: 2020 2020 2020 2020 2020 206c 696e 6520             line 
-000117b0: 3d20 662e 7265 6164 6c69 6e65 2829 0a20  = f.readline(). 
-000117c0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-000117d0: 6620 6c69 6e65 2e73 7461 7274 7377 6974  f line.startswit
-000117e0: 6828 2231 2022 293a 0a20 2020 2020 2020  h("1 "):.       
-000117f0: 2020 2020 2020 2020 2020 2020 2063 6f6e               con
-00011800: 7469 6e75 6564 203d 2046 616c 7365 0a20  tinued = False. 
-00011810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011820: 2020 2062 7265 616b 0a20 2020 2020 2020     break.       
-00011830: 2020 2020 2020 2020 2069 6620 6c69 6e65           if line
-00011840: 2e73 7461 7274 7377 6974 6828 2220 2020  .startswith("   
-00011850: 204e 4f2e 2229 3a0a 2020 2020 2020 2020   NO."):.        
-00011860: 2020 2020 2020 2020 2020 2020 6272 6561              brea
-00011870: 6b0a 2020 2020 2020 2020 2020 2020 656c  k.            el
-00011880: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00011890: 2020 2020 6272 6561 6b0a 2020 2020 2020      break.      
-000118a0: 2020 7265 7475 726e 206e 702e 6172 7261    return np.arra
-000118b0: 7928 7461 626c 6529 0a0a 2020 2020 6463  y(table)..    dc
-000118c0: 7420 3d20 7b7d 0a20 2020 2066 2e73 6565  t = {}.    f.see
-000118d0: 6b28 302c 2030 290a 2020 2020 7768 696c  k(0, 0).    whil
-000118e0: 6520 5472 7565 3a0a 2020 2020 2020 2020  e True:.        
-000118f0: 7365 203d 205f 6669 6e64 5f65 6967 656e  se = _find_eigen
-00011900: 2866 290a 2020 2020 2020 2020 6966 2073  (f).        if s
-00011910: 6520 6973 204e 6f6e 653a 0a20 2020 2020  e is None:.     
-00011920: 2020 2020 2020 2072 6574 7572 6e20 6463         return dc
-00011930: 740a 2020 2020 2020 2020 7461 626c 6520  t.        table 
-00011940: 3d20 5f72 645f 6569 6765 6e5f 7461 626c  = _rd_eigen_tabl
-00011950: 6528 6629 0a20 2020 2020 2020 2069 6620  e(f).        if 
-00011960: 7573 655f 7061 6e64 6173 3a0a 2020 2020  use_pandas:.    
-00011970: 2020 2020 2020 2020 6920 3d20 7461 626c          i = tabl
-00011980: 655b 3a2c 2030 5d2e 6173 7479 7065 2869  e[:, 0].astype(i
-00011990: 6e74 290a 2020 2020 2020 2020 2020 2020  nt).            
-000119a0: 6320 3d20 5b0a 2020 2020 2020 2020 2020  c = [.          
-000119b0: 2020 2020 2020 226d 6f64 6520 2322 2c0a        "mode #",.
-000119c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000119d0: 2265 7874 2023 222c 0a20 2020 2020 2020  "ext #",.       
-000119e0: 2020 2020 2020 2020 2022 6569 6765 6e76           "eigenv
-000119f0: 616c 7565 222c 0a20 2020 2020 2020 2020  alue",.         
-00011a00: 2020 2020 2020 2022 7261 6469 616e 7322         "radians"
-00011a10: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00011a20: 2020 2263 7963 6c65 7322 2c0a 2020 2020    "cycles",.    
-00011a30: 2020 2020 2020 2020 2020 2020 2267 656e              "gen
-00011a40: 6d61 7373 222c 0a20 2020 2020 2020 2020  mass",.         
-00011a50: 2020 2020 2020 2022 6765 6e73 7469 6622         "genstif"
-00011a60: 2c0a 2020 2020 2020 2020 2020 2020 5d0a  ,.            ].
-00011a70: 2020 2020 2020 2020 2020 2020 7461 626c              tabl
-00011a80: 6520 3d20 7064 2e44 6174 6146 7261 6d65  e = pd.DataFrame
-00011a90: 2874 6162 6c65 2c20 696e 6465 783d 692c  (table, index=i,
-00011aa0: 2063 6f6c 756d 6e73 3d63 290a 2020 2020   columns=c).    
-00011ab0: 2020 2020 6463 745b 7365 5d20 3d20 7461      dct[se] = ta
-00011ac0: 626c 650a 0a0a 4067 7569 746f 6f6c 732e  ble...@guitools.
-00011ad0: 7772 6974 655f 7465 7874 5f66 696c 650a  write_text_file.
-00011ae0: 6465 6620 7774 6e61 7369 6e74 7328 662c  def wtnasints(f,
-00011af0: 2073 7461 7274 2c20 696e 7473 293a 0a20   start, ints):. 
-00011b00: 2020 2022 2222 0a20 2020 2055 7469 6c69     """.    Utili
-00011b10: 7479 2072 6f75 7469 6e65 2066 6f72 2074  ty routine for t
-00011b20: 6865 206e 6173 7472 616e 2027 7774 2a27  he nastran 'wt*'
-00011b30: 2072 6f75 7469 6e65 732e 0a0a 2020 2020   routines...    
-00011b40: 5061 7261 6d65 7465 7273 0a20 2020 202d  Parameters.    -
-00011b50: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 6620  ---------.    f 
-00011b60: 3a20 7374 7269 6e67 206f 7220 6669 6c65  : string or file
-00011b70: 5f6c 696b 6520 6f72 2031 206f 7220 4e6f  _like or 1 or No
-00011b80: 6e65 0a20 2020 2020 2020 2045 6974 6865  ne.        Eithe
-00011b90: 7220 6120 6e61 6d65 206f 6620 6120 6669  r a name of a fi
-00011ba0: 6c65 2c20 6f72 2069 7320 6120 6669 6c65  le, or is a file
-00011bb0: 5f6c 696b 6520 6f62 6a65 6374 2061 7320  _like object as 
-00011bc0: 7265 7475 726e 6564 0a20 2020 2020 2020  returned.       
-00011bd0: 2062 7920 3a66 756e 633a 606f 7065 6e60   by :func:`open`
-00011be0: 206f 7220 3a63 6c61 7373 3a60 696f 2e53   or :class:`io.S
-00011bf0: 7472 696e 6749 4f60 2e20 496e 7075 7420  tringIO`. Input 
-00011c00: 6173 2069 6e74 6567 6572 2031 2074 6f0a  as integer 1 to.
-00011c10: 2020 2020 2020 2020 7772 6974 6520 746f          write to
-00011c20: 2073 7464 6f75 742e 2043 616e 2061 6c73   stdout. Can als
-00011c30: 6f20 6265 2074 6865 206e 616d 6520 6f66  o be the name of
-00011c40: 2061 2064 6972 6563 746f 7279 206f 7220   a directory or 
-00011c50: 4e6f 6e65 3b0a 2020 2020 2020 2020 696e  None;.        in
-00011c60: 2074 6865 7365 2063 6173 6573 2c20 6120   these cases, a 
-00011c70: 4755 4920 6973 206f 7065 6e65 6420 666f  GUI is opened fo
-00011c80: 7220 6669 6c65 2073 656c 6563 7469 6f6e  r file selection
-00011c90: 2e0a 2020 2020 7374 6172 7420 3a20 696e  ..    start : in
-00011ca0: 7465 6765 720a 2020 2020 2020 2020 4265  teger.        Be
-00011cb0: 6769 6e6e 696e 6720 6669 656c 6420 666f  ginning field fo
-00011cc0: 7220 7468 6520 696e 7465 6765 7273 3b20  r the integers; 
-00011cd0: 6361 7264 206e 616d 6520 6973 2069 6e20  card name is in 
-00011ce0: 6669 656c 6420 312c 2073 6f0a 2020 2020  field 1, so.    
-00011cf0: 2020 2020 7374 6172 7420 7368 6f75 6c64      start should
-00011d00: 2062 6520 3e3d 2032 2e0a 2020 2020 696e   be >= 2..    in
-00011d10: 7473 203a 2031 6420 6172 7261 795f 6c69  ts : 1d array_li
-00011d20: 6b65 0a20 2020 2020 2020 2056 6563 746f  ke.        Vecto
-00011d30: 7220 6f66 2069 6e74 6567 6572 7320 746f  r of integers to
-00011d40: 2077 7269 7465 0a0a 2020 2020 5265 7475   write..    Retu
-00011d50: 726e 730a 2020 2020 2d2d 2d2d 2d2d 2d0a  rns.    -------.
-00011d60: 2020 2020 4e6f 6e65 0a0a 2020 2020 4e6f      None..    No
-00011d70: 7465 730a 2020 2020 2d2d 2d2d 2d0a 0a20  tes.    -----.. 
-00011d80: 2020 2054 6869 7320 726f 7574 696e 6520     This routine 
-00011d90: 6973 2074 7970 6963 616c 6c79 206e 6f74  is typically not
-00011da0: 2063 616c 6c65 6420 6469 7265 6374 6c79   called directly
-00011db0: 2c20 6275 7420 636f 756c 6420 6265 2075  , but could be u
-00011dc0: 7365 6675 6c0a 2020 2020 746f 2077 7269  seful.    to wri
-00011dd0: 7465 2063 6172 6473 2074 6861 7420 6172  te cards that ar
-00011de0: 6520 6e6f 7420 616c 7265 6164 7920 6163  e not already ac
-00011df0: 636f 756e 7465 6420 666f 7220 696e 2074  counted for in t
-00011e00: 6869 730a 2020 2020 6d6f 6475 6c65 2e20  his.    module. 
-00011e10: 4173 2061 6e20 6578 616d 706c 6520 7573  As an example us
-00011e20: 6167 652c 2068 6572 6520 6973 2074 6865  age, here is the
-00011e30: 2063 6f64 6520 696e 7369 6465 0a20 2020   code inside.   
-00011e40: 203a 6675 6e63 3a60 7774 6373 7570 6572   :func:`wtcsuper
-00011e50: 603a 3a0a 0a20 2020 2020 2020 2066 2e77  `::..        f.w
-00011e60: 7269 7465 2866 2243 5355 5045 5220 207b  rite(f"CSUPER  {
-00011e70: 7375 7065 7269 643a 3864 7d7b 303a 3864  superid:8d}{0:8d
-00011e80: 7d22 290a 2020 2020 2020 2020 7774 6e61  }").        wtna
-00011e90: 7369 6e74 7328 662c 2034 2c20 6772 6964  sints(f, 4, grid
-00011ea0: 7329 0a0a 2020 2020 4578 616d 706c 6573  s)..    Examples
-00011eb0: 0a20 2020 202d 2d2d 2d2d 2d2d 2d0a 2020  .    --------.  
-00011ec0: 2020 3e3e 3e20 696d 706f 7274 206e 756d    >>> import num
-00011ed0: 7079 2061 7320 6e70 0a20 2020 203e 3e3e  py as np.    >>>
-00011ee0: 2066 726f 6d20 7079 7965 7469 2069 6d70   from pyyeti imp
-00011ef0: 6f72 7420 6e61 7374 7261 6e0a 2020 2020  ort nastran.    
-00011f00: 3e3e 3e20 6e61 7374 7261 6e2e 7774 6e61  >>> nastran.wtna
-00011f10: 7369 6e74 7328 312c 2032 2c20 6e70 2e61  sints(1, 2, np.a
-00011f20: 7261 6e67 6528 3238 2929 0a20 2020 2020  range(28)).     
-00011f30: 2020 2020 2020 3020 2020 2020 2020 3120        0       1 
-00011f40: 2020 2020 2020 3220 2020 2020 2020 3320        2       3 
-00011f50: 2020 2020 2020 3420 2020 2020 2020 3520        4       5 
-00011f60: 2020 2020 2020 3620 2020 2020 2020 370a        6       7.
-00011f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011f80: 2020 2038 2020 2020 2020 2039 2020 2020     8       9    
-00011f90: 2020 3130 2020 2020 2020 3131 2020 2020    10      11    
-00011fa0: 2020 3132 2020 2020 2020 3133 2020 2020    12      13    
-00011fb0: 2020 3134 2020 2020 2020 3135 0a20 2020    14      15.   
-00011fc0: 2020 2020 2020 2020 2020 2020 2020 2031                 1
-00011fd0: 3620 2020 2020 2031 3720 2020 2020 2031  6      17      1
-00011fe0: 3820 2020 2020 2031 3920 2020 2020 2032  8      19      2
-00011ff0: 3020 2020 2020 2032 3120 2020 2020 2032  0      21      2
-00012000: 3220 2020 2020 2032 330a 2020 2020 2020  2      23.      
-00012010: 2020 2020 2020 2020 2020 2020 3234 2020              24  
-00012020: 2020 2020 3235 2020 2020 2020 3236 2020      25      26  
-00012030: 2020 2020 3237 0a20 2020 2022 2222 0a20      27.    """. 
-00012040: 2020 206e 203d 206c 656e 2869 6e74 7329     n = len(ints)
-00012050: 0a20 2020 2066 6972 7374 6c69 6e65 203d  .    firstline =
-00012060: 2031 3020 2d20 7374 6172 740a 2020 2020   10 - start.    
-00012070: 6966 206e 203e 3d20 6669 7273 746c 696e  if n >= firstlin
-00012080: 653a 0a20 2020 2020 2020 2069 203d 2066  e:.        i = f
-00012090: 6972 7374 6c69 6e65 0a20 2020 2020 2020  irstline.       
-000120a0: 2066 2e77 7269 7465 2828 227b 3a38 647d   f.write(("{:8d}
-000120b0: 2220 2a20 6920 2b20 225c 6e22 292e 666f  " * i + "\n").fo
-000120c0: 726d 6174 282a 696e 7473 5b3a 695d 2929  rmat(*ints[:i]))
-000120d0: 0a20 2020 2020 2020 2077 6869 6c65 206e  .        while n
-000120e0: 203e 3d20 6920 2b20 383a 0a20 2020 2020   >= i + 8:.     
-000120f0: 2020 2020 2020 2066 2e77 7269 7465 2828         f.write((
-00012100: 227b 3a38 737d 2220 2b20 227b 3a38 647d  "{:8s}" + "{:8d}
-00012110: 2220 2a20 3820 2b20 225c 6e22 292e 666f  " * 8 + "\n").fo
-00012120: 726d 6174 2822 222c 202a 696e 7473 5b69  rmat("", *ints[i
-00012130: 203a 2069 202b 2038 5d29 290a 2020 2020   : i + 8])).    
-00012140: 2020 2020 2020 2020 6920 2b3d 2038 0a20          i += 8. 
-00012150: 2020 2020 2020 2069 6620 6e20 3e20 693a         if n > i:
-00012160: 0a20 2020 2020 2020 2020 2020 206e 202d  .            n -
-00012170: 3d20 690a 2020 2020 2020 2020 2020 2020  = i.            
-00012180: 662e 7772 6974 6528 2822 7b3a 3873 7d22  f.write(("{:8s}"
-00012190: 202b 2022 7b3a 3864 7d22 202a 206e 202b   + "{:8d}" * n +
-000121a0: 2022 5c6e 2229 2e66 6f72 6d61 7428 2222   "\n").format(""
-000121b0: 2c20 2a69 6e74 735b 693a 5d29 290a 2020  , *ints[i:])).  
-000121c0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-000121d0: 662e 7772 6974 6528 2822 7b3a 3864 7d22  f.write(("{:8d}"
-000121e0: 202a 206e 202b 2022 5c6e 2229 2e66 6f72   * n + "\n").for
-000121f0: 6d61 7428 2a69 6e74 7329 290a 0a0a 6465  mat(*ints))...de
-00012200: 6620 7264 6373 7570 6572 7328 6629 3a0a  f rdcsupers(f):.
-00012210: 2020 2020 7222 2222 0a20 2020 2052 6561      r""".    Rea
-00012220: 6420 4353 5550 4552 2065 6e74 7269 6573  d CSUPER entries
-00012230: 0a0a 2020 2020 5061 7261 6d65 7465 7273  ..    Parameters
-00012240: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a  .    ----------.
-00012250: 2020 2020 6620 3a20 7374 7269 6e67 206f      f : string o
-00012260: 7220 6669 6c65 5f6c 696b 6520 6f72 204e  r file_like or N
-00012270: 6f6e 650a 2020 2020 2020 2020 4569 7468  one.        Eith
-00012280: 6572 2061 2066 696c 656e 616d 652c 206f  er a filename, o
-00012290: 7220 6973 2061 2066 696c 655f 6c69 6b65  r is a file_like
-000122a0: 206f 626a 6563 7420 6173 2072 6574 7572   object as retur
-000122b0: 6e65 640a 2020 2020 2020 2020 6279 203a  ned.        by :
-000122c0: 6675 6e63 3a60 6f70 656e 602e 2049 6620  func:`open`. If 
-000122d0: 6669 6c65 5f6c 696b 6520 6f62 6a65 6374  file_like object
-000122e0: 2c20 6974 2069 7320 7265 776f 756e 6420  , it is rewound 
-000122f0: 6669 7273 742e 2043 616e 0a20 2020 2020  first. Can.     
-00012300: 2020 2061 6c73 6f20 6265 2074 6865 206e     also be the n
-00012310: 616d 6520 6f66 2061 2064 6972 6563 746f  ame of a directo
-00012320: 7279 206f 7220 4e6f 6e65 3b20 696e 2074  ry or None; in t
-00012330: 6865 7365 2063 6173 6573 2c20 6120 4755  hese cases, a GU
-00012340: 490a 2020 2020 2020 2020 6973 206f 7065  I.        is ope
-00012350: 6e65 6420 666f 7220 6669 6c65 2073 656c  ned for file sel
-00012360: 6563 7469 6f6e 2e0a 0a20 2020 2052 6574  ection...    Ret
-00012370: 7572 6e73 0a20 2020 202d 2d2d 2d2d 2d2d  urns.    -------
-00012380: 0a20 2020 2064 6963 7469 6f6e 6172 790a  .    dictionary.
-00012390: 2020 2020 2020 2020 5468 6520 6469 6374          The dict
-000123a0: 696f 6e61 7279 206b 6579 7320 6172 6520  ionary keys are 
-000123b0: 7468 6520 4353 5550 4552 2049 4473 2e20  the CSUPER IDs. 
-000123c0: 5468 6520 6469 6374 696f 6e61 7279 2076  The dictionary v
-000123d0: 616c 7565 730a 2020 2020 2020 2020 6172  alues.        ar
-000123e0: 6520 616c 6c20 7468 6520 6964 7320 6672  e all the ids fr
-000123f0: 6f6d 2074 6865 2043 5355 5045 5220 6361  om the CSUPER ca
-00012400: 7264 2069 6e20 7468 6520 666f 726d 3a20  rd in the form: 
-00012410: 5b63 7375 7065 725f 6964 2c20 302c 0a20  [csuper_id, 0,. 
-00012420: 2020 2020 2020 206e 6f64 655f 6964 5f31         node_id_1
-00012430: 2c20 6e6f 6465 5f69 645f 322c 20e2 80a6  , node_id_2, ...
-00012440: 206e 6f64 655f 6964 5f6e 5d0a 0a20 2020   node_id_n]..   
-00012450: 204e 6f74 6573 0a20 2020 202d 2d2d 2d2d   Notes.    -----
-00012460: 0a20 2020 2041 6e79 2022 5448 5255 2220  .    Any "THRU" 
-00012470: 6669 656c 6473 2077 696c 6c20 6265 2073  fields will be s
-00012480: 6574 2074 6f20 2d31 2e20 5468 6973 2072  et to -1. This r
-00012490: 6f75 7469 6e65 2073 696d 706c 7920 6361  outine simply ca
-000124a0: 6c6c 7320 7468 650a 2020 2020 6d6f 7265  lls the.    more
-000124b0: 2067 656e 6572 616c 2072 6f75 7469 6e65   general routine
-000124c0: 203a 6675 6e63 3a60 7264 6361 7264 7360   :func:`rdcards`
-000124d0: 3a3a 0a0a 2020 2020 2020 2020 7264 6361  ::..        rdca
-000124e0: 7264 7328 662c 2027 6373 7570 6572 272c  rds(f, 'csuper',
-000124f0: 2072 6574 7572 6e5f 7661 723d 2764 6963   return_var='dic
-00012500: 7427 2c20 6474 7970 653d 6e70 2e69 6e74  t', dtype=np.int
-00012510: 3634 2c20 626c 616e 6b3d 2d31 290a 0a20  64, blank=-1).. 
-00012520: 2020 2045 7861 6d70 6c65 730a 2020 2020     Examples.    
-00012530: 2d2d 2d2d 2d2d 2d2d 0a20 2020 203e 3e3e  --------.    >>>
-00012540: 2069 6d70 6f72 7420 6e75 6d70 7920 6173   import numpy as
-00012550: 206e 700a 2020 2020 3e3e 3e20 6672 6f6d   np.    >>> from
-00012560: 2070 7979 6574 6920 696d 706f 7274 206e   pyyeti import n
-00012570: 6173 7472 616e 0a20 2020 203e 3e3e 2066  astran.    >>> f
-00012580: 726f 6d20 696f 2069 6d70 6f72 7420 5374  rom io import St
-00012590: 7269 6e67 494f 0a20 2020 203e 3e3e 206e  ringIO.    >>> n
-000125a0: 702e 7365 745f 7072 696e 746f 7074 696f  p.set_printoptio
-000125b0: 6e73 286c 696e 6577 6964 7468 3d36 3029  ns(linewidth=60)
-000125c0: 0a20 2020 203e 3e3e 2066 203d 2053 7472  .    >>> f = Str
-000125d0: 696e 6749 4f28 2243 5355 5045 522c 3130  ingIO("CSUPER,10
-000125e0: 312c 302c 332c 3131 2c31 392c 3237 2c31  1,0,3,11,19,27,1
-000125f0: 3939 3530 3031 2c31 3939 3530 3032 5c6e  995001,1995002\n
-00012600: 220a 2020 2020 2e2e 2e20 2020 2020 2020  ".    ...       
-00012610: 2020 2020 2020 2022 2c31 3939 3530 3033         ",1995003
-00012620: 2c74 6872 752c 3139 3935 3031 3020 2024  ,thru,1995010  $
-00012630: 2063 6f6d 6d65 6e74 2229 0a20 2020 203e   comment").    >
-00012640: 3e3e 206e 6173 7472 616e 2e72 6463 7375  >> nastran.rdcsu
-00012650: 7065 7273 2866 2920 2020 2020 2020 2020  pers(f)         
-00012660: 2020 2020 2320 646f 6374 6573 743a 202b      # doctest: +
-00012670: 454c 4c49 5053 4953 0a20 2020 207b 3130  ELLIPSIS.    {10
-00012680: 313a 2061 7272 6179 285b 2020 2020 3130  1: array([    10
-00012690: 312c 2020 2020 2020 2030 2c20 2020 2020  1,       0,     
-000126a0: 2020 332c 2020 2020 2020 3131 2c20 2020    3,      11,   
-000126b0: 2020 2031 392c 2020 2020 2020 3237 2c0a     19,      27,.
-000126c0: 2020 2020 2020 2020 2020 2031 3939 3530             19950
-000126d0: 3031 2c20 3139 3935 3030 322c 2031 3939  01, 1995002, 199
-000126e0: 3530 3033 2c20 2020 2020 202d 312c 2031  5003,      -1, 1
-000126f0: 3939 3530 3130 5d2e 2e2e 297d 0a20 2020  995010]...)}.   
-00012700: 2022 2222 0a20 2020 2072 6574 7572 6e20   """.    return 
-00012710: 7264 6361 7264 7328 662c 2022 6373 7570  rdcards(f, "csup
-00012720: 6572 222c 2072 6574 7572 6e5f 7661 723d  er", return_var=
-00012730: 2264 6963 7422 2c20 6474 7970 653d 6e70  "dict", dtype=np
-00012740: 2e69 6e74 3634 2c20 626c 616e 6b3d 2d31  .int64, blank=-1
-00012750: 290a 0a0a 6465 6620 7264 6578 7472 6e28  )...def rdextrn(
-00012760: 662c 2065 7870 616e 643d 5472 7565 293a  f, expand=True):
-00012770: 0a20 2020 2072 2222 220a 2020 2020 5265  .    r""".    Re
-00012780: 6164 2045 5854 524e 2065 6e74 7279 2066  ad EXTRN entry f
-00012790: 726f 6d20 2e70 6368 2066 696c 6520 6372  rom .pch file cr
-000127a0: 6561 7465 6420 6279 204e 6173 7472 616e  eated by Nastran
-000127b0: 0a0a 2020 2020 5061 7261 6d65 7465 7273  ..    Parameters
-000127c0: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a  .    ----------.
-000127d0: 2020 2020 6620 3a20 7374 7269 6e67 206f      f : string o
-000127e0: 7220 6669 6c65 5f6c 696b 6520 6f72 204e  r file_like or N
-000127f0: 6f6e 650a 2020 2020 2020 2020 4569 7468  one.        Eith
-00012800: 6572 2061 206e 616d 6520 6f66 2061 2066  er a name of a f
-00012810: 696c 652c 206f 7220 6973 2061 2066 696c  ile, or is a fil
-00012820: 655f 6c69 6b65 206f 626a 6563 7420 6173  e_like object as
-00012830: 2072 6574 7572 6e65 640a 2020 2020 2020   returned.      
-00012840: 2020 6279 203a 6675 6e63 3a60 6f70 656e    by :func:`open
-00012850: 602e 2049 6620 6669 6c65 5f6c 696b 6520  `. If file_like 
-00012860: 6f62 6a65 6374 2c20 6974 2069 7320 7265  object, it is re
-00012870: 776f 756e 6420 6669 7273 742e 2043 616e  wound first. Can
-00012880: 0a20 2020 2020 2020 2061 6c73 6f20 6265  .        also be
-00012890: 2074 6865 206e 616d 6520 6f66 2061 2064   the name of a d
-000128a0: 6972 6563 746f 7279 206f 7220 4e6f 6e65  irectory or None
-000128b0: 3b20 696e 2074 6865 7365 2063 6173 6573  ; in these cases
-000128c0: 2c20 6120 4755 490a 2020 2020 2020 2020  , a GUI.        
-000128d0: 6973 206f 7065 6e65 6420 666f 7220 6669  is opened for fi
-000128e0: 6c65 2073 656c 6563 7469 6f6e 2e0a 2020  le selection..  
-000128f0: 2020 6578 7061 6e64 203a 2062 6f6f 6c3b    expand : bool;
-00012900: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
-00012910: 2020 4966 2054 7275 652c 2065 7870 616e    If True, expan
-00012920: 6420 726f 7773 206c 696b 6520 7468 6973  d rows like this
-00012930: 3a3a 0a0a 2020 2020 2020 2020 2020 2020  ::..            
-00012940: 5b31 3030 2c20 3132 3334 3536 5d0a 0a20  [100, 123456].. 
-00012950: 2020 2020 2020 2069 6e74 6f20 3620 7365         into 6 se
-00012960: 7061 7261 7465 2072 6f77 7320 6c69 6b65  parate rows like
-00012970: 2074 6869 733a 3a0a 0a20 2020 2020 2020   this::..       
-00012980: 2020 2020 205b 3130 302c 2031 5d2c 0a20       [100, 1],. 
-00012990: 2020 2020 2020 2020 2020 205b 3130 302c             [100,
-000129a0: 2032 5d2c 0a20 2020 2020 2020 2020 2020   2],.           
-000129b0: 205b 3130 302c 2033 5d2c 0a20 2020 2020   [100, 3],.     
-000129c0: 2020 2020 2020 205b 3130 302c 2034 5d2c         [100, 4],
-000129d0: 0a20 2020 2020 2020 2020 2020 205b 3130  .            [10
-000129e0: 302c 2035 5d2c 0a20 2020 2020 2020 2020  0, 5],.         
-000129f0: 2020 205b 3130 302c 2036 5d2c 0a0a 2020     [100, 6],..  
-00012a00: 2020 5265 7475 726e 730a 2020 2020 2d2d    Returns.    --
-00012a10: 2d2d 2d2d 2d0a 2020 2020 3264 206e 6461  -----.    2d nda
-00012a20: 7272 6179 0a20 2020 2020 2020 2054 776f  rray.        Two
-00012a30: 2063 6f6c 756d 6e20 6172 7261 793a 205b   column array: [
-00012a40: 4944 2c20 444f 465d 0a0a 2020 2020 4e6f  ID, DOF]..    No
-00012a50: 7465 730a 2020 2020 2d2d 2d2d 2d0a 2020  tes.    -----.  
-00012a60: 2020 5468 6520 6578 7061 6e73 696f 6e20    The expansion 
-00012a70: 6973 2064 6f6e 6520 6279 203a 6675 6e63  is done by :func
-00012a80: 3a60 7079 7965 7469 2e6e 6173 7472 616e  :`pyyeti.nastran
-00012a90: 2e6e 3270 2e65 7870 616e 6464 6f66 602e  .n2p.expanddof`.
-00012aa0: 0a0a 2020 2020 4578 616d 706c 6573 0a20  ..    Examples. 
-00012ab0: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
-00012ac0: 3e3e 3e20 6672 6f6d 2070 7979 6574 6920  >>> from pyyeti 
-00012ad0: 696d 706f 7274 206e 6173 7472 616e 0a20  import nastran. 
-00012ae0: 2020 203e 3e3e 2066 726f 6d20 696f 2069     >>> from io i
-00012af0: 6d70 6f72 7420 5374 7269 6e67 494f 0a20  mport StringIO. 
-00012b00: 2020 203e 3e3e 2066 203d 2053 7472 696e     >>> f = Strin
-00012b10: 6749 4f28 2745 5854 524e 2c33 2c31 3233  gIO('EXTRN,3,123
-00012b20: 3435 362c 3131 2c31 3233 3435 362c 3139  456,11,123456,19
-00012b30: 2c31 3233 3435 362c 3237 2c31 3233 3435  ,123456,27,12345
-00012b40: 365c 6e27 0a20 2020 202e 2e2e 2020 2020  6\n'.    ...    
-00012b50: 2020 2020 2020 2020 2020 272c 3239 3935            ',2995
-00012b60: 3030 312c 302c 3239 3935 3030 322c 302c  001,0,2995002,0,
-00012b70: 3239 3935 3030 332c 302c 3239 3935 3030  2995003,0,299500
-00012b80: 342c 305c 6e27 0a20 2020 202e 2e2e 2020  4,0\n'.    ...  
-00012b90: 2020 2020 2020 2020 2020 2020 272c 3239              ',29
-00012ba0: 3935 3030 352c 302c 3239 3935 3030 362c  95005,0,2995006,
-00012bb0: 302c 3239 3935 3030 372c 302c 3239 3935  0,2995007,0,2995
-00012bc0: 3030 382c 305c 6e27 290a 2020 2020 3e3e  008,0\n').    >>
-00012bd0: 3e20 6e61 7374 7261 6e2e 7264 6578 7472  > nastran.rdextr
-00012be0: 6e28 662c 2065 7870 616e 643d 4661 6c73  n(f, expand=Fals
-00012bf0: 6529 2020 2023 2064 6f63 7465 7374 3a20  e)   # doctest: 
-00012c00: 2b45 4c4c 4950 5349 530a 2020 2020 6172  +ELLIPSIS.    ar
-00012c10: 7261 7928 5b5b 2020 2020 2020 332c 2020  ray([[      3,  
-00012c20: 3132 3334 3536 5d2c 0a20 2020 2020 2020  123456],.       
-00012c30: 2020 2020 5b20 2020 2020 3131 2c20 2031      [     11,  1
-00012c40: 3233 3435 365d 2c0a 2020 2020 2020 2020  23456],.        
-00012c50: 2020 205b 2020 2020 2031 392c 2020 3132     [     19,  12
-00012c60: 3334 3536 5d2c 0a20 2020 2020 2020 2020  3456],.         
-00012c70: 2020 5b20 2020 2020 3237 2c20 2031 3233    [     27,  123
-00012c80: 3435 365d 2c0a 2020 2020 2020 2020 2020  456],.          
-00012c90: 205b 3239 3935 3030 312c 2020 2020 2020   [2995001,      
-00012ca0: 2030 5d2c 0a20 2020 2020 2020 2020 2020   0],.           
-00012cb0: 5b32 3939 3530 3032 2c20 2020 2020 2020  [2995002,       
-00012cc0: 305d 2c0a 2020 2020 2020 2020 2020 205b  0],.           [
-00012cd0: 3239 3935 3030 332c 2020 2020 2020 2030  2995003,       0
-00012ce0: 5d2c 0a20 2020 2020 2020 2020 2020 5b32  ],.           [2
-00012cf0: 3939 3530 3034 2c20 2020 2020 2020 305d  995004,       0]
-00012d00: 2c0a 2020 2020 2020 2020 2020 205b 3239  ,.           [29
-00012d10: 3935 3030 352c 2020 2020 2020 2030 5d2c  95005,       0],
-00012d20: 0a20 2020 2020 2020 2020 2020 5b32 3939  .           [299
-00012d30: 3530 3036 2c20 2020 2020 2020 305d 2c0a  5006,       0],.
-00012d40: 2020 2020 2020 2020 2020 205b 3239 3935             [2995
-00012d50: 3030 372c 2020 2020 2020 2030 5d2c 0a20  007,       0],. 
-00012d60: 2020 2020 2020 2020 2020 5b32 3939 3530            [29950
-00012d70: 3038 2c20 2020 2020 2020 305d 5d2e 2e2e  08,       0]]...
-00012d80: 290a 2020 2020 3e3e 3e20 6620 3d20 5374  ).    >>> f = St
-00012d90: 7269 6e67 494f 2827 4558 5452 4e2c 332c  ringIO('EXTRN,3,
-00012da0: 3132 3334 3536 2c32 3939 3530 3031 2c30  123456,2995001,0
-00012db0: 2729 0a20 2020 203e 3e3e 206e 6173 7472  ').    >>> nastr
-00012dc0: 616e 2e72 6465 7874 726e 2866 2920 2020  an.rdextrn(f)   
-00012dd0: 2020 2020 2020 2020 2020 2320 646f 6374            # doct
-00012de0: 6573 743a 202b 454c 4c49 5053 4953 0a20  est: +ELLIPSIS. 
-00012df0: 2020 2061 7272 6179 285b 5b20 2020 2020     array([[     
-00012e00: 2033 2c20 2020 2020 2020 315d 2c0a 2020   3,       1],.  
-00012e10: 2020 2020 2020 2020 205b 2020 2020 2020           [      
-00012e20: 332c 2020 2020 2020 2032 5d2c 0a20 2020  3,       2],.   
-00012e30: 2020 2020 2020 2020 5b20 2020 2020 2033          [      3
-00012e40: 2c20 2020 2020 2020 335d 2c0a 2020 2020  ,       3],.    
-00012e50: 2020 2020 2020 205b 2020 2020 2020 332c         [      3,
-00012e60: 2020 2020 2020 2034 5d2c 0a20 2020 2020         4],.     
-00012e70: 2020 2020 2020 5b20 2020 2020 2033 2c20        [      3, 
-00012e80: 2020 2020 2020 355d 2c0a 2020 2020 2020        5],.      
-00012e90: 2020 2020 205b 2020 2020 2020 332c 2020       [      3,  
-00012ea0: 2020 2020 2036 5d2c 0a20 2020 2020 2020       6],.       
-00012eb0: 2020 2020 5b32 3939 3530 3031 2c20 2020      [2995001,   
-00012ec0: 2020 2020 305d 5d2e 2e2e 290a 2020 2020      0]]...).    
-00012ed0: 2222 220a 2020 2020 6578 7472 6e20 3d20  """.    extrn = 
-00012ee0: 7264 6361 7264 7328 662c 2022 6578 7472  rdcards(f, "extr
-00012ef0: 6e22 2c20 6474 7970 653d 6e70 2e69 6e74  n", dtype=np.int
-00012f00: 3634 292e 7265 7368 6170 6528 2d31 2c20  64).reshape(-1, 
-00012f10: 3229 0a20 2020 2069 6620 6578 7061 6e64  2).    if expand
-00012f20: 3a0a 2020 2020 2020 2020 6578 7472 6e20  :.        extrn 
-00012f30: 3d20 6e32 702e 6578 7061 6e64 646f 6628  = n2p.expanddof(
-00012f40: 6578 7472 6e29 0a20 2020 2072 6574 7572  extrn).    retur
-00012f50: 6e20 6578 7472 6e0a 0a0a 4067 7569 746f  n extrn...@guito
-00012f60: 6f6c 732e 7772 6974 655f 7465 7874 5f66  ols.write_text_f
-00012f70: 696c 650a 6465 6620 7774 6373 7570 6572  ile.def wtcsuper
-00012f80: 2866 2c20 7375 7065 7269 642c 2067 7269  (f, superid, gri
-00012f90: 6473 293a 0a20 2020 2022 2222 0a20 2020  ds):.    """.   
-00012fa0: 2057 7269 7465 7320 6120 4e61 7374 7261   Writes a Nastra
-00012fb0: 6e20 4353 5550 4552 2063 6172 6420 746f  n CSUPER card to
-00012fc0: 2061 2066 696c 652e 0a0a 2020 2020 5061   a file...    Pa
-00012fd0: 7261 6d65 7465 7273 0a20 2020 202d 2d2d  rameters.    ---
-00012fe0: 2d2d 2d2d 2d2d 2d0a 2020 2020 6620 3a20  -------.    f : 
-00012ff0: 7374 7269 6e67 206f 7220 6669 6c65 5f6c  string or file_l
-00013000: 696b 6520 6f72 2031 206f 7220 4e6f 6e65  ike or 1 or None
-00013010: 0a20 2020 2020 2020 2045 6974 6865 7220  .        Either 
-00013020: 6120 6e61 6d65 206f 6620 6120 6669 6c65  a name of a file
-00013030: 2c20 6f72 2069 7320 6120 6669 6c65 5f6c  , or is a file_l
-00013040: 696b 6520 6f62 6a65 6374 2061 7320 7265  ike object as re
-00013050: 7475 726e 6564 0a20 2020 2020 2020 2062  turned.        b
-00013060: 7920 3a66 756e 633a 606f 7065 6e60 206f  y :func:`open` o
-00013070: 7220 3a63 6c61 7373 3a60 696f 2e53 7472  r :class:`io.Str
-00013080: 696e 6749 4f60 2e20 496e 7075 7420 6173  ingIO`. Input as
-00013090: 2069 6e74 6567 6572 2031 2074 6f0a 2020   integer 1 to.  
-000130a0: 2020 2020 2020 7772 6974 6520 746f 2073        write to s
-000130b0: 7464 6f75 742e 2043 616e 2061 6c73 6f20  tdout. Can also 
-000130c0: 6265 2074 6865 206e 616d 6520 6f66 2061  be the name of a
-000130d0: 2064 6972 6563 746f 7279 206f 7220 4e6f   directory or No
-000130e0: 6e65 3b0a 2020 2020 2020 2020 696e 2074  ne;.        in t
-000130f0: 6865 7365 2063 6173 6573 2c20 6120 4755  hese cases, a GU
-00013100: 4920 6973 206f 7065 6e65 6420 666f 7220  I is opened for 
-00013110: 6669 6c65 2073 656c 6563 7469 6f6e 2e0a  file selection..
-00013120: 2020 2020 7375 7065 7269 6420 3a20 696e      superid : in
-00013130: 7465 6765 720a 2020 2020 2020 2020 5375  teger.        Su
-00013140: 7065 7265 6c65 6d65 6e74 2049 440a 2020  perelement ID.  
-00013150: 2020 6772 6964 7320 3a20 3164 2061 7272    grids : 1d arr
-00013160: 6179 5f6c 696b 650a 2020 2020 2020 2020  ay_like.        
-00013170: 5665 6374 6f72 206f 6620 6772 6964 2069  Vector of grid i
-00013180: 6473 2e0a 0a20 2020 2052 6574 7572 6e73  ds...    Returns
-00013190: 0a20 2020 202d 2d2d 2d2d 2d2d 0a20 2020  .    -------.   
-000131a0: 204e 6f6e 650a 0a20 2020 2045 7861 6d70   None..    Examp
-000131b0: 6c65 730a 2020 2020 2d2d 2d2d 2d2d 2d2d  les.    --------
-000131c0: 0a20 2020 203e 3e3e 2066 726f 6d20 7079  .    >>> from py
-000131d0: 7965 7469 2069 6d70 6f72 7420 6e61 7374  yeti import nast
-000131e0: 7261 6e0a 2020 2020 3e3e 3e20 696d 706f  ran.    >>> impo
-000131f0: 7274 206e 756d 7079 2061 7320 6e70 0a20  rt numpy as np. 
-00013200: 2020 203e 3e3e 206e 6173 7472 616e 2e77     >>> nastran.w
-00013210: 7463 7375 7065 7228 312c 2031 3030 2c20  tcsuper(1, 100, 
-00013220: 6e70 2e61 7261 6e67 6528 312c 2031 3029  np.arange(1, 10)
-00013230: 290a 2020 2020 4353 5550 4552 2020 2020  ).    CSUPER    
-00013240: 2020 2031 3030 2020 2020 2020 2030 2020     100       0  
-00013250: 2020 2020 2031 2020 2020 2020 2032 2020       1       2  
-00013260: 2020 2020 2033 2020 2020 2020 2034 2020       3       4  
-00013270: 2020 2020 2035 2020 2020 2020 2036 0a20       5       6. 
-00013280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013290: 2020 3720 2020 2020 2020 3820 2020 2020    7       8     
-000132a0: 2020 390a 2020 2020 2222 220a 2020 2020    9.    """.    
-000132b0: 662e 7772 6974 6528 6622 4353 5550 4552  f.write(f"CSUPER
-000132c0: 2020 7b73 7570 6572 6964 3a38 647d 7b30    {superid:8d}{0
-000132d0: 3a38 647d 2229 0a20 2020 2077 746e 6173  :8d}").    wtnas
-000132e0: 696e 7473 2866 2c20 342c 2067 7269 6473  ints(f, 4, grids
-000132f0: 290a 0a0a 4067 7569 746f 6f6c 732e 7772  )...@guitools.wr
-00013300: 6974 655f 7465 7874 5f66 696c 650a 6465  ite_text_file.de
-00013310: 6620 7774 7370 6331 2866 2c20 6569 642c  f wtspc1(f, eid,
-00013320: 2064 6f66 2c20 6772 6964 732c 206e 616d   dof, grids, nam
-00013330: 653d 2253 5043 3122 293a 0a20 2020 2022  e="SPC1"):.    "
-00013340: 2222 0a20 2020 2057 7269 7465 7320 6120  "".    Writes a 
-00013350: 4e61 7374 7261 6e20 5350 4331 2028 6f72  Nastran SPC1 (or
-00013360: 2073 696d 696c 6172 2920 6361 7264 2074   similar) card t
-00013370: 6f20 6120 6669 6c65 2e0a 0a20 2020 2050  o a file...    P
-00013380: 6172 616d 6574 6572 730a 2020 2020 2d2d  arameters.    --
-00013390: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2066 203a  --------.    f :
-000133a0: 2073 7472 696e 6720 6f72 2066 696c 655f   string or file_
-000133b0: 6c69 6b65 206f 7220 3120 6f72 204e 6f6e  like or 1 or Non
-000133c0: 650a 2020 2020 2020 2020 4569 7468 6572  e.        Either
-000133d0: 2061 206e 616d 6520 6f66 2061 2066 696c   a name of a fil
-000133e0: 652c 206f 7220 6973 2061 2066 696c 655f  e, or is a file_
-000133f0: 6c69 6b65 206f 626a 6563 7420 6173 2072  like object as r
-00013400: 6574 7572 6e65 640a 2020 2020 2020 2020  eturned.        
-00013410: 6279 203a 6675 6e63 3a60 6f70 656e 6020  by :func:`open` 
-00013420: 6f72 203a 636c 6173 733a 6069 6f2e 5374  or :class:`io.St
-00013430: 7269 6e67 494f 602e 2049 6e70 7574 2061  ringIO`. Input a
-00013440: 7320 696e 7465 6765 7220 3120 746f 0a20  s integer 1 to. 
-00013450: 2020 2020 2020 2077 7269 7465 2074 6f20         write to 
-00013460: 7374 646f 7574 2e20 4361 6e20 616c 736f  stdout. Can also
-00013470: 2062 6520 7468 6520 6e61 6d65 206f 6620   be the name of 
-00013480: 6120 6469 7265 6374 6f72 7920 6f72 204e  a directory or N
-00013490: 6f6e 653b 0a20 2020 2020 2020 2069 6e20  one;.        in 
-000134a0: 7468 6573 6520 6361 7365 732c 2061 2047  these cases, a G
-000134b0: 5549 2069 7320 6f70 656e 6564 2066 6f72  UI is opened for
-000134c0: 2066 696c 6520 7365 6c65 6374 696f 6e2e   file selection.
-000134d0: 0a20 2020 2065 6964 203a 2069 6e74 6567  .    eid : integ
-000134e0: 6572 0a20 2020 2020 2020 2045 6c65 6d65  er.        Eleme
-000134f0: 6e74 2049 440a 2020 2020 646f 6620 3a20  nt ID.    dof : 
-00013500: 696e 7465 6765 720a 2020 2020 2020 2020  integer.        
-00013510: 416e 2069 6e74 6567 6572 2063 6f6e 6361  An integer conca
-00013520: 7465 6e61 7469 6f6e 206f 6620 7468 6520  tenation of the 
-00013530: 444f 4620 2865 783a 2031 3233 3435 3629  DOF (ex: 123456)
-00013540: 0a20 2020 2067 7269 6473 203a 2031 6420  .    grids : 1d 
-00013550: 6172 7261 795f 6c69 6b65 0a20 2020 2020  array_like.     
-00013560: 2020 2056 6563 746f 7220 6f66 2067 7269     Vector of gri
-00013570: 6420 6964 732e 0a20 2020 206e 616d 6520  d ids..    name 
-00013580: 3a20 7374 7269 6e67 3b20 6f70 7469 6f6e  : string; option
-00013590: 616c 0a20 2020 2020 2020 204e 616d 6520  al.        Name 
-000135a0: 6f66 204e 4153 5452 414e 2063 6172 6420  of NASTRAN card 
-000135b0: 746f 2077 7269 7465 3b20 6361 7264 206d  to write; card m
-000135c0: 7573 7420 6265 2069 6e20 7361 6d65 2066  ust be in same f
-000135d0: 6f72 6d61 7420 6173 0a20 2020 2020 2020  ormat as.       
-000135e0: 2074 6865 2053 5043 3120 6361 7264 2e0a   the SPC1 card..
-000135f0: 0a20 2020 2052 6574 7572 6e73 0a20 2020  .    Returns.   
-00013600: 202d 2d2d 2d2d 2d2d 0a20 2020 204e 6f6e   -------.    Non
-00013610: 650a 0a20 2020 2045 7861 6d70 6c65 730a  e..    Examples.
-00013620: 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020      --------.   
-00013630: 203e 3e3e 2066 726f 6d20 7079 7965 7469   >>> from pyyeti
-00013640: 2069 6d70 6f72 7420 6e61 7374 7261 6e0a   import nastran.
-00013650: 2020 2020 3e3e 3e20 696d 706f 7274 206e      >>> import n
-00013660: 756d 7079 2061 7320 6e70 0a20 2020 203e  umpy as np.    >
-00013670: 3e3e 206e 6173 7472 616e 2e77 7473 7063  >> nastran.wtspc
-00013680: 3128 312c 2031 2c20 3132 3334 3536 2c20  1(1, 1, 123456, 
-00013690: 6e70 2e61 7261 6e67 6528 312c 2031 3029  np.arange(1, 10)
-000136a0: 290a 2020 2020 5350 4331 2020 2020 2020  ).    SPC1      
-000136b0: 2020 2020 2031 2020 3132 3334 3536 2020       1  123456  
-000136c0: 2020 2020 2031 2020 2020 2020 2032 2020       1       2  
-000136d0: 2020 2020 2033 2020 2020 2020 2034 2020       3       4  
-000136e0: 2020 2020 2035 2020 2020 2020 2036 0a20       5       6. 
-000136f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013700: 2020 3720 2020 2020 2020 3820 2020 2020    7       8     
-00013710: 2020 390a 2020 2020 3e3e 3e20 6e61 7374    9.    >>> nast
-00013720: 7261 6e2e 7774 7370 6331 2831 2c20 3230  ran.wtspc1(1, 20
-00013730: 302c 2031 3233 3435 362c 206e 702e 6172  0, 123456, np.ar
-00013740: 616e 6765 2832 3030 312c 2032 3033 3129  ange(2001, 2031)
-00013750: 2c0a 2020 2020 2e2e 2e20 2020 2020 2020  ,.    ...       
-00013760: 2020 2020 2020 2020 2027 5345 5153 4554           'SEQSET
-00013770: 3127 290a 2020 2020 5345 5153 4554 3120  1').    SEQSET1 
-00013780: 2020 2020 2032 3030 2020 3132 3334 3536       200  123456
-00013790: 2020 2020 3230 3031 2020 2020 3230 3032      2001    2002
-000137a0: 2020 2020 3230 3033 2020 2020 3230 3034      2003    2004
-000137b0: 2020 2020 3230 3035 2020 2020 3230 3036      2005    2006
-000137c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000137d0: 2032 3030 3720 2020 2032 3030 3820 2020   2007    2008   
-000137e0: 2032 3030 3920 2020 2032 3031 3020 2020   2009    2010   
-000137f0: 2032 3031 3120 2020 2032 3031 3220 2020   2011    2012   
-00013800: 2032 3031 3320 2020 2032 3031 340a 2020   2013    2014.  
-00013810: 2020 2020 2020 2020 2020 2020 2020 3230                20
-00013820: 3135 2020 2020 3230 3136 2020 2020 3230  15    2016    20
-00013830: 3137 2020 2020 3230 3138 2020 2020 3230  17    2018    20
-00013840: 3139 2020 2020 3230 3230 2020 2020 3230  19    2020    20
-00013850: 3231 2020 2020 3230 3232 0a20 2020 2020  21    2022.     
-00013860: 2020 2020 2020 2020 2020 2032 3032 3320             2023 
-00013870: 2020 2032 3032 3420 2020 2032 3032 3520     2024    2025 
-00013880: 2020 2032 3032 3620 2020 2032 3032 3720     2026    2027 
-00013890: 2020 2032 3032 3820 2020 2032 3032 3920     2028    2029 
-000138a0: 2020 2032 3033 300a 2020 2020 2222 220a     2030.    """.
-000138b0: 2020 2020 662e 7772 6974 6528 6622 7b6e      f.write(f"{n
-000138c0: 616d 653a 3c38 737d 7b65 6964 3a38 647d  ame:<8s}{eid:8d}
-000138d0: 7b64 6f66 3a38 647d 2229 0a20 2020 2077  {dof:8d}").    w
-000138e0: 746e 6173 696e 7473 2866 2c20 342c 2067  tnasints(f, 4, g
-000138f0: 7269 6473 290a 0a0a 4067 7569 746f 6f6c  rids)...@guitool
-00013900: 732e 7772 6974 655f 7465 7874 5f66 696c  s.write_text_fil
-00013910: 650a 6465 6620 7774 7873 6574 3128 662c  e.def wtxset1(f,
-00013920: 2064 6f66 2c20 6772 6964 732c 206e 616d   dof, grids, nam
-00013930: 653d 2242 5345 5431 2229 3a0a 2020 2020  e="BSET1"):.    
-00013940: 2222 220a 2020 2020 5772 6974 6573 2061  """.    Writes a
-00013950: 204e 6173 7472 616e 2042 5345 5431 2c20   Nastran BSET1, 
-00013960: 5153 4554 3120 286f 7220 7369 6d69 6c61  QSET1 (or simila
-00013970: 7229 2063 6172 6420 746f 2061 2066 696c  r) card to a fil
-00013980: 652e 0a0a 2020 2020 5061 7261 6d65 7465  e...    Paramete
-00013990: 7273 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d  rs.    ---------
-000139a0: 2d0a 2020 2020 6620 3a20 7374 7269 6e67  -.    f : string
-000139b0: 206f 7220 6669 6c65 5f6c 696b 6520 6f72   or file_like or
-000139c0: 2031 206f 7220 4e6f 6e65 0a20 2020 2020   1 or None.     
-000139d0: 2020 2045 6974 6865 7220 6120 6e61 6d65     Either a name
-000139e0: 206f 6620 6120 6669 6c65 2c20 6f72 2069   of a file, or i
-000139f0: 7320 6120 6669 6c65 5f6c 696b 6520 6f62  s a file_like ob
-00013a00: 6a65 6374 2061 7320 7265 7475 726e 6564  ject as returned
-00013a10: 0a20 2020 2020 2020 2062 7920 3a66 756e  .        by :fun
-00013a20: 633a 606f 7065 6e60 206f 7220 3a63 6c61  c:`open` or :cla
-00013a30: 7373 3a60 696f 2e53 7472 696e 6749 4f60  ss:`io.StringIO`
-00013a40: 2e20 496e 7075 7420 6173 2069 6e74 6567  . Input as integ
-00013a50: 6572 2031 2074 6f0a 2020 2020 2020 2020  er 1 to.        
-00013a60: 7772 6974 6520 746f 2073 7464 6f75 742e  write to stdout.
-00013a70: 2043 616e 2061 6c73 6f20 6265 2074 6865   Can also be the
-00013a80: 206e 616d 6520 6f66 2061 2064 6972 6563   name of a direc
-00013a90: 746f 7279 206f 7220 4e6f 6e65 3b0a 2020  tory or None;.  
-00013aa0: 2020 2020 2020 696e 2074 6865 7365 2063        in these c
-00013ab0: 6173 6573 2c20 6120 4755 4920 6973 206f  ases, a GUI is o
-00013ac0: 7065 6e65 6420 666f 7220 6669 6c65 2073  pened for file s
-00013ad0: 656c 6563 7469 6f6e 2e0a 2020 2020 646f  election..    do
-00013ae0: 6620 3a20 696e 7465 6765 720a 2020 2020  f : integer.    
-00013af0: 2020 2020 416e 2069 6e74 6567 6572 2063      An integer c
-00013b00: 6f6e 6361 7465 6e61 7469 6f6e 206f 6620  oncatenation of 
-00013b10: 7468 6520 444f 4620 2865 783a 2031 3233  the DOF (ex: 123
-00013b20: 3435 3629 0a20 2020 2067 7269 6473 203a  456).    grids :
-00013b30: 2031 6420 6172 7261 795f 6c69 6b65 0a20   1d array_like. 
-00013b40: 2020 2020 2020 2056 6563 746f 7220 6f66         Vector of
-00013b50: 2067 7269 6420 6964 732e 0a20 2020 206e   grid ids..    n
-00013b60: 616d 6520 3a20 7374 7269 6e67 3b20 6f70  ame : string; op
-00013b70: 7469 6f6e 616c 0a20 2020 2020 2020 204e  tional.        N
-00013b80: 616d 6520 6f66 204e 4153 5452 414e 2063  ame of NASTRAN c
-00013b90: 6172 6420 746f 2077 7269 7465 3b20 6361  ard to write; ca
-00013ba0: 7264 206d 7573 7420 6265 2069 6e20 7361  rd must be in sa
-00013bb0: 6d65 2066 6f72 6d61 7420 6173 0a20 2020  me format as.   
-00013bc0: 2020 2020 2074 6865 2053 5043 3120 6361       the SPC1 ca
-00013bd0: 7264 2e0a 0a20 2020 2052 6574 7572 6e73  rd...    Returns
-00013be0: 0a20 2020 202d 2d2d 2d2d 2d2d 0a20 2020  .    -------.   
-00013bf0: 204e 6f6e 650a 0a20 2020 2045 7861 6d70   None..    Examp
-00013c00: 6c65 730a 2020 2020 2d2d 2d2d 2d2d 2d2d  les.    --------
-00013c10: 0a20 2020 203e 3e3e 2066 726f 6d20 7079  .    >>> from py
-00013c20: 7965 7469 2069 6d70 6f72 7420 6e61 7374  yeti import nast
-00013c30: 7261 6e0a 2020 2020 3e3e 3e20 696d 706f  ran.    >>> impo
-00013c40: 7274 206e 756d 7079 2061 7320 6e70 0a20  rt numpy as np. 
-00013c50: 2020 203e 3e3e 206e 6173 7472 616e 2e77     >>> nastran.w
-00013c60: 7478 7365 7431 2831 2c20 3132 3334 3536  txset1(1, 123456
-00013c70: 2c20 6e70 2e61 7261 6e67 6528 312c 2031  , np.arange(1, 1
-00013c80: 3129 290a 2020 2020 4253 4554 3120 2020  1)).    BSET1   
-00013c90: 2020 3132 3334 3536 2020 2020 2020 2031    123456       1
-00013ca0: 2020 2020 2020 2032 2020 2020 2020 2033         2       3
-00013cb0: 2020 2020 2020 2034 2020 2020 2020 2035         4       5
-00013cc0: 2020 2020 2020 2036 2020 2020 2020 2037         6       7
-00013cd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00013ce0: 2020 2020 3820 2020 2020 2020 3920 2020      8       9   
-00013cf0: 2020 2031 300a 2020 2020 3e3e 3e20 6e61     10.    >>> na
-00013d00: 7374 7261 6e2e 7774 7873 6574 3128 312c  stran.wtxset1(1,
-00013d10: 2030 2c20 6e70 2e61 7261 6e67 6528 3230   0, np.arange(20
-00013d20: 3031 2c20 3230 3133 292c 2027 5153 4554  01, 2013), 'QSET
-00013d30: 3127 290a 2020 2020 5153 4554 3120 2020  1').    QSET1   
-00013d40: 2020 2020 2020 2030 2020 2020 3230 3031         0    2001
-00013d50: 2020 2020 3230 3032 2020 2020 3230 3033      2002    2003
-00013d60: 2020 2020 3230 3034 2020 2020 3230 3035      2004    2005
-00013d70: 2020 2020 3230 3036 2020 2020 3230 3037      2006    2007
-00013d80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00013d90: 2032 3030 3820 2020 2032 3030 3920 2020   2008    2009   
-00013da0: 2032 3031 3020 2020 2032 3031 3120 2020   2010    2011   
-00013db0: 2032 3031 320a 2020 2020 2222 220a 2020   2012.    """.  
-00013dc0: 2020 662e 7772 6974 6528 6622 7b6e 616d    f.write(f"{nam
-00013dd0: 653a 3c38 737d 7b64 6f66 3a38 647d 2229  e:<8s}{dof:8d}")
-00013de0: 0a20 2020 2077 746e 6173 696e 7473 2866  .    wtnasints(f
-00013df0: 2c20 332c 2067 7269 6473 290a 0a0a 4067  , 3, grids)...@g
-00013e00: 7569 746f 6f6c 732e 7772 6974 655f 7465  uitools.write_te
-00013e10: 7874 5f66 696c 650a 6465 6620 7774 7163  xt_file.def wtqc
-00013e20: 7365 7428 662c 2073 7461 7274 6772 6964  set(f, startgrid
-00013e30: 2c20 6e71 293a 0a20 2020 2022 2222 0a20  , nq):.    """. 
-00013e40: 2020 2057 7269 7465 7320 4e61 7374 7261     Writes Nastra
-00013e50: 6e20 5153 4554 3120 616e 6420 4353 4554  n QSET1 and CSET
-00013e60: 3120 6361 7264 7320 666f 7220 4752 4944  1 cards for GRID
-00013e70: 206d 6f64 616c 2044 4f46 2066 6f72 2075   modal DOF for u
-00013e80: 7365 2069 6e0a 2020 2020 7468 6520 444d  se in.    the DM
-00013e90: 4150 2022 7874 6d61 7472 6978 222e 0a0a  AP "xtmatrix"...
-00013ea0: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
-00013eb0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
-00013ec0: 2020 6620 3a20 7374 7269 6e67 206f 7220    f : string or 
-00013ed0: 6669 6c65 5f6c 696b 6520 6f72 2031 206f  file_like or 1 o
-00013ee0: 7220 4e6f 6e65 0a20 2020 2020 2020 2045  r None.        E
-00013ef0: 6974 6865 7220 6120 6e61 6d65 206f 6620  ither a name of 
-00013f00: 6120 6669 6c65 2c20 6f72 2069 7320 6120  a file, or is a 
-00013f10: 6669 6c65 5f6c 696b 6520 6f62 6a65 6374  file_like object
-00013f20: 2061 7320 7265 7475 726e 6564 0a20 2020   as returned.   
-00013f30: 2020 2020 2062 7920 3a66 756e 633a 606f       by :func:`o
-00013f40: 7065 6e60 206f 7220 3a63 6c61 7373 3a60  pen` or :class:`
-00013f50: 696f 2e53 7472 696e 6749 4f60 2e20 496e  io.StringIO`. In
-00013f60: 7075 7420 6173 2069 6e74 6567 6572 2031  put as integer 1
-00013f70: 2074 6f0a 2020 2020 2020 2020 7772 6974   to.        writ
-00013f80: 6520 746f 2073 7464 6f75 742e 2043 616e  e to stdout. Can
-00013f90: 2061 6c73 6f20 6265 2074 6865 206e 616d   also be the nam
-00013fa0: 6520 6f66 2061 2064 6972 6563 746f 7279  e of a directory
-00013fb0: 206f 7220 4e6f 6e65 3b0a 2020 2020 2020   or None;.      
-00013fc0: 2020 696e 2074 6865 7365 2063 6173 6573    in these cases
-00013fd0: 2c20 6120 4755 4920 6973 206f 7065 6e65  , a GUI is opene
-00013fe0: 6420 666f 7220 6669 6c65 2073 656c 6563  d for file selec
-00013ff0: 7469 6f6e 2e0a 2020 2020 7374 6172 7467  tion..    startg
-00014000: 7269 6420 3a20 696e 7465 6765 720a 2020  rid : integer.  
-00014010: 2020 2020 2020 5468 6520 7374 6172 7420        The start 
-00014020: 4944 2066 6f72 2074 6865 206d 6f64 616c  ID for the modal
-00014030: 2067 7269 6473 2074 6861 7420 6e65 6564   grids that need
-00014040: 2074 6f20 6265 2061 7373 6967 6e65 6420   to be assigned 
-00014050: 746f 0a20 2020 2020 2020 2074 6865 2051  to.        the Q
-00014060: 2d73 6574 2061 6e64 2043 2d73 6574 2e20  -set and C-set. 
-00014070: 416e 7920 6578 7472 6120 444f 4620 6172  Any extra DOF ar
-00014080: 6520 6173 7369 676e 6564 2074 6f20 7468  e assigned to th
-00014090: 6520 432d 7365 742e 0a20 2020 2020 2020  e C-set..       
-000140a0: 2043 7265 6174 6564 2067 7269 6420 4944   Created grid ID
-000140b0: 7320 7769 6c6c 2062 6520 7365 7175 656e  s will be sequen
-000140c0: 7469 616c 2e0a 2020 2020 6e71 203a 2069  tial..    nq : i
-000140d0: 6e74 6567 6572 0a20 2020 2020 2020 204e  nteger.        N
-000140e0: 756d 6265 7220 6f66 206d 6f64 616c 2044  umber of modal D
-000140f0: 4f46 0a0a 2020 2020 5265 7475 726e 730a  OF..    Returns.
-00014100: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
-00014110: 4e6f 6e65 0a0a 2020 2020 4578 616d 706c  None..    Exampl
-00014120: 6573 0a20 2020 202d 2d2d 2d2d 2d2d 2d0a  es.    --------.
-00014130: 2020 2020 3e3e 3e20 6672 6f6d 2070 7979      >>> from pyy
-00014140: 6574 6920 696d 706f 7274 206e 6173 7472  eti import nastr
-00014150: 616e 0a20 2020 203e 3e3e 2069 6d70 6f72  an.    >>> impor
-00014160: 7420 6e75 6d70 7920 6173 206e 700a 2020  t numpy as np.  
-00014170: 2020 3e3e 3e20 6e61 7374 7261 6e2e 7774    >>> nastran.wt
-00014180: 7163 7365 7428 312c 2039 3930 3030 312c  qcset(1, 990001,
-00014190: 2031 3429 0a20 2020 2051 5345 5431 2020   14).    QSET1  
-000141a0: 2020 2031 3233 3435 3620 2039 3930 3030     123456  99000
-000141b0: 3120 5448 5255 2020 2020 2039 3930 3030  1 THRU     99000
-000141c0: 320a 2020 2020 5153 4554 3120 2020 2020  2.    QSET1     
-000141d0: 2020 2020 3132 2020 3939 3030 3033 0a20      12  990003. 
-000141e0: 2020 2043 5345 5431 2020 2020 2020 2033     CSET1       3
-000141f0: 3435 3620 2039 3930 3030 330a 2020 2020  456  990003.    
-00014200: 2222 220a 2020 2020 6e67 7269 6473 203d  """.    ngrids =
-00014210: 2028 6e71 202b 2035 2920 2f2f 2036 0a20   (nq + 5) // 6. 
-00014220: 2020 2065 6e64 6772 6964 203d 2073 7461     endgrid = sta
-00014230: 7274 6772 6964 202b 206e 6772 6964 7320  rtgrid + ngrids 
-00014240: 2d20 310a 2020 2020 7864 6f66 203d 206e  - 1.    xdof = n
-00014250: 7120 2d20 3620 2a20 286e 6772 6964 7320  q - 6 * (ngrids 
-00014260: 2d20 3129 0a20 2020 2078 646f 6673 203d  - 1).    xdofs =
-00014270: 2022 3132 3334 3536 225b 3a78 646f 665d   "123456"[:xdof]
-00014280: 0a20 2020 2063 646f 6673 203d 2022 3132  .    cdofs = "12
-00014290: 3334 3536 225b 7864 6f66 3a5d 0a20 2020  3456"[xdof:].   
-000142a0: 2023 2077 7269 7465 2071 7365 7420 616e   # write qset an
-000142b0: 6420 6373 6574 2063 6172 6473 3a0a 2020  d cset cards:.  
-000142c0: 2020 6966 2078 646f 6620 3d3d 2036 3a0a    if xdof == 6:.
-000142d0: 2020 2020 2020 2020 6966 206e 6772 6964          if ngrid
-000142e0: 7320 3e20 313a 0a20 2020 2020 2020 2020  s > 1:.         
-000142f0: 2020 2066 2e77 7269 7465 280a 2020 2020     f.write(.    
-00014300: 2020 2020 2020 2020 2020 2020 6622 7b27              f"{'
-00014310: 5153 4554 3127 3a3c 3873 7d7b 3132 3334  QSET1':<8s}{1234
-00014320: 3536 3a38 647d 7b73 7461 7274 6772 6964  56:8d}{startgrid
-00014330: 3a38 647d 7b27 2054 4852 5520 273a 3c38  :8d}{' THRU ':<8
-00014340: 737d 7b65 6e64 6772 6964 3a38 647d 5c6e  s}{endgrid:8d}\n
-00014350: 220a 2020 2020 2020 2020 2020 2020 290a  ".            ).
-00014360: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00014370: 2020 2020 2020 2020 2020 662e 7772 6974            f.writ
-00014380: 6528 6622 7b27 5153 4554 3127 3a3c 3873  e(f"{'QSET1':<8s
-00014390: 7d7b 3132 3334 3536 3a38 647d 7b73 7461  }{123456:8d}{sta
-000143a0: 7274 6772 6964 3a38 647d 5c6e 2229 0a20  rtgrid:8d}\n"). 
-000143b0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-000143c0: 2069 6620 6e67 7269 6473 203e 2032 3a0a   if ngrids > 2:.
-000143d0: 2020 2020 2020 2020 2020 2020 662e 7772              f.wr
-000143e0: 6974 6528 0a20 2020 2020 2020 2020 2020  ite(.           
-000143f0: 2020 2020 2066 227b 2751 5345 5431 273a       f"{'QSET1':
-00014400: 3c38 737d 7b31 3233 3435 363a 3864 7d7b  <8s}{123456:8d}{
-00014410: 7374 6172 7467 7269 643a 3864 7d7b 2720  startgrid:8d}{' 
-00014420: 5448 5255 2027 3a3c 3873 7d22 0a20 2020  THRU ':<8s}".   
-00014430: 2020 2020 2020 2020 2020 2020 2066 227b               f"{
-00014440: 656e 6467 7269 6420 2d20 313a 3864 7d5c  endgrid - 1:8d}\
-00014450: 6e22 0a20 2020 2020 2020 2020 2020 2029  n".            )
-00014460: 0a20 2020 2020 2020 2065 6c69 6620 6e67  .        elif ng
-00014470: 7269 6473 203d 3d20 323a 0a20 2020 2020  rids == 2:.     
-00014480: 2020 2020 2020 2066 2e77 7269 7465 2866         f.write(f
-00014490: 227b 2751 5345 5431 273a 3c38 737d 7b31  "{'QSET1':<8s}{1
-000144a0: 3233 3435 363a 3864 7d7b 7374 6172 7467  23456:8d}{startg
-000144b0: 7269 643a 3864 7d5c 6e22 290a 2020 2020  rid:8d}\n").    
-000144c0: 2020 2020 662e 7772 6974 6528 6622 7b27      f.write(f"{'
-000144d0: 5153 4554 3127 3a3c 3873 7d7b 7864 6f66  QSET1':<8s}{xdof
-000144e0: 733a 3e38 737d 7b65 6e64 6772 6964 3a38  s:>8s}{endgrid:8
-000144f0: 647d 5c6e 2229 0a20 2020 2020 2020 2066  d}\n").        f
-00014500: 2e77 7269 7465 2866 227b 2743 5345 5431  .write(f"{'CSET1
-00014510: 273a 3c38 737d 7b63 646f 6673 3a3e 3873  ':<8s}{cdofs:>8s
-00014520: 7d7b 656e 6467 7269 643a 3864 7d5c 6e22  }{endgrid:8d}\n"
-00014530: 290a 0a0a 4067 7569 746f 6f6c 732e 7772  )...@guitools.wr
-00014540: 6974 655f 7465 7874 5f66 696c 650a 6465  ite_text_file.de
-00014550: 6620 7774 7262 6532 2866 2c20 6569 642c  f wtrbe2(f, eid,
-00014560: 2069 6e64 6570 2c20 646f 662c 2064 6570   indep, dof, dep
-00014570: 293a 0a20 2020 2022 2222 0a20 2020 2057  ):.    """.    W
-00014580: 7269 7465 7320 6120 4e61 7374 7261 6e20  rites a Nastran 
-00014590: 5242 4532 2063 6172 6420 746f 2061 2066  RBE2 card to a f
-000145a0: 696c 652e 0a0a 2020 2020 5061 7261 6d65  ile...    Parame
-000145b0: 7465 7273 0a20 2020 202d 2d2d 2d2d 2d2d  ters.    -------
-000145c0: 2d2d 2d0a 2020 2020 6620 3a20 7374 7269  ---.    f : stri
-000145d0: 6e67 206f 7220 6669 6c65 5f6c 696b 6520  ng or file_like 
-000145e0: 6f72 2031 206f 7220 4e6f 6e65 0a20 2020  or 1 or None.   
-000145f0: 2020 2020 2045 6974 6865 7220 6120 6e61       Either a na
-00014600: 6d65 206f 6620 6120 6669 6c65 2c20 6f72  me of a file, or
-00014610: 2069 7320 6120 6669 6c65 5f6c 696b 6520   is a file_like 
-00014620: 6f62 6a65 6374 2061 7320 7265 7475 726e  object as return
-00014630: 6564 0a20 2020 2020 2020 2062 7920 3a66  ed.        by :f
-00014640: 756e 633a 606f 7065 6e60 206f 7220 3a63  unc:`open` or :c
-00014650: 6c61 7373 3a60 696f 2e53 7472 696e 6749  lass:`io.StringI
-00014660: 4f60 2e20 496e 7075 7420 6173 2069 6e74  O`. Input as int
-00014670: 6567 6572 2031 2074 6f0a 2020 2020 2020  eger 1 to.      
-00014680: 2020 7772 6974 6520 746f 2073 7464 6f75    write to stdou
-00014690: 742e 2043 616e 2061 6c73 6f20 6265 2074  t. Can also be t
-000146a0: 6865 206e 616d 6520 6f66 2061 2064 6972  he name of a dir
-000146b0: 6563 746f 7279 206f 7220 4e6f 6e65 3b0a  ectory or None;.
-000146c0: 2020 2020 2020 2020 696e 2074 6865 7365          in these
-000146d0: 2063 6173 6573 2c20 6120 4755 4920 6973   cases, a GUI is
-000146e0: 206f 7065 6e65 6420 666f 7220 6669 6c65   opened for file
-000146f0: 2073 656c 6563 7469 6f6e 2e0a 2020 2020   selection..    
-00014700: 6569 6420 3a20 696e 7465 6765 720a 2020  eid : integer.  
-00014710: 2020 2020 2020 456c 656d 656e 7420 4944        Element ID
-00014720: 0a20 2020 2069 6e64 6570 203a 2069 6e74  .    indep : int
-00014730: 6567 6572 0a20 2020 2020 2020 2049 6e64  eger.        Ind
-00014740: 6570 656e 6465 6e74 2067 7269 6420 4944  ependent grid ID
-00014750: 2e20 416c 6c20 3620 444f 4620 6172 6520  . All 6 DOF are 
-00014760: 6175 746f 6d61 7469 6361 6c6c 7920 696e  automatically in
-00014770: 6465 7065 6e64 656e 740a 2020 2020 2020  dependent.      
-00014780: 2020 616e 6420 6172 6520 6e6f 7420 7370    and are not sp
-00014790: 6563 6966 6965 642e 0a20 2020 2064 6f66  ecified..    dof
-000147a0: 203a 2069 6e74 6567 6572 0a20 2020 2020   : integer.     
-000147b0: 2020 2041 6e20 696e 7465 6765 7220 636f     An integer co
-000147c0: 6e63 6174 656e 6174 696f 6e20 6f66 2074  ncatenation of t
-000147d0: 6865 2044 4f46 2028 6578 3a20 3132 3334  he DOF (ex: 1234
-000147e0: 3536 2920 7468 6174 2061 7070 6c69 6573  56) that applies
-000147f0: 0a20 2020 2020 2020 2066 6f72 2061 6c6c  .        for all
-00014800: 2074 6865 2064 6570 656e 6465 6e74 2044   the dependent D
-00014810: 4f46 2e0a 2020 2020 6465 7020 3a20 3164  OF..    dep : 1d
-00014820: 2061 7272 6179 5f6c 696b 650a 2020 2020   array_like.    
-00014830: 2020 2020 5665 6374 6f72 206f 6620 6465      Vector of de
-00014840: 7065 6e64 656e 7420 6772 6964 2049 4473  pendent grid IDs
-00014850: 0a0a 2020 2020 5265 7475 726e 730a 2020  ..    Returns.  
-00014860: 2020 2d2d 2d2d 2d2d 2d0a 2020 2020 4e6f    -------.    No
-00014870: 6e65 0a0a 2020 2020 4578 616d 706c 6573  ne..    Examples
-00014880: 0a20 2020 202d 2d2d 2d2d 2d2d 2d0a 2020  .    --------.  
-00014890: 2020 3e3e 3e20 6672 6f6d 2070 7979 6574    >>> from pyyet
-000148a0: 6920 696d 706f 7274 206e 6173 7472 616e  i import nastran
-000148b0: 0a20 2020 203e 3e3e 2069 6d70 6f72 7420  .    >>> import 
-000148c0: 6e75 6d70 7920 6173 206e 700a 2020 2020  numpy as np.    
-000148d0: 3e3e 3e20 6e61 7374 7261 6e2e 7774 7262  >>> nastran.wtrb
-000148e0: 6532 2831 2c20 312c 2031 3030 2c20 3132  e2(1, 1, 100, 12
-000148f0: 3334 3536 2c20 6e70 2e61 7261 6e67 6528  3456, np.arange(
-00014900: 3130 312c 2031 3131 2929 0a20 2020 2052  101, 111)).    R
-00014910: 4245 3220 2020 2020 2020 2020 2020 3120  BE2           1 
-00014920: 2020 2020 3130 3020 2031 3233 3435 3620      100  123456 
-00014930: 2020 2020 3130 3120 2020 2020 3130 3220      101     102 
-00014940: 2020 2020 3130 3320 2020 2020 3130 3420      103     104 
-00014950: 2020 2020 3130 350a 2020 2020 2020 2020      105.        
-00014960: 2020 2020 2020 2020 2031 3036 2020 2020           106    
-00014970: 2031 3037 2020 2020 2031 3038 2020 2020   107     108    
-00014980: 2031 3039 2020 2020 2031 3130 0a20 2020   109     110.   
-00014990: 2022 2222 0a20 2020 2066 2e77 7269 7465   """.    f.write
-000149a0: 2866 2252 4245 3220 2020 207b 6569 643a  (f"RBE2    {eid:
-000149b0: 3864 7d7b 696e 6465 703a 3864 7d7b 646f  8d}{indep:8d}{do
-000149c0: 663a 3864 7d22 290a 2020 2020 7774 6e61  f:8d}").    wtna
-000149d0: 7369 6e74 7328 662c 2035 2c20 6465 7029  sints(f, 5, dep)
-000149e0: 0a0a 0a40 6775 6974 6f6f 6c73 2e77 7269  ...@guitools.wri
-000149f0: 7465 5f74 6578 745f 6669 6c65 0a64 6566  te_text_file.def
-00014a00: 2077 7472 6265 3328 662c 2065 6964 2c20   wtrbe3(f, eid, 
-00014a10: 4752 4944 5f64 6570 2c20 444f 465f 6465  GRID_dep, DOF_de
-00014a20: 702c 2049 6e64 5f4c 6973 742c 2055 4d5f  p, Ind_List, UM_
-00014a30: 4c69 7374 3d4e 6f6e 652c 2061 6c70 6861  List=None, alpha
-00014a40: 3d4e 6f6e 6529 3a0a 2020 2020 2222 220a  =None):.    """.
-00014a50: 2020 2020 5772 6974 6573 2061 204e 6173      Writes a Nas
-00014a60: 7472 616e 2052 4245 3320 6361 7264 2074  tran RBE3 card t
-00014a70: 6f20 6120 6669 6c65 2e0a 0a20 2020 2050  o a file...    P
-00014a80: 6172 616d 6574 6572 730a 2020 2020 2d2d  arameters.    --
-00014a90: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2066 203a  --------.    f :
-00014aa0: 2073 7472 696e 6720 6f72 2066 696c 655f   string or file_
-00014ab0: 6c69 6b65 206f 7220 3120 6f72 204e 6f6e  like or 1 or Non
-00014ac0: 650a 2020 2020 2020 2020 4569 7468 6572  e.        Either
-00014ad0: 2061 206e 616d 6520 6f66 2061 2066 696c   a name of a fil
-00014ae0: 652c 206f 7220 6973 2061 2066 696c 655f  e, or is a file_
-00014af0: 6c69 6b65 206f 626a 6563 7420 6173 2072  like object as r
-00014b00: 6574 7572 6e65 640a 2020 2020 2020 2020  eturned.        
-00014b10: 6279 203a 6675 6e63 3a60 6f70 656e 6020  by :func:`open` 
-00014b20: 6f72 203a 636c 6173 733a 6069 6f2e 5374  or :class:`io.St
-00014b30: 7269 6e67 494f 602e 2049 6e70 7574 2061  ringIO`. Input a
-00014b40: 7320 696e 7465 6765 7220 3120 746f 0a20  s integer 1 to. 
-00014b50: 2020 2020 2020 2077 7269 7465 2074 6f20         write to 
-00014b60: 7374 646f 7574 2e20 4361 6e20 616c 736f  stdout. Can also
-00014b70: 2062 6520 7468 6520 6e61 6d65 206f 6620   be the name of 
-00014b80: 6120 6469 7265 6374 6f72 7920 6f72 204e  a directory or N
-00014b90: 6f6e 653b 0a20 2020 2020 2020 2069 6e20  one;.        in 
-00014ba0: 7468 6573 6520 6361 7365 732c 2061 2047  these cases, a G
-00014bb0: 5549 2069 7320 6f70 656e 6564 2066 6f72  UI is opened for
-00014bc0: 2066 696c 6520 7365 6c65 6374 696f 6e2e   file selection.
-00014bd0: 0a20 2020 2065 6964 203a 2069 6e74 6567  .    eid : integ
-00014be0: 6572 0a20 2020 2020 2020 2045 6c65 6d65  er.        Eleme
-00014bf0: 6e74 2049 440a 2020 2020 4752 4944 5f64  nt ID.    GRID_d
-00014c00: 6570 203a 2069 6e74 6567 6572 0a20 2020  ep : integer.   
-00014c10: 2020 2020 2044 6570 656e 6465 6e74 2067       Dependent g
-00014c20: 7269 6420 4944 0a20 2020 2044 4f46 5f64  rid ID.    DOF_d
-00014c30: 6570 203a 2069 6e74 6567 6572 0a20 2020  ep : integer.   
-00014c40: 2020 2020 2041 6e20 696e 7465 6765 7220       An integer 
-00014c50: 636f 6e63 6174 656e 6174 696f 6e20 6f66  concatenation of
-00014c60: 2074 6865 2044 4f46 2028 6578 3a20 3132   the DOF (ex: 12
-00014c70: 3334 3536 290a 2020 2020 496e 645f 4c69  3456).    Ind_Li
-00014c80: 7374 203a 206c 6973 740a 2020 2020 2020  st : list.      
-00014c90: 2020 5b20 444f 465f 496e 6431 2c20 4752    [ DOF_Ind1, GR
-00014ca0: 4944 535f 496e 6431 2c20 444f 465f 496e  IDS_Ind1, DOF_In
-00014cb0: 6432 2c20 4752 4944 535f 496e 6432 2c20  d2, GRIDS_Ind2, 
-00014cc0: 2e2e 2e20 5d2c 2077 6865 7265 3a3a 0a0a  ... ], where::..
-00014cd0: 2020 2020 2020 2020 2020 2020 444f 465f              DOF_
-00014ce0: 496e 6431 2020 203a 2031 206f 7220 3220  Ind1   : 1 or 2 
-00014cf0: 656c 656d 656e 7420 6172 7261 795f 6c69  element array_li
-00014d00: 6b65 2063 6f6e 7461 696e 696e 6720 7468  ke containing th
-00014d10: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
-00014d20: 2020 2020 2020 2020 2020 2063 6f6d 706f             compo
-00014d30: 6e65 6e74 2044 4f46 2028 6965 2c20 3132  nent DOF (ie, 12
-00014d40: 3334 3536 2920 6f66 2074 6865 206e 6f64  3456) of the nod
-00014d50: 6573 2069 6e0a 2020 2020 2020 2020 2020  es in.          
-00014d60: 2020 2020 2020 2020 2020 2020 2020 2047                 G
-00014d70: 5249 4453 5f49 6e64 3120 616e 642c 206f  RIDS_Ind1 and, o
-00014d80: 7074 696f 6e61 6c6c 792c 2074 6865 2077  ptionally, the w
-00014d90: 6569 6768 7469 6e67 0a20 2020 2020 2020  eighting.       
-00014da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014db0: 2020 6661 6374 6f72 2066 6f72 2074 6865    factor for the
-00014dc0: 7365 2044 4f46 2e20 4966 206e 6f74 2069  se DOF. If not i
-00014dd0: 6e70 7574 2c20 7468 650a 2020 2020 2020  nput, the.      
-00014de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014df0: 2020 2077 6569 6768 7469 6e67 2066 6163     weighting fac
-00014e00: 746f 7220 6465 6661 756c 7473 2074 6f20  tor defaults to 
-00014e10: 312e 302e 0a20 2020 2020 2020 2020 2020  1.0..           
-00014e20: 2047 5249 4453 5f49 6e64 3120 3a20 6172   GRIDS_Ind1 : ar
-00014e30: 7261 795f 6c69 6b65 206f 6620 6e6f 6465  ray_like of node
-00014e40: 2069 6473 2063 6f72 7265 7370 6f6e 6469   ids correspondi
-00014e50: 6e67 2074 6f0a 2020 2020 2020 2020 2020  ng to.          
-00014e60: 2020 2020 2020 2020 2020 2020 2020 2044                 D
-00014e70: 4f46 5f49 6e64 310a 2020 2020 2020 2020  OF_Ind1.        
-00014e80: 2020 2020 2e2e 2e0a 2020 2020 2020 2020      ....        
-00014e90: 2020 2020 6567 3a20 205b 205b 3132 332c      eg:  [ [123,
-00014ea0: 2031 2e32 5d2c 205b 3935 2c20 3139 352c   1.2], [95, 195,
-00014eb0: 2031 3030 305d 2c20 3132 3334 3536 2c20   1000], 123456, 
-00014ec0: 3935 5d0a 0a20 2020 2020 2020 2060 496e  95]..        `In
-00014ed0: 645f 4c69 7374 6020 6d75 7374 2062 6520  d_List` must be 
-00014ee0: 6576 656e 206c 656e 6774 682e 0a0a 2020  even length...  
-00014ef0: 2020 554d 5f4c 6973 7420 3a20 4e6f 6e65    UM_List : None
-00014f00: 206f 7220 6c69 7374 3b20 6f70 7469 6f6e   or list; option
-00014f10: 616c 0a20 2020 2020 2020 205b 2047 5249  al.        [ GRI
-00014f20: 445f 4d53 4554 312c 2044 4f46 5f4d 5345  D_MSET1, DOF_MSE
-00014f30: 5431 2c20 4752 4944 5f4d 5345 5432 2c20  T1, GRID_MSET2, 
-00014f40: 444f 465f 4d53 4554 322c 202e 2e2e 205d  DOF_MSET2, ... ]
-00014f50: 2077 6865 7265 3a3a 0a0a 2020 2020 2020   where::..      
-00014f60: 2020 2020 2020 2020 4752 4944 5f4d 5345          GRID_MSE
-00014f70: 5431 203a 2066 6972 7374 2067 7269 6420  T1 : first grid 
-00014f80: 696e 2074 6865 204d 2d73 6574 0a20 2020  in the M-set.   
-00014f90: 2020 2020 2020 2020 2020 2044 4f46 5f4d             DOF_M
-00014fa0: 5345 5431 2020 3a20 444f 4620 6f66 2066  SET1  : DOF of f
-00014fb0: 6972 7374 2067 7269 6420 696e 204d 2d73  irst grid in M-s
-00014fc0: 6574 2028 696e 7465 6765 7220 7375 6273  et (integer subs
-00014fd0: 6574 0a20 2020 2020 2020 2020 2020 2020  et.             
-00014fe0: 2020 2020 2020 2020 2020 2020 2020 6f66                of
-00014ff0: 2031 3233 3435 3629 2e20 4e6f 2077 6569   123456). No wei
-00015000: 6768 7469 6e67 2066 6163 746f 7273 2061  ghting factors a
-00015010: 7265 0a20 2020 2020 2020 2020 2020 2020  re.             
-00015020: 2020 2020 2020 2020 2020 2020 2020 616c                al
-00015030: 6c6f 7765 6420 6865 7265 2e0a 2020 2020  lowed here..    
-00015040: 2020 2020 2020 2020 2020 4752 4944 5f4d            GRID_M
-00015050: 5345 5432 203a 2073 6563 6f6e 6420 6772  SET2 : second gr
-00015060: 6964 2069 6e20 7468 6520 4d2d 7365 740a  id in the M-set.
-00015070: 2020 2020 2020 2020 2020 2020 2020 444f                DO
-00015080: 465f 4d53 4554 3220 203a 2044 4f46 206f  F_MSET2  : DOF o
-00015090: 6620 7365 636f 6e64 2067 7269 6420 696e  f second grid in
-000150a0: 204d 2d73 6574 0a20 2020 2020 2020 2020   M-set.         
-000150b0: 2020 2020 202e 2e2e 0a0a 2020 2020 616c       .....    al
-000150c0: 7068 6120 3a20 4e6f 6e65 206f 7220 7374  pha : None or st
-000150d0: 7269 6e67 3b20 6f70 7469 6f6e 616c 0a20  ring; optional. 
-000150e0: 2020 2020 2020 2054 6865 726d 616c 2065         Thermal e
-000150f0: 7870 616e 7369 6f6e 2063 6f65 6666 6963  xpansion coeffic
-00015100: 6965 6e74 2069 6e20 6120 382d 6368 6172  ient in a 8-char
-00015110: 2073 7472 696e 6720 286f 7220 6c65 7373   string (or less
-00015120: 292e 0a0a 2020 2020 5265 7475 726e 730a  )...    Returns.
-00015130: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
-00015140: 4e6f 6e65 0a0a 2020 2020 4578 616d 706c  None..    Exampl
-00015150: 6573 0a20 2020 202d 2d2d 2d2d 2d2d 2d0a  es.    --------.
-00015160: 2020 2020 3e3e 3e20 6672 6f6d 2070 7979      >>> from pyy
-00015170: 6574 6920 696d 706f 7274 206e 6173 7472  eti import nastr
-00015180: 616e 0a20 2020 203e 3e3e 206e 6173 7472  an.    >>> nastr
-00015190: 616e 2e77 7472 6265 3328 312c 2031 3030  an.wtrbe3(1, 100
-000151a0: 2c20 3939 3030 2c20 3132 3334 3536 2c0a  , 9900, 123456,.
-000151b0: 2020 2020 2e2e 2e20 2020 2020 2020 2020      ...         
-000151c0: 2020 2020 2020 205b 3132 332c 205b 3939         [123, [99
-000151d0: 3031 2c20 3939 3032 2c20 3939 3033 2c20  01, 9902, 9903, 
-000151e0: 3939 3034 5d2c 0a20 2020 202e 2e2e 2020  9904],.    ...  
-000151f0: 2020 2020 2020 2020 2020 2020 2020 2031                 1
-00015200: 3233 3435 362c 205b 3435 3030 3031 2c20  23456, [450001, 
-00015210: 3230 305d 5d29 0a20 2020 2052 4245 3320  200]]).    RBE3 
-00015220: 2020 2020 2020 2020 3130 3020 2020 2020          100     
-00015230: 2020 2020 2020 2039 3930 3020 2031 3233         9900  123
-00015240: 3435 3620 2020 312e 3030 3020 2020 2020  456   1.000     
-00015250: 3132 3320 2020 2039 3930 3120 2020 2039  123    9901    9
-00015260: 3930 320a 2020 2020 2020 2020 2020 2020  902.            
-00015270: 2020 2020 3939 3033 2020 2020 3939 3034      9903    9904
-00015280: 2020 2031 2e30 3030 2020 3132 3334 3536     1.000  123456
-00015290: 2020 3435 3030 3031 2020 2020 2032 3030    450001     200
-000152a0: 0a20 2020 203e 3e3e 206e 6173 7472 616e  .    >>> nastran
-000152b0: 2e77 7472 6265 3328 312c 2031 3030 2c20  .wtrbe3(1, 100, 
-000152c0: 3939 3030 2c20 3132 3334 3536 2c0a 2020  9900, 123456,.  
-000152d0: 2020 2e2e 2e20 2020 2020 2020 2020 2020    ...           
-000152e0: 2020 2020 205b 3132 332c 205b 3939 3031       [123, [9901
-000152f0: 2c20 3939 3032 2c20 3939 3033 2c20 3939  , 9902, 9903, 99
-00015300: 3034 5d2c 0a20 2020 202e 2e2e 2020 2020  04],.    ...    
-00015310: 2020 2020 2020 2020 2020 2020 205b 3132               [12
-00015320: 3334 3536 2c20 312e 325d 2c20 5b34 3530  3456, 1.2], [450
-00015330: 3030 312c 2032 3030 5d5d 2c0a 2020 2020  001, 200]],.    
-00015340: 2e2e 2e20 2020 2020 2020 2020 2020 2020  ...             
-00015350: 2020 2055 4d5f 4c69 7374 3d5b 3939 3031     UM_List=[9901
-00015360: 2c20 3132 2c20 3939 3032 2c20 332c 2039  , 12, 9902, 3, 9
-00015370: 3930 332c 2031 322c 2039 3930 342c 2033  903, 12, 9904, 3
-00015380: 5d2c 0a20 2020 202e 2e2e 2020 2020 2020  ],.    ...      
-00015390: 2020 2020 2020 2020 2020 616c 7068 613d            alpha=
-000153a0: 2736 2e35 652d 3627 290a 2020 2020 5242  '6.5e-6').    RB
-000153b0: 4533 2020 2020 2020 2020 2031 3030 2020  E3         100  
-000153c0: 2020 2020 2020 2020 2020 3939 3030 2020            9900  
-000153d0: 3132 3334 3536 2020 2031 2e30 3030 2020  123456   1.000  
-000153e0: 2020 2031 3233 2020 2020 3939 3031 2020     123    9901  
-000153f0: 2020 3939 3032 0a20 2020 2020 2020 2020    9902.         
-00015400: 2020 2020 2020 2039 3930 3320 2020 2039         9903    9
-00015410: 3930 3420 2020 312e 3230 3020 2031 3233  904   1.200  123
-00015420: 3435 3620 2034 3530 3030 3120 2020 2020  456  450001     
-00015430: 3230 300a 2020 2020 2020 2020 2020 2020  200.            
-00015440: 554d 2020 2020 2020 2020 2020 3939 3031  UM          9901
-00015450: 2020 2020 2020 3132 2020 2020 3939 3032        12    9902
-00015460: 2020 2020 2020 2033 2020 2020 3939 3033         3    9903
-00015470: 2020 2020 2020 3132 0a20 2020 2020 2020        12.       
-00015480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015490: 2039 3930 3420 2020 2020 2020 330a 2020   9904       3.  
-000154a0: 2020 2020 2020 2020 2020 414c 5048 4120            ALPHA 
-000154b0: 2020 2020 362e 3565 2d36 0a20 2020 2022      6.5e-6.    "
-000154c0: 2222 0a20 2020 2069 6620 6c65 6e28 496e  "".    if len(In
-000154d0: 645f 4c69 7374 2920 2620 313a 0a20 2020  d_List) & 1:.   
-000154e0: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-000154f0: 4572 726f 7228 6622 6049 6e64 5f4c 6973  Error(f"`Ind_Lis
-00015500: 7460 206d 7573 7420 6861 7665 2065 7665  t` must have eve
-00015510: 6e20 6c65 6e67 7468 2028 6974 2069 7320  n length (it is 
-00015520: 7b6c 656e 2849 6e64 5f4c 6973 7429 7d29  {len(Ind_List)})
-00015530: 2229 0a0a 2020 2020 662e 7772 6974 6528  ")..    f.write(
-00015540: 6622 5242 4533 2020 2020 7b65 6964 3a38  f"RBE3    {eid:8
-00015550: 647d 2020 2020 2020 2020 7b47 5249 445f  d}        {GRID_
-00015560: 6465 703a 3864 7d7b 444f 465f 6465 703a  dep:8d}{DOF_dep:
-00015570: 3864 7d22 290a 2020 2020 6669 656c 6420  8d}").    field 
-00015580: 3d20 350a 0a20 2020 2064 6566 205f 496e  = 5..    def _In
-00015590: 635f 4669 656c 6428 662c 2066 6965 6c64  c_Field(f, field
-000155a0: 293a 0a20 2020 2020 2020 2066 6965 6c64  ):.        field
-000155b0: 202b 3d20 310a 2020 2020 2020 2020 6966   += 1.        if
-000155c0: 2066 6965 6c64 203d 3d20 3130 3a0a 2020   field == 10:.  
-000155d0: 2020 2020 2020 2020 2020 662e 7772 6974            f.writ
-000155e0: 6528 225c 6e20 2020 2020 2020 2022 290a  e("\n        ").
-000155f0: 2020 2020 2020 2020 2020 2020 6669 656c              fiel
-00015600: 6420 3d20 320a 2020 2020 2020 2020 7265  d = 2.        re
-00015610: 7475 726e 2066 6965 6c64 0a0a 2020 2020  turn field..    
-00015620: 2320 6c6f 6f70 206f 7665 7220 696e 6465  # loop over inde
-00015630: 7065 6e64 656e 7473 0a20 2020 2066 6f72  pendents.    for
-00015640: 206a 2069 6e20 7261 6e67 6528 302c 206c   j in range(0, l
-00015650: 656e 2849 6e64 5f4c 6973 7429 2c20 3229  en(Ind_List), 2)
-00015660: 3a0a 2020 2020 2020 2020 444f 465f 696e  :.        DOF_in
-00015670: 6420 3d20 6e70 2e61 746c 6561 7374 5f31  d = np.atleast_1
-00015680: 6428 496e 645f 4c69 7374 5b6a 5d29 0a20  d(Ind_List[j]). 
-00015690: 2020 2020 2020 2047 5249 4453 5f69 6e64         GRIDS_ind
-000156a0: 203d 206e 702e 6174 6c65 6173 745f 3164   = np.atleast_1d
-000156b0: 2849 6e64 5f4c 6973 745b 6a20 2b20 315d  (Ind_List[j + 1]
-000156c0: 290a 2020 2020 2020 2020 646f 6620 3d20  ).        dof = 
-000156d0: 696e 7428 444f 465f 696e 645b 305d 290a  int(DOF_ind[0]).
-000156e0: 2020 2020 2020 2020 6966 206c 656e 2844          if len(D
-000156f0: 4f46 5f69 6e64 2920 3d3d 2032 3a0a 2020  OF_ind) == 2:.  
-00015700: 2020 2020 2020 2020 2020 7774 203d 2066            wt = f
-00015710: 6c6f 6174 2844 4f46 5f69 6e64 5b31 5d29  loat(DOF_ind[1])
-00015720: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-00015730: 2020 2020 2020 2020 2020 2077 7420 3d20             wt = 
-00015740: 312e 300a 2020 2020 2020 2020 6669 656c  1.0.        fiel
-00015750: 6420 3d20 5f49 6e63 5f46 6965 6c64 2866  d = _Inc_Field(f
-00015760: 2c20 6669 656c 6429 0a20 2020 2020 2020  , field).       
-00015770: 2066 2e77 7269 7465 2866 227b 7774 3a38   f.write(f"{wt:8
-00015780: 2e33 667d 2229 0a20 2020 2020 2020 2066  .3f}").        f
-00015790: 6965 6c64 203d 205f 496e 635f 4669 656c  ield = _Inc_Fiel
-000157a0: 6428 662c 2066 6965 6c64 290a 2020 2020  d(f, field).    
-000157b0: 2020 2020 662e 7772 6974 6528 6622 7b64      f.write(f"{d
-000157c0: 6f66 3a38 647d 2229 0a20 2020 2020 2020  of:8d}").       
-000157d0: 2066 6f72 2067 2069 6e20 4752 4944 535f   for g in GRIDS_
-000157e0: 696e 643a 0a20 2020 2020 2020 2020 2020  ind:.           
-000157f0: 2066 6965 6c64 203d 205f 496e 635f 4669   field = _Inc_Fi
-00015800: 656c 6428 662c 2066 6965 6c64 290a 2020  eld(f, field).  
-00015810: 2020 2020 2020 2020 2020 662e 7772 6974            f.writ
-00015820: 6528 6622 7b67 3a38 647d 2229 0a20 2020  e(f"{g:8d}").   
-00015830: 2066 2e77 7269 7465 2822 5c6e 2229 0a0a   f.write("\n")..
-00015840: 2020 2020 6465 6620 5f49 6e63 5f55 4d5f      def _Inc_UM_
-00015850: 4669 656c 6428 662c 2066 6965 6c64 293a  Field(f, field):
-00015860: 0a20 2020 2020 2020 2066 6965 6c64 202b  .        field +
-00015870: 3d20 310a 2020 2020 2020 2020 6966 2066  = 1.        if f
-00015880: 6965 6c64 203d 3d20 393a 0a20 2020 2020  ield == 9:.     
-00015890: 2020 2020 2020 2066 2e77 7269 7465 2822         f.write("
-000158a0: 5c6e 2020 2020 2020 2020 2020 2020 2020  \n              
-000158b0: 2020 2229 0a20 2020 2020 2020 2020 2020    ").           
-000158c0: 2066 6965 6c64 203d 2033 0a20 2020 2020   field = 3.     
-000158d0: 2020 2072 6574 7572 6e20 6669 656c 640a     return field.
-000158e0: 0a20 2020 2069 6620 554d 5f4c 6973 7420  .    if UM_List 
-000158f0: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
-00015900: 2020 2020 2066 2e77 7269 7465 2822 2020       f.write("  
-00015910: 2020 2020 2020 554d 2020 2020 2020 2229        UM      ")
-00015920: 0a20 2020 2020 2020 2066 6965 6c64 203d  .        field =
-00015930: 2032 0a20 2020 2020 2020 2066 6f72 206a   2.        for j
-00015940: 2069 6e20 554d 5f4c 6973 743a 0a20 2020   in UM_List:.   
-00015950: 2020 2020 2020 2020 2066 6965 6c64 203d           field =
-00015960: 205f 496e 635f 554d 5f46 6965 6c64 2866   _Inc_UM_Field(f
-00015970: 2c20 6669 656c 6429 0a20 2020 2020 2020  , field).       
-00015980: 2020 2020 2066 2e77 7269 7465 2822 7b3a       f.write("{:
-00015990: 3864 7d22 2e66 6f72 6d61 7428 6a29 290a  8d}".format(j)).
-000159a0: 2020 2020 2020 2020 662e 7772 6974 6528          f.write(
-000159b0: 225c 6e22 290a 0a20 2020 2069 6620 616c  "\n")..    if al
-000159c0: 7068 6120 6973 206e 6f74 204e 6f6e 653a  pha is not None:
-000159d0: 0a20 2020 2020 2020 2066 2e77 7269 7465  .        f.write
-000159e0: 2866 2220 2020 2020 2020 2041 4c50 4841  (f"        ALPHA
-000159f0: 2020 207b 616c 7068 613a 3e38 737d 5c6e     {alpha:>8s}\n
-00015a00: 2229 0a0a 0a40 6775 6974 6f6f 6c73 2e77  ")...@guitools.w
-00015a10: 7269 7465 5f74 6578 745f 6669 6c65 0a64  rite_text_file.d
-00015a20: 6566 2077 7473 6573 6574 2866 2c20 7375  ef wtseset(f, su
-00015a30: 7065 7269 642c 2067 7269 6473 293a 0a20  perid, grids):. 
-00015a40: 2020 2022 2222 0a20 2020 2057 7269 7465     """.    Write
-00015a50: 7320 6120 4e61 7374 7261 6e20 5345 5345  s a Nastran SESE
-00015a60: 5420 6361 7264 2074 6f20 6120 6669 6c65  T card to a file
-00015a70: 2e0a 0a20 2020 2050 6172 616d 6574 6572  ...    Parameter
-00015a80: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  s.    ----------
-00015a90: 0a20 2020 2066 203a 2073 7472 696e 6720  .    f : string 
-00015aa0: 6f72 2066 696c 655f 6c69 6b65 206f 7220  or file_like or 
-00015ab0: 3120 6f72 204e 6f6e 650a 2020 2020 2020  1 or None.      
-00015ac0: 2020 4569 7468 6572 2061 206e 616d 6520    Either a name 
-00015ad0: 6f66 2061 2066 696c 652c 206f 7220 6973  of a file, or is
-00015ae0: 2061 2066 696c 655f 6c69 6b65 206f 626a   a file_like obj
-00015af0: 6563 7420 6173 2072 6574 7572 6e65 640a  ect as returned.
-00015b00: 2020 2020 2020 2020 6279 203a 6675 6e63          by :func
-00015b10: 3a60 6f70 656e 6020 6f72 203a 636c 6173  :`open` or :clas
-00015b20: 733a 6069 6f2e 5374 7269 6e67 494f 602e  s:`io.StringIO`.
-00015b30: 2049 6e70 7574 2061 7320 696e 7465 6765   Input as intege
-00015b40: 7220 3120 746f 0a20 2020 2020 2020 2077  r 1 to.        w
-00015b50: 7269 7465 2074 6f20 7374 646f 7574 2e20  rite to stdout. 
-00015b60: 4361 6e20 616c 736f 2062 6520 7468 6520  Can also be the 
-00015b70: 6e61 6d65 206f 6620 6120 6469 7265 6374  name of a direct
-00015b80: 6f72 7920 6f72 204e 6f6e 653b 0a20 2020  ory or None;.   
-00015b90: 2020 2020 2069 6e20 7468 6573 6520 6361       in these ca
-00015ba0: 7365 732c 2061 2047 5549 2069 7320 6f70  ses, a GUI is op
-00015bb0: 656e 6564 2066 6f72 2066 696c 6520 7365  ened for file se
-00015bc0: 6c65 6374 696f 6e2e 0a20 2020 2073 7570  lection..    sup
-00015bd0: 6572 6964 3a20 696e 7465 6765 720a 2020  erid: integer.  
-00015be0: 2020 2020 2020 5375 7065 7265 6c65 6d65        Supereleme
-00015bf0: 6e74 2049 440a 2020 2020 6772 6964 7320  nt ID.    grids 
-00015c00: 3a20 3164 2061 7272 6179 5f6c 696b 650a  : 1d array_like.
-00015c10: 2020 2020 2020 2020 5665 6374 6f72 206f          Vector o
-00015c20: 6620 6772 6964 2069 6473 2e0a 0a20 2020  f grid ids...   
-00015c30: 2052 6574 7572 6e73 0a20 2020 202d 2d2d   Returns.    ---
-00015c40: 2d2d 2d2d 0a20 2020 204e 6f6e 650a 0a20  ----.    None.. 
-00015c50: 2020 2045 7861 6d70 6c65 730a 2020 2020     Examples.    
-00015c60: 2d2d 2d2d 2d2d 2d2d 0a20 2020 203e 3e3e  --------.    >>>
-00015c70: 2066 726f 6d20 7079 7965 7469 2069 6d70   from pyyeti imp
-00015c80: 6f72 7420 6e61 7374 7261 6e0a 2020 2020  ort nastran.    
-00015c90: 3e3e 3e20 696d 706f 7274 206e 756d 7079  >>> import numpy
-00015ca0: 2061 7320 6e70 0a20 2020 203e 3e3e 206e   as np.    >>> n
-00015cb0: 6173 7472 616e 2e77 7473 6573 6574 2831  astran.wtseset(1
-00015cc0: 2c20 3130 302c 206e 702e 6172 616e 6765  , 100, np.arange
-00015cd0: 2831 2c20 3236 2929 0a20 2020 2053 4553  (1, 26)).    SES
-00015ce0: 4554 2020 2020 2020 2020 3130 3020 2020  ET        100   
-00015cf0: 2020 2020 3120 2020 2020 2020 3220 2020      1       2   
-00015d00: 2020 2020 3320 2020 2020 2020 3420 2020      3       4   
-00015d10: 2020 2020 3520 2020 2020 2020 3620 2020      5       6   
-00015d20: 2020 2020 370a 2020 2020 5345 5345 5420      7.    SESET 
-00015d30: 2020 2020 2020 2031 3030 2020 2020 2020         100      
-00015d40: 2038 2020 2020 2020 2039 2020 2020 2020   8       9      
-00015d50: 3130 2020 2020 2020 3131 2020 2020 2020  10      11      
-00015d60: 3132 2020 2020 2020 3133 2020 2020 2020  12      13      
-00015d70: 3134 0a20 2020 2053 4553 4554 2020 2020  14.    SESET    
-00015d80: 2020 2020 3130 3020 2020 2020 2031 3520      100      15 
-00015d90: 2020 2020 2031 3620 2020 2020 2031 3720       16      17 
-00015da0: 2020 2020 2031 3820 2020 2020 2031 3920       18      19 
-00015db0: 2020 2020 2032 3020 2020 2020 2032 310a       20      21.
-00015dc0: 2020 2020 5345 5345 5420 2020 2020 2020      SESET       
-00015dd0: 2031 3030 2020 2020 2020 3232 2020 2020   100      22    
-00015de0: 2020 3233 2020 2020 2020 3234 2020 2020    23      24    
-00015df0: 2020 3235 0a20 2020 2022 2222 0a20 2020    25.    """.   
-00015e00: 206e 203d 206c 656e 2867 7269 6473 290a   n = len(grids).
-00015e10: 2020 2020 2320 3720 6772 6964 7320 7065      # 7 grids pe
-00015e20: 7220 5345 5345 543a 0a20 2020 2066 726d  r SESET:.    frm
-00015e30: 203d 2022 5345 5345 5420 2020 7b3a 3864   = "SESET   {:8d
-00015e40: 7d22 202b 2022 7b3a 3864 7d22 202a 2037  }" + "{:8d}" * 7
-00015e50: 202b 2022 5c6e 220a 2020 2020 6920 3d20   + "\n".    i = 
-00015e60: 300a 2020 2020 7768 696c 6520 6920 2b20  0.    while i + 
-00015e70: 3720 3c3d 206e 3a0a 2020 2020 2020 2020  7 <= n:.        
-00015e80: 662e 7772 6974 6528 6672 6d2e 666f 726d  f.write(frm.form
-00015e90: 6174 2873 7570 6572 6964 2c20 2a67 7269  at(superid, *gri
-00015ea0: 6473 5b69 203a 2069 202b 2037 5d29 290a  ds[i : i + 7])).
-00015eb0: 2020 2020 2020 2020 6920 2b3d 2037 0a20          i += 7. 
-00015ec0: 2020 2069 6620 6920 3c20 6e3a 0a20 2020     if i < n:.   
-00015ed0: 2020 2020 2066 726d 203d 2022 5345 5345       frm = "SESE
-00015ee0: 5420 2020 7b3a 3864 7d22 202b 2022 7b3a  T   {:8d}" + "{:
-00015ef0: 3864 7d22 202a 2028 6e20 2d20 6929 202b  8d}" * (n - i) +
-00015f00: 2022 5c6e 220a 2020 2020 2020 2020 662e   "\n".        f.
-00015f10: 7772 6974 6528 6672 6d2e 666f 726d 6174  write(frm.format
-00015f20: 2873 7570 6572 6964 2c20 2a67 7269 6473  (superid, *grids
-00015f30: 5b69 3a5d 2929 0a0a 0a40 6775 6974 6f6f  [i:]))...@guitoo
-00015f40: 6c73 2e77 7269 7465 5f74 6578 745f 6669  ls.write_text_fi
-00015f50: 6c65 0a64 6566 2077 7473 6574 2866 2c20  le.def wtset(f, 
-00015f60: 7365 7469 642c 2069 6473 293a 0a20 2020  setid, ids):.   
-00015f70: 2022 2222 0a20 2020 2057 7269 7465 7320   """.    Writes 
-00015f80: 6120 4e61 7374 7261 6e20 6361 7365 2d63  a Nastran case-c
-00015f90: 6f6e 7472 6f6c 2053 4554 2063 6172 6420  ontrol SET card 
-00015fa0: 746f 2061 2066 696c 652e 0a0a 2020 2020  to a file...    
-00015fb0: 5061 7261 6d65 7465 7273 0a20 2020 202d  Parameters.    -
-00015fc0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 6620  ---------.    f 
-00015fd0: 3a20 7374 7269 6e67 206f 7220 6669 6c65  : string or file
-00015fe0: 5f6c 696b 6520 6f72 2031 206f 7220 4e6f  _like or 1 or No
-00015ff0: 6e65 0a20 2020 2020 2020 2045 6974 6865  ne.        Eithe
-00016000: 7220 6120 6e61 6d65 206f 6620 6120 6669  r a name of a fi
-00016010: 6c65 2c20 6f72 2069 7320 6120 6669 6c65  le, or is a file
-00016020: 5f6c 696b 6520 6f62 6a65 6374 2061 7320  _like object as 
-00016030: 7265 7475 726e 6564 0a20 2020 2020 2020  returned.       
-00016040: 2062 7920 3a66 756e 633a 606f 7065 6e60   by :func:`open`
-00016050: 206f 7220 3a63 6c61 7373 3a60 696f 2e53   or :class:`io.S
-00016060: 7472 696e 6749 4f60 2e20 496e 7075 7420  tringIO`. Input 
-00016070: 6173 2069 6e74 6567 6572 2031 2074 6f0a  as integer 1 to.
-00016080: 2020 2020 2020 2020 7772 6974 6520 746f          write to
-00016090: 2073 7464 6f75 742e 2043 616e 2061 6c73   stdout. Can als
-000160a0: 6f20 6265 2074 6865 206e 616d 6520 6f66  o be the name of
-000160b0: 2061 2064 6972 6563 746f 7279 206f 7220   a directory or 
-000160c0: 4e6f 6e65 3b0a 2020 2020 2020 2020 696e  None;.        in
-000160d0: 2074 6865 7365 2063 6173 6573 2c20 6120   these cases, a 
-000160e0: 4755 4920 6973 206f 7065 6e65 6420 666f  GUI is opened fo
-000160f0: 7220 6669 6c65 2073 656c 6563 7469 6f6e  r file selection
-00016100: 2e0a 2020 2020 7365 7469 643a 2069 6e74  ..    setid: int
-00016110: 6567 6572 0a20 2020 2020 2020 2053 6574  eger.        Set
-00016120: 2049 440a 2020 2020 6964 7320 3a20 3164   ID.    ids : 1d
-00016130: 2061 7272 6179 5f6c 696b 650a 2020 2020   array_like.    
-00016140: 2020 2020 5665 6374 6f72 206f 6620 4944      Vector of ID
-00016150: 730a 0a20 2020 2052 6574 7572 6e73 0a20  s..    Returns. 
-00016160: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 204e     -------.    N
-00016170: 6f6e 650a 0a20 2020 2045 7861 6d70 6c65  one..    Example
-00016180: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20  s.    --------. 
-00016190: 2020 203e 3e3e 2066 726f 6d20 7079 7965     >>> from pyye
-000161a0: 7469 2069 6d70 6f72 7420 6e61 7374 7261  ti import nastra
-000161b0: 6e0a 2020 2020 3e3e 3e20 696d 706f 7274  n.    >>> import
-000161c0: 206e 756d 7079 2061 7320 6e70 0a20 2020   numpy as np.   
-000161d0: 203e 3e3e 206e 6173 7472 616e 2e77 7473   >>> nastran.wts
-000161e0: 6574 2831 2c20 3130 302c 206e 702e 6172  et(1, 100, np.ar
-000161f0: 616e 6765 2831 2c20 3236 2929 0a20 2020  ange(1, 26)).   
-00016200: 2053 4554 2031 3030 203d 2031 2c20 322c   SET 100 = 1, 2,
-00016210: 2033 2c20 342c 2035 2c20 362c 2037 2c0a   3, 4, 5, 6, 7,.
-00016220: 2020 2020 2038 2c20 392c 2031 302c 2031       8, 9, 10, 1
-00016230: 312c 2031 322c 2031 332c 2031 342c 0a20  1, 12, 13, 14,. 
-00016240: 2020 2020 3135 2c20 3136 2c20 3137 2c20      15, 16, 17, 
-00016250: 3138 2c20 3139 2c20 3230 2c20 3231 2c0a  18, 19, 20, 21,.
-00016260: 2020 2020 2032 322c 2032 332c 2032 342c       22, 23, 24,
-00016270: 2032 350a 2020 2020 2222 220a 2020 2020   25.    """.    
-00016280: 662e 7772 6974 6528 6622 5345 5420 7b73  f.write(f"SET {s
-00016290: 6574 6964 7d20 3d22 290a 2020 2020 6e20  etid} =").    n 
-000162a0: 3d20 6c65 6e28 6964 7329 0a20 2020 2023  = len(ids).    #
-000162b0: 2037 2069 6473 2070 6572 206c 696e 653a   7 ids per line:
-000162c0: 0a20 2020 2066 726d 203d 2022 207b 3a64  .    frm = " {:d
-000162d0: 7d2c 2220 2a20 3720 2b20 225c 6e22 0a20  }," * 7 + "\n". 
-000162e0: 2020 2069 203d 2030 0a20 2020 2077 6869     i = 0.    whi
-000162f0: 6c65 2069 202b 2037 203c 206e 3a0a 2020  le i + 7 < n:.  
-00016300: 2020 2020 2020 662e 7772 6974 6528 6672        f.write(fr
-00016310: 6d2e 666f 726d 6174 282a 6964 735b 6920  m.format(*ids[i 
-00016320: 3a20 6920 2b20 375d 2929 0a20 2020 2020  : i + 7])).     
-00016330: 2020 2069 202b 3d20 370a 2020 2020 6672     i += 7.    fr
-00016340: 6d20 3d20 2220 7b3a 647d 2c22 202a 2028  m = " {:d}," * (
-00016350: 6e20 2d20 6920 2d20 3129 202b 2022 207b  n - i - 1) + " {
-00016360: 3a64 7d5c 6e22 0a20 2020 2066 2e77 7269  :d}\n".    f.wri
-00016370: 7465 2866 726d 2e66 6f72 6d61 7428 2a69  te(frm.format(*i
-00016380: 6473 5b69 3a5d 2929 0a0a 0a40 6775 6974  ds[i:]))...@guit
-00016390: 6f6f 6c73 2e77 7269 7465 5f74 6578 745f  ools.write_text_
-000163a0: 6669 6c65 0a64 6566 2077 7472 7370 6c69  file.def wtrspli
-000163b0: 6e65 2866 2c20 7269 642c 2069 6473 2c20  ne(f, rid, ids, 
-000163c0: 446f 4c3d 2230 2e31 2229 3a0a 2020 2020  DoL="0.1"):.    
-000163d0: 2222 220a 2020 2020 5772 6974 6520 4e61  """.    Write Na
-000163e0: 7374 7261 6e20 5253 504c 494e 4520 6361  stran RSPLINE ca
-000163f0: 7264 2873 292e 0a0a 2020 2020 5061 7261  rd(s)...    Para
-00016400: 6d65 7465 7273 0a20 2020 202d 2d2d 2d2d  meters.    -----
-00016410: 2d2d 2d2d 2d0a 2020 2020 6620 3a20 7374  -----.    f : st
-00016420: 7269 6e67 206f 7220 6669 6c65 5f6c 696b  ring or file_lik
-00016430: 6520 6f72 2031 206f 7220 4e6f 6e65 0a20  e or 1 or None. 
-00016440: 2020 2020 2020 2045 6974 6865 7220 6120         Either a 
-00016450: 6e61 6d65 206f 6620 6120 6669 6c65 2c20  name of a file, 
-00016460: 6f72 2069 7320 6120 6669 6c65 5f6c 696b  or is a file_lik
-00016470: 6520 6f62 6a65 6374 2061 7320 7265 7475  e object as retu
-00016480: 726e 6564 0a20 2020 2020 2020 2062 7920  rned.        by 
-00016490: 3a66 756e 633a 606f 7065 6e60 206f 7220  :func:`open` or 
-000164a0: 3a63 6c61 7373 3a60 696f 2e53 7472 696e  :class:`io.Strin
-000164b0: 6749 4f60 2e20 496e 7075 7420 6173 2069  gIO`. Input as i
-000164c0: 6e74 6567 6572 2031 2074 6f0a 2020 2020  nteger 1 to.    
-000164d0: 2020 2020 7772 6974 6520 746f 2073 7464      write to std
-000164e0: 6f75 742e 2043 616e 2061 6c73 6f20 6265  out. Can also be
-000164f0: 2074 6865 206e 616d 6520 6f66 2061 2064   the name of a d
-00016500: 6972 6563 746f 7279 206f 7220 4e6f 6e65  irectory or None
-00016510: 3b0a 2020 2020 2020 2020 696e 2074 6865  ;.        in the
-00016520: 7365 2063 6173 6573 2c20 6120 4755 4920  se cases, a GUI 
-00016530: 6973 206f 7065 6e65 6420 666f 7220 6669  is opened for fi
-00016540: 6c65 2073 656c 6563 7469 6f6e 2e0a 2020  le selection..  
-00016550: 2020 7269 6420 3a20 696e 7465 6765 720a    rid : integer.
-00016560: 2020 2020 2020 2020 4944 2066 6f72 2031          ID for 1
-00016570: 7374 2052 5350 4c49 4e45 3b20 6765 7473  st RSPLINE; gets
-00016580: 2069 6e63 7265 6d65 6e74 6564 2062 7920   incremented by 
-00016590: 3120 666f 7220 6561 6368 2052 5350 4c49  1 for each RSPLI
-000165a0: 4e45 0a20 2020 2069 6473 203a 2032 6420  NE.    ids : 2d 
-000165b0: 6172 7261 795f 6c69 6b65 0a20 2020 2020  array_like.     
-000165c0: 2020 2032 2063 6f6c 756d 6e20 6d61 7472     2 column matr
-000165d0: 6978 3a20 5b67 7269 645f 6964 732c 2069  ix: [grid_ids, i
-000165e0: 6e64 6570 656e 6465 6e74 5f66 6c61 675d  ndependent_flag]
-000165f0: 3b20 6861 7320 6772 6964 7320 666f 720a  ; has grids for.
-00016600: 2020 2020 2020 2020 5253 504c 494e 4520          RSPLINE 
-00016610: 696e 2064 6573 6972 6564 206f 7264 6572  in desired order
-00016620: 2061 6e64 2061 2030 206f 7220 3120 666c   and a 0 or 1 fl
-00016630: 6167 2066 6f72 2065 6163 6820 7768 6572  ag for each wher
-00016640: 6520 310a 2020 2020 2020 2020 6d65 616e  e 1.        mean
-00016650: 7320 7468 6520 6772 6964 2069 7320 696e  s the grid is in
-00016660: 6465 7065 6e64 656e 742e 204e 6f74 653a  dependent. Note:
-00016670: 2074 6865 2031 7374 2061 6e64 206c 6173   the 1st and las
-00016680: 7420 6772 6964 730a 2020 2020 2020 2020  t grids.        
-00016690: 6d75 7374 2062 6520 696e 6465 7065 6e64  must be independ
-000166a0: 656e 742e 0a20 2020 2044 6f4c 203a 2073  ent..    DoL : s
-000166b0: 7472 696e 6720 6f72 2072 6561 6c20 7363  tring or real sc
-000166c0: 616c 6172 0a20 2020 2020 2020 2053 7065  alar.        Spe
-000166d0: 6369 6669 6573 2072 6174 696f 206f 6620  cifies ratio of 
-000166e0: 6469 616d 6574 6572 206f 6620 656c 6173  diameter of elas
-000166f0: 7469 6320 7475 6265 2074 6f20 7468 6520  tic tube to the 
-00016700: 7375 6d20 6f66 2074 6865 0a20 2020 2020  sum of the.     
-00016710: 2020 206c 656e 6774 6873 206f 6620 616c     lengths of al
-00016720: 6c20 7365 676d 656e 7473 2e20 5772 6974  l segments. Writ
-00016730: 7465 6e20 7769 7468 3a20 6060 6627 7b44  ten with: ``f'{D
-00016740: 6f4c 3a3c 387d 2760 600a 0a20 2020 2052  oL:<8}'``..    R
-00016750: 6574 7572 6e73 0a20 2020 202d 2d2d 2d2d  eturns.    -----
-00016760: 2d2d 0a20 2020 204e 6f6e 650a 0a20 2020  --.    None..   
-00016770: 204e 6f74 6573 0a20 2020 202d 2d2d 2d2d   Notes.    -----
-00016780: 0a20 2020 2054 6865 2052 5350 4c49 4e45  .    The RSPLINE
-00016790: 7320 7769 6c6c 2066 6f6c 6c6f 7720 7468  s will follow th
-000167a0: 6973 2070 6174 7465 726e 3a3a 0a0a 2020  is pattern::..  
-000167b0: 2020 2020 2020 5253 504c 494e 4531 2020        RSPLINE1  
-000167c0: 696e 6465 7065 6e64 656e 7431 202d 2064  independent1 - d
-000167d0: 6570 656e 6465 6e74 7331 202d 2069 6e64  ependents1 - ind
-000167e0: 6570 656e 6465 6e74 320a 2020 2020 2020  ependent2.      
-000167f0: 2020 5253 504c 494e 4532 2020 696e 6465    RSPLINE2  inde
-00016800: 7065 6e64 656e 7432 202d 2064 6570 656e  pendent2 - depen
-00016810: 6465 6e74 7332 202d 2069 6e64 6570 656e  dents2 - indepen
-00016820: 6465 6e74 330a 2020 2020 2020 2020 2e2e  dent3.        ..
-00016830: 2e0a 0a20 2020 204e 6f74 6520 7468 6174  ...    Note that
-00016840: 2074 6865 7265 2063 616e 2062 6520 6d75   there can be mu
-00016850: 6c74 6970 6c65 2064 6570 656e 6465 6e74  ltiple dependent
-00016860: 7320 7361 6e64 7769 6368 6564 2062 6574  s sandwiched bet
-00016870: 7765 656e 2074 6865 0a20 2020 2074 776f  ween the.    two
-00016880: 206f 7574 7369 6465 2069 6e64 6570 656e   outside indepen
-00016890: 6465 6e74 206e 6f64 6573 2070 6572 2052  dent nodes per R
-000168a0: 5350 4c49 4e45 2e0a 0a20 2020 2054 6865  SPLINE...    The
-000168b0: 2073 706c 696e 6520 656c 656d 656e 7420   spline element 
-000168c0: 6173 7375 6d65 7320 6120 6c69 6e65 6172  assumes a linear
-000168d0: 2069 6e74 6572 706f 6c61 7469 6f6e 2066   interpolation f
-000168e0: 6f72 2064 6973 706c 6163 656d 656e 740a  or displacement.
-000168f0: 2020 2020 616e 6420 746f 7273 696f 6e20      and torsion 
-00016900: 616c 6f6e 6720 7468 6520 6178 6973 206f  along the axis o
-00016910: 6620 7468 6520 7370 6c69 6e65 2c20 6120  f the spline, a 
-00016920: 7175 6164 7261 7469 630a 2020 2020 696e  quadratic.    in
-00016930: 7465 7270 6f6c 6174 696f 6e20 666f 7220  terpolation for 
-00016940: 726f 7461 7469 6f6e 7320 6e6f 726d 616c  rotations normal
-00016950: 2074 6f20 7468 6520 6178 6973 206f 6620   to the axis of 
-00016960: 7468 6520 7370 6c69 6e65 2c20 616e 640a  the spline, and.
-00016970: 2020 2020 6120 6375 6269 6320 696e 7465      a cubic inte
-00016980: 7270 6f6c 6174 696f 6e20 666f 7220 6469  rpolation for di
-00016990: 7370 6c61 6365 6d65 6e74 7320 6e6f 726d  splacements norm
-000169a0: 616c 2074 6f20 7468 6520 6178 6973 206f  al to the axis o
-000169b0: 6620 7468 650a 2020 2020 7370 6c69 6e65  f the.    spline
-000169c0: 2e0a 0a20 2020 2053 6565 2061 6c73 6f0a  ...    See also.
-000169d0: 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020      --------.   
-000169e0: 203a 6675 6e63 3a60 7774 7273 706c 696e   :func:`wtrsplin
-000169f0: 655f 7269 6e67 7360 0a0a 2020 2020 5261  e_rings`..    Ra
-00016a00: 6973 6573 0a20 2020 202d 2d2d 2d2d 2d0a  ises.    ------.
-00016a10: 2020 2020 5661 6c75 6545 7272 6f72 0a0a      ValueError..
-00016a20: 2020 2020 2020 2020 4966 2074 6865 7265          If there
-00016a30: 2061 7265 206c 6573 7320 7468 616e 2033   are less than 3
-00016a40: 2067 7269 6473 2066 6f72 2052 5350 4c49   grids for RSPLI
-00016a50: 4e45 2e0a 0a20 2020 2020 2020 2049 6620  NE...        If 
-00016a60: 6569 7468 6572 2074 6865 2066 6972 7374  either the first
-00016a70: 206f 7220 6c61 7374 2067 7269 6473 2069   or last grids i
-00016a80: 7320 6465 7065 6e64 656e 742e 0a0a 2020  s dependent...  
-00016a90: 2020 4578 616d 706c 6573 0a20 2020 202d    Examples.    -
-00016aa0: 2d2d 2d2d 2d2d 2d0a 2020 2020 3e3e 3e20  -------.    >>> 
-00016ab0: 696d 706f 7274 206e 756d 7079 2061 7320  import numpy as 
-00016ac0: 6e70 0a20 2020 203e 3e3e 2066 726f 6d20  np.    >>> from 
-00016ad0: 7079 7965 7469 2069 6d70 6f72 7420 6e61  pyyeti import na
-00016ae0: 7374 7261 6e0a 2020 2020 3e3e 3e20 6964  stran.    >>> id
-00016af0: 7320 3d20 6e70 2e61 7272 6179 285b 5b31  s = np.array([[1
-00016b00: 3030 2c20 315d 2c0a 2020 2020 2e2e 2e20  00, 1],.    ... 
-00016b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016b20: 5b31 3031 2c20 305d 2c0a 2020 2020 2e2e  [101, 0],.    ..
-00016b30: 2e20 2020 2020 2020 2020 2020 2020 2020  .               
-00016b40: 2020 5b31 3032 2c20 305d 2c0a 2020 2020    [102, 0],.    
-00016b50: 2e2e 2e20 2020 2020 2020 2020 2020 2020  ...             
-00016b60: 2020 2020 5b31 3033 2c20 315d 2c0a 2020      [103, 1],.  
-00016b70: 2020 2e2e 2e20 2020 2020 2020 2020 2020    ...           
-00016b80: 2020 2020 2020 5b31 3034 2c20 305d 2c0a        [104, 0],.
-00016b90: 2020 2020 2e2e 2e20 2020 2020 2020 2020      ...         
-00016ba0: 2020 2020 2020 2020 5b31 3035 2c20 315d          [105, 1]
-00016bb0: 5d29 0a20 2020 203e 3e3e 206e 6173 7472  ]).    >>> nastr
-00016bc0: 616e 2e77 7472 7370 6c69 6e65 2831 2c20  an.wtrspline(1, 
-00016bd0: 3130 2c20 6964 7329 0a20 2020 2052 5350  10, ids).    RSP
-00016be0: 4c49 4e45 2020 2020 2020 2031 3020 2020  LINE       10   
-00016bf0: 2020 302e 3120 2020 2020 3130 3020 2020    0.1     100   
-00016c00: 2020 3130 3120 2031 3233 3435 3620 2020    101  123456   
-00016c10: 2020 3130 3220 2031 3233 3435 3620 2020    102  123456   
-00016c20: 2020 3130 330a 2020 2020 5253 504c 494e    103.    RSPLIN
-00016c30: 4520 2020 2020 2020 3131 2020 2020 2030  E       11     0
-00016c40: 2e31 2020 2020 2031 3033 2020 2020 2031  .1     103     1
-00016c50: 3034 2020 3132 3334 3536 2020 2020 2031  04  123456     1
-00016c60: 3035 0a20 2020 2022 2222 0a20 2020 2069  05.    """.    i
-00016c70: 6473 203d 206e 702e 6174 6c65 6173 745f  ds = np.atleast_
-00016c80: 3264 2869 6473 292e 6173 7479 7065 286e  2d(ids).astype(n
-00016c90: 702e 696e 7436 3429 0a20 2020 204e 203d  p.int64).    N =
-00016ca0: 2069 6473 2e73 6861 7065 5b30 5d0a 2020   ids.shape[0].  
-00016cb0: 2020 6966 204e 203c 2033 3a0a 2020 2020    if N < 3:.    
-00016cc0: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-00016cd0: 7272 6f72 2822 6e6f 7420 656e 6f75 6768  rror("not enough
-00016ce0: 2067 7269 6473 2066 6f72 2052 5350 4c49   grids for RSPLI
-00016cf0: 4e45 2229 0a0a 2020 2020 6964 732c 2069  NE")..    ids, i
-00016d00: 6e64 203d 2069 6473 2e54 0a20 2020 2069  nd = ids.T.    i
-00016d10: 6620 696e 642e 616c 6c28 293a 0a20 2020  f ind.all():.   
-00016d20: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-00016d30: 4572 726f 7228 2274 6865 7265 2061 7265  Error("there are
-00016d40: 206e 6f20 6465 7065 6e64 656e 7420 444f   no dependent DO
-00016d50: 4620 666f 7220 5253 504c 494e 4522 290a  F for RSPLINE").
-00016d60: 0a20 2020 2069 6620 6e6f 7420 696e 645b  .    if not ind[
-00016d70: 305d 203d 3d20 696e 645b 2d31 5d20 3d3d  0] == ind[-1] ==
-00016d80: 2031 3a0a 2020 2020 2020 2020 7261 6973   1:.        rais
-00016d90: 6520 5661 6c75 6545 7272 6f72 2822 7468  e ValueError("th
-00016da0: 6520 6669 7273 7420 616e 6420 6c61 7374  e first and last
-00016db0: 2067 7269 6473 206d 7573 7420 6265 2069   grids must be i
-00016dc0: 6e64 6570 656e 6465 6e74 2229 0a0a 2020  ndependent")..  
-00016dd0: 2020 2320 6669 6e64 2069 6e64 6963 6573    # find indices
-00016de0: 206f 6620 616c 6c20 6465 7065 6e64 656e   of all dependen
-00016df0: 7473 3a0a 2020 2020 6465 7073 203d 2028  ts:.    deps = (
-00016e00: 696e 6420 3d3d 2030 292e 6e6f 6e7a 6572  ind == 0).nonzer
-00016e10: 6f28 295b 305d 0a0a 2020 2020 2320 6669  o()[0]..    # fi
-00016e20: 6e64 2067 6170 7320 696e 2069 6e64 6963  nd gaps in indic
-00016e30: 6573 206f 6620 6465 7065 6e64 656e 7473  es of dependents
-00016e40: 206c 6973 743a 0a20 2020 2067 6170 7320   list:.    gaps 
-00016e50: 3d20 286e 702e 6469 6666 2864 6570 7329  = (np.diff(deps)
-00016e60: 2021 3d20 3129 2e6e 6f6e 7a65 726f 2829   != 1).nonzero()
-00016e70: 5b30 5d0a 0a20 2020 2023 2073 7461 7274  [0]..    # start
-00016e80: 696e 6720 696e 6469 6365 7320 6f66 2064  ing indices of d
-00016e90: 6570 656e 6465 6e74 733a 0a20 2020 2066  ependents:.    f
-00016ea0: 6972 7374 7320 3d20 6465 7073 5b6e 702e  irsts = deps[np.
-00016eb0: 6873 7461 636b 2828 302c 2067 6170 7320  hstack((0, gaps 
-00016ec0: 2b20 3129 295d 0a0a 2020 2020 2320 656e  + 1))]..    # en
-00016ed0: 6469 6e67 2069 6e64 6963 6573 206f 6620  ding indices of 
-00016ee0: 6465 7065 6e64 656e 7473 3a0a 2020 2020  dependents:.    
-00016ef0: 6c61 7374 7320 3d20 6465 7073 5b6e 702e  lasts = deps[np.
-00016f00: 6873 7461 636b 2828 6761 7073 2c20 6c65  hstack((gaps, le
-00016f10: 6e28 6465 7073 2920 2d20 3129 295d 0a0a  n(deps) - 1))]..
-00016f20: 2020 2020 2320 7772 6974 6520 6f6e 6520      # write one 
-00016f30: 5253 504c 494e 4520 7065 7220 7365 7269  RSPLINE per seri
-00016f40: 6573 206f 6620 6465 7065 6e64 656e 7473  es of dependents
-00016f50: 3a0a 2020 2020 666f 7220 6430 2c20 6431  :.    for d0, d1
-00016f60: 2069 6e20 7a69 7028 6669 7273 7473 2c20   in zip(firsts, 
-00016f70: 6c61 7374 7329 3a0a 2020 2020 2020 2020  lasts):.        
-00016f80: 662e 7772 6974 6528 6622 5253 504c 494e  f.write(f"RSPLIN
-00016f90: 4520 7b72 6964 3a38 7d7b 446f 4c3a 3e38  E {rid:8}{DoL:>8
-00016fa0: 7d7b 6964 735b 6430 202d 2031 5d3a 387d  }{ids[d0 - 1]:8}
-00016fb0: 2229 0a20 2020 2020 2020 2072 6964 202b  ").        rid +
-00016fc0: 3d20 310a 2020 2020 2020 2020 6669 656c  = 1.        fiel
-00016fd0: 6420 3d20 3520 2023 206e 6578 7420 6e61  d = 5  # next na
-00016fe0: 7374 7261 6e20 6669 656c 6420 2831 2074  stran field (1 t
-00016ff0: 6f20 3130 290a 0a20 2020 2020 2020 2023  o 10)..        #
-00017000: 2077 7269 7465 2061 6c6c 2062 7574 206c   write all but l
-00017010: 6173 7420 6772 6964 206f 6620 6375 7272  ast grid of curr
-00017020: 656e 7420 7365 676d 656e 743a 0a20 2020  ent segment:.   
-00017030: 2020 2020 2066 6f72 206a 2069 6e20 7261       for j in ra
-00017040: 6e67 6528 6430 2c20 6431 202b 2031 293a  nge(d0, d1 + 1):
-00017050: 0a20 2020 2020 2020 2020 2020 2066 2e77  .            f.w
-00017060: 7269 7465 2866 227b 6964 735b 6a5d 3a38  rite(f"{ids[j]:8
-00017070: 7d22 290a 2020 2020 2020 2020 2020 2020  }").            
-00017080: 6669 656c 6420 2b3d 2031 0a20 2020 2020  field += 1.     
-00017090: 2020 2020 2020 2069 6620 6669 656c 6420         if field 
-000170a0: 3d3d 2031 303a 0a20 2020 2020 2020 2020  == 10:.         
-000170b0: 2020 2020 2020 2066 2e77 7269 7465 2822         f.write("
-000170c0: 5c6e 2020 2020 2020 2020 2229 0a20 2020  \n        ").   
-000170d0: 2020 2020 2020 2020 2020 2020 2066 6965               fie
-000170e0: 6c64 203d 2032 0a20 2020 2020 2020 2020  ld = 2.         
-000170f0: 2020 2066 2e77 7269 7465 2822 2020 3132     f.write("  12
-00017100: 3334 3536 2229 0a20 2020 2020 2020 2020  3456").         
-00017110: 2020 2066 6965 6c64 202b 3d20 310a 0a20     field += 1.. 
-00017120: 2020 2020 2020 2023 2077 7269 7465 2063         # write c
-00017130: 6c6f 7369 6e67 2069 6e64 6570 656e 6465  losing independe
-00017140: 6e74 3a0a 2020 2020 2020 2020 662e 7772  nt:.        f.wr
-00017150: 6974 6528 6622 7b69 6473 5b64 3120 2b20  ite(f"{ids[d1 + 
-00017160: 315d 3a38 7d5c 6e22 290a 0a0a 6465 6620  1]:8}\n")...def 
-00017170: 5f69 6e74 6572 7365 6374 2863 6972 6341  _intersect(circA
-00017180: 2c20 6369 7263 422c 2078 7941 2c20 6472  , circB, xyA, dr
-00017190: 6177 3d46 616c 7365 293a 0a20 2020 2022  aw=False):.    "
-000171a0: 2222 0a20 2020 2046 696e 6420 7768 6572  "".    Find wher
-000171b0: 6520 6120 6c69 6e65 2074 6861 7420 7061  e a line that pa
-000171c0: 7373 6573 2074 6872 6f75 6768 2074 6865  sses through the
-000171d0: 2063 656e 7465 7220 6f66 2063 6972 6341   center of circA
-000171e0: 2061 6e64 0a20 2020 2070 6f69 6e74 2078   and.    point x
-000171f0: 7941 2069 6e74 6572 7365 6374 7320 6369  yA intersects ci
-00017200: 7263 422e 0a0a 2020 2020 5061 7261 6d65  rcB...    Parame
-00017210: 7465 7273 0a20 2020 202d 2d2d 2d2d 2d2d  ters.    -------
-00017220: 2d2d 2d0a 2020 2020 6369 7263 4120 3a20  ---.    circA : 
-00017230: 332d 656c 656d 656e 7420 6172 7261 795f  3-element array_
-00017240: 6c69 6b65 0a20 2020 2020 2020 205b 7863  like.        [xc
-00017250: 2c20 7963 2c20 525d 2066 6f72 2063 6972  , yc, R] for cir
-00017260: 636c 6520 410a 2020 2020 6369 7263 4220  cle A.    circB 
-00017270: 3a20 332d 656c 656d 656e 7420 6172 7261  : 3-element arra
-00017280: 795f 6c69 6b65 0a20 2020 2020 2020 205b  y_like.        [
-00017290: 7863 2c20 7963 2c20 525d 2066 6f72 2063  xc, yc, R] for c
-000172a0: 6972 636c 6520 420a 2020 2020 7879 4120  ircle B.    xyA 
-000172b0: 3a20 322d 656c 656d 656e 7420 6172 7261  : 2-element arra
-000172c0: 795f 6c69 6b65 0a20 2020 2020 2020 205b  y_like.        [
-000172d0: 782c 2079 5d20 706f 696e 7420 2870 726f  x, y] point (pro
-000172e0: 6261 626c 7920 6f6e 2063 6972 636c 6520  bably on circle 
-000172f0: 4129 0a20 2020 2064 7261 7720 3a20 626f  A).    draw : bo
-00017300: 6f6c 3b20 6f70 7469 6f6e 616c 0a20 2020  ol; optional.   
-00017310: 2020 2020 2049 6620 5472 7565 2c20 706c       If True, pl
-00017320: 6f74 2063 6972 636c 6573 2061 6e64 2070  ot circles and p
-00017330: 6f69 6e74 7320 666f 7220 7669 7375 616c  oints for visual
-00017340: 2069 6e73 7065 6374 696f 6e20 696e 0a20   inspection in. 
-00017350: 2020 2020 2020 2066 6967 7572 6520 2769         figure 'i
-00017360: 6e74 6572 7365 6374 270a 0a20 2020 2052  ntersect'..    R
-00017370: 6574 7572 6e73 0a20 2020 202d 2d2d 2d2d  eturns.    -----
-00017380: 2d2d 0a20 2020 2070 7420 3a20 3164 206e  --.    pt : 1d n
-00017390: 6461 7272 6179 0a20 2020 2020 2020 205b  darray.        [
-000173a0: 782c 2079 5d20 6c6f 6361 7469 6f6e 206f  x, y] location o
-000173b0: 6620 696e 7465 7273 6563 7469 6f6e 2070  f intersection p
-000173c0: 6f69 6e74 2063 6c6f 7365 7374 2074 6f20  oint closest to 
-000173d0: 7879 410a 0a20 2020 2045 7861 6d70 6c65  xyA..    Example
-000173e0: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20  s.    --------. 
-000173f0: 2020 202e 2e20 706c 6f74 3a3a 0a20 2020     .. plot::.   
-00017400: 2020 2020 203a 636f 6e74 6578 743a 2063       :context: c
-00017410: 6c6f 7365 2d66 6967 730a 0a20 2020 2020  lose-figs..     
-00017420: 2020 203e 3e3e 2066 726f 6d20 7079 7965     >>> from pyye
-00017430: 7469 2e6e 6173 7472 616e 2e62 756c 6b20  ti.nastran.bulk 
-00017440: 696d 706f 7274 205f 696e 7465 7273 6563  import _intersec
-00017450: 740a 2020 2020 2020 2020 3e3e 3e20 6369  t.        >>> ci
-00017460: 7263 4120 3d20 2830 2e2c 2030 2e2c 2031  rcA = (0., 0., 1
-00017470: 302e 290a 2020 2020 2020 2020 3e3e 3e20  0.).        >>> 
-00017480: 6369 7263 4220 3d20 2830 2e2c 2030 2e2c  circB = (0., 0.,
-00017490: 2031 352e 290a 2020 2020 2020 2020 3e3e   15.).        >>
-000174a0: 3e20 7879 4120 3d20 2830 2e2c 2035 2e29  > xyA = (0., 5.)
-000174b0: 0a20 2020 2020 2020 203e 3e3e 205f 696e  .        >>> _in
-000174c0: 7465 7273 6563 7428 6369 7263 412c 2063  tersect(circA, c
-000174d0: 6972 6342 2c20 5b30 2e2c 2031 2e5d 2c20  ircB, [0., 1.], 
-000174e0: 6472 6177 3d31 290a 2020 2020 2020 2020  draw=1).        
-000174f0: 6172 7261 7928 5b20 2030 2e2c 2020 3135  array([  0.,  15
-00017500: 2e5d 290a 2020 2020 2020 2020 3e3e 3e20  .]).        >>> 
-00017510: 5f69 6e74 6572 7365 6374 2863 6972 6341  _intersect(circA
-00017520: 2c20 6369 7263 422c 205b 302e 2c20 2d31  , circB, [0., -1
-00017530: 2e5d 290a 2020 2020 2020 2020 6172 7261  .]).        arra
-00017540: 7928 5b20 2030 2e2c 202d 3135 2e5d 290a  y([  0., -15.]).
-00017550: 2020 2020 2020 2020 3e3e 3e20 5f69 6e74          >>> _int
-00017560: 6572 7365 6374 2863 6972 6341 2c20 6369  ersect(circA, ci
-00017570: 7263 422c 205b 312e 2c20 302e 5d29 0a20  rcB, [1., 0.]). 
-00017580: 2020 2020 2020 2061 7272 6179 285b 2031         array([ 1
-00017590: 352e 2c20 2020 302e 5d29 0a20 2020 2020  5.,   0.]).     
-000175a0: 2020 203e 3e3e 205f 696e 7465 7273 6563     >>> _intersec
-000175b0: 7428 6369 7263 412c 2063 6972 6342 2c20  t(circA, circB, 
-000175c0: 5b2d 312e 2c20 302e 5d29 0a20 2020 2020  [-1., 0.]).     
-000175d0: 2020 2061 7272 6179 285b 2d31 352e 2c20     array([-15., 
-000175e0: 2020 302e 5d29 0a20 2020 2022 2222 0a20    0.]).    """. 
-000175f0: 2020 2028 7831 2c20 7931 2c20 5231 2920     (x1, y1, R1) 
-00017600: 3d20 6369 7263 410a 2020 2020 2878 322c  = circA.    (x2,
-00017610: 2079 3229 203d 2078 7941 0a20 2020 2028   y2) = xyA.    (
-00017620: 7833 2c20 7933 2c20 5233 2920 3d20 6369  x3, y3, R3) = ci
-00017630: 7263 420a 2020 2020 6966 2061 6273 2878  rcB.    if abs(x
-00017640: 3220 2d20 7831 2920 3e20 3130 3020 2a20  2 - x1) > 100 * 
-00017650: 6e70 2e66 696e 666f 2866 6c6f 6174 292e  np.finfo(float).
-00017660: 6570 733a 0a20 2020 2020 2020 206d 203d  eps:.        m =
-00017670: 2028 7932 202d 2079 3129 202f 2028 7832   (y2 - y1) / (x2
-00017680: 202d 2078 3129 0a20 2020 2020 2020 2062   - x1).        b
-00017690: 203d 2028 7832 202a 2079 3120 2d20 7831   = (x2 * y1 - x1
-000176a0: 202a 2079 3229 202f 2028 7832 202d 2078   * y2) / (x2 - x
-000176b0: 3129 0a20 2020 2020 2020 2023 2028 6d78  1).        # (mx
-000176c0: 2b62 2d79 3329 2a2a 3220 2b20 2878 2d78  +b-y3)**2 + (x-x
-000176d0: 3329 2a2a 3220 3d20 5233 2a2a 320a 2020  3)**2 = R3**2.  
-000176e0: 2020 2020 2020 6132 203d 206d 202a 206d        a2 = m * m
-000176f0: 202b 2031 0a20 2020 2020 2020 2061 3120   + 1.        a1 
-00017700: 3d20 3220 2a20 286d 202a 2028 6220 2d20  = 2 * (m * (b - 
-00017710: 7933 2920 2d20 7833 2920 2f20 6132 0a20  y3) - x3) / a2. 
-00017720: 2020 2020 2020 2061 3020 3d20 2828 6220         a0 = ((b 
-00017730: 2d20 7933 2920 2a2a 2032 202b 2078 332a  - y3) ** 2 + x3*
-00017740: 2a32 202d 2052 332a 2a32 2920 2f20 6132  *2 - R3**2) / a2
-00017750: 0a20 2020 2020 2020 2078 3120 3d20 2d61  .        x1 = -a
-00017760: 3120 2f20 3220 2b20 6e70 2e73 7172 7428  1 / 2 + np.sqrt(
-00017770: 2861 3120 2f20 3229 202a 2a20 3220 2d20  (a1 / 2) ** 2 - 
-00017780: 6130 290a 2020 2020 2020 2020 7832 203d  a0).        x2 =
-00017790: 202d 6131 202f 2032 202d 206e 702e 7371   -a1 / 2 - np.sq
-000177a0: 7274 2828 6131 202f 2032 2920 2a2a 2032  rt((a1 / 2) ** 2
-000177b0: 202d 2061 3029 0a20 2020 2020 2020 2079   - a0).        y
-000177c0: 3120 3d20 6d20 2a20 7831 202b 2062 0a20  1 = m * x1 + b. 
-000177d0: 2020 2020 2020 2079 3220 3d20 6d20 2a20         y2 = m * 
-000177e0: 7832 202b 2062 0a20 2020 2065 6c73 653a  x2 + b.    else:
-000177f0: 0a20 2020 2020 2020 2023 206c 696e 6520  .        # line 
-00017800: 6973 2076 6572 7469 6361 6c20 2878 3120  is vertical (x1 
-00017810: 2620 7832 2061 7265 2075 6e63 6861 6e67  & x2 are unchang
-00017820: 6564 290a 2020 2020 2020 2020 2320 2020  ed).        #   
-00017830: 2028 792d 7933 292a 2a32 202b 2028 7831   (y-y3)**2 + (x1
-00017840: 2d78 3329 2a2a 3220 3d20 5233 2a2a 320a  -x3)**2 = R3**2.
-00017850: 2020 2020 2020 2020 2320 2020 2079 2d79          #    y-y
-00017860: 3320 3d20 2b2d 206e 702e 7371 7274 2852  3 = +- np.sqrt(R
-00017870: 332a 2a32 202d 2028 7831 2d78 3329 2a2a  3**2 - (x1-x3)**
-00017880: 3229 0a20 2020 2020 2020 2079 3120 3d20  2).        y1 = 
-00017890: 7933 202b 206e 702e 7371 7274 2852 332a  y3 + np.sqrt(R3*
-000178a0: 2a32 202d 2028 7831 202d 2078 3329 202a  *2 - (x1 - x3) *
-000178b0: 2a20 3229 0a20 2020 2020 2020 2079 3220  * 2).        y2 
-000178c0: 3d20 7933 202d 206e 702e 7371 7274 2852  = y3 - np.sqrt(R
-000178d0: 332a 2a32 202d 2028 7831 202d 2078 3329  3**2 - (x1 - x3)
-000178e0: 202a 2a20 3229 0a20 2020 2065 7272 3120   ** 2).    err1 
-000178f0: 3d20 6162 7328 7879 415b 305d 202d 2078  = abs(xyA[0] - x
-00017900: 3129 202b 2061 6273 2878 7941 5b31 5d20  1) + abs(xyA[1] 
-00017910: 2d20 7931 290a 2020 2020 6572 7232 203d  - y1).    err2 =
-00017920: 2061 6273 2878 7941 5b30 5d20 2d20 7832   abs(xyA[0] - x2
-00017930: 2920 2b20 6162 7328 7879 415b 315d 202d  ) + abs(xyA[1] -
-00017940: 2079 3229 0a20 2020 2069 6620 6572 7231   y2).    if err1
-00017950: 203c 2065 7272 323a 0a20 2020 2020 2020   < err2:.       
-00017960: 2070 7420 3d20 6e70 2e61 7272 6179 285b   pt = np.array([
-00017970: 7831 2c20 7931 5d29 0a20 2020 2065 6c73  x1, y1]).    els
-00017980: 653a 0a20 2020 2020 2020 2070 7420 3d20  e:.        pt = 
-00017990: 6e70 2e61 7272 6179 285b 7832 2c20 7932  np.array([x2, y2
-000179a0: 5d29 0a20 2020 2069 6620 6472 6177 3a0a  ]).    if draw:.
-000179b0: 2020 2020 2020 2020 706c 742e 6669 6775          plt.figu
-000179c0: 7265 2822 696e 7465 7273 6563 7422 290a  re("intersect").
-000179d0: 2020 2020 2020 2020 706c 742e 636c 6628          plt.clf(
-000179e0: 290a 2020 2020 2020 2020 7468 203d 206e  ).        th = n
-000179f0: 702e 6172 616e 6765 2830 2c20 3336 3129  p.arange(0, 361)
-00017a00: 202a 206e 702e 7069 202f 2031 3830 2e30   * np.pi / 180.0
-00017a10: 0a20 2020 2020 2020 2028 7831 2c20 7931  .        (x1, y1
-00017a20: 2c20 5231 2920 3d20 6369 7263 410a 2020  , R1) = circA.  
-00017a30: 2020 2020 2020 706c 742e 706c 6f74 2878        plt.plot(x
-00017a40: 3120 2b20 5231 202a 206e 702e 636f 7328  1 + R1 * np.cos(
-00017a50: 7468 292c 2079 3120 2b20 5231 202a 206e  th), y1 + R1 * n
-00017a60: 702e 7369 6e28 7468 292c 206c 6162 656c  p.sin(th), label
-00017a70: 3d22 4369 7263 4122 290a 2020 2020 2020  ="CircA").      
-00017a80: 2020 706c 742e 706c 6f74 2878 3320 2b20    plt.plot(x3 + 
-00017a90: 5233 202a 206e 702e 636f 7328 7468 292c  R3 * np.cos(th),
-00017aa0: 2079 3320 2b20 5233 202a 206e 702e 7369   y3 + R3 * np.si
-00017ab0: 6e28 7468 292c 206c 6162 656c 3d22 4369  n(th), label="Ci
-00017ac0: 7263 4222 290a 2020 2020 2020 2020 706c  rcB").        pl
-00017ad0: 742e 7363 6174 7465 7228 2a78 7941 2c20  t.scatter(*xyA, 
-00017ae0: 633d 2267 222c 206d 6172 6b65 723d 226f  c="g", marker="o
-00017af0: 222c 2073 3d36 302c 206c 6162 656c 3d22  ", s=60, label="
-00017b00: 7879 4122 290a 2020 2020 2020 2020 706c  xyA").        pl
-00017b10: 742e 7363 6174 7465 7228 2a70 742c 2063  t.scatter(*pt, c
-00017b20: 3d22 6222 2c20 6d61 726b 6572 3d22 7622  ="b", marker="v"
-00017b30: 2c20 733d 3630 2c20 6c61 6265 6c3d 2269  , s=60, label="i
-00017b40: 6e74 6572 7365 6374 696f 6e20 6f6e 2043  ntersection on C
-00017b50: 6972 6342 2229 0a20 2020 2020 2020 2070  ircB").        p
-00017b60: 6c74 2e61 7869 7328 2265 7175 616c 2229  lt.axis("equal")
-00017b70: 0a20 2020 2020 2020 2070 6c74 2e6c 6567  .        plt.leg
-00017b80: 656e 6428 6c6f 633d 2262 6573 7422 2c20  end(loc="best", 
-00017b90: 7363 6174 7465 7270 6f69 6e74 733d 3129  scatterpoints=1)
-00017ba0: 0a20 2020 2072 6574 7572 6e20 7074 0a0a  .    return pt..
-00017bb0: 0a64 6566 205f 6368 6563 6b5f 7a5f 616c  .def _check_z_al
-00017bc0: 6967 6e6d 656e 7428 6369 7263 5f70 6172  ignment(circ_par
-00017bd0: 6d73 2c20 746f 6c29 3a0a 2020 2020 2320  ms, tol):.    # 
-00017be0: 4861 7665 2074 776f 2064 6966 6665 7265  Have two differe
-00017bf0: 6e74 2074 7261 6e73 666f 726d 7320 746f  nt transforms to
-00017c00: 2061 206c 6f63 616c 2073 7973 7465 6d20   a local system 
-00017c10: 2e2e 2e20 6861 7665 2074 6f20 7573 650a  ... have to use.
-00017c20: 2020 2020 2320 7361 6d65 206f 6e65 2074      # same one t
-00017c30: 6f20 6765 7420 7072 6f70 6572 206e 6f64  o get proper nod
-00017c40: 6520 616c 6967 6e69 6e67 2074 6f20 6f63  e aligning to oc
-00017c50: 6375 7220 666f 7220 5253 504c 494e 452e  cur for RSPLINE.
-00017c60: 2042 7574 2c0a 2020 2020 2320 7468 6520   But,.    # the 
-00017c70: 7a2d 6178 6973 2066 6f72 2062 6f74 6820  z-axis for both 
-00017c80: 6265 7474 6572 206d 6174 6368 2075 7020  better match up 
-00017c90: 2e2e 2e20 636f 6d70 7574 6520 636f 7369  ... compute cosi
-00017ca0: 6e65 206f 6620 616e 676c 650a 2020 2020  ne of angle.    
-00017cb0: 2320 6265 7477 6565 6e20 7468 6520 7477  # between the tw
-00017cc0: 6f20 7a2d 6178 6573 202e 2e2e 2073 686f  o z-axes ... sho
-00017cd0: 756c 6420 6265 2076 6572 7920 636c 6f73  uld be very clos
-00017ce0: 6520 746f 2031 2e30 3a0a 2020 2020 7a31  e to 1.0:.    z1
-00017cf0: 203d 2063 6972 635f 7061 726d 735b 305d   = circ_parms[0]
-00017d00: 2e62 6173 6963 326c 6f63 616c 5b32 5d0a  .basic2local[2].
-00017d10: 2020 2020 7a32 203d 2063 6972 635f 7061      z2 = circ_pa
-00017d20: 726d 735b 315d 2e62 6173 6963 326c 6f63  rms[1].basic2loc
-00017d30: 616c 5b32 5d0a 2020 2020 2320 7468 6573  al[2].    # thes
-00017d40: 6520 6172 6520 756e 6974 2076 6563 746f  e are unit vecto
-00017d50: 7273 3b20 6e6f 206e 6565 6420 746f 2064  rs; no need to d
-00017d60: 6976 6964 6520 6279 206d 6167 6e69 7475  ivide by magnitu
-00017d70: 6465 733a 0a20 2020 2063 6f73 696e 6520  des:.    cosine 
-00017d80: 3d20 7a31 2e64 6f74 287a 3229 0a20 2020  = z1.dot(z2).   
-00017d90: 2069 6620 6162 7328 636f 7369 6e65 2920   if abs(cosine) 
-00017da0: 3c20 746f 6c3a 0a20 2020 2020 2020 2072  < tol:.        r
-00017db0: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-00017dc0: 0a20 2020 2020 2020 2020 2020 2022 7065  .            "pe
-00017dd0: 7270 656e 6469 6375 6c61 7220 6469 7265  rpendicular dire
-00017de0: 6374 696f 6e73 206f 6620 6072 3167 7269  ctions of `r1gri
-00017df0: 6473 6020 616e 6420 220a 2020 2020 2020  ds` and ".      
-00017e00: 2020 2020 2020 6622 6072 3267 7269 6473        f"`r2grids
-00017e10: 6020 646f 206e 6f74 206d 6174 6368 3a20  ` do not match: 
-00017e20: 7b7a 317d 2076 732e 207b 7a32 7d3b 2074  {z1} vs. {z2}; t
-00017e30: 6865 2022 0a20 2020 2020 2020 2020 2020  he ".           
-00017e40: 2066 2263 6f73 696e 6520 6f66 2074 6865   f"cosine of the
-00017e50: 2061 6e67 6c65 2062 6574 7765 656e 2074   angle between t
-00017e60: 6865 6d20 6973 207b 636f 7369 6e65 7d22  hem is {cosine}"
-00017e70: 0a20 2020 2020 2020 2029 0a0a 0a64 6566  .        )...def
-00017e80: 205f 7774 5f63 6972 636c 6531 5f63 6f6f   _wt_circle1_coo
-00017e90: 7264 2866 2c20 636f 7264 5f69 642c 2063  rd(f, cord_id, c
-00017ea0: 656e 7465 722c 2062 6173 6963 326c 6f63  enter, basic2loc
-00017eb0: 616c 2c20 6e6f 6465 302c 206e 6f64 655f  al, node0, node_
-00017ec0: 6964 302c 206e 616d 6573 293a 0a20 2020  id0, names):.   
-00017ed0: 2072 6566 5f63 6f72 645f 6964 203d 2030   ref_cord_id = 0
-00017ee0: 0a20 2020 2064 6973 7420 3d20 6d61 7828  .    dist = max(
-00017ef0: 312e 302c 206e 702e 6c69 6e61 6c67 2e6e  1.0, np.linalg.n
-00017f00: 6f72 6d28 6365 6e74 6572 2929 0a20 2020  orm(center)).   
-00017f10: 2070 203d 2031 3020 2a2a 206e 702e 666c   p = 10 ** np.fl
-00017f20: 6f6f 7228 6e70 2e6c 6f67 3130 2864 6973  oor(np.log10(dis
-00017f30: 7429 290a 2020 2020 6469 7374 203d 2072  t)).    dist = r
-00017f40: 6f75 6e64 2864 6973 7420 2f20 7029 202a  ound(dist / p) *
-00017f50: 2070 0a20 2020 206c 6f63 616c 5f63 6f72   p.    local_cor
-00017f60: 6420 3d20 7b0a 2020 2020 2020 2020 636f  d = {.        co
-00017f70: 7264 5f69 643a 205b 0a20 2020 2020 2020  rd_id: [.       
-00017f80: 2020 2020 2022 434f 5244 3252 222c 0a20       "CORD2R",. 
-00017f90: 2020 2020 2020 2020 2020 206e 702e 7673             np.vs
-00017fa0: 7461 636b 280a 2020 2020 2020 2020 2020  tack(.          
-00017fb0: 2020 2020 2020 280a 2020 2020 2020 2020        (.        
-00017fc0: 2020 2020 2020 2020 2020 2020 5b63 6f72              [cor
-00017fd0: 645f 6964 2c20 312c 2072 6566 5f63 6f72  d_id, 1, ref_cor
-00017fe0: 645f 6964 5d2c 0a20 2020 2020 2020 2020  d_id],.         
-00017ff0: 2020 2020 2020 2020 2020 2063 656e 7465             cente
-00018000: 722c 0a20 2020 2020 2020 2020 2020 2020  r,.             
-00018010: 2020 2020 2020 2063 656e 7465 7220 2b20         center + 
-00018020: 6469 7374 202a 2062 6173 6963 326c 6f63  dist * basic2loc
-00018030: 616c 5b32 5d2c 0a20 2020 2020 2020 2020  al[2],.         
-00018040: 2020 2020 2020 2020 2020 2063 656e 7465             cente
-00018050: 7220 2b20 6469 7374 202a 2062 6173 6963  r + dist * basic
-00018060: 326c 6f63 616c 5b30 5d2c 0a20 2020 2020  2local[0],.     
-00018070: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00018080: 2020 2020 2020 2020 2029 2c0a 2020 2020           ),.    
-00018090: 2020 2020 5d0a 2020 2020 7d0a 2020 2020      ].    }.    
-000180a0: 636f 6d6d 656e 7420 3d20 280a 2020 2020  comment = (.    
-000180b0: 2020 2020 6622 4f72 6967 696e 206f 6620      f"Origin of 
-000180c0: 6c6f 6361 6c20 434f 5244 3252 207b 636f  local CORD2R {co
-000180d0: 7264 5f69 647d 2069 7320 6174 2063 656e  rd_id} is at cen
-000180e0: 7465 7220 6f66 207b 6e61 6d65 735b 305d  ter of {names[0]
-000180f0: 7d20 7269 6e67 3b22 0a20 2020 2020 2020  } ring;".       
-00018100: 2022 207a 2069 7320 7065 7270 656e 6469   " z is perpendi
-00018110: 6375 6c61 7220 746f 2070 6c61 6e65 206f  cular to plane o
-00018120: 6620 6369 7263 6c65 2c20 616e 6420 7820  f circle, and x 
-00018130: 6973 2061 6c69 676e 6564 2077 6974 6820  is aligned with 
-00018140: 220a 2020 2020 2020 2020 6622 6e6f 6465  ".        f"node
-00018150: 207b 6e6f 6465 307d 2028 616e 6420 6e65   {node0} (and ne
-00018160: 7720 6e6f 6465 207b 6e6f 6465 5f69 6430  w node {node_id0
-00018170: 7d29 2e22 0a20 2020 2029 0a20 2020 2066  }).".    ).    f
-00018180: 2e77 7269 7465 286d 6b63 6f6d 6d65 6e74  .write(mkcomment
-00018190: 2863 6f6d 6d65 6e74 2929 0a20 2020 2077  (comment)).    w
-000181a0: 7463 6f6f 7264 6361 7264 7328 662c 206c  tcoordcards(f, l
-000181b0: 6f63 616c 5f63 6f72 6429 0a0a 0a64 6566  ocal_cord)...def
-000181c0: 205f 7774 6772 6964 735f 7262 6532 7328   _wtgrids_rbe2s(
-000181d0: 0a20 2020 2066 2c20 6369 7263 5f70 6172  .    f, circ_par
-000181e0: 6d73 2c20 6365 6e74 6572 2c20 6261 7369  ms, center, basi
-000181f0: 6332 6c6f 6361 6c2c 2063 6f72 645f 6964  c2local, cord_id
-00018200: 2c20 6e6f 6465 5f69 6430 2c20 7262 6532  , node_id0, rbe2
-00018210: 5f69 6430 2c20 7269 6e67 315f 6964 732c  _id0, ring1_ids,
-00018220: 206e 616d 6573 0a29 3a0a 2020 2020 6e31   names.):.    n1
-00018230: 203d 2063 6972 635f 7061 726d 735b 305d   = circ_parms[0]
-00018240: 2e6c 6f63 616c 2e73 6861 7065 5b31 5d0a  .local.shape[1].
-00018250: 2020 2020 6e65 7770 7473 203d 206e 702e      newpts = np.
-00018260: 7a65 726f 7328 286e 312c 2033 2929 0a0a  zeros((n1, 3))..
-00018270: 2020 2020 2320 6465 6669 6e65 207a 206c      # define z l
-00018280: 6f63 6174 696f 6e20 6f66 206e 6577 7074  ocation of newpt
-00018290: 733a 0a20 2020 206e 6577 7074 735b 3a2c  s:.    newpts[:,
-000182a0: 2032 5d20 3d20 6369 7263 5f70 6172 6d73   2] = circ_parms
-000182b0: 5b31 5d2e 6c6f 6361 6c5b 325d 2e6d 6561  [1].local[2].mea
-000182c0: 6e28 290a 0a20 2020 2023 2063 6f6d 7075  n()..    # compu
-000182d0: 7465 2063 656e 7465 7220 6f66 2063 6972  te center of cir
-000182e0: 636c 6520 3220 696e 206c 6f63 616c 2031  cle 2 in local 1
-000182f0: 2063 6f6f 7264 696e 6174 6573 3a0a 2020   coordinates:.  
-00018300: 2020 6365 6e74 6572 3220 3d20 6261 7369    center2 = basi
-00018310: 6332 6c6f 6361 6c20 4020 2863 6972 635f  c2local @ (circ_
-00018320: 7061 726d 735b 315d 2e63 656e 7465 7220  parms[1].center 
-00018330: 2d20 6365 6e74 6572 290a 2020 2020 7261  - center).    ra
-00018340: 6469 7573 203d 2063 6972 635f 7061 726d  dius = circ_parm
-00018350: 735b 305d 2e72 6164 6975 730a 2020 2020  s[0].radius.    
-00018360: 666f 7220 6a20 696e 2072 616e 6765 286e  for j in range(n
-00018370: 3129 3a0a 2020 2020 2020 2020 6e65 7770  1):.        newp
-00018380: 7473 5b6a 2c20 3a32 5d20 3d20 5f69 6e74  ts[j, :2] = _int
-00018390: 6572 7365 6374 280a 2020 2020 2020 2020  ersect(.        
-000183a0: 2020 2020 5b30 2e30 2c20 302e 302c 2072      [0.0, 0.0, r
-000183b0: 6164 6975 735d 2c0a 2020 2020 2020 2020  adius],.        
-000183c0: 2020 2020 5b63 656e 7465 7232 5b30 5d2c      [center2[0],
-000183d0: 2063 656e 7465 7232 5b31 5d2c 2063 6972   center2[1], cir
-000183e0: 635f 7061 726d 735b 315d 2e72 6164 6975  c_parms[1].radiu
-000183f0: 735d 2c0a 2020 2020 2020 2020 2020 2020  s],.            
-00018400: 6369 7263 5f70 6172 6d73 5b30 5d2e 6c6f  circ_parms[0].lo
-00018410: 6361 6c5b 3a32 2c20 6a5d 2c0a 2020 2020  cal[:2, j],.    
-00018420: 2020 2020 290a 0a20 2020 2023 2077 7269      )..    # wri
-00018430: 7465 206e 6577 2067 7269 6473 0a20 2020  te new grids.   
-00018440: 2063 6f6d 6d65 6e74 203d 2028 0a20 2020   comment = (.   
-00018450: 2020 2020 2066 2247 7269 6473 2074 6f20       f"Grids to 
-00018460: 5242 4532 2074 6f20 7468 6520 7b6e 616d  RBE2 to the {nam
-00018470: 6573 5b30 5d7d 2067 7269 6473 2e20 5468  es[0]} grids. Th
-00018480: 6573 6520 6772 6964 7320 6c69 6e65 2022  ese grids line "
-00018490: 0a20 2020 2020 2020 2066 2275 7020 7769  .        f"up wi
-000184a0: 7468 2074 6865 207b 6e61 6d65 735b 315d  th the {names[1]
-000184b0: 7d20 6369 7263 6c65 2073 6f20 7468 6174  } circle so that
-000184c0: 2074 6865 2052 5350 4c49 4e45 2028 7768   the RSPLINE (wh
-000184d0: 6963 6820 220a 2020 2020 2020 2020 6622  ich ".        f"
-000184e0: 7469 6573 2074 6f67 6574 6865 7220 7468  ties together th
-000184f0: 6573 6520 6e65 7720 6772 6964 7320 616e  ese new grids an
-00018500: 6420 7468 6520 7b6e 616d 6573 5b31 5d7d  d the {names[1]}
-00018510: 2067 7269 6473 2920 7769 6c6c 2022 0a20   grids) will ". 
-00018520: 2020 2020 2020 2022 6265 2073 6d6f 6f74         "be smoot
-00018530: 682e 220a 2020 2020 290a 2020 2020 662e  h.".    ).    f.
-00018540: 7772 6974 6528 6d6b 636f 6d6d 656e 7428  write(mkcomment(
-00018550: 636f 6d6d 656e 7429 290a 2020 2020 7665  comment)).    ve
-00018560: 6320 3d20 6e70 2e61 7261 6e67 6528 6e31  c = np.arange(n1
-00018570: 290a 2020 2020 6e65 7769 6473 203d 206e  ).    newids = n
-00018580: 6f64 655f 6964 3020 2b20 7665 630a 2020  ode_id0 + vec.  
-00018590: 2020 7262 6532 6964 7320 3d20 7262 6532    rbe2ids = rbe2
-000185a0: 5f69 6430 202b 2076 6563 0a20 2020 2077  _id0 + vec.    w
-000185b0: 7467 7269 6473 2866 2c20 6e65 7769 6473  tgrids(f, newids
-000185c0: 2c20 7879 7a3d 6e65 7770 7473 2c20 6370  , xyz=newpts, cp
-000185d0: 3d63 6f72 645f 6964 290a 0a20 2020 2063  =cord_id)..    c
-000185e0: 6f6d 6d65 6e74 203d 2028 0a20 2020 2020  omment = (.     
-000185f0: 2020 2066 2252 4245 3220 7468 6520 7b6e     f"RBE2 the {n
-00018600: 616d 6573 5b30 5d7d 206e 6f64 6573 2074  ames[0]} nodes t
-00018610: 6f20 6e65 7720 6e6f 6465 7320 6372 6561  o new nodes crea
-00018620: 7465 6420 6162 6f76 6520 220a 2020 2020  ted above ".    
-00018630: 2020 2020 2228 7468 6520 6e65 7720 6e6f      "(the new no
-00018640: 6465 7320 6172 6520 696e 6465 7065 6e64  des are independ
-00018650: 656e 7429 3a22 0a20 2020 2029 0a20 2020  ent):".    ).   
-00018660: 2066 2e77 7269 7465 286d 6b63 6f6d 6d65   f.write(mkcomme
-00018670: 6e74 2863 6f6d 6d65 6e74 2929 0a20 2020  nt(comment)).   
-00018680: 2077 7269 7465 722e 7665 6377 7269 7465   writer.vecwrite
-00018690: 2866 2c20 2252 4245 322c 7b7d 2c7b 7d2c  (f, "RBE2,{},{},
-000186a0: 3132 3334 3536 2c7b 7d5c 6e22 2c20 7262  123456,{}\n", rb
-000186b0: 6532 6964 732c 206e 6577 6964 732c 2072  e2ids, newids, r
-000186c0: 696e 6731 5f69 6473 290a 2020 2020 7265  ing1_ids).    re
-000186d0: 7475 726e 206e 6577 7074 732c 206e 6577  turn newpts, new
-000186e0: 6964 730a 0a0a 6465 6620 5f73 6f72 745f  ids...def _sort_
-000186f0: 6e5f 7772 6974 6528 0a20 2020 2066 2c20  n_write(.    f, 
-00018700: 696e 6465 7065 6e64 656e 742c 2063 6972  independent, cir
-00018710: 635f 7061 726d 732c 206e 6577 7074 732c  c_parms, newpts,
-00018720: 206e 6577 6964 732c 2072 696e 6732 5f69   newids, ring2_i
-00018730: 6473 2c20 7273 706c 696e 655f 6964 302c  ds, rspline_id0,
-00018740: 2044 6f4c 2c20 6e61 6d65 730a 293a 0a20   DoL, names.):. 
-00018750: 2020 206e 3120 3d20 6369 7263 5f70 6172     n1 = circ_par
-00018760: 6d73 5b30 5d2e 6c6f 6361 6c2e 7368 6170  ms[0].local.shap
-00018770: 655b 315d 0a20 2020 206e 3220 3d20 6369  e[1].    n2 = ci
-00018780: 7263 5f70 6172 6d73 5b31 5d2e 6c6f 6361  rc_parms[1].loca
-00018790: 6c2e 7368 6170 655b 315d 0a0a 2020 2020  l.shape[1]..    
-000187a0: 2320 2d20 746f 2064 6f20 7468 6973 2069  # - to do this i
-000187b0: 6e20 6f72 6465 722c 2077 6520 6e65 6564  n order, we need
-000187c0: 2074 6f20 636f 6d70 7574 6520 7468 6569   to compute thei
-000187d0: 7220 616e 676c 6573 0a20 2020 2074 685f  r angles.    th_
-000187e0: 3120 3d20 6e70 2e61 7263 7461 6e32 286e  1 = np.arctan2(n
-000187f0: 6577 7074 735b 3a2c 2031 5d2c 206e 6577  ewpts[:, 1], new
-00018800: 7074 735b 3a2c 2030 5d29 0a20 2020 2072  pts[:, 0]).    r
-00018810: 325f 6c6f 6361 6c20 3d20 6369 7263 5f70  2_local = circ_p
-00018820: 6172 6d73 5b31 5d2e 6c6f 6361 6c2e 540a  arms[1].local.T.
-00018830: 2020 2020 7468 5f32 203d 206e 702e 6172      th_2 = np.ar
-00018840: 6374 616e 3228 7232 5f6c 6f63 616c 5b3a  ctan2(r2_local[:
-00018850: 2c20 315d 2c20 7232 5f6c 6f63 616c 5b3a  , 1], r2_local[:
-00018860: 2c20 305d 290a 2020 2020 7468 203d 206e  , 0]).    th = n
-00018870: 702e 6873 7461 636b 2828 7468 5f31 2c20  p.hstack((th_1, 
-00018880: 7468 5f32 2929 0a20 2020 2074 685b 7468  th_2)).    th[th
-00018890: 203c 202d 3165 2d38 5d20 2b3d 2032 202a   < -1e-8] += 2 *
-000188a0: 206e 702e 7069 0a0a 2020 2020 6964 735f   np.pi..    ids_
-000188b0: 3120 3d20 6e70 2e63 6f6c 756d 6e5f 7374  1 = np.column_st
-000188c0: 6163 6b28 286e 6577 6964 732c 206e 702e  ack((newids, np.
-000188d0: 7a65 726f 7328 6e31 2c20 6e70 2e69 6e74  zeros(n1, np.int
-000188e0: 3634 2929 290a 2020 2020 6964 735f 3220  64))).    ids_2 
-000188f0: 3d20 6e70 2e63 6f6c 756d 6e5f 7374 6163  = np.column_stac
-00018900: 6b28 2872 696e 6732 5f69 6473 2c20 6e70  k((ring2_ids, np
-00018910: 2e7a 6572 6f73 286e 322c 206e 702e 696e  .zeros(n2, np.in
-00018920: 7436 3429 2929 0a0a 2020 2020 6966 2069  t64)))..    if i
-00018930: 6e64 6570 656e 6465 6e74 203d 3d20 2272  ndependent == "r
-00018940: 696e 6731 223a 0a20 2020 2020 2020 2063  ing1":.        c
-00018950: 6f6d 6d65 6e74 203d 2028 0a20 2020 2020  omment = (.     
-00018960: 2020 2020 2020 2066 2252 5350 4c49 4e45         f"RSPLINE
-00018970: 2074 6865 207b 6e61 6d65 735b 315d 7d20   the {names[1]} 
-00018980: 6e6f 6465 7320 746f 2074 6865 206e 6577  nodes to the new
-00018990: 206e 6f64 6573 2063 7265 6174 6564 2022   nodes created "
-000189a0: 0a20 2020 2020 2020 2020 2020 2022 6162  .            "ab
-000189b0: 6f76 652c 2077 6974 6820 7468 6520 6e65  ove, with the ne
-000189c0: 7720 6e6f 6465 7320 6265 696e 6720 696e  w nodes being in
-000189d0: 6465 7065 6e64 656e 742e 220a 2020 2020  dependent.".    
-000189e0: 2020 2020 290a 2020 2020 2020 2020 6964      ).        id
-000189f0: 735f 315b 3a2c 2031 5d20 3d20 310a 2020  s_1[:, 1] = 1.  
-00018a00: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00018a10: 636f 6d6d 656e 7420 3d20 280a 2020 2020  comment = (.    
-00018a20: 2020 2020 2020 2020 6622 5253 504c 494e          f"RSPLIN
-00018a30: 4520 7468 6520 6e65 7720 6e6f 6465 7320  E the new nodes 
-00018a40: 6372 6561 7465 6420 6162 6f76 6520 746f  created above to
-00018a50: 2074 6865 207b 6e61 6d65 735b 315d 7d20   the {names[1]} 
-00018a60: 220a 2020 2020 2020 2020 2020 2020 6622  ".            f"
-00018a70: 6e6f 6465 732c 2077 6974 6820 7468 6520  nodes, with the 
-00018a80: 7b6e 616d 6573 5b31 5d7d 206e 6f64 6573  {names[1]} nodes
-00018a90: 2062 6569 6e67 2069 6e64 6570 656e 6465   being independe
-00018aa0: 6e74 2e22 0a20 2020 2020 2020 2029 0a20  nt.".        ). 
-00018ab0: 2020 2020 2020 2069 6473 5f32 5b3a 2c20         ids_2[:, 
-00018ac0: 315d 203d 2031 0a0a 2020 2020 662e 7772  1] = 1..    f.wr
-00018ad0: 6974 6528 6d6b 636f 6d6d 656e 7428 636f  ite(mkcomment(co
-00018ae0: 6d6d 656e 7429 290a 2020 2020 6964 7320  mment)).    ids 
-00018af0: 3d20 6e70 2e76 7374 6163 6b28 2869 6473  = np.vstack((ids
-00018b00: 5f31 2c20 6964 735f 3229 290a 0a20 2020  _1, ids_2))..   
-00018b10: 2023 2073 6f72 7420 6279 2061 6e67 756c   # sort by angul
-00018b20: 6172 206c 6f63 6174 696f 6e3a 0a20 2020  ar location:.   
-00018b30: 2069 203d 206e 702e 6172 6773 6f72 7428   i = np.argsort(
-00018b40: 7468 290a 2020 2020 6964 7320 3d20 6964  th).    ids = id
-00018b50: 735b 695d 0a20 2020 2069 203d 2030 0a20  s[i].    i = 0. 
-00018b60: 2020 2077 6869 6c65 2069 6473 5b69 2c20     while ids[i, 
-00018b70: 315d 203d 3d20 303a 0a20 2020 2020 2020  1] == 0:.       
-00018b80: 2069 202b 3d20 310a 2020 2020 2320 7374   i += 1.    # st
-00018b90: 6163 6b20 6964 732c 2065 6e73 7572 696e  ack ids, ensurin
-00018ba0: 6720 7374 6172 7469 6e67 2061 6e64 2065  g starting and e
-00018bb0: 6e64 696e 6720 6e6f 6465 2069 7320 696e  nding node is in
-00018bc0: 6465 7065 6e64 656e 743a 0a20 2020 2069  dependent:.    i
-00018bd0: 6473 203d 206e 702e 7673 7461 636b 2828  ds = np.vstack((
-00018be0: 6964 735b 693a 5d2c 2069 6473 5b3a 695d  ids[i:], ids[:i]
-00018bf0: 2c20 6964 735b 695d 2929 0a20 2020 2077  , ids[i])).    w
-00018c00: 7472 7370 6c69 6e65 2866 2c20 7273 706c  trspline(f, rspl
-00018c10: 696e 655f 6964 302c 2069 6473 2c20 446f  ine_id0, ids, Do
-00018c20: 4c3d 446f 4c29 0a20 2020 2072 6574 7572  L=DoL).    retur
-00018c30: 6e20 6964 730a 0a0a 6465 6620 5f70 6c6f  n ids...def _plo
-00018c40: 745f 7273 706c 696e 6528 0a20 2020 2061  t_rspline(.    a
-00018c50: 782c 0a20 2020 2063 6972 635f 7061 726d  x,.    circ_parm
-00018c60: 732c 0a20 2020 2078 797a 2c0a 2020 2020  s,.    xyz,.    
-00018c70: 6e65 7770 7473 2c0a 2020 2020 6e65 7769  newpts,.    newi
-00018c80: 6473 2c0a 2020 2020 6261 7369 6332 6c6f  ds,.    basic2lo
-00018c90: 6361 6c2c 0a20 2020 2063 656e 7465 722c  cal,.    center,
-00018ca0: 0a20 2020 2072 7370 6c69 6e65 5f6e 6f64  .    rspline_nod
-00018cb0: 6573 2c0a 2020 2020 7269 6e67 325f 6964  es,.    ring2_id
-00018cc0: 732c 0a20 2020 206e 616d 6573 2c0a 293a  s,.    names,.):
-00018cd0: 0a20 2020 2066 6f72 2069 7465 6d20 696e  .    for item in
-00018ce0: 2022 7879 7a22 3a0a 2020 2020 2020 2020   "xyz":.        
-00018cf0: 6765 745f 6675 6e63 203d 2067 6574 6174  get_func = getat
-00018d00: 7472 2861 782c 2066 2267 6574 5f7b 6974  tr(ax, f"get_{it
-00018d10: 656d 7d6c 6162 656c 2229 0a20 2020 2020  em}label").     
-00018d20: 2020 2069 6620 6e6f 7420 6765 745f 6675     if not get_fu
-00018d30: 6e63 2829 3a0a 2020 2020 2020 2020 2020  nc():.          
-00018d40: 2020 7365 745f 6675 6e63 203d 2067 6574    set_func = get
-00018d50: 6174 7472 2861 782c 2066 2273 6574 5f7b  attr(ax, f"set_{
-00018d60: 6974 656d 7d6c 6162 656c 2229 0a20 2020  item}label").   
-00018d70: 2020 2020 2020 2020 2073 6574 5f66 756e           set_fun
-00018d80: 6328 6974 656d 2e75 7070 6572 2829 290a  c(item.upper()).
-00018d90: 0a20 2020 2023 2064 7261 7720 7468 6520  .    # draw the 
-00018da0: 6669 7420 666f 7220 6369 7263 6c65 733a  fit for circles:
-00018db0: 0a20 2020 2074 6820 3d20 6e70 2e64 6567  .    th = np.deg
-00018dc0: 3272 6164 286e 702e 6172 616e 6765 2830  2rad(np.arange(0
-00018dd0: 2e30 2c20 3336 3129 290a 2020 2020 666f  .0, 361)).    fo
-00018de0: 7220 6e75 6d2c 2028 7061 726d 732c 206c  r num, (parms, l
-00018df0: 696e 6529 2069 6e20 656e 756d 6572 6174  ine) in enumerat
-00018e00: 6528 7a69 7028 6369 7263 5f70 6172 6d73  e(zip(circ_parms
-00018e10: 2c20 2822 2b22 2c20 2278 2229 2929 3a0a  , ("+", "x"))):.
-00018e20: 2020 2020 2020 2020 7820 3d20 7061 726d          x = parm
-00018e30: 732e 7261 6469 7573 202a 206e 702e 636f  s.radius * np.co
-00018e40: 7328 7468 290a 2020 2020 2020 2020 7920  s(th).        y 
-00018e50: 3d20 7061 726d 732e 7261 6469 7573 202a  = parms.radius *
-00018e60: 206e 702e 7369 6e28 7468 290a 2020 2020   np.sin(th).    
-00018e70: 2020 2020 7a20 3d20 3020 2a20 780a 2020      z = 0 * x.  
-00018e80: 2020 2020 2020 2320 7472 616e 7366 6f72        # transfor
-00018e90: 6d20 746f 2062 6173 6963 2063 6f6f 7264  m to basic coord
-00018ea0: 696e 6174 6573 2061 6e64 2070 6c6f 743a  inates and plot:
-00018eb0: 0a20 2020 2020 2020 2063 6972 636c 655f  .        circle_
-00018ec0: 6261 7369 6320 3d20 280a 2020 2020 2020  basic = (.      
-00018ed0: 2020 2020 2020 7061 726d 732e 6365 6e74        parms.cent
-00018ee0: 6572 202b 2028 6e70 2e63 6f6c 756d 6e5f  er + (np.column_
-00018ef0: 7374 6163 6b28 2878 2c20 792c 207a 2929  stack((x, y, z))
-00018f00: 2040 2070 6172 6d73 2e62 6173 6963 326c   @ parms.basic2l
-00018f10: 6f63 616c 290a 2020 2020 2020 2020 292e  ocal).        ).
-00018f20: 540a 2020 2020 2020 2020 6820 3d20 6178  T.        h = ax
-00018f30: 2e70 6c6f 7428 0a20 2020 2020 2020 2020  .plot(.         
-00018f40: 2020 202a 7879 7a5b 6e75 6d5d 2e54 2c0a     *xyz[num].T,.
-00018f50: 2020 2020 2020 2020 2020 2020 6c69 6e65              line
-00018f60: 2c0a 2020 2020 2020 2020 2020 2020 6d61  ,.            ma
-00018f70: 726b 6572 7369 7a65 3d38 2e30 2c0a 2020  rkersize=8.0,.  
-00018f80: 2020 2020 2020 2020 2020 6d61 726b 6572            marker
-00018f90: 6564 6765 7769 6474 683d 322e 302c 0a20  edgewidth=2.0,. 
-00018fa0: 2020 2020 2020 2020 2020 206c 6162 656c             label
-00018fb0: 3d66 227b 6e61 6d65 735b 6e75 6d5d 7d20  =f"{names[num]} 
-00018fc0: 6e6f 6465 7322 2c0a 2020 2020 2020 2020  nodes",.        
-00018fd0: 295b 305d 0a20 2020 2020 2020 2061 782e  )[0].        ax.
-00018fe0: 706c 6f74 282a 6369 7263 6c65 5f62 6173  plot(*circle_bas
-00018ff0: 6963 2c20 682e 6765 745f 636f 6c6f 7228  ic, h.get_color(
-00019000: 292c 206c 6162 656c 3d66 227b 6e61 6d65  ), label=f"{name
-00019010: 735b 6e75 6d5d 7d20 6265 7374 2d66 6974  s[num]} best-fit
-00019020: 2063 6972 636c 6522 290a 0a20 2020 2023   circle")..    #
-00019030: 2067 6574 2062 6173 6963 2063 6f6f 7264   get basic coord
-00019040: 696e 6174 6573 206f 6620 6e65 7770 7473  inates of newpts
-00019050: 3a0a 2020 2020 6e65 7770 7473 5f62 6173  :.    newpts_bas
-00019060: 6963 203d 206e 6577 7074 7320 4020 6261  ic = newpts @ ba
-00019070: 7369 6332 6c6f 6361 6c20 2b20 6365 6e74  sic2local + cent
-00019080: 6572 0a0a 2020 2020 7365 676d 656e 7473  er..    segments
-00019090: 203d 206e 702e 656d 7074 7928 2833 202a   = np.empty((3 *
-000190a0: 206e 6577 7074 732e 7368 6170 655b 305d   newpts.shape[0]
-000190b0: 2c20 3329 290a 2020 2020 7365 676d 656e  , 3)).    segmen
-000190c0: 7473 5b3a 3a33 5d20 3d20 6e65 7770 7473  ts[::3] = newpts
-000190d0: 5f62 6173 6963 0a20 2020 2073 6567 6d65  _basic.    segme
-000190e0: 6e74 735b 313a 3a33 5d20 3d20 7879 7a5b  nts[1::3] = xyz[
-000190f0: 305d 0a20 2020 2073 6567 6d65 6e74 735b  0].    segments[
-00019100: 323a 3a33 5d20 3d20 6e70 2e6e 616e 0a0a  2::3] = np.nan..
-00019110: 2020 2020 6820 3d20 6178 2e70 6c6f 7428      h = ax.plot(
-00019120: 0a20 2020 2020 2020 202a 6e65 7770 7473  .        *newpts
-00019130: 5f62 6173 6963 2e54 2c0a 2020 2020 2020  _basic.T,.      
-00019140: 2020 226f 222c 0a20 2020 2020 2020 206d    "o",.        m
-00019150: 6172 6b65 7273 697a 653d 352e 302c 0a20  arkersize=5.0,. 
-00019160: 2020 2020 2020 206d 6172 6b65 7265 6467         markeredg
-00019170: 6577 6964 7468 3d32 2e30 2c0a 2020 2020  ewidth=2.0,.    
-00019180: 2020 2020 6c61 6265 6c3d 2822 4e65 7720      label=("New 
-00019190: 7b7d 206e 6f64 6573 5c6e 202d 2073 686f  {} nodes\n - sho
-000191a0: 756c 6420 6265 206f 6e20 7b7d 2063 6972  uld be on {} cir
-000191b0: 636c 6522 292e 666f 726d 6174 282a 6e61  cle").format(*na
-000191c0: 6d65 7329 2c0a 2020 2020 295b 305d 0a20  mes),.    )[0]. 
-000191d0: 2020 2061 782e 706c 6f74 280a 2020 2020     ax.plot(.    
-000191e0: 2020 2020 2a73 6567 6d65 6e74 732e 542c      *segments.T,
-000191f0: 0a20 2020 2020 2020 2022 2d22 2c0a 2020  .        "-",.  
-00019200: 2020 2020 2020 636f 6c6f 723d 682e 6765        color=h.ge
-00019210: 745f 636f 6c6f 7228 292c 0a20 2020 2020  t_color(),.     
-00019220: 2020 206c 6162 656c 3d66 2252 4245 3273     label=f"RBE2s
-00019230: 202d 2073 686f 756c 6420 6265 207b 6e61   - should be {na
-00019240: 6d65 735b 305d 7d20 7261 6469 616c 222c  mes[0]} radial",
-00019250: 0a20 2020 2029 0a0a 2020 2020 2320 706c  .    )..    # pl
-00019260: 6f74 2074 6865 2072 7370 6c69 6e65 3a0a  ot the rspline:.
-00019270: 2020 2020 756e 736f 7274 6564 5f72 7370      unsorted_rsp
-00019280: 6c69 6e65 5f6e 6f64 6573 203d 206e 702e  line_nodes = np.
-00019290: 6873 7461 636b 2828 6e65 7769 6473 2c20  hstack((newids, 
-000192a0: 7269 6e67 325f 6964 7329 290a 2020 2020  ring2_ids)).    
-000192b0: 7076 203d 206c 6f63 6174 652e 6d61 745f  pv = locate.mat_
-000192c0: 696e 7465 7273 6563 7428 756e 736f 7274  intersect(unsort
-000192d0: 6564 5f72 7370 6c69 6e65 5f6e 6f64 6573  ed_rspline_nodes
-000192e0: 2c20 7273 706c 696e 655f 6e6f 6465 735b  , rspline_nodes[
-000192f0: 3a2c 2030 5d2c 2032 290a 0a20 2020 2072  :, 0], 2)..    r
-00019300: 7370 6c69 6e65 5f78 797a 203d 206e 702e  spline_xyz = np.
-00019310: 7673 7461 636b 2828 6e65 7770 7473 5f62  vstack((newpts_b
-00019320: 6173 6963 2c20 7879 7a5b 315d 2929 5b70  asic, xyz[1]))[p
-00019330: 765b 305d 5d0a 2020 2020 6178 2e70 6c6f  v[0]].    ax.plo
-00019340: 7428 2a72 7370 6c69 6e65 5f78 797a 2e54  t(*rspline_xyz.T
-00019350: 2c20 222d 2d22 2c20 616c 7068 613d 302e  , "--", alpha=0.
-00019360: 372c 206c 696e 6577 6964 7468 3d33 2e30  7, linewidth=3.0
-00019370: 2c20 6c61 6265 6c3d 2246 696e 616c 2052  , label="Final R
-00019380: 5350 4c49 4e45 2229 0a0a 2020 2020 7974  SPLINE")..    yt
-00019390: 6f6f 6c73 2e61 7869 735f 6571 7561 6c5f  ools.axis_equal_
-000193a0: 3364 2861 7829 0a20 2020 2061 782e 6c65  3d(ax).    ax.le
-000193b0: 6765 6e64 286c 6f63 3d22 7570 7065 7220  gend(loc="upper 
-000193c0: 6c65 6674 222c 2062 626f 785f 746f 5f61  left", bbox_to_a
-000193d0: 6e63 686f 723d 2831 2e30 2c20 312e 3029  nchor=(1.0, 1.0)
-000193e0: 290a 2020 2020 6178 2e67 6574 5f66 6967  ).    ax.get_fig
-000193f0: 7572 6528 292e 7469 6768 745f 6c61 796f  ure().tight_layo
-00019400: 7574 2829 0a0a 0a64 6566 2077 7472 7370  ut()...def wtrsp
-00019410: 6c69 6e65 5f72 696e 6773 280a 2020 2020  line_rings(.    
-00019420: 662c 0a20 2020 2072 3167 7269 6473 2c0a  f,.    r1grids,.
-00019430: 2020 2020 7232 6772 6964 732c 0a20 2020      r2grids,.   
-00019440: 206e 6f64 655f 6964 302c 0a20 2020 2072   node_id0,.    r
-00019450: 7370 6c69 6e65 5f69 6430 2c0a 2020 2020  spline_id0,.    
-00019460: 7262 6532 5f69 6430 3d4e 6f6e 652c 0a20  rbe2_id0=None,. 
-00019470: 2020 2063 6f72 645f 6964 3d4e 6f6e 652c     cord_id=None,
-00019480: 0a20 2020 206d 616b 6570 6c6f 743d 226e  .    makeplot="n
-00019490: 6577 222c 0a20 2020 2044 6f4c 3d22 302e  ew",.    DoL="0.
-000194a0: 3122 2c0a 2020 2020 696e 6465 7065 6e64  1",.    independ
-000194b0: 656e 743d 2272 696e 6731 222c 0a29 3a0a  ent="ring1",.):.
-000194c0: 2020 2020 2222 220a 2020 2020 4372 6561      """.    Crea
-000194d0: 7465 7320 6120 736d 6f6f 7468 2052 5350  tes a smooth RSP
-000194e0: 4c49 4e45 2074 6f20 636f 6e6e 6563 7420  LINE to connect 
-000194f0: 7477 6f20 7269 6e67 7320 6f66 2067 7269  two rings of gri
-00019500: 6473 0a0a 2020 2020 5061 7261 6d65 7465  ds..    Paramete
-00019510: 7273 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d  rs.    ---------
-00019520: 2d0a 2020 2020 6620 3a20 7374 7269 6e67  -.    f : string
-00019530: 206f 7220 6669 6c65 5f6c 696b 6520 6f72   or file_like or
-00019540: 2031 206f 7220 4e6f 6e65 0a20 2020 2020   1 or None.     
-00019550: 2020 2045 6974 6865 7220 6120 6e61 6d65     Either a name
-00019560: 206f 6620 6120 6669 6c65 2c20 6f72 2069   of a file, or i
-00019570: 7320 6120 6669 6c65 5f6c 696b 6520 6f62  s a file_like ob
-00019580: 6a65 6374 2061 7320 7265 7475 726e 6564  ject as returned
-00019590: 0a20 2020 2020 2020 2062 7920 3a66 756e  .        by :fun
-000195a0: 633a 606f 7065 6e60 206f 7220 3a63 6c61  c:`open` or :cla
-000195b0: 7373 3a60 696f 2e53 7472 696e 6749 4f60  ss:`io.StringIO`
-000195c0: 2e20 496e 7075 7420 6173 2069 6e74 6567  . Input as integ
-000195d0: 6572 2031 2074 6f0a 2020 2020 2020 2020  er 1 to.        
-000195e0: 7772 6974 6520 746f 2073 7464 6f75 742e  write to stdout.
-000195f0: 2043 616e 2061 6c73 6f20 6265 2074 6865   Can also be the
-00019600: 206e 616d 6520 6f66 2061 2064 6972 6563   name of a direc
-00019610: 746f 7279 206f 7220 4e6f 6e65 3b0a 2020  tory or None;.  
-00019620: 2020 2020 2020 696e 2074 6865 7365 2063        in these c
-00019630: 6173 6573 2c20 6120 4755 4920 6973 206f  ases, a GUI is o
-00019640: 7065 6e65 6420 666f 7220 6669 6c65 2073  pened for file s
-00019650: 656c 6563 7469 6f6e 2e0a 2020 2020 7231  election..    r1
-00019660: 6772 6964 7320 3a20 3264 2061 7272 6179  grids : 2d array
-00019670: 5f6c 696b 6520 6f72 2044 6174 6146 7261  _like or DataFra
-00019680: 6d65 206f 7220 7475 706c 650a 2020 2020  me or tuple.    
-00019690: 2020 2020 4967 6e6f 7269 6e67 2074 6865      Ignoring the
-000196a0: 2074 7570 6c65 2069 6e70 7574 206f 7074   tuple input opt
-000196b0: 696f 6e20 666f 7220 6e6f 772c 2060 7231  ion for now, `r1
-000196c0: 6772 6964 7360 2063 6f6e 7461 696e 730a  grids` contains.
-000196d0: 2020 2020 2020 2020 7468 6520 6964 7320          the ids 
-000196e0: 616e 6420 6c6f 6361 7469 6f6e 7320 6f66  and locations of
-000196f0: 2074 6865 2072 696e 6720 3120 6772 6964   the ring 1 grid
-00019700: 7320 696e 2062 6173 6963 0a20 2020 2020  s in basic.     
-00019710: 2020 2063 6f6f 7264 696e 6174 6573 2e20     coordinates. 
-00019720: 4966 2032 6420 6172 7261 795f 6c69 6b65  If 2d array_like
-00019730: 2c20 6974 2068 6173 2034 2063 6f6c 756d  , it has 4 colum
-00019740: 6e73 2064 6573 6372 6962 696e 6720 7468  ns describing th
-00019750: 650a 2020 2020 2020 2020 7269 6e67 2031  e.        ring 1
-00019760: 2067 7269 6473 3a3a 0a0a 2020 2020 2020   grids::..      
-00019770: 2020 2020 2020 205b 6964 2c20 782c 2079         [id, x, y
-00019780: 2c20 7a5d 203c 202d 2d20 6261 7369 6320  , z] < -- basic 
-00019790: 636f 6f72 6469 6e61 7465 730a 0a20 2020  coordinates..   
-000197a0: 2020 2020 2049 6620 4461 7461 4672 616d       If DataFram
-000197b0: 652c 2069 7420 6973 2061 7373 756d 6564  e, it is assumed
-000197c0: 2074 6f20 6265 2074 6865 2055 5345 5420   to be the USET 
-000197d0: 4461 7461 4672 616d 650a 2020 2020 2020  DataFrame.      
-000197e0: 2020 636f 6e74 6169 6e69 6e67 206a 7573    containing jus
-000197f0: 7420 7468 6520 7269 6e67 2031 2067 7269  t the ring 1 gri
-00019800: 6473 2e20 5468 6520 666f 726d 6174 206f  ds. The format o
-00019810: 6620 7468 6973 0a20 2020 2020 2020 2044  f this.        D
-00019820: 6174 6146 7261 6d65 2069 7320 6465 7363  ataFrame is desc
-00019830: 7269 6265 6420 696e 0a20 2020 2020 2020  ribed in.       
-00019840: 203a 6675 6e63 3a60 7079 7965 7469 2e6e   :func:`pyyeti.n
-00019850: 6173 7472 616e 2e6f 7032 2e4f 5032 2e72  astran.op2.OP2.r
-00019860: 646e 3263 6f70 3260 2e0a 0a20 2020 2020  dn2cop2`...     
-00019870: 2020 2054 6865 2064 6566 6175 6c74 206e     The default n
-00019880: 616d 6520 696e 2074 6865 206f 7574 7075  ame in the outpu
-00019890: 7420 636f 6d6d 656e 7473 2066 6f72 2072  t comments for r
-000198a0: 696e 6720 3120 6973 2027 5269 6e67 0a20  ing 1 is 'Ring. 
-000198b0: 2020 2020 2020 2031 272e 2042 7920 7573         1'. By us
-000198c0: 696e 6720 7468 6520 7475 706c 6520 696e  ing the tuple in
-000198d0: 7075 7420 6f70 7469 6f6e 2c20 796f 7520  put option, you 
-000198e0: 6361 6e20 7072 6f76 6964 6520 610a 2020  can provide a.  
-000198f0: 2020 2020 2020 6e61 6d65 2e20 466f 7220        name. For 
-00019900: 6578 616d 706c 652c 2074 6865 2064 6566  example, the def
-00019910: 6175 6c74 2069 7320 6571 7569 7661 6c65  ault is equivale
-00019920: 6e74 2074 6f3a 3a0a 0a20 2020 2020 2020  nt to::..       
-00019930: 2020 2020 2028 2752 696e 6720 3127 2c20       ('Ring 1', 
-00019940: 7231 6772 6964 7329 0a0a 2020 2020 2020  r1grids)..      
-00019950: 2020 2e2e 206e 6f74 653a 3a0a 2020 2020    .. note::.    
-00019960: 2020 2020 2020 2020 204e 6f74 6520 7468           Note th
-00019970: 6174 2077 6865 6e20 7573 696e 6720 6120  at when using a 
-00019980: 5553 4554 2074 6162 6c65 2c20 7468 6520  USET table, the 
-00019990: 6772 6964 7320 6361 6e20 6265 0a20 2020  grids can be.   
-000199a0: 2020 2020 2020 2020 2020 6465 6669 6e65            define
-000199b0: 6420 696e 2061 6e79 206c 6f63 616c 2063  d in any local c
-000199c0: 6f6f 7264 696e 6174 6520 7379 7374 656d  oordinate system
-000199d0: 2873 292e 2048 6f77 6576 6572 2c20 626f  (s). However, bo
-000199e0: 7468 0a20 2020 2020 2020 2020 2020 2020  th.             
-000199f0: 6072 3167 7269 6473 6020 616e 6420 6072  `r1grids` and `r
-00019a00: 3267 7269 6473 6020 6d75 7374 2075 7365  2grids` must use
-00019a10: 2074 6865 2073 616d 6520 6261 7369 630a   the same basic.
-00019a20: 2020 2020 2020 2020 2020 2020 2063 6f6f               coo
-00019a30: 7264 696e 6174 6520 7379 7374 656d 2e0a  rdinate system..
-00019a40: 0a20 2020 2072 3267 7269 6473 203a 2032  .    r2grids : 2
-00019a50: 6420 6172 7261 795f 6c69 6b65 206f 7220  d array_like or 
-00019a60: 4461 7461 4672 616d 6520 6f72 2074 7570  DataFrame or tup
-00019a70: 6c65 0a20 2020 2020 2020 2043 6f6e 7461  le.        Conta
-00019a80: 696e 7320 7468 6520 6964 7320 616e 6420  ins the ids and 
-00019a90: 6c6f 6361 7469 6f6e 7320 2861 6e64 206f  locations (and o
-00019aa0: 7074 696f 6e61 6c6c 792c 2074 6865 206e  ptionally, the n
-00019ab0: 616d 6529 206f 660a 2020 2020 2020 2020  ame) of.        
-00019ac0: 7468 6520 7269 6e67 2032 2067 7269 6473  the ring 2 grids
-00019ad0: 2069 6e20 6261 7369 6320 636f 6f72 6469   in basic coordi
-00019ae0: 6e61 7465 732e 2053 6565 2060 7231 6772  nates. See `r1gr
-00019af0: 6964 7360 2066 6f72 0a20 2020 2020 2020  ids` for.       
-00019b00: 2064 6573 6372 6970 7469 6f6e 206f 6620   description of 
-00019b10: 666f 726d 6174 2e20 5468 6520 6465 6661  format. The defa
-00019b20: 756c 7420 6e61 6d65 2066 6f72 2072 696e  ult name for rin
-00019b30: 6720 3220 6973 2027 5269 6e67 0a20 2020  g 2 is 'Ring.   
-00019b40: 2020 2020 2032 272e 0a20 2020 206e 6f64       2'..    nod
-00019b50: 655f 6964 3020 3a20 696e 7465 6765 720a  e_id0 : integer.
-00019b60: 2020 2020 2020 2020 3173 7420 6964 206f          1st id o
-00019b70: 6620 6e65 7720 6e6f 6465 7320 6372 6561  f new nodes crea
-00019b80: 7465 6420 746f 2027 6d6f 7665 2720 7269  ted to 'move' ri
-00019b90: 6e67 2031 206e 6f64 6573 0a20 2020 2072  ng 1 nodes.    r
-00019ba0: 7370 6c69 6e65 5f69 6430 203a 2069 6e74  spline_id0 : int
-00019bb0: 6567 6572 0a20 2020 2020 2020 2031 7374  eger.        1st
-00019bc0: 2069 6420 6f66 2052 5350 4c49 4e45 730a   id of RSPLINEs.
-00019bd0: 2020 2020 7262 6532 5f69 6430 203a 2069      rbe2_id0 : i
-00019be0: 6e74 6567 6572 206f 7220 4e6f 6e65 3b20  nteger or None; 
-00019bf0: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
-00019c00: 2031 7374 2069 6420 6f66 2052 4245 3220   1st id of RBE2 
-00019c10: 656c 656d 656e 7473 2074 6861 7420 7769  elements that wi
-00019c20: 6c6c 2063 6f6e 6e65 6374 206f 6c64 2072  ll connect old r
-00019c30: 696e 6720 3120 6e6f 6465 7320 746f 0a20  ing 1 nodes to. 
-00019c40: 2020 2020 2020 206e 6577 206f 6e65 732e         new ones.
-00019c50: 2049 6620 4e6f 6e65 2c20 6060 7262 6532   If None, ``rbe2
-00019c60: 5f69 6430 203d 206e 6f64 655f 6964 3060  _id0 = node_id0`
-00019c70: 602e 0a20 2020 2063 6f72 645f 6964 203a  `..    cord_id :
-00019c80: 2069 6e74 6567 6572 206f 7220 4e6f 6e65   integer or None
-00019c90: 3b20 6f70 7469 6f6e 616c 0a20 2020 2020  ; optional.     
-00019ca0: 2020 2049 4420 666f 7220 7468 6520 6c6f     ID for the lo
-00019cb0: 6361 6c20 636f 6f72 6469 6e61 7465 2073  cal coordinate s
-00019cc0: 7973 7465 6d20 666f 7220 7468 6520 6072  ystem for the `r
-00019cd0: 3167 7269 6473 602e 2049 6620 4e6f 6e65  1grids`. If None
-00019ce0: 2c0a 2020 2020 2020 2020 6974 2069 7320  ,.        it is 
-00019cf0: 7365 7420 746f 2060 606e 6f64 655f 6964  set to ``node_id
-00019d00: 3020 2a20 3130 6060 2e0a 2020 2020 6d61  0 * 10``..    ma
-00019d10: 6b65 706c 6f74 203a 2073 7472 696e 6720  keplot : string 
-00019d20: 6f72 2061 7865 7320 6f62 6a65 6374 3b20  or axes object; 
-00019d30: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
-00019d40: 2053 7065 6369 6669 6573 2069 6620 616e   Specifies if an
-00019d50: 6420 686f 7720 746f 2070 6c6f 7420 6461  d how to plot da
-00019d60: 7461 2073 686f 7769 6e67 2074 6865 2052  ta showing the R
-00019d70: 5350 4c49 4e45 2e0a 0a20 2020 2020 2020  SPLINE...       
-00019d80: 203d 3d3d 3d3d 3d3d 3d3d 3d3d 2020 203d   ===========   =
-00019d90: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00019da0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 0a20  ==============. 
-00019db0: 2020 2020 2020 2060 6d61 6b65 706c 6f74         `makeplot
-00019dc0: 6020 2020 2044 6573 6372 6970 7469 6f6e  `    Description
-00019dd0: 0a20 2020 2020 2020 203d 3d3d 3d3d 3d3d  .        =======
-00019de0: 3d3d 3d3d 2020 203d 3d3d 3d3d 3d3d 3d3d  ====   =========
-00019df0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00019e00: 3d3d 3d3d 3d3d 0a20 2020 2020 2020 2020  ======.         
-00019e10: 2020 2027 6e6f 2720 2020 2020 2064 6f20     'no'      do 
-00019e20: 6e6f 7420 706c 6f74 0a20 2020 2020 2020  not plot.       
-00019e30: 2020 2763 6c65 6172 2720 2020 2020 2070    'clear'      p
-00019e40: 6c6f 7420 6166 7465 7220 636c 6561 7269  lot after cleari
-00019e50: 6e67 2066 6967 7572 650a 2020 2020 2020  ng figure.      
-00019e60: 2020 2020 2027 6164 6427 2020 2020 2020       'add'      
-00019e70: 706c 6f74 2077 6974 686f 7574 2063 6c65  plot without cle
-00019e80: 6172 696e 6720 6669 6775 7265 0a20 2020  aring figure.   
-00019e90: 2020 2020 2020 2020 276e 6577 2720 2020          'new'   
-00019ea0: 2020 2070 6c6f 7420 696e 206e 6577 2066     plot in new f
-00019eb0: 6967 7572 650a 2020 2020 2020 2020 6178  igure.        ax
-00019ec0: 6573 206f 626a 6563 7420 2020 706c 6f74  es object   plot
-00019ed0: 2069 6e20 6769 7665 6e20 6178 6573 2028   in given axes (
-00019ee0: 6c69 6b65 2027 6164 6427 290a 2020 2020  like 'add').    
-00019ef0: 2020 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d20      =========== 
-00019f00: 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d    ==============
-00019f10: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-00019f20: 3d0a 0a20 2020 2020 2020 204e 6f74 6520  =..        Note 
-00019f30: 7468 6174 2069 6620 606d 616b 6570 6c6f  that if `makeplo
-00019f40: 7460 2069 7320 2761 6464 2720 6f72 2061  t` is 'add' or a
-00019f50: 6e20 6178 6573 206f 626a 6563 742c 2069  n axes object, i
-00019f60: 7420 6d75 7374 2062 650a 2020 2020 2020  t must be.      
-00019f70: 2020 3364 3b20 6f74 6865 7277 6973 6520    3d; otherwise 
-00019f80: 6120 5661 6c75 6545 7272 6f72 2065 7863  a ValueError exc
-00019f90: 6570 7469 6f6e 2069 7320 7261 6973 6564  eption is raised
-00019fa0: 2e0a 0a20 2020 2044 6f4c 203a 2073 7472  ...    DoL : str
-00019fb0: 696e 6720 6f72 2072 6561 6c20 7363 616c  ing or real scal
-00019fc0: 6172 3b20 6f70 7469 6f6e 616c 0a20 2020  ar; optional.   
-00019fd0: 2020 2020 2053 7065 6369 6669 6573 2072       Specifies r
-00019fe0: 6174 696f 206f 6620 6469 616d 6574 6572  atio of diameter
-00019ff0: 206f 6620 656c 6173 7469 6320 7479 6265   of elastic tybe
-0001a000: 2074 6f20 7468 6520 7375 6d20 6f66 2074   to the sum of t
-0001a010: 6865 0a20 2020 2020 2020 206c 656e 6774  he.        lengt
-0001a020: 6873 206f 6620 616c 6c20 7365 676d 656e  hs of all segmen
-0001a030: 7473 2e20 5772 6974 7465 6e20 7769 7468  ts. Written with
-0001a040: 3a20 6060 6627 7b44 6f4c 3a3c 387d 2760  : ``f'{DoL:<8}'`
-0001a050: 600a 2020 2020 696e 6465 7065 6e64 656e  `.    independen
-0001a060: 7420 3a20 7374 723b 206f 7074 696f 6e61  t : str; optiona
-0001a070: 6c0a 2020 2020 2020 2020 4569 7468 6572  l.        Either
-0001a080: 2027 7269 6e67 3127 206f 7220 2772 696e   'ring1' or 'rin
-0001a090: 6732 2720 6f72 2074 6865 2061 7373 6967  g2' or the assig
-0001a0a0: 6e65 6420 6e61 6d65 2069 6620 6f6e 6520  ned name if one 
-0001a0b0: 7761 730a 2020 2020 2020 2020 7072 6f76  was.        prov
-0001a0c0: 6964 6564 2069 6e20 7468 6520 6072 3167  ided in the `r1g
-0001a0d0: 7269 6473 6020 6f72 2060 7232 6772 6964  rids` or `r2grid
-0001a0e0: 7360 2069 6e70 7574 2e20 5468 6973 2069  s` input. This i
-0001a0f0: 6e70 7574 2069 730a 2020 2020 2020 2020  nput is.        
-0001a100: 6361 7365 2d69 6e73 656e 7369 7469 7665  case-insensitive
-0001a110: 2061 6e64 2061 6c6c 2073 7061 6365 7320   and all spaces 
-0001a120: 6172 6520 6967 6e6f 7265 642c 2073 6f20  are ignored, so 
-0001a130: 2752 696e 6720 3127 2069 730a 2020 2020  'Ring 1' is.    
-0001a140: 2020 2020 7468 6520 7361 6d65 2061 7320      the same as 
-0001a150: 2772 696e 6731 272e 2053 7065 6369 6669  'ring1'. Specifi
-0001a160: 6573 2077 6869 6368 2072 696e 6720 7769  es which ring wi
-0001a170: 6c6c 2062 6520 696e 6465 7065 6e64 656e  ll be independen
-0001a180: 740a 2020 2020 2020 2020 6f6e 2074 6865  t.        on the
-0001a190: 2052 5350 4c49 4e45 732e 204e 6f74 6520   RSPLINEs. Note 
-0001a1a0: 7468 6174 2069 7320 6469 6666 6572 656e  that is differen
-0001a1b0: 7420 7468 616e 206a 7573 7420 7377 6974  t than just swit
-0001a1c0: 6368 696e 670a 2020 2020 2020 2020 7468  ching.        th
-0001a1d0: 6520 6f72 6465 7220 6f66 2060 7231 6772  e order of `r1gr
-0001a1e0: 6964 7360 2061 6e64 2060 7232 6772 6964  ids` and `r2grid
-0001a1f0: 7360 2e20 5468 6973 206f 7074 696f 6e20  s`. This option 
-0001a200: 6d6f 6469 6669 6573 0a20 2020 2020 2020  modifies.       
-0001a210: 2073 7465 7020 3420 6265 6c6f 7720 7768   step 4 below wh
-0001a220: 696c 6520 7377 6974 6368 696e 6720 6072  ile switching `r
-0001a230: 3167 7269 6473 6020 616e 6420 6072 3267  1grids` and `r2g
-0001a240: 7269 6473 6020 6d6f 6469 6669 6573 0a20  rids` modifies. 
-0001a250: 2020 2020 2020 2061 6c6c 2074 6865 2073         all the s
-0001a260: 7465 7073 2e0a 0a20 2020 2052 6574 7572  teps...    Retur
-0001a270: 6e73 0a20 2020 202d 2d2d 2d2d 2d2d 0a20  ns.    -------. 
-0001a280: 2020 204e 6f6e 650a 0a20 2020 204e 6f74     None..    Not
-0001a290: 6573 0a20 2020 202d 2d2d 2d2d 0a20 2020  es.    -----.   
-0001a2a0: 2054 6869 7320 726f 7574 696e 6520 7772   This routine wr
-0001a2b0: 6974 6573 2047 5249 442c 2052 4245 3220  ites GRID, RBE2 
-0001a2c0: 616e 6420 5253 504c 494e 4520 6c69 6e65  and RSPLINE line
-0001a2d0: 7320 746f 2074 6865 206f 7574 7075 740a  s to the output.
-0001a2e0: 2020 2020 6669 6c65 2e0a 0a20 2020 2054      file...    T
-0001a2f0: 6865 2061 7070 726f 6163 6820 6973 2061  he approach is a
-0001a300: 7320 666f 6c6c 6f77 7320 284e 203d 206e  s follows (N = n
-0001a310: 756d 6265 7220 6f66 2072 696e 6720 3120  umber of ring 1 
-0001a320: 6772 6964 7329 3a0a 0a20 2020 2020 2031  grids):..      1
-0001a330: 2e20 4669 7420 6120 6369 7263 6c65 2074  . Fit a circle t
-0001a340: 6872 6f75 6768 2062 6f74 6820 7468 6520  hrough both the 
-0001a350: 7269 6e67 2031 206e 6f64 6573 2061 6e64  ring 1 nodes and
-0001a360: 2074 6865 2072 696e 6720 320a 2020 2020   the ring 2.    
-0001a370: 2020 2020 206e 6f64 6573 2e20 4120 6e65       nodes. A ne
-0001a380: 7720 2272 696e 6720 3122 206c 6f63 616c  w "ring 1" local
-0001a390: 2063 6f6f 7264 696e 6174 6520 7379 7374   coordinate syst
-0001a3a0: 656d 2069 7320 6465 6669 6e65 6420 2873  em is defined (s
-0001a3b0: 6565 0a20 2020 2020 2020 2020 3a66 756e  ee.         :fun
-0001a3c0: 633a 6070 7979 6574 692e 7974 6f6f 6c73  c:`pyyeti.ytools
-0001a3d0: 2e66 6974 5f63 6972 636c 655f 3364 6029  .fit_circle_3d`)
-0001a3e0: 2074 6f20 7369 6d70 6c69 6679 2074 6865   to simplify the
-0001a3f0: 2063 7265 6174 696f 6e0a 2020 2020 2020   creation.      
-0001a400: 2020 206f 6620 7468 6520 6e65 7720 5253     of the new RS
-0001a410: 504c 494e 452e 2049 6e20 7468 6520 6c6f  PLINE. In the lo
-0001a420: 6361 6c20 7379 7374 656d 2c20 7a20 6973  cal system, z is
-0001a430: 2070 6572 7065 6e64 6963 756c 6172 0a20   perpendicular. 
-0001a440: 2020 2020 2020 2020 746f 2074 6865 2070          to the p
-0001a450: 6c61 6e65 206f 6620 7468 6520 6369 7263  lane of the circ
-0001a460: 6c65 2061 6e64 2078 2069 7320 616c 6967  le and x is alig
-0001a470: 6e65 6420 7769 7468 206e 6f64 6520 3120  ned with node 1 
-0001a480: 6f66 0a20 2020 2020 2020 2020 7269 6e67  of.         ring
-0001a490: 2031 2e0a 2020 2020 2020 322e 2043 7265   1..      2. Cre
-0001a4a0: 6174 6520 4e20 6e65 7720 7269 6e67 2031  ate N new ring 1
-0001a4b0: 2067 7269 6473 2061 7420 7374 6174 696f   grids at statio
-0001a4c0: 6e20 616e 6420 7261 6469 7573 206f 6620  n and radius of 
-0001a4d0: 7269 6e67 2032 0a20 2020 2020 2020 2020  ring 2.         
-0001a4e0: 6772 6964 732c 2062 7574 2061 7420 7468  grids, but at th
-0001a4f0: 6520 7361 6d65 2061 6e67 756c 6172 206c  e same angular l
-0001a500: 6f63 6174 696f 6e20 6173 206f 7269 6769  ocation as origi
-0001a510: 6e61 6c20 4e2e 0a20 2020 2020 2033 2e20  nal N..      3. 
-0001a520: 5242 4532 2074 6865 7365 206e 6577 2067  RBE2 these new g
-0001a530: 7269 6473 2074 6f20 7468 6520 4e20 6f72  rids to the N or
-0001a540: 6967 696e 616c 2067 7269 6473 2e20 5468  iginal grids. Th
-0001a550: 6520 6e65 7720 6772 6964 730a 2020 2020  e new grids.    
-0001a560: 2020 2020 2061 7265 2069 6e64 6570 656e       are indepen
-0001a570: 6465 6e74 2e0a 2020 2020 2020 342e 2057  dent..      4. W
-0001a580: 7269 7465 2052 5350 4c49 4e45 2063 6172  rite RSPLINE car
-0001a590: 6473 2075 7369 6e67 203a 6675 6e63 3a60  ds using :func:`
-0001a5a0: 7774 7273 706c 696e 6560 2e20 5468 6520  wtrspline`. The 
-0001a5b0: 6669 7273 740a 2020 2020 2020 2020 2052  first.         R
-0001a5c0: 5350 4c49 4e45 2073 7461 7274 7320 6174  SPLINE starts at
-0001a5d0: 2074 6865 2069 6e64 6570 656e 6465 6e74   the independent
-0001a5e0: 2067 7269 6420 286f 6e20 7269 6e67 2031   grid (on ring 1
-0001a5f0: 206f 7220 7269 6e67 2032 0a20 2020 2020   or ring 2.     
-0001a600: 2020 2020 6163 636f 7264 696e 6720 746f      according to
-0001a610: 2060 696e 6465 7065 6e64 656e 7460 2920   `independent`) 
-0001a620: 7769 7468 2074 6865 206c 6f77 6573 7420  with the lowest 
-0001a630: 616e 6775 6c61 720a 2020 2020 2020 2020  angular.        
-0001a640: 206c 6f63 6174 696f 6e2e 2054 6865 2061   location. The a
-0001a650: 6e67 756c 6172 206c 6f63 6174 696f 6e73  ngular locations
-0001a660: 2072 616e 6765 2066 726f 6d20 3020 746f   range from 0 to
-0001a670: 2033 3630 2064 6567 7265 6573 2c0a 2020   360 degrees,.  
-0001a680: 2020 2020 2020 2063 6f75 6e74 6572 2d63         counter-c
-0001a690: 6c6f 636b 7769 7365 2e20 5468 6520 5253  lockwise. The RS
-0001a6a0: 504c 494e 4573 2070 726f 6365 6564 2063  PLINEs proceed c
-0001a6b0: 6f75 6e74 6572 2d63 6c6f 636b 7769 7365  ounter-clockwise
-0001a6c0: 0a20 2020 2020 2020 2020 6172 6f75 6e64  .         around
-0001a6d0: 2074 6865 2063 6972 636c 652e 0a0a 2020   the circle...  
-0001a6e0: 2020 5365 6520 616c 736f 0a20 2020 202d    See also.    -
-0001a6f0: 2d2d 2d2d 2d2d 2d0a 2020 2020 3a66 756e  -------.    :fun
-0001a700: 633a 6077 7472 7370 6c69 6e65 600a 0a20  c:`wtrspline`.. 
-0001a710: 2020 2052 6169 7365 730a 2020 2020 2d2d     Raises.    --
-0001a720: 2d2d 2d2d 0a20 2020 2056 616c 7565 4572  ----.    ValueEr
-0001a730: 726f 720a 0a20 2020 2020 2020 2057 6865  ror..        Whe
-0001a740: 6e20 7468 6520 7065 7270 656e 6469 6375  n the perpendicu
-0001a750: 6c61 7220 6469 7265 6374 696f 6e73 206f  lar directions o
-0001a760: 6620 6072 3167 7269 6473 6020 616e 6420  f `r1grids` and 
-0001a770: 6072 3267 7269 6473 600a 2020 2020 2020  `r2grids`.      
-0001a780: 2020 646f 206e 6f74 206d 6174 6368 2077    do not match w
-0001a790: 6974 6869 6e20 746f 6c65 7261 6e63 653a  ithin tolerance:
-0001a7a0: 2061 6273 6f6c 7574 6520 7661 6c75 6520   absolute value 
-0001a7b0: 6f66 2074 6865 2063 6f73 696e 6520 6f66  of the cosine of
-0001a7c0: 0a20 2020 2020 2020 2074 6865 2061 6e67  .        the ang
-0001a7d0: 6c65 2062 6574 7765 656e 2074 6865 2074  le between the t
-0001a7e0: 776f 2070 6572 7065 6e64 6963 756c 6172  wo perpendicular
-0001a7f0: 2064 6972 6563 7469 6f6e 7320 6d75 7374   directions must
-0001a800: 2062 6520 3e0a 2020 2020 2020 2020 302e   be >.        0.
-0001a810: 3939 2e0a 0a20 2020 2020 2020 2057 6865  99...        Whe
-0001a820: 6e20 6120 6072 3167 7269 6473 6020 6f72  n a `r1grids` or
-0001a830: 2060 7232 6772 6964 7360 2044 6174 6146   `r2grids` DataF
-0001a840: 7261 6d65 2064 6f65 7320 6e6f 7420 6861  rame does not ha
-0001a850: 7665 2061 0a20 2020 2020 2020 206d 756c  ve a.        mul
-0001a860: 7469 706c 6520 6f66 2036 2072 6f77 732e  tiple of 6 rows.
-0001a870: 0a0a 2020 2020 2020 2020 5768 656e 2074  ..        When t
-0001a880: 6865 2060 6d61 6b65 706c 6f74 6020 6f70  he `makeplot` op
-0001a890: 7469 6f6e 2074 7269 6573 2074 6f20 6164  tion tries to ad
-0001a8a0: 6420 746f 2061 6e20 6178 6573 206f 626a  d to an axes obj
-0001a8b0: 6563 7420 7468 6174 0a20 2020 2020 2020  ect that.       
-0001a8c0: 2069 7320 6e6f 7420 7573 696e 6720 6120   is not using a 
-0001a8d0: 3364 2070 726f 6a65 6374 696f 6e2e 0a0a  3d projection...
-0001a8e0: 2020 2020 4578 616d 706c 6573 0a20 2020      Examples.   
-0001a8f0: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 4465   --------.    De
-0001a900: 6669 6e65 2074 776f 2072 696e 6773 206f  fine two rings o
-0001a910: 6620 6772 6964 733a 0a0a 2020 2020 312e  f grids:..    1.
-0001a920: 2052 696e 6720 3120 7769 6c6c 2062 6520   Ring 1 will be 
-0001a930: 6174 2073 7461 7469 6f6e 2030 2e30 2077  at station 0.0 w
-0001a940: 6974 6820 3520 6e6f 6465 7320 6f6e 2072  ith 5 nodes on r
-0001a950: 696e 6720 6f66 2072 6164 6975 730a 2020  ing of radius.  
-0001a960: 2020 2020 2035 302e 2049 4473 2077 696c       50. IDs wil
-0001a970: 6c20 6265 2031 2074 6f20 352e 0a0a 2020  l be 1 to 5...  
-0001a980: 2020 322e 2052 696e 6720 3220 7769 6c6c    2. Ring 2 will
-0001a990: 2062 6520 6174 2073 7461 7469 6f6e 2031   be at station 1
-0001a9a0: 2e30 2077 6974 6820 3720 6e6f 6465 7320  .0 with 7 nodes 
-0001a9b0: 6f6e 2072 696e 6720 6f66 2072 6164 6975  on ring of radiu
-0001a9c0: 730a 2020 2020 2020 2034 352e 2049 4473  s.       45. IDs
-0001a9d0: 2077 696c 6c20 6265 2031 3031 2074 6f20   will be 101 to 
-0001a9e0: 3130 372e 0a0a 2020 2020 466f 7220 6465  107...    For de
-0001a9f0: 6d6f 6e73 7472 6174 696f 6e2c 2072 696e  monstration, rin
-0001aa00: 6720 3120 7769 6c6c 2062 6520 6e61 6d65  g 1 will be name
-0001aa10: 6420 2753 7061 6365 6372 6166 7427 2077  d 'Spacecraft' w
-0001aa20: 6869 6c65 2074 6865 0a20 2020 2064 6566  hile the.    def
-0001aa30: 6175 6c74 2077 696c 6c20 6265 2061 6363  ault will be acc
-0001aa40: 6570 7465 6420 666f 7220 7269 6e67 2032  epted for ring 2
-0001aa50: 2028 7768 6963 6820 6973 2027 5269 6e67   (which is 'Ring
-0001aa60: 2032 2729 2e0a 0a20 2020 202e 2e20 706c   2')...    .. pl
-0001aa70: 6f74 3a3a 0a20 2020 2020 2020 203a 636f  ot::.        :co
-0001aa80: 6e74 6578 743a 2063 6c6f 7365 2d66 6967  ntext: close-fig
-0001aa90: 730a 0a20 2020 2020 2020 203e 3e3e 2069  s..        >>> i
-0001aaa0: 6d70 6f72 7420 6e75 6d70 7920 6173 206e  mport numpy as n
-0001aab0: 700a 2020 2020 2020 2020 3e3e 3e20 696d  p.        >>> im
-0001aac0: 706f 7274 206d 6174 706c 6f74 6c69 622e  port matplotlib.
-0001aad0: 7079 706c 6f74 2061 7320 706c 740a 2020  pyplot as plt.  
-0001aae0: 2020 2020 2020 3e3e 3e20 6672 6f6d 2070        >>> from p
-0001aaf0: 7979 6574 6920 696d 706f 7274 206e 6173  yyeti import nas
-0001ab00: 7472 616e 0a20 2020 2020 2020 203e 3e3e  tran.        >>>
-0001ab10: 2074 6865 7461 3120 3d20 6e70 2e61 7261   theta1 = np.ara
-0001ab20: 6e67 6528 302c 2033 3539 2c20 3336 302f  nge(0, 359, 360/
-0001ab30: 3529 2a6e 702e 7069 2f31 3830 0a20 2020  5)*np.pi/180.   
-0001ab40: 2020 2020 203e 3e3e 2072 6164 3120 3d20       >>> rad1 = 
-0001ab50: 3530 2e0a 2020 2020 2020 2020 3e3e 3e20  50..        >>> 
-0001ab60: 7374 6131 203d 2030 2e0a 2020 2020 2020  sta1 = 0..      
-0001ab70: 2020 3e3e 3e20 6e31 203d 206c 656e 2874    >>> n1 = len(t
-0001ab80: 6865 7461 3129 0a20 2020 2020 2020 203e  heta1).        >
-0001ab90: 3e3e 2072 696e 6731 203d 206e 702e 7673  >> ring1 = np.vs
-0001aba0: 7461 636b 2828 6e70 2e61 7261 6e67 6528  tack((np.arange(
-0001abb0: 312c 206e 312b 3129 2c20 2020 2020 2023  1, n1+1),      #
-0001abc0: 2049 440a 2020 2020 2020 2020 2e2e 2e20   ID.        ... 
-0001abd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001abe0: 2020 2073 7461 312a 6e70 2e6f 6e65 7328     sta1*np.ones(
-0001abf0: 6e31 292c 2020 2020 2020 2020 2320 780a  n1),        # x.
-0001ac00: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
-0001ac10: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0001ac20: 6164 312a 6e70 2e63 6f73 2874 6865 7461  ad1*np.cos(theta
-0001ac30: 3129 2c20 2020 2020 2320 790a 2020 2020  1),     # y.    
-0001ac40: 2020 2020 2e2e 2e20 2020 2020 2020 2020      ...         
-0001ac50: 2020 2020 2020 2020 2020 2072 6164 312a             rad1*
-0001ac60: 6e70 2e73 696e 2874 6865 7461 3129 2929  np.sin(theta1)))
-0001ac70: 2e54 2020 2320 7a0a 2020 2020 2020 2020  .T  # z.        
-0001ac80: 3e3e 3e20 2320 5072 6f76 6964 6520 6120  >>> # Provide a 
-0001ac90: 6e61 6d65 2066 6f72 2072 696e 6720 313a  name for ring 1:
-0001aca0: 0a20 2020 2020 2020 203e 3e3e 2072 696e  .        >>> rin
-0001acb0: 6731 203d 2028 2753 7061 6365 6372 6166  g1 = ('Spacecraf
-0001acc0: 7427 2c20 7269 6e67 3129 0a20 2020 2020  t', ring1).     
-0001acd0: 2020 203e 3e3e 2074 6865 7461 3220 3d20     >>> theta2 = 
-0001ace0: 6e70 2e61 7261 6e67 6528 3130 2c20 3335  np.arange(10, 35
-0001acf0: 392c 2033 3630 2f37 292a 6e70 2e70 692f  9, 360/7)*np.pi/
-0001ad00: 3138 300a 2020 2020 2020 2020 3e3e 3e20  180.        >>> 
-0001ad10: 7261 6432 203d 2034 352e 0a20 2020 2020  rad2 = 45..     
-0001ad20: 2020 203e 3e3e 2073 7461 3220 3d20 312e     >>> sta2 = 1.
-0001ad30: 0a20 2020 2020 2020 203e 3e3e 206e 3220  .        >>> n2 
-0001ad40: 3d20 6c65 6e28 7468 6574 6132 290a 2020  = len(theta2).  
-0001ad50: 2020 2020 2020 3e3e 3e20 7269 6e67 3220        >>> ring2 
-0001ad60: 3d20 6e70 2e76 7374 6163 6b28 286e 702e  = np.vstack((np.
-0001ad70: 6172 616e 6765 2831 2c20 6e32 2b31 292b  arange(1, n2+1)+
-0001ad80: 3130 302c 2020 2320 4944 0a20 2020 2020  100,  # ID.     
-0001ad90: 2020 202e 2e2e 2020 2020 2020 2020 2020     ...          
-0001ada0: 2020 2020 2020 2020 2020 7374 6132 2a6e            sta2*n
-0001adb0: 702e 6f6e 6573 286e 3229 2c20 2020 2020  p.ones(n2),     
-0001adc0: 2020 2023 2078 0a20 2020 2020 2020 202e     # x.        .
-0001add0: 2e2e 2020 2020 2020 2020 2020 2020 2020  ..              
-0001ade0: 2020 2020 2020 7261 6432 2a6e 702e 636f        rad2*np.co
-0001adf0: 7328 7468 6574 6132 292c 2020 2020 2023  s(theta2),     #
-0001ae00: 2079 0a20 2020 2020 2020 202e 2e2e 2020   y.        ...  
-0001ae10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ae20: 2020 7261 6432 2a6e 702e 7369 6e28 7468    rad2*np.sin(th
-0001ae30: 6574 6132 2929 292e 5420 2023 207a 0a20  eta2))).T  # z. 
-0001ae40: 2020 2020 2020 203e 3e3e 2066 6967 203d         >>> fig =
-0001ae50: 2070 6c74 2e66 6967 7572 6528 2745 7861   plt.figure('Exa
-0001ae60: 6d70 6c65 272c 2066 6967 7369 7a65 3d28  mple', figsize=(
-0001ae70: 382c 2036 2929 0a20 2020 2020 2020 203e  8, 6)).        >
-0001ae80: 3e3e 2066 6967 2e63 6c66 2829 0a20 2020  >> fig.clf().   
-0001ae90: 2020 2020 203e 3e3e 2061 7820 3d20 6669       >>> ax = fi
-0001aea0: 672e 6164 645f 7375 6270 6c6f 7428 312c  g.add_subplot(1,
-0001aeb0: 2031 2c20 312c 2070 726f 6a65 6374 696f   1, 1, projectio
-0001aec0: 6e3d 2733 6427 290a 2020 2020 2020 2020  n='3d').        
-0001aed0: 3e3e 3e20 6e61 7374 7261 6e2e 7774 7273  >>> nastran.wtrs
-0001aee0: 706c 696e 655f 7269 6e67 7328 0a20 2020  pline_rings(.   
-0001aef0: 2020 2020 202e 2e2e 2020 2020 2031 2c20       ...     1, 
-0001af00: 7269 6e67 312c 2072 696e 6732 2c20 3130  ring1, ring2, 10
-0001af10: 3031 2c20 3230 3031 2c0a 2020 2020 2020  01, 2001,.      
-0001af20: 2020 2e2e 2e20 2020 2020 6d61 6b65 706c    ...     makepl
-0001af30: 6f74 3d61 7829 2020 2023 2064 6f63 7465  ot=ax)   # docte
-0001af40: 7374 3a20 2b53 4b49 500a 2020 2020 2020  st: +SKIP.      
-0001af50: 2020 240a 2020 2020 2020 2020 2420 4669    $.        $ Fi
-0001af60: 7420 6f66 2053 7061 6365 6372 6166 7420  t of Spacecraft 
-0001af70: 6772 6964 733a 0a20 2020 2020 2020 2024  grids:.        $
-0001af80: 2020 2020 2043 656e 7465 723a 205b 302e       Center: [0.
-0001af90: 3030 302c 2030 2e30 3030 2c20 302e 3030  000, 0.000, 0.00
-0001afa0: 305d 2028 696e 2062 6173 6963 290a 2020  0] (in basic).  
-0001afb0: 2020 2020 2020 2420 2020 2020 5261 6469        $     Radi
-0001afc0: 7573 3a20 3530 2e30 0a20 2020 2020 2020  us: 50.0.       
-0001afd0: 2024 0a20 2020 2020 2020 2024 2046 6974   $.        $ Fit
-0001afe0: 206f 6620 5269 6e67 2032 2067 7269 6473   of Ring 2 grids
-0001aff0: 3a0a 2020 2020 2020 2020 2420 2020 2020  :.        $     
-0001b000: 4365 6e74 6572 3a20 5b31 2e30 3030 2c20  Center: [1.000, 
-0001b010: 2d31 2e37 3736 652d 3135 2c20 2d33 2e35  -1.776e-15, -3.5
-0001b020: 3533 652d 3135 5d20 2869 6e20 6261 7369  53e-15] (in basi
-0001b030: 6329 0a20 2020 2020 2020 2024 2020 2020  c).        $    
-0001b040: 2052 6164 6975 733a 2034 352e 300a 2020   Radius: 45.0.  
-0001b050: 2020 2020 2020 240a 2020 2020 2020 2020        $.        
-0001b060: 2420 4f72 6967 696e 206f 6620 6c6f 6361  $ Origin of loca
-0001b070: 6c20 434f 5244 3252 2031 3030 3130 2069  l CORD2R 10010 i
-0001b080: 7320 6174 2063 656e 7465 7220 6f66 2053  s at center of S
-0001b090: 7061 6365 6372 6166 743b 207a 2069 730a  pacecraft; z is.
-0001b0a0: 2020 2020 2020 2020 2420 7065 7270 656e          $ perpen
-0001b0b0: 6469 6375 6c61 7220 746f 2070 6c61 6e65  dicular to plane
-0001b0c0: 206f 6620 6369 7263 6c65 2c20 616e 6420   of circle, and 
-0001b0d0: 7820 6973 2061 6c69 676e 6564 2077 6974  x is aligned wit
-0001b0e0: 6820 6e6f 6465 2031 2028 616e 640a 2020  h node 1 (and.  
-0001b0f0: 2020 2020 2020 2420 6e65 7720 6e6f 6465        $ new node
-0001b100: 2031 3030 3129 2e0a 2020 2020 2020 2020   1001)..        
-0001b110: 240a 2020 2020 2020 2020 2420 436f 6f72  $.        $ Coor
-0001b120: 6469 6e61 7465 2031 3030 3130 3a0a 2020  dinate 10010:.  
-0001b130: 2020 2020 2020 434f 5244 3252 2a20 2020        CORD2R*   
-0001b140: 2020 2020 2020 2020 2031 3030 3130 2020           10010  
-0001b150: 2020 2020 2020 2020 2020 2020 2030 2020               0  
-0001b160: 302e 3030 3030 3030 3030 652b 3030 2020  0.00000000e+00  
-0001b170: 302e 3030 3030 3030 3030 652b 3030 2a0a  0.00000000e+00*.
-0001b180: 2020 2020 2020 2020 2a20 2020 2020 2020          *       
-0001b190: 2020 302e 3030 3030 3030 3030 652b 3030    0.00000000e+00
-0001b1a0: 2020 312e 3030 3030 3030 3030 652b 3030    1.00000000e+00
-0001b1b0: 2020 302e 3030 3030 3030 3030 652b 3030    0.00000000e+00
-0001b1c0: 2020 302e 3030 3030 3030 3030 652b 3030    0.00000000e+00
-0001b1d0: 2a0a 2020 2020 2020 2020 2a20 2020 2020  *.        *     
-0001b1e0: 2020 2020 302e 3030 3030 3030 3030 652b      0.00000000e+
-0001b1f0: 3030 2020 312e 3030 3030 3030 3030 652b  00  1.00000000e+
-0001b200: 3030 2020 302e 3030 3030 3030 3030 652b  00  0.00000000e+
-0001b210: 3030 0a20 2020 2020 2020 2024 0a20 2020  00.        $.   
-0001b220: 2020 2020 2024 2047 7269 6473 2074 6f20       $ Grids to 
-0001b230: 5242 4532 2074 6f20 7468 6520 5370 6163  RBE2 to the Spac
-0001b240: 6563 7261 6674 2067 7269 6473 2e20 5468  ecraft grids. Th
-0001b250: 6573 6520 6772 6964 7320 6c69 6e65 2075  ese grids line u
-0001b260: 7020 7769 7468 2074 6865 0a20 2020 2020  p with the.     
-0001b270: 2020 2024 2052 696e 6720 3220 6369 7263     $ Ring 2 circ
-0001b280: 6c65 2073 6f20 7468 6174 2074 6865 2052  le so that the R
-0001b290: 5350 4c49 4e45 2028 7768 6963 6820 7469  SPLINE (which ti
-0001b2a0: 6573 2074 6f67 6574 6865 7220 7468 6573  es together thes
-0001b2b0: 6520 6e65 7720 6772 6964 730a 2020 2020  e new grids.    
-0001b2c0: 2020 2020 2420 616e 6420 7468 6520 5269      $ and the Ri
-0001b2d0: 6e67 2032 2067 7269 6473 2920 7769 6c6c  ng 2 grids) will
-0001b2e0: 2062 6520 736d 6f6f 7468 2e0a 2020 2020   be smooth..    
-0001b2f0: 2020 2020 240a 2020 2020 2020 2020 4752      $.        GR
-0001b300: 4944 2a20 2020 2020 2020 2020 2020 2020  ID*             
-0001b310: 2020 3130 3031 2020 2020 2020 2020 2020    1001          
-0001b320: 2031 3030 3130 2020 2020 2034 352e 3030   10010     45.00
-0001b330: 3030 3030 3030 2020 2020 202d 302e 3030  000000     -0.00
-0001b340: 3030 3030 3030 0a20 2020 2020 2020 202a  000000.        *
-0001b350: 2020 2020 2020 2020 2020 2020 2031 2e30               1.0
-0001b360: 3030 3030 3030 3020 2020 2020 2020 2020  0000000         
-0001b370: 2020 2020 2020 300a 2020 2020 2020 2020        0.        
-0001b380: 4752 4944 2a20 2020 2020 2020 2020 2020  GRID*           
-0001b390: 2020 2020 3130 3032 2020 2020 2020 2020      1002        
-0001b3a0: 2020 2031 3030 3130 2020 2020 2031 332e     10010     13.
-0001b3b0: 3930 3537 3634 3735 2020 2020 2034 322e  90576475     42.
-0001b3c0: 3739 3735 3433 3233 0a20 2020 2020 2020  79754323.       
-0001b3d0: 202a 2020 2020 2020 2020 2020 2020 2031   *             1
-0001b3e0: 2e30 3030 3030 3030 3020 2020 2020 2020  .00000000       
-0001b3f0: 2020 2020 2020 2020 300a 2020 2020 2020          0.      
-0001b400: 2020 4752 4944 2a20 2020 2020 2020 2020    GRID*         
-0001b410: 2020 2020 2020 3130 3033 2020 2020 2020        1003      
-0001b420: 2020 2020 2031 3030 3130 2020 2020 2d33       10010    -3
-0001b430: 362e 3430 3537 3634 3735 2020 2020 2032  6.40576475     2
-0001b440: 362e 3435 3033 3336 3335 0a20 2020 2020  6.45033635.     
-0001b450: 2020 202a 2020 2020 2020 2020 2020 2020     *            
-0001b460: 2031 2e30 3030 3030 3030 3020 2020 2020   1.00000000     
-0001b470: 2020 2020 2020 2020 2020 300a 2020 2020            0.    
-0001b480: 2020 2020 4752 4944 2a20 2020 2020 2020      GRID*       
-0001b490: 2020 2020 2020 2020 3130 3034 2020 2020          1004    
-0001b4a0: 2020 2020 2020 2031 3030 3130 2020 2020         10010    
-0001b4b0: 2d33 362e 3430 3537 3634 3735 2020 2020  -36.40576475    
-0001b4c0: 2d32 362e 3435 3033 3336 3335 0a20 2020  -26.45033635.   
-0001b4d0: 2020 2020 202a 2020 2020 2020 2020 2020       *          
-0001b4e0: 2020 2031 2e30 3030 3030 3030 3020 2020     1.00000000   
-0001b4f0: 2020 2020 2020 2020 2020 2020 300a 2020              0.  
-0001b500: 2020 2020 2020 4752 4944 2a20 2020 2020        GRID*     
-0001b510: 2020 2020 2020 2020 2020 3130 3035 2020            1005  
-0001b520: 2020 2020 2020 2020 2031 3030 3130 2020           10010  
-0001b530: 2020 2031 332e 3930 3537 3634 3735 2020     13.90576475  
-0001b540: 2020 2d34 322e 3739 3735 3433 3233 0a20    -42.79754323. 
-0001b550: 2020 2020 2020 202a 2020 2020 2020 2020         *        
-0001b560: 2020 2020 2031 2e30 3030 3030 3030 3020       1.00000000 
-0001b570: 2020 2020 2020 2020 2020 2020 2020 300a                0.
-0001b580: 2020 2020 2020 2020 240a 2020 2020 2020          $.      
-0001b590: 2020 2420 5242 4532 2074 6865 2053 7061    $ RBE2 the Spa
-0001b5a0: 6365 6372 6166 7420 6e6f 6465 7320 746f  cecraft nodes to
-0001b5b0: 206e 6577 206e 6f64 6573 2063 7265 6174   new nodes creat
-0001b5c0: 6564 2061 626f 7665 2028 7468 6520 6e65  ed above (the ne
-0001b5d0: 7720 6e6f 6465 730a 2020 2020 2020 2020  w nodes.        
-0001b5e0: 2420 6172 6520 696e 6465 7065 6e64 656e  $ are independen
-0001b5f0: 7429 3a0a 2020 2020 2020 2020 240a 2020  t):.        $.  
-0001b600: 2020 2020 2020 5242 4532 2c31 3030 312c        RBE2,1001,
-0001b610: 3130 3031 2c31 3233 3435 362c 310a 2020  1001,123456,1.  
-0001b620: 2020 2020 2020 5242 4532 2c31 3030 322c        RBE2,1002,
-0001b630: 3130 3032 2c31 3233 3435 362c 320a 2020  1002,123456,2.  
-0001b640: 2020 2020 2020 5242 4532 2c31 3030 332c        RBE2,1003,
-0001b650: 3130 3033 2c31 3233 3435 362c 330a 2020  1003,123456,3.  
-0001b660: 2020 2020 2020 5242 4532 2c31 3030 342c        RBE2,1004,
-0001b670: 3130 3034 2c31 3233 3435 362c 340a 2020  1004,123456,4.  
-0001b680: 2020 2020 2020 5242 4532 2c31 3030 352c        RBE2,1005,
-0001b690: 3130 3035 2c31 3233 3435 362c 350a 2020  1005,123456,5.  
-0001b6a0: 2020 2020 2020 240a 2020 2020 2020 2020        $.        
-0001b6b0: 2420 5253 504c 494e 4520 7468 6520 5269  $ RSPLINE the Ri
-0001b6c0: 6e67 2032 206e 6f64 6573 2074 6f20 7468  ng 2 nodes to th
-0001b6d0: 6520 6e65 7720 6e6f 6465 7320 6372 6561  e new nodes crea
-0001b6e0: 7465 6420 6162 6f76 652c 2077 6974 6820  ted above, with 
-0001b6f0: 7468 6520 6e65 770a 2020 2020 2020 2020  the new.        
-0001b700: 2420 6e6f 6465 7320 6265 696e 6720 696e  $ nodes being in
-0001b710: 6465 7065 6e64 656e 742e 0a20 2020 2020  dependent..     
-0001b720: 2020 2024 0a20 2020 2020 2020 2052 5350     $.        RSP
-0001b730: 4c49 4e45 2020 2020 2032 3030 3120 2020  LINE     2001   
-0001b740: 2020 302e 3120 2020 2031 3030 3120 2020    0.1    1001   
-0001b750: 2020 3130 3120 2031 3233 3435 3620 2020    101  123456   
-0001b760: 2020 3130 3220 2031 3233 3435 3620 2020    102  123456   
-0001b770: 2031 3030 320a 2020 2020 2020 2020 5253   1002.        RS
-0001b780: 504c 494e 4520 2020 2020 3230 3032 2020  PLINE     2002  
-0001b790: 2020 2030 2e31 2020 2020 3130 3032 2020     0.1    1002  
-0001b7a0: 2020 2031 3033 2020 3132 3334 3536 2020     103  123456  
-0001b7b0: 2020 3130 3033 0a20 2020 2020 2020 2052    1003.        R
-0001b7c0: 5350 4c49 4e45 2020 2020 2032 3030 3320  SPLINE     2003 
-0001b7d0: 2020 2020 302e 3120 2020 2031 3030 3320      0.1    1003 
-0001b7e0: 2020 2020 3130 3420 2031 3233 3435 3620      104  123456 
-0001b7f0: 2020 2020 3130 3520 2031 3233 3435 3620      105  123456 
-0001b800: 2020 2031 3030 340a 2020 2020 2020 2020     1004.        
-0001b810: 5253 504c 494e 4520 2020 2020 3230 3034  RSPLINE     2004
-0001b820: 2020 2020 2030 2e31 2020 2020 3130 3034       0.1    1004
-0001b830: 2020 2020 2031 3036 2020 3132 3334 3536       106  123456
-0001b840: 2020 2020 3130 3035 0a20 2020 2020 2020      1005.       
-0001b850: 2052 5350 4c49 4e45 2020 2020 2032 3030   RSPLINE     200
-0001b860: 3520 2020 2020 302e 3120 2020 2031 3030  5     0.1    100
-0001b870: 3520 2020 2020 3130 3720 2031 3233 3435  5     107  12345
-0001b880: 3620 2020 2031 3030 310a 2020 2020 2222  6    1001.    ""
-0001b890: 220a 0a20 2020 2064 6566 205f 6368 6563  "..    def _chec
-0001b8a0: 6b5f 6772 6964 7328 6772 6964 732c 206e  k_grids(grids, n
-0001b8b0: 616d 6529 3a0a 2020 2020 2020 2020 6966  ame):.        if
-0001b8c0: 2069 7369 6e73 7461 6e63 6528 6772 6964   isinstance(grid
-0001b8d0: 732c 2074 7570 6c65 2920 616e 6420 6c65  s, tuple) and le
-0001b8e0: 6e28 6772 6964 7329 203d 3d20 323a 0a20  n(grids) == 2:. 
-0001b8f0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0001b900: 6e20 6772 6964 730a 2020 2020 2020 2020  n grids.        
-0001b910: 7265 7475 726e 206e 616d 652c 2067 7269  return name, gri
-0001b920: 6473 0a0a 2020 2020 6465 6620 5f64 6573  ds..    def _des
-0001b930: 7061 6365 2873 293a 0a20 2020 2020 2020  pace(s):.       
-0001b940: 2072 6574 7572 6e20 2822 222e 6a6f 696e   return ("".join
-0001b950: 2873 2e73 706c 6974 2829 2929 2e6c 6f77  (s.split())).low
-0001b960: 6572 2829 0a0a 2020 2020 7231 6e61 6d65  er()..    r1name
-0001b970: 2c20 7231 6772 6964 7320 3d20 5f63 6865  , r1grids = _che
-0001b980: 636b 5f67 7269 6473 2872 3167 7269 6473  ck_grids(r1grids
-0001b990: 2c20 2252 696e 6720 3122 290a 2020 2020  , "Ring 1").    
-0001b9a0: 7232 6e61 6d65 2c20 7232 6772 6964 7320  r2name, r2grids 
-0001b9b0: 3d20 5f63 6865 636b 5f67 7269 6473 2872  = _check_grids(r
-0001b9c0: 3267 7269 6473 2c20 2252 696e 6720 3222  2grids, "Ring 2"
-0001b9d0: 290a 0a20 2020 2023 2065 6e73 7572 6520  )..    # ensure 
-0001b9e0: 7468 6174 2069 6e64 6570 656e 6465 6e74  that independent
-0001b9f0: 2069 7320 6569 7468 6572 2027 7269 6e67   is either 'ring
-0001ba00: 3127 206f 7220 2772 696e 6732 273a 0a20  1' or 'ring2':. 
-0001ba10: 2020 2069 6e64 6570 656e 6465 6e74 203d     independent =
-0001ba20: 205f 6465 7370 6163 6528 696e 6465 7065   _despace(indepe
-0001ba30: 6e64 656e 7429 0a20 2020 2069 6620 696e  ndent).    if in
-0001ba40: 6465 7065 6e64 656e 7420 3d3d 205f 6465  dependent == _de
-0001ba50: 7370 6163 6528 7231 6e61 6d65 293a 0a20  space(r1name):. 
-0001ba60: 2020 2020 2020 2069 6e64 6570 656e 6465         independe
-0001ba70: 6e74 203d 2022 7269 6e67 3122 0a20 2020  nt = "ring1".   
-0001ba80: 2065 6c69 6620 696e 6465 7065 6e64 656e   elif independen
-0001ba90: 7420 3d3d 205f 6465 7370 6163 6528 7232  t == _despace(r2
-0001baa0: 6e61 6d65 293a 0a20 2020 2020 2020 2069  name):.        i
-0001bab0: 6e64 6570 656e 6465 6e74 203d 2022 7269  ndependent = "ri
-0001bac0: 6e67 3222 0a20 2020 2069 6620 696e 6465  ng2".    if inde
-0001bad0: 7065 6e64 656e 7420 6e6f 7420 696e 2028  pendent not in (
-0001bae0: 2272 696e 6731 222c 2022 7269 6e67 3222  "ring1", "ring2"
-0001baf0: 293a 0a20 2020 2020 2020 2072 6169 7365  ):.        raise
-0001bb00: 2056 616c 7565 4572 726f 7228 2269 6e76   ValueError("inv
-0001bb10: 616c 6964 2060 696e 6465 7065 6e64 656e  alid `independen
-0001bb20: 7460 206f 7074 696f 6e22 290a 0a20 2020  t` option")..   
-0001bb30: 2069 6620 7262 6532 5f69 6430 2069 7320   if rbe2_id0 is 
-0001bb40: 4e6f 6e65 3a0a 2020 2020 2020 2020 7262  None:.        rb
-0001bb50: 6532 5f69 6430 203d 206e 6f64 655f 6964  e2_id0 = node_id
-0001bb60: 300a 2020 2020 6966 2063 6f72 645f 6964  0.    if cord_id
-0001bb70: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
-0001bb80: 2020 636f 7264 5f69 6420 3d20 6e6f 6465    cord_id = node
-0001bb90: 5f69 6430 202a 2031 300a 0a20 2020 206e  _id0 * 10..    n
-0001bba0: 616d 6573 203d 2028 7231 6e61 6d65 2c20  ames = (r1name, 
-0001bbb0: 7232 6e61 6d65 290a 2020 2020 4944 7320  r2name).    IDs 
-0001bbc0: 3d20 5b5d 0a20 2020 2078 797a 203d 205b  = [].    xyz = [
-0001bbd0: 5d0a 2020 2020 666f 7220 7269 6e67 2c20  ].    for ring, 
-0001bbe0: 6e61 6d65 2069 6e20 2828 7231 6772 6964  name in ((r1grid
-0001bbf0: 732c 2022 7231 6772 6964 7322 292c 2028  s, "r1grids"), (
-0001bc00: 7232 6772 6964 732c 2022 7232 6772 6964  r2grids, "r2grid
-0001bc10: 7322 2929 3a0a 2020 2020 2020 2020 6966  s")):.        if
-0001bc20: 2069 7369 6e73 7461 6e63 6528 7269 6e67   isinstance(ring
-0001bc30: 2c20 7064 2e44 6174 6146 7261 6d65 293a  , pd.DataFrame):
-0001bc40: 0a20 2020 2020 2020 2020 2020 2072 203d  .            r =
-0001bc50: 2072 696e 672e 7368 6170 655b 305d 0a20   ring.shape[0]. 
-0001bc60: 2020 2020 2020 2020 2020 2069 6620 2872             if (r
-0001bc70: 202f 2f20 3629 202a 2036 2021 3d20 723a   // 6) * 6 != r:
-0001bc80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001bc90: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-0001bca0: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
-0001bcb0: 2020 2020 2020 2066 226e 756d 6265 7220         f"number 
-0001bcc0: 6f66 2072 6f77 7320 607b 6e61 6d65 7d60  of rows `{name}`
-0001bcd0: 2069 7320 6e6f 7420 2220 226d 756c 7469   is not " "multi
-0001bce0: 706c 6520 6f66 2036 2066 6f72 2055 5345  ple of 6 for USE
-0001bcf0: 5420 696e 7075 7422 0a20 2020 2020 2020  T input".       
-0001bd00: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-0001bd10: 2020 2020 2020 2049 4473 2e61 7070 656e         IDs.appen
-0001bd20: 6428 7269 6e67 2e69 6e64 6578 2e67 6574  d(ring.index.get
-0001bd30: 5f6c 6576 656c 5f76 616c 7565 7328 2269  _level_values("i
-0001bd40: 6422 295b 3a3a 365d 290a 2020 2020 2020  d")[::6]).      
-0001bd50: 2020 2020 2020 7879 7a2e 6170 7065 6e64        xyz.append
-0001bd60: 2872 696e 672e 696c 6f63 5b3a 3a36 2c20  (ring.iloc[::6, 
-0001bd70: 313a 5d2e 7661 6c75 6573 290a 2020 2020  1:].values).    
-0001bd80: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-0001bd90: 2020 2020 2020 7269 6e67 203d 206e 702e        ring = np.
-0001bda0: 6174 6c65 6173 745f 3264 2872 696e 6729  atleast_2d(ring)
-0001bdb0: 0a20 2020 2020 2020 2020 2020 2049 4473  .            IDs
-0001bdc0: 2e61 7070 656e 6428 7269 6e67 5b3a 2c20  .append(ring[:, 
-0001bdd0: 305d 2e61 7374 7970 6528 6e70 2e69 6e74  0].astype(np.int
-0001bde0: 3634 2929 0a20 2020 2020 2020 2020 2020  64)).           
-0001bdf0: 2078 797a 2e61 7070 656e 6428 7269 6e67   xyz.append(ring
-0001be00: 5b3a 2c20 313a 5d29 0a0a 2020 2020 2320  [:, 1:])..    # 
-0001be10: 6669 7420 626f 7468 2063 6972 636c 6573  fit both circles
-0001be20: 3a0a 2020 2020 6369 7263 5f70 6172 6d73  :.    circ_parms
-0001be30: 203d 205b 7974 6f6f 6c73 2e66 6974 5f63   = [ytools.fit_c
-0001be40: 6972 636c 655f 3364 2878 797a 5b69 5d2e  ircle_3d(xyz[i].
-0001be50: 5429 2066 6f72 2069 2069 6e20 2830 2c20  T) for i in (0, 
-0001be60: 3129 5d0a 0a20 2020 2023 207a 2061 7865  1)]..    # z axe
-0001be70: 7320 6265 7474 6572 2062 6520 616c 6967  s better be alig
-0001be80: 6e65 643a 0a20 2020 205f 6368 6563 6b5f  ned:.    _check_
-0001be90: 7a5f 616c 6967 6e6d 656e 7428 6369 7263  z_alignment(circ
-0001bea0: 5f70 6172 6d73 2c20 302e 3939 290a 0a20  _parms, 0.99).. 
-0001beb0: 2020 2023 2075 7365 2031 7374 2062 6173     # use 1st bas
-0001bec0: 6963 326c 6f63 616c 2074 7261 6e73 666f  ic2local transfo
-0001bed0: 726d 206f 6e20 7365 636f 6e64 2073 6574  rm on second set
-0001bee0: 206f 6620 6461 7461 2074 6f20 6765 7420   of data to get 
-0001bef0: 616c 6c0a 2020 2020 2320 636f 6f72 6469  all.    # coordi
-0001bf00: 6e61 7465 7320 696e 2073 616d 6520 6c6f  nates in same lo
-0001bf10: 6361 6c20 7379 7374 656d 3a0a 2020 2020  cal system:.    
-0001bf20: 6261 7369 6332 6c6f 6361 6c20 3d20 6369  basic2local = ci
-0001bf30: 7263 5f70 6172 6d73 5b30 5d2e 6261 7369  rc_parms[0].basi
-0001bf40: 6332 6c6f 6361 6c0a 2020 2020 6365 6e74  c2local.    cent
-0001bf50: 6572 203d 2063 6972 635f 7061 726d 735b  er = circ_parms[
-0001bf60: 305d 2e63 656e 7465 720a 2020 2020 6369  0].center.    ci
-0001bf70: 7263 5f70 6172 6d73 5b31 5d2e 6c6f 6361  rc_parms[1].loca
-0001bf80: 6c20 3d20 6261 7369 6332 6c6f 6361 6c20  l = basic2local 
-0001bf90: 4020 2878 797a 5b31 5d20 2d20 6365 6e74  @ (xyz[1] - cent
-0001bfa0: 6572 292e 540a 0a20 2020 2023 2074 6865  er).T..    # the
-0001bfb0: 2063 656e 7465 7220 706f 696e 7420 7769   center point wi
-0001bfc0: 6c6c 206f 6674 656e 2068 6176 6520 6e65  ll often have ne
-0001bfd0: 6172 2d7a 6572 6f73 2062 7574 2062 6520  ar-zeros but be 
-0001bfe0: 6e75 6d65 7269 6361 6c6c 790a 2020 2020  numerically.    
-0001bff0: 2320 6f66 6620 2e2e 2e20 6368 6563 6b20  # off ... check 
-0001c000: 666f 7220 7468 6973 2061 6e64 2061 646a  for this and adj
-0001c010: 7573 7420 6966 2074 6861 7427 7320 7468  ust if that's th
-0001c020: 6520 6361 7365 3a0a 2020 2020 7261 6469  e case:.    radi
-0001c030: 7573 203d 2063 6972 635f 7061 726d 735b  us = circ_parms[
-0001c040: 305d 2e72 6164 6975 730a 2020 2020 666f  0].radius.    fo
-0001c050: 7220 692c 2076 616c 7565 2069 6e20 656e  r i, value in en
-0001c060: 756d 6572 6174 6528 6365 6e74 6572 293a  umerate(center):
-0001c070: 0a20 2020 2020 2020 2069 6620 6162 7328  .        if abs(
-0001c080: 7661 6c75 6529 203c 2031 652d 3720 2a20  value) < 1e-7 * 
-0001c090: 7261 6469 7573 3a0a 2020 2020 2020 2020  radius:.        
-0001c0a0: 2020 2020 6365 6e74 6572 5b69 5d20 3d20      center[i] = 
-0001c0b0: 302e 300a 0a20 2020 2040 6775 6974 6f6f  0.0..    @guitoo
-0001c0c0: 6c73 2e77 7269 7465 5f74 6578 745f 6669  ls.write_text_fi
-0001c0d0: 6c65 0a20 2020 2064 6566 205f 7772 6974  le.    def _writ
-0001c0e0: 655f 6669 6c65 2866 293a 0a20 2020 2020  e_file(f):.     
-0001c0f0: 2020 2023 2077 7269 7465 2063 6972 636c     # write circl
-0001c100: 6520 696e 666f 2066 6f72 2072 6566 6572  e info for refer
-0001c110: 656e 6365 3a0a 2020 2020 2020 2020 666f  ence:.        fo
-0001c120: 7220 6920 696e 2072 616e 6765 2832 293a  r i in range(2):
-0001c130: 0a20 2020 2020 2020 2020 2020 2063 7472  .            ctr
-0001c140: 203d 2063 6972 635f 7061 726d 735b 695d   = circ_parms[i]
-0001c150: 2e63 656e 7465 720a 2020 2020 2020 2020  .center.        
-0001c160: 2020 2020 6374 725f 7374 7269 6e67 203d      ctr_string =
-0001c170: 2066 225b 7b63 7472 5b30 5d3a 232e 3467   f"[{ctr[0]:#.4g
-0001c180: 7d2c 207b 6374 725b 315d 3a23 2e34 677d  }, {ctr[1]:#.4g}
-0001c190: 2c20 7b63 7472 5b32 5d3a 232e 3467 7d5d  , {ctr[2]:#.4g}]
-0001c1a0: 220a 2020 2020 2020 2020 2020 2020 636f  ".            co
-0001c1b0: 6d6d 656e 7420 3d20 280a 2020 2020 2020  mment = (.      
-0001c1c0: 2020 2020 2020 2020 2020 2224 5c6e 220a            "$\n".
-0001c1d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c1e0: 6622 2420 4669 7420 6f66 207b 6e61 6d65  f"$ Fit of {name
-0001c1f0: 735b 695d 7d20 6772 6964 733a 5c6e 220a  s[i]} grids:\n".
-0001c200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c210: 6622 2420 2020 2020 4365 6e74 6572 3a20  f"$     Center: 
-0001c220: 7b63 7472 5f73 7472 696e 677d 2028 696e  {ctr_string} (in
-0001c230: 2062 6173 6963 295c 6e22 0a20 2020 2020   basic)\n".     
-0001c240: 2020 2020 2020 2020 2020 2066 2224 2020             f"$  
-0001c250: 2020 2052 6164 6975 733a 207b 6369 7263     Radius: {circ
-0001c260: 5f70 6172 6d73 5b69 5d2e 7261 6469 7573  _parms[i].radius
-0001c270: 7d5c 6e22 0a20 2020 2020 2020 2020 2020  }\n".           
-0001c280: 2029 0a20 2020 2020 2020 2020 2020 2066   ).            f
-0001c290: 2e77 7269 7465 2863 6f6d 6d65 6e74 290a  .write(comment).
-0001c2a0: 0a20 2020 2020 2020 2023 2077 7269 7465  .        # write
-0001c2b0: 206c 6f63 616c 2063 6f6f 7264 696e 6174   local coordinat
-0001c2c0: 6520 7379 7374 656d 2074 6f20 6669 6c65  e system to file
-0001c2d0: 3a0a 2020 2020 2020 2020 5f77 745f 6369  :.        _wt_ci
-0001c2e0: 7263 6c65 315f 636f 6f72 6428 662c 2063  rcle1_coord(f, c
-0001c2f0: 6f72 645f 6964 2c20 6365 6e74 6572 2c20  ord_id, center, 
-0001c300: 6261 7369 6332 6c6f 6361 6c2c 2049 4473  basic2local, IDs
-0001c310: 5b30 5d5b 305d 2c20 6e6f 6465 5f69 6430  [0][0], node_id0
-0001c320: 2c20 6e61 6d65 7329 0a0a 2020 2020 2020  , names)..      
-0001c330: 2020 2320 6372 6561 7465 206e 6577 206e    # create new n
-0001c340: 6f64 6573 2074 6861 7420 7769 6c6c 2062  odes that will b
-0001c350: 6520 5242 4532 2764 2074 6f20 7269 6e67  e RBE2'd to ring
-0001c360: 2031 206e 6f64 6573 2c20 6275 740a 2020   1 nodes, but.  
-0001c370: 2020 2020 2020 2320 6c6f 6361 7465 6420        # located 
-0001c380: 6f6e 2072 696e 6720 3220 6369 7263 6c65  on ring 2 circle
-0001c390: 0a20 2020 2020 2020 2023 202d 2074 6865  .        # - the
-0001c3a0: 7365 206e 6f64 6573 2077 696c 6c20 6265  se nodes will be
-0001c3b0: 2064 6566 696e 6564 2069 6e20 7468 6520   defined in the 
-0001c3c0: 6c6f 6361 6c20 7379 7374 656d 2062 7574  local system but
-0001c3d0: 206f 7574 7075 740a 2020 2020 2020 2020   output.        
-0001c3e0: 2320 2020 696e 2062 6173 6963 0a20 2020  #   in basic.   
-0001c3f0: 2020 2020 206e 6577 7074 732c 206e 6577       newpts, new
-0001c400: 6964 7320 3d20 5f77 7467 7269 6473 5f72  ids = _wtgrids_r
-0001c410: 6265 3273 280a 2020 2020 2020 2020 2020  be2s(.          
-0001c420: 2020 662c 0a20 2020 2020 2020 2020 2020    f,.           
-0001c430: 2063 6972 635f 7061 726d 732c 0a20 2020   circ_parms,.   
-0001c440: 2020 2020 2020 2020 2063 656e 7465 722c           center,
-0001c450: 0a20 2020 2020 2020 2020 2020 2062 6173  .            bas
-0001c460: 6963 326c 6f63 616c 2c0a 2020 2020 2020  ic2local,.      
-0001c470: 2020 2020 2020 636f 7264 5f69 642c 0a20        cord_id,. 
-0001c480: 2020 2020 2020 2020 2020 206e 6f64 655f             node_
-0001c490: 6964 302c 0a20 2020 2020 2020 2020 2020  id0,.           
-0001c4a0: 2072 6265 325f 6964 302c 0a20 2020 2020   rbe2_id0,.     
-0001c4b0: 2020 2020 2020 2049 4473 5b30 5d2c 0a20         IDs[0],. 
-0001c4c0: 2020 2020 2020 2020 2020 206e 616d 6573             names
-0001c4d0: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
-0001c4e0: 2020 2020 2023 2072 7370 6c69 6e65 2077       # rspline w
-0001c4f0: 696c 6c20 7469 6520 7468 6520 276e 6577  ill tie the 'new
-0001c500: 7074 7327 2061 6e64 2074 6865 2072 696e  pts' and the rin
-0001c510: 6720 3220 6e6f 6465 7320 746f 6765 7468  g 2 nodes togeth
-0001c520: 6572 3a0a 2020 2020 2020 2020 7273 706c  er:.        rspl
-0001c530: 696e 655f 6e6f 6465 7320 3d20 5f73 6f72  ine_nodes = _sor
-0001c540: 745f 6e5f 7772 6974 6528 0a20 2020 2020  t_n_write(.     
-0001c550: 2020 2020 2020 2066 2c20 696e 6465 7065         f, indepe
-0001c560: 6e64 656e 742c 2063 6972 635f 7061 726d  ndent, circ_parm
-0001c570: 732c 206e 6577 7074 732c 206e 6577 6964  s, newpts, newid
-0001c580: 732c 2049 4473 5b31 5d2c 2072 7370 6c69  s, IDs[1], rspli
-0001c590: 6e65 5f69 6430 2c20 446f 4c2c 206e 616d  ne_id0, DoL, nam
-0001c5a0: 6573 0a20 2020 2020 2020 2029 0a0a 2020  es.        )..  
-0001c5b0: 2020 2020 2020 7265 7475 726e 206e 6577        return new
-0001c5c0: 7074 732c 206e 6577 6964 732c 2072 7370  pts, newids, rsp
-0001c5d0: 6c69 6e65 5f6e 6f64 6573 0a0a 2020 2020  line_nodes..    
-0001c5e0: 2320 7772 6974 6520 7468 6520 7273 706c  # write the rspl
-0001c5f0: 696e 653a 0a20 2020 206e 6577 7074 732c  ine:.    newpts,
-0001c600: 206e 6577 6964 732c 2072 7370 6c69 6e65   newids, rspline
-0001c610: 5f6e 6f64 6573 203d 205f 7772 6974 655f  _nodes = _write_
-0001c620: 6669 6c65 2866 290a 0a20 2020 2061 7820  file(f)..    ax 
-0001c630: 3d20 7974 6f6f 6c73 2e5f 6368 6563 6b5f  = ytools._check_
-0001c640: 6d61 6b65 706c 6f74 286d 616b 6570 6c6f  makeplot(makeplo
-0001c650: 742c 2066 6967 7369 7a65 3d5b 382c 2036  t, figsize=[8, 6
-0001c660: 5d2c 206e 6565 6433 643d 5472 7565 290a  ], need3d=True).
-0001c670: 2020 2020 6966 2061 783a 0a20 2020 2020      if ax:.     
-0001c680: 2020 205f 706c 6f74 5f72 7370 6c69 6e65     _plot_rspline
-0001c690: 280a 2020 2020 2020 2020 2020 2020 6178  (.            ax
-0001c6a0: 2c0a 2020 2020 2020 2020 2020 2020 6369  ,.            ci
-0001c6b0: 7263 5f70 6172 6d73 2c0a 2020 2020 2020  rc_parms,.      
-0001c6c0: 2020 2020 2020 7879 7a2c 0a20 2020 2020        xyz,.     
-0001c6d0: 2020 2020 2020 206e 6577 7074 732c 0a20         newpts,. 
-0001c6e0: 2020 2020 2020 2020 2020 206e 6577 6964             newid
-0001c6f0: 732c 0a20 2020 2020 2020 2020 2020 2062  s,.            b
-0001c700: 6173 6963 326c 6f63 616c 2c0a 2020 2020  asic2local,.    
-0001c710: 2020 2020 2020 2020 6365 6e74 6572 2c0a          center,.
-0001c720: 2020 2020 2020 2020 2020 2020 7273 706c              rspl
-0001c730: 696e 655f 6e6f 6465 732c 0a20 2020 2020  ine_nodes,.     
-0001c740: 2020 2020 2020 2049 4473 5b31 5d2c 0a20         IDs[1],. 
-0001c750: 2020 2020 2020 2020 2020 206e 616d 6573             names
-0001c760: 2c0a 2020 2020 2020 2020 290a 0a0a 6465  ,.        )...de
-0001c770: 6620 7774 636f 6f72 6463 6172 6473 2866  f wtcoordcards(f
-0001c780: 2c20 6369 293a 0a20 2020 2022 2222 0a20  , ci):.    """. 
-0001c790: 2020 2057 7269 7465 204e 6173 7472 616e     Write Nastran
-0001c7a0: 2043 4f52 4432 2a20 6361 7264 7320 746f   CORD2* cards to
-0001c7b0: 2061 2066 696c 650a 0a20 2020 2050 6172   a file..    Par
-0001c7c0: 616d 6574 6572 730a 2020 2020 2d2d 2d2d  ameters.    ----
-0001c7d0: 2d2d 2d2d 2d2d 0a20 2020 2066 203a 2073  ------.    f : s
-0001c7e0: 7472 696e 6720 6f72 2066 696c 655f 6c69  tring or file_li
-0001c7f0: 6b65 206f 7220 3120 6f72 204e 6f6e 650a  ke or 1 or None.
-0001c800: 2020 2020 2020 2020 4569 7468 6572 2061          Either a
-0001c810: 206e 616d 6520 6f66 2061 2066 696c 652c   name of a file,
-0001c820: 206f 7220 6973 2061 2066 696c 655f 6c69   or is a file_li
-0001c830: 6b65 206f 626a 6563 7420 6173 2072 6574  ke object as ret
-0001c840: 7572 6e65 640a 2020 2020 2020 2020 6279  urned.        by
-0001c850: 203a 6675 6e63 3a60 6f70 656e 6020 6f72   :func:`open` or
-0001c860: 203a 636c 6173 733a 6069 6f2e 5374 7269   :class:`io.Stri
-0001c870: 6e67 494f 602e 2049 6e70 7574 2061 7320  ngIO`. Input as 
-0001c880: 696e 7465 6765 7220 3120 746f 0a20 2020  integer 1 to.   
-0001c890: 2020 2020 2077 7269 7465 2074 6f20 7374       write to st
-0001c8a0: 646f 7574 2e20 4361 6e20 616c 736f 2062  dout. Can also b
-0001c8b0: 6520 7468 6520 6e61 6d65 206f 6620 6120  e the name of a 
-0001c8c0: 6469 7265 6374 6f72 7920 6f72 204e 6f6e  directory or Non
-0001c8d0: 653b 0a20 2020 2020 2020 2069 6e20 7468  e;.        in th
-0001c8e0: 6573 6520 6361 7365 732c 2061 2047 5549  ese cases, a GUI
-0001c8f0: 2069 7320 6f70 656e 6564 2066 6f72 2066   is opened for f
-0001c900: 696c 6520 7365 6c65 6374 696f 6e2e 0a20  ile selection.. 
-0001c910: 2020 2063 6920 3a20 6469 6374 696f 6e61     ci : dictiona
-0001c920: 7279 206f 7220 4e6f 6e65 0a20 2020 2020  ry or None.     
-0001c930: 2020 2044 6963 7469 6f6e 6172 7920 6f66     Dictionary of
-0001c940: 2063 6f6f 7264 696e 6174 6520 6361 7264   coordinate card
-0001c950: 2069 6e66 6f20 6173 2072 6574 7572 6e65   info as returne
-0001c960: 6420 6279 0a20 2020 2020 2020 203a 6675  d by.        :fu
-0001c970: 6e63 3a60 7079 7965 7469 2e6e 6173 7472  nc:`pyyeti.nastr
-0001c980: 616e 2e6e 3270 2e6d 6b63 6f72 6463 6172  an.n2p.mkcordcar
-0001c990: 6469 6e66 6f60 2e20 4966 204e 6f6e 6520  dinfo`. If None 
-0001c9a0: 6f72 2069 6620 6469 6374 0a20 2020 2020  or if dict.     
-0001c9b0: 2020 2069 7320 656d 7074 792c 2074 6869     is empty, thi
-0001c9c0: 7320 726f 7574 696e 6520 7175 6965 746c  s routine quietl
-0001c9d0: 7920 646f 6573 206e 6f74 6869 6e67 2e0a  y does nothing..
-0001c9e0: 0a20 2020 2052 6574 7572 6e73 0a20 2020  .    Returns.   
-0001c9f0: 202d 2d2d 2d2d 2d2d 0a20 2020 204e 6f6e   -------.    Non
-0001ca00: 650a 0a20 2020 204e 6f74 6573 0a20 2020  e..    Notes.   
-0001ca10: 202d 2d2d 2d2d 0a20 2020 2054 7970 6963   -----.    Typic
-0001ca20: 616c 6c79 2063 616c 6c65 6420 6279 203a  ally called by :
-0001ca30: 6675 6e63 3a60 7774 6578 7473 656f 7574  func:`wtextseout
-0001ca40: 602e 0a0a 2020 2020 4578 616d 706c 6573  `...    Examples
-0001ca50: 0a20 2020 202d 2d2d 2d2d 2d2d 2d0a 2020  .    --------.  
-0001ca60: 2020 3e3e 3e20 696d 706f 7274 206e 756d    >>> import num
-0001ca70: 7079 2061 7320 6e70 0a20 2020 203e 3e3e  py as np.    >>>
-0001ca80: 2066 726f 6d20 7079 7965 7469 2069 6d70   from pyyeti imp
-0001ca90: 6f72 7420 6e61 7374 7261 6e0a 2020 2020  ort nastran.    
-0001caa0: 3e3e 3e20 6369 203d 207b 3130 3a20 5b27  >>> ci = {10: ['
-0001cab0: 434f 5244 3252 272c 206e 702e 6172 7261  CORD2R', np.arra
-0001cac0: 7928 5b5b 3130 2c20 312c 2030 5d2c 0a20  y([[10, 1, 0],. 
-0001cad0: 2020 202e 2e2e 2020 2020 2020 2020 2020     ...          
-0001cae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001caf0: 2020 2020 2020 5b31 3030 2e2c 2030 2e2c        [100., 0.,
-0001cb00: 2030 2e5d 2c0a 2020 2020 2e2e 2e20 2020   0.],.    ...   
-0001cb10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cb20: 2020 2020 2020 2020 2020 2020 205b 3130               [10
-0001cb30: 302e 2c20 302e 2c20 3130 302e 5d2c 0a20  0., 0., 100.],. 
-0001cb40: 2020 202e 2e2e 2020 2020 2020 2020 2020     ...          
-0001cb50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001cb60: 2020 2020 2020 5b32 3030 2e2c 2030 2e2c        [200., 0.,
-0001cb70: 2030 2e5d 5d29 5d7d 0a20 2020 203e 3e3e   0.]])]}.    >>>
-0001cb80: 206e 6173 7472 616e 2e77 7463 6f6f 7264   nastran.wtcoord
-0001cb90: 6361 7264 7328 312c 2063 6929 0a20 2020  cards(1, ci).   
-0001cba0: 2024 2043 6f6f 7264 696e 6174 6520 3130   $ Coordinate 10
-0001cbb0: 3a0a 2020 2020 434f 5244 3252 2a20 2020  :.    CORD2R*   
-0001cbc0: 2020 2020 2020 2020 2020 2020 3130 2020              10  
-0001cbd0: 2020 2020 2020 2020 2020 2020 2030 2020               0  
-0001cbe0: 312e 3030 3030 3030 3030 652b 3032 2020  1.00000000e+02  
-0001cbf0: 302e 3030 3030 3030 3030 652b 3030 2a0a  0.00000000e+00*.
-0001cc00: 2020 2020 2a20 2020 2020 2020 2020 302e      *         0.
-0001cc10: 3030 3030 3030 3030 652b 3030 2020 312e  00000000e+00  1.
-0001cc20: 3030 3030 3030 3030 652b 3032 2020 302e  00000000e+02  0.
-0001cc30: 3030 3030 3030 3030 652b 3030 2020 312e  00000000e+00  1.
-0001cc40: 3030 3030 3030 3030 652b 3032 2a0a 2020  00000000e+02*.  
-0001cc50: 2020 2a20 2020 2020 2020 2020 322e 3030    *         2.00
-0001cc60: 3030 3030 3030 652b 3032 2020 302e 3030  000000e+02  0.00
-0001cc70: 3030 3030 3030 652b 3030 2020 302e 3030  000000e+00  0.00
-0001cc80: 3030 3030 3030 652b 3030 0a20 2020 2022  000000e+00.    "
-0001cc90: 2222 0a20 2020 2069 6620 6369 2069 7320  "".    if ci is 
-0001cca0: 4e6f 6e65 206f 7220 6c65 6e28 6369 2920  None or len(ci) 
-0001ccb0: 3d3d 2030 3a0a 2020 2020 2020 2020 7265  == 0:.        re
-0001ccc0: 7475 726e 0a0a 2020 2020 4067 7569 746f  turn..    @guito
-0001ccd0: 6f6c 732e 7772 6974 655f 7465 7874 5f66  ols.write_text_f
-0001cce0: 696c 650a 2020 2020 6465 6620 5f77 7463  ile.    def _wtc
-0001ccf0: 6f6f 7264 7328 662c 2063 6929 3a0a 2020  oords(f, ci):.  
-0001cd00: 2020 2020 2020 666f 7220 6b20 696e 2063        for k in c
-0001cd10: 693a 0a20 2020 2020 2020 2020 2020 2064  i:.            d
-0001cd20: 6174 6120 3d20 6369 5b6b 5d20 2023 205b  ata = ci[k]  # [
-0001cd30: 6e61 6d65 2c20 5b5b 6964 2c20 7479 7065  name, [[id, type
-0001cd40: 2c20 7265 665d 3b20 413b 2042 3b20 435d  , ref]; A; B; C]
-0001cd50: 5d0a 2020 2020 2020 2020 2020 2020 636f  ].            co
-0001cd60: 6f72 6420 3d20 6461 7461 5b31 5d0a 2020  ord = data[1].  
-0001cd70: 2020 2020 2020 2020 2020 6162 6320 3d20            abc = 
-0001cd80: 2b63 6f6f 7264 5b31 3a5d 0a20 2020 2020  +coord[1:].     
-0001cd90: 2020 2020 2020 2061 6263 5b61 6273 2861         abc[abs(a
-0001cda0: 6263 2920 3c20 6162 7328 6162 6329 2e6d  bc) < abs(abc).m
-0001cdb0: 6178 2829 202a 2031 652d 3135 5d20 3d20  ax() * 1e-15] = 
-0001cdc0: 302e 300a 2020 2020 2020 2020 2020 2020  0.0.            
-0001cdd0: 662e 7772 6974 6528 6622 2420 436f 6f72  f.write(f"$ Coor
-0001cde0: 6469 6e61 7465 207b 6b7d 3a5c 6e22 290a  dinate {k}:\n").
-0001cdf0: 2020 2020 2020 2020 2020 2020 662e 7772              f.wr
-0001ce00: 6974 6528 0a20 2020 2020 2020 2020 2020  ite(.           
-0001ce10: 2020 2020 2022 7b3a 3c38 737d 7b3a 3136       "{:<8s}{:16
-0001ce20: 647d 7b3a 3136 647d 7b3a 3136 2e38 657d  d}{:16d}{:16.8e}
-0001ce30: 7b3a 3136 2e38 657d 2a5c 6e22 2e66 6f72  {:16.8e}*\n".for
-0001ce40: 6d61 7428 0a20 2020 2020 2020 2020 2020  mat(.           
-0001ce50: 2020 2020 2020 2020 2064 6174 615b 305d           data[0]
-0001ce60: 202b 2022 2a22 2c20 6b2c 2069 6e74 2863   + "*", k, int(c
-0001ce70: 6f6f 7264 5b30 2c20 325d 292c 202a 6162  oord[0, 2]), *ab
-0001ce80: 635b 302c 203a 325d 0a20 2020 2020 2020  c[0, :2].       
-0001ce90: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-0001cea0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0001ceb0: 2020 2020 2066 2e77 7269 7465 2828 227b       f.write(("{
-0001cec0: 3a3c 3873 7d22 202b 2022 7b3a 3136 2e38  :<8s}" + "{:16.8
-0001ced0: 657d 2220 2a20 3420 2b20 222a 5c6e 2229  e}" * 4 + "*\n")
-0001cee0: 2e66 6f72 6d61 7428 222a 222c 2061 6263  .format("*", abc
-0001cef0: 5b30 2c20 325d 2c20 2a61 6263 5b31 5d29  [0, 2], *abc[1])
-0001cf00: 290a 2020 2020 2020 2020 2020 2020 662e  ).            f.
-0001cf10: 7772 6974 6528 2822 7b3a 3c38 737d 2220  write(("{:<8s}" 
-0001cf20: 2b20 227b 3a31 362e 3865 7d22 202a 2033  + "{:16.8e}" * 3
-0001cf30: 202b 2022 5c6e 2229 2e66 6f72 6d61 7428   + "\n").format(
-0001cf40: 222a 222c 202a 6162 635b 325d 2929 0a0a  "*", *abc[2]))..
-0001cf50: 2020 2020 5f77 7463 6f6f 7264 7328 662c      _wtcoords(f,
-0001cf60: 2063 6929 0a0a 0a40 6775 6974 6f6f 6c73   ci)...@guitools
-0001cf70: 2e77 7269 7465 5f74 6578 745f 6669 6c65  .write_text_file
-0001cf80: 0a64 6566 2077 7465 7874 726e 2866 2c20  .def wtextrn(f, 
-0001cf90: 6964 732c 2064 6f66 293a 0a20 2020 2022  ids, dof):.    "
-0001cfa0: 2222 0a20 2020 2057 7269 7465 7320 6120  "".    Writes a 
-0001cfb0: 4e61 7374 7261 6e20 4558 5452 4e20 6361  Nastran EXTRN ca
-0001cfc0: 7264 2074 6f20 6120 6669 6c65 2e0a 0a20  rd to a file... 
-0001cfd0: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
-0001cfe0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
-0001cff0: 2066 203a 2073 7472 696e 6720 6f72 2066   f : string or f
-0001d000: 696c 655f 6c69 6b65 206f 7220 3120 6f72  ile_like or 1 or
-0001d010: 204e 6f6e 650a 2020 2020 2020 2020 4569   None.        Ei
-0001d020: 7468 6572 2061 206e 616d 6520 6f66 2061  ther a name of a
-0001d030: 2066 696c 652c 206f 7220 6973 2061 2066   file, or is a f
-0001d040: 696c 655f 6c69 6b65 206f 626a 6563 7420  ile_like object 
-0001d050: 6173 2072 6574 7572 6e65 640a 2020 2020  as returned.    
-0001d060: 2020 2020 6279 203a 6675 6e63 3a60 6f70      by :func:`op
-0001d070: 656e 6020 6f72 203a 636c 6173 733a 6069  en` or :class:`i
-0001d080: 6f2e 5374 7269 6e67 494f 602e 2049 6e70  o.StringIO`. Inp
-0001d090: 7574 2061 7320 696e 7465 6765 7220 3120  ut as integer 1 
-0001d0a0: 746f 0a20 2020 2020 2020 2077 7269 7465  to.        write
-0001d0b0: 2074 6f20 7374 646f 7574 2e20 4361 6e20   to stdout. Can 
-0001d0c0: 616c 736f 2062 6520 7468 6520 6e61 6d65  also be the name
-0001d0d0: 206f 6620 6120 6469 7265 6374 6f72 7920   of a directory 
-0001d0e0: 6f72 204e 6f6e 653b 0a20 2020 2020 2020  or None;.       
-0001d0f0: 2069 6e20 7468 6573 6520 6361 7365 732c   in these cases,
-0001d100: 2061 2047 5549 2069 7320 6f70 656e 6564   a GUI is opened
-0001d110: 2066 6f72 2066 696c 6520 7365 6c65 6374   for file select
-0001d120: 696f 6e2e 0a20 2020 2069 6473 203a 2031  ion..    ids : 1
-0001d130: 6420 6172 7261 795f 6c69 6b65 0a20 2020  d array_like.   
-0001d140: 2020 2020 2056 6563 746f 7220 6f66 206e       Vector of n
-0001d150: 6f64 6520 6964 730a 2020 2020 646f 6620  ode ids.    dof 
-0001d160: 3a20 3164 2061 7272 6179 5f6c 696b 650a  : 1d array_like.
-0001d170: 2020 2020 2020 2020 5665 6374 6f72 206f          Vector o
-0001d180: 6620 444f 460a 0a20 2020 2052 6574 7572  f DOF..    Retur
-0001d190: 6e73 0a20 2020 202d 2d2d 2d2d 2d2d 0a20  ns.    -------. 
-0001d1a0: 2020 204e 6f6e 650a 0a20 2020 204e 6f74     None..    Not
-0001d1b0: 6573 0a20 2020 202d 2d2d 2d2d 0a20 2020  es.    -----.   
-0001d1c0: 2054 7970 6963 616c 6c79 2063 616c 6c65   Typically calle
-0001d1d0: 6420 6279 203a 6675 6e63 3a60 7774 6578  d by :func:`wtex
-0001d1e0: 7473 656f 7574 602e 0a0a 2020 2020 4578  tseout`...    Ex
-0001d1f0: 616d 706c 6573 0a20 2020 202d 2d2d 2d2d  amples.    -----
-0001d200: 2d2d 2d0a 2020 2020 3e3e 3e20 6672 6f6d  ---.    >>> from
-0001d210: 2070 7979 6574 6920 696d 706f 7274 206e   pyyeti import n
-0001d220: 6173 7472 616e 0a20 2020 203e 3e3e 206e  astran.    >>> n
-0001d230: 6173 7472 616e 2e77 7465 7874 726e 2831  astran.wtextrn(1
-0001d240: 2c20 5b39 3939 2c20 3130 3030 312c 2031  , [999, 10001, 1
-0001d250: 3030 3032 2c20 3130 3030 332c 2031 3030  0002, 10003, 100
-0001d260: 3034 2c20 3130 3030 355d 2c0a 2020 2020  04, 10005],.    
-0001d270: 2e2e 2e20 2020 2020 2020 2020 2020 2020  ...             
-0001d280: 2020 2020 2020 205b 3132 3334 3536 2c20         [123456, 
-0001d290: 302c 2030 2c20 302c 2030 2c20 305d 290a  0, 0, 0, 0, 0]).
-0001d2a0: 2020 2020 4558 5452 4e20 2020 2020 2020      EXTRN       
-0001d2b0: 2039 3939 2020 3132 3334 3536 2020 2031   999  123456   1
-0001d2c0: 3030 3031 2020 2020 2020 2030 2020 2031  0001       0   1
-0001d2d0: 3030 3032 2020 2020 2020 2030 2020 2031  0002       0   1
-0001d2e0: 3030 3033 2020 2020 2020 2030 0a20 2020  0003       0.   
-0001d2f0: 2020 2020 2020 2020 2020 2020 3130 3030              1000
-0001d300: 3420 2020 2020 2020 3020 2020 3130 3030  4       0   1000
-0001d310: 3520 2020 2020 2020 300a 2020 2020 2222  5       0.    ""
-0001d320: 220a 2020 2020 662e 7772 6974 6528 2245  ".    f.write("E
-0001d330: 5854 524e 2020 2022 290a 2020 2020 696e  XTRN   ").    in
-0001d340: 7473 203d 206e 702e 7a65 726f 7328 6c65  ts = np.zeros(le
-0001d350: 6e28 6964 7329 202a 2032 2c20 6474 7970  n(ids) * 2, dtyp
-0001d360: 653d 696e 7429 0a20 2020 2069 6e74 735b  e=int).    ints[
-0001d370: 3a3a 325d 203d 2069 6473 0a20 2020 2069  ::2] = ids.    i
-0001d380: 6e74 735b 313a 3a32 5d20 3d20 646f 660a  nts[1::2] = dof.
-0001d390: 2020 2020 7774 6e61 7369 6e74 7328 662c      wtnasints(f,
-0001d3a0: 2032 2c20 696e 7473 290a 0a0a 6465 6620   2, ints)...def 
-0001d3b0: 7774 6578 7473 656f 7574 280a 2020 2020  wtextseout(.    
-0001d3c0: 6e61 6d65 2c0a 2020 2020 2a2c 0a20 2020  name,.    *,.   
-0001d3d0: 2073 652c 0a20 2020 206d 6161 2c0a 2020   se,.    maa,.  
-0001d3e0: 2020 6261 612c 0a20 2020 206b 6161 2c0a    baa,.    kaa,.
-0001d3f0: 2020 2020 6273 6574 2c0a 2020 2020 7573      bset,.    us
-0001d400: 6574 2c0a 2020 2020 7370 6f69 6e74 312c  et,.    spoint1,
-0001d410: 0a20 2020 2073 6564 6e3d 302c 0a20 2020  .    sedn=0,.   
-0001d420: 206e 616d 656c 6973 743d 5b0a 2020 2020   namelist=[.    
-0001d430: 2020 2020 226b 6161 222c 0a20 2020 2020      "kaa",.     
-0001d440: 2020 2022 6d61 6122 2c0a 2020 2020 2020     "maa",.      
-0001d450: 2020 2262 6161 222c 0a20 2020 2020 2020    "baa",.       
-0001d460: 2022 6b34 7878 222c 0a20 2020 2020 2020   "k4xx",.       
-0001d470: 2022 7061 222c 0a20 2020 2020 2020 2022   "pa",.        "
-0001d480: 6770 7878 222c 0a20 2020 2020 2020 2022  gpxx",.        "
-0001d490: 6764 7878 222c 0a20 2020 2020 2020 2022  gdxx",.        "
-0001d4a0: 7276 6178 222c 0a20 2020 2020 2020 2022  rvax",.        "
-0001d4b0: 7661 222c 0a20 2020 2020 2020 2022 6d75  va",.        "mu
-0001d4c0: 6731 222c 0a20 2020 2020 2020 2022 6d75  g1",.        "mu
-0001d4d0: 6731 6f22 2c0a 2020 2020 2020 2020 226d  g1o",.        "m
-0001d4e0: 6573 3122 2c0a 2020 2020 2020 2020 226d  es1",.        "m
-0001d4f0: 6573 316f 222c 0a20 2020 2020 2020 2022  es1o",.        "
-0001d500: 6d65 6531 222c 0a20 2020 2020 2020 2022  mee1",.        "
-0001d510: 6d65 6531 6f22 2c0a 2020 2020 2020 2020  mee1o",.        
-0001d520: 226d 6770 6622 2c0a 2020 2020 2020 2020  "mgpf",.        
-0001d530: 226d 6770 666f 222c 0a20 2020 2020 2020  "mgpfo",.       
-0001d540: 2022 6d65 6631 222c 0a20 2020 2020 2020   "mef1",.       
-0001d550: 2022 6d65 6631 6f22 2c0a 2020 2020 2020   "mef1o",.      
-0001d560: 2020 226d 7167 3122 2c0a 2020 2020 2020    "mqg1",.      
-0001d570: 2020 226d 7167 316f 222c 0a20 2020 2020    "mqg1o",.     
-0001d580: 2020 2022 6d71 6d67 3122 2c0a 2020 2020     "mqmg1",.    
-0001d590: 2020 2020 226d 716d 6731 6f22 2c0a 2020      "mqmg1o",.  
-0001d5a0: 2020 5d2c 0a20 2020 202a 2a6b 7761 7267    ],.    **kwarg
-0001d5b0: 732c 0a29 3a0a 2020 2020 2222 220a 2020  s,.):.    """.  
-0001d5c0: 2020 5772 6974 6520 2e6f 7034 2c20 2e61    Write .op4, .a
-0001d5d0: 736d 2c20 2e70 6368 2061 6e64 2070 6f73  sm, .pch and pos
-0001d5e0: 7369 626c 7920 7468 6520 6461 6d70 696e  sibly the dampin
-0001d5f0: 6720 444d 4947 2066 696c 6520 666f 7220  g DMIG file for 
-0001d600: 616e 0a20 2020 2065 7874 6572 6e61 6c20  an.    external 
-0001d610: 5345 2e0a 0a20 2020 204e 6f74 6520 7468  SE...    Note th
-0001d620: 6174 2061 6c6c 2069 6e70 7574 7320 6578  at all inputs ex
-0001d630: 6365 7074 2060 6e61 6d65 6020 6d75 7374  cept `name` must
-0001d640: 2062 6520 6e61 6d65 6420 616e 6420 6361   be named and ca
-0001d650: 6e20 6265 2069 6e70 7574 0a20 2020 2069  n be input.    i
-0001d660: 6e20 616e 7920 6f72 6465 722e 0a0a 2020  n any order...  
-0001d670: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
-0001d680: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
-0001d690: 6e61 6d65 203a 2073 7472 696e 670a 2020  name : string.  
-0001d6a0: 2020 2020 2020 4261 7365 6e61 6d65 2066        Basename f
-0001d6b0: 6f72 2066 696c 6573 3b20 6567 3a20 2773  or files; eg: 's
-0001d6c0: 7061 6365 6372 6166 7427 2e20 4669 6c65  pacecraft'. File
-0001d6d0: 7320 7769 7468 2074 6865 0a20 2020 2020  s with the.     
-0001d6e0: 2020 2065 7874 656e 7369 6f6e 7320 272e     extensions '.
-0001d6f0: 6f70 3427 2c20 272e 6173 6d27 2c20 616e  op4', '.asm', an
-0001d700: 6420 272e 7063 6827 2077 696c 6c20 6265  d '.pch' will be
-0001d710: 2063 7265 6174 6564 2e20 4966 2060 6268   created. If `bh
-0001d720: 600a 2020 2020 2020 2020 6973 2054 7275  `.        is Tru
-0001d730: 652c 2061 2027 2e62 6161 5f64 6d69 6727  e, a '.baa_dmig'
-0001d740: 2066 696c 6520 7769 6c6c 2061 6c73 6f20   file will also 
-0001d750: 6265 2063 7265 6174 6564 2e0a 2020 2020  be created..    
-0001d760: 7365 203a 2069 6e74 6567 6572 0a20 2020  se : integer.   
-0001d770: 2020 2020 2053 7570 6572 656c 656d 656e       Superelemen
-0001d780: 7420 6964 3b20 616c 736f 2075 7365 6420  t id; also used 
-0001d790: 6173 2074 6865 2046 6f72 7472 616e 2075  as the Fortran u
-0001d7a0: 6e69 7420 6e75 6d62 6572 206f 6e20 7468  nit number on th
-0001d7b0: 650a 2020 2020 2020 2020 5345 4255 4c4b  e.        SEBULK
-0001d7c0: 2065 6e74 7279 2e0a 2020 2020 6d61 612c   entry..    maa,
-0001d7d0: 2062 6161 2c20 6b61 6120 3a20 3264 2061   baa, kaa : 2d a
-0001d7e0: 7272 6179 5f6c 696b 650a 2020 2020 2020  rray_like.      
-0001d7f0: 2020 5468 6573 6520 6172 6520 7468 6520    These are the 
-0001d800: 4372 6169 672d 4261 6d70 746f 6e20 6d61  Craig-Bampton ma
-0001d810: 7373 2c20 6461 6d70 696e 6720 616e 6420  ss, damping and 
-0001d820: 7374 6966 666e 6573 730a 2020 2020 2020  stiffness.      
-0001d830: 2020 6d61 7472 6963 6573 2072 6573 7065    matrices respe
-0001d840: 6374 6976 656c 792e 0a20 2020 2062 7365  ctively..    bse
-0001d850: 7420 3a20 3164 2061 7272 6179 5f6c 696b  t : 1d array_lik
-0001d860: 650a 2020 2020 2020 2020 496e 6465 7820  e.        Index 
-0001d870: 7061 7274 6974 696f 6e20 7665 6374 6f72  partition vector
-0001d880: 2066 6f72 2074 6865 2062 7365 740a 2020   for the bset.  
-0001d890: 2020 7573 6574 203a 2070 616e 6461 7320    uset : pandas 
-0001d8a0: 4461 7461 4672 616d 650a 2020 2020 2020  DataFrame.      
-0001d8b0: 2020 4120 4461 7461 4672 616d 6520 6173    A DataFrame as
-0001d8c0: 206f 7574 7075 7420 6279 0a20 2020 2020   output by.     
-0001d8d0: 2020 203a 6675 6e63 3a60 7079 7965 7469     :func:`pyyeti
-0001d8e0: 2e6e 6173 7472 616e 2e6f 7032 2e4f 5032  .nastran.op2.OP2
-0001d8f0: 2e72 646e 3263 6f70 3260 2e0a 0a20 2020  .rdn2cop2`...   
-0001d900: 2020 2020 202e 2e20 7761 726e 696e 673a       .. warning:
-0001d910: 3a0a 2020 2020 2020 2020 2020 2020 556e  :.            Un
-0001d920: 6c69 6b65 203a 6675 6e63 3a60 7079 7965  like :func:`pyye
-0001d930: 7469 2e63 622e 6d6b 5f6e 6574 5f64 726d  ti.cb.mk_net_drm
-0001d940: 7360 2c20 7468 6973 2055 5345 5420 7461  s`, this USET ta
-0001d950: 626c 650a 2020 2020 2020 2020 2020 2020  ble.            
-0001d960: 6465 6669 6e65 7320 7468 6520 622d 7365  defines the b-se
-0001d970: 7420 6e6f 6465 7320 7265 6c61 7469 7665  t nodes relative
-0001d980: 2074 6f20 7468 6520 6261 7369 6320 636f   to the basic co
-0001d990: 6f72 6469 6e61 7465 0a20 2020 2020 2020  ordinate.       
-0001d9a0: 2020 2020 2073 7973 7465 6d20 6f66 2073       system of s
-0001d9b0: 7570 6572 656c 656d 656e 7420 302e 2054  uperelement 0. T
-0001d9c0: 6869 7320 6973 2073 6f20 7468 6520 6578  his is so the ex
-0001d9d0: 7465 726e 616c 0a20 2020 2020 2020 2020  ternal.         
-0001d9e0: 2020 2073 7570 6572 656c 656d 656e 7420     superelement 
-0001d9f0: 6973 2070 6f73 6974 696f 6e65 6420 7072  is positioned pr
-0001da00: 6f70 6572 6c79 2e20 4e6f 7465 2068 6f77  operly. Note how
-0001da10: 6576 6572 2074 6861 7420 7468 650a 2020  ever that the.  
-0001da20: 2020 2020 2020 2020 2020 2264 6973 706c            "displ
-0001da30: 6163 656d 656e 7422 2063 6f6f 7264 696e  acement" coordin
-0001da40: 6174 6520 7379 7374 656d 2873 2920 2873  ate system(s) (s
-0001da50: 7065 6369 6669 6564 2061 6674 6572 2074  pecified after t
-0001da60: 6865 0a20 2020 2020 2020 2020 2020 2063  he.            c
-0001da70: 6f6f 7264 696e 6174 6573 206f 6e20 7468  oordinates on th
-0001da80: 6520 2247 5249 4422 2063 6172 6429 206d  e "GRID" card) m
-0001da90: 7573 7420 6d61 7463 6820 7768 6174 6576  ust match whatev
-0001daa0: 6572 2074 6865 0a20 2020 2020 2020 2020  er the.         
-0001dab0: 2020 2064 6973 706c 6163 656d 656e 7420     displacement 
-0001dac0: 636f 6f72 6469 6e61 7465 2073 7973 7465  coordinate syste
-0001dad0: 6d28 7329 2061 7265 2066 6f72 2074 6865  m(s) are for the
-0001dae0: 0a20 2020 2020 2020 2020 2020 2043 7261  .            Cra
-0001daf0: 6967 2d42 616d 7074 6f6e 2063 6f6d 706f  ig-Bampton compo
-0001db00: 6e65 6e74 2e0a 0a20 2020 2073 706f 696e  nent...    spoin
-0001db10: 7431 203a 2069 6e74 6567 6572 0a20 2020  t1 : integer.   
-0001db20: 2020 2020 2053 7461 7274 696e 6720 7661       Starting va
-0001db30: 6c75 6520 666f 7220 7468 6520 5350 4f49  lue for the SPOI
-0001db40: 4e54 7320 2866 6f72 206d 6f64 616c 2044  NTs (for modal D
-0001db50: 4f46 290a 2020 2020 7365 646e 203a 2069  OF).    sedn : i
-0001db60: 6e74 6567 6572 3b20 6f70 7469 6f6e 616c  nteger; optional
-0001db70: 0a20 2020 2020 2020 2044 6f77 6e73 7472  .        Downstr
-0001db80: 6561 6d20 7375 7065 7265 6c65 6d65 6e74  eam superelement
-0001db90: 2069 640a 2020 2020 6e61 6d65 6c69 7374   id.    namelist
-0001dba0: 203a 206c 6973 743b 206f 7074 696f 6e61   : list; optiona
-0001dbb0: 6c0a 2020 2020 2020 2020 4c69 7374 2c20  l.        List, 
-0001dbc0: 696e 206f 7264 6572 2c20 6f66 206e 616d  in order, of nam
-0001dbd0: 6573 2074 6f20 7772 6974 6520 746f 2074  es to write to t
-0001dbe0: 6865 206f 7034 2066 696c 652e 2056 616c  he op4 file. Val
-0001dbf0: 7565 730a 2020 2020 2020 2020 6465 6661  ues.        defa
-0001dc00: 756c 7420 746f 2031 7831 207a 6572 6f20  ult to 1x1 zero 
-0001dc10: 6d61 7472 6963 6573 2077 6974 6820 7468  matrices with th
-0001dc20: 6573 6520 6578 6365 7074 696f 6e73 3a20  ese exceptions: 
-0001dc30: 226d 6161 222c 0a20 2020 2020 2020 2022  "maa",.        "
-0001dc40: 6b61 6122 2c20 2262 6161 222c 2061 7265  kaa", "baa", are
-0001dc50: 2061 7320 696e 7075 7420 6162 6f76 652c   as input above,
-0001dc60: 2022 7061 2220 6973 2061 2076 6563 746f   "pa" is a vecto
-0001dc70: 7220 6f66 207a 6572 6f73 0a20 2020 2020  r of zeros.     
-0001dc80: 2020 2061 6e64 2022 7661 2220 6973 2061     and "va" is a
-0001dc90: 2076 6563 746f 7220 6f66 206f 6e65 732e   vector of ones.
-0001dca0: 2054 6865 2064 6566 6175 6c74 7320 6361   The defaults ca
-0001dcb0: 6e20 6265 206f 7665 7272 6964 6465 6e0a  n be overridden.
-0001dcc0: 2020 2020 2020 2020 696e 2060 6b77 6172          in `kwar
-0001dcd0: 6773 602e 0a20 2020 202a 2a6b 7761 7267  gs`..    **kwarg
-0001dce0: 7320 3a20 6f70 7469 6f6e 616c 0a20 2020  s : optional.   
-0001dcf0: 2020 2020 2041 6c6c 6f77 7320 7573 6572       Allows user
-0001dd00: 2074 6f20 696e 7075 7420 6f74 6865 7220   to input other 
-0001dd10: 6d61 7472 6963 6573 2074 6f20 6265 2077  matrices to be w
-0001dd20: 7269 7474 656e 2074 6f20 7468 6520 6f70  ritten to the op
-0001dd30: 340a 2020 2020 2020 2020 6669 6c65 2e20  4.        file. 
-0001dd40: 4e61 6d65 206d 7573 7420 696e 2060 6e61  Name must in `na
-0001dd50: 6d65 6c69 7374 6020 746f 2062 6520 7772  melist` to be wr
-0001dd60: 6974 7465 6e2e 0a0a 2020 2020 5265 7475  itten...    Retu
-0001dd70: 726e 730a 2020 2020 2d2d 2d2d 2d2d 2d0a  rns.    -------.
-0001dd80: 2020 2020 4e6f 6e65 0a20 2020 2022 2222      None.    """
-0001dd90: 0a20 2020 206d 6161 2c20 6261 612c 206b  .    maa, baa, k
-0001dda0: 6161 203d 206e 702e 6174 6c65 6173 745f  aa = np.atleast_
-0001ddb0: 3264 286d 6161 2c20 6261 612c 206b 6161  2d(maa, baa, kaa
-0001ddc0: 290a 2020 2020 6273 6574 203d 206e 702e  ).    bset = np.
-0001ddd0: 6174 6c65 6173 745f 3164 2862 7365 7429  atleast_1d(bset)
-0001dde0: 0a20 2020 206e 203d 206d 6161 2e73 6861  .    n = maa.sha
-0001ddf0: 7065 5b30 5d0a 2020 2020 6e71 203d 206e  pe[0].    nq = n
-0001de00: 202d 206c 656e 2862 7365 7429 0a0a 2020   - len(bset)..  
-0001de10: 2020 2320 7072 6570 6172 6520 7374 616e    # prepare stan
-0001de20: 6461 7264 204e 6173 7472 616e 206f 7034  dard Nastran op4
-0001de30: 2066 696c 653a 0a20 2020 2070 6120 3d20   file:.    pa = 
-0001de40: 6e70 2e7a 6572 6f73 2828 6e2c 2031 2929  np.zeros((n, 1))
-0001de50: 0a20 2020 2076 6120 3d20 6e70 2e6f 6e65  .    va = np.one
-0001de60: 7328 286e 2c20 3129 290a 2020 2020 6463  s((n, 1)).    dc
-0001de70: 7420 3d20 7b2a 2a6c 6f63 616c 7328 292c  t = {**locals(),
-0001de80: 202a 2a6b 7761 7267 737d 0a20 2020 2076   **kwargs}.    v
-0001de90: 6172 6c69 7374 203d 205b 6463 742e 6765  arlist = [dct.ge
-0001dea0: 7428 692c 2030 2e30 2920 666f 7220 6920  t(i, 0.0) for i 
-0001deb0: 696e 206e 616d 656c 6973 745d 0a20 2020  in namelist].   
-0001dec0: 206f 7034 2e77 7269 7465 286e 616d 6520   op4.write(name 
-0001ded0: 2b20 222e 6f70 3422 2c20 6e61 6d65 6c69  + ".op4", nameli
-0001dee0: 7374 2c20 7661 726c 6973 7429 0a0a 2020  st, varlist)..  
-0001def0: 2020 2320 4765 7420 736f 6d65 2064 6174    # Get some dat
-0001df00: 6120 6672 6f6d 2074 6865 2075 7365 7420  a from the uset 
-0001df10: 7461 626c 653a 0a20 2020 2063 6920 3d20  table:.    ci = 
-0001df20: 6e32 702e 6d6b 636f 7264 6361 7264 696e  n2p.mkcordcardin
-0001df30: 666f 2875 7365 7429 0a20 2020 2067 7269  fo(uset).    gri
-0001df40: 6473 203d 2075 7365 742e 696e 6465 782e  ds = uset.index.
-0001df50: 6765 745f 6c65 7665 6c5f 7661 6c75 6573  get_level_values
-0001df60: 2822 6964 2229 0a20 2020 2064 6f66 203d  ("id").    dof =
-0001df70: 2075 7365 742e 696e 6465 782e 6765 745f   uset.index.get_
-0001df80: 6c65 7665 6c5f 7661 6c75 6573 2822 646f  level_values("do
-0001df90: 6622 290a 2020 2020 7076 203d 2064 6f66  f").    pv = dof
-0001dfa0: 203d 3d20 310a 2020 2020 6772 6964 7320   == 1.    grids 
-0001dfb0: 3d20 6772 6964 735b 7076 5d0a 2020 2020  = grids[pv].    
-0001dfc0: 7879 7a20 3d20 7573 6574 2e6c 6f63 5b70  xyz = uset.loc[p
-0001dfd0: 762c 2022 7822 3a22 7a22 5d2e 7661 6c75  v, "x":"z"].valu
-0001dfe0: 6573 0a20 2020 2070 7620 3d20 646f 6620  es.    pv = dof 
-0001dff0: 3d3d 2032 0a20 2020 2063 6420 3d20 7573  == 2.    cd = us
-0001e000: 6574 2e6c 6f63 5b70 762c 2022 7822 5d2e  et.loc[pv, "x"].
-0001e010: 7661 6c75 6573 2e61 7374 7970 6528 696e  values.astype(in
-0001e020: 7429 0a0a 2020 2020 2320 5772 6974 6520  t)..    # Write 
-0001e030: 6f75 7420 4153 4d20 6669 6c65 0a20 2020  out ASM file.   
-0001e040: 2075 6e69 7420 3d20 7365 0a20 2020 2073   unit = se.    s
-0001e050: 706f 696e 746e 203d 2073 706f 696e 7431  pointn = spoint1
-0001e060: 202b 206e 7120 2d20 310a 2020 2020 7769   + nq - 1.    wi
-0001e070: 7468 206f 7065 6e28 6e61 6d65 202b 2022  th open(name + "
-0001e080: 2e61 736d 222c 2022 7722 2920 6173 2066  .asm", "w") as f
-0001e090: 3a0a 2020 2020 2020 2020 662e 7772 6974  :.        f.writ
-0001e0a0: 6528 0a20 2020 2020 2020 2020 2020 2066  e(.            f
-0001e0b0: 2224 207b 6e61 6d65 2e75 7070 6572 2829  "$ {name.upper()
-0001e0c0: 7d20 4153 5345 4d42 4c59 2046 494c 4520  } ASSEMBLY FILE 
-0001e0d0: 464f 5220 5245 5349 4455 414c 2052 554e  FOR RESIDUAL RUN
-0001e0e0: 2e2e 2e49 4e43 4c55 4445 2049 4e20 4255  ...INCLUDE IN BU
-0001e0f0: 4c4b 2044 4154 415c 6e22 0a20 2020 2020  LK DATA\n".     
-0001e100: 2020 2029 0a20 2020 2020 2020 2066 2e77     ).        f.w
-0001e110: 7269 7465 2822 245c 6e22 290a 2020 2020  rite("$\n").    
-0001e120: 2020 2020 662e 7772 6974 6528 6622 5345      f.write(f"SE
-0001e130: 4255 4c4b 2020 7b73 653a 3864 7d20 2045  BULK  {se:8d}  E
-0001e140: 5854 4f50 3420 2020 2020 2020 2020 204d  XTOP4          M
-0001e150: 414e 5541 4c20 2020 2020 2020 2020 2020  ANUAL           
-0001e160: 2020 2020 207b 756e 6974 3a38 647d 5c6e       {unit:8d}\n
-0001e170: 2229 0a20 2020 2020 2020 2066 2e77 7269  ").        f.wri
-0001e180: 7465 2866 2253 4543 4f4e 4354 207b 7365  te(f"SECONCT {se
-0001e190: 3a38 647d 7b73 6564 6e3a 3864 7d20 2020  :8d}{sedn:8d}   
-0001e1a0: 2020 2020 2020 2020 2020 204e 4f5c 6e22             NO\n"
-0001e1b0: 290a 2020 2020 2020 2020 662e 7772 6974  ).        f.writ
-0001e1c0: 6528 2220 2020 2020 2020 2022 290a 2020  e("        ").  
-0001e1d0: 2020 2020 2020 6769 6473 203d 206e 702e        gids = np.
-0001e1e0: 7673 7461 636b 2828 6772 6964 732c 2067  vstack((grids, g
-0001e1f0: 7269 6473 2929 2e54 0a20 2020 2020 2020  rids)).T.       
-0001e200: 2077 746e 6173 696e 7473 2866 2c20 322c   wtnasints(f, 2,
-0001e210: 2067 6964 732e 7261 7665 6c28 2929 0a0a   gids.ravel())..
-0001e220: 2020 2020 2020 2020 2320 5772 6974 6520          # Write 
-0001e230: 636f 6f72 6469 6e61 7465 2073 7973 7465  coordinate syste
-0001e240: 6d20 6361 7264 7320 6966 206e 6565 6465  m cards if neede
-0001e250: 643a 0a20 2020 2020 2020 2066 2e77 7269  d:.        f.wri
-0001e260: 7465 2822 245c 6e24 2043 4f4f 5244 494e  te("$\n$ COORDIN
-0001e270: 4154 4520 5359 5354 454d 2044 4154 415c  ATE SYSTEM DATA\
-0001e280: 6e24 5c6e 2229 0a20 2020 2020 2020 2077  n$\n").        w
-0001e290: 7463 6f6f 7264 6361 7264 7328 662c 2063  tcoordcards(f, c
-0001e2a0: 6929 0a0a 2020 2020 2020 2020 2320 5772  i)..        # Wr
-0001e2b0: 6974 6520 4772 6964 2064 6174 613a 0a20  ite Grid data:. 
-0001e2c0: 2020 2020 2020 2066 2e77 7269 7465 2822         f.write("
-0001e2d0: 245c 6e24 2042 4f55 4e44 4152 5920 4752  $\n$ BOUNDARY GR
-0001e2e0: 4944 2044 4154 415c 6e24 5c6e 2229 0a20  ID DATA\n$\n"). 
-0001e2f0: 2020 2020 2020 2077 7467 7269 6473 2866         wtgrids(f
-0001e300: 2c20 6772 6964 732c 2030 2c20 7879 7a2c  , grids, 0, xyz,
-0001e310: 2063 6429 0a20 2020 2020 2020 2069 6620   cd).        if 
-0001e320: 7370 6f69 6e74 6e20 3e3d 2073 706f 696e  spointn >= spoin
-0001e330: 7431 3a0a 2020 2020 2020 2020 2020 2020  t1:.            
-0001e340: 662e 7772 6974 6528 2224 5c6e 2229 0a20  f.write("$\n"). 
-0001e350: 2020 2020 2020 2020 2020 2066 2e77 7269             f.wri
-0001e360: 7465 2866 2253 4543 4f4e 4354 207b 7365  te(f"SECONCT {se
-0001e370: 3a38 647d 7b73 6564 6e3a 3864 7d20 2020  :8d}{sedn:8d}   
-0001e380: 2020 2020 2020 2020 2020 204e 4f5c 6e22             NO\n"
-0001e390: 290a 2020 2020 2020 2020 2020 2020 662e  ).            f.
-0001e3a0: 7772 6974 6528 0a20 2020 2020 2020 2020  write(.         
-0001e3b0: 2020 2020 2020 2066 2220 2020 2020 2020         f"       
-0001e3c0: 207b 7370 6f69 6e74 313a 3864 7d20 2020   {spoint1:8d}   
-0001e3d0: 2054 4852 557b 7370 6f69 6e74 6e3a 3864   THRU{spointn:8d
-0001e3e0: 7d22 0a20 2020 2020 2020 2020 2020 2020  }".             
-0001e3f0: 2020 2066 227b 7370 6f69 6e74 313a 3864     f"{spoint1:8d
-0001e400: 7d20 2020 2054 4852 557b 7370 6f69 6e74  }    THRU{spoint
-0001e410: 6e3a 3864 7d5c 6e22 0a20 2020 2020 2020  n:8d}\n".       
-0001e420: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-0001e430: 2020 2066 2e77 7269 7465 2822 245c 6e22     f.write("$\n"
-0001e440: 290a 2020 2020 2020 2020 2020 2020 662e  ).            f.
-0001e450: 7772 6974 6528 6622 5350 4f49 4e54 2020  write(f"SPOINT  
-0001e460: 7b73 706f 696e 7431 3a38 647d 2020 2020  {spoint1:8d}    
-0001e470: 5448 5255 7b73 706f 696e 746e 3a38 647d  THRU{spointn:8d}
-0001e480: 5c6e 2229 0a0a 2020 2020 2320 5772 6974  \n")..    # Writ
-0001e490: 6520 6f75 7420 5043 4820 6669 6c65 0a20  e out PCH file. 
-0001e4a0: 2020 2077 6974 6820 6f70 656e 286e 616d     with open(nam
-0001e4b0: 6520 2b20 222e 7063 6822 2c20 2277 2229  e + ".pch", "w")
-0001e4c0: 2061 7320 663a 0a20 2020 2020 2020 2066   as f:.        f
-0001e4d0: 2e77 7269 7465 2866 2224 207b 6e61 6d65  .write(f"$ {name
-0001e4e0: 2e75 7070 6572 2829 7d20 5055 4e43 4820  .upper()} PUNCH 
-0001e4f0: 4649 4c45 2046 4f52 2052 4553 4944 5541  FILE FOR RESIDUA
-0001e500: 4c20 5255 4e2e 2e2e 494e 434c 5544 4520  L RUN...INCLUDE 
-0001e510: 4154 2045 4e44 5c6e 2229 0a20 2020 2020  AT END\n").     
-0001e520: 2020 2066 2e77 7269 7465 2822 245c 6e22     f.write("$\n"
-0001e530: 290a 2020 2020 2020 2020 662e 7772 6974  ).        f.writ
-0001e540: 6528 6622 4245 4749 4e20 5355 5045 527b  e(f"BEGIN SUPER{
-0001e550: 7365 3a38 647d 5c6e 245c 6e22 290a 2020  se:8d}\n$\n").  
-0001e560: 2020 2020 2020 6964 7320 3d20 6e70 2e68        ids = np.h
-0001e570: 7374 6163 6b28 2867 7269 6473 2c20 7370  stack((grids, sp
-0001e580: 6f69 6e74 3120 2b20 6e70 2e61 7261 6e67  oint1 + np.arang
-0001e590: 6528 6e71 2929 290a 2020 2020 2020 2020  e(nq))).        
-0001e5a0: 646f 6620 3d20 6e70 2e7a 6572 6f73 5f6c  dof = np.zeros_l
-0001e5b0: 696b 6528 6964 732c 2064 7479 7065 3d69  ike(ids, dtype=i
-0001e5c0: 6e74 290a 2020 2020 2020 2020 646f 665b  nt).        dof[
-0001e5d0: 3a20 6c65 6e28 6772 6964 7329 5d20 3d20  : len(grids)] = 
-0001e5e0: 3132 3334 3536 0a20 2020 2020 2020 2077  123456.        w
-0001e5f0: 7465 7874 726e 2866 2c20 6964 732c 2064  textrn(f, ids, d
-0001e600: 6f66 290a 2020 2020 2020 2020 662e 7772  of).        f.wr
-0001e610: 6974 6528 2224 5c6e 2229 0a20 2020 2020  ite("$\n").     
-0001e620: 2020 2066 2e77 7269 7465 2822 2420 434f     f.write("$ CO
-0001e630: 4f52 4449 4e41 5445 2053 5953 5445 4d20  ORDINATE SYSTEM 
-0001e640: 4441 5441 5c6e 245c 6e22 290a 2020 2020  DATA\n$\n").    
-0001e650: 2020 2020 7774 636f 6f72 6463 6172 6473      wtcoordcards
-0001e660: 2866 2c20 6369 290a 2020 2020 2020 2020  (f, ci).        
-0001e670: 662e 7772 6974 6528 2224 5c6e 2420 424f  f.write("$\n$ BO
-0001e680: 554e 4441 5259 2047 5249 4420 4441 5441  UNDARY GRID DATA
-0001e690: 5c6e 245c 6e22 290a 2020 2020 2020 2020  \n$\n").        
-0001e6a0: 7774 6772 6964 7328 662c 2067 7269 6473  wtgrids(f, grids
-0001e6b0: 2c20 302c 2078 797a 2c20 6364 290a 2020  , 0, xyz, cd).  
-0001e6c0: 2020 2020 2020 662e 7772 6974 6528 2224        f.write("$
-0001e6d0: 5c6e 2229 0a0a 2020 2020 2020 2020 662e  \n")..        f.
-0001e6e0: 7772 6974 6528 2224 2042 5345 545c 6e24  write("$ BSET\n$
-0001e6f0: 5c6e 2229 0a20 2020 2020 2020 2066 2e77  \n").        f.w
-0001e700: 7269 7465 2866 2241 5345 5431 2020 207b  rite(f"ASET1   {
-0001e710: 3132 3334 3536 3a38 647d 2229 0a20 2020  123456:8d}").   
-0001e720: 2020 2020 2077 746e 6173 696e 7473 2866       wtnasints(f
-0001e730: 2c20 332c 2067 7269 6473 290a 2020 2020  , 3, grids).    
-0001e740: 2020 2020 6966 2073 706f 696e 746e 203e      if spointn >
-0001e750: 3d20 7370 6f69 6e74 313a 0a20 2020 2020  = spoint1:.     
-0001e760: 2020 2020 2020 2066 2e77 7269 7465 2822         f.write("
-0001e770: 245c 6e22 290a 2020 2020 2020 2020 2020  $\n").          
-0001e780: 2020 662e 7772 6974 6528 2224 2051 5345    f.write("$ QSE
-0001e790: 545c 6e24 5c6e 2229 0a20 2020 2020 2020  T\n$\n").       
-0001e7a0: 2020 2020 2066 2e77 7269 7465 2866 2251       f.write(f"Q
-0001e7b0: 5345 5431 2020 207b 303a 3864 7d7b 7370  SET1   {0:8d}{sp
-0001e7c0: 6f69 6e74 313a 3864 7d20 2020 2054 4852  oint1:8d}    THR
-0001e7d0: 557b 7370 6f69 6e74 6e3a 3864 7d5c 6e22  U{spointn:8d}\n"
-0001e7e0: 290a 2020 2020 2020 2020 2020 2020 662e  ).            f.
-0001e7f0: 7772 6974 6528 2224 5c6e 2229 0a20 2020  write("$\n").   
-0001e800: 2020 2020 2020 2020 2066 2e77 7269 7465           f.write
-0001e810: 2866 2253 504f 494e 5420 207b 7370 6f69  (f"SPOINT  {spoi
-0001e820: 6e74 313a 3864 7d20 2020 2054 4852 557b  nt1:8d}    THRU{
-0001e830: 7370 6f69 6e74 6e3a 3864 7d5c 6e22 290a  spointn:8d}\n").
-0001e840: 0a0a 6465 6620 6d6b 6e61 7374 280a 2020  ..def mknast(.  
-0001e850: 2020 7363 7269 7074 3d4e 6f6e 652c 0a20    script=None,. 
-0001e860: 2020 202a 2c0a 2020 2020 6e61 7363 6f6d     *,.    nascom
-0001e870: 3d22 6e61 7374 3970 3122 2c0a 2020 2020  ="nast9p1",.    
-0001e880: 6e61 736f 7074 3d22 6261 7463 683d 6e6f  nasopt="batch=no
-0001e890: 222c 0a20 2020 2065 7874 3d22 6f75 7422  ",.    ext="out"
-0001e8a0: 2c0a 2020 2020 7374 6f70 6f6e 6661 7461  ,.    stoponfata
-0001e8b0: 6c3d 4661 6c73 652c 0a20 2020 2073 6865  l=False,.    she
-0001e8c0: 6c6c 3d22 2f62 696e 2f73 6822 2c0a 2020  ll="/bin/sh",.  
-0001e8d0: 2020 6669 6c65 733d 4e6f 6e65 2c0a 2020    files=None,.  
-0001e8e0: 2020 6265 666f 7265 3d22 222c 0a20 2020    before="",.   
-0001e8f0: 2061 6674 6572 3d22 222c 0a20 2020 2074   after="",.    t
-0001e900: 6f70 3d22 222c 0a20 2020 2062 6f74 746f  op="",.    botto
-0001e910: 6d3d 2222 2c0a 293a 0a20 2020 2022 2222  m="",.):.    """
-0001e920: 0a20 2020 2043 7265 6174 6573 2061 2073  .    Creates a s
-0001e930: 6865 6c6c 2073 6372 6970 7420 666f 7220  hell script for 
-0001e940: 7275 6e6e 696e 6720 6120 6368 6169 6e20  running a chain 
-0001e950: 6f66 204e 6173 7472 616e 2028 6f72 206f  of Nastran (or o
-0001e960: 7468 6572 290a 2020 2020 7275 6e73 2e0a  ther).    runs..
-0001e970: 0a20 2020 204e 6f74 6520 7468 6174 2061  .    Note that a
-0001e980: 6c6c 2069 6e70 7574 7320 6578 6365 7074  ll inputs except
-0001e990: 2060 7363 7269 7074 6020 6d75 7374 2062   `script` must b
-0001e9a0: 6520 6e61 6d65 6420 616e 6420 6361 6e20  e named and can 
-0001e9b0: 6265 0a20 2020 2069 6e70 7574 2069 6e20  be.    input in 
-0001e9c0: 616e 7920 6f72 6465 722e 0a0a 2020 2020  any order...    
-0001e9d0: 5061 7261 6d65 7465 7273 0a20 2020 202d  Parameters.    -
-0001e9e0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 7363  ---------.    sc
-0001e9f0: 7269 7074 203a 2073 7472 696e 6720 6f72  ript : string or
-0001ea00: 204e 6f6e 653b 206f 7074 696f 6e61 6c0a   None; optional.
-0001ea10: 2020 2020 2020 2020 4e61 6d65 206f 6620          Name of 
-0001ea20: 7368 656c 6c20 7363 7269 7074 2074 6f20  shell script to 
-0001ea30: 6372 6561 7465 3b20 6966 204e 6f6e 652c  create; if None,
-0001ea40: 2075 7365 7220 6973 2070 726f 6d70 7465   user is prompte
-0001ea50: 6420 666f 720a 2020 2020 2020 2020 6e61  d for.        na
-0001ea60: 6d65 2e0a 2020 2020 6e61 7363 6f6d 203a  me..    nascom :
-0001ea70: 2073 7472 696e 673b 206f 7074 696f 6e61   string; optiona
-0001ea80: 6c0a 2020 2020 2020 2020 4e61 7374 7261  l.        Nastra
-0001ea90: 6e20 636f 6d6d 616e 643b 206e 6f74 653a  n command; note:
-0001eaa0: 2074 6869 7320 6361 6e20 6163 7475 616c   this can actual
-0001eab0: 6c79 2073 7065 6369 6679 2061 6e79 2070  ly specify any p
-0001eac0: 726f 6772 616d 2c0a 2020 2020 2020 2020  rogram,.        
-0001ead0: 6275 7420 606e 6173 6f70 7460 2077 6f75  but `nasopt` wou
-0001eae0: 6c64 206c 696b 656c 7920 6e65 6564 2061  ld likely need a
-0001eaf0: 646a 7573 7469 6e67 2074 6f6f 2e0a 2020  djusting too..  
-0001eb00: 2020 6e61 736f 7074 203a 2073 7472 696e    nasopt : strin
-0001eb10: 673b 206f 7074 696f 6e61 6c0a 2020 2020  g; optional.    
-0001eb20: 2020 2020 4f70 7469 6f6e 7320 666f 7220      Options for 
-0001eb30: 6e61 7374 7261 6e20 636f 6d6d 616e 640a  nastran command.
-0001eb40: 2020 2020 6578 7420 3a20 7374 7269 6e67      ext : string
-0001eb50: 3b20 6f70 7469 6f6e 616c 0a20 2020 2020  ; optional.     
-0001eb60: 2020 2054 6865 2065 7874 656e 7369 6f6e     The extension
-0001eb70: 206f 6620 7468 6520 4e61 7374 7261 6e20   of the Nastran 
-0001eb80: 6f75 7470 7574 2028 6630 3629 2066 696c  output (f06) fil
-0001eb90: 653b 2075 7375 616c 6c79 2027 6630 3627  e; usually 'f06'
-0001eba0: 0a20 2020 2020 2020 206f 7220 276f 7574  .        or 'out
-0001ebb0: 270a 2020 2020 7374 6f70 6f6e 6661 7461  '.    stoponfata
-0001ebc0: 6c20 3a20 626f 6f6c 3b20 6f70 7469 6f6e  l : bool; option
-0001ebd0: 616c 0a20 2020 2020 2020 2053 6574 2074  al.        Set t
-0001ebe0: 6f20 5472 7565 2069 6620 796f 7520 7761  o True if you wa
-0001ebf0: 6e74 2074 6865 2073 6372 6970 7420 746f  nt the script to
-0001ec00: 2065 7869 7420 6f6e 2066 6972 7374 2046   exit on first F
-0001ec10: 4154 414c 0a20 2020 2020 2020 2069 6e73  ATAL.        ins
-0001ec20: 7465 6164 206f 6620 636f 6e74 696e 7569  tead of continui
-0001ec30: 6e67 206f 6e0a 2020 2020 7368 656c 6c20  ng on.    shell 
-0001ec40: 3a20 7374 7269 6e67 3b20 6f70 7469 6f6e  : string; option
-0001ec50: 616c 0a20 2020 2020 2020 2053 6865 6c6c  al.        Shell
-0001ec60: 2070 726f 6772 616d 2074 6f20 7772 6974   program to writ
-0001ec70: 6520 6174 2074 6f70 206f 6620 7363 7269  e at top of scri
-0001ec80: 7074 2c20 6567 3a20 2321 6073 6865 6c6c  pt, eg: #!`shell
-0001ec90: 600a 2020 2020 6669 6c65 7320 3a20 7374  `.    files : st
-0001eca0: 7269 6e67 206f 7220 4e6f 6e65 3b20 6f70  ring or None; op
-0001ecb0: 7469 6f6e 616c 0a20 2020 2020 2020 204c  tional.        L
-0001ecc0: 6973 7420 6f66 2066 696c 656e 616d 6573  ist of filenames
-0001ecd0: 2074 6f20 7275 6e3b 2069 6620 4e6f 6e65   to run; if None
-0001ece0: 2c20 7573 6572 2069 7320 7072 6f6d 7074  , user is prompt
-0001ecf0: 6564 2066 6f72 206e 616d 6573 0a20 2020  ed for names.   
-0001ed00: 2062 6566 6f72 6520 3a20 7374 7269 6e67   before : string
-0001ed10: 3b20 6f70 7469 6f6e 616c 0a20 2020 2020  ; optional.     
-0001ed20: 2020 2053 7472 696e 6720 746f 2070 7574     String to put
-0001ed30: 2069 6e20 7368 656c 6c20 7363 7269 7074   in shell script
-0001ed40: 2062 6566 6f72 6520 6561 6368 206e 6173   before each nas
-0001ed50: 7472 616e 2063 6f6d 6d61 6e64 0a20 2020  tran command.   
-0001ed60: 2061 6674 6572 203a 2073 7472 696e 673b   after : string;
-0001ed70: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
-0001ed80: 2020 5374 7269 6e67 2074 6f20 7075 7420    String to put 
-0001ed90: 696e 2073 6865 6c6c 2073 6372 6970 7420  in shell script 
-0001eda0: 6166 7465 7220 6561 6368 206e 6173 7472  after each nastr
-0001edb0: 616e 2063 6f6d 6d61 6e64 0a20 2020 2074  an command.    t
-0001edc0: 6f70 203a 2073 7472 696e 673b 206f 7074  op : string; opt
-0001edd0: 696f 6e61 6c0a 2020 2020 2020 2020 5374  ional.        St
-0001ede0: 7269 6e67 2074 6f20 7075 7420 696e 2073  ring to put in s
-0001edf0: 6865 6c6c 2073 6372 6970 7420 6174 2074  hell script at t
-0001ee00: 6865 2074 6f70 0a20 2020 2062 6f74 746f  he top.    botto
-0001ee10: 6d20 3a20 7374 7269 6e67 3b20 6f70 7469  m : string; opti
-0001ee20: 6f6e 616c 0a20 2020 2020 2020 2053 7472  onal.        Str
-0001ee30: 696e 6720 746f 2070 7574 2069 6e20 7368  ing to put in sh
-0001ee40: 656c 6c20 7363 7269 7074 2061 7420 7468  ell script at th
-0001ee50: 6520 626f 7474 6f6d 0a0a 2020 2020 5265  e bottom..    Re
-0001ee60: 7475 726e 730a 2020 2020 2d2d 2d2d 2d2d  turns.    ------
-0001ee70: 2d0a 2020 2020 4e6f 6e65 0a0a 2020 2020  -.    None..    
-0001ee80: 4e6f 7465 730a 2020 2020 2d2d 2d2d 2d0a  Notes.    -----.
-0001ee90: 2020 2020 4966 2079 6f75 2772 6520 696e      If you're in
-0001eea0: 2074 6865 2027 6261 7368 2720 7368 656c   the 'bash' shel
-0001eeb0: 6c2c 2074 6865 2072 6573 756c 7469 6e67  l, the resulting
-0001eec0: 2073 6372 6970 7420 6361 6e20 6265 2072   script can be r
-0001eed0: 756e 2069 6e0a 2020 2020 7468 6520 6261  un in.    the ba
-0001eee0: 636b 6772 6f75 6e64 2077 6974 682c 2061  ckground with, a
-0001eef0: 7373 756d 696e 6720 7468 6520 7363 7269  ssuming the scri
-0001ef00: 7074 206e 616d 6520 6973 2027 646f 7275  pt name is 'doru
-0001ef10: 6e73 2e73 6827 3a3a 0a0a 2020 2020 2020  ns.sh'::..      
-0001ef20: 206e 6f68 7570 202e 2f64 6f72 756e 732e   nohup ./doruns.
-0001ef30: 7368 203e 2064 6f72 756e 732e 6c6f 6720  sh > doruns.log 
-0001ef40: 323e 2631 2026 0a0a 2020 2020 4578 616d  2>&1 &..    Exam
-0001ef50: 706c 6520 7573 6167 653a 3a0a 0a20 2020  ple usage::..   
-0001ef60: 2020 2020 2066 726f 6d20 7079 7965 7469       from pyyeti
-0001ef70: 2069 6d70 6f72 7420 6e61 7374 7261 6e0a   import nastran.
-0001ef80: 2020 2020 2020 2020 6e61 7374 7261 6e2e          nastran.
-0001ef90: 6d6b 6e61 7374 2827 646f 7275 6e73 2e73  mknast('doruns.s
-0001efa0: 6827 2c20 6669 6c65 733d 5b27 6669 6c65  h', files=['file
-0001efb0: 312e 6461 7427 2c20 2766 696c 6532 2e64  1.dat', 'file2.d
-0001efc0: 6174 275d 290a 2020 2020 2222 220a 2020  at']).    """.  
-0001efd0: 2020 2320 4e61 6d65 206f 6620 7363 7269    # Name of scri
-0001efe0: 7074 2074 6f20 6372 6561 7465 3a0a 2020  pt to create:.  
-0001eff0: 2020 6966 2073 6372 6970 7420 6973 204e    if script is N
-0001f000: 6f6e 653a 0a20 2020 2020 2020 2073 6372  one:.        scr
-0001f010: 6970 7420 3d20 696e 7075 7428 224e 616d  ipt = input("Nam
-0001f020: 6520 6f66 2073 6865 6c6c 2073 6372 6970  e of shell scrip
-0001f030: 7420 746f 2063 7265 6174 6520 2864 6f72  t to create (dor
-0001f040: 756e 732e 7368 293a 2022 290a 2020 2020  uns.sh): ").    
-0001f050: 2020 2020 6966 206e 6f74 2073 6372 6970      if not scrip
-0001f060: 743a 0a20 2020 2020 2020 2020 2020 2073  t:.            s
-0001f070: 6372 6970 7420 3d20 2264 6f72 756e 732e  cript = "doruns.
-0001f080: 7368 220a 0a20 2020 2023 2069 6e69 7469  sh"..    # initi
-0001f090: 616c 697a 6520 7368 656c 6c20 7363 7269  alize shell scri
-0001f0a0: 7074 0a20 2020 2047 5245 5020 3d20 2267  pt.    GREP = "g
-0001f0b0: 7265 7020 2d6c 2027 5b2a 5e5d 5b2a 5e5d  rep -l '[*^][*^]
-0001f0c0: 5b2a 5e5d 2e2a 4641 5441 4c27 220a 2020  [*^].*FATAL'".  
-0001f0d0: 2020 7769 7468 206f 7065 6e28 7363 7269    with open(scri
-0001f0e0: 7074 2c20 2277 2229 2061 7320 663a 0a20  pt, "w") as f:. 
-0001f0f0: 2020 2020 2020 2066 2e77 7269 7465 2866         f.write(f
-0001f100: 2223 217b 7368 656c 6c7d 5c6e 2229 0a20  "#!{shell}\n"). 
-0001f110: 2020 2020 2020 2063 7572 6469 7220 3d20         curdir = 
-0001f120: 6f73 2e67 6574 6377 6428 290a 2020 2020  os.getcwd().    
-0001f130: 2020 2020 662e 7772 6974 6528 6622 6364      f.write(f"cd
-0001f140: 207b 6375 7264 6972 7d5c 6e5c 6e22 290a   {curdir}\n\n").
-0001f150: 2020 2020 2020 2020 6966 2074 6f70 3a0a          if top:.
-0001f160: 2020 2020 2020 2020 2020 2020 662e 7772              f.wr
-0001f170: 6974 6528 6622 7b74 6f70 7d5c 6e22 290a  ite(f"{top}\n").
-0001f180: 0a20 2020 2020 2020 2069 203d 202d 310a  .        i = -1.
-0001f190: 2020 2020 2020 2020 7768 696c 6520 313a          while 1:
-0001f1a0: 2020 2320 6c6f 6f70 206f 7665 7220 6669    # loop over fi
-0001f1b0: 6c65 206e 616d 6573 0a20 2020 2020 2020  le names.       
-0001f1c0: 2020 2020 2069 202b 3d20 310a 2020 2020       i += 1.    
-0001f1d0: 2020 2020 2020 2020 6966 2066 696c 6573          if files
-0001f1e0: 2069 7320 6e6f 7420 4e6f 6e65 3a0a 2020   is not None:.  
-0001f1f0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0001f200: 2069 203e 3d20 6c65 6e28 6669 6c65 7329   i >= len(files)
-0001f210: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0001f220: 2020 2020 2020 6272 6561 6b0a 2020 2020        break.    
-0001f230: 2020 2020 2020 2020 2020 2020 656c 7365              else
-0001f240: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0001f250: 2020 2020 2020 6e61 7366 696c 6520 3d20        nasfile = 
-0001f260: 6669 6c65 735b 695d 0a20 2020 2020 2020  files[i].       
-0001f270: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-0001f280: 2020 2020 2020 2020 2020 2070 203d 2066             p = f
-0001f290: 2246 696c 6520 237b 6920 2b20 313a 3264  "File #{i + 1:2d
-0001f2a0: 7d20 2862 6c61 6e6b 2074 6f20 7175 6974  } (blank to quit
-0001f2b0: 293a 2022 0a20 2020 2020 2020 2020 2020  ): ".           
-0001f2c0: 2020 2020 206e 6173 6669 6c65 203d 2069       nasfile = i
-0001f2d0: 6e70 7574 2870 290a 2020 2020 2020 2020  nput(p).        
-0001f2e0: 2020 2020 2020 2020 6966 206e 6f74 206e          if not n
-0001f2f0: 6173 6669 6c65 3a0a 2020 2020 2020 2020  asfile:.        
-0001f300: 2020 2020 2020 2020 2020 2020 6272 6561              brea
-0001f310: 6b0a 0a20 2020 2020 2020 2020 2020 2069  k..            i
-0001f320: 6620 6e6f 7420 6f73 2e70 6174 682e 6578  f not os.path.ex
-0001f330: 6973 7473 286e 6173 6669 6c65 293a 0a20  ists(nasfile):. 
-0001f340: 2020 2020 2020 2020 2020 2020 2020 2077                 w
-0001f350: 6172 6e69 6e67 732e 7761 726e 280a 2020  arnings.warn(.  
-0001f360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f370: 2020 6622 6669 6c65 2027 7b6e 6173 6669    f"file '{nasfi
-0001f380: 6c65 7d27 206e 6f74 2066 6f75 6e64 222c  le}' not found",
-0001f390: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001f3a0: 2020 2020 2052 756e 7469 6d65 5761 726e       RuntimeWarn
-0001f3b0: 696e 672c 0a20 2020 2020 2020 2020 2020  ing,.           
-0001f3c0: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
-0001f3d0: 2020 2020 662e 7772 6974 6528 6622 5c6e      f.write(f"\n
-0001f3e0: 2320 2a2a 2a2a 2a2a 2a2a 2046 696c 6520  # ******** File 
-0001f3f0: 7b6e 6173 6669 6c65 7d20 2a2a 2a2a 2a2a  {nasfile} ******
-0001f400: 2a2a 5c6e 2229 0a20 2020 2020 2020 2020  **\n").         
-0001f410: 2020 2070 203d 206e 6173 6669 6c65 2e72     p = nasfile.r
-0001f420: 6669 6e64 2822 2f22 290a 2020 2020 2020  find("/").      
-0001f430: 2020 2020 2020 6966 2070 203e 202d 313a        if p > -1:
-0001f440: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001f450: 2066 696c 6570 6174 6820 3d20 6e61 7366   filepath = nasf
-0001f460: 696c 655b 3a70 5d0a 2020 2020 2020 2020  ile[:p].        
-0001f470: 2020 2020 2020 2020 6669 6c65 6e61 6d65          filename
-0001f480: 203d 206e 6173 6669 6c65 5b70 202b 2031   = nasfile[p + 1
-0001f490: 203a 5d0a 2020 2020 2020 2020 2020 2020   :].            
-0001f4a0: 2020 2020 662e 7772 6974 6528 6622 2020      f.write(f"  
-0001f4b0: 6364 207b 6669 6c65 7061 7468 7d5c 6e22  cd {filepath}\n"
-0001f4c0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0001f4d0: 2020 646f 6364 203d 2031 0a20 2020 2020    docd = 1.     
-0001f4e0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-0001f4f0: 2020 2020 2020 2020 2020 2020 2066 696c               fil
-0001f500: 656e 616d 6520 3d20 6e61 7366 696c 650a  ename = nasfile.
-0001f510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f520: 646f 6364 203d 2030 0a0a 2020 2020 2020  docd = 0..      
-0001f530: 2020 2020 2020 6966 2062 6566 6f72 653a        if before:
-0001f540: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001f550: 2066 2e77 7269 7465 2866 227b 6265 666f   f.write(f"{befo
-0001f560: 7265 7d5c 6e22 290a 2020 2020 2020 2020  re}\n").        
-0001f570: 2020 2020 662e 7772 6974 6528 6622 2020      f.write(f"  
-0001f580: 7b6e 6173 636f 6d7d 2027 7b6e 6173 6f70  {nascom} '{nasop
-0001f590: 747d 2720 277b 6669 6c65 6e61 6d65 7d27  t}' '{filename}'
-0001f5a0: 5c6e 2229 0a0a 2020 2020 2020 2020 2020  \n")..          
-0001f5b0: 2020 6966 2073 746f 706f 6e66 6174 616c    if stoponfatal
-0001f5c0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0001f5d0: 2020 7020 3d20 6669 6c65 6e61 6d65 2e72    p = filename.r
-0001f5e0: 6669 6e64 2822 2e22 290a 2020 2020 2020  find(".").      
-0001f5f0: 2020 2020 2020 2020 2020 6966 2070 203e            if p >
-0001f600: 202d 313a 0a20 2020 2020 2020 2020 2020   -1:.           
-0001f610: 2020 2020 2020 2020 2066 3036 6669 6c65           f06file
-0001f620: 203d 2066 696c 656e 616d 655b 3a20 7020   = filename[: p 
-0001f630: 2b20 315d 202b 2065 7874 0a20 2020 2020  + 1] + ext.     
-0001f640: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-0001f650: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001f660: 2020 2020 2066 3036 6669 6c65 203d 2066       f06file = f
-0001f670: 696c 656e 616d 6520 2b20 222e 2220 2b20  ilename + "." + 
-0001f680: 6578 740a 0a20 2020 2020 2020 2020 2020  ext..           
-0001f690: 2020 2020 2066 2e77 7269 7465 2866 2220       f.write(f" 
-0001f6a0: 2069 6620 5b20 5820 213d 2058 607b 4752   if [ X != X`{GR
-0001f6b0: 4550 7d20 7b66 3036 6669 6c65 7d60 205d  EP} {f06file}` ]
-0001f6c0: 203b 2074 6865 6e5c 6e22 290a 2020 2020   ; then\n").    
-0001f6d0: 2020 2020 2020 2020 2020 2020 662e 7772              f.wr
-0001f6e0: 6974 6528 2220 2020 2065 7869 745c 6e22  ite("    exit\n"
-0001f6f0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0001f700: 2020 662e 7772 6974 6528 2220 2066 695c    f.write("  fi\
-0001f710: 6e22 290a 2020 2020 2020 2020 2020 2020  n").            
-0001f720: 6966 2061 6674 6572 3a0a 2020 2020 2020  if after:.      
-0001f730: 2020 2020 2020 2020 2020 662e 7772 6974            f.writ
-0001f740: 6528 6622 7b61 6674 6572 7d5c 6e22 290a  e(f"{after}\n").
-0001f750: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0001f760: 646f 6364 3a0a 2020 2020 2020 2020 2020  docd:.          
-0001f770: 2020 2020 2020 662e 7772 6974 6528 6622        f.write(f"
-0001f780: 2020 6364 207b 6375 7264 6972 7d5c 6e22    cd {curdir}\n"
-0001f790: 290a 0a20 2020 2020 2020 2069 6620 626f  )..        if bo
-0001f7a0: 7474 6f6d 3a0a 2020 2020 2020 2020 2020  ttom:.          
-0001f7b0: 2020 662e 7772 6974 6528 6622 7b62 6f74    f.write(f"{bot
-0001f7c0: 746f 6d7d 5c6e 2229 0a20 2020 206f 732e  tom}\n").    os.
-0001f7d0: 7379 7374 656d 2866 2263 686d 6f64 2061  system(f"chmod a
-0001f7e0: 2b72 7820 277b 7363 7269 7074 7d27 2229  +rx '{script}'")
-0001f7f0: 0a0a 0a64 6566 2072 6464 7469 7063 6828  ...def rddtipch(
-0001f800: 662c 206e 616d 653d 2254 5547 3122 293a  f, name="TUG1"):
-0001f810: 0a20 2020 2022 2222 0a20 2020 2052 6561  .    """.    Rea
-0001f820: 6420 7468 6520 326e 6420 7265 636f 7264  d the 2nd record
-0001f830: 206f 6620 7370 6563 6966 6963 2044 5449   of specific DTI
-0001f840: 7320 6672 6f6d 2061 202e 7063 6820 6669  s from a .pch fi
-0001f850: 6c65 2e0a 0a20 2020 2050 6172 616d 6574  le...    Paramet
-0001f860: 6572 730a 2020 2020 2d2d 2d2d 2d2d 2d2d  ers.    --------
-0001f870: 2d2d 0a20 2020 2066 203a 2073 7472 696e  --.    f : strin
-0001f880: 6720 6f72 2066 696c 655f 6c69 6b65 206f  g or file_like o
-0001f890: 7220 4e6f 6e65 0a20 2020 2020 2020 2045  r None.        E
-0001f8a0: 6974 6865 7220 6120 6e61 6d65 206f 6620  ither a name of 
-0001f8b0: 6120 6669 6c65 2c20 6f72 2069 7320 6120  a file, or is a 
-0001f8c0: 6669 6c65 5f6c 696b 6520 6f62 6a65 6374  file_like object
-0001f8d0: 2061 7320 7265 7475 726e 6564 0a20 2020   as returned.   
-0001f8e0: 2020 2020 2062 7920 3a66 756e 633a 606f       by :func:`o
-0001f8f0: 7065 6e60 2e20 4966 2066 696c 655f 6c69  pen`. If file_li
-0001f900: 6b65 206f 626a 6563 742c 2069 7420 6973  ke object, it is
-0001f910: 2072 6577 6f75 6e64 2066 6972 7374 2e20   rewound first. 
-0001f920: 4361 6e0a 2020 2020 2020 2020 616c 736f  Can.        also
-0001f930: 2062 6520 7468 6520 6e61 6d65 206f 6620   be the name of 
-0001f940: 6120 6469 7265 6374 6f72 7920 6f72 204e  a directory or N
-0001f950: 6f6e 653b 2069 6e20 7468 6573 6520 6361  one; in these ca
-0001f960: 7365 732c 2061 2047 5549 0a20 2020 2020  ses, a GUI.     
-0001f970: 2020 2069 7320 6f70 656e 6564 2066 6f72     is opened for
-0001f980: 2066 696c 6520 7365 6c65 6374 696f 6e2e   file selection.
-0001f990: 0a20 2020 206e 616d 6520 3a20 7374 7269  .    name : stri
-0001f9a0: 6e67 0a20 2020 2020 2020 204e 616d 6520  ng.        Name 
-0001f9b0: 6f66 2044 5449 2074 6162 6c65 2074 6f20  of DTI table to 
-0001f9c0: 7265 6164 2066 726f 6d20 7468 6520 2e70  read from the .p
-0001f9d0: 6368 2066 696c 650a 0a20 2020 2052 6574  ch file..    Ret
-0001f9e0: 7572 6e73 0a20 2020 202d 2d2d 2d2d 2d2d  urns.    -------
-0001f9f0: 0a20 2020 2069 645f 646f 6620 3a20 6e64  .    id_dof : nd
-0001fa00: 6172 7261 790a 2020 2020 2020 2020 322d  array.        2-
-0001fa10: 636f 6c75 6d6e 206d 6174 7269 7820 6f66  column matrix of
-0001fa20: 2074 6865 2066 6f72 6d3a 2060 605b 6964   the form: ``[id
-0001fa30: 2c20 646f 665d 6060 2e20 5468 6520 6e75  , dof]``. The nu
-0001fa40: 6d62 6572 206f 6620 726f 7773 0a20 2020  mber of rows.   
-0001fa50: 2020 2020 2069 6e20 6069 645f 646f 6660       in `id_dof`
-0001fa60: 2063 6f72 7265 7370 6f6e 6473 2074 6f20   corresponds to 
-0001fa70: 7468 6520 6d61 7463 6869 6e67 206d 6174  the matching mat
-0001fa80: 7269 7820 696e 202e 6f70 3420 6669 6c65  rix in .op4 file
-0001fa90: 0a20 2020 2020 2020 2028 7365 6520 4e6f  .        (see No
-0001faa0: 7465 7329 2e0a 0a20 2020 204e 6f74 6573  tes)...    Notes
-0001fab0: 0a20 2020 202d 2d2d 2d2d 0a20 2020 2054  .    -----.    T
-0001fac0: 6869 7320 726f 7574 696e 6520 6973 2075  his routine is u
-0001fad0: 7365 6675 6c20 666f 7220 7265 6164 696e  seful for readin
-0001fae0: 6720 6461 7461 2066 726f 6d20 2e70 6368  g data from .pch
-0001faf0: 2066 696c 6573 2077 7269 7474 656e 2062   files written b
-0001fb00: 790a 2020 2020 7468 6520 4558 5453 454f  y.    the EXTSEO
-0001fb10: 5554 2063 6f6d 6d61 6e64 2e20 5468 6520  UT command. The 
-0001fb20: 326e 6420 7265 636f 7264 206f 6620 2254  2nd record of "T
-0001fb30: 5547 3122 2028 666f 7220 6578 616d 706c  UG1" (for exampl
-0001fb40: 6529 0a20 2020 2063 6f6e 7461 696e 7320  e).    contains 
-0001fb50: 7468 6520 444f 4620 7468 6174 2063 6f72  the DOF that cor
-0001fb60: 7265 7370 6f6e 6420 746f 2074 6865 2072  respond to the r
-0001fb70: 6f77 7320 6f66 2074 6865 2022 4d55 4731  ows of the "MUG1
-0001fb80: 2220 6d61 7472 6978 0a20 2020 2069 6e20  " matrix.    in 
-0001fb90: 7468 6520 2e6f 7034 2066 696c 652e 2054  the .op4 file. T
-0001fba0: 6861 7420 6d61 7472 6978 2063 616e 2062  hat matrix can b
-0001fbb0: 6520 7265 6164 2062 7920 7468 650a 2020  e read by the.  
-0001fbc0: 2020 3a6d 6f64 3a60 7079 7965 7469 2e6e    :mod:`pyyeti.n
-0001fbd0: 6173 7472 616e 2e6f 7034 6020 6d6f 6475  astran.op4` modu
-0001fbe0: 6c65 2e0a 0a20 2020 2045 7861 6d70 6c65  le...    Example
-0001fbf0: 2075 7361 6765 3a3a 0a0a 2020 2020 2020   usage::..      
-0001fc00: 2020 2320 7265 6164 206d 7567 3120 616e    # read mug1 an
-0001fc10: 6420 7475 6731 2028 6372 6561 7465 6420  d tug1 (created 
-0001fc20: 6672 6f6d 2045 5854 5345 4f55 5429 3a0a  from EXTSEOUT):.
-0001fc30: 2020 2020 2020 2020 6672 6f6d 2070 7979          from pyy
-0001fc40: 6574 6920 696d 706f 7274 206e 6173 7472  eti import nastr
-0001fc50: 616e 0a20 2020 2020 2020 2066 726f 6d20  an.        from 
-0001fc60: 7079 7965 7469 2e6e 6173 7472 616e 2069  pyyeti.nastran i
-0001fc70: 6d70 6f72 7420 6f70 340a 2020 2020 2020  mport op4.      
-0001fc80: 2020 6d75 6731 203d 206f 7034 2e72 6561    mug1 = op4.rea
-0001fc90: 6428 2764 6174 612e 6f70 3427 2c20 276d  d('data.op4', 'm
-0001fca0: 7567 3127 295b 276d 7567 3127 5d0a 2020  ug1')['mug1'].  
-0001fcb0: 2020 2020 2020 7475 6731 203d 206e 6173        tug1 = nas
-0001fcc0: 7472 616e 2e72 6464 7469 7063 6828 2764  tran.rddtipch('d
-0001fcd0: 6174 612e 7063 6827 290a 0a20 2020 2020  ata.pch')..     
-0001fce0: 2020 2023 2066 6f72 6d20 4452 4d20 746f     # form DRM to
-0001fcf0: 2072 6563 6f76 6572 7920 6772 6964 2031   recovery grid 1
-0001fd00: 3030 2c20 646f 6620 343a 0a20 2020 2020  00, dof 4:.     
-0001fd10: 2020 2066 726f 6d20 7079 7965 7469 2069     from pyyeti i
-0001fd20: 6d70 6f72 7420 6c6f 6361 7465 0a20 2020  mport locate.   
-0001fd30: 2020 2020 2072 6f77 203d 206c 6f63 6174       row = locat
-0001fd40: 652e 6669 6e64 5f72 6f77 7328 7475 6731  e.find_rows(tug1
-0001fd50: 2c20 5b31 3030 2c20 345d 290a 2020 2020  , [100, 4]).    
-0001fd60: 2020 2020 6472 6d20 3d20 6d75 6731 5b72      drm = mug1[r
-0001fd70: 6f77 2c20 3a5d 0a20 2020 2022 2222 0a20  ow, :].    """. 
-0001fd80: 2020 2073 7472 696e 6720 3d20 6622 4454     string = f"DT
-0001fd90: 4920 2020 2020 7b6e 616d 653a 3c38 737d  I     {name:<8s}
-0001fda0: 3222 0a20 2020 2063 203d 2072 6463 6172  2".    c = rdcar
-0001fdb0: 6473 2866 2c20 7374 7269 6e67 290a 2020  ds(f, string).  
-0001fdc0: 2020 6320 3d20 635b 302c 2031 363a 2d31    c = c[0, 16:-1
-0001fdd0: 5d2e 7265 7368 6170 6528 2d31 2c20 3429  ].reshape(-1, 4)
-0001fde0: 2e61 7374 7970 6528 6e70 2e69 6e74 3634  .astype(np.int64
-0001fdf0: 290a 2020 2020 6d20 3d20 635b 3a2c 2031  ).    m = c[:, 1
-0001fe00: 3a5d 0a0a 2020 2020 2320 6172 7261 7928  :]..    # array(
-0001fe10: 5b5b 2020 2020 2020 332c 2020 2020 2020  [[      3,      
-0001fe20: 2036 2c20 2020 2020 2020 315d 2c0a 2020   6,       1],.  
-0001fe30: 2020 2320 2020 2020 2020 205b 2020 2020    #        [    
-0001fe40: 2031 312c 2020 2020 2020 2036 2c20 2020   11,       6,   
-0001fe50: 2020 2020 375d 2c0a 2020 2020 2320 2020      7],.    #   
-0001fe60: 2020 2020 205b 2020 2020 2031 392c 2020       [     19,  
-0001fe70: 2020 2020 2036 2c20 2020 2020 2031 335d       6,      13]
-0001fe80: 2c0a 2020 2020 2320 2020 2020 2020 205b  ,.    #        [
-0001fe90: 2020 2020 2032 372c 2020 2020 2020 2036       27,       6
-0001fea0: 2c20 2020 2020 2031 395d 2c0a 2020 2020  ,      19],.    
-0001feb0: 2320 2020 2020 2020 205b 2020 2020 2034  #        [     4
-0001fec0: 352c 2020 2020 2020 2036 2c20 2020 2020  5,       6,     
-0001fed0: 2032 355d 2c0a 2020 2020 2320 2020 2020   25],.    #     
-0001fee0: 2020 205b 2020 2020 2036 302c 2020 2020     [     60,    
-0001fef0: 2020 2036 2c20 2020 2020 2033 315d 2c0a     6,      31],.
-0001ff00: 2020 2020 2320 2020 2020 2020 205b 3139      #        [19
-0001ff10: 3935 3030 322c 2020 2020 2020 2036 2c20  95002,       6, 
-0001ff20: 2020 2020 2033 375d 5d29 0a0a 2020 2020       37]])..    
-0001ff30: 6966 206e 702e 616c 6c28 6d5b 3a2c 2031  if np.all(m[:, 1
-0001ff40: 5d20 3d3d 206d 5b30 2c20 315d 293a 0a20  ] == m[0, 1]):. 
-0001ff50: 2020 2020 2020 2023 2061 6c6c 2069 6473         # all ids
-0001ff60: 2068 6176 6520 7361 6d65 206e 756d 6265   have same numbe
-0001ff70: 7220 6f66 2063 6f6d 706f 6e65 6e74 732c  r of components,
-0001ff80: 2073 6f20 7461 6b65 2073 686f 7274 6375   so take shortcu
-0001ff90: 743a 0a20 2020 2020 2020 2063 203d 206d  t:.        c = m
-0001ffa0: 5b30 2c20 315d 0a20 2020 2020 2020 2069  [0, 1].        i
-0001ffb0: 6473 203d 206e 702e 646f 7428 6d5b 3a2c  ds = np.dot(m[:,
-0001ffc0: 2030 3a31 5d2c 206e 702e 6f6e 6573 2828   0:1], np.ones((
-0001ffd0: 312c 2063 292c 206e 702e 696e 7436 3429  1, c), np.int64)
-0001ffe0: 290a 2020 2020 2020 2020 6964 7320 3d20  ).        ids = 
-0001fff0: 6964 732e 7265 7368 6170 6528 282d 312c  ids.reshape((-1,
-00020000: 2031 2929 0a20 2020 2020 2020 2064 6f66   1)).        dof
-00020010: 203d 206e 702e 6172 616e 6765 2831 2c20   = np.arange(1, 
-00020020: 6320 2b20 312c 2064 7479 7065 3d6e 702e  c + 1, dtype=np.
-00020030: 696e 7436 3429 2e72 6573 6861 7065 2831  int64).reshape(1
-00020040: 2c20 2d31 290a 2020 2020 2020 2020 646f  , -1).        do
-00020050: 6673 203d 206e 702e 646f 7428 6e70 2e6f  fs = np.dot(np.o
-00020060: 6e65 7328 286e 702e 7369 7a65 286d 2c20  nes((np.size(m, 
-00020070: 3029 2c20 3129 2c20 6e70 2e69 6e74 3634  0), 1), np.int64
-00020080: 292c 2064 6f66 290a 2020 2020 2020 2020  ), dof).        
-00020090: 646f 6673 203d 2064 6f66 732e 7265 7368  dofs = dofs.resh
-000200a0: 6170 6528 282d 312c 2031 2929 0a20 2020  ape((-1, 1)).   
-000200b0: 2020 2020 2069 6464 6f66 203d 206e 702e       iddof = np.
-000200c0: 6873 7461 636b 2828 6964 732c 2064 6f66  hstack((ids, dof
-000200d0: 7329 290a 2020 2020 656c 7365 3a0a 2020  s)).    else:.  
-000200e0: 2020 2020 2020 6e72 6f77 7320 3d20 6d5b        nrows = m[
-000200f0: 2d31 2c20 325d 202b 206d 5b2d 312c 2031  -1, 2] + m[-1, 1
-00020100: 5d20 2d20 310a 2020 2020 2020 2020 6964  ] - 1.        id
-00020110: 646f 6620 3d20 6e70 2e7a 6572 6f73 2828  dof = np.zeros((
-00020120: 6e72 6f77 732c 2032 292c 206e 702e 696e  nrows, 2), np.in
-00020130: 7436 3429 0a20 2020 2020 2020 206a 203d  t64).        j =
-00020140: 2030 0a20 2020 2020 2020 2066 6f72 204a   0.        for J
-00020150: 2069 6e20 7261 6e67 6528 6e70 2e73 697a   in range(np.siz
-00020160: 6528 6d2c 2030 2929 3a0a 2020 2020 2020  e(m, 0)):.      
-00020170: 2020 2020 2020 7076 203d 206e 702e 6172        pv = np.ar
-00020180: 616e 6765 2830 2c20 6d5b 4a2c 2031 5d2c  ange(0, m[J, 1],
-00020190: 2064 7479 7065 3d6e 702e 696e 7436 3429   dtype=np.int64)
-000201a0: 0a20 2020 2020 2020 2020 2020 2069 6464  .            idd
-000201b0: 6f66 5b70 7620 2b20 6a2c 2030 5d20 3d20  of[pv + j, 0] = 
-000201c0: 6d5b 4a2c 2030 5d0a 2020 2020 2020 2020  m[J, 0].        
-000201d0: 2020 2020 6964 646f 665b 7076 202b 206a      iddof[pv + j
-000201e0: 2c20 315d 203d 2070 7620 2b20 310a 2020  , 1] = pv + 1.  
-000201f0: 2020 2020 2020 2020 2020 6a20 2b3d 206d            j += m
-00020200: 5b4a 2c20 315d 0a20 2020 2072 6574 7572  [J, 1].    retur
-00020210: 6e20 6964 646f 660a                      n iddof.
+00010f10: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00010f20: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+00010f30: 6174 6368 203d 206d 6174 6368 5b30 5d0a  atch = match[0].
+00010f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010f50: 732e 6170 7065 6e64 286d 6174 6368 290a  s.append(match).
+00010f60: 2020 2020 2020 2020 7265 7475 726e 2022          return "
+00010f70: 5c6e 222e 6a6f 696e 2873 2920 2b20 225c  \n".join(s) + "\
+00010f80: 6e22 0a0a 2020 2020 4067 7569 746f 6f6c  n"..    @guitool
+00010f90: 732e 7772 6974 655f 7465 7874 5f66 696c  s.write_text_fil
+00010fa0: 650a 2020 2020 6465 6620 5f77 7462 756c  e.    def _wtbul
+00010fb0: 6b28 662c 2062 6c6b 293a 0a20 2020 2020  k(f, blk):.     
+00010fc0: 2020 2066 2e77 7269 7465 2862 6c6b 290a     f.write(blk).
+00010fd0: 0a20 2020 205f 7774 6275 6c6b 2866 6f75  .    _wtbulk(fou
+00010fe0: 742c 205f 7264 6275 6c6b 2866 696e 2929  t, _rdbulk(fin))
+00010ff0: 0a0a 0a40 6775 6974 6f6f 6c73 2e72 6561  ...@guitools.rea
+00011000: 645f 7465 7874 5f66 696c 650a 6465 6620  d_text_file.def 
+00011010: 7264 6569 6765 6e28 662c 2075 7365 5f70  rdeigen(f, use_p
+00011020: 616e 6461 733d 5472 7565 293a 0a20 2020  andas=True):.   
+00011030: 2022 2222 0a20 2020 2052 6561 6420 6569   """.    Read ei
+00011040: 6765 6e76 616c 7565 2074 6162 6c65 7320  genvalue tables 
+00011050: 6672 6f6d 2061 204e 6173 7472 616e 2066  from a Nastran f
+00011060: 3036 2066 696c 652e 0a0a 2020 2020 5061  06 file...    Pa
+00011070: 7261 6d65 7465 7273 0a20 2020 202d 2d2d  rameters.    ---
+00011080: 2d2d 2d2d 2d2d 2d0a 2020 2020 6620 3a20  -------.    f : 
+00011090: 7374 7269 6e67 206f 7220 6669 6c65 5f6c  string or file_l
+000110a0: 696b 6520 6f72 204e 6f6e 650a 2020 2020  ike or None.    
+000110b0: 2020 2020 4569 7468 6572 2061 206e 616d      Either a nam
+000110c0: 6520 6f66 2061 2066 696c 652c 206f 7220  e of a file, or 
+000110d0: 6973 2061 2066 696c 655f 6c69 6b65 206f  is a file_like o
+000110e0: 626a 6563 7420 6173 2072 6574 7572 6e65  bject as returne
+000110f0: 640a 2020 2020 2020 2020 6279 203a 6675  d.        by :fu
+00011100: 6e63 3a60 6f70 656e 602e 2049 6620 6669  nc:`open`. If fi
+00011110: 6c65 5f6c 696b 6520 6f62 6a65 6374 2c20  le_like object, 
+00011120: 6974 2069 7320 7265 776f 756e 6420 6669  it is rewound fi
+00011130: 7273 742e 2043 616e 0a20 2020 2020 2020  rst. Can.       
+00011140: 2061 6c73 6f20 6265 2074 6865 206e 616d   also be the nam
+00011150: 6520 6f66 2061 2064 6972 6563 746f 7279  e of a directory
+00011160: 206f 7220 4e6f 6e65 3b20 696e 2074 6865   or None; in the
+00011170: 7365 2063 6173 6573 2c20 6120 4755 490a  se cases, a GUI.
+00011180: 2020 2020 2020 2020 6973 206f 7065 6e65          is opene
+00011190: 6420 666f 7220 6669 6c65 2073 656c 6563  d for file selec
+000111a0: 7469 6f6e 2e0a 2020 2020 7573 655f 7061  tion..    use_pa
+000111b0: 6e64 6173 203a 2062 6f6f 6c3b 206f 7074  ndas : bool; opt
+000111c0: 696f 6e61 6c0a 2020 2020 2020 2020 4966  ional.        If
+000111d0: 2054 7275 652c 2074 6865 2076 616c 7565   True, the value
+000111e0: 7320 7265 7475 726e 6564 2069 6e20 7468  s returned in th
+000111f0: 6520 6469 6374 696f 6e61 7279 2077 696c  e dictionary wil
+00011200: 6c20 6265 2070 616e 6461 730a 2020 2020  l be pandas.    
+00011210: 2020 2020 4461 7461 4672 616d 6573 0a0a      DataFrames..
+00011220: 2020 2020 5265 7475 726e 730a 2020 2020      Returns.    
+00011230: 2d2d 2d2d 2d2d 2d0a 2020 2020 6469 6374  -------.    dict
+00011240: 696f 6e61 7279 0a20 2020 2020 2020 2054  ionary.        T
+00011250: 6865 206b 6579 7320 6172 6520 7468 6520  he keys are the 
+00011260: 7375 7065 7265 6c65 6d65 6e74 2049 4473  superelement IDs
+00011270: 2061 6e64 2074 6865 2076 616c 7565 7320   and the values 
+00011280: 6973 2074 6865 2037 0a20 2020 2020 2020  is the 7.       
+00011290: 2063 6f6c 756d 6e20 6569 6765 6e76 616c   column eigenval
+000112a0: 7565 2074 6162 6c65 3a20 5b6d 6f64 6520  ue table: [mode 
+000112b0: 6e75 6d62 6572 2c20 6578 7472 6163 7469  number, extracti
+000112c0: 6f6e 206f 7264 6572 2c0a 2020 2020 2020  on order,.      
+000112d0: 2020 6569 6765 6e76 616c 7565 2c20 7261    eigenvalue, ra
+000112e0: 6469 616e 732c 2063 7963 6c65 732c 2067  dians, cycles, g
+000112f0: 656e 6572 616c 697a 6564 206d 6173 732c  eneralized mass,
+00011300: 2067 656e 6572 616c 697a 6564 0a20 2020   generalized.   
+00011310: 2020 2020 2073 7469 6666 6e65 7373 5d0a       stiffness].
+00011320: 0a20 2020 204e 6f74 6573 0a20 2020 202d  .    Notes.    -
+00011330: 2d2d 2d2d 0a20 2020 2054 6865 206c 6173  ----.    The las
+00011340: 7420 7461 626c 6520 7265 6164 2066 6f72  t table read for
+00011350: 2061 2073 7570 6572 656c 656d 656e 7420   a superelement 
+00011360: 7265 706c 6163 6573 2074 6162 6c65 7320  replaces tables 
+00011370: 7072 6576 696f 7573 6c79 0a20 2020 2072  previously.    r
+00011380: 6561 6420 696e 2e0a 0a20 2020 2049 6620  ead in...    If 
+00011390: 7468 6520 7061 6e64 6173 206f 7574 7075  the pandas outpu
+000113a0: 7420 6973 2063 686f 7365 6e20 2874 6865  t is chosen (the
+000113b0: 2064 6566 6175 6c74 2920 7468 6520 6d6f   default) the mo
+000113c0: 6465 206e 756d 6265 7220 6973 0a20 2020  de number is.   
+000113d0: 2075 7365 6420 6173 2074 6865 2060 696e   used as the `in
+000113e0: 6465 7860 2061 6e64 2060 636f 6c75 6d6e  dex` and `column
+000113f0: 7360 2069 733a 3a0a 0a20 2020 2020 2020  s` is::..       
+00011400: 2063 203d 205b 274d 6f64 6520 2327 2c20   c = ['Mode #', 
+00011410: 2765 7874 2023 272c 2027 6569 6765 6e76  'ext #', 'eigenv
+00011420: 616c 7565 272c 2027 7261 6469 616e 7327  alue', 'radians'
+00011430: 2c0a 2020 2020 2020 2020 2020 2020 2027  ,.             '
+00011440: 6379 636c 6573 272c 2027 6765 6e6d 6173  cycles', 'genmas
+00011450: 7327 2c20 2767 656e 7374 6966 275d 0a20  s', 'genstif']. 
+00011460: 2020 2022 2222 0a0a 2020 2020 6465 6620     """..    def 
+00011470: 5f66 696e 645f 6569 6765 6e28 6629 3a0a  _find_eigen(f):.
+00011480: 2020 2020 2020 2020 5345 203d 2022 5355          SE = "SU
+00011490: 5045 5245 4c45 4d45 4e54 2022 0a20 2020  PERELEMENT ".   
+000114a0: 2020 2020 2045 4947 203d 2022 5220 4520       EIG = "R E 
+000114b0: 4120 4c20 2020 4520 4920 4720 4520 4e20  A L   E I G E N 
+000114c0: 5620 4120 4c20 5520 4520 5322 0a20 2020  V A L U E S".   
+000114d0: 2020 2020 2073 6520 3d20 300a 2020 2020       se = 0.    
+000114e0: 2020 2020 666f 7220 6c69 6e65 2069 6e20      for line in 
+000114f0: 663a 0a20 2020 2020 2020 2020 2020 2069  f:.            i
+00011500: 6620 6c65 6e28 6c69 6e65 2920 3e20 3131  f len(line) > 11
+00011510: 3620 616e 6420 6c69 6e65 5b31 3034 3a5d  6 and line[104:]
+00011520: 2e73 7461 7274 7377 6974 6828 5345 293a  .startswith(SE):
+00011530: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00011540: 2073 6520 3d20 696e 7428 6c69 6e65 5b31   se = int(line[1
+00011550: 3136 3a5d 290a 2020 2020 2020 2020 2020  16:]).          
+00011560: 2020 6966 206c 656e 286c 696e 6529 203e    if len(line) >
+00011570: 2037 3620 616e 6420 6c69 6e65 5b34 363a   76 and line[46:
+00011580: 5d2e 7374 6172 7473 7769 7468 2845 4947  ].startswith(EIG
+00011590: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+000115a0: 2020 2072 6574 7572 6e20 7365 0a20 2020     return se.   
+000115b0: 2020 2020 2072 6574 7572 6e20 4e6f 6e65       return None
+000115c0: 0a0a 2020 2020 6465 6620 5f72 645f 6569  ..    def _rd_ei
+000115d0: 6765 6e5f 7461 626c 6528 6629 3a0a 2020  gen_table(f):.  
+000115e0: 2020 2020 2020 2222 2245 6967 656e 7661        """Eigenva
+000115f0: 6c75 6520 7461 626c 6520 666f 756e 642c  lue table found,
+00011600: 2072 6561 6420 6974 2e22 2222 0a20 2020   read it.""".   
+00011610: 2020 2020 2066 6f72 206c 696e 6520 696e       for line in
+00011620: 2066 3a0a 2020 2020 2020 2020 2020 2020   f:.            
+00011630: 6966 206c 696e 652e 7374 6172 7473 7769  if line.startswi
+00011640: 7468 2822 2020 2020 4e4f 2e22 293a 0a20  th("    NO."):. 
+00011650: 2020 2020 2020 2020 2020 2020 2020 2062                 b
+00011660: 7265 616b 0a20 2020 2020 2020 2074 6162  reak.        tab
+00011670: 6c65 203d 205b 5d0a 2020 2020 2020 2020  le = [].        
+00011680: 636f 6e74 696e 7565 6420 3d20 5472 7565  continued = True
+00011690: 0a20 2020 2020 2020 2077 6869 6c65 2063  .        while c
+000116a0: 6f6e 7469 6e75 6564 3a0a 2020 2020 2020  ontinued:.      
+000116b0: 2020 2020 2020 666f 7220 6c69 6e65 2069        for line i
+000116c0: 6e20 663a 0a20 2020 2020 2020 2020 2020  n f:.           
+000116d0: 2020 2020 2074 7279 3a0a 2020 2020 2020       try:.      
+000116e0: 2020 2020 2020 2020 2020 2020 2020 726f                ro
+000116f0: 7720 3d20 5b66 6c6f 6174 2869 2920 666f  w = [float(i) fo
+00011700: 7220 6920 696e 206c 696e 652e 7370 6c69  r i in line.spli
+00011710: 7428 295d 0a20 2020 2020 2020 2020 2020  t()].           
+00011720: 2020 2020 2065 7863 6570 7420 5661 6c75       except Valu
+00011730: 6545 7272 6f72 3a0a 2020 2020 2020 2020  eError:.        
+00011740: 2020 2020 2020 2020 2020 2020 6272 6561              brea
+00011750: 6b0a 2020 2020 2020 2020 2020 2020 2020  k.              
+00011760: 2020 6966 206c 656e 2872 6f77 2920 3d3d    if len(row) ==
+00011770: 2037 3a0a 2020 2020 2020 2020 2020 2020   7:.            
+00011780: 2020 2020 2020 2020 7461 626c 652e 6170          table.ap
+00011790: 7065 6e64 2872 6f77 290a 2020 2020 2020  pend(row).      
+000117a0: 2020 2020 2020 666f 7220 5f20 696e 2072        for _ in r
+000117b0: 616e 6765 2838 293a 0a20 2020 2020 2020  ange(8):.       
+000117c0: 2020 2020 2020 2020 206c 696e 6520 3d20           line = 
+000117d0: 662e 7265 6164 6c69 6e65 2829 0a20 2020  f.readline().   
+000117e0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+000117f0: 6c69 6e65 2e73 7461 7274 7377 6974 6828  line.startswith(
+00011800: 2231 2022 293a 0a20 2020 2020 2020 2020  "1 "):.         
+00011810: 2020 2020 2020 2020 2020 2063 6f6e 7469             conti
+00011820: 6e75 6564 203d 2046 616c 7365 0a20 2020  nued = False.   
+00011830: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011840: 2062 7265 616b 0a20 2020 2020 2020 2020   break.         
+00011850: 2020 2020 2020 2069 6620 6c69 6e65 2e73         if line.s
+00011860: 7461 7274 7377 6974 6828 2220 2020 204e  tartswith("    N
+00011870: 4f2e 2229 3a0a 2020 2020 2020 2020 2020  O."):.          
+00011880: 2020 2020 2020 2020 2020 6272 6561 6b0a            break.
+00011890: 2020 2020 2020 2020 2020 2020 656c 7365              else
+000118a0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000118b0: 2020 6272 6561 6b0a 2020 2020 2020 2020    break.        
+000118c0: 7265 7475 726e 206e 702e 6172 7261 7928  return np.array(
+000118d0: 7461 626c 6529 0a0a 2020 2020 6463 7420  table)..    dct 
+000118e0: 3d20 7b7d 0a20 2020 2066 2e73 6565 6b28  = {}.    f.seek(
+000118f0: 302c 2030 290a 2020 2020 7768 696c 6520  0, 0).    while 
+00011900: 5472 7565 3a0a 2020 2020 2020 2020 7365  True:.        se
+00011910: 203d 205f 6669 6e64 5f65 6967 656e 2866   = _find_eigen(f
+00011920: 290a 2020 2020 2020 2020 6966 2073 6520  ).        if se 
+00011930: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
+00011940: 2020 2020 2072 6574 7572 6e20 6463 740a       return dct.
+00011950: 2020 2020 2020 2020 7461 626c 6520 3d20          table = 
+00011960: 5f72 645f 6569 6765 6e5f 7461 626c 6528  _rd_eigen_table(
+00011970: 6629 0a20 2020 2020 2020 2069 6620 7573  f).        if us
+00011980: 655f 7061 6e64 6173 3a0a 2020 2020 2020  e_pandas:.      
+00011990: 2020 2020 2020 6920 3d20 7461 626c 655b        i = table[
+000119a0: 3a2c 2030 5d2e 6173 7479 7065 2869 6e74  :, 0].astype(int
+000119b0: 290a 2020 2020 2020 2020 2020 2020 6320  ).            c 
+000119c0: 3d20 5b0a 2020 2020 2020 2020 2020 2020  = [.            
+000119d0: 2020 2020 226d 6f64 6520 2322 2c0a 2020      "mode #",.  
+000119e0: 2020 2020 2020 2020 2020 2020 2020 2265                "e
+000119f0: 7874 2023 222c 0a20 2020 2020 2020 2020  xt #",.         
+00011a00: 2020 2020 2020 2022 6569 6765 6e76 616c         "eigenval
+00011a10: 7565 222c 0a20 2020 2020 2020 2020 2020  ue",.           
+00011a20: 2020 2020 2022 7261 6469 616e 7322 2c0a       "radians",.
+00011a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011a40: 2263 7963 6c65 7322 2c0a 2020 2020 2020  "cycles",.      
+00011a50: 2020 2020 2020 2020 2020 2267 656e 6d61            "genma
+00011a60: 7373 222c 0a20 2020 2020 2020 2020 2020  ss",.           
+00011a70: 2020 2020 2022 6765 6e73 7469 6622 2c0a       "genstif",.
+00011a80: 2020 2020 2020 2020 2020 2020 5d0a 2020              ].  
+00011a90: 2020 2020 2020 2020 2020 7461 626c 6520            table 
+00011aa0: 3d20 7064 2e44 6174 6146 7261 6d65 2874  = pd.DataFrame(t
+00011ab0: 6162 6c65 2c20 696e 6465 783d 692c 2063  able, index=i, c
+00011ac0: 6f6c 756d 6e73 3d63 290a 2020 2020 2020  olumns=c).      
+00011ad0: 2020 6463 745b 7365 5d20 3d20 7461 626c    dct[se] = tabl
+00011ae0: 650a 0a0a 4067 7569 746f 6f6c 732e 7772  e...@guitools.wr
+00011af0: 6974 655f 7465 7874 5f66 696c 650a 6465  ite_text_file.de
+00011b00: 6620 7774 6e61 7369 6e74 7328 662c 2073  f wtnasints(f, s
+00011b10: 7461 7274 2c20 696e 7473 293a 0a20 2020  tart, ints):.   
+00011b20: 2022 2222 0a20 2020 2055 7469 6c69 7479   """.    Utility
+00011b30: 2072 6f75 7469 6e65 2066 6f72 2074 6865   routine for the
+00011b40: 206e 6173 7472 616e 2027 7774 2a27 2072   nastran 'wt*' r
+00011b50: 6f75 7469 6e65 732e 0a0a 2020 2020 5061  outines...    Pa
+00011b60: 7261 6d65 7465 7273 0a20 2020 202d 2d2d  rameters.    ---
+00011b70: 2d2d 2d2d 2d2d 2d0a 2020 2020 6620 3a20  -------.    f : 
+00011b80: 7374 7269 6e67 206f 7220 6669 6c65 5f6c  string or file_l
+00011b90: 696b 6520 6f72 2031 206f 7220 4e6f 6e65  ike or 1 or None
+00011ba0: 0a20 2020 2020 2020 2045 6974 6865 7220  .        Either 
+00011bb0: 6120 6e61 6d65 206f 6620 6120 6669 6c65  a name of a file
+00011bc0: 2c20 6f72 2069 7320 6120 6669 6c65 5f6c  , or is a file_l
+00011bd0: 696b 6520 6f62 6a65 6374 2061 7320 7265  ike object as re
+00011be0: 7475 726e 6564 0a20 2020 2020 2020 2062  turned.        b
+00011bf0: 7920 3a66 756e 633a 606f 7065 6e60 206f  y :func:`open` o
+00011c00: 7220 3a63 6c61 7373 3a60 696f 2e53 7472  r :class:`io.Str
+00011c10: 696e 6749 4f60 2e20 496e 7075 7420 6173  ingIO`. Input as
+00011c20: 2069 6e74 6567 6572 2031 2074 6f0a 2020   integer 1 to.  
+00011c30: 2020 2020 2020 7772 6974 6520 746f 2073        write to s
+00011c40: 7464 6f75 742e 2043 616e 2061 6c73 6f20  tdout. Can also 
+00011c50: 6265 2074 6865 206e 616d 6520 6f66 2061  be the name of a
+00011c60: 2064 6972 6563 746f 7279 206f 7220 4e6f   directory or No
+00011c70: 6e65 3b0a 2020 2020 2020 2020 696e 2074  ne;.        in t
+00011c80: 6865 7365 2063 6173 6573 2c20 6120 4755  hese cases, a GU
+00011c90: 4920 6973 206f 7065 6e65 6420 666f 7220  I is opened for 
+00011ca0: 6669 6c65 2073 656c 6563 7469 6f6e 2e0a  file selection..
+00011cb0: 2020 2020 7374 6172 7420 3a20 696e 7465      start : inte
+00011cc0: 6765 720a 2020 2020 2020 2020 4265 6769  ger.        Begi
+00011cd0: 6e6e 696e 6720 6669 656c 6420 666f 7220  nning field for 
+00011ce0: 7468 6520 696e 7465 6765 7273 3b20 6361  the integers; ca
+00011cf0: 7264 206e 616d 6520 6973 2069 6e20 6669  rd name is in fi
+00011d00: 656c 6420 312c 2073 6f0a 2020 2020 2020  eld 1, so.      
+00011d10: 2020 7374 6172 7420 7368 6f75 6c64 2062    start should b
+00011d20: 6520 3e3d 2032 2e0a 2020 2020 696e 7473  e >= 2..    ints
+00011d30: 203a 2031 6420 6172 7261 795f 6c69 6b65   : 1d array_like
+00011d40: 0a20 2020 2020 2020 2056 6563 746f 7220  .        Vector 
+00011d50: 6f66 2069 6e74 6567 6572 7320 746f 2077  of integers to w
+00011d60: 7269 7465 0a0a 2020 2020 5265 7475 726e  rite..    Return
+00011d70: 730a 2020 2020 2d2d 2d2d 2d2d 2d0a 2020  s.    -------.  
+00011d80: 2020 4e6f 6e65 0a0a 2020 2020 4e6f 7465    None..    Note
+00011d90: 730a 2020 2020 2d2d 2d2d 2d0a 0a20 2020  s.    -----..   
+00011da0: 2054 6869 7320 726f 7574 696e 6520 6973   This routine is
+00011db0: 2074 7970 6963 616c 6c79 206e 6f74 2063   typically not c
+00011dc0: 616c 6c65 6420 6469 7265 6374 6c79 2c20  alled directly, 
+00011dd0: 6275 7420 636f 756c 6420 6265 2075 7365  but could be use
+00011de0: 6675 6c0a 2020 2020 746f 2077 7269 7465  ful.    to write
+00011df0: 2063 6172 6473 2074 6861 7420 6172 6520   cards that are 
+00011e00: 6e6f 7420 616c 7265 6164 7920 6163 636f  not already acco
+00011e10: 756e 7465 6420 666f 7220 696e 2074 6869  unted for in thi
+00011e20: 730a 2020 2020 6d6f 6475 6c65 2e20 4173  s.    module. As
+00011e30: 2061 6e20 6578 616d 706c 6520 7573 6167   an example usag
+00011e40: 652c 2068 6572 6520 6973 2074 6865 2063  e, here is the c
+00011e50: 6f64 6520 696e 7369 6465 0a20 2020 203a  ode inside.    :
+00011e60: 6675 6e63 3a60 7774 6373 7570 6572 603a  func:`wtcsuper`:
+00011e70: 3a0a 0a20 2020 2020 2020 2066 2e77 7269  :..        f.wri
+00011e80: 7465 2866 2243 5355 5045 5220 207b 7375  te(f"CSUPER  {su
+00011e90: 7065 7269 643a 3864 7d7b 303a 3864 7d22  perid:8d}{0:8d}"
+00011ea0: 290a 2020 2020 2020 2020 7774 6e61 7369  ).        wtnasi
+00011eb0: 6e74 7328 662c 2034 2c20 6772 6964 7329  nts(f, 4, grids)
+00011ec0: 0a0a 2020 2020 4578 616d 706c 6573 0a20  ..    Examples. 
+00011ed0: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
+00011ee0: 3e3e 3e20 696d 706f 7274 206e 756d 7079  >>> import numpy
+00011ef0: 2061 7320 6e70 0a20 2020 203e 3e3e 2066   as np.    >>> f
+00011f00: 726f 6d20 7079 7965 7469 2069 6d70 6f72  rom pyyeti impor
+00011f10: 7420 6e61 7374 7261 6e0a 2020 2020 3e3e  t nastran.    >>
+00011f20: 3e20 6e61 7374 7261 6e2e 7774 6e61 7369  > nastran.wtnasi
+00011f30: 6e74 7328 312c 2032 2c20 6e70 2e61 7261  nts(1, 2, np.ara
+00011f40: 6e67 6528 3238 2929 0a20 2020 2020 2020  nge(28)).       
+00011f50: 2020 2020 3020 2020 2020 2020 3120 2020      0       1   
+00011f60: 2020 2020 3220 2020 2020 2020 3320 2020      2       3   
+00011f70: 2020 2020 3420 2020 2020 2020 3520 2020      4       5   
+00011f80: 2020 2020 3620 2020 2020 2020 370a 2020      6       7.  
+00011f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011fa0: 2038 2020 2020 2020 2039 2020 2020 2020   8       9      
+00011fb0: 3130 2020 2020 2020 3131 2020 2020 2020  10      11      
+00011fc0: 3132 2020 2020 2020 3133 2020 2020 2020  12      13      
+00011fd0: 3134 2020 2020 2020 3135 0a20 2020 2020  14      15.     
+00011fe0: 2020 2020 2020 2020 2020 2020 2031 3620               16 
+00011ff0: 2020 2020 2031 3720 2020 2020 2031 3820       17      18 
+00012000: 2020 2020 2031 3920 2020 2020 2032 3020       19      20 
+00012010: 2020 2020 2032 3120 2020 2020 2032 3220       21      22 
+00012020: 2020 2020 2032 330a 2020 2020 2020 2020       23.        
+00012030: 2020 2020 2020 2020 2020 3234 2020 2020            24    
+00012040: 2020 3235 2020 2020 2020 3236 2020 2020    25      26    
+00012050: 2020 3237 0a20 2020 2022 2222 0a20 2020    27.    """.   
+00012060: 206e 203d 206c 656e 2869 6e74 7329 0a20   n = len(ints). 
+00012070: 2020 2066 6972 7374 6c69 6e65 203d 2031     firstline = 1
+00012080: 3020 2d20 7374 6172 740a 2020 2020 6966  0 - start.    if
+00012090: 206e 203e 3d20 6669 7273 746c 696e 653a   n >= firstline:
+000120a0: 0a20 2020 2020 2020 2069 203d 2066 6972  .        i = fir
+000120b0: 7374 6c69 6e65 0a20 2020 2020 2020 2066  stline.        f
+000120c0: 2e77 7269 7465 2828 227b 3a38 647d 2220  .write(("{:8d}" 
+000120d0: 2a20 6920 2b20 225c 6e22 292e 666f 726d  * i + "\n").form
+000120e0: 6174 282a 696e 7473 5b3a 695d 2929 0a20  at(*ints[:i])). 
+000120f0: 2020 2020 2020 2077 6869 6c65 206e 203e         while n >
+00012100: 3d20 6920 2b20 383a 0a20 2020 2020 2020  = i + 8:.       
+00012110: 2020 2020 2066 2e77 7269 7465 2828 227b       f.write(("{
+00012120: 3a38 737d 2220 2b20 227b 3a38 647d 2220  :8s}" + "{:8d}" 
+00012130: 2a20 3820 2b20 225c 6e22 292e 666f 726d  * 8 + "\n").form
+00012140: 6174 2822 222c 202a 696e 7473 5b69 203a  at("", *ints[i :
+00012150: 2069 202b 2038 5d29 290a 2020 2020 2020   i + 8])).      
+00012160: 2020 2020 2020 6920 2b3d 2038 0a20 2020        i += 8.   
+00012170: 2020 2020 2069 6620 6e20 3e20 693a 0a20       if n > i:. 
+00012180: 2020 2020 2020 2020 2020 206e 202d 3d20             n -= 
+00012190: 690a 2020 2020 2020 2020 2020 2020 662e  i.            f.
+000121a0: 7772 6974 6528 2822 7b3a 3873 7d22 202b  write(("{:8s}" +
+000121b0: 2022 7b3a 3864 7d22 202a 206e 202b 2022   "{:8d}" * n + "
+000121c0: 5c6e 2229 2e66 6f72 6d61 7428 2222 2c20  \n").format("", 
+000121d0: 2a69 6e74 735b 693a 5d29 290a 2020 2020  *ints[i:])).    
+000121e0: 656c 7365 3a0a 2020 2020 2020 2020 662e  else:.        f.
+000121f0: 7772 6974 6528 2822 7b3a 3864 7d22 202a  write(("{:8d}" *
+00012200: 206e 202b 2022 5c6e 2229 2e66 6f72 6d61   n + "\n").forma
+00012210: 7428 2a69 6e74 7329 290a 0a0a 6465 6620  t(*ints))...def 
+00012220: 7264 6373 7570 6572 7328 6629 3a0a 2020  rdcsupers(f):.  
+00012230: 2020 7222 2222 0a20 2020 2052 6561 6420    r""".    Read 
+00012240: 4353 5550 4552 2065 6e74 7269 6573 0a0a  CSUPER entries..
+00012250: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
+00012260: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
+00012270: 2020 6620 3a20 7374 7269 6e67 206f 7220    f : string or 
+00012280: 6669 6c65 5f6c 696b 6520 6f72 204e 6f6e  file_like or Non
+00012290: 650a 2020 2020 2020 2020 4569 7468 6572  e.        Either
+000122a0: 2061 2066 696c 656e 616d 652c 206f 7220   a filename, or 
+000122b0: 6973 2061 2066 696c 655f 6c69 6b65 206f  is a file_like o
+000122c0: 626a 6563 7420 6173 2072 6574 7572 6e65  bject as returne
+000122d0: 640a 2020 2020 2020 2020 6279 203a 6675  d.        by :fu
+000122e0: 6e63 3a60 6f70 656e 602e 2049 6620 6669  nc:`open`. If fi
+000122f0: 6c65 5f6c 696b 6520 6f62 6a65 6374 2c20  le_like object, 
+00012300: 6974 2069 7320 7265 776f 756e 6420 6669  it is rewound fi
+00012310: 7273 742e 2043 616e 0a20 2020 2020 2020  rst. Can.       
+00012320: 2061 6c73 6f20 6265 2074 6865 206e 616d   also be the nam
+00012330: 6520 6f66 2061 2064 6972 6563 746f 7279  e of a directory
+00012340: 206f 7220 4e6f 6e65 3b20 696e 2074 6865   or None; in the
+00012350: 7365 2063 6173 6573 2c20 6120 4755 490a  se cases, a GUI.
+00012360: 2020 2020 2020 2020 6973 206f 7065 6e65          is opene
+00012370: 6420 666f 7220 6669 6c65 2073 656c 6563  d for file selec
+00012380: 7469 6f6e 2e0a 0a20 2020 2052 6574 7572  tion...    Retur
+00012390: 6e73 0a20 2020 202d 2d2d 2d2d 2d2d 0a20  ns.    -------. 
+000123a0: 2020 2064 6963 7469 6f6e 6172 790a 2020     dictionary.  
+000123b0: 2020 2020 2020 5468 6520 6469 6374 696f        The dictio
+000123c0: 6e61 7279 206b 6579 7320 6172 6520 7468  nary keys are th
+000123d0: 6520 4353 5550 4552 2049 4473 2e20 5468  e CSUPER IDs. Th
+000123e0: 6520 6469 6374 696f 6e61 7279 2076 616c  e dictionary val
+000123f0: 7565 730a 2020 2020 2020 2020 6172 6520  ues.        are 
+00012400: 616c 6c20 7468 6520 6964 7320 6672 6f6d  all the ids from
+00012410: 2074 6865 2043 5355 5045 5220 6361 7264   the CSUPER card
+00012420: 2069 6e20 7468 6520 666f 726d 3a20 5b63   in the form: [c
+00012430: 7375 7065 725f 6964 2c20 302c 0a20 2020  super_id, 0,.   
+00012440: 2020 2020 206e 6f64 655f 6964 5f31 2c20       node_id_1, 
+00012450: 6e6f 6465 5f69 645f 322c 20e2 80a6 206e  node_id_2, ... n
+00012460: 6f64 655f 6964 5f6e 5d0a 0a20 2020 204e  ode_id_n]..    N
+00012470: 6f74 6573 0a20 2020 202d 2d2d 2d2d 0a20  otes.    -----. 
+00012480: 2020 2041 6e79 2022 5448 5255 2220 6669     Any "THRU" fi
+00012490: 656c 6473 2077 696c 6c20 6265 2073 6574  elds will be set
+000124a0: 2074 6f20 2d31 2e20 5468 6973 2072 6f75   to -1. This rou
+000124b0: 7469 6e65 2073 696d 706c 7920 6361 6c6c  tine simply call
+000124c0: 7320 7468 650a 2020 2020 6d6f 7265 2067  s the.    more g
+000124d0: 656e 6572 616c 2072 6f75 7469 6e65 203a  eneral routine :
+000124e0: 6675 6e63 3a60 7264 6361 7264 7360 3a3a  func:`rdcards`::
+000124f0: 0a0a 2020 2020 2020 2020 7264 6361 7264  ..        rdcard
+00012500: 7328 662c 2027 6373 7570 6572 272c 2072  s(f, 'csuper', r
+00012510: 6574 7572 6e5f 7661 723d 2764 6963 7427  eturn_var='dict'
+00012520: 2c20 6474 7970 653d 6e70 2e69 6e74 3634  , dtype=np.int64
+00012530: 2c20 626c 616e 6b3d 2d31 290a 0a20 2020  , blank=-1)..   
+00012540: 2045 7861 6d70 6c65 730a 2020 2020 2d2d   Examples.    --
+00012550: 2d2d 2d2d 2d2d 0a20 2020 203e 3e3e 2069  ------.    >>> i
+00012560: 6d70 6f72 7420 6e75 6d70 7920 6173 206e  mport numpy as n
+00012570: 700a 2020 2020 3e3e 3e20 6672 6f6d 2070  p.    >>> from p
+00012580: 7979 6574 6920 696d 706f 7274 206e 6173  yyeti import nas
+00012590: 7472 616e 0a20 2020 203e 3e3e 2066 726f  tran.    >>> fro
+000125a0: 6d20 696f 2069 6d70 6f72 7420 5374 7269  m io import Stri
+000125b0: 6e67 494f 0a20 2020 203e 3e3e 206e 702e  ngIO.    >>> np.
+000125c0: 7365 745f 7072 696e 746f 7074 696f 6e73  set_printoptions
+000125d0: 286c 696e 6577 6964 7468 3d36 3029 0a20  (linewidth=60). 
+000125e0: 2020 203e 3e3e 2066 203d 2053 7472 696e     >>> f = Strin
+000125f0: 6749 4f28 2243 5355 5045 522c 3130 312c  gIO("CSUPER,101,
+00012600: 302c 332c 3131 2c31 392c 3237 2c31 3939  0,3,11,19,27,199
+00012610: 3530 3031 2c31 3939 3530 3032 5c6e 220a  5001,1995002\n".
+00012620: 2020 2020 2e2e 2e20 2020 2020 2020 2020      ...         
+00012630: 2020 2020 2022 2c31 3939 3530 3033 2c74       ",1995003,t
+00012640: 6872 752c 3139 3935 3031 3020 2024 2063  hru,1995010  $ c
+00012650: 6f6d 6d65 6e74 2229 0a20 2020 203e 3e3e  omment").    >>>
+00012660: 206e 6173 7472 616e 2e72 6463 7375 7065   nastran.rdcsupe
+00012670: 7273 2866 2920 2020 2020 2020 2020 2020  rs(f)           
+00012680: 2020 2320 646f 6374 6573 743a 202b 454c    # doctest: +EL
+00012690: 4c49 5053 4953 0a20 2020 207b 3130 313a  LIPSIS.    {101:
+000126a0: 2061 7272 6179 285b 2020 2020 3130 312c   array([    101,
+000126b0: 2020 2020 2020 2030 2c20 2020 2020 2020         0,       
+000126c0: 332c 2020 2020 2020 3131 2c20 2020 2020  3,      11,     
+000126d0: 2031 392c 2020 2020 2020 3237 2c0a 2020   19,      27,.  
+000126e0: 2020 2020 2020 2020 2031 3939 3530 3031           1995001
+000126f0: 2c20 3139 3935 3030 322c 2031 3939 3530  , 1995002, 19950
+00012700: 3033 2c20 2020 2020 202d 312c 2031 3939  03,      -1, 199
+00012710: 3530 3130 5d2e 2e2e 297d 0a20 2020 2022  5010]...)}.    "
+00012720: 2222 0a20 2020 2072 6574 7572 6e20 7264  "".    return rd
+00012730: 6361 7264 7328 662c 2022 6373 7570 6572  cards(f, "csuper
+00012740: 222c 2072 6574 7572 6e5f 7661 723d 2264  ", return_var="d
+00012750: 6963 7422 2c20 6474 7970 653d 6e70 2e69  ict", dtype=np.i
+00012760: 6e74 3634 2c20 626c 616e 6b3d 2d31 290a  nt64, blank=-1).
+00012770: 0a0a 6465 6620 7264 6578 7472 6e28 662c  ..def rdextrn(f,
+00012780: 2065 7870 616e 643d 5472 7565 293a 0a20   expand=True):. 
+00012790: 2020 2072 2222 220a 2020 2020 5265 6164     r""".    Read
+000127a0: 2045 5854 524e 2065 6e74 7279 2066 726f   EXTRN entry fro
+000127b0: 6d20 2e70 6368 2066 696c 6520 6372 6561  m .pch file crea
+000127c0: 7465 6420 6279 204e 6173 7472 616e 0a0a  ted by Nastran..
+000127d0: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
+000127e0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
+000127f0: 2020 6620 3a20 7374 7269 6e67 206f 7220    f : string or 
+00012800: 6669 6c65 5f6c 696b 6520 6f72 204e 6f6e  file_like or Non
+00012810: 650a 2020 2020 2020 2020 4569 7468 6572  e.        Either
+00012820: 2061 206e 616d 6520 6f66 2061 2066 696c   a name of a fil
+00012830: 652c 206f 7220 6973 2061 2066 696c 655f  e, or is a file_
+00012840: 6c69 6b65 206f 626a 6563 7420 6173 2072  like object as r
+00012850: 6574 7572 6e65 640a 2020 2020 2020 2020  eturned.        
+00012860: 6279 203a 6675 6e63 3a60 6f70 656e 602e  by :func:`open`.
+00012870: 2049 6620 6669 6c65 5f6c 696b 6520 6f62   If file_like ob
+00012880: 6a65 6374 2c20 6974 2069 7320 7265 776f  ject, it is rewo
+00012890: 756e 6420 6669 7273 742e 2043 616e 0a20  und first. Can. 
+000128a0: 2020 2020 2020 2061 6c73 6f20 6265 2074         also be t
+000128b0: 6865 206e 616d 6520 6f66 2061 2064 6972  he name of a dir
+000128c0: 6563 746f 7279 206f 7220 4e6f 6e65 3b20  ectory or None; 
+000128d0: 696e 2074 6865 7365 2063 6173 6573 2c20  in these cases, 
+000128e0: 6120 4755 490a 2020 2020 2020 2020 6973  a GUI.        is
+000128f0: 206f 7065 6e65 6420 666f 7220 6669 6c65   opened for file
+00012900: 2073 656c 6563 7469 6f6e 2e0a 2020 2020   selection..    
+00012910: 6578 7061 6e64 203a 2062 6f6f 6c3b 206f  expand : bool; o
+00012920: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
+00012930: 4966 2054 7275 652c 2065 7870 616e 6420  If True, expand 
+00012940: 726f 7773 206c 696b 6520 7468 6973 3a3a  rows like this::
+00012950: 0a0a 2020 2020 2020 2020 2020 2020 5b31  ..            [1
+00012960: 3030 2c20 3132 3334 3536 5d0a 0a20 2020  00, 123456]..   
+00012970: 2020 2020 2069 6e74 6f20 3620 7365 7061       into 6 sepa
+00012980: 7261 7465 2072 6f77 7320 6c69 6b65 2074  rate rows like t
+00012990: 6869 733a 3a0a 0a20 2020 2020 2020 2020  his::..         
+000129a0: 2020 205b 3130 302c 2031 5d2c 0a20 2020     [100, 1],.   
+000129b0: 2020 2020 2020 2020 205b 3130 302c 2032           [100, 2
+000129c0: 5d2c 0a20 2020 2020 2020 2020 2020 205b  ],.            [
+000129d0: 3130 302c 2033 5d2c 0a20 2020 2020 2020  100, 3],.       
+000129e0: 2020 2020 205b 3130 302c 2034 5d2c 0a20       [100, 4],. 
+000129f0: 2020 2020 2020 2020 2020 205b 3130 302c             [100,
+00012a00: 2035 5d2c 0a20 2020 2020 2020 2020 2020   5],.           
+00012a10: 205b 3130 302c 2036 5d2c 0a0a 2020 2020   [100, 6],..    
+00012a20: 5265 7475 726e 730a 2020 2020 2d2d 2d2d  Returns.    ----
+00012a30: 2d2d 2d0a 2020 2020 3264 206e 6461 7272  ---.    2d ndarr
+00012a40: 6179 0a20 2020 2020 2020 2054 776f 2063  ay.        Two c
+00012a50: 6f6c 756d 6e20 6172 7261 793a 205b 4944  olumn array: [ID
+00012a60: 2c20 444f 465d 0a0a 2020 2020 4e6f 7465  , DOF]..    Note
+00012a70: 730a 2020 2020 2d2d 2d2d 2d0a 2020 2020  s.    -----.    
+00012a80: 5468 6520 6578 7061 6e73 696f 6e20 6973  The expansion is
+00012a90: 2064 6f6e 6520 6279 203a 6675 6e63 3a60   done by :func:`
+00012aa0: 7079 7965 7469 2e6e 6173 7472 616e 2e6e  pyyeti.nastran.n
+00012ab0: 3270 2e65 7870 616e 6464 6f66 602e 0a0a  2p.expanddof`...
+00012ac0: 2020 2020 4578 616d 706c 6573 0a20 2020      Examples.   
+00012ad0: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 3e3e   --------.    >>
+00012ae0: 3e20 6672 6f6d 2070 7979 6574 6920 696d  > from pyyeti im
+00012af0: 706f 7274 206e 6173 7472 616e 0a20 2020  port nastran.   
+00012b00: 203e 3e3e 2066 726f 6d20 696f 2069 6d70   >>> from io imp
+00012b10: 6f72 7420 5374 7269 6e67 494f 0a20 2020  ort StringIO.   
+00012b20: 203e 3e3e 2066 203d 2053 7472 696e 6749   >>> f = StringI
+00012b30: 4f28 2745 5854 524e 2c33 2c31 3233 3435  O('EXTRN,3,12345
+00012b40: 362c 3131 2c31 3233 3435 362c 3139 2c31  6,11,123456,19,1
+00012b50: 3233 3435 362c 3237 2c31 3233 3435 365c  23456,27,123456\
+00012b60: 6e27 0a20 2020 202e 2e2e 2020 2020 2020  n'.    ...      
+00012b70: 2020 2020 2020 2020 272c 3239 3935 3030          ',299500
+00012b80: 312c 302c 3239 3935 3030 322c 302c 3239  1,0,2995002,0,29
+00012b90: 3935 3030 332c 302c 3239 3935 3030 342c  95003,0,2995004,
+00012ba0: 305c 6e27 0a20 2020 202e 2e2e 2020 2020  0\n'.    ...    
+00012bb0: 2020 2020 2020 2020 2020 272c 3239 3935            ',2995
+00012bc0: 3030 352c 302c 3239 3935 3030 362c 302c  005,0,2995006,0,
+00012bd0: 3239 3935 3030 372c 302c 3239 3935 3030  2995007,0,299500
+00012be0: 382c 305c 6e27 290a 2020 2020 3e3e 3e20  8,0\n').    >>> 
+00012bf0: 6e61 7374 7261 6e2e 7264 6578 7472 6e28  nastran.rdextrn(
+00012c00: 662c 2065 7870 616e 643d 4661 6c73 6529  f, expand=False)
+00012c10: 2020 2023 2064 6f63 7465 7374 3a20 2b45     # doctest: +E
+00012c20: 4c4c 4950 5349 530a 2020 2020 6172 7261  LLIPSIS.    arra
+00012c30: 7928 5b5b 2020 2020 2020 332c 2020 3132  y([[      3,  12
+00012c40: 3334 3536 5d2c 0a20 2020 2020 2020 2020  3456],.         
+00012c50: 2020 5b20 2020 2020 3131 2c20 2031 3233    [     11,  123
+00012c60: 3435 365d 2c0a 2020 2020 2020 2020 2020  456],.          
+00012c70: 205b 2020 2020 2031 392c 2020 3132 3334   [     19,  1234
+00012c80: 3536 5d2c 0a20 2020 2020 2020 2020 2020  56],.           
+00012c90: 5b20 2020 2020 3237 2c20 2031 3233 3435  [     27,  12345
+00012ca0: 365d 2c0a 2020 2020 2020 2020 2020 205b  6],.           [
+00012cb0: 3239 3935 3030 312c 2020 2020 2020 2030  2995001,       0
+00012cc0: 5d2c 0a20 2020 2020 2020 2020 2020 5b32  ],.           [2
+00012cd0: 3939 3530 3032 2c20 2020 2020 2020 305d  995002,       0]
+00012ce0: 2c0a 2020 2020 2020 2020 2020 205b 3239  ,.           [29
+00012cf0: 3935 3030 332c 2020 2020 2020 2030 5d2c  95003,       0],
+00012d00: 0a20 2020 2020 2020 2020 2020 5b32 3939  .           [299
+00012d10: 3530 3034 2c20 2020 2020 2020 305d 2c0a  5004,       0],.
+00012d20: 2020 2020 2020 2020 2020 205b 3239 3935             [2995
+00012d30: 3030 352c 2020 2020 2020 2030 5d2c 0a20  005,       0],. 
+00012d40: 2020 2020 2020 2020 2020 5b32 3939 3530            [29950
+00012d50: 3036 2c20 2020 2020 2020 305d 2c0a 2020  06,       0],.  
+00012d60: 2020 2020 2020 2020 205b 3239 3935 3030           [299500
+00012d70: 372c 2020 2020 2020 2030 5d2c 0a20 2020  7,       0],.   
+00012d80: 2020 2020 2020 2020 5b32 3939 3530 3038          [2995008
+00012d90: 2c20 2020 2020 2020 305d 5d2e 2e2e 290a  ,       0]]...).
+00012da0: 2020 2020 3e3e 3e20 6620 3d20 5374 7269      >>> f = Stri
+00012db0: 6e67 494f 2827 4558 5452 4e2c 332c 3132  ngIO('EXTRN,3,12
+00012dc0: 3334 3536 2c32 3939 3530 3031 2c30 2729  3456,2995001,0')
+00012dd0: 0a20 2020 203e 3e3e 206e 6173 7472 616e  .    >>> nastran
+00012de0: 2e72 6465 7874 726e 2866 2920 2020 2020  .rdextrn(f)     
+00012df0: 2020 2020 2020 2020 2320 646f 6374 6573          # doctes
+00012e00: 743a 202b 454c 4c49 5053 4953 0a20 2020  t: +ELLIPSIS.   
+00012e10: 2061 7272 6179 285b 5b20 2020 2020 2033   array([[      3
+00012e20: 2c20 2020 2020 2020 315d 2c0a 2020 2020  ,       1],.    
+00012e30: 2020 2020 2020 205b 2020 2020 2020 332c         [      3,
+00012e40: 2020 2020 2020 2032 5d2c 0a20 2020 2020         2],.     
+00012e50: 2020 2020 2020 5b20 2020 2020 2033 2c20        [      3, 
+00012e60: 2020 2020 2020 335d 2c0a 2020 2020 2020        3],.      
+00012e70: 2020 2020 205b 2020 2020 2020 332c 2020       [      3,  
+00012e80: 2020 2020 2034 5d2c 0a20 2020 2020 2020       4],.       
+00012e90: 2020 2020 5b20 2020 2020 2033 2c20 2020      [      3,   
+00012ea0: 2020 2020 355d 2c0a 2020 2020 2020 2020      5],.        
+00012eb0: 2020 205b 2020 2020 2020 332c 2020 2020     [      3,    
+00012ec0: 2020 2036 5d2c 0a20 2020 2020 2020 2020     6],.         
+00012ed0: 2020 5b32 3939 3530 3031 2c20 2020 2020    [2995001,     
+00012ee0: 2020 305d 5d2e 2e2e 290a 2020 2020 2222    0]]...).    ""
+00012ef0: 220a 2020 2020 6578 7472 6e20 3d20 7264  ".    extrn = rd
+00012f00: 6361 7264 7328 662c 2022 6578 7472 6e22  cards(f, "extrn"
+00012f10: 2c20 6474 7970 653d 6e70 2e69 6e74 3634  , dtype=np.int64
+00012f20: 292e 7265 7368 6170 6528 2d31 2c20 3229  ).reshape(-1, 2)
+00012f30: 0a20 2020 2069 6620 6578 7061 6e64 3a0a  .    if expand:.
+00012f40: 2020 2020 2020 2020 6578 7472 6e20 3d20          extrn = 
+00012f50: 6e32 702e 6578 7061 6e64 646f 6628 6578  n2p.expanddof(ex
+00012f60: 7472 6e29 0a20 2020 2072 6574 7572 6e20  trn).    return 
+00012f70: 6578 7472 6e0a 0a0a 4067 7569 746f 6f6c  extrn...@guitool
+00012f80: 732e 7772 6974 655f 7465 7874 5f66 696c  s.write_text_fil
+00012f90: 650a 6465 6620 7774 6373 7570 6572 2866  e.def wtcsuper(f
+00012fa0: 2c20 7375 7065 7269 642c 2067 7269 6473  , superid, grids
+00012fb0: 293a 0a20 2020 2022 2222 0a20 2020 2057  ):.    """.    W
+00012fc0: 7269 7465 7320 6120 4e61 7374 7261 6e20  rites a Nastran 
+00012fd0: 4353 5550 4552 2063 6172 6420 746f 2061  CSUPER card to a
+00012fe0: 2066 696c 652e 0a0a 2020 2020 5061 7261   file...    Para
+00012ff0: 6d65 7465 7273 0a20 2020 202d 2d2d 2d2d  meters.    -----
+00013000: 2d2d 2d2d 2d0a 2020 2020 6620 3a20 7374  -----.    f : st
+00013010: 7269 6e67 206f 7220 6669 6c65 5f6c 696b  ring or file_lik
+00013020: 6520 6f72 2031 206f 7220 4e6f 6e65 0a20  e or 1 or None. 
+00013030: 2020 2020 2020 2045 6974 6865 7220 6120         Either a 
+00013040: 6e61 6d65 206f 6620 6120 6669 6c65 2c20  name of a file, 
+00013050: 6f72 2069 7320 6120 6669 6c65 5f6c 696b  or is a file_lik
+00013060: 6520 6f62 6a65 6374 2061 7320 7265 7475  e object as retu
+00013070: 726e 6564 0a20 2020 2020 2020 2062 7920  rned.        by 
+00013080: 3a66 756e 633a 606f 7065 6e60 206f 7220  :func:`open` or 
+00013090: 3a63 6c61 7373 3a60 696f 2e53 7472 696e  :class:`io.Strin
+000130a0: 6749 4f60 2e20 496e 7075 7420 6173 2069  gIO`. Input as i
+000130b0: 6e74 6567 6572 2031 2074 6f0a 2020 2020  nteger 1 to.    
+000130c0: 2020 2020 7772 6974 6520 746f 2073 7464      write to std
+000130d0: 6f75 742e 2043 616e 2061 6c73 6f20 6265  out. Can also be
+000130e0: 2074 6865 206e 616d 6520 6f66 2061 2064   the name of a d
+000130f0: 6972 6563 746f 7279 206f 7220 4e6f 6e65  irectory or None
+00013100: 3b0a 2020 2020 2020 2020 696e 2074 6865  ;.        in the
+00013110: 7365 2063 6173 6573 2c20 6120 4755 4920  se cases, a GUI 
+00013120: 6973 206f 7065 6e65 6420 666f 7220 6669  is opened for fi
+00013130: 6c65 2073 656c 6563 7469 6f6e 2e0a 2020  le selection..  
+00013140: 2020 7375 7065 7269 6420 3a20 696e 7465    superid : inte
+00013150: 6765 720a 2020 2020 2020 2020 5375 7065  ger.        Supe
+00013160: 7265 6c65 6d65 6e74 2049 440a 2020 2020  relement ID.    
+00013170: 6772 6964 7320 3a20 3164 2061 7272 6179  grids : 1d array
+00013180: 5f6c 696b 650a 2020 2020 2020 2020 5665  _like.        Ve
+00013190: 6374 6f72 206f 6620 6772 6964 2069 6473  ctor of grid ids
+000131a0: 2e0a 0a20 2020 2052 6574 7572 6e73 0a20  ...    Returns. 
+000131b0: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 204e     -------.    N
+000131c0: 6f6e 650a 0a20 2020 2045 7861 6d70 6c65  one..    Example
+000131d0: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20  s.    --------. 
+000131e0: 2020 203e 3e3e 2066 726f 6d20 7079 7965     >>> from pyye
+000131f0: 7469 2069 6d70 6f72 7420 6e61 7374 7261  ti import nastra
+00013200: 6e0a 2020 2020 3e3e 3e20 696d 706f 7274  n.    >>> import
+00013210: 206e 756d 7079 2061 7320 6e70 0a20 2020   numpy as np.   
+00013220: 203e 3e3e 206e 6173 7472 616e 2e77 7463   >>> nastran.wtc
+00013230: 7375 7065 7228 312c 2031 3030 2c20 6e70  super(1, 100, np
+00013240: 2e61 7261 6e67 6528 312c 2031 3029 290a  .arange(1, 10)).
+00013250: 2020 2020 4353 5550 4552 2020 2020 2020      CSUPER      
+00013260: 2031 3030 2020 2020 2020 2030 2020 2020   100       0    
+00013270: 2020 2031 2020 2020 2020 2032 2020 2020     1       2    
+00013280: 2020 2033 2020 2020 2020 2034 2020 2020     3       4    
+00013290: 2020 2035 2020 2020 2020 2036 0a20 2020     5       6.   
+000132a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000132b0: 3720 2020 2020 2020 3820 2020 2020 2020  7       8       
+000132c0: 390a 2020 2020 2222 220a 2020 2020 662e  9.    """.    f.
+000132d0: 7772 6974 6528 6622 4353 5550 4552 2020  write(f"CSUPER  
+000132e0: 7b73 7570 6572 6964 3a38 647d 7b30 3a38  {superid:8d}{0:8
+000132f0: 647d 2229 0a20 2020 2077 746e 6173 696e  d}").    wtnasin
+00013300: 7473 2866 2c20 342c 2067 7269 6473 290a  ts(f, 4, grids).
+00013310: 0a0a 4067 7569 746f 6f6c 732e 7772 6974  ..@guitools.writ
+00013320: 655f 7465 7874 5f66 696c 650a 6465 6620  e_text_file.def 
+00013330: 7774 6d70 6328 662c 2073 6574 6964 2c20  wtmpc(f, setid, 
+00013340: 6769 645f 646f 665f 642c 2063 6f65 6666  gid_dof_d, coeff
+00013350: 5f64 2c20 6769 645f 646f 665f 692c 2063  _d, gid_dof_i, c
+00013360: 6f65 6666 735f 6929 3a0a 2020 2020 2222  oeffs_i):.    ""
+00013370: 220a 2020 2020 5772 6974 6573 2061 204e  ".    Writes a N
+00013380: 6173 7472 616e 204d 5043 2063 6172 6420  astran MPC card 
+00013390: 746f 2061 2066 696c 650a 0a20 2020 2050  to a file..    P
+000133a0: 6172 616d 6574 6572 730a 2020 2020 2d2d  arameters.    --
+000133b0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2066 203a  --------.    f :
+000133c0: 2073 7472 696e 6720 6f72 2066 696c 655f   string or file_
+000133d0: 6c69 6b65 206f 7220 3120 6f72 204e 6f6e  like or 1 or Non
+000133e0: 650a 2020 2020 2020 2020 4569 7468 6572  e.        Either
+000133f0: 2061 206e 616d 6520 6f66 2061 2066 696c   a name of a fil
+00013400: 652c 206f 7220 6973 2061 2066 696c 655f  e, or is a file_
+00013410: 6c69 6b65 206f 626a 6563 7420 6173 2072  like object as r
+00013420: 6574 7572 6e65 640a 2020 2020 2020 2020  eturned.        
+00013430: 6279 203a 6675 6e63 3a60 6f70 656e 6020  by :func:`open` 
+00013440: 6f72 203a 636c 6173 733a 6069 6f2e 5374  or :class:`io.St
+00013450: 7269 6e67 494f 602e 2049 6e70 7574 2061  ringIO`. Input a
+00013460: 7320 696e 7465 6765 7220 3120 746f 0a20  s integer 1 to. 
+00013470: 2020 2020 2020 2077 7269 7465 2074 6f20         write to 
+00013480: 7374 646f 7574 2e20 4361 6e20 616c 736f  stdout. Can also
+00013490: 2062 6520 7468 6520 6e61 6d65 206f 6620   be the name of 
+000134a0: 6120 6469 7265 6374 6f72 7920 6f72 204e  a directory or N
+000134b0: 6f6e 653b 0a20 2020 2020 2020 2069 6e20  one;.        in 
+000134c0: 7468 6573 6520 6361 7365 732c 2061 2047  these cases, a G
+000134d0: 5549 2069 7320 6f70 656e 6564 2066 6f72  UI is opened for
+000134e0: 2066 696c 6520 7365 6c65 6374 696f 6e2e   file selection.
+000134f0: 0a20 2020 2073 6574 6964 203a 2069 6e74  .    setid : int
+00013500: 6567 6572 0a20 2020 2020 2020 204d 5043  eger.        MPC
+00013510: 2073 6574 2049 440a 2020 2020 6769 645f   set ID.    gid_
+00013520: 646f 665f 6420 3a20 3164 2061 7272 6179  dof_d : 1d array
+00013530: 5f6c 696b 650a 2020 2020 2020 2020 4120  _like.        A 
+00013540: 6c65 6e67 7468 2d32 2061 7272 6179 2063  length-2 array c
+00013550: 6f6e 7461 696e 696e 6720 7468 6520 6465  ontaining the de
+00013560: 7065 6e64 656e 7420 6772 6964 2049 4420  pendent grid ID 
+00013570: 616e 6420 444f 462e 0a20 2020 2063 6f65  and DOF..    coe
+00013580: 6666 5f64 203a 2066 6c6f 6174 0a20 2020  ff_d : float.   
+00013590: 2020 2020 2054 6865 2063 6f65 6666 6963       The coeffic
+000135a0: 6965 6e74 2061 7070 6c69 6564 2074 6f20  ient applied to 
+000135b0: 7468 6520 6465 7065 6e64 656e 7420 444f  the dependent DO
+000135c0: 462e 0a20 2020 2067 6964 5f64 6f66 5f69  F..    gid_dof_i
+000135d0: 203a 2032 6420 6172 7261 795f 6c69 6b65   : 2d array_like
+000135e0: 0a20 2020 2020 2020 2032 2063 6f6c 756d  .        2 colum
+000135f0: 6e20 6d61 7472 6978 3a20 5b67 7269 645f  n matrix: [grid_
+00013600: 6964 732c 2044 4f46 735d 2073 7065 6369  ids, DOFs] speci
+00013610: 6679 696e 6720 7468 6520 696e 6465 7065  fying the indepe
+00013620: 6e64 656e 740a 2020 2020 2020 2020 444f  ndent.        DO
+00013630: 4673 0a20 2020 2063 6f65 6666 735f 6920  Fs.    coeffs_i 
+00013640: 3a20 3164 2061 7272 6179 5f6c 696b 650a  : 1d array_like.
+00013650: 2020 2020 2020 2020 4172 7261 7920 6f66          Array of
+00013660: 2066 6c6f 6174 7320 636f 6e74 6169 6e69   floats containi
+00013670: 6e67 2074 6865 2063 6f65 6666 6963 6965  ng the coefficie
+00013680: 6e74 2066 6f72 2065 6163 6820 696e 6465  nt for each inde
+00013690: 7065 6e64 656e 740a 2020 2020 2020 2020  pendent.        
+000136a0: 444f 462e 2020 5468 6973 2061 7272 6179  DOF.  This array
+000136b0: 206d 7563 6820 6861 7665 2074 6865 2073   much have the s
+000136c0: 616d 6520 6c65 6e67 7468 2061 7320 7468  ame length as th
+000136d0: 6520 6e75 6d62 6572 206f 6620 726f 7773  e number of rows
+000136e0: 0a20 2020 2020 2020 2069 6e20 6769 645f  .        in gid_
+000136f0: 646f 665f 692e 0a0a 2020 2020 4578 616d  dof_i...    Exam
+00013700: 706c 6573 0a20 2020 202d 2d2d 2d2d 2d2d  ples.    -------
+00013710: 2d0a 2020 2020 3e3e 3e20 696d 706f 7274  -.    >>> import
+00013720: 206e 756d 7079 2061 7320 6e70 0a20 2020   numpy as np.   
+00013730: 203e 3e3e 2066 726f 6d20 7079 7965 7469   >>> from pyyeti
+00013740: 2069 6d70 6f72 7420 6e61 7374 7261 6e0a   import nastran.
+00013750: 2020 2020 3e3e 3e20 7365 7469 6420 3d20      >>> setid = 
+00013760: 3130 310a 2020 2020 3e3e 3e20 6964 5f64  101.    >>> id_d
+00013770: 6f66 5f64 203d 206e 702e 6172 7261 7928  of_d = np.array(
+00013780: 5b32 312c 2031 5d29 0a20 2020 203e 3e3e  [21, 1]).    >>>
+00013790: 2063 6f65 6666 5f64 203d 202d 312e 300a   coeff_d = -1.0.
+000137a0: 2020 2020 3e3e 3e20 6964 5f64 6f66 5f69      >>> id_dof_i
+000137b0: 203d 206e 702e 6172 7261 7928 5b5b 3331   = np.array([[31
+000137c0: 2c20 315d 2c20 5b33 312c 2032 5d2c 205b  , 1], [31, 2], [
+000137d0: 3332 2c20 355d 5d29 0a20 2020 203e 3e3e  32, 5]]).    >>>
+000137e0: 2063 6f65 6666 735f 6920 3d20 6e70 2e61   coeffs_i = np.a
+000137f0: 7272 6179 285b 302e 3735 2c20 302e 3235  rray([0.75, 0.25
+00013800: 2c20 312e 3635 5d29 0a20 2020 203e 3e3e  , 1.65]).    >>>
+00013810: 206e 6173 7472 616e 2e77 746d 7063 2831   nastran.wtmpc(1
+00013820: 2c20 7365 7469 642c 2069 645f 646f 665f  , setid, id_dof_
+00013830: 642c 2063 6f65 6666 5f64 2c20 6964 5f64  d, coeff_d, id_d
+00013840: 6f66 5f69 2c20 636f 6566 6673 5f69 290a  of_i, coeffs_i).
+00013850: 2020 2020 4d50 432a 2020 2020 2020 2020      MPC*        
+00013860: 2020 2020 2020 2020 2031 3031 2020 2020           101    
+00013870: 2020 2020 2020 2020 2020 3231 2020 2020            21    
+00013880: 2020 2020 2020 2020 2020 2031 2d31 2e30             1-1.0
+00013890: 3030 3030 3030 3030 452b 3030 0a20 2020  00000000E+00.   
+000138a0: 202a 2020 2020 2020 2020 2020 2020 2020   *              
+000138b0: 2020 2020 2020 2033 3120 2020 2020 2020         31       
+000138c0: 2020 2020 2020 2020 3120 372e 3530 3030          1 7.5000
+000138d0: 3030 3030 3045 2d30 3120 2020 2020 2020  00000E-01       
+000138e0: 2020 2020 2020 2020 202a 0a20 2020 202a           *.    *
+000138f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013910: 2020 2020 2033 3120 2020 2020 2020 2020       31         
+00013920: 2020 2020 2020 3220 322e 3530 3030 3030        2 2.500000
+00013930: 3030 3045 2d30 310a 2020 2020 2a20 2020  000E-01.    *   
+00013940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013950: 2020 3332 2020 2020 2020 2020 2020 2020    32            
+00013960: 2020 2035 2031 2e36 3530 3030 3030 3030     5 1.650000000
+00013970: 452b 3030 0a20 2020 2022 2222 0a20 2020  E+00.    """.   
+00013980: 2069 6620 6e6f 7420 7365 7469 6420 3e20   if not setid > 
+00013990: 303a 0a20 2020 2020 2020 2072 6169 7365  0:.        raise
+000139a0: 2056 616c 7565 4572 726f 7228 2273 6574   ValueError("set
+000139b0: 6964 206d 7573 7420 6265 203e 3022 290a  id must be >0").
+000139c0: 2020 2020 6966 2067 6964 5f64 6f66 5f64      if gid_dof_d
+000139d0: 2e73 6861 7065 5b30 5d20 213d 2032 3a0a  .shape[0] != 2:.
+000139e0: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+000139f0: 6c75 6545 7272 6f72 2822 6769 645f 646f  lueError("gid_do
+00013a00: 665f 6420 6d75 7374 2068 6176 6520 6c65  f_d must have le
+00013a10: 6e67 7468 2032 2229 0a20 2020 206e 5f63  ngth 2").    n_c
+00013a20: 6f65 6666 203d 2063 6f65 6666 735f 692e  oeff = coeffs_i.
+00013a30: 7368 6170 655b 305d 0a20 2020 2069 6620  shape[0].    if 
+00013a40: 6e5f 636f 6566 6620 3c20 313a 0a20 2020  n_coeff < 1:.   
+00013a50: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+00013a60: 4572 726f 7228 226d 7573 7420 6861 7665  Error("must have
+00013a70: 2061 7420 6c65 6173 7420 6f6e 6520 696e   at least one in
+00013a80: 6465 7065 6e64 656e 7420 444f 4622 290a  dependent DOF").
+00013a90: 2020 2020 6966 2067 6964 5f64 6f66 5f69      if gid_dof_i
+00013aa0: 2e73 6861 7065 5b30 5d20 213d 206e 5f63  .shape[0] != n_c
+00013ab0: 6f65 6666 3a0a 2020 2020 2020 2020 7261  oeff:.        ra
+00013ac0: 6973 6520 5661 6c75 6545 7272 6f72 2822  ise ValueError("
+00013ad0: 6e75 6d62 6572 206f 6620 726f 7773 2069  number of rows i
+00013ae0: 6e20 6769 645f 646f 665f 6920 6d75 7374  n gid_dof_i must
+00013af0: 206d 6174 6368 206c 656e 6774 6820 6f66   match length of
+00013b00: 2063 6f65 6666 735f 6922 290a 2020 2020   coeffs_i").    
+00013b10: 6966 2067 6964 5f64 6f66 5f69 2e73 6861  if gid_dof_i.sha
+00013b20: 7065 5b31 5d20 213d 2032 3a0a 2020 2020  pe[1] != 2:.    
+00013b30: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+00013b40: 7272 6f72 2822 6769 645f 646f 665f 6920  rror("gid_dof_i 
+00013b50: 6d75 7374 2068 6176 6520 7477 6f20 636f  must have two co
+00013b60: 6c75 6d6e 7322 290a 0a20 2020 2067 6964  lumns")..    gid
+00013b70: 5f64 2c20 646f 665f 6420 3d20 6769 645f  _d, dof_d = gid_
+00013b80: 646f 665f 640a 2020 2020 662e 7772 6974  dof_d.    f.writ
+00013b90: 6528 6622 4d50 432a 2020 2020 7b73 6574  e(f"MPC*    {set
+00013ba0: 6964 3a31 3664 7d7b 6769 645f 643a 3136  id:16d}{gid_d:16
+00013bb0: 647d 7b64 6f66 5f64 3a31 3664 7d7b 636f  d}{dof_d:16d}{co
+00013bc0: 6566 665f 643a 3136 2e39 457d 5c6e 2229  eff_d:16.9E}\n")
+00013bd0: 0a20 2020 2066 6f72 2069 2c20 2863 6f65  .    for i, (coe
+00013be0: 6666 2c20 2867 6964 2c20 646f 6629 2920  ff, (gid, dof)) 
+00013bf0: 696e 2065 6e75 6d65 7261 7465 287a 6970  in enumerate(zip
+00013c00: 2863 6f65 6666 735f 692c 2067 6964 5f64  (coeffs_i, gid_d
+00013c10: 6f66 5f69 2929 3a0a 2020 2020 2020 2020  of_i)):.        
+00013c20: 662e 7772 6974 6528 222a 2020 2020 2020  f.write("*      
+00013c30: 2022 290a 2020 2020 2020 2020 6966 2069   ").        if i
+00013c40: 2025 2032 2021 3d20 303a 0a20 2020 2020   % 2 != 0:.     
+00013c50: 2020 2020 2020 2066 2e77 7269 7465 2822         f.write("
+00013c60: 2022 202a 2031 3629 0a20 2020 2020 2020   " * 16).       
+00013c70: 2066 2e77 7269 7465 2866 227b 6769 643a   f.write(f"{gid:
+00013c80: 3136 647d 7b64 6f66 3a31 3664 7d7b 636f  16d}{dof:16d}{co
+00013c90: 6566 663a 3136 2e39 457d 2229 0a20 2020  eff:16.9E}").   
+00013ca0: 2020 2020 2069 6620 6920 2520 3220 3d3d       if i % 2 ==
+00013cb0: 2030 2061 6e64 206e 5f63 6f65 6666 203e   0 and n_coeff >
+00013cc0: 2069 202b 2031 3a0a 2020 2020 2020 2020   i + 1:.        
+00013cd0: 2020 2020 662e 7772 6974 6528 2220 2220      f.write(" " 
+00013ce0: 2a20 3136 202b 2022 2a22 290a 2020 2020  * 16 + "*").    
+00013cf0: 2020 2020 662e 7772 6974 6528 225c 6e22      f.write("\n"
+00013d00: 290a 2020 2020 6966 2069 2025 2032 2021  ).    if i % 2 !
+00013d10: 3d20 303a 0a20 2020 2020 2020 2066 2e77  = 0:.        f.w
+00013d20: 7269 7465 2822 2a5c 6e22 290a 0a0a 4067  rite("*\n")...@g
+00013d30: 7569 746f 6f6c 732e 7772 6974 655f 7465  uitools.write_te
+00013d40: 7874 5f66 696c 650a 6465 6620 7774 7370  xt_file.def wtsp
+00013d50: 6f69 6e74 7328 662c 2073 706f 696e 7473  oints(f, spoints
+00013d60: 293a 0a20 2020 2022 2222 0a20 2020 2057  ):.    """.    W
+00013d70: 7269 7465 7320 4e61 7374 7261 6e20 5350  rites Nastran SP
+00013d80: 4f49 4e54 2063 6172 6473 2074 6f20 6120  OINT cards to a 
+00013d90: 6669 6c65 2e0a 0a20 2020 2066 203a 2073  file...    f : s
+00013da0: 7472 696e 6720 6f72 2066 696c 655f 6c69  tring or file_li
+00013db0: 6b65 206f 7220 3120 6f72 204e 6f6e 650a  ke or 1 or None.
+00013dc0: 2020 2020 2020 2020 4569 7468 6572 2061          Either a
+00013dd0: 206e 616d 6520 6f66 2061 2066 696c 652c   name of a file,
+00013de0: 206f 7220 6973 2061 2066 696c 655f 6c69   or is a file_li
+00013df0: 6b65 206f 626a 6563 7420 6173 2072 6574  ke object as ret
+00013e00: 7572 6e65 640a 2020 2020 2020 2020 6279  urned.        by
+00013e10: 203a 6675 6e63 3a60 6f70 656e 6020 6f72   :func:`open` or
+00013e20: 203a 636c 6173 733a 6069 6f2e 5374 7269   :class:`io.Stri
+00013e30: 6e67 494f 602e 2049 6e70 7574 2061 7320  ngIO`. Input as 
+00013e40: 696e 7465 6765 7220 3120 746f 0a20 2020  integer 1 to.   
+00013e50: 2020 2020 2077 7269 7465 2074 6f20 7374       write to st
+00013e60: 646f 7574 2e20 4361 6e20 616c 736f 2062  dout. Can also b
+00013e70: 6520 7468 6520 6e61 6d65 206f 6620 6120  e the name of a 
+00013e80: 6469 7265 6374 6f72 7920 6f72 204e 6f6e  directory or Non
+00013e90: 653b 0a20 2020 2020 2020 2069 6e20 7468  e;.        in th
+00013ea0: 6573 6520 6361 7365 732c 2061 2047 5549  ese cases, a GUI
+00013eb0: 2069 7320 6f70 656e 6564 2066 6f72 2066   is opened for f
+00013ec0: 696c 6520 7365 6c65 6374 696f 6e2e 0a20  ile selection.. 
+00013ed0: 2020 2073 706f 696e 7473 203a 2031 6420     spoints : 1d 
+00013ee0: 6172 7261 795f 6c69 6b65 0a20 2020 2020  array_like.     
+00013ef0: 2020 2056 6563 746f 7220 6f66 2053 504f     Vector of SPO
+00013f00: 494e 5420 4944 732e 0a0a 2020 2020 4578  INT IDs...    Ex
+00013f10: 616d 706c 6573 0a20 2020 202d 2d2d 2d2d  amples.    -----
+00013f20: 2d2d 2d0a 2020 2020 3e3e 3e20 696d 706f  ---.    >>> impo
+00013f30: 7274 206e 756d 7079 2061 7320 6e70 0a20  rt numpy as np. 
+00013f40: 2020 203e 3e3e 2066 726f 6d20 7079 7965     >>> from pyye
+00013f50: 7469 2069 6d70 6f72 7420 6e61 7374 7261  ti import nastra
+00013f60: 6e0a 2020 2020 3e3e 3e20 7370 6f69 6e74  n.    >>> spoint
+00013f70: 7320 3d20 5b31 3030 312c 2031 3030 322c  s = [1001, 1002,
+00013f80: 2031 3030 335d 0a20 2020 203e 3e3e 206e   1003].    >>> n
+00013f90: 6173 7472 616e 2e77 7473 706f 696e 7473  astran.wtspoints
+00013fa0: 2831 2c20 7370 6f69 6e74 7329 0a20 2020  (1, spoints).   
+00013fb0: 2053 504f 494e 5420 2020 2020 2031 3030   SPOINT      100
+00013fc0: 3120 2020 2031 3030 3220 2020 2031 3030  1    1002    100
+00013fd0: 330a 2020 2020 2222 220a 2020 2020 6966  3.    """.    if
+00013fe0: 206e 6f74 206c 656e 2873 706f 696e 7473   not len(spoints
+00013ff0: 2920 3e20 303a 0a20 2020 2020 2020 2072  ) > 0:.        r
+00014000: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+00014010: 2273 706f 696e 7473 206d 7573 7420 6861  "spoints must ha
+00014020: 7665 206c 656e 6774 6820 3e30 2229 0a20  ve length >0"). 
+00014030: 2020 2066 2e77 7269 7465 2822 5350 4f49     f.write("SPOI
+00014040: 4e54 2020 2229 0a20 2020 2066 6f72 2069  NT  ").    for i
+00014050: 2c20 7370 6f69 6e74 2069 6e20 656e 756d  , spoint in enum
+00014060: 6572 6174 6528 7370 6f69 6e74 7329 3a0a  erate(spoints):.
+00014070: 2020 2020 2020 2020 6966 2069 203e 2030          if i > 0
+00014080: 2061 6e64 2069 2025 2038 203d 3d20 303a   and i % 8 == 0:
+00014090: 0a20 2020 2020 2020 2020 2020 2066 2e77  .            f.w
+000140a0: 7269 7465 2822 5c6e 5350 4f49 4e54 2020  rite("\nSPOINT  
+000140b0: 2229 0a20 2020 2020 2020 2066 2e77 7269  ").        f.wri
+000140c0: 7465 2866 227b 7370 6f69 6e74 3a38 647d  te(f"{spoint:8d}
+000140d0: 2229 0a20 2020 2066 2e77 7269 7465 2822  ").    f.write("
+000140e0: 5c6e 2229 0a0a 0a40 6775 6974 6f6f 6c73  \n")...@guitools
+000140f0: 2e77 7269 7465 5f74 6578 745f 6669 6c65  .write_text_file
+00014100: 0a64 6566 2077 7473 7063 3128 662c 2065  .def wtspc1(f, e
+00014110: 6964 2c20 646f 662c 2067 7269 6473 2c20  id, dof, grids, 
+00014120: 6e61 6d65 3d22 5350 4331 2229 3a0a 2020  name="SPC1"):.  
+00014130: 2020 2222 220a 2020 2020 5772 6974 6573    """.    Writes
+00014140: 2061 204e 6173 7472 616e 2053 5043 3120   a Nastran SPC1 
+00014150: 286f 7220 7369 6d69 6c61 7229 2063 6172  (or similar) car
+00014160: 6420 746f 2061 2066 696c 652e 0a0a 2020  d to a file...  
+00014170: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
+00014180: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
+00014190: 6620 3a20 7374 7269 6e67 206f 7220 6669  f : string or fi
+000141a0: 6c65 5f6c 696b 6520 6f72 2031 206f 7220  le_like or 1 or 
+000141b0: 4e6f 6e65 0a20 2020 2020 2020 2045 6974  None.        Eit
+000141c0: 6865 7220 6120 6e61 6d65 206f 6620 6120  her a name of a 
+000141d0: 6669 6c65 2c20 6f72 2069 7320 6120 6669  file, or is a fi
+000141e0: 6c65 5f6c 696b 6520 6f62 6a65 6374 2061  le_like object a
+000141f0: 7320 7265 7475 726e 6564 0a20 2020 2020  s returned.     
+00014200: 2020 2062 7920 3a66 756e 633a 606f 7065     by :func:`ope
+00014210: 6e60 206f 7220 3a63 6c61 7373 3a60 696f  n` or :class:`io
+00014220: 2e53 7472 696e 6749 4f60 2e20 496e 7075  .StringIO`. Inpu
+00014230: 7420 6173 2069 6e74 6567 6572 2031 2074  t as integer 1 t
+00014240: 6f0a 2020 2020 2020 2020 7772 6974 6520  o.        write 
+00014250: 746f 2073 7464 6f75 742e 2043 616e 2061  to stdout. Can a
+00014260: 6c73 6f20 6265 2074 6865 206e 616d 6520  lso be the name 
+00014270: 6f66 2061 2064 6972 6563 746f 7279 206f  of a directory o
+00014280: 7220 4e6f 6e65 3b0a 2020 2020 2020 2020  r None;.        
+00014290: 696e 2074 6865 7365 2063 6173 6573 2c20  in these cases, 
+000142a0: 6120 4755 4920 6973 206f 7065 6e65 6420  a GUI is opened 
+000142b0: 666f 7220 6669 6c65 2073 656c 6563 7469  for file selecti
+000142c0: 6f6e 2e0a 2020 2020 6569 6420 3a20 696e  on..    eid : in
+000142d0: 7465 6765 720a 2020 2020 2020 2020 456c  teger.        El
+000142e0: 656d 656e 7420 4944 0a20 2020 2064 6f66  ement ID.    dof
+000142f0: 203a 2069 6e74 6567 6572 0a20 2020 2020   : integer.     
+00014300: 2020 2041 6e20 696e 7465 6765 7220 636f     An integer co
+00014310: 6e63 6174 656e 6174 696f 6e20 6f66 2074  ncatenation of t
+00014320: 6865 2044 4f46 2028 6578 3a20 3132 3334  he DOF (ex: 1234
+00014330: 3536 290a 2020 2020 6772 6964 7320 3a20  56).    grids : 
+00014340: 3164 2061 7272 6179 5f6c 696b 650a 2020  1d array_like.  
+00014350: 2020 2020 2020 5665 6374 6f72 206f 6620        Vector of 
+00014360: 6772 6964 2069 6473 2e0a 2020 2020 6e61  grid ids..    na
+00014370: 6d65 203a 2073 7472 696e 673b 206f 7074  me : string; opt
+00014380: 696f 6e61 6c0a 2020 2020 2020 2020 4e61  ional.        Na
+00014390: 6d65 206f 6620 4e41 5354 5241 4e20 6361  me of NASTRAN ca
+000143a0: 7264 2074 6f20 7772 6974 653b 2063 6172  rd to write; car
+000143b0: 6420 6d75 7374 2062 6520 696e 2073 616d  d must be in sam
+000143c0: 6520 666f 726d 6174 2061 730a 2020 2020  e format as.    
+000143d0: 2020 2020 7468 6520 5350 4331 2063 6172      the SPC1 car
+000143e0: 642e 0a0a 2020 2020 5265 7475 726e 730a  d...    Returns.
+000143f0: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
+00014400: 4e6f 6e65 0a0a 2020 2020 4578 616d 706c  None..    Exampl
+00014410: 6573 0a20 2020 202d 2d2d 2d2d 2d2d 2d0a  es.    --------.
+00014420: 2020 2020 3e3e 3e20 6672 6f6d 2070 7979      >>> from pyy
+00014430: 6574 6920 696d 706f 7274 206e 6173 7472  eti import nastr
+00014440: 616e 0a20 2020 203e 3e3e 2069 6d70 6f72  an.    >>> impor
+00014450: 7420 6e75 6d70 7920 6173 206e 700a 2020  t numpy as np.  
+00014460: 2020 3e3e 3e20 6e61 7374 7261 6e2e 7774    >>> nastran.wt
+00014470: 7370 6331 2831 2c20 312c 2031 3233 3435  spc1(1, 1, 12345
+00014480: 362c 206e 702e 6172 616e 6765 2831 2c20  6, np.arange(1, 
+00014490: 3130 2929 0a20 2020 2053 5043 3120 2020  10)).    SPC1   
+000144a0: 2020 2020 2020 2020 3120 2031 3233 3435          1  12345
+000144b0: 3620 2020 2020 2020 3120 2020 2020 2020  6       1       
+000144c0: 3220 2020 2020 2020 3320 2020 2020 2020  2       3       
+000144d0: 3420 2020 2020 2020 3520 2020 2020 2020  4       5       
+000144e0: 360a 2020 2020 2020 2020 2020 2020 2020  6.              
+000144f0: 2020 2020 2037 2020 2020 2020 2038 2020       7       8  
+00014500: 2020 2020 2039 0a20 2020 203e 3e3e 206e       9.    >>> n
+00014510: 6173 7472 616e 2e77 7473 7063 3128 312c  astran.wtspc1(1,
+00014520: 2032 3030 2c20 3132 3334 3536 2c20 6e70   200, 123456, np
+00014530: 2e61 7261 6e67 6528 3230 3031 2c20 3230  .arange(2001, 20
+00014540: 3331 292c 0a20 2020 202e 2e2e 2020 2020  31),.    ...    
+00014550: 2020 2020 2020 2020 2020 2020 2753 4551              'SEQ
+00014560: 5345 5431 2729 0a20 2020 2053 4551 5345  SET1').    SEQSE
+00014570: 5431 2020 2020 2020 3230 3020 2031 3233  T1      200  123
+00014580: 3435 3620 2020 2032 3030 3120 2020 2032  456    2001    2
+00014590: 3030 3220 2020 2032 3030 3320 2020 2032  002    2003    2
+000145a0: 3030 3420 2020 2032 3030 3520 2020 2032  004    2005    2
+000145b0: 3030 360a 2020 2020 2020 2020 2020 2020  006.            
+000145c0: 2020 2020 3230 3037 2020 2020 3230 3038      2007    2008
+000145d0: 2020 2020 3230 3039 2020 2020 3230 3130      2009    2010
+000145e0: 2020 2020 3230 3131 2020 2020 3230 3132      2011    2012
+000145f0: 2020 2020 3230 3133 2020 2020 3230 3134      2013    2014
+00014600: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00014610: 2032 3031 3520 2020 2032 3031 3620 2020   2015    2016   
+00014620: 2032 3031 3720 2020 2032 3031 3820 2020   2017    2018   
+00014630: 2032 3031 3920 2020 2032 3032 3020 2020   2019    2020   
+00014640: 2032 3032 3120 2020 2032 3032 320a 2020   2021    2022.  
+00014650: 2020 2020 2020 2020 2020 2020 2020 3230                20
+00014660: 3233 2020 2020 3230 3234 2020 2020 3230  23    2024    20
+00014670: 3235 2020 2020 3230 3236 2020 2020 3230  25    2026    20
+00014680: 3237 2020 2020 3230 3238 2020 2020 3230  27    2028    20
+00014690: 3239 2020 2020 3230 3330 0a20 2020 2022  29    2030.    "
+000146a0: 2222 0a20 2020 2066 2e77 7269 7465 2866  "".    f.write(f
+000146b0: 227b 6e61 6d65 3a3c 3873 7d7b 6569 643a  "{name:<8s}{eid:
+000146c0: 3864 7d7b 646f 663a 3864 7d22 290a 2020  8d}{dof:8d}").  
+000146d0: 2020 7774 6e61 7369 6e74 7328 662c 2034    wtnasints(f, 4
+000146e0: 2c20 6772 6964 7329 0a0a 0a40 6775 6974  , grids)...@guit
+000146f0: 6f6f 6c73 2e77 7269 7465 5f74 6578 745f  ools.write_text_
+00014700: 6669 6c65 0a64 6566 2077 7478 7365 7431  file.def wtxset1
+00014710: 2866 2c20 646f 662c 2067 7269 6473 2c20  (f, dof, grids, 
+00014720: 6e61 6d65 3d22 4253 4554 3122 293a 0a20  name="BSET1"):. 
+00014730: 2020 2022 2222 0a20 2020 2057 7269 7465     """.    Write
+00014740: 7320 6120 4e61 7374 7261 6e20 4253 4554  s a Nastran BSET
+00014750: 312c 2051 5345 5431 2028 6f72 2073 696d  1, QSET1 (or sim
+00014760: 696c 6172 2920 6361 7264 2074 6f20 6120  ilar) card to a 
+00014770: 6669 6c65 2e0a 0a20 2020 2050 6172 616d  file...    Param
+00014780: 6574 6572 730a 2020 2020 2d2d 2d2d 2d2d  eters.    ------
+00014790: 2d2d 2d2d 0a20 2020 2066 203a 2073 7472  ----.    f : str
+000147a0: 696e 6720 6f72 2066 696c 655f 6c69 6b65  ing or file_like
+000147b0: 206f 7220 3120 6f72 204e 6f6e 650a 2020   or 1 or None.  
+000147c0: 2020 2020 2020 4569 7468 6572 2061 206e        Either a n
+000147d0: 616d 6520 6f66 2061 2066 696c 652c 206f  ame of a file, o
+000147e0: 7220 6973 2061 2066 696c 655f 6c69 6b65  r is a file_like
+000147f0: 206f 626a 6563 7420 6173 2072 6574 7572   object as retur
+00014800: 6e65 640a 2020 2020 2020 2020 6279 203a  ned.        by :
+00014810: 6675 6e63 3a60 6f70 656e 6020 6f72 203a  func:`open` or :
+00014820: 636c 6173 733a 6069 6f2e 5374 7269 6e67  class:`io.String
+00014830: 494f 602e 2049 6e70 7574 2061 7320 696e  IO`. Input as in
+00014840: 7465 6765 7220 3120 746f 0a20 2020 2020  teger 1 to.     
+00014850: 2020 2077 7269 7465 2074 6f20 7374 646f     write to stdo
+00014860: 7574 2e20 4361 6e20 616c 736f 2062 6520  ut. Can also be 
+00014870: 7468 6520 6e61 6d65 206f 6620 6120 6469  the name of a di
+00014880: 7265 6374 6f72 7920 6f72 204e 6f6e 653b  rectory or None;
+00014890: 0a20 2020 2020 2020 2069 6e20 7468 6573  .        in thes
+000148a0: 6520 6361 7365 732c 2061 2047 5549 2069  e cases, a GUI i
+000148b0: 7320 6f70 656e 6564 2066 6f72 2066 696c  s opened for fil
+000148c0: 6520 7365 6c65 6374 696f 6e2e 0a20 2020  e selection..   
+000148d0: 2064 6f66 203a 2069 6e74 6567 6572 0a20   dof : integer. 
+000148e0: 2020 2020 2020 2041 6e20 696e 7465 6765         An intege
+000148f0: 7220 636f 6e63 6174 656e 6174 696f 6e20  r concatenation 
+00014900: 6f66 2074 6865 2044 4f46 2028 6578 3a20  of the DOF (ex: 
+00014910: 3132 3334 3536 290a 2020 2020 6772 6964  123456).    grid
+00014920: 7320 3a20 3164 2061 7272 6179 5f6c 696b  s : 1d array_lik
+00014930: 650a 2020 2020 2020 2020 5665 6374 6f72  e.        Vector
+00014940: 206f 6620 6772 6964 2069 6473 2e0a 2020   of grid ids..  
+00014950: 2020 6e61 6d65 203a 2073 7472 696e 673b    name : string;
+00014960: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
+00014970: 2020 4e61 6d65 206f 6620 4e41 5354 5241    Name of NASTRA
+00014980: 4e20 6361 7264 2074 6f20 7772 6974 653b  N card to write;
+00014990: 2063 6172 6420 6d75 7374 2062 6520 696e   card must be in
+000149a0: 2073 616d 6520 666f 726d 6174 2061 730a   same format as.
+000149b0: 2020 2020 2020 2020 7468 6520 5350 4331          the SPC1
+000149c0: 2063 6172 642e 0a0a 2020 2020 5265 7475   card...    Retu
+000149d0: 726e 730a 2020 2020 2d2d 2d2d 2d2d 2d0a  rns.    -------.
+000149e0: 2020 2020 4e6f 6e65 0a0a 2020 2020 4578      None..    Ex
+000149f0: 616d 706c 6573 0a20 2020 202d 2d2d 2d2d  amples.    -----
+00014a00: 2d2d 2d0a 2020 2020 3e3e 3e20 6672 6f6d  ---.    >>> from
+00014a10: 2070 7979 6574 6920 696d 706f 7274 206e   pyyeti import n
+00014a20: 6173 7472 616e 0a20 2020 203e 3e3e 2069  astran.    >>> i
+00014a30: 6d70 6f72 7420 6e75 6d70 7920 6173 206e  mport numpy as n
+00014a40: 700a 2020 2020 3e3e 3e20 6e61 7374 7261  p.    >>> nastra
+00014a50: 6e2e 7774 7873 6574 3128 312c 2031 3233  n.wtxset1(1, 123
+00014a60: 3435 362c 206e 702e 6172 616e 6765 2831  456, np.arange(1
+00014a70: 2c20 3131 2929 0a20 2020 2042 5345 5431  , 11)).    BSET1
+00014a80: 2020 2020 2031 3233 3435 3620 2020 2020       123456     
+00014a90: 2020 3120 2020 2020 2020 3220 2020 2020    1       2     
+00014aa0: 2020 3320 2020 2020 2020 3420 2020 2020    3       4     
+00014ab0: 2020 3520 2020 2020 2020 3620 2020 2020    5       6     
+00014ac0: 2020 370a 2020 2020 2020 2020 2020 2020    7.            
+00014ad0: 2020 2020 2020 2038 2020 2020 2020 2039         8       9
+00014ae0: 2020 2020 2020 3130 0a20 2020 203e 3e3e        10.    >>>
+00014af0: 206e 6173 7472 616e 2e77 7478 7365 7431   nastran.wtxset1
+00014b00: 2831 2c20 302c 206e 702e 6172 616e 6765  (1, 0, np.arange
+00014b10: 2832 3030 312c 2032 3031 3329 2c20 2751  (2001, 2013), 'Q
+00014b20: 5345 5431 2729 0a20 2020 2051 5345 5431  SET1').    QSET1
+00014b30: 2020 2020 2020 2020 2020 3020 2020 2032            0    2
+00014b40: 3030 3120 2020 2032 3030 3220 2020 2032  001    2002    2
+00014b50: 3030 3320 2020 2032 3030 3420 2020 2032  003    2004    2
+00014b60: 3030 3520 2020 2032 3030 3620 2020 2032  005    2006    2
+00014b70: 3030 370a 2020 2020 2020 2020 2020 2020  007.            
+00014b80: 2020 2020 3230 3038 2020 2020 3230 3039      2008    2009
+00014b90: 2020 2020 3230 3130 2020 2020 3230 3131      2010    2011
+00014ba0: 2020 2020 3230 3132 0a20 2020 2022 2222      2012.    """
+00014bb0: 0a20 2020 2066 2e77 7269 7465 2866 227b  .    f.write(f"{
+00014bc0: 6e61 6d65 3a3c 3873 7d7b 646f 663a 3864  name:<8s}{dof:8d
+00014bd0: 7d22 290a 2020 2020 7774 6e61 7369 6e74  }").    wtnasint
+00014be0: 7328 662c 2033 2c20 6772 6964 7329 0a0a  s(f, 3, grids)..
+00014bf0: 0a40 6775 6974 6f6f 6c73 2e77 7269 7465  .@guitools.write
+00014c00: 5f74 6578 745f 6669 6c65 0a64 6566 2077  _text_file.def w
+00014c10: 7471 6373 6574 2866 2c20 7374 6172 7467  tqcset(f, startg
+00014c20: 7269 642c 206e 7129 3a0a 2020 2020 2222  rid, nq):.    ""
+00014c30: 220a 2020 2020 5772 6974 6573 204e 6173  ".    Writes Nas
+00014c40: 7472 616e 2051 5345 5431 2061 6e64 2043  tran QSET1 and C
+00014c50: 5345 5431 2063 6172 6473 2066 6f72 2047  SET1 cards for G
+00014c60: 5249 4420 6d6f 6461 6c20 444f 4620 666f  RID modal DOF fo
+00014c70: 7220 7573 6520 696e 0a20 2020 2074 6865  r use in.    the
+00014c80: 2044 4d41 5020 2278 746d 6174 7269 7822   DMAP "xtmatrix"
+00014c90: 2e0a 0a20 2020 2050 6172 616d 6574 6572  ...    Parameter
+00014ca0: 730a 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  s.    ----------
+00014cb0: 0a20 2020 2066 203a 2073 7472 696e 6720  .    f : string 
+00014cc0: 6f72 2066 696c 655f 6c69 6b65 206f 7220  or file_like or 
+00014cd0: 3120 6f72 204e 6f6e 650a 2020 2020 2020  1 or None.      
+00014ce0: 2020 4569 7468 6572 2061 206e 616d 6520    Either a name 
+00014cf0: 6f66 2061 2066 696c 652c 206f 7220 6973  of a file, or is
+00014d00: 2061 2066 696c 655f 6c69 6b65 206f 626a   a file_like obj
+00014d10: 6563 7420 6173 2072 6574 7572 6e65 640a  ect as returned.
+00014d20: 2020 2020 2020 2020 6279 203a 6675 6e63          by :func
+00014d30: 3a60 6f70 656e 6020 6f72 203a 636c 6173  :`open` or :clas
+00014d40: 733a 6069 6f2e 5374 7269 6e67 494f 602e  s:`io.StringIO`.
+00014d50: 2049 6e70 7574 2061 7320 696e 7465 6765   Input as intege
+00014d60: 7220 3120 746f 0a20 2020 2020 2020 2077  r 1 to.        w
+00014d70: 7269 7465 2074 6f20 7374 646f 7574 2e20  rite to stdout. 
+00014d80: 4361 6e20 616c 736f 2062 6520 7468 6520  Can also be the 
+00014d90: 6e61 6d65 206f 6620 6120 6469 7265 6374  name of a direct
+00014da0: 6f72 7920 6f72 204e 6f6e 653b 0a20 2020  ory or None;.   
+00014db0: 2020 2020 2069 6e20 7468 6573 6520 6361       in these ca
+00014dc0: 7365 732c 2061 2047 5549 2069 7320 6f70  ses, a GUI is op
+00014dd0: 656e 6564 2066 6f72 2066 696c 6520 7365  ened for file se
+00014de0: 6c65 6374 696f 6e2e 0a20 2020 2073 7461  lection..    sta
+00014df0: 7274 6772 6964 203a 2069 6e74 6567 6572  rtgrid : integer
+00014e00: 0a20 2020 2020 2020 2054 6865 2073 7461  .        The sta
+00014e10: 7274 2049 4420 666f 7220 7468 6520 6d6f  rt ID for the mo
+00014e20: 6461 6c20 6772 6964 7320 7468 6174 206e  dal grids that n
+00014e30: 6565 6420 746f 2062 6520 6173 7369 676e  eed to be assign
+00014e40: 6564 2074 6f0a 2020 2020 2020 2020 7468  ed to.        th
+00014e50: 6520 512d 7365 7420 616e 6420 432d 7365  e Q-set and C-se
+00014e60: 742e 2041 6e79 2065 7874 7261 2044 4f46  t. Any extra DOF
+00014e70: 2061 7265 2061 7373 6967 6e65 6420 746f   are assigned to
+00014e80: 2074 6865 2043 2d73 6574 2e0a 2020 2020   the C-set..    
+00014e90: 2020 2020 4372 6561 7465 6420 6772 6964      Created grid
+00014ea0: 2049 4473 2077 696c 6c20 6265 2073 6571   IDs will be seq
+00014eb0: 7565 6e74 6961 6c2e 0a20 2020 206e 7120  uential..    nq 
+00014ec0: 3a20 696e 7465 6765 720a 2020 2020 2020  : integer.      
+00014ed0: 2020 4e75 6d62 6572 206f 6620 6d6f 6461    Number of moda
+00014ee0: 6c20 444f 460a 0a20 2020 2052 6574 7572  l DOF..    Retur
+00014ef0: 6e73 0a20 2020 202d 2d2d 2d2d 2d2d 0a20  ns.    -------. 
+00014f00: 2020 204e 6f6e 650a 0a20 2020 2045 7861     None..    Exa
+00014f10: 6d70 6c65 730a 2020 2020 2d2d 2d2d 2d2d  mples.    ------
+00014f20: 2d2d 0a20 2020 203e 3e3e 2066 726f 6d20  --.    >>> from 
+00014f30: 7079 7965 7469 2069 6d70 6f72 7420 6e61  pyyeti import na
+00014f40: 7374 7261 6e0a 2020 2020 3e3e 3e20 696d  stran.    >>> im
+00014f50: 706f 7274 206e 756d 7079 2061 7320 6e70  port numpy as np
+00014f60: 0a20 2020 203e 3e3e 206e 6173 7472 616e  .    >>> nastran
+00014f70: 2e77 7471 6373 6574 2831 2c20 3939 3030  .wtqcset(1, 9900
+00014f80: 3031 2c20 3134 290a 2020 2020 5153 4554  01, 14).    QSET
+00014f90: 3120 2020 2020 3132 3334 3536 2020 3939  1     123456  99
+00014fa0: 3030 3031 2054 4852 5520 2020 2020 3939  0001 THRU     99
+00014fb0: 3030 3032 0a20 2020 2051 5345 5431 2020  0002.    QSET1  
+00014fc0: 2020 2020 2020 2031 3220 2039 3930 3030         12  99000
+00014fd0: 330a 2020 2020 4353 4554 3120 2020 2020  3.    CSET1     
+00014fe0: 2020 3334 3536 2020 3939 3030 3033 0a20    3456  990003. 
+00014ff0: 2020 2022 2222 0a20 2020 206e 6772 6964     """.    ngrid
+00015000: 7320 3d20 286e 7120 2b20 3529 202f 2f20  s = (nq + 5) // 
+00015010: 360a 2020 2020 656e 6467 7269 6420 3d20  6.    endgrid = 
+00015020: 7374 6172 7467 7269 6420 2b20 6e67 7269  startgrid + ngri
+00015030: 6473 202d 2031 0a20 2020 2078 646f 6620  ds - 1.    xdof 
+00015040: 3d20 6e71 202d 2036 202a 2028 6e67 7269  = nq - 6 * (ngri
+00015050: 6473 202d 2031 290a 2020 2020 7864 6f66  ds - 1).    xdof
+00015060: 7320 3d20 2231 3233 3435 3622 5b3a 7864  s = "123456"[:xd
+00015070: 6f66 5d0a 2020 2020 6364 6f66 7320 3d20  of].    cdofs = 
+00015080: 2231 3233 3435 3622 5b78 646f 663a 5d0a  "123456"[xdof:].
+00015090: 2020 2020 2320 7772 6974 6520 7173 6574      # write qset
+000150a0: 2061 6e64 2063 7365 7420 6361 7264 733a   and cset cards:
+000150b0: 0a20 2020 2069 6620 7864 6f66 203d 3d20  .    if xdof == 
+000150c0: 363a 0a20 2020 2020 2020 2069 6620 6e67  6:.        if ng
+000150d0: 7269 6473 203e 2031 3a0a 2020 2020 2020  rids > 1:.      
+000150e0: 2020 2020 2020 662e 7772 6974 6528 0a20        f.write(. 
+000150f0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00015100: 227b 2751 5345 5431 273a 3c38 737d 7b31  "{'QSET1':<8s}{1
+00015110: 3233 3435 363a 3864 7d7b 7374 6172 7467  23456:8d}{startg
+00015120: 7269 643a 3864 7d7b 2720 5448 5255 2027  rid:8d}{' THRU '
+00015130: 3a3c 3873 7d7b 656e 6467 7269 643a 3864  :<8s}{endgrid:8d
+00015140: 7d5c 6e22 0a20 2020 2020 2020 2020 2020  }\n".           
+00015150: 2029 0a20 2020 2020 2020 2065 6c73 653a   ).        else:
+00015160: 0a20 2020 2020 2020 2020 2020 2066 2e77  .            f.w
+00015170: 7269 7465 2866 227b 2751 5345 5431 273a  rite(f"{'QSET1':
+00015180: 3c38 737d 7b31 3233 3435 363a 3864 7d7b  <8s}{123456:8d}{
+00015190: 7374 6172 7467 7269 643a 3864 7d5c 6e22  startgrid:8d}\n"
+000151a0: 290a 2020 2020 656c 7365 3a0a 2020 2020  ).    else:.    
+000151b0: 2020 2020 6966 206e 6772 6964 7320 3e20      if ngrids > 
+000151c0: 323a 0a20 2020 2020 2020 2020 2020 2066  2:.            f
+000151d0: 2e77 7269 7465 280a 2020 2020 2020 2020  .write(.        
+000151e0: 2020 2020 2020 2020 6622 7b27 5153 4554          f"{'QSET
+000151f0: 3127 3a3c 3873 7d7b 3132 3334 3536 3a38  1':<8s}{123456:8
+00015200: 647d 7b73 7461 7274 6772 6964 3a38 647d  d}{startgrid:8d}
+00015210: 7b27 2054 4852 5520 273a 3c38 737d 220a  {' THRU ':<8s}".
+00015220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015230: 6622 7b65 6e64 6772 6964 202d 2031 3a38  f"{endgrid - 1:8
+00015240: 647d 5c6e 220a 2020 2020 2020 2020 2020  d}\n".          
+00015250: 2020 290a 2020 2020 2020 2020 656c 6966    ).        elif
+00015260: 206e 6772 6964 7320 3d3d 2032 3a0a 2020   ngrids == 2:.  
+00015270: 2020 2020 2020 2020 2020 662e 7772 6974            f.writ
+00015280: 6528 6622 7b27 5153 4554 3127 3a3c 3873  e(f"{'QSET1':<8s
+00015290: 7d7b 3132 3334 3536 3a38 647d 7b73 7461  }{123456:8d}{sta
+000152a0: 7274 6772 6964 3a38 647d 5c6e 2229 0a20  rtgrid:8d}\n"). 
+000152b0: 2020 2020 2020 2066 2e77 7269 7465 2866         f.write(f
+000152c0: 227b 2751 5345 5431 273a 3c38 737d 7b78  "{'QSET1':<8s}{x
+000152d0: 646f 6673 3a3e 3873 7d7b 656e 6467 7269  dofs:>8s}{endgri
+000152e0: 643a 3864 7d5c 6e22 290a 2020 2020 2020  d:8d}\n").      
+000152f0: 2020 662e 7772 6974 6528 6622 7b27 4353    f.write(f"{'CS
+00015300: 4554 3127 3a3c 3873 7d7b 6364 6f66 733a  ET1':<8s}{cdofs:
+00015310: 3e38 737d 7b65 6e64 6772 6964 3a38 647d  >8s}{endgrid:8d}
+00015320: 5c6e 2229 0a0a 0a40 6775 6974 6f6f 6c73  \n")...@guitools
+00015330: 2e77 7269 7465 5f74 6578 745f 6669 6c65  .write_text_file
+00015340: 0a64 6566 2077 7472 6265 3228 662c 2065  .def wtrbe2(f, e
+00015350: 6964 2c20 696e 6465 702c 2064 6f66 2c20  id, indep, dof, 
+00015360: 6465 7029 3a0a 2020 2020 2222 220a 2020  dep):.    """.  
+00015370: 2020 5772 6974 6573 2061 204e 6173 7472    Writes a Nastr
+00015380: 616e 2052 4245 3220 6361 7264 2074 6f20  an RBE2 card to 
+00015390: 6120 6669 6c65 2e0a 0a20 2020 2050 6172  a file...    Par
+000153a0: 616d 6574 6572 730a 2020 2020 2d2d 2d2d  ameters.    ----
+000153b0: 2d2d 2d2d 2d2d 0a20 2020 2066 203a 2073  ------.    f : s
+000153c0: 7472 696e 6720 6f72 2066 696c 655f 6c69  tring or file_li
+000153d0: 6b65 206f 7220 3120 6f72 204e 6f6e 650a  ke or 1 or None.
+000153e0: 2020 2020 2020 2020 4569 7468 6572 2061          Either a
+000153f0: 206e 616d 6520 6f66 2061 2066 696c 652c   name of a file,
+00015400: 206f 7220 6973 2061 2066 696c 655f 6c69   or is a file_li
+00015410: 6b65 206f 626a 6563 7420 6173 2072 6574  ke object as ret
+00015420: 7572 6e65 640a 2020 2020 2020 2020 6279  urned.        by
+00015430: 203a 6675 6e63 3a60 6f70 656e 6020 6f72   :func:`open` or
+00015440: 203a 636c 6173 733a 6069 6f2e 5374 7269   :class:`io.Stri
+00015450: 6e67 494f 602e 2049 6e70 7574 2061 7320  ngIO`. Input as 
+00015460: 696e 7465 6765 7220 3120 746f 0a20 2020  integer 1 to.   
+00015470: 2020 2020 2077 7269 7465 2074 6f20 7374       write to st
+00015480: 646f 7574 2e20 4361 6e20 616c 736f 2062  dout. Can also b
+00015490: 6520 7468 6520 6e61 6d65 206f 6620 6120  e the name of a 
+000154a0: 6469 7265 6374 6f72 7920 6f72 204e 6f6e  directory or Non
+000154b0: 653b 0a20 2020 2020 2020 2069 6e20 7468  e;.        in th
+000154c0: 6573 6520 6361 7365 732c 2061 2047 5549  ese cases, a GUI
+000154d0: 2069 7320 6f70 656e 6564 2066 6f72 2066   is opened for f
+000154e0: 696c 6520 7365 6c65 6374 696f 6e2e 0a20  ile selection.. 
+000154f0: 2020 2065 6964 203a 2069 6e74 6567 6572     eid : integer
+00015500: 0a20 2020 2020 2020 2045 6c65 6d65 6e74  .        Element
+00015510: 2049 440a 2020 2020 696e 6465 7020 3a20   ID.    indep : 
+00015520: 696e 7465 6765 720a 2020 2020 2020 2020  integer.        
+00015530: 496e 6465 7065 6e64 656e 7420 6772 6964  Independent grid
+00015540: 2049 442e 2041 6c6c 2036 2044 4f46 2061   ID. All 6 DOF a
+00015550: 7265 2061 7574 6f6d 6174 6963 616c 6c79  re automatically
+00015560: 2069 6e64 6570 656e 6465 6e74 0a20 2020   independent.   
+00015570: 2020 2020 2061 6e64 2061 7265 206e 6f74       and are not
+00015580: 2073 7065 6369 6669 6564 2e0a 2020 2020   specified..    
+00015590: 646f 6620 3a20 696e 7465 6765 720a 2020  dof : integer.  
+000155a0: 2020 2020 2020 416e 2069 6e74 6567 6572        An integer
+000155b0: 2063 6f6e 6361 7465 6e61 7469 6f6e 206f   concatenation o
+000155c0: 6620 7468 6520 444f 4620 2865 783a 2031  f the DOF (ex: 1
+000155d0: 3233 3435 3629 2074 6861 7420 6170 706c  23456) that appl
+000155e0: 6965 730a 2020 2020 2020 2020 666f 7220  ies.        for 
+000155f0: 616c 6c20 7468 6520 6465 7065 6e64 656e  all the dependen
+00015600: 7420 444f 462e 0a20 2020 2064 6570 203a  t DOF..    dep :
+00015610: 2031 6420 6172 7261 795f 6c69 6b65 0a20   1d array_like. 
+00015620: 2020 2020 2020 2056 6563 746f 7220 6f66         Vector of
+00015630: 2064 6570 656e 6465 6e74 2067 7269 6420   dependent grid 
+00015640: 4944 730a 0a20 2020 2052 6574 7572 6e73  IDs..    Returns
+00015650: 0a20 2020 202d 2d2d 2d2d 2d2d 0a20 2020  .    -------.   
+00015660: 204e 6f6e 650a 0a20 2020 2045 7861 6d70   None..    Examp
+00015670: 6c65 730a 2020 2020 2d2d 2d2d 2d2d 2d2d  les.    --------
+00015680: 0a20 2020 203e 3e3e 2066 726f 6d20 7079  .    >>> from py
+00015690: 7965 7469 2069 6d70 6f72 7420 6e61 7374  yeti import nast
+000156a0: 7261 6e0a 2020 2020 3e3e 3e20 696d 706f  ran.    >>> impo
+000156b0: 7274 206e 756d 7079 2061 7320 6e70 0a20  rt numpy as np. 
+000156c0: 2020 203e 3e3e 206e 6173 7472 616e 2e77     >>> nastran.w
+000156d0: 7472 6265 3228 312c 2031 2c20 3130 302c  trbe2(1, 1, 100,
+000156e0: 2031 3233 3435 362c 206e 702e 6172 616e   123456, np.aran
+000156f0: 6765 2831 3031 2c20 3131 3129 290a 2020  ge(101, 111)).  
+00015700: 2020 5242 4532 2020 2020 2020 2020 2020    RBE2          
+00015710: 2031 2020 2020 2031 3030 2020 3132 3334   1     100  1234
+00015720: 3536 2020 2020 2031 3031 2020 2020 2031  56     101     1
+00015730: 3032 2020 2020 2031 3033 2020 2020 2031  02     103     1
+00015740: 3034 2020 2020 2031 3035 0a20 2020 2020  04     105.     
+00015750: 2020 2020 2020 2020 2020 2020 3130 3620              106 
+00015760: 2020 2020 3130 3720 2020 2020 3130 3820      107     108 
+00015770: 2020 2020 3130 3920 2020 2020 3131 300a      109     110.
+00015780: 2020 2020 2222 220a 2020 2020 662e 7772      """.    f.wr
+00015790: 6974 6528 6622 5242 4532 2020 2020 7b65  ite(f"RBE2    {e
+000157a0: 6964 3a38 647d 7b69 6e64 6570 3a38 647d  id:8d}{indep:8d}
+000157b0: 7b64 6f66 3a38 647d 2229 0a20 2020 2077  {dof:8d}").    w
+000157c0: 746e 6173 696e 7473 2866 2c20 352c 2064  tnasints(f, 5, d
+000157d0: 6570 290a 0a0a 4067 7569 746f 6f6c 732e  ep)...@guitools.
+000157e0: 7772 6974 655f 7465 7874 5f66 696c 650a  write_text_file.
+000157f0: 6465 6620 7774 7262 6533 2866 2c20 6569  def wtrbe3(f, ei
+00015800: 642c 2047 5249 445f 6465 702c 2044 4f46  d, GRID_dep, DOF
+00015810: 5f64 6570 2c20 496e 645f 4c69 7374 2c20  _dep, Ind_List, 
+00015820: 554d 5f4c 6973 743d 4e6f 6e65 2c20 616c  UM_List=None, al
+00015830: 7068 613d 4e6f 6e65 293a 0a20 2020 2022  pha=None):.    "
+00015840: 2222 0a20 2020 2057 7269 7465 7320 6120  "".    Writes a 
+00015850: 4e61 7374 7261 6e20 5242 4533 2063 6172  Nastran RBE3 car
+00015860: 6420 746f 2061 2066 696c 652e 0a0a 2020  d to a file...  
+00015870: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
+00015880: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
+00015890: 6620 3a20 7374 7269 6e67 206f 7220 6669  f : string or fi
+000158a0: 6c65 5f6c 696b 6520 6f72 2031 206f 7220  le_like or 1 or 
+000158b0: 4e6f 6e65 0a20 2020 2020 2020 2045 6974  None.        Eit
+000158c0: 6865 7220 6120 6e61 6d65 206f 6620 6120  her a name of a 
+000158d0: 6669 6c65 2c20 6f72 2069 7320 6120 6669  file, or is a fi
+000158e0: 6c65 5f6c 696b 6520 6f62 6a65 6374 2061  le_like object a
+000158f0: 7320 7265 7475 726e 6564 0a20 2020 2020  s returned.     
+00015900: 2020 2062 7920 3a66 756e 633a 606f 7065     by :func:`ope
+00015910: 6e60 206f 7220 3a63 6c61 7373 3a60 696f  n` or :class:`io
+00015920: 2e53 7472 696e 6749 4f60 2e20 496e 7075  .StringIO`. Inpu
+00015930: 7420 6173 2069 6e74 6567 6572 2031 2074  t as integer 1 t
+00015940: 6f0a 2020 2020 2020 2020 7772 6974 6520  o.        write 
+00015950: 746f 2073 7464 6f75 742e 2043 616e 2061  to stdout. Can a
+00015960: 6c73 6f20 6265 2074 6865 206e 616d 6520  lso be the name 
+00015970: 6f66 2061 2064 6972 6563 746f 7279 206f  of a directory o
+00015980: 7220 4e6f 6e65 3b0a 2020 2020 2020 2020  r None;.        
+00015990: 696e 2074 6865 7365 2063 6173 6573 2c20  in these cases, 
+000159a0: 6120 4755 4920 6973 206f 7065 6e65 6420  a GUI is opened 
+000159b0: 666f 7220 6669 6c65 2073 656c 6563 7469  for file selecti
+000159c0: 6f6e 2e0a 2020 2020 6569 6420 3a20 696e  on..    eid : in
+000159d0: 7465 6765 720a 2020 2020 2020 2020 456c  teger.        El
+000159e0: 656d 656e 7420 4944 0a20 2020 2047 5249  ement ID.    GRI
+000159f0: 445f 6465 7020 3a20 696e 7465 6765 720a  D_dep : integer.
+00015a00: 2020 2020 2020 2020 4465 7065 6e64 656e          Dependen
+00015a10: 7420 6772 6964 2049 440a 2020 2020 444f  t grid ID.    DO
+00015a20: 465f 6465 7020 3a20 696e 7465 6765 720a  F_dep : integer.
+00015a30: 2020 2020 2020 2020 416e 2069 6e74 6567          An integ
+00015a40: 6572 2063 6f6e 6361 7465 6e61 7469 6f6e  er concatenation
+00015a50: 206f 6620 7468 6520 444f 4620 2865 783a   of the DOF (ex:
+00015a60: 2031 3233 3435 3629 0a20 2020 2049 6e64   123456).    Ind
+00015a70: 5f4c 6973 7420 3a20 6c69 7374 0a20 2020  _List : list.   
+00015a80: 2020 2020 205b 2044 4f46 5f49 6e64 312c       [ DOF_Ind1,
+00015a90: 2047 5249 4453 5f49 6e64 312c 2044 4f46   GRIDS_Ind1, DOF
+00015aa0: 5f49 6e64 322c 2047 5249 4453 5f49 6e64  _Ind2, GRIDS_Ind
+00015ab0: 322c 202e 2e2e 205d 2c20 7768 6572 653a  2, ... ], where:
+00015ac0: 3a0a 0a20 2020 2020 2020 2020 2020 2044  :..            D
+00015ad0: 4f46 5f49 6e64 3120 2020 3a20 3120 6f72  OF_Ind1   : 1 or
+00015ae0: 2032 2065 6c65 6d65 6e74 2061 7272 6179   2 element array
+00015af0: 5f6c 696b 6520 636f 6e74 6169 6e69 6e67  _like containing
+00015b00: 2074 6865 0a20 2020 2020 2020 2020 2020   the.           
+00015b10: 2020 2020 2020 2020 2020 2020 2020 636f                co
+00015b20: 6d70 6f6e 656e 7420 444f 4620 2869 652c  mponent DOF (ie,
+00015b30: 2031 3233 3435 3629 206f 6620 7468 6520   123456) of the 
+00015b40: 6e6f 6465 7320 696e 0a20 2020 2020 2020  nodes in.       
+00015b50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015b60: 2020 4752 4944 535f 496e 6431 2061 6e64    GRIDS_Ind1 and
+00015b70: 2c20 6f70 7469 6f6e 616c 6c79 2c20 7468  , optionally, th
+00015b80: 6520 7765 6967 6874 696e 670a 2020 2020  e weighting.    
+00015b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015ba0: 2020 2020 2066 6163 746f 7220 666f 7220       factor for 
+00015bb0: 7468 6573 6520 444f 462e 2049 6620 6e6f  these DOF. If no
+00015bc0: 7420 696e 7075 742c 2074 6865 0a20 2020  t input, the.   
+00015bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015be0: 2020 2020 2020 7765 6967 6874 696e 6720        weighting 
+00015bf0: 6661 6374 6f72 2064 6566 6175 6c74 7320  factor defaults 
+00015c00: 746f 2031 2e30 2e0a 2020 2020 2020 2020  to 1.0..        
+00015c10: 2020 2020 4752 4944 535f 496e 6431 203a      GRIDS_Ind1 :
+00015c20: 2061 7272 6179 5f6c 696b 6520 6f66 206e   array_like of n
+00015c30: 6f64 6520 6964 7320 636f 7272 6573 706f  ode ids correspo
+00015c40: 6e64 696e 6720 746f 0a20 2020 2020 2020  nding to.       
+00015c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015c60: 2020 444f 465f 496e 6431 0a20 2020 2020    DOF_Ind1.     
+00015c70: 2020 2020 2020 202e 2e2e 0a20 2020 2020         ....     
+00015c80: 2020 2020 2020 2065 673a 2020 5b20 5b31         eg:  [ [1
+00015c90: 3233 2c20 312e 325d 2c20 5b39 352c 2031  23, 1.2], [95, 1
+00015ca0: 3935 2c20 3130 3030 5d2c 2031 3233 3435  95, 1000], 12345
+00015cb0: 362c 2039 355d 0a0a 2020 2020 2020 2020  6, 95]..        
+00015cc0: 6049 6e64 5f4c 6973 7460 206d 7573 7420  `Ind_List` must 
+00015cd0: 6265 2065 7665 6e20 6c65 6e67 7468 2e0a  be even length..
+00015ce0: 0a20 2020 2055 4d5f 4c69 7374 203a 204e  .    UM_List : N
+00015cf0: 6f6e 6520 6f72 206c 6973 743b 206f 7074  one or list; opt
+00015d00: 696f 6e61 6c0a 2020 2020 2020 2020 5b20  ional.        [ 
+00015d10: 4752 4944 5f4d 5345 5431 2c20 444f 465f  GRID_MSET1, DOF_
+00015d20: 4d53 4554 312c 2047 5249 445f 4d53 4554  MSET1, GRID_MSET
+00015d30: 322c 2044 4f46 5f4d 5345 5432 2c20 2e2e  2, DOF_MSET2, ..
+00015d40: 2e20 5d20 7768 6572 653a 3a0a 0a20 2020  . ] where::..   
+00015d50: 2020 2020 2020 2020 2020 2047 5249 445f             GRID_
+00015d60: 4d53 4554 3120 3a20 6669 7273 7420 6772  MSET1 : first gr
+00015d70: 6964 2069 6e20 7468 6520 4d2d 7365 740a  id in the M-set.
+00015d80: 2020 2020 2020 2020 2020 2020 2020 444f                DO
+00015d90: 465f 4d53 4554 3120 203a 2044 4f46 206f  F_MSET1  : DOF o
+00015da0: 6620 6669 7273 7420 6772 6964 2069 6e20  f first grid in 
+00015db0: 4d2d 7365 7420 2869 6e74 6567 6572 2073  M-set (integer s
+00015dc0: 7562 7365 740a 2020 2020 2020 2020 2020  ubset.          
+00015dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015de0: 206f 6620 3132 3334 3536 292e 204e 6f20   of 123456). No 
+00015df0: 7765 6967 6874 696e 6720 6661 6374 6f72  weighting factor
+00015e00: 7320 6172 650a 2020 2020 2020 2020 2020  s are.          
+00015e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015e20: 2061 6c6c 6f77 6564 2068 6572 652e 0a20   allowed here.. 
+00015e30: 2020 2020 2020 2020 2020 2020 2047 5249               GRI
+00015e40: 445f 4d53 4554 3220 3a20 7365 636f 6e64  D_MSET2 : second
+00015e50: 2067 7269 6420 696e 2074 6865 204d 2d73   grid in the M-s
+00015e60: 6574 0a20 2020 2020 2020 2020 2020 2020  et.             
+00015e70: 2044 4f46 5f4d 5345 5432 2020 3a20 444f   DOF_MSET2  : DO
+00015e80: 4620 6f66 2073 6563 6f6e 6420 6772 6964  F of second grid
+00015e90: 2069 6e20 4d2d 7365 740a 2020 2020 2020   in M-set.      
+00015ea0: 2020 2020 2020 2020 2e2e 2e0a 0a20 2020          .....   
+00015eb0: 2061 6c70 6861 203a 204e 6f6e 6520 6f72   alpha : None or
+00015ec0: 2073 7472 696e 673b 206f 7074 696f 6e61   string; optiona
+00015ed0: 6c0a 2020 2020 2020 2020 5468 6572 6d61  l.        Therma
+00015ee0: 6c20 6578 7061 6e73 696f 6e20 636f 6566  l expansion coef
+00015ef0: 6669 6369 656e 7420 696e 2061 2038 2d63  ficient in a 8-c
+00015f00: 6861 7220 7374 7269 6e67 2028 6f72 206c  har string (or l
+00015f10: 6573 7329 2e0a 0a20 2020 2052 6574 7572  ess)...    Retur
+00015f20: 6e73 0a20 2020 202d 2d2d 2d2d 2d2d 0a20  ns.    -------. 
+00015f30: 2020 204e 6f6e 650a 0a20 2020 2045 7861     None..    Exa
+00015f40: 6d70 6c65 730a 2020 2020 2d2d 2d2d 2d2d  mples.    ------
+00015f50: 2d2d 0a20 2020 203e 3e3e 2066 726f 6d20  --.    >>> from 
+00015f60: 7079 7965 7469 2069 6d70 6f72 7420 6e61  pyyeti import na
+00015f70: 7374 7261 6e0a 2020 2020 3e3e 3e20 6e61  stran.    >>> na
+00015f80: 7374 7261 6e2e 7774 7262 6533 2831 2c20  stran.wtrbe3(1, 
+00015f90: 3130 302c 2039 3930 302c 2031 3233 3435  100, 9900, 12345
+00015fa0: 362c 0a20 2020 202e 2e2e 2020 2020 2020  6,.    ...      
+00015fb0: 2020 2020 2020 2020 2020 5b31 3233 2c20            [123, 
+00015fc0: 5b39 3930 312c 2039 3930 322c 2039 3930  [9901, 9902, 990
+00015fd0: 332c 2039 3930 345d 2c0a 2020 2020 2e2e  3, 9904],.    ..
+00015fe0: 2e20 2020 2020 2020 2020 2020 2020 2020  .               
+00015ff0: 2020 3132 3334 3536 2c20 5b34 3530 3030    123456, [45000
+00016000: 312c 2032 3030 5d5d 290a 2020 2020 5242  1, 200]]).    RB
+00016010: 4533 2020 2020 2020 2020 2031 3030 2020  E3         100  
+00016020: 2020 2020 2020 2020 2020 3939 3030 2020            9900  
+00016030: 3132 3334 3536 2020 2031 2e30 3030 2020  123456   1.000  
+00016040: 2020 2031 3233 2020 2020 3939 3031 2020     123    9901  
+00016050: 2020 3939 3032 0a20 2020 2020 2020 2020    9902.         
+00016060: 2020 2020 2020 2039 3930 3320 2020 2039         9903    9
+00016070: 3930 3420 2020 312e 3030 3020 2031 3233  904   1.000  123
+00016080: 3435 3620 2034 3530 3030 3120 2020 2020  456  450001     
+00016090: 3230 300a 2020 2020 3e3e 3e20 6e61 7374  200.    >>> nast
+000160a0: 7261 6e2e 7774 7262 6533 2831 2c20 3130  ran.wtrbe3(1, 10
+000160b0: 302c 2039 3930 302c 2031 3233 3435 362c  0, 9900, 123456,
+000160c0: 0a20 2020 202e 2e2e 2020 2020 2020 2020  .    ...        
+000160d0: 2020 2020 2020 2020 5b31 3233 2c20 5b39          [123, [9
+000160e0: 3930 312c 2039 3930 322c 2039 3930 332c  901, 9902, 9903,
+000160f0: 2039 3930 345d 2c0a 2020 2020 2e2e 2e20   9904],.    ... 
+00016100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016110: 5b31 3233 3435 362c 2031 2e32 5d2c 205b  [123456, 1.2], [
+00016120: 3435 3030 3031 2c20 3230 305d 5d2c 0a20  450001, 200]],. 
+00016130: 2020 202e 2e2e 2020 2020 2020 2020 2020     ...          
+00016140: 2020 2020 2020 554d 5f4c 6973 743d 5b39        UM_List=[9
+00016150: 3930 312c 2031 322c 2039 3930 322c 2033  901, 12, 9902, 3
+00016160: 2c20 3939 3033 2c20 3132 2c20 3939 3034  , 9903, 12, 9904
+00016170: 2c20 335d 2c0a 2020 2020 2e2e 2e20 2020  , 3],.    ...   
+00016180: 2020 2020 2020 2020 2020 2020 2061 6c70               alp
+00016190: 6861 3d27 362e 3565 2d36 2729 0a20 2020  ha='6.5e-6').   
+000161a0: 2052 4245 3320 2020 2020 2020 2020 3130   RBE3         10
+000161b0: 3020 2020 2020 2020 2020 2020 2039 3930  0            990
+000161c0: 3020 2031 3233 3435 3620 2020 312e 3030  0  123456   1.00
+000161d0: 3020 2020 2020 3132 3320 2020 2039 3930  0     123    990
+000161e0: 3120 2020 2039 3930 320a 2020 2020 2020  1    9902.      
+000161f0: 2020 2020 2020 2020 2020 3939 3033 2020            9903  
+00016200: 2020 3939 3034 2020 2031 2e32 3030 2020    9904   1.200  
+00016210: 3132 3334 3536 2020 3435 3030 3031 2020  123456  450001  
+00016220: 2020 2032 3030 0a20 2020 2020 2020 2020     200.         
+00016230: 2020 2055 4d20 2020 2020 2020 2020 2039     UM          9
+00016240: 3930 3120 2020 2020 2031 3220 2020 2039  901      12    9
+00016250: 3930 3220 2020 2020 2020 3320 2020 2039  902       3    9
+00016260: 3930 3320 2020 2020 2031 320a 2020 2020  903      12.    
+00016270: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016280: 2020 2020 3939 3034 2020 2020 2020 2033      9904       3
+00016290: 0a20 2020 2020 2020 2020 2020 2041 4c50  .            ALP
+000162a0: 4841 2020 2020 2036 2e35 652d 360a 2020  HA     6.5e-6.  
+000162b0: 2020 2222 220a 2020 2020 6966 206c 656e    """.    if len
+000162c0: 2849 6e64 5f4c 6973 7429 2026 2031 3a0a  (Ind_List) & 1:.
+000162d0: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+000162e0: 6c75 6545 7272 6f72 2866 2260 496e 645f  lueError(f"`Ind_
+000162f0: 4c69 7374 6020 6d75 7374 2068 6176 6520  List` must have 
+00016300: 6576 656e 206c 656e 6774 6820 2869 7420  even length (it 
+00016310: 6973 207b 6c65 6e28 496e 645f 4c69 7374  is {len(Ind_List
+00016320: 297d 2922 290a 0a20 2020 2066 2e77 7269  )})")..    f.wri
+00016330: 7465 2866 2252 4245 3320 2020 207b 6569  te(f"RBE3    {ei
+00016340: 643a 3864 7d20 2020 2020 2020 207b 4752  d:8d}        {GR
+00016350: 4944 5f64 6570 3a38 647d 7b44 4f46 5f64  ID_dep:8d}{DOF_d
+00016360: 6570 3a38 647d 2229 0a20 2020 2066 6965  ep:8d}").    fie
+00016370: 6c64 203d 2035 0a0a 2020 2020 6465 6620  ld = 5..    def 
+00016380: 5f49 6e63 5f46 6965 6c64 2866 2c20 6669  _Inc_Field(f, fi
+00016390: 656c 6429 3a0a 2020 2020 2020 2020 6669  eld):.        fi
+000163a0: 656c 6420 2b3d 2031 0a20 2020 2020 2020  eld += 1.       
+000163b0: 2069 6620 6669 656c 6420 3d3d 2031 303a   if field == 10:
+000163c0: 0a20 2020 2020 2020 2020 2020 2066 2e77  .            f.w
+000163d0: 7269 7465 2822 5c6e 2020 2020 2020 2020  rite("\n        
+000163e0: 2229 0a20 2020 2020 2020 2020 2020 2066  ").            f
+000163f0: 6965 6c64 203d 2032 0a20 2020 2020 2020  ield = 2.       
+00016400: 2072 6574 7572 6e20 6669 656c 640a 0a20   return field.. 
+00016410: 2020 2023 206c 6f6f 7020 6f76 6572 2069     # loop over i
+00016420: 6e64 6570 656e 6465 6e74 730a 2020 2020  ndependents.    
+00016430: 666f 7220 6a20 696e 2072 616e 6765 2830  for j in range(0
+00016440: 2c20 6c65 6e28 496e 645f 4c69 7374 292c  , len(Ind_List),
+00016450: 2032 293a 0a20 2020 2020 2020 2044 4f46   2):.        DOF
+00016460: 5f69 6e64 203d 206e 702e 6174 6c65 6173  _ind = np.atleas
+00016470: 745f 3164 2849 6e64 5f4c 6973 745b 6a5d  t_1d(Ind_List[j]
+00016480: 290a 2020 2020 2020 2020 4752 4944 535f  ).        GRIDS_
+00016490: 696e 6420 3d20 6e70 2e61 746c 6561 7374  ind = np.atleast
+000164a0: 5f31 6428 496e 645f 4c69 7374 5b6a 202b  _1d(Ind_List[j +
+000164b0: 2031 5d29 0a20 2020 2020 2020 2064 6f66   1]).        dof
+000164c0: 203d 2069 6e74 2844 4f46 5f69 6e64 5b30   = int(DOF_ind[0
+000164d0: 5d29 0a20 2020 2020 2020 2069 6620 6c65  ]).        if le
+000164e0: 6e28 444f 465f 696e 6429 203d 3d20 323a  n(DOF_ind) == 2:
+000164f0: 0a20 2020 2020 2020 2020 2020 2077 7420  .            wt 
+00016500: 3d20 666c 6f61 7428 444f 465f 696e 645b  = float(DOF_ind[
+00016510: 315d 290a 2020 2020 2020 2020 656c 7365  1]).        else
+00016520: 3a0a 2020 2020 2020 2020 2020 2020 7774  :.            wt
+00016530: 203d 2031 2e30 0a20 2020 2020 2020 2066   = 1.0.        f
+00016540: 6965 6c64 203d 205f 496e 635f 4669 656c  ield = _Inc_Fiel
+00016550: 6428 662c 2066 6965 6c64 290a 2020 2020  d(f, field).    
+00016560: 2020 2020 662e 7772 6974 6528 6622 7b77      f.write(f"{w
+00016570: 743a 382e 3366 7d22 290a 2020 2020 2020  t:8.3f}").      
+00016580: 2020 6669 656c 6420 3d20 5f49 6e63 5f46    field = _Inc_F
+00016590: 6965 6c64 2866 2c20 6669 656c 6429 0a20  ield(f, field). 
+000165a0: 2020 2020 2020 2066 2e77 7269 7465 2866         f.write(f
+000165b0: 227b 646f 663a 3864 7d22 290a 2020 2020  "{dof:8d}").    
+000165c0: 2020 2020 666f 7220 6720 696e 2047 5249      for g in GRI
+000165d0: 4453 5f69 6e64 3a0a 2020 2020 2020 2020  DS_ind:.        
+000165e0: 2020 2020 6669 656c 6420 3d20 5f49 6e63      field = _Inc
+000165f0: 5f46 6965 6c64 2866 2c20 6669 656c 6429  _Field(f, field)
+00016600: 0a20 2020 2020 2020 2020 2020 2066 2e77  .            f.w
+00016610: 7269 7465 2866 227b 673a 3864 7d22 290a  rite(f"{g:8d}").
+00016620: 2020 2020 662e 7772 6974 6528 225c 6e22      f.write("\n"
+00016630: 290a 0a20 2020 2064 6566 205f 496e 635f  )..    def _Inc_
+00016640: 554d 5f46 6965 6c64 2866 2c20 6669 656c  UM_Field(f, fiel
+00016650: 6429 3a0a 2020 2020 2020 2020 6669 656c  d):.        fiel
+00016660: 6420 2b3d 2031 0a20 2020 2020 2020 2069  d += 1.        i
+00016670: 6620 6669 656c 6420 3d3d 2039 3a0a 2020  f field == 9:.  
+00016680: 2020 2020 2020 2020 2020 662e 7772 6974            f.writ
+00016690: 6528 225c 6e20 2020 2020 2020 2020 2020  e("\n           
+000166a0: 2020 2020 2022 290a 2020 2020 2020 2020       ").        
+000166b0: 2020 2020 6669 656c 6420 3d20 330a 2020      field = 3.  
+000166c0: 2020 2020 2020 7265 7475 726e 2066 6965        return fie
+000166d0: 6c64 0a0a 2020 2020 6966 2055 4d5f 4c69  ld..    if UM_Li
+000166e0: 7374 2069 7320 6e6f 7420 4e6f 6e65 3a0a  st is not None:.
+000166f0: 2020 2020 2020 2020 662e 7772 6974 6528          f.write(
+00016700: 2220 2020 2020 2020 2055 4d20 2020 2020  "        UM     
+00016710: 2022 290a 2020 2020 2020 2020 6669 656c   ").        fiel
+00016720: 6420 3d20 320a 2020 2020 2020 2020 666f  d = 2.        fo
+00016730: 7220 6a20 696e 2055 4d5f 4c69 7374 3a0a  r j in UM_List:.
+00016740: 2020 2020 2020 2020 2020 2020 6669 656c              fiel
+00016750: 6420 3d20 5f49 6e63 5f55 4d5f 4669 656c  d = _Inc_UM_Fiel
+00016760: 6428 662c 2066 6965 6c64 290a 2020 2020  d(f, field).    
+00016770: 2020 2020 2020 2020 662e 7772 6974 6528          f.write(
+00016780: 227b 3a38 647d 222e 666f 726d 6174 286a  "{:8d}".format(j
+00016790: 2929 0a20 2020 2020 2020 2066 2e77 7269  )).        f.wri
+000167a0: 7465 2822 5c6e 2229 0a0a 2020 2020 6966  te("\n")..    if
+000167b0: 2061 6c70 6861 2069 7320 6e6f 7420 4e6f   alpha is not No
+000167c0: 6e65 3a0a 2020 2020 2020 2020 662e 7772  ne:.        f.wr
+000167d0: 6974 6528 6622 2020 2020 2020 2020 414c  ite(f"        AL
+000167e0: 5048 4120 2020 7b61 6c70 6861 3a3e 3873  PHA   {alpha:>8s
+000167f0: 7d5c 6e22 290a 0a0a 4067 7569 746f 6f6c  }\n")...@guitool
+00016800: 732e 7772 6974 655f 7465 7874 5f66 696c  s.write_text_fil
+00016810: 650a 6465 6620 7774 7365 7365 7428 662c  e.def wtseset(f,
+00016820: 2073 7570 6572 6964 2c20 6772 6964 7329   superid, grids)
+00016830: 3a0a 2020 2020 2222 220a 2020 2020 5772  :.    """.    Wr
+00016840: 6974 6573 2061 204e 6173 7472 616e 2053  ites a Nastran S
+00016850: 4553 4554 2063 6172 6420 746f 2061 2066  ESET card to a f
+00016860: 696c 652e 0a0a 2020 2020 5061 7261 6d65  ile...    Parame
+00016870: 7465 7273 0a20 2020 202d 2d2d 2d2d 2d2d  ters.    -------
+00016880: 2d2d 2d0a 2020 2020 6620 3a20 7374 7269  ---.    f : stri
+00016890: 6e67 206f 7220 6669 6c65 5f6c 696b 6520  ng or file_like 
+000168a0: 6f72 2031 206f 7220 4e6f 6e65 0a20 2020  or 1 or None.   
+000168b0: 2020 2020 2045 6974 6865 7220 6120 6e61       Either a na
+000168c0: 6d65 206f 6620 6120 6669 6c65 2c20 6f72  me of a file, or
+000168d0: 2069 7320 6120 6669 6c65 5f6c 696b 6520   is a file_like 
+000168e0: 6f62 6a65 6374 2061 7320 7265 7475 726e  object as return
+000168f0: 6564 0a20 2020 2020 2020 2062 7920 3a66  ed.        by :f
+00016900: 756e 633a 606f 7065 6e60 206f 7220 3a63  unc:`open` or :c
+00016910: 6c61 7373 3a60 696f 2e53 7472 696e 6749  lass:`io.StringI
+00016920: 4f60 2e20 496e 7075 7420 6173 2069 6e74  O`. Input as int
+00016930: 6567 6572 2031 2074 6f0a 2020 2020 2020  eger 1 to.      
+00016940: 2020 7772 6974 6520 746f 2073 7464 6f75    write to stdou
+00016950: 742e 2043 616e 2061 6c73 6f20 6265 2074  t. Can also be t
+00016960: 6865 206e 616d 6520 6f66 2061 2064 6972  he name of a dir
+00016970: 6563 746f 7279 206f 7220 4e6f 6e65 3b0a  ectory or None;.
+00016980: 2020 2020 2020 2020 696e 2074 6865 7365          in these
+00016990: 2063 6173 6573 2c20 6120 4755 4920 6973   cases, a GUI is
+000169a0: 206f 7065 6e65 6420 666f 7220 6669 6c65   opened for file
+000169b0: 2073 656c 6563 7469 6f6e 2e0a 2020 2020   selection..    
+000169c0: 7375 7065 7269 643a 2069 6e74 6567 6572  superid: integer
+000169d0: 0a20 2020 2020 2020 2053 7570 6572 656c  .        Superel
+000169e0: 656d 656e 7420 4944 0a20 2020 2067 7269  ement ID.    gri
+000169f0: 6473 203a 2031 6420 6172 7261 795f 6c69  ds : 1d array_li
+00016a00: 6b65 0a20 2020 2020 2020 2056 6563 746f  ke.        Vecto
+00016a10: 7220 6f66 2067 7269 6420 6964 732e 0a0a  r of grid ids...
+00016a20: 2020 2020 5265 7475 726e 730a 2020 2020      Returns.    
+00016a30: 2d2d 2d2d 2d2d 2d0a 2020 2020 4e6f 6e65  -------.    None
+00016a40: 0a0a 2020 2020 4578 616d 706c 6573 0a20  ..    Examples. 
+00016a50: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
+00016a60: 3e3e 3e20 6672 6f6d 2070 7979 6574 6920  >>> from pyyeti 
+00016a70: 696d 706f 7274 206e 6173 7472 616e 0a20  import nastran. 
+00016a80: 2020 203e 3e3e 2069 6d70 6f72 7420 6e75     >>> import nu
+00016a90: 6d70 7920 6173 206e 700a 2020 2020 3e3e  mpy as np.    >>
+00016aa0: 3e20 6e61 7374 7261 6e2e 7774 7365 7365  > nastran.wtsese
+00016ab0: 7428 312c 2031 3030 2c20 6e70 2e61 7261  t(1, 100, np.ara
+00016ac0: 6e67 6528 312c 2032 3629 290a 2020 2020  nge(1, 26)).    
+00016ad0: 5345 5345 5420 2020 2020 2020 2031 3030  SESET        100
+00016ae0: 2020 2020 2020 2031 2020 2020 2020 2032         1       2
+00016af0: 2020 2020 2020 2033 2020 2020 2020 2034         3       4
+00016b00: 2020 2020 2020 2035 2020 2020 2020 2036         5       6
+00016b10: 2020 2020 2020 2037 0a20 2020 2053 4553         7.    SES
+00016b20: 4554 2020 2020 2020 2020 3130 3020 2020  ET        100   
+00016b30: 2020 2020 3820 2020 2020 2020 3920 2020      8       9   
+00016b40: 2020 2031 3020 2020 2020 2031 3120 2020     10      11   
+00016b50: 2020 2031 3220 2020 2020 2031 3320 2020     12      13   
+00016b60: 2020 2031 340a 2020 2020 5345 5345 5420     14.    SESET 
+00016b70: 2020 2020 2020 2031 3030 2020 2020 2020         100      
+00016b80: 3135 2020 2020 2020 3136 2020 2020 2020  15      16      
+00016b90: 3137 2020 2020 2020 3138 2020 2020 2020  17      18      
+00016ba0: 3139 2020 2020 2020 3230 2020 2020 2020  19      20      
+00016bb0: 3231 0a20 2020 2053 4553 4554 2020 2020  21.    SESET    
+00016bc0: 2020 2020 3130 3020 2020 2020 2032 3220      100      22 
+00016bd0: 2020 2020 2032 3320 2020 2020 2032 3420       23      24 
+00016be0: 2020 2020 2032 350a 2020 2020 2222 220a       25.    """.
+00016bf0: 2020 2020 6e20 3d20 6c65 6e28 6772 6964      n = len(grid
+00016c00: 7329 0a20 2020 2023 2037 2067 7269 6473  s).    # 7 grids
+00016c10: 2070 6572 2053 4553 4554 3a0a 2020 2020   per SESET:.    
+00016c20: 6672 6d20 3d20 2253 4553 4554 2020 207b  frm = "SESET   {
+00016c30: 3a38 647d 2220 2b20 227b 3a38 647d 2220  :8d}" + "{:8d}" 
+00016c40: 2a20 3720 2b20 225c 6e22 0a20 2020 2069  * 7 + "\n".    i
+00016c50: 203d 2030 0a20 2020 2077 6869 6c65 2069   = 0.    while i
+00016c60: 202b 2037 203c 3d20 6e3a 0a20 2020 2020   + 7 <= n:.     
+00016c70: 2020 2066 2e77 7269 7465 2866 726d 2e66     f.write(frm.f
+00016c80: 6f72 6d61 7428 7375 7065 7269 642c 202a  ormat(superid, *
+00016c90: 6772 6964 735b 6920 3a20 6920 2b20 375d  grids[i : i + 7]
+00016ca0: 2929 0a20 2020 2020 2020 2069 202b 3d20  )).        i += 
+00016cb0: 370a 2020 2020 6966 2069 203c 206e 3a0a  7.    if i < n:.
+00016cc0: 2020 2020 2020 2020 6672 6d20 3d20 2253          frm = "S
+00016cd0: 4553 4554 2020 207b 3a38 647d 2220 2b20  ESET   {:8d}" + 
+00016ce0: 227b 3a38 647d 2220 2a20 286e 202d 2069  "{:8d}" * (n - i
+00016cf0: 2920 2b20 225c 6e22 0a20 2020 2020 2020  ) + "\n".       
+00016d00: 2066 2e77 7269 7465 2866 726d 2e66 6f72   f.write(frm.for
+00016d10: 6d61 7428 7375 7065 7269 642c 202a 6772  mat(superid, *gr
+00016d20: 6964 735b 693a 5d29 290a 0a0a 4067 7569  ids[i:]))...@gui
+00016d30: 746f 6f6c 732e 7772 6974 655f 7465 7874  tools.write_text
+00016d40: 5f66 696c 650a 6465 6620 7774 7365 7428  _file.def wtset(
+00016d50: 662c 2073 6574 6964 2c20 6964 7329 3a0a  f, setid, ids):.
+00016d60: 2020 2020 2222 220a 2020 2020 5772 6974      """.    Writ
+00016d70: 6573 2061 204e 6173 7472 616e 2063 6173  es a Nastran cas
+00016d80: 652d 636f 6e74 726f 6c20 5345 5420 6361  e-control SET ca
+00016d90: 7264 2074 6f20 6120 6669 6c65 2e0a 0a20  rd to a file... 
+00016da0: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
+00016db0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
+00016dc0: 2066 203a 2073 7472 696e 6720 6f72 2066   f : string or f
+00016dd0: 696c 655f 6c69 6b65 206f 7220 3120 6f72  ile_like or 1 or
+00016de0: 204e 6f6e 650a 2020 2020 2020 2020 4569   None.        Ei
+00016df0: 7468 6572 2061 206e 616d 6520 6f66 2061  ther a name of a
+00016e00: 2066 696c 652c 206f 7220 6973 2061 2066   file, or is a f
+00016e10: 696c 655f 6c69 6b65 206f 626a 6563 7420  ile_like object 
+00016e20: 6173 2072 6574 7572 6e65 640a 2020 2020  as returned.    
+00016e30: 2020 2020 6279 203a 6675 6e63 3a60 6f70      by :func:`op
+00016e40: 656e 6020 6f72 203a 636c 6173 733a 6069  en` or :class:`i
+00016e50: 6f2e 5374 7269 6e67 494f 602e 2049 6e70  o.StringIO`. Inp
+00016e60: 7574 2061 7320 696e 7465 6765 7220 3120  ut as integer 1 
+00016e70: 746f 0a20 2020 2020 2020 2077 7269 7465  to.        write
+00016e80: 2074 6f20 7374 646f 7574 2e20 4361 6e20   to stdout. Can 
+00016e90: 616c 736f 2062 6520 7468 6520 6e61 6d65  also be the name
+00016ea0: 206f 6620 6120 6469 7265 6374 6f72 7920   of a directory 
+00016eb0: 6f72 204e 6f6e 653b 0a20 2020 2020 2020  or None;.       
+00016ec0: 2069 6e20 7468 6573 6520 6361 7365 732c   in these cases,
+00016ed0: 2061 2047 5549 2069 7320 6f70 656e 6564   a GUI is opened
+00016ee0: 2066 6f72 2066 696c 6520 7365 6c65 6374   for file select
+00016ef0: 696f 6e2e 0a20 2020 2073 6574 6964 3a20  ion..    setid: 
+00016f00: 696e 7465 6765 720a 2020 2020 2020 2020  integer.        
+00016f10: 5365 7420 4944 0a20 2020 2069 6473 203a  Set ID.    ids :
+00016f20: 2031 6420 6172 7261 795f 6c69 6b65 0a20   1d array_like. 
+00016f30: 2020 2020 2020 2056 6563 746f 7220 6f66         Vector of
+00016f40: 2049 4473 0a0a 2020 2020 5265 7475 726e   IDs..    Return
+00016f50: 730a 2020 2020 2d2d 2d2d 2d2d 2d0a 2020  s.    -------.  
+00016f60: 2020 4e6f 6e65 0a0a 2020 2020 4578 616d    None..    Exam
+00016f70: 706c 6573 0a20 2020 202d 2d2d 2d2d 2d2d  ples.    -------
+00016f80: 2d0a 2020 2020 3e3e 3e20 6672 6f6d 2070  -.    >>> from p
+00016f90: 7979 6574 6920 696d 706f 7274 206e 6173  yyeti import nas
+00016fa0: 7472 616e 0a20 2020 203e 3e3e 2069 6d70  tran.    >>> imp
+00016fb0: 6f72 7420 6e75 6d70 7920 6173 206e 700a  ort numpy as np.
+00016fc0: 2020 2020 3e3e 3e20 6e61 7374 7261 6e2e      >>> nastran.
+00016fd0: 7774 7365 7428 312c 2031 3030 2c20 6e70  wtset(1, 100, np
+00016fe0: 2e61 7261 6e67 6528 312c 2032 3629 290a  .arange(1, 26)).
+00016ff0: 2020 2020 5345 5420 3130 3020 3d20 312c      SET 100 = 1,
+00017000: 2032 2c20 332c 2034 2c20 352c 2036 2c20   2, 3, 4, 5, 6, 
+00017010: 372c 0a20 2020 2020 382c 2039 2c20 3130  7,.     8, 9, 10
+00017020: 2c20 3131 2c20 3132 2c20 3133 2c20 3134  , 11, 12, 13, 14
+00017030: 2c0a 2020 2020 2031 352c 2031 362c 2031  ,.     15, 16, 1
+00017040: 372c 2031 382c 2031 392c 2032 302c 2032  7, 18, 19, 20, 2
+00017050: 312c 0a20 2020 2020 3232 2c20 3233 2c20  1,.     22, 23, 
+00017060: 3234 2c20 3235 0a20 2020 2022 2222 0a20  24, 25.    """. 
+00017070: 2020 2066 2e77 7269 7465 2866 2253 4554     f.write(f"SET
+00017080: 207b 7365 7469 647d 203d 2229 0a20 2020   {setid} =").   
+00017090: 206e 203d 206c 656e 2869 6473 290a 2020   n = len(ids).  
+000170a0: 2020 2320 3720 6964 7320 7065 7220 6c69    # 7 ids per li
+000170b0: 6e65 3a0a 2020 2020 6672 6d20 3d20 2220  ne:.    frm = " 
+000170c0: 7b3a 647d 2c22 202a 2037 202b 2022 5c6e  {:d}," * 7 + "\n
+000170d0: 220a 2020 2020 6920 3d20 300a 2020 2020  ".    i = 0.    
+000170e0: 7768 696c 6520 6920 2b20 3720 3c20 6e3a  while i + 7 < n:
+000170f0: 0a20 2020 2020 2020 2066 2e77 7269 7465  .        f.write
+00017100: 2866 726d 2e66 6f72 6d61 7428 2a69 6473  (frm.format(*ids
+00017110: 5b69 203a 2069 202b 2037 5d29 290a 2020  [i : i + 7])).  
+00017120: 2020 2020 2020 6920 2b3d 2037 0a20 2020        i += 7.   
+00017130: 2066 726d 203d 2022 207b 3a64 7d2c 2220   frm = " {:d}," 
+00017140: 2a20 286e 202d 2069 202d 2031 2920 2b20  * (n - i - 1) + 
+00017150: 2220 7b3a 647d 5c6e 220a 2020 2020 662e  " {:d}\n".    f.
+00017160: 7772 6974 6528 6672 6d2e 666f 726d 6174  write(frm.format
+00017170: 282a 6964 735b 693a 5d29 290a 0a0a 4067  (*ids[i:]))...@g
+00017180: 7569 746f 6f6c 732e 7772 6974 655f 7465  uitools.write_te
+00017190: 7874 5f66 696c 650a 6465 6620 7774 7273  xt_file.def wtrs
+000171a0: 706c 696e 6528 662c 2072 6964 2c20 6964  pline(f, rid, id
+000171b0: 732c 2044 6f4c 3d22 302e 3122 293a 0a20  s, DoL="0.1"):. 
+000171c0: 2020 2022 2222 0a20 2020 2057 7269 7465     """.    Write
+000171d0: 204e 6173 7472 616e 2052 5350 4c49 4e45   Nastran RSPLINE
+000171e0: 2063 6172 6428 7329 2e0a 0a20 2020 2050   card(s)...    P
+000171f0: 6172 616d 6574 6572 730a 2020 2020 2d2d  arameters.    --
+00017200: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2066 203a  --------.    f :
+00017210: 2073 7472 696e 6720 6f72 2066 696c 655f   string or file_
+00017220: 6c69 6b65 206f 7220 3120 6f72 204e 6f6e  like or 1 or Non
+00017230: 650a 2020 2020 2020 2020 4569 7468 6572  e.        Either
+00017240: 2061 206e 616d 6520 6f66 2061 2066 696c   a name of a fil
+00017250: 652c 206f 7220 6973 2061 2066 696c 655f  e, or is a file_
+00017260: 6c69 6b65 206f 626a 6563 7420 6173 2072  like object as r
+00017270: 6574 7572 6e65 640a 2020 2020 2020 2020  eturned.        
+00017280: 6279 203a 6675 6e63 3a60 6f70 656e 6020  by :func:`open` 
+00017290: 6f72 203a 636c 6173 733a 6069 6f2e 5374  or :class:`io.St
+000172a0: 7269 6e67 494f 602e 2049 6e70 7574 2061  ringIO`. Input a
+000172b0: 7320 696e 7465 6765 7220 3120 746f 0a20  s integer 1 to. 
+000172c0: 2020 2020 2020 2077 7269 7465 2074 6f20         write to 
+000172d0: 7374 646f 7574 2e20 4361 6e20 616c 736f  stdout. Can also
+000172e0: 2062 6520 7468 6520 6e61 6d65 206f 6620   be the name of 
+000172f0: 6120 6469 7265 6374 6f72 7920 6f72 204e  a directory or N
+00017300: 6f6e 653b 0a20 2020 2020 2020 2069 6e20  one;.        in 
+00017310: 7468 6573 6520 6361 7365 732c 2061 2047  these cases, a G
+00017320: 5549 2069 7320 6f70 656e 6564 2066 6f72  UI is opened for
+00017330: 2066 696c 6520 7365 6c65 6374 696f 6e2e   file selection.
+00017340: 0a20 2020 2072 6964 203a 2069 6e74 6567  .    rid : integ
+00017350: 6572 0a20 2020 2020 2020 2049 4420 666f  er.        ID fo
+00017360: 7220 3173 7420 5253 504c 494e 453b 2067  r 1st RSPLINE; g
+00017370: 6574 7320 696e 6372 656d 656e 7465 6420  ets incremented 
+00017380: 6279 2031 2066 6f72 2065 6163 6820 5253  by 1 for each RS
+00017390: 504c 494e 450a 2020 2020 6964 7320 3a20  PLINE.    ids : 
+000173a0: 3264 2061 7272 6179 5f6c 696b 650a 2020  2d array_like.  
+000173b0: 2020 2020 2020 3220 636f 6c75 6d6e 206d        2 column m
+000173c0: 6174 7269 783a 205b 6772 6964 5f69 6473  atrix: [grid_ids
+000173d0: 2c20 696e 6465 7065 6e64 656e 745f 666c  , independent_fl
+000173e0: 6167 5d3b 2068 6173 2067 7269 6473 2066  ag]; has grids f
+000173f0: 6f72 0a20 2020 2020 2020 2052 5350 4c49  or.        RSPLI
+00017400: 4e45 2069 6e20 6465 7369 7265 6420 6f72  NE in desired or
+00017410: 6465 7220 616e 6420 6120 3020 6f72 2031  der and a 0 or 1
+00017420: 2066 6c61 6720 666f 7220 6561 6368 2077   flag for each w
+00017430: 6865 7265 2031 0a20 2020 2020 2020 206d  here 1.        m
+00017440: 6561 6e73 2074 6865 2067 7269 6420 6973  eans the grid is
+00017450: 2069 6e64 6570 656e 6465 6e74 2e20 4e6f   independent. No
+00017460: 7465 3a20 7468 6520 3173 7420 616e 6420  te: the 1st and 
+00017470: 6c61 7374 2067 7269 6473 0a20 2020 2020  last grids.     
+00017480: 2020 206d 7573 7420 6265 2069 6e64 6570     must be indep
+00017490: 656e 6465 6e74 2e0a 2020 2020 446f 4c20  endent..    DoL 
+000174a0: 3a20 7374 7269 6e67 206f 7220 7265 616c  : string or real
+000174b0: 2073 6361 6c61 720a 2020 2020 2020 2020   scalar.        
+000174c0: 5370 6563 6966 6965 7320 7261 7469 6f20  Specifies ratio 
+000174d0: 6f66 2064 6961 6d65 7465 7220 6f66 2065  of diameter of e
+000174e0: 6c61 7374 6963 2074 7562 6520 746f 2074  lastic tube to t
+000174f0: 6865 2073 756d 206f 6620 7468 650a 2020  he sum of the.  
+00017500: 2020 2020 2020 6c65 6e67 7468 7320 6f66        lengths of
+00017510: 2061 6c6c 2073 6567 6d65 6e74 732e 2057   all segments. W
+00017520: 7269 7474 656e 2077 6974 683a 2060 6066  ritten with: ``f
+00017530: 277b 446f 4c3a 3c38 7d27 6060 0a0a 2020  '{DoL:<8}'``..  
+00017540: 2020 5265 7475 726e 730a 2020 2020 2d2d    Returns.    --
+00017550: 2d2d 2d2d 2d0a 2020 2020 4e6f 6e65 0a0a  -----.    None..
+00017560: 2020 2020 4e6f 7465 730a 2020 2020 2d2d      Notes.    --
+00017570: 2d2d 2d0a 2020 2020 5468 6520 5253 504c  ---.    The RSPL
+00017580: 494e 4573 2077 696c 6c20 666f 6c6c 6f77  INEs will follow
+00017590: 2074 6869 7320 7061 7474 6572 6e3a 3a0a   this pattern::.
+000175a0: 0a20 2020 2020 2020 2052 5350 4c49 4e45  .        RSPLINE
+000175b0: 3120 2069 6e64 6570 656e 6465 6e74 3120  1  independent1 
+000175c0: 2d20 6465 7065 6e64 656e 7473 3120 2d20  - dependents1 - 
+000175d0: 696e 6465 7065 6e64 656e 7432 0a20 2020  independent2.   
+000175e0: 2020 2020 2052 5350 4c49 4e45 3220 2069       RSPLINE2  i
+000175f0: 6e64 6570 656e 6465 6e74 3220 2d20 6465  ndependent2 - de
+00017600: 7065 6e64 656e 7473 3220 2d20 696e 6465  pendents2 - inde
+00017610: 7065 6e64 656e 7433 0a20 2020 2020 2020  pendent3.       
+00017620: 202e 2e2e 0a0a 2020 2020 4e6f 7465 2074   .....    Note t
+00017630: 6861 7420 7468 6572 6520 6361 6e20 6265  hat there can be
+00017640: 206d 756c 7469 706c 6520 6465 7065 6e64   multiple depend
+00017650: 656e 7473 2073 616e 6477 6963 6865 6420  ents sandwiched 
+00017660: 6265 7477 6565 6e20 7468 650a 2020 2020  between the.    
+00017670: 7477 6f20 6f75 7473 6964 6520 696e 6465  two outside inde
+00017680: 7065 6e64 656e 7420 6e6f 6465 7320 7065  pendent nodes pe
+00017690: 7220 5253 504c 494e 452e 0a0a 2020 2020  r RSPLINE...    
+000176a0: 5468 6520 7370 6c69 6e65 2065 6c65 6d65  The spline eleme
+000176b0: 6e74 2061 7373 756d 6573 2061 206c 696e  nt assumes a lin
+000176c0: 6561 7220 696e 7465 7270 6f6c 6174 696f  ear interpolatio
+000176d0: 6e20 666f 7220 6469 7370 6c61 6365 6d65  n for displaceme
+000176e0: 6e74 0a20 2020 2061 6e64 2074 6f72 7369  nt.    and torsi
+000176f0: 6f6e 2061 6c6f 6e67 2074 6865 2061 7869  on along the axi
+00017700: 7320 6f66 2074 6865 2073 706c 696e 652c  s of the spline,
+00017710: 2061 2071 7561 6472 6174 6963 0a20 2020   a quadratic.   
+00017720: 2069 6e74 6572 706f 6c61 7469 6f6e 2066   interpolation f
+00017730: 6f72 2072 6f74 6174 696f 6e73 206e 6f72  or rotations nor
+00017740: 6d61 6c20 746f 2074 6865 2061 7869 7320  mal to the axis 
+00017750: 6f66 2074 6865 2073 706c 696e 652c 2061  of the spline, a
+00017760: 6e64 0a20 2020 2061 2063 7562 6963 2069  nd.    a cubic i
+00017770: 6e74 6572 706f 6c61 7469 6f6e 2066 6f72  nterpolation for
+00017780: 2064 6973 706c 6163 656d 656e 7473 206e   displacements n
+00017790: 6f72 6d61 6c20 746f 2074 6865 2061 7869  ormal to the axi
+000177a0: 7320 6f66 2074 6865 0a20 2020 2073 706c  s of the.    spl
+000177b0: 696e 652e 0a0a 2020 2020 5365 6520 616c  ine...    See al
+000177c0: 736f 0a20 2020 202d 2d2d 2d2d 2d2d 2d0a  so.    --------.
+000177d0: 2020 2020 3a66 756e 633a 6077 7472 7370      :func:`wtrsp
+000177e0: 6c69 6e65 5f72 696e 6773 600a 0a20 2020  line_rings`..   
+000177f0: 2052 6169 7365 730a 2020 2020 2d2d 2d2d   Raises.    ----
+00017800: 2d2d 0a20 2020 2056 616c 7565 4572 726f  --.    ValueErro
+00017810: 720a 0a20 2020 2020 2020 2049 6620 7468  r..        If th
+00017820: 6572 6520 6172 6520 6c65 7373 2074 6861  ere are less tha
+00017830: 6e20 3320 6772 6964 7320 666f 7220 5253  n 3 grids for RS
+00017840: 504c 494e 452e 0a0a 2020 2020 2020 2020  PLINE...        
+00017850: 4966 2065 6974 6865 7220 7468 6520 6669  If either the fi
+00017860: 7273 7420 6f72 206c 6173 7420 6772 6964  rst or last grid
+00017870: 7320 6973 2064 6570 656e 6465 6e74 2e0a  s is dependent..
+00017880: 0a20 2020 2045 7861 6d70 6c65 730a 2020  .    Examples.  
+00017890: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 203e    --------.    >
+000178a0: 3e3e 2069 6d70 6f72 7420 6e75 6d70 7920  >> import numpy 
+000178b0: 6173 206e 700a 2020 2020 3e3e 3e20 6672  as np.    >>> fr
+000178c0: 6f6d 2070 7979 6574 6920 696d 706f 7274  om pyyeti import
+000178d0: 206e 6173 7472 616e 0a20 2020 203e 3e3e   nastran.    >>>
+000178e0: 2069 6473 203d 206e 702e 6172 7261 7928   ids = np.array(
+000178f0: 5b5b 3130 302c 2031 5d2c 0a20 2020 202e  [[100, 1],.    .
+00017900: 2e2e 2020 2020 2020 2020 2020 2020 2020  ..              
+00017910: 2020 205b 3130 312c 2030 5d2c 0a20 2020     [101, 0],.   
+00017920: 202e 2e2e 2020 2020 2020 2020 2020 2020   ...            
+00017930: 2020 2020 205b 3130 322c 2030 5d2c 0a20       [102, 0],. 
+00017940: 2020 202e 2e2e 2020 2020 2020 2020 2020     ...          
+00017950: 2020 2020 2020 205b 3130 332c 2031 5d2c         [103, 1],
+00017960: 0a20 2020 202e 2e2e 2020 2020 2020 2020  .    ...        
+00017970: 2020 2020 2020 2020 205b 3130 342c 2030           [104, 0
+00017980: 5d2c 0a20 2020 202e 2e2e 2020 2020 2020  ],.    ...      
+00017990: 2020 2020 2020 2020 2020 205b 3130 352c             [105,
+000179a0: 2031 5d5d 290a 2020 2020 3e3e 3e20 6e61   1]]).    >>> na
+000179b0: 7374 7261 6e2e 7774 7273 706c 696e 6528  stran.wtrspline(
+000179c0: 312c 2031 302c 2069 6473 290a 2020 2020  1, 10, ids).    
+000179d0: 5253 504c 494e 4520 2020 2020 2020 3130  RSPLINE       10
+000179e0: 2020 2020 2030 2e31 2020 2020 2031 3030       0.1     100
+000179f0: 2020 2020 2031 3031 2020 3132 3334 3536       101  123456
+00017a00: 2020 2020 2031 3032 2020 3132 3334 3536       102  123456
+00017a10: 2020 2020 2031 3033 0a20 2020 2052 5350       103.    RSP
+00017a20: 4c49 4e45 2020 2020 2020 2031 3120 2020  LINE       11   
+00017a30: 2020 302e 3120 2020 2020 3130 3320 2020    0.1     103   
+00017a40: 2020 3130 3420 2031 3233 3435 3620 2020    104  123456   
+00017a50: 2020 3130 350a 2020 2020 2222 220a 2020    105.    """.  
+00017a60: 2020 6964 7320 3d20 6e70 2e61 746c 6561    ids = np.atlea
+00017a70: 7374 5f32 6428 6964 7329 2e61 7374 7970  st_2d(ids).astyp
+00017a80: 6528 6e70 2e69 6e74 3634 290a 2020 2020  e(np.int64).    
+00017a90: 4e20 3d20 6964 732e 7368 6170 655b 305d  N = ids.shape[0]
+00017aa0: 0a20 2020 2069 6620 4e20 3c20 333a 0a20  .    if N < 3:. 
+00017ab0: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+00017ac0: 7565 4572 726f 7228 226e 6f74 2065 6e6f  ueError("not eno
+00017ad0: 7567 6820 6772 6964 7320 666f 7220 5253  ugh grids for RS
+00017ae0: 504c 494e 4522 290a 0a20 2020 2069 6473  PLINE")..    ids
+00017af0: 2c20 696e 6420 3d20 6964 732e 540a 2020  , ind = ids.T.  
+00017b00: 2020 6966 2069 6e64 2e61 6c6c 2829 3a0a    if ind.all():.
+00017b10: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+00017b20: 6c75 6545 7272 6f72 2822 7468 6572 6520  lueError("there 
+00017b30: 6172 6520 6e6f 2064 6570 656e 6465 6e74  are no dependent
+00017b40: 2044 4f46 2066 6f72 2052 5350 4c49 4e45   DOF for RSPLINE
+00017b50: 2229 0a0a 2020 2020 6966 206e 6f74 2069  ")..    if not i
+00017b60: 6e64 5b30 5d20 3d3d 2069 6e64 5b2d 315d  nd[0] == ind[-1]
+00017b70: 203d 3d20 313a 0a20 2020 2020 2020 2072   == 1:.        r
+00017b80: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+00017b90: 2274 6865 2066 6972 7374 2061 6e64 206c  "the first and l
+00017ba0: 6173 7420 6772 6964 7320 6d75 7374 2062  ast grids must b
+00017bb0: 6520 696e 6465 7065 6e64 656e 7422 290a  e independent").
+00017bc0: 0a20 2020 2023 2066 696e 6420 696e 6469  .    # find indi
+00017bd0: 6365 7320 6f66 2061 6c6c 2064 6570 656e  ces of all depen
+00017be0: 6465 6e74 733a 0a20 2020 2064 6570 7320  dents:.    deps 
+00017bf0: 3d20 2869 6e64 203d 3d20 3029 2e6e 6f6e  = (ind == 0).non
+00017c00: 7a65 726f 2829 5b30 5d0a 0a20 2020 2023  zero()[0]..    #
+00017c10: 2066 696e 6420 6761 7073 2069 6e20 696e   find gaps in in
+00017c20: 6469 6365 7320 6f66 2064 6570 656e 6465  dices of depende
+00017c30: 6e74 7320 6c69 7374 3a0a 2020 2020 6761  nts list:.    ga
+00017c40: 7073 203d 2028 6e70 2e64 6966 6628 6465  ps = (np.diff(de
+00017c50: 7073 2920 213d 2031 292e 6e6f 6e7a 6572  ps) != 1).nonzer
+00017c60: 6f28 295b 305d 0a0a 2020 2020 2320 7374  o()[0]..    # st
+00017c70: 6172 7469 6e67 2069 6e64 6963 6573 206f  arting indices o
+00017c80: 6620 6465 7065 6e64 656e 7473 3a0a 2020  f dependents:.  
+00017c90: 2020 6669 7273 7473 203d 2064 6570 735b    firsts = deps[
+00017ca0: 6e70 2e68 7374 6163 6b28 2830 2c20 6761  np.hstack((0, ga
+00017cb0: 7073 202b 2031 2929 5d0a 0a20 2020 2023  ps + 1))]..    #
+00017cc0: 2065 6e64 696e 6720 696e 6469 6365 7320   ending indices 
+00017cd0: 6f66 2064 6570 656e 6465 6e74 733a 0a20  of dependents:. 
+00017ce0: 2020 206c 6173 7473 203d 2064 6570 735b     lasts = deps[
+00017cf0: 6e70 2e68 7374 6163 6b28 2867 6170 732c  np.hstack((gaps,
+00017d00: 206c 656e 2864 6570 7329 202d 2031 2929   len(deps) - 1))
+00017d10: 5d0a 0a20 2020 2023 2077 7269 7465 206f  ]..    # write o
+00017d20: 6e65 2052 5350 4c49 4e45 2070 6572 2073  ne RSPLINE per s
+00017d30: 6572 6965 7320 6f66 2064 6570 656e 6465  eries of depende
+00017d40: 6e74 733a 0a20 2020 2066 6f72 2064 302c  nts:.    for d0,
+00017d50: 2064 3120 696e 207a 6970 2866 6972 7374   d1 in zip(first
+00017d60: 732c 206c 6173 7473 293a 0a20 2020 2020  s, lasts):.     
+00017d70: 2020 2066 2e77 7269 7465 2866 2252 5350     f.write(f"RSP
+00017d80: 4c49 4e45 207b 7269 643a 387d 7b44 6f4c  LINE {rid:8}{DoL
+00017d90: 3a3e 387d 7b69 6473 5b64 3020 2d20 315d  :>8}{ids[d0 - 1]
+00017da0: 3a38 7d22 290a 2020 2020 2020 2020 7269  :8}").        ri
+00017db0: 6420 2b3d 2031 0a20 2020 2020 2020 2066  d += 1.        f
+00017dc0: 6965 6c64 203d 2035 2020 2320 6e65 7874  ield = 5  # next
+00017dd0: 206e 6173 7472 616e 2066 6965 6c64 2028   nastran field (
+00017de0: 3120 746f 2031 3029 0a0a 2020 2020 2020  1 to 10)..      
+00017df0: 2020 2320 7772 6974 6520 616c 6c20 6275    # write all bu
+00017e00: 7420 6c61 7374 2067 7269 6420 6f66 2063  t last grid of c
+00017e10: 7572 7265 6e74 2073 6567 6d65 6e74 3a0a  urrent segment:.
+00017e20: 2020 2020 2020 2020 666f 7220 6a20 696e          for j in
+00017e30: 2072 616e 6765 2864 302c 2064 3120 2b20   range(d0, d1 + 
+00017e40: 3129 3a0a 2020 2020 2020 2020 2020 2020  1):.            
+00017e50: 662e 7772 6974 6528 6622 7b69 6473 5b6a  f.write(f"{ids[j
+00017e60: 5d3a 387d 2229 0a20 2020 2020 2020 2020  ]:8}").         
+00017e70: 2020 2066 6965 6c64 202b 3d20 310a 2020     field += 1.  
+00017e80: 2020 2020 2020 2020 2020 6966 2066 6965            if fie
+00017e90: 6c64 203d 3d20 3130 3a0a 2020 2020 2020  ld == 10:.      
+00017ea0: 2020 2020 2020 2020 2020 662e 7772 6974            f.writ
+00017eb0: 6528 225c 6e20 2020 2020 2020 2022 290a  e("\n        ").
+00017ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017ed0: 6669 656c 6420 3d20 320a 2020 2020 2020  field = 2.      
+00017ee0: 2020 2020 2020 662e 7772 6974 6528 2220        f.write(" 
+00017ef0: 2031 3233 3435 3622 290a 2020 2020 2020   123456").      
+00017f00: 2020 2020 2020 6669 656c 6420 2b3d 2031        field += 1
+00017f10: 0a0a 2020 2020 2020 2020 2320 7772 6974  ..        # writ
+00017f20: 6520 636c 6f73 696e 6720 696e 6465 7065  e closing indepe
+00017f30: 6e64 656e 743a 0a20 2020 2020 2020 2066  ndent:.        f
+00017f40: 2e77 7269 7465 2866 227b 6964 735b 6431  .write(f"{ids[d1
+00017f50: 202b 2031 5d3a 387d 5c6e 2229 0a0a 0a64   + 1]:8}\n")...d
+00017f60: 6566 205f 696e 7465 7273 6563 7428 6369  ef _intersect(ci
+00017f70: 7263 412c 2063 6972 6342 2c20 7879 412c  rcA, circB, xyA,
+00017f80: 2064 7261 773d 4661 6c73 6529 3a0a 2020   draw=False):.  
+00017f90: 2020 2222 220a 2020 2020 4669 6e64 2077    """.    Find w
+00017fa0: 6865 7265 2061 206c 696e 6520 7468 6174  here a line that
+00017fb0: 2070 6173 7365 7320 7468 726f 7567 6820   passes through 
+00017fc0: 7468 6520 6365 6e74 6572 206f 6620 6369  the center of ci
+00017fd0: 7263 4120 616e 640a 2020 2020 706f 696e  rcA and.    poin
+00017fe0: 7420 7879 4120 696e 7465 7273 6563 7473  t xyA intersects
+00017ff0: 2063 6972 6342 2e0a 0a20 2020 2050 6172   circB...    Par
+00018000: 616d 6574 6572 730a 2020 2020 2d2d 2d2d  ameters.    ----
+00018010: 2d2d 2d2d 2d2d 0a20 2020 2063 6972 6341  ------.    circA
+00018020: 203a 2033 2d65 6c65 6d65 6e74 2061 7272   : 3-element arr
+00018030: 6179 5f6c 696b 650a 2020 2020 2020 2020  ay_like.        
+00018040: 5b78 632c 2079 632c 2052 5d20 666f 7220  [xc, yc, R] for 
+00018050: 6369 7263 6c65 2041 0a20 2020 2063 6972  circle A.    cir
+00018060: 6342 203a 2033 2d65 6c65 6d65 6e74 2061  cB : 3-element a
+00018070: 7272 6179 5f6c 696b 650a 2020 2020 2020  rray_like.      
+00018080: 2020 5b78 632c 2079 632c 2052 5d20 666f    [xc, yc, R] fo
+00018090: 7220 6369 7263 6c65 2042 0a20 2020 2078  r circle B.    x
+000180a0: 7941 203a 2032 2d65 6c65 6d65 6e74 2061  yA : 2-element a
+000180b0: 7272 6179 5f6c 696b 650a 2020 2020 2020  rray_like.      
+000180c0: 2020 5b78 2c20 795d 2070 6f69 6e74 2028    [x, y] point (
+000180d0: 7072 6f62 6162 6c79 206f 6e20 6369 7263  probably on circ
+000180e0: 6c65 2041 290a 2020 2020 6472 6177 203a  le A).    draw :
+000180f0: 2062 6f6f 6c3b 206f 7074 696f 6e61 6c0a   bool; optional.
+00018100: 2020 2020 2020 2020 4966 2054 7275 652c          If True,
+00018110: 2070 6c6f 7420 6369 7263 6c65 7320 616e   plot circles an
+00018120: 6420 706f 696e 7473 2066 6f72 2076 6973  d points for vis
+00018130: 7561 6c20 696e 7370 6563 7469 6f6e 2069  ual inspection i
+00018140: 6e0a 2020 2020 2020 2020 6669 6775 7265  n.        figure
+00018150: 2027 696e 7465 7273 6563 7427 0a0a 2020   'intersect'..  
+00018160: 2020 5265 7475 726e 730a 2020 2020 2d2d    Returns.    --
+00018170: 2d2d 2d2d 2d0a 2020 2020 7074 203a 2031  -----.    pt : 1
+00018180: 6420 6e64 6172 7261 790a 2020 2020 2020  d ndarray.      
+00018190: 2020 5b78 2c20 795d 206c 6f63 6174 696f    [x, y] locatio
+000181a0: 6e20 6f66 2069 6e74 6572 7365 6374 696f  n of intersectio
+000181b0: 6e20 706f 696e 7420 636c 6f73 6573 7420  n point closest 
+000181c0: 746f 2078 7941 0a0a 2020 2020 4578 616d  to xyA..    Exam
+000181d0: 706c 6573 0a20 2020 202d 2d2d 2d2d 2d2d  ples.    -------
+000181e0: 2d0a 2020 2020 2e2e 2070 6c6f 743a 3a0a  -.    .. plot::.
+000181f0: 2020 2020 2020 2020 3a63 6f6e 7465 7874          :context
+00018200: 3a20 636c 6f73 652d 6669 6773 0a0a 2020  : close-figs..  
+00018210: 2020 2020 2020 3e3e 3e20 6672 6f6d 2070        >>> from p
+00018220: 7979 6574 692e 6e61 7374 7261 6e2e 6275  yyeti.nastran.bu
+00018230: 6c6b 2069 6d70 6f72 7420 5f69 6e74 6572  lk import _inter
+00018240: 7365 6374 0a20 2020 2020 2020 203e 3e3e  sect.        >>>
+00018250: 2063 6972 6341 203d 2028 302e 2c20 302e   circA = (0., 0.
+00018260: 2c20 3130 2e29 0a20 2020 2020 2020 203e  , 10.).        >
+00018270: 3e3e 2063 6972 6342 203d 2028 302e 2c20  >> circB = (0., 
+00018280: 302e 2c20 3135 2e29 0a20 2020 2020 2020  0., 15.).       
+00018290: 203e 3e3e 2078 7941 203d 2028 302e 2c20   >>> xyA = (0., 
+000182a0: 352e 290a 2020 2020 2020 2020 3e3e 3e20  5.).        >>> 
+000182b0: 5f69 6e74 6572 7365 6374 2863 6972 6341  _intersect(circA
+000182c0: 2c20 6369 7263 422c 205b 302e 2c20 312e  , circB, [0., 1.
+000182d0: 5d2c 2064 7261 773d 3129 0a20 2020 2020  ], draw=1).     
+000182e0: 2020 2061 7272 6179 285b 2020 302e 2c20     array([  0., 
+000182f0: 2031 352e 5d29 0a20 2020 2020 2020 203e   15.]).        >
+00018300: 3e3e 205f 696e 7465 7273 6563 7428 6369  >> _intersect(ci
+00018310: 7263 412c 2063 6972 6342 2c20 5b30 2e2c  rcA, circB, [0.,
+00018320: 202d 312e 5d29 0a20 2020 2020 2020 2061   -1.]).        a
+00018330: 7272 6179 285b 2020 302e 2c20 2d31 352e  rray([  0., -15.
+00018340: 5d29 0a20 2020 2020 2020 203e 3e3e 205f  ]).        >>> _
+00018350: 696e 7465 7273 6563 7428 6369 7263 412c  intersect(circA,
+00018360: 2063 6972 6342 2c20 5b31 2e2c 2030 2e5d   circB, [1., 0.]
+00018370: 290a 2020 2020 2020 2020 6172 7261 7928  ).        array(
+00018380: 5b20 3135 2e2c 2020 2030 2e5d 290a 2020  [ 15.,   0.]).  
+00018390: 2020 2020 2020 3e3e 3e20 5f69 6e74 6572        >>> _inter
+000183a0: 7365 6374 2863 6972 6341 2c20 6369 7263  sect(circA, circ
+000183b0: 422c 205b 2d31 2e2c 2030 2e5d 290a 2020  B, [-1., 0.]).  
+000183c0: 2020 2020 2020 6172 7261 7928 5b2d 3135        array([-15
+000183d0: 2e2c 2020 2030 2e5d 290a 2020 2020 2222  .,   0.]).    ""
+000183e0: 220a 2020 2020 2878 312c 2079 312c 2052  ".    (x1, y1, R
+000183f0: 3129 203d 2063 6972 6341 0a20 2020 2028  1) = circA.    (
+00018400: 7832 2c20 7932 2920 3d20 7879 410a 2020  x2, y2) = xyA.  
+00018410: 2020 2878 332c 2079 332c 2052 3329 203d    (x3, y3, R3) =
+00018420: 2063 6972 6342 0a20 2020 2069 6620 6162   circB.    if ab
+00018430: 7328 7832 202d 2078 3129 203e 2031 3030  s(x2 - x1) > 100
+00018440: 202a 206e 702e 6669 6e66 6f28 666c 6f61   * np.finfo(floa
+00018450: 7429 2e65 7073 3a0a 2020 2020 2020 2020  t).eps:.        
+00018460: 6d20 3d20 2879 3220 2d20 7931 2920 2f20  m = (y2 - y1) / 
+00018470: 2878 3220 2d20 7831 290a 2020 2020 2020  (x2 - x1).      
+00018480: 2020 6220 3d20 2878 3220 2a20 7931 202d    b = (x2 * y1 -
+00018490: 2078 3120 2a20 7932 2920 2f20 2878 3220   x1 * y2) / (x2 
+000184a0: 2d20 7831 290a 2020 2020 2020 2020 2320  - x1).        # 
+000184b0: 286d 782b 622d 7933 292a 2a32 202b 2028  (mx+b-y3)**2 + (
+000184c0: 782d 7833 292a 2a32 203d 2052 332a 2a32  x-x3)**2 = R3**2
+000184d0: 0a20 2020 2020 2020 2061 3220 3d20 6d20  .        a2 = m 
+000184e0: 2a20 6d20 2b20 310a 2020 2020 2020 2020  * m + 1.        
+000184f0: 6131 203d 2032 202a 2028 6d20 2a20 2862  a1 = 2 * (m * (b
+00018500: 202d 2079 3329 202d 2078 3329 202f 2061   - y3) - x3) / a
+00018510: 320a 2020 2020 2020 2020 6130 203d 2028  2.        a0 = (
+00018520: 2862 202d 2079 3329 202a 2a20 3220 2b20  (b - y3) ** 2 + 
+00018530: 7833 2a2a 3220 2d20 5233 2a2a 3229 202f  x3**2 - R3**2) /
+00018540: 2061 320a 2020 2020 2020 2020 7831 203d   a2.        x1 =
+00018550: 202d 6131 202f 2032 202b 206e 702e 7371   -a1 / 2 + np.sq
+00018560: 7274 2828 6131 202f 2032 2920 2a2a 2032  rt((a1 / 2) ** 2
+00018570: 202d 2061 3029 0a20 2020 2020 2020 2078   - a0).        x
+00018580: 3220 3d20 2d61 3120 2f20 3220 2d20 6e70  2 = -a1 / 2 - np
+00018590: 2e73 7172 7428 2861 3120 2f20 3229 202a  .sqrt((a1 / 2) *
+000185a0: 2a20 3220 2d20 6130 290a 2020 2020 2020  * 2 - a0).      
+000185b0: 2020 7931 203d 206d 202a 2078 3120 2b20    y1 = m * x1 + 
+000185c0: 620a 2020 2020 2020 2020 7932 203d 206d  b.        y2 = m
+000185d0: 202a 2078 3220 2b20 620a 2020 2020 656c   * x2 + b.    el
+000185e0: 7365 3a0a 2020 2020 2020 2020 2320 6c69  se:.        # li
+000185f0: 6e65 2069 7320 7665 7274 6963 616c 2028  ne is vertical (
+00018600: 7831 2026 2078 3220 6172 6520 756e 6368  x1 & x2 are unch
+00018610: 616e 6765 6429 0a20 2020 2020 2020 2023  anged).        #
+00018620: 2020 2020 2879 2d79 3329 2a2a 3220 2b20      (y-y3)**2 + 
+00018630: 2878 312d 7833 292a 2a32 203d 2052 332a  (x1-x3)**2 = R3*
+00018640: 2a32 0a20 2020 2020 2020 2023 2020 2020  *2.        #    
+00018650: 792d 7933 203d 202b 2d20 6e70 2e73 7172  y-y3 = +- np.sqr
+00018660: 7428 5233 2a2a 3220 2d20 2878 312d 7833  t(R3**2 - (x1-x3
+00018670: 292a 2a32 290a 2020 2020 2020 2020 7931  )**2).        y1
+00018680: 203d 2079 3320 2b20 6e70 2e73 7172 7428   = y3 + np.sqrt(
+00018690: 5233 2a2a 3220 2d20 2878 3120 2d20 7833  R3**2 - (x1 - x3
+000186a0: 2920 2a2a 2032 290a 2020 2020 2020 2020  ) ** 2).        
+000186b0: 7932 203d 2079 3320 2d20 6e70 2e73 7172  y2 = y3 - np.sqr
+000186c0: 7428 5233 2a2a 3220 2d20 2878 3120 2d20  t(R3**2 - (x1 - 
+000186d0: 7833 2920 2a2a 2032 290a 2020 2020 6572  x3) ** 2).    er
+000186e0: 7231 203d 2061 6273 2878 7941 5b30 5d20  r1 = abs(xyA[0] 
+000186f0: 2d20 7831 2920 2b20 6162 7328 7879 415b  - x1) + abs(xyA[
+00018700: 315d 202d 2079 3129 0a20 2020 2065 7272  1] - y1).    err
+00018710: 3220 3d20 6162 7328 7879 415b 305d 202d  2 = abs(xyA[0] -
+00018720: 2078 3229 202b 2061 6273 2878 7941 5b31   x2) + abs(xyA[1
+00018730: 5d20 2d20 7932 290a 2020 2020 6966 2065  ] - y2).    if e
+00018740: 7272 3120 3c20 6572 7232 3a0a 2020 2020  rr1 < err2:.    
+00018750: 2020 2020 7074 203d 206e 702e 6172 7261      pt = np.arra
+00018760: 7928 5b78 312c 2079 315d 290a 2020 2020  y([x1, y1]).    
+00018770: 656c 7365 3a0a 2020 2020 2020 2020 7074  else:.        pt
+00018780: 203d 206e 702e 6172 7261 7928 5b78 322c   = np.array([x2,
+00018790: 2079 325d 290a 2020 2020 6966 2064 7261   y2]).    if dra
+000187a0: 773a 0a20 2020 2020 2020 2070 6c74 2e66  w:.        plt.f
+000187b0: 6967 7572 6528 2269 6e74 6572 7365 6374  igure("intersect
+000187c0: 2229 0a20 2020 2020 2020 2070 6c74 2e63  ").        plt.c
+000187d0: 6c66 2829 0a20 2020 2020 2020 2074 6820  lf().        th 
+000187e0: 3d20 6e70 2e61 7261 6e67 6528 302c 2033  = np.arange(0, 3
+000187f0: 3631 2920 2a20 6e70 2e70 6920 2f20 3138  61) * np.pi / 18
+00018800: 302e 300a 2020 2020 2020 2020 2878 312c  0.0.        (x1,
+00018810: 2079 312c 2052 3129 203d 2063 6972 6341   y1, R1) = circA
+00018820: 0a20 2020 2020 2020 2070 6c74 2e70 6c6f  .        plt.plo
+00018830: 7428 7831 202b 2052 3120 2a20 6e70 2e63  t(x1 + R1 * np.c
+00018840: 6f73 2874 6829 2c20 7931 202b 2052 3120  os(th), y1 + R1 
+00018850: 2a20 6e70 2e73 696e 2874 6829 2c20 6c61  * np.sin(th), la
+00018860: 6265 6c3d 2243 6972 6341 2229 0a20 2020  bel="CircA").   
+00018870: 2020 2020 2070 6c74 2e70 6c6f 7428 7833       plt.plot(x3
+00018880: 202b 2052 3320 2a20 6e70 2e63 6f73 2874   + R3 * np.cos(t
+00018890: 6829 2c20 7933 202b 2052 3320 2a20 6e70  h), y3 + R3 * np
+000188a0: 2e73 696e 2874 6829 2c20 6c61 6265 6c3d  .sin(th), label=
+000188b0: 2243 6972 6342 2229 0a20 2020 2020 2020  "CircB").       
+000188c0: 2070 6c74 2e73 6361 7474 6572 282a 7879   plt.scatter(*xy
+000188d0: 412c 2063 3d22 6722 2c20 6d61 726b 6572  A, c="g", marker
+000188e0: 3d22 6f22 2c20 733d 3630 2c20 6c61 6265  ="o", s=60, labe
+000188f0: 6c3d 2278 7941 2229 0a20 2020 2020 2020  l="xyA").       
+00018900: 2070 6c74 2e73 6361 7474 6572 282a 7074   plt.scatter(*pt
+00018910: 2c20 633d 2262 222c 206d 6172 6b65 723d  , c="b", marker=
+00018920: 2276 222c 2073 3d36 302c 206c 6162 656c  "v", s=60, label
+00018930: 3d22 696e 7465 7273 6563 7469 6f6e 206f  ="intersection o
+00018940: 6e20 4369 7263 4222 290a 2020 2020 2020  n CircB").      
+00018950: 2020 706c 742e 6178 6973 2822 6571 7561    plt.axis("equa
+00018960: 6c22 290a 2020 2020 2020 2020 706c 742e  l").        plt.
+00018970: 6c65 6765 6e64 286c 6f63 3d22 6265 7374  legend(loc="best
+00018980: 222c 2073 6361 7474 6572 706f 696e 7473  ", scatterpoints
+00018990: 3d31 290a 2020 2020 7265 7475 726e 2070  =1).    return p
+000189a0: 740a 0a0a 6465 6620 5f63 6865 636b 5f7a  t...def _check_z
+000189b0: 5f61 6c69 676e 6d65 6e74 2863 6972 635f  _alignment(circ_
+000189c0: 7061 726d 732c 2074 6f6c 293a 0a20 2020  parms, tol):.   
+000189d0: 2023 2048 6176 6520 7477 6f20 6469 6666   # Have two diff
+000189e0: 6572 656e 7420 7472 616e 7366 6f72 6d73  erent transforms
+000189f0: 2074 6f20 6120 6c6f 6361 6c20 7379 7374   to a local syst
+00018a00: 656d 202e 2e2e 2068 6176 6520 746f 2075  em ... have to u
+00018a10: 7365 0a20 2020 2023 2073 616d 6520 6f6e  se.    # same on
+00018a20: 6520 746f 2067 6574 2070 726f 7065 7220  e to get proper 
+00018a30: 6e6f 6465 2061 6c69 676e 696e 6720 746f  node aligning to
+00018a40: 206f 6363 7572 2066 6f72 2052 5350 4c49   occur for RSPLI
+00018a50: 4e45 2e20 4275 742c 0a20 2020 2023 2074  NE. But,.    # t
+00018a60: 6865 207a 2d61 7869 7320 666f 7220 626f  he z-axis for bo
+00018a70: 7468 2062 6574 7465 7220 6d61 7463 6820  th better match 
+00018a80: 7570 202e 2e2e 2063 6f6d 7075 7465 2063  up ... compute c
+00018a90: 6f73 696e 6520 6f66 2061 6e67 6c65 0a20  osine of angle. 
+00018aa0: 2020 2023 2062 6574 7765 656e 2074 6865     # between the
+00018ab0: 2074 776f 207a 2d61 7865 7320 2e2e 2e20   two z-axes ... 
+00018ac0: 7368 6f75 6c64 2062 6520 7665 7279 2063  should be very c
+00018ad0: 6c6f 7365 2074 6f20 312e 303a 0a20 2020  lose to 1.0:.   
+00018ae0: 207a 3120 3d20 6369 7263 5f70 6172 6d73   z1 = circ_parms
+00018af0: 5b30 5d2e 6261 7369 6332 6c6f 6361 6c5b  [0].basic2local[
+00018b00: 325d 0a20 2020 207a 3220 3d20 6369 7263  2].    z2 = circ
+00018b10: 5f70 6172 6d73 5b31 5d2e 6261 7369 6332  _parms[1].basic2
+00018b20: 6c6f 6361 6c5b 325d 0a20 2020 2023 2074  local[2].    # t
+00018b30: 6865 7365 2061 7265 2075 6e69 7420 7665  hese are unit ve
+00018b40: 6374 6f72 733b 206e 6f20 6e65 6564 2074  ctors; no need t
+00018b50: 6f20 6469 7669 6465 2062 7920 6d61 676e  o divide by magn
+00018b60: 6974 7564 6573 3a0a 2020 2020 636f 7369  itudes:.    cosi
+00018b70: 6e65 203d 207a 312e 646f 7428 7a32 290a  ne = z1.dot(z2).
+00018b80: 2020 2020 6966 2061 6273 2863 6f73 696e      if abs(cosin
+00018b90: 6529 203c 2074 6f6c 3a0a 2020 2020 2020  e) < tol:.      
+00018ba0: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+00018bb0: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
+00018bc0: 2270 6572 7065 6e64 6963 756c 6172 2064  "perpendicular d
+00018bd0: 6972 6563 7469 6f6e 7320 6f66 2060 7231  irections of `r1
+00018be0: 6772 6964 7360 2061 6e64 2022 0a20 2020  grids` and ".   
+00018bf0: 2020 2020 2020 2020 2066 2260 7232 6772           f"`r2gr
+00018c00: 6964 7360 2064 6f20 6e6f 7420 6d61 7463  ids` do not matc
+00018c10: 683a 207b 7a31 7d20 7673 2e20 7b7a 327d  h: {z1} vs. {z2}
+00018c20: 3b20 7468 6520 220a 2020 2020 2020 2020  ; the ".        
+00018c30: 2020 2020 6622 636f 7369 6e65 206f 6620      f"cosine of 
+00018c40: 7468 6520 616e 676c 6520 6265 7477 6565  the angle betwee
+00018c50: 6e20 7468 656d 2069 7320 7b63 6f73 696e  n them is {cosin
+00018c60: 657d 220a 2020 2020 2020 2020 290a 0a0a  e}".        )...
+00018c70: 6465 6620 5f77 745f 6369 7263 6c65 315f  def _wt_circle1_
+00018c80: 636f 6f72 6428 662c 2063 6f72 645f 6964  coord(f, cord_id
+00018c90: 2c20 6365 6e74 6572 2c20 6261 7369 6332  , center, basic2
+00018ca0: 6c6f 6361 6c2c 206e 6f64 6530 2c20 6e6f  local, node0, no
+00018cb0: 6465 5f69 6430 2c20 6e61 6d65 7329 3a0a  de_id0, names):.
+00018cc0: 2020 2020 7265 665f 636f 7264 5f69 6420      ref_cord_id 
+00018cd0: 3d20 300a 2020 2020 6469 7374 203d 206d  = 0.    dist = m
+00018ce0: 6178 2831 2e30 2c20 6e70 2e6c 696e 616c  ax(1.0, np.linal
+00018cf0: 672e 6e6f 726d 2863 656e 7465 7229 290a  g.norm(center)).
+00018d00: 2020 2020 7020 3d20 3130 202a 2a20 6e70      p = 10 ** np
+00018d10: 2e66 6c6f 6f72 286e 702e 6c6f 6731 3028  .floor(np.log10(
+00018d20: 6469 7374 2929 0a20 2020 2064 6973 7420  dist)).    dist 
+00018d30: 3d20 726f 756e 6428 6469 7374 202f 2070  = round(dist / p
+00018d40: 2920 2a20 700a 2020 2020 6c6f 6361 6c5f  ) * p.    local_
+00018d50: 636f 7264 203d 207b 0a20 2020 2020 2020  cord = {.       
+00018d60: 2063 6f72 645f 6964 3a20 5b0a 2020 2020   cord_id: [.    
+00018d70: 2020 2020 2020 2020 2243 4f52 4432 5222          "CORD2R"
+00018d80: 2c0a 2020 2020 2020 2020 2020 2020 6e70  ,.            np
+00018d90: 2e76 7374 6163 6b28 0a20 2020 2020 2020  .vstack(.       
+00018da0: 2020 2020 2020 2020 2028 0a20 2020 2020           (.     
+00018db0: 2020 2020 2020 2020 2020 2020 2020 205b                 [
+00018dc0: 636f 7264 5f69 642c 2031 2c20 7265 665f  cord_id, 1, ref_
+00018dd0: 636f 7264 5f69 645d 2c0a 2020 2020 2020  cord_id],.      
+00018de0: 2020 2020 2020 2020 2020 2020 2020 6365                ce
+00018df0: 6e74 6572 2c0a 2020 2020 2020 2020 2020  nter,.          
+00018e00: 2020 2020 2020 2020 2020 6365 6e74 6572            center
+00018e10: 202b 2064 6973 7420 2a20 6261 7369 6332   + dist * basic2
+00018e20: 6c6f 6361 6c5b 325d 2c0a 2020 2020 2020  local[2],.      
+00018e30: 2020 2020 2020 2020 2020 2020 2020 6365                ce
+00018e40: 6e74 6572 202b 2064 6973 7420 2a20 6261  nter + dist * ba
+00018e50: 7369 6332 6c6f 6361 6c5b 305d 2c0a 2020  sic2local[0],.  
+00018e60: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+00018e70: 2020 2020 2020 2020 2020 2020 292c 0a20              ),. 
+00018e80: 2020 2020 2020 205d 0a20 2020 207d 0a20         ].    }. 
+00018e90: 2020 2063 6f6d 6d65 6e74 203d 2028 0a20     comment = (. 
+00018ea0: 2020 2020 2020 2066 224f 7269 6769 6e20         f"Origin 
+00018eb0: 6f66 206c 6f63 616c 2043 4f52 4432 5220  of local CORD2R 
+00018ec0: 7b63 6f72 645f 6964 7d20 6973 2061 7420  {cord_id} is at 
+00018ed0: 6365 6e74 6572 206f 6620 7b6e 616d 6573  center of {names
+00018ee0: 5b30 5d7d 2072 696e 673b 220a 2020 2020  [0]} ring;".    
+00018ef0: 2020 2020 2220 7a20 6973 2070 6572 7065      " z is perpe
+00018f00: 6e64 6963 756c 6172 2074 6f20 706c 616e  ndicular to plan
+00018f10: 6520 6f66 2063 6972 636c 652c 2061 6e64  e of circle, and
+00018f20: 2078 2069 7320 616c 6967 6e65 6420 7769   x is aligned wi
+00018f30: 7468 2022 0a20 2020 2020 2020 2066 226e  th ".        f"n
+00018f40: 6f64 6520 7b6e 6f64 6530 7d20 2861 6e64  ode {node0} (and
+00018f50: 206e 6577 206e 6f64 6520 7b6e 6f64 655f   new node {node_
+00018f60: 6964 307d 292e 220a 2020 2020 290a 2020  id0}).".    ).  
+00018f70: 2020 662e 7772 6974 6528 6d6b 636f 6d6d    f.write(mkcomm
+00018f80: 656e 7428 636f 6d6d 656e 7429 290a 2020  ent(comment)).  
+00018f90: 2020 7774 636f 6f72 6463 6172 6473 2866    wtcoordcards(f
+00018fa0: 2c20 6c6f 6361 6c5f 636f 7264 290a 0a0a  , local_cord)...
+00018fb0: 6465 6620 5f77 7467 7269 6473 5f72 6265  def _wtgrids_rbe
+00018fc0: 3273 280a 2020 2020 662c 2063 6972 635f  2s(.    f, circ_
+00018fd0: 7061 726d 732c 2063 656e 7465 722c 2062  parms, center, b
+00018fe0: 6173 6963 326c 6f63 616c 2c20 636f 7264  asic2local, cord
+00018ff0: 5f69 642c 206e 6f64 655f 6964 302c 2072  _id, node_id0, r
+00019000: 6265 325f 6964 302c 2072 696e 6731 5f69  be2_id0, ring1_i
+00019010: 6473 2c20 6e61 6d65 730a 293a 0a20 2020  ds, names.):.   
+00019020: 206e 3120 3d20 6369 7263 5f70 6172 6d73   n1 = circ_parms
+00019030: 5b30 5d2e 6c6f 6361 6c2e 7368 6170 655b  [0].local.shape[
+00019040: 315d 0a20 2020 206e 6577 7074 7320 3d20  1].    newpts = 
+00019050: 6e70 2e7a 6572 6f73 2828 6e31 2c20 3329  np.zeros((n1, 3)
+00019060: 290a 0a20 2020 2023 2064 6566 696e 6520  )..    # define 
+00019070: 7a20 6c6f 6361 7469 6f6e 206f 6620 6e65  z location of ne
+00019080: 7770 7473 3a0a 2020 2020 6e65 7770 7473  wpts:.    newpts
+00019090: 5b3a 2c20 325d 203d 2063 6972 635f 7061  [:, 2] = circ_pa
+000190a0: 726d 735b 315d 2e6c 6f63 616c 5b32 5d2e  rms[1].local[2].
+000190b0: 6d65 616e 2829 0a0a 2020 2020 2320 636f  mean()..    # co
+000190c0: 6d70 7574 6520 6365 6e74 6572 206f 6620  mpute center of 
+000190d0: 6369 7263 6c65 2032 2069 6e20 6c6f 6361  circle 2 in loca
+000190e0: 6c20 3120 636f 6f72 6469 6e61 7465 733a  l 1 coordinates:
+000190f0: 0a20 2020 2063 656e 7465 7232 203d 2062  .    center2 = b
+00019100: 6173 6963 326c 6f63 616c 2040 2028 6369  asic2local @ (ci
+00019110: 7263 5f70 6172 6d73 5b31 5d2e 6365 6e74  rc_parms[1].cent
+00019120: 6572 202d 2063 656e 7465 7229 0a20 2020  er - center).   
+00019130: 2072 6164 6975 7320 3d20 6369 7263 5f70   radius = circ_p
+00019140: 6172 6d73 5b30 5d2e 7261 6469 7573 0a20  arms[0].radius. 
+00019150: 2020 2066 6f72 206a 2069 6e20 7261 6e67     for j in rang
+00019160: 6528 6e31 293a 0a20 2020 2020 2020 206e  e(n1):.        n
+00019170: 6577 7074 735b 6a2c 203a 325d 203d 205f  ewpts[j, :2] = _
+00019180: 696e 7465 7273 6563 7428 0a20 2020 2020  intersect(.     
+00019190: 2020 2020 2020 205b 302e 302c 2030 2e30         [0.0, 0.0
+000191a0: 2c20 7261 6469 7573 5d2c 0a20 2020 2020  , radius],.     
+000191b0: 2020 2020 2020 205b 6365 6e74 6572 325b         [center2[
+000191c0: 305d 2c20 6365 6e74 6572 325b 315d 2c20  0], center2[1], 
+000191d0: 6369 7263 5f70 6172 6d73 5b31 5d2e 7261  circ_parms[1].ra
+000191e0: 6469 7573 5d2c 0a20 2020 2020 2020 2020  dius],.         
+000191f0: 2020 2063 6972 635f 7061 726d 735b 305d     circ_parms[0]
+00019200: 2e6c 6f63 616c 5b3a 322c 206a 5d2c 0a20  .local[:2, j],. 
+00019210: 2020 2020 2020 2029 0a0a 2020 2020 2320         )..    # 
+00019220: 7772 6974 6520 6e65 7720 6772 6964 730a  write new grids.
+00019230: 2020 2020 636f 6d6d 656e 7420 3d20 280a      comment = (.
+00019240: 2020 2020 2020 2020 6622 4772 6964 7320          f"Grids 
+00019250: 746f 2052 4245 3220 746f 2074 6865 207b  to RBE2 to the {
+00019260: 6e61 6d65 735b 305d 7d20 6772 6964 732e  names[0]} grids.
+00019270: 2054 6865 7365 2067 7269 6473 206c 696e   These grids lin
+00019280: 6520 220a 2020 2020 2020 2020 6622 7570  e ".        f"up
+00019290: 2077 6974 6820 7468 6520 7b6e 616d 6573   with the {names
+000192a0: 5b31 5d7d 2063 6972 636c 6520 736f 2074  [1]} circle so t
+000192b0: 6861 7420 7468 6520 5253 504c 494e 4520  hat the RSPLINE 
+000192c0: 2877 6869 6368 2022 0a20 2020 2020 2020  (which ".       
+000192d0: 2066 2274 6965 7320 746f 6765 7468 6572   f"ties together
+000192e0: 2074 6865 7365 206e 6577 2067 7269 6473   these new grids
+000192f0: 2061 6e64 2074 6865 207b 6e61 6d65 735b   and the {names[
+00019300: 315d 7d20 6772 6964 7329 2077 696c 6c20  1]} grids) will 
+00019310: 220a 2020 2020 2020 2020 2262 6520 736d  ".        "be sm
+00019320: 6f6f 7468 2e22 0a20 2020 2029 0a20 2020  ooth.".    ).   
+00019330: 2066 2e77 7269 7465 286d 6b63 6f6d 6d65   f.write(mkcomme
+00019340: 6e74 2863 6f6d 6d65 6e74 2929 0a20 2020  nt(comment)).   
+00019350: 2076 6563 203d 206e 702e 6172 616e 6765   vec = np.arange
+00019360: 286e 3129 0a20 2020 206e 6577 6964 7320  (n1).    newids 
+00019370: 3d20 6e6f 6465 5f69 6430 202b 2076 6563  = node_id0 + vec
+00019380: 0a20 2020 2072 6265 3269 6473 203d 2072  .    rbe2ids = r
+00019390: 6265 325f 6964 3020 2b20 7665 630a 2020  be2_id0 + vec.  
+000193a0: 2020 7774 6772 6964 7328 662c 206e 6577    wtgrids(f, new
+000193b0: 6964 732c 2078 797a 3d6e 6577 7074 732c  ids, xyz=newpts,
+000193c0: 2063 703d 636f 7264 5f69 6429 0a0a 2020   cp=cord_id)..  
+000193d0: 2020 636f 6d6d 656e 7420 3d20 280a 2020    comment = (.  
+000193e0: 2020 2020 2020 6622 5242 4532 2074 6865        f"RBE2 the
+000193f0: 207b 6e61 6d65 735b 305d 7d20 6e6f 6465   {names[0]} node
+00019400: 7320 746f 206e 6577 206e 6f64 6573 2063  s to new nodes c
+00019410: 7265 6174 6564 2061 626f 7665 2022 0a20  reated above ". 
+00019420: 2020 2020 2020 2022 2874 6865 206e 6577         "(the new
+00019430: 206e 6f64 6573 2061 7265 2069 6e64 6570   nodes are indep
+00019440: 656e 6465 6e74 293a 220a 2020 2020 290a  endent):".    ).
+00019450: 2020 2020 662e 7772 6974 6528 6d6b 636f      f.write(mkco
+00019460: 6d6d 656e 7428 636f 6d6d 656e 7429 290a  mment(comment)).
+00019470: 2020 2020 7772 6974 6572 2e76 6563 7772      writer.vecwr
+00019480: 6974 6528 662c 2022 5242 4532 2c7b 7d2c  ite(f, "RBE2,{},
+00019490: 7b7d 2c31 3233 3435 362c 7b7d 5c6e 222c  {},123456,{}\n",
+000194a0: 2072 6265 3269 6473 2c20 6e65 7769 6473   rbe2ids, newids
+000194b0: 2c20 7269 6e67 315f 6964 7329 0a20 2020  , ring1_ids).   
+000194c0: 2072 6574 7572 6e20 6e65 7770 7473 2c20   return newpts, 
+000194d0: 6e65 7769 6473 0a0a 0a64 6566 205f 736f  newids...def _so
+000194e0: 7274 5f6e 5f77 7269 7465 280a 2020 2020  rt_n_write(.    
+000194f0: 662c 2069 6e64 6570 656e 6465 6e74 2c20  f, independent, 
+00019500: 6369 7263 5f70 6172 6d73 2c20 6e65 7770  circ_parms, newp
+00019510: 7473 2c20 6e65 7769 6473 2c20 7269 6e67  ts, newids, ring
+00019520: 325f 6964 732c 2072 7370 6c69 6e65 5f69  2_ids, rspline_i
+00019530: 6430 2c20 446f 4c2c 206e 616d 6573 0a29  d0, DoL, names.)
+00019540: 3a0a 2020 2020 6e31 203d 2063 6972 635f  :.    n1 = circ_
+00019550: 7061 726d 735b 305d 2e6c 6f63 616c 2e73  parms[0].local.s
+00019560: 6861 7065 5b31 5d0a 2020 2020 6e32 203d  hape[1].    n2 =
+00019570: 2063 6972 635f 7061 726d 735b 315d 2e6c   circ_parms[1].l
+00019580: 6f63 616c 2e73 6861 7065 5b31 5d0a 0a20  ocal.shape[1].. 
+00019590: 2020 2023 202d 2074 6f20 646f 2074 6869     # - to do thi
+000195a0: 7320 696e 206f 7264 6572 2c20 7765 206e  s in order, we n
+000195b0: 6565 6420 746f 2063 6f6d 7075 7465 2074  eed to compute t
+000195c0: 6865 6972 2061 6e67 6c65 730a 2020 2020  heir angles.    
+000195d0: 7468 5f31 203d 206e 702e 6172 6374 616e  th_1 = np.arctan
+000195e0: 3228 6e65 7770 7473 5b3a 2c20 315d 2c20  2(newpts[:, 1], 
+000195f0: 6e65 7770 7473 5b3a 2c20 305d 290a 2020  newpts[:, 0]).  
+00019600: 2020 7232 5f6c 6f63 616c 203d 2063 6972    r2_local = cir
+00019610: 635f 7061 726d 735b 315d 2e6c 6f63 616c  c_parms[1].local
+00019620: 2e54 0a20 2020 2074 685f 3220 3d20 6e70  .T.    th_2 = np
+00019630: 2e61 7263 7461 6e32 2872 325f 6c6f 6361  .arctan2(r2_loca
+00019640: 6c5b 3a2c 2031 5d2c 2072 325f 6c6f 6361  l[:, 1], r2_loca
+00019650: 6c5b 3a2c 2030 5d29 0a20 2020 2074 6820  l[:, 0]).    th 
+00019660: 3d20 6e70 2e68 7374 6163 6b28 2874 685f  = np.hstack((th_
+00019670: 312c 2074 685f 3229 290a 2020 2020 7468  1, th_2)).    th
+00019680: 5b74 6820 3c20 2d31 652d 385d 202b 3d20  [th < -1e-8] += 
+00019690: 3220 2a20 6e70 2e70 690a 0a20 2020 2069  2 * np.pi..    i
+000196a0: 6473 5f31 203d 206e 702e 636f 6c75 6d6e  ds_1 = np.column
+000196b0: 5f73 7461 636b 2828 6e65 7769 6473 2c20  _stack((newids, 
+000196c0: 6e70 2e7a 6572 6f73 286e 312c 206e 702e  np.zeros(n1, np.
+000196d0: 696e 7436 3429 2929 0a20 2020 2069 6473  int64))).    ids
+000196e0: 5f32 203d 206e 702e 636f 6c75 6d6e 5f73  _2 = np.column_s
+000196f0: 7461 636b 2828 7269 6e67 325f 6964 732c  tack((ring2_ids,
+00019700: 206e 702e 7a65 726f 7328 6e32 2c20 6e70   np.zeros(n2, np
+00019710: 2e69 6e74 3634 2929 290a 0a20 2020 2069  .int64)))..    i
+00019720: 6620 696e 6465 7065 6e64 656e 7420 3d3d  f independent ==
+00019730: 2022 7269 6e67 3122 3a0a 2020 2020 2020   "ring1":.      
+00019740: 2020 636f 6d6d 656e 7420 3d20 280a 2020    comment = (.  
+00019750: 2020 2020 2020 2020 2020 6622 5253 504c            f"RSPL
+00019760: 494e 4520 7468 6520 7b6e 616d 6573 5b31  INE the {names[1
+00019770: 5d7d 206e 6f64 6573 2074 6f20 7468 6520  ]} nodes to the 
+00019780: 6e65 7720 6e6f 6465 7320 6372 6561 7465  new nodes create
+00019790: 6420 220a 2020 2020 2020 2020 2020 2020  d ".            
+000197a0: 2261 626f 7665 2c20 7769 7468 2074 6865  "above, with the
+000197b0: 206e 6577 206e 6f64 6573 2062 6569 6e67   new nodes being
+000197c0: 2069 6e64 6570 656e 6465 6e74 2e22 0a20   independent.". 
+000197d0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+000197e0: 2069 6473 5f31 5b3a 2c20 315d 203d 2031   ids_1[:, 1] = 1
+000197f0: 0a20 2020 2065 6c73 653a 0a20 2020 2020  .    else:.     
+00019800: 2020 2063 6f6d 6d65 6e74 203d 2028 0a20     comment = (. 
+00019810: 2020 2020 2020 2020 2020 2066 2252 5350             f"RSP
+00019820: 4c49 4e45 2074 6865 206e 6577 206e 6f64  LINE the new nod
+00019830: 6573 2063 7265 6174 6564 2061 626f 7665  es created above
+00019840: 2074 6f20 7468 6520 7b6e 616d 6573 5b31   to the {names[1
+00019850: 5d7d 2022 0a20 2020 2020 2020 2020 2020  ]} ".           
+00019860: 2066 226e 6f64 6573 2c20 7769 7468 2074   f"nodes, with t
+00019870: 6865 207b 6e61 6d65 735b 315d 7d20 6e6f  he {names[1]} no
+00019880: 6465 7320 6265 696e 6720 696e 6465 7065  des being indepe
+00019890: 6e64 656e 742e 220a 2020 2020 2020 2020  ndent.".        
+000198a0: 290a 2020 2020 2020 2020 6964 735f 325b  ).        ids_2[
+000198b0: 3a2c 2031 5d20 3d20 310a 0a20 2020 2066  :, 1] = 1..    f
+000198c0: 2e77 7269 7465 286d 6b63 6f6d 6d65 6e74  .write(mkcomment
+000198d0: 2863 6f6d 6d65 6e74 2929 0a20 2020 2069  (comment)).    i
+000198e0: 6473 203d 206e 702e 7673 7461 636b 2828  ds = np.vstack((
+000198f0: 6964 735f 312c 2069 6473 5f32 2929 0a0a  ids_1, ids_2))..
+00019900: 2020 2020 2320 736f 7274 2062 7920 616e      # sort by an
+00019910: 6775 6c61 7220 6c6f 6361 7469 6f6e 3a0a  gular location:.
+00019920: 2020 2020 6920 3d20 6e70 2e61 7267 736f      i = np.argso
+00019930: 7274 2874 6829 0a20 2020 2069 6473 203d  rt(th).    ids =
+00019940: 2069 6473 5b69 5d0a 2020 2020 6920 3d20   ids[i].    i = 
+00019950: 300a 2020 2020 7768 696c 6520 6964 735b  0.    while ids[
+00019960: 692c 2031 5d20 3d3d 2030 3a0a 2020 2020  i, 1] == 0:.    
+00019970: 2020 2020 6920 2b3d 2031 0a20 2020 2023      i += 1.    #
+00019980: 2073 7461 636b 2069 6473 2c20 656e 7375   stack ids, ensu
+00019990: 7269 6e67 2073 7461 7274 696e 6720 616e  ring starting an
+000199a0: 6420 656e 6469 6e67 206e 6f64 6520 6973  d ending node is
+000199b0: 2069 6e64 6570 656e 6465 6e74 3a0a 2020   independent:.  
+000199c0: 2020 6964 7320 3d20 6e70 2e76 7374 6163    ids = np.vstac
+000199d0: 6b28 2869 6473 5b69 3a5d 2c20 6964 735b  k((ids[i:], ids[
+000199e0: 3a69 5d2c 2069 6473 5b69 5d29 290a 2020  :i], ids[i])).  
+000199f0: 2020 7774 7273 706c 696e 6528 662c 2072    wtrspline(f, r
+00019a00: 7370 6c69 6e65 5f69 6430 2c20 6964 732c  spline_id0, ids,
+00019a10: 2044 6f4c 3d44 6f4c 290a 2020 2020 7265   DoL=DoL).    re
+00019a20: 7475 726e 2069 6473 0a0a 0a64 6566 205f  turn ids...def _
+00019a30: 706c 6f74 5f72 7370 6c69 6e65 280a 2020  plot_rspline(.  
+00019a40: 2020 6178 2c0a 2020 2020 6369 7263 5f70    ax,.    circ_p
+00019a50: 6172 6d73 2c0a 2020 2020 7879 7a2c 0a20  arms,.    xyz,. 
+00019a60: 2020 206e 6577 7074 732c 0a20 2020 206e     newpts,.    n
+00019a70: 6577 6964 732c 0a20 2020 2062 6173 6963  ewids,.    basic
+00019a80: 326c 6f63 616c 2c0a 2020 2020 6365 6e74  2local,.    cent
+00019a90: 6572 2c0a 2020 2020 7273 706c 696e 655f  er,.    rspline_
+00019aa0: 6e6f 6465 732c 0a20 2020 2072 696e 6732  nodes,.    ring2
+00019ab0: 5f69 6473 2c0a 2020 2020 6e61 6d65 732c  _ids,.    names,
+00019ac0: 0a29 3a0a 2020 2020 666f 7220 6974 656d  .):.    for item
+00019ad0: 2069 6e20 2278 797a 223a 0a20 2020 2020   in "xyz":.     
+00019ae0: 2020 2067 6574 5f66 756e 6320 3d20 6765     get_func = ge
+00019af0: 7461 7474 7228 6178 2c20 6622 6765 745f  tattr(ax, f"get_
+00019b00: 7b69 7465 6d7d 6c61 6265 6c22 290a 2020  {item}label").  
+00019b10: 2020 2020 2020 6966 206e 6f74 2067 6574        if not get
+00019b20: 5f66 756e 6328 293a 0a20 2020 2020 2020  _func():.       
+00019b30: 2020 2020 2073 6574 5f66 756e 6320 3d20       set_func = 
+00019b40: 6765 7461 7474 7228 6178 2c20 6622 7365  getattr(ax, f"se
+00019b50: 745f 7b69 7465 6d7d 6c61 6265 6c22 290a  t_{item}label").
+00019b60: 2020 2020 2020 2020 2020 2020 7365 745f              set_
+00019b70: 6675 6e63 2869 7465 6d2e 7570 7065 7228  func(item.upper(
+00019b80: 2929 0a0a 2020 2020 2320 6472 6177 2074  ))..    # draw t
+00019b90: 6865 2066 6974 2066 6f72 2063 6972 636c  he fit for circl
+00019ba0: 6573 3a0a 2020 2020 7468 203d 206e 702e  es:.    th = np.
+00019bb0: 6465 6732 7261 6428 6e70 2e61 7261 6e67  deg2rad(np.arang
+00019bc0: 6528 302e 302c 2033 3631 2929 0a20 2020  e(0.0, 361)).   
+00019bd0: 2066 6f72 206e 756d 2c20 2870 6172 6d73   for num, (parms
+00019be0: 2c20 6c69 6e65 2920 696e 2065 6e75 6d65  , line) in enume
+00019bf0: 7261 7465 287a 6970 2863 6972 635f 7061  rate(zip(circ_pa
+00019c00: 726d 732c 2028 222b 222c 2022 7822 2929  rms, ("+", "x"))
+00019c10: 293a 0a20 2020 2020 2020 2078 203d 2070  ):.        x = p
+00019c20: 6172 6d73 2e72 6164 6975 7320 2a20 6e70  arms.radius * np
+00019c30: 2e63 6f73 2874 6829 0a20 2020 2020 2020  .cos(th).       
+00019c40: 2079 203d 2070 6172 6d73 2e72 6164 6975   y = parms.radiu
+00019c50: 7320 2a20 6e70 2e73 696e 2874 6829 0a20  s * np.sin(th). 
+00019c60: 2020 2020 2020 207a 203d 2030 202a 2078         z = 0 * x
+00019c70: 0a20 2020 2020 2020 2023 2074 7261 6e73  .        # trans
+00019c80: 666f 726d 2074 6f20 6261 7369 6320 636f  form to basic co
+00019c90: 6f72 6469 6e61 7465 7320 616e 6420 706c  ordinates and pl
+00019ca0: 6f74 3a0a 2020 2020 2020 2020 6369 7263  ot:.        circ
+00019cb0: 6c65 5f62 6173 6963 203d 2028 0a20 2020  le_basic = (.   
+00019cc0: 2020 2020 2020 2020 2070 6172 6d73 2e63           parms.c
+00019cd0: 656e 7465 7220 2b20 286e 702e 636f 6c75  enter + (np.colu
+00019ce0: 6d6e 5f73 7461 636b 2828 782c 2079 2c20  mn_stack((x, y, 
+00019cf0: 7a29 2920 4020 7061 726d 732e 6261 7369  z)) @ parms.basi
+00019d00: 6332 6c6f 6361 6c29 0a20 2020 2020 2020  c2local).       
+00019d10: 2029 2e54 0a20 2020 2020 2020 2068 203d   ).T.        h =
+00019d20: 2061 782e 706c 6f74 280a 2020 2020 2020   ax.plot(.      
+00019d30: 2020 2020 2020 2a78 797a 5b6e 756d 5d2e        *xyz[num].
+00019d40: 542c 0a20 2020 2020 2020 2020 2020 206c  T,.            l
+00019d50: 696e 652c 0a20 2020 2020 2020 2020 2020  ine,.           
+00019d60: 206d 6172 6b65 7273 697a 653d 382e 302c   markersize=8.0,
+00019d70: 0a20 2020 2020 2020 2020 2020 206d 6172  .            mar
+00019d80: 6b65 7265 6467 6577 6964 7468 3d32 2e30  keredgewidth=2.0
+00019d90: 2c0a 2020 2020 2020 2020 2020 2020 6c61  ,.            la
+00019da0: 6265 6c3d 6622 7b6e 616d 6573 5b6e 756d  bel=f"{names[num
+00019db0: 5d7d 206e 6f64 6573 222c 0a20 2020 2020  ]} nodes",.     
+00019dc0: 2020 2029 5b30 5d0a 2020 2020 2020 2020     )[0].        
+00019dd0: 6178 2e70 6c6f 7428 2a63 6972 636c 655f  ax.plot(*circle_
+00019de0: 6261 7369 632c 2068 2e67 6574 5f63 6f6c  basic, h.get_col
+00019df0: 6f72 2829 2c20 6c61 6265 6c3d 6622 7b6e  or(), label=f"{n
+00019e00: 616d 6573 5b6e 756d 5d7d 2062 6573 742d  ames[num]} best-
+00019e10: 6669 7420 6369 7263 6c65 2229 0a0a 2020  fit circle")..  
+00019e20: 2020 2320 6765 7420 6261 7369 6320 636f    # get basic co
+00019e30: 6f72 6469 6e61 7465 7320 6f66 206e 6577  ordinates of new
+00019e40: 7074 733a 0a20 2020 206e 6577 7074 735f  pts:.    newpts_
+00019e50: 6261 7369 6320 3d20 6e65 7770 7473 2040  basic = newpts @
+00019e60: 2062 6173 6963 326c 6f63 616c 202b 2063   basic2local + c
+00019e70: 656e 7465 720a 0a20 2020 2073 6567 6d65  enter..    segme
+00019e80: 6e74 7320 3d20 6e70 2e65 6d70 7479 2828  nts = np.empty((
+00019e90: 3320 2a20 6e65 7770 7473 2e73 6861 7065  3 * newpts.shape
+00019ea0: 5b30 5d2c 2033 2929 0a20 2020 2073 6567  [0], 3)).    seg
+00019eb0: 6d65 6e74 735b 3a3a 335d 203d 206e 6577  ments[::3] = new
+00019ec0: 7074 735f 6261 7369 630a 2020 2020 7365  pts_basic.    se
+00019ed0: 676d 656e 7473 5b31 3a3a 335d 203d 2078  gments[1::3] = x
+00019ee0: 797a 5b30 5d0a 2020 2020 7365 676d 656e  yz[0].    segmen
+00019ef0: 7473 5b32 3a3a 335d 203d 206e 702e 6e61  ts[2::3] = np.na
+00019f00: 6e0a 0a20 2020 2068 203d 2061 782e 706c  n..    h = ax.pl
+00019f10: 6f74 280a 2020 2020 2020 2020 2a6e 6577  ot(.        *new
+00019f20: 7074 735f 6261 7369 632e 542c 0a20 2020  pts_basic.T,.   
+00019f30: 2020 2020 2022 6f22 2c0a 2020 2020 2020       "o",.      
+00019f40: 2020 6d61 726b 6572 7369 7a65 3d35 2e30    markersize=5.0
+00019f50: 2c0a 2020 2020 2020 2020 6d61 726b 6572  ,.        marker
+00019f60: 6564 6765 7769 6474 683d 322e 302c 0a20  edgewidth=2.0,. 
+00019f70: 2020 2020 2020 206c 6162 656c 3d28 224e         label=("N
+00019f80: 6577 207b 7d20 6e6f 6465 735c 6e20 2d20  ew {} nodes\n - 
+00019f90: 7368 6f75 6c64 2062 6520 6f6e 207b 7d20  should be on {} 
+00019fa0: 6369 7263 6c65 2229 2e66 6f72 6d61 7428  circle").format(
+00019fb0: 2a6e 616d 6573 292c 0a20 2020 2029 5b30  *names),.    )[0
+00019fc0: 5d0a 2020 2020 6178 2e70 6c6f 7428 0a20  ].    ax.plot(. 
+00019fd0: 2020 2020 2020 202a 7365 676d 656e 7473         *segments
+00019fe0: 2e54 2c0a 2020 2020 2020 2020 222d 222c  .T,.        "-",
+00019ff0: 0a20 2020 2020 2020 2063 6f6c 6f72 3d68  .        color=h
+0001a000: 2e67 6574 5f63 6f6c 6f72 2829 2c0a 2020  .get_color(),.  
+0001a010: 2020 2020 2020 6c61 6265 6c3d 6622 5242        label=f"RB
+0001a020: 4532 7320 2d20 7368 6f75 6c64 2062 6520  E2s - should be 
+0001a030: 7b6e 616d 6573 5b30 5d7d 2072 6164 6961  {names[0]} radia
+0001a040: 6c22 2c0a 2020 2020 290a 0a20 2020 2023  l",.    )..    #
+0001a050: 2070 6c6f 7420 7468 6520 7273 706c 696e   plot the rsplin
+0001a060: 653a 0a20 2020 2075 6e73 6f72 7465 645f  e:.    unsorted_
+0001a070: 7273 706c 696e 655f 6e6f 6465 7320 3d20  rspline_nodes = 
+0001a080: 6e70 2e68 7374 6163 6b28 286e 6577 6964  np.hstack((newid
+0001a090: 732c 2072 696e 6732 5f69 6473 2929 0a20  s, ring2_ids)). 
+0001a0a0: 2020 2070 7620 3d20 6c6f 6361 7465 2e6d     pv = locate.m
+0001a0b0: 6174 5f69 6e74 6572 7365 6374 2875 6e73  at_intersect(uns
+0001a0c0: 6f72 7465 645f 7273 706c 696e 655f 6e6f  orted_rspline_no
+0001a0d0: 6465 732c 2072 7370 6c69 6e65 5f6e 6f64  des, rspline_nod
+0001a0e0: 6573 5b3a 2c20 305d 2c20 3229 0a0a 2020  es[:, 0], 2)..  
+0001a0f0: 2020 7273 706c 696e 655f 7879 7a20 3d20    rspline_xyz = 
+0001a100: 6e70 2e76 7374 6163 6b28 286e 6577 7074  np.vstack((newpt
+0001a110: 735f 6261 7369 632c 2078 797a 5b31 5d29  s_basic, xyz[1])
+0001a120: 295b 7076 5b30 5d5d 0a20 2020 2061 782e  )[pv[0]].    ax.
+0001a130: 706c 6f74 282a 7273 706c 696e 655f 7879  plot(*rspline_xy
+0001a140: 7a2e 542c 2022 2d2d 222c 2061 6c70 6861  z.T, "--", alpha
+0001a150: 3d30 2e37 2c20 6c69 6e65 7769 6474 683d  =0.7, linewidth=
+0001a160: 332e 302c 206c 6162 656c 3d22 4669 6e61  3.0, label="Fina
+0001a170: 6c20 5253 504c 494e 4522 290a 0a20 2020  l RSPLINE")..   
+0001a180: 2079 746f 6f6c 732e 6178 6973 5f65 7175   ytools.axis_equ
+0001a190: 616c 5f33 6428 6178 290a 2020 2020 6178  al_3d(ax).    ax
+0001a1a0: 2e6c 6567 656e 6428 6c6f 633d 2275 7070  .legend(loc="upp
+0001a1b0: 6572 206c 6566 7422 2c20 6262 6f78 5f74  er left", bbox_t
+0001a1c0: 6f5f 616e 6368 6f72 3d28 312e 302c 2031  o_anchor=(1.0, 1
+0001a1d0: 2e30 2929 0a20 2020 2061 782e 6765 745f  .0)).    ax.get_
+0001a1e0: 6669 6775 7265 2829 2e74 6967 6874 5f6c  figure().tight_l
+0001a1f0: 6179 6f75 7428 290a 0a0a 6465 6620 7774  ayout()...def wt
+0001a200: 7273 706c 696e 655f 7269 6e67 7328 0a20  rspline_rings(. 
+0001a210: 2020 2066 2c0a 2020 2020 7231 6772 6964     f,.    r1grid
+0001a220: 732c 0a20 2020 2072 3267 7269 6473 2c0a  s,.    r2grids,.
+0001a230: 2020 2020 6e6f 6465 5f69 6430 2c0a 2020      node_id0,.  
+0001a240: 2020 7273 706c 696e 655f 6964 302c 0a20    rspline_id0,. 
+0001a250: 2020 2072 6265 325f 6964 303d 4e6f 6e65     rbe2_id0=None
+0001a260: 2c0a 2020 2020 636f 7264 5f69 643d 4e6f  ,.    cord_id=No
+0001a270: 6e65 2c0a 2020 2020 6d61 6b65 706c 6f74  ne,.    makeplot
+0001a280: 3d22 6e65 7722 2c0a 2020 2020 446f 4c3d  ="new",.    DoL=
+0001a290: 2230 2e31 222c 0a20 2020 2069 6e64 6570  "0.1",.    indep
+0001a2a0: 656e 6465 6e74 3d22 7269 6e67 3122 2c0a  endent="ring1",.
+0001a2b0: 293a 0a20 2020 2022 2222 0a20 2020 2043  ):.    """.    C
+0001a2c0: 7265 6174 6573 2061 2073 6d6f 6f74 6820  reates a smooth 
+0001a2d0: 5253 504c 494e 4520 746f 2063 6f6e 6e65  RSPLINE to conne
+0001a2e0: 6374 2074 776f 2072 696e 6773 206f 6620  ct two rings of 
+0001a2f0: 6772 6964 730a 0a20 2020 2050 6172 616d  grids..    Param
+0001a300: 6574 6572 730a 2020 2020 2d2d 2d2d 2d2d  eters.    ------
+0001a310: 2d2d 2d2d 0a20 2020 2066 203a 2073 7472  ----.    f : str
+0001a320: 696e 6720 6f72 2066 696c 655f 6c69 6b65  ing or file_like
+0001a330: 206f 7220 3120 6f72 204e 6f6e 650a 2020   or 1 or None.  
+0001a340: 2020 2020 2020 4569 7468 6572 2061 206e        Either a n
+0001a350: 616d 6520 6f66 2061 2066 696c 652c 206f  ame of a file, o
+0001a360: 7220 6973 2061 2066 696c 655f 6c69 6b65  r is a file_like
+0001a370: 206f 626a 6563 7420 6173 2072 6574 7572   object as retur
+0001a380: 6e65 640a 2020 2020 2020 2020 6279 203a  ned.        by :
+0001a390: 6675 6e63 3a60 6f70 656e 6020 6f72 203a  func:`open` or :
+0001a3a0: 636c 6173 733a 6069 6f2e 5374 7269 6e67  class:`io.String
+0001a3b0: 494f 602e 2049 6e70 7574 2061 7320 696e  IO`. Input as in
+0001a3c0: 7465 6765 7220 3120 746f 0a20 2020 2020  teger 1 to.     
+0001a3d0: 2020 2077 7269 7465 2074 6f20 7374 646f     write to stdo
+0001a3e0: 7574 2e20 4361 6e20 616c 736f 2062 6520  ut. Can also be 
+0001a3f0: 7468 6520 6e61 6d65 206f 6620 6120 6469  the name of a di
+0001a400: 7265 6374 6f72 7920 6f72 204e 6f6e 653b  rectory or None;
+0001a410: 0a20 2020 2020 2020 2069 6e20 7468 6573  .        in thes
+0001a420: 6520 6361 7365 732c 2061 2047 5549 2069  e cases, a GUI i
+0001a430: 7320 6f70 656e 6564 2066 6f72 2066 696c  s opened for fil
+0001a440: 6520 7365 6c65 6374 696f 6e2e 0a20 2020  e selection..   
+0001a450: 2072 3167 7269 6473 203a 2032 6420 6172   r1grids : 2d ar
+0001a460: 7261 795f 6c69 6b65 206f 7220 4461 7461  ray_like or Data
+0001a470: 4672 616d 6520 6f72 2074 7570 6c65 0a20  Frame or tuple. 
+0001a480: 2020 2020 2020 2049 676e 6f72 696e 6720         Ignoring 
+0001a490: 7468 6520 7475 706c 6520 696e 7075 7420  the tuple input 
+0001a4a0: 6f70 7469 6f6e 2066 6f72 206e 6f77 2c20  option for now, 
+0001a4b0: 6072 3167 7269 6473 6020 636f 6e74 6169  `r1grids` contai
+0001a4c0: 6e73 0a20 2020 2020 2020 2074 6865 2069  ns.        the i
+0001a4d0: 6473 2061 6e64 206c 6f63 6174 696f 6e73  ds and locations
+0001a4e0: 206f 6620 7468 6520 7269 6e67 2031 2067   of the ring 1 g
+0001a4f0: 7269 6473 2069 6e20 6261 7369 630a 2020  rids in basic.  
+0001a500: 2020 2020 2020 636f 6f72 6469 6e61 7465        coordinate
+0001a510: 732e 2049 6620 3264 2061 7272 6179 5f6c  s. If 2d array_l
+0001a520: 696b 652c 2069 7420 6861 7320 3420 636f  ike, it has 4 co
+0001a530: 6c75 6d6e 7320 6465 7363 7269 6269 6e67  lumns describing
+0001a540: 2074 6865 0a20 2020 2020 2020 2072 696e   the.        rin
+0001a550: 6720 3120 6772 6964 733a 3a0a 0a20 2020  g 1 grids::..   
+0001a560: 2020 2020 2020 2020 2020 5b69 642c 2078            [id, x
+0001a570: 2c20 792c 207a 5d20 3c20 2d2d 2062 6173  , y, z] < -- bas
+0001a580: 6963 2063 6f6f 7264 696e 6174 6573 0a0a  ic coordinates..
+0001a590: 2020 2020 2020 2020 4966 2044 6174 6146          If DataF
+0001a5a0: 7261 6d65 2c20 6974 2069 7320 6173 7375  rame, it is assu
+0001a5b0: 6d65 6420 746f 2062 6520 7468 6520 5553  med to be the US
+0001a5c0: 4554 2044 6174 6146 7261 6d65 0a20 2020  ET DataFrame.   
+0001a5d0: 2020 2020 2063 6f6e 7461 696e 696e 6720       containing 
+0001a5e0: 6a75 7374 2074 6865 2072 696e 6720 3120  just the ring 1 
+0001a5f0: 6772 6964 732e 2054 6865 2066 6f72 6d61  grids. The forma
+0001a600: 7420 6f66 2074 6869 730a 2020 2020 2020  t of this.      
+0001a610: 2020 4461 7461 4672 616d 6520 6973 2064    DataFrame is d
+0001a620: 6573 6372 6962 6564 2069 6e0a 2020 2020  escribed in.    
+0001a630: 2020 2020 3a66 756e 633a 6070 7979 6574      :func:`pyyet
+0001a640: 692e 6e61 7374 7261 6e2e 6f70 322e 4f50  i.nastran.op2.OP
+0001a650: 322e 7264 6e32 636f 7032 602e 0a0a 2020  2.rdn2cop2`...  
+0001a660: 2020 2020 2020 5468 6520 6465 6661 756c        The defaul
+0001a670: 7420 6e61 6d65 2069 6e20 7468 6520 6f75  t name in the ou
+0001a680: 7470 7574 2063 6f6d 6d65 6e74 7320 666f  tput comments fo
+0001a690: 7220 7269 6e67 2031 2069 7320 2752 696e  r ring 1 is 'Rin
+0001a6a0: 670a 2020 2020 2020 2020 3127 2e20 4279  g.        1'. By
+0001a6b0: 2075 7369 6e67 2074 6865 2074 7570 6c65   using the tuple
+0001a6c0: 2069 6e70 7574 206f 7074 696f 6e2c 2079   input option, y
+0001a6d0: 6f75 2063 616e 2070 726f 7669 6465 2061  ou can provide a
+0001a6e0: 0a20 2020 2020 2020 206e 616d 652e 2046  .        name. F
+0001a6f0: 6f72 2065 7861 6d70 6c65 2c20 7468 6520  or example, the 
+0001a700: 6465 6661 756c 7420 6973 2065 7175 6976  default is equiv
+0001a710: 616c 656e 7420 746f 3a3a 0a0a 2020 2020  alent to::..    
+0001a720: 2020 2020 2020 2020 2827 5269 6e67 2031          ('Ring 1
+0001a730: 272c 2072 3167 7269 6473 290a 0a20 2020  ', r1grids)..   
+0001a740: 2020 2020 202e 2e20 6e6f 7465 3a3a 0a20       .. note::. 
+0001a750: 2020 2020 2020 2020 2020 2020 4e6f 7465              Note
+0001a760: 2074 6861 7420 7768 656e 2075 7369 6e67   that when using
+0001a770: 2061 2055 5345 5420 7461 626c 652c 2074   a USET table, t
+0001a780: 6865 2067 7269 6473 2063 616e 2062 650a  he grids can be.
+0001a790: 2020 2020 2020 2020 2020 2020 2064 6566               def
+0001a7a0: 696e 6564 2069 6e20 616e 7920 6c6f 6361  ined in any loca
+0001a7b0: 6c20 636f 6f72 6469 6e61 7465 2073 7973  l coordinate sys
+0001a7c0: 7465 6d28 7329 2e20 486f 7765 7665 722c  tem(s). However,
+0001a7d0: 2062 6f74 680a 2020 2020 2020 2020 2020   both.          
+0001a7e0: 2020 2060 7231 6772 6964 7360 2061 6e64     `r1grids` and
+0001a7f0: 2060 7232 6772 6964 7360 206d 7573 7420   `r2grids` must 
+0001a800: 7573 6520 7468 6520 7361 6d65 2062 6173  use the same bas
+0001a810: 6963 0a20 2020 2020 2020 2020 2020 2020  ic.             
+0001a820: 636f 6f72 6469 6e61 7465 2073 7973 7465  coordinate syste
+0001a830: 6d2e 0a0a 2020 2020 7232 6772 6964 7320  m...    r2grids 
+0001a840: 3a20 3264 2061 7272 6179 5f6c 696b 6520  : 2d array_like 
+0001a850: 6f72 2044 6174 6146 7261 6d65 206f 7220  or DataFrame or 
+0001a860: 7475 706c 650a 2020 2020 2020 2020 436f  tuple.        Co
+0001a870: 6e74 6169 6e73 2074 6865 2069 6473 2061  ntains the ids a
+0001a880: 6e64 206c 6f63 6174 696f 6e73 2028 616e  nd locations (an
+0001a890: 6420 6f70 7469 6f6e 616c 6c79 2c20 7468  d optionally, th
+0001a8a0: 6520 6e61 6d65 2920 6f66 0a20 2020 2020  e name) of.     
+0001a8b0: 2020 2074 6865 2072 696e 6720 3220 6772     the ring 2 gr
+0001a8c0: 6964 7320 696e 2062 6173 6963 2063 6f6f  ids in basic coo
+0001a8d0: 7264 696e 6174 6573 2e20 5365 6520 6072  rdinates. See `r
+0001a8e0: 3167 7269 6473 6020 666f 720a 2020 2020  1grids` for.    
+0001a8f0: 2020 2020 6465 7363 7269 7074 696f 6e20      description 
+0001a900: 6f66 2066 6f72 6d61 742e 2054 6865 2064  of format. The d
+0001a910: 6566 6175 6c74 206e 616d 6520 666f 7220  efault name for 
+0001a920: 7269 6e67 2032 2069 7320 2752 696e 670a  ring 2 is 'Ring.
+0001a930: 2020 2020 2020 2020 3227 2e0a 2020 2020          2'..    
+0001a940: 6e6f 6465 5f69 6430 203a 2069 6e74 6567  node_id0 : integ
+0001a950: 6572 0a20 2020 2020 2020 2031 7374 2069  er.        1st i
+0001a960: 6420 6f66 206e 6577 206e 6f64 6573 2063  d of new nodes c
+0001a970: 7265 6174 6564 2074 6f20 276d 6f76 6527  reated to 'move'
+0001a980: 2072 696e 6720 3120 6e6f 6465 730a 2020   ring 1 nodes.  
+0001a990: 2020 7273 706c 696e 655f 6964 3020 3a20    rspline_id0 : 
+0001a9a0: 696e 7465 6765 720a 2020 2020 2020 2020  integer.        
+0001a9b0: 3173 7420 6964 206f 6620 5253 504c 494e  1st id of RSPLIN
+0001a9c0: 4573 0a20 2020 2072 6265 325f 6964 3020  Es.    rbe2_id0 
+0001a9d0: 3a20 696e 7465 6765 7220 6f72 204e 6f6e  : integer or Non
+0001a9e0: 653b 206f 7074 696f 6e61 6c0a 2020 2020  e; optional.    
+0001a9f0: 2020 2020 3173 7420 6964 206f 6620 5242      1st id of RB
+0001aa00: 4532 2065 6c65 6d65 6e74 7320 7468 6174  E2 elements that
+0001aa10: 2077 696c 6c20 636f 6e6e 6563 7420 6f6c   will connect ol
+0001aa20: 6420 7269 6e67 2031 206e 6f64 6573 2074  d ring 1 nodes t
+0001aa30: 6f0a 2020 2020 2020 2020 6e65 7720 6f6e  o.        new on
+0001aa40: 6573 2e20 4966 204e 6f6e 652c 2060 6072  es. If None, ``r
+0001aa50: 6265 325f 6964 3020 3d20 6e6f 6465 5f69  be2_id0 = node_i
+0001aa60: 6430 6060 2e0a 2020 2020 636f 7264 5f69  d0``..    cord_i
+0001aa70: 6420 3a20 696e 7465 6765 7220 6f72 204e  d : integer or N
+0001aa80: 6f6e 653b 206f 7074 696f 6e61 6c0a 2020  one; optional.  
+0001aa90: 2020 2020 2020 4944 2066 6f72 2074 6865        ID for the
+0001aaa0: 206c 6f63 616c 2063 6f6f 7264 696e 6174   local coordinat
+0001aab0: 6520 7379 7374 656d 2066 6f72 2074 6865  e system for the
+0001aac0: 2060 7231 6772 6964 7360 2e20 4966 204e   `r1grids`. If N
+0001aad0: 6f6e 652c 0a20 2020 2020 2020 2069 7420  one,.        it 
+0001aae0: 6973 2073 6574 2074 6f20 6060 6e6f 6465  is set to ``node
+0001aaf0: 5f69 6430 202a 2031 3060 602e 0a20 2020  _id0 * 10``..   
+0001ab00: 206d 616b 6570 6c6f 7420 3a20 7374 7269   makeplot : stri
+0001ab10: 6e67 206f 7220 6178 6573 206f 626a 6563  ng or axes objec
+0001ab20: 743b 206f 7074 696f 6e61 6c0a 2020 2020  t; optional.    
+0001ab30: 2020 2020 5370 6563 6966 6965 7320 6966      Specifies if
+0001ab40: 2061 6e64 2068 6f77 2074 6f20 706c 6f74   and how to plot
+0001ab50: 2064 6174 6120 7368 6f77 696e 6720 7468   data showing th
+0001ab60: 6520 5253 504c 494e 452e 0a0a 2020 2020  e RSPLINE...    
+0001ab70: 2020 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d20      =========== 
+0001ab80: 2020 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d    ==============
+0001ab90: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0001aba0: 3d0a 2020 2020 2020 2020 606d 616b 6570  =.        `makep
+0001abb0: 6c6f 7460 2020 2020 4465 7363 7269 7074  lot`    Descript
+0001abc0: 696f 6e0a 2020 2020 2020 2020 3d3d 3d3d  ion.        ====
+0001abd0: 3d3d 3d3d 3d3d 3d20 2020 3d3d 3d3d 3d3d  =======   ======
+0001abe0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0001abf0: 3d3d 3d3d 3d3d 3d3d 3d0a 2020 2020 2020  =========.      
+0001ac00: 2020 2020 2020 276e 6f27 2020 2020 2020        'no'      
+0001ac10: 646f 206e 6f74 2070 6c6f 740a 2020 2020  do not plot.    
+0001ac20: 2020 2020 2027 636c 6561 7227 2020 2020       'clear'    
+0001ac30: 2020 706c 6f74 2061 6674 6572 2063 6c65    plot after cle
+0001ac40: 6172 696e 6720 6669 6775 7265 0a20 2020  aring figure.   
+0001ac50: 2020 2020 2020 2020 2761 6464 2720 2020          'add'   
+0001ac60: 2020 2070 6c6f 7420 7769 7468 6f75 7420     plot without 
+0001ac70: 636c 6561 7269 6e67 2066 6967 7572 650a  clearing figure.
+0001ac80: 2020 2020 2020 2020 2020 2027 6e65 7727             'new'
+0001ac90: 2020 2020 2020 706c 6f74 2069 6e20 6e65        plot in ne
+0001aca0: 7720 6669 6775 7265 0a20 2020 2020 2020  w figure.       
+0001acb0: 2061 7865 7320 6f62 6a65 6374 2020 2070   axes object   p
+0001acc0: 6c6f 7420 696e 2067 6976 656e 2061 7865  lot in given axe
+0001acd0: 7320 286c 696b 6520 2761 6464 2729 0a20  s (like 'add'). 
+0001ace0: 2020 2020 2020 203d 3d3d 3d3d 3d3d 3d3d         =========
+0001acf0: 3d3d 2020 203d 3d3d 3d3d 3d3d 3d3d 3d3d  ==   ===========
+0001ad00: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0001ad10: 3d3d 3d3d 0a0a 2020 2020 2020 2020 4e6f  ====..        No
+0001ad20: 7465 2074 6861 7420 6966 2060 6d61 6b65  te that if `make
+0001ad30: 706c 6f74 6020 6973 2027 6164 6427 206f  plot` is 'add' o
+0001ad40: 7220 616e 2061 7865 7320 6f62 6a65 6374  r an axes object
+0001ad50: 2c20 6974 206d 7573 7420 6265 0a20 2020  , it must be.   
+0001ad60: 2020 2020 2033 643b 206f 7468 6572 7769       3d; otherwi
+0001ad70: 7365 2061 2056 616c 7565 4572 726f 7220  se a ValueError 
+0001ad80: 6578 6365 7074 696f 6e20 6973 2072 6169  exception is rai
+0001ad90: 7365 642e 0a0a 2020 2020 446f 4c20 3a20  sed...    DoL : 
+0001ada0: 7374 7269 6e67 206f 7220 7265 616c 2073  string or real s
+0001adb0: 6361 6c61 723b 206f 7074 696f 6e61 6c0a  calar; optional.
+0001adc0: 2020 2020 2020 2020 5370 6563 6966 6965          Specifie
+0001add0: 7320 7261 7469 6f20 6f66 2064 6961 6d65  s ratio of diame
+0001ade0: 7465 7220 6f66 2065 6c61 7374 6963 2074  ter of elastic t
+0001adf0: 7962 6520 746f 2074 6865 2073 756d 206f  ybe to the sum o
+0001ae00: 6620 7468 650a 2020 2020 2020 2020 6c65  f the.        le
+0001ae10: 6e67 7468 7320 6f66 2061 6c6c 2073 6567  ngths of all seg
+0001ae20: 6d65 6e74 732e 2057 7269 7474 656e 2077  ments. Written w
+0001ae30: 6974 683a 2060 6066 277b 446f 4c3a 3c38  ith: ``f'{DoL:<8
+0001ae40: 7d27 6060 0a20 2020 2069 6e64 6570 656e  }'``.    indepen
+0001ae50: 6465 6e74 203a 2073 7472 3b20 6f70 7469  dent : str; opti
+0001ae60: 6f6e 616c 0a20 2020 2020 2020 2045 6974  onal.        Eit
+0001ae70: 6865 7220 2772 696e 6731 2720 6f72 2027  her 'ring1' or '
+0001ae80: 7269 6e67 3227 206f 7220 7468 6520 6173  ring2' or the as
+0001ae90: 7369 676e 6564 206e 616d 6520 6966 206f  signed name if o
+0001aea0: 6e65 2077 6173 0a20 2020 2020 2020 2070  ne was.        p
+0001aeb0: 726f 7669 6465 6420 696e 2074 6865 2060  rovided in the `
+0001aec0: 7231 6772 6964 7360 206f 7220 6072 3267  r1grids` or `r2g
+0001aed0: 7269 6473 6020 696e 7075 742e 2054 6869  rids` input. Thi
+0001aee0: 7320 696e 7075 7420 6973 0a20 2020 2020  s input is.     
+0001aef0: 2020 2063 6173 652d 696e 7365 6e73 6974     case-insensit
+0001af00: 6976 6520 616e 6420 616c 6c20 7370 6163  ive and all spac
+0001af10: 6573 2061 7265 2069 676e 6f72 6564 2c20  es are ignored, 
+0001af20: 736f 2027 5269 6e67 2031 2720 6973 0a20  so 'Ring 1' is. 
+0001af30: 2020 2020 2020 2074 6865 2073 616d 6520         the same 
+0001af40: 6173 2027 7269 6e67 3127 2e20 5370 6563  as 'ring1'. Spec
+0001af50: 6966 6965 7320 7768 6963 6820 7269 6e67  ifies which ring
+0001af60: 2077 696c 6c20 6265 2069 6e64 6570 656e   will be indepen
+0001af70: 6465 6e74 0a20 2020 2020 2020 206f 6e20  dent.        on 
+0001af80: 7468 6520 5253 504c 494e 4573 2e20 4e6f  the RSPLINEs. No
+0001af90: 7465 2074 6861 7420 6973 2064 6966 6665  te that is diffe
+0001afa0: 7265 6e74 2074 6861 6e20 6a75 7374 2073  rent than just s
+0001afb0: 7769 7463 6869 6e67 0a20 2020 2020 2020  witching.       
+0001afc0: 2074 6865 206f 7264 6572 206f 6620 6072   the order of `r
+0001afd0: 3167 7269 6473 6020 616e 6420 6072 3267  1grids` and `r2g
+0001afe0: 7269 6473 602e 2054 6869 7320 6f70 7469  rids`. This opti
+0001aff0: 6f6e 206d 6f64 6966 6965 730a 2020 2020  on modifies.    
+0001b000: 2020 2020 7374 6570 2034 2062 656c 6f77      step 4 below
+0001b010: 2077 6869 6c65 2073 7769 7463 6869 6e67   while switching
+0001b020: 2060 7231 6772 6964 7360 2061 6e64 2060   `r1grids` and `
+0001b030: 7232 6772 6964 7360 206d 6f64 6966 6965  r2grids` modifie
+0001b040: 730a 2020 2020 2020 2020 616c 6c20 7468  s.        all th
+0001b050: 6520 7374 6570 732e 0a0a 2020 2020 5265  e steps...    Re
+0001b060: 7475 726e 730a 2020 2020 2d2d 2d2d 2d2d  turns.    ------
+0001b070: 2d0a 2020 2020 4e6f 6e65 0a0a 2020 2020  -.    None..    
+0001b080: 4e6f 7465 730a 2020 2020 2d2d 2d2d 2d0a  Notes.    -----.
+0001b090: 2020 2020 5468 6973 2072 6f75 7469 6e65      This routine
+0001b0a0: 2077 7269 7465 7320 4752 4944 2c20 5242   writes GRID, RB
+0001b0b0: 4532 2061 6e64 2052 5350 4c49 4e45 206c  E2 and RSPLINE l
+0001b0c0: 696e 6573 2074 6f20 7468 6520 6f75 7470  ines to the outp
+0001b0d0: 7574 0a20 2020 2066 696c 652e 0a0a 2020  ut.    file...  
+0001b0e0: 2020 5468 6520 6170 7072 6f61 6368 2069    The approach i
+0001b0f0: 7320 6173 2066 6f6c 6c6f 7773 2028 4e20  s as follows (N 
+0001b100: 3d20 6e75 6d62 6572 206f 6620 7269 6e67  = number of ring
+0001b110: 2031 2067 7269 6473 293a 0a0a 2020 2020   1 grids):..    
+0001b120: 2020 312e 2046 6974 2061 2063 6972 636c    1. Fit a circl
+0001b130: 6520 7468 726f 7567 6820 626f 7468 2074  e through both t
+0001b140: 6865 2072 696e 6720 3120 6e6f 6465 7320  he ring 1 nodes 
+0001b150: 616e 6420 7468 6520 7269 6e67 2032 0a20  and the ring 2. 
+0001b160: 2020 2020 2020 2020 6e6f 6465 732e 2041          nodes. A
+0001b170: 206e 6577 2022 7269 6e67 2031 2220 6c6f   new "ring 1" lo
+0001b180: 6361 6c20 636f 6f72 6469 6e61 7465 2073  cal coordinate s
+0001b190: 7973 7465 6d20 6973 2064 6566 696e 6564  ystem is defined
+0001b1a0: 2028 7365 650a 2020 2020 2020 2020 203a   (see.         :
+0001b1b0: 6675 6e63 3a60 7079 7965 7469 2e79 746f  func:`pyyeti.yto
+0001b1c0: 6f6c 732e 6669 745f 6369 7263 6c65 5f33  ols.fit_circle_3
+0001b1d0: 6460 2920 746f 2073 696d 706c 6966 7920  d`) to simplify 
+0001b1e0: 7468 6520 6372 6561 7469 6f6e 0a20 2020  the creation.   
+0001b1f0: 2020 2020 2020 6f66 2074 6865 206e 6577        of the new
+0001b200: 2052 5350 4c49 4e45 2e20 496e 2074 6865   RSPLINE. In the
+0001b210: 206c 6f63 616c 2073 7973 7465 6d2c 207a   local system, z
+0001b220: 2069 7320 7065 7270 656e 6469 6375 6c61   is perpendicula
+0001b230: 720a 2020 2020 2020 2020 2074 6f20 7468  r.         to th
+0001b240: 6520 706c 616e 6520 6f66 2074 6865 2063  e plane of the c
+0001b250: 6972 636c 6520 616e 6420 7820 6973 2061  ircle and x is a
+0001b260: 6c69 676e 6564 2077 6974 6820 6e6f 6465  ligned with node
+0001b270: 2031 206f 660a 2020 2020 2020 2020 2072   1 of.         r
+0001b280: 696e 6720 312e 0a20 2020 2020 2032 2e20  ing 1..      2. 
+0001b290: 4372 6561 7465 204e 206e 6577 2072 696e  Create N new rin
+0001b2a0: 6720 3120 6772 6964 7320 6174 2073 7461  g 1 grids at sta
+0001b2b0: 7469 6f6e 2061 6e64 2072 6164 6975 7320  tion and radius 
+0001b2c0: 6f66 2072 696e 6720 320a 2020 2020 2020  of ring 2.      
+0001b2d0: 2020 2067 7269 6473 2c20 6275 7420 6174     grids, but at
+0001b2e0: 2074 6865 2073 616d 6520 616e 6775 6c61   the same angula
+0001b2f0: 7220 6c6f 6361 7469 6f6e 2061 7320 6f72  r location as or
+0001b300: 6967 696e 616c 204e 2e0a 2020 2020 2020  iginal N..      
+0001b310: 332e 2052 4245 3220 7468 6573 6520 6e65  3. RBE2 these ne
+0001b320: 7720 6772 6964 7320 746f 2074 6865 204e  w grids to the N
+0001b330: 206f 7269 6769 6e61 6c20 6772 6964 732e   original grids.
+0001b340: 2054 6865 206e 6577 2067 7269 6473 0a20   The new grids. 
+0001b350: 2020 2020 2020 2020 6172 6520 696e 6465          are inde
+0001b360: 7065 6e64 656e 742e 0a20 2020 2020 2034  pendent..      4
+0001b370: 2e20 5772 6974 6520 5253 504c 494e 4520  . Write RSPLINE 
+0001b380: 6361 7264 7320 7573 696e 6720 3a66 756e  cards using :fun
+0001b390: 633a 6077 7472 7370 6c69 6e65 602e 2054  c:`wtrspline`. T
+0001b3a0: 6865 2066 6972 7374 0a20 2020 2020 2020  he first.       
+0001b3b0: 2020 5253 504c 494e 4520 7374 6172 7473    RSPLINE starts
+0001b3c0: 2061 7420 7468 6520 696e 6465 7065 6e64   at the independ
+0001b3d0: 656e 7420 6772 6964 2028 6f6e 2072 696e  ent grid (on rin
+0001b3e0: 6720 3120 6f72 2072 696e 6720 320a 2020  g 1 or ring 2.  
+0001b3f0: 2020 2020 2020 2061 6363 6f72 6469 6e67         according
+0001b400: 2074 6f20 6069 6e64 6570 656e 6465 6e74   to `independent
+0001b410: 6029 2077 6974 6820 7468 6520 6c6f 7765  `) with the lowe
+0001b420: 7374 2061 6e67 756c 6172 0a20 2020 2020  st angular.     
+0001b430: 2020 2020 6c6f 6361 7469 6f6e 2e20 5468      location. Th
+0001b440: 6520 616e 6775 6c61 7220 6c6f 6361 7469  e angular locati
+0001b450: 6f6e 7320 7261 6e67 6520 6672 6f6d 2030  ons range from 0
+0001b460: 2074 6f20 3336 3020 6465 6772 6565 732c   to 360 degrees,
+0001b470: 0a20 2020 2020 2020 2020 636f 756e 7465  .         counte
+0001b480: 722d 636c 6f63 6b77 6973 652e 2054 6865  r-clockwise. The
+0001b490: 2052 5350 4c49 4e45 7320 7072 6f63 6565   RSPLINEs procee
+0001b4a0: 6420 636f 756e 7465 722d 636c 6f63 6b77  d counter-clockw
+0001b4b0: 6973 650a 2020 2020 2020 2020 2061 726f  ise.         aro
+0001b4c0: 756e 6420 7468 6520 6369 7263 6c65 2e0a  und the circle..
+0001b4d0: 0a20 2020 2053 6565 2061 6c73 6f0a 2020  .    See also.  
+0001b4e0: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 203a    --------.    :
+0001b4f0: 6675 6e63 3a60 7774 7273 706c 696e 6560  func:`wtrspline`
+0001b500: 0a0a 2020 2020 5261 6973 6573 0a20 2020  ..    Raises.   
+0001b510: 202d 2d2d 2d2d 2d0a 2020 2020 5661 6c75   ------.    Valu
+0001b520: 6545 7272 6f72 0a0a 2020 2020 2020 2020  eError..        
+0001b530: 5768 656e 2074 6865 2070 6572 7065 6e64  When the perpend
+0001b540: 6963 756c 6172 2064 6972 6563 7469 6f6e  icular direction
+0001b550: 7320 6f66 2060 7231 6772 6964 7360 2061  s of `r1grids` a
+0001b560: 6e64 2060 7232 6772 6964 7360 0a20 2020  nd `r2grids`.   
+0001b570: 2020 2020 2064 6f20 6e6f 7420 6d61 7463       do not matc
+0001b580: 6820 7769 7468 696e 2074 6f6c 6572 616e  h within toleran
+0001b590: 6365 3a20 6162 736f 6c75 7465 2076 616c  ce: absolute val
+0001b5a0: 7565 206f 6620 7468 6520 636f 7369 6e65  ue of the cosine
+0001b5b0: 206f 660a 2020 2020 2020 2020 7468 6520   of.        the 
+0001b5c0: 616e 676c 6520 6265 7477 6565 6e20 7468  angle between th
+0001b5d0: 6520 7477 6f20 7065 7270 656e 6469 6375  e two perpendicu
+0001b5e0: 6c61 7220 6469 7265 6374 696f 6e73 206d  lar directions m
+0001b5f0: 7573 7420 6265 203e 0a20 2020 2020 2020  ust be >.       
+0001b600: 2030 2e39 392e 0a0a 2020 2020 2020 2020   0.99...        
+0001b610: 5768 656e 2061 2060 7231 6772 6964 7360  When a `r1grids`
+0001b620: 206f 7220 6072 3267 7269 6473 6020 4461   or `r2grids` Da
+0001b630: 7461 4672 616d 6520 646f 6573 206e 6f74  taFrame does not
+0001b640: 2068 6176 6520 610a 2020 2020 2020 2020   have a.        
+0001b650: 6d75 6c74 6970 6c65 206f 6620 3620 726f  multiple of 6 ro
+0001b660: 7773 2e0a 0a20 2020 2020 2020 2057 6865  ws...        Whe
+0001b670: 6e20 7468 6520 606d 616b 6570 6c6f 7460  n the `makeplot`
+0001b680: 206f 7074 696f 6e20 7472 6965 7320 746f   option tries to
+0001b690: 2061 6464 2074 6f20 616e 2061 7865 7320   add to an axes 
+0001b6a0: 6f62 6a65 6374 2074 6861 740a 2020 2020  object that.    
+0001b6b0: 2020 2020 6973 206e 6f74 2075 7369 6e67      is not using
+0001b6c0: 2061 2033 6420 7072 6f6a 6563 7469 6f6e   a 3d projection
+0001b6d0: 2e0a 0a20 2020 2045 7861 6d70 6c65 730a  ...    Examples.
+0001b6e0: 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020      --------.   
+0001b6f0: 2044 6566 696e 6520 7477 6f20 7269 6e67   Define two ring
+0001b700: 7320 6f66 2067 7269 6473 3a0a 0a20 2020  s of grids:..   
+0001b710: 2031 2e20 5269 6e67 2031 2077 696c 6c20   1. Ring 1 will 
+0001b720: 6265 2061 7420 7374 6174 696f 6e20 302e  be at station 0.
+0001b730: 3020 7769 7468 2035 206e 6f64 6573 206f  0 with 5 nodes o
+0001b740: 6e20 7269 6e67 206f 6620 7261 6469 7573  n ring of radius
+0001b750: 0a20 2020 2020 2020 3530 2e20 4944 7320  .       50. IDs 
+0001b760: 7769 6c6c 2062 6520 3120 746f 2035 2e0a  will be 1 to 5..
+0001b770: 0a20 2020 2032 2e20 5269 6e67 2032 2077  .    2. Ring 2 w
+0001b780: 696c 6c20 6265 2061 7420 7374 6174 696f  ill be at statio
+0001b790: 6e20 312e 3020 7769 7468 2037 206e 6f64  n 1.0 with 7 nod
+0001b7a0: 6573 206f 6e20 7269 6e67 206f 6620 7261  es on ring of ra
+0001b7b0: 6469 7573 0a20 2020 2020 2020 3435 2e20  dius.       45. 
+0001b7c0: 4944 7320 7769 6c6c 2062 6520 3130 3120  IDs will be 101 
+0001b7d0: 746f 2031 3037 2e0a 0a20 2020 2046 6f72  to 107...    For
+0001b7e0: 2064 656d 6f6e 7374 7261 7469 6f6e 2c20   demonstration, 
+0001b7f0: 7269 6e67 2031 2077 696c 6c20 6265 206e  ring 1 will be n
+0001b800: 616d 6564 2027 5370 6163 6563 7261 6674  amed 'Spacecraft
+0001b810: 2720 7768 696c 6520 7468 650a 2020 2020  ' while the.    
+0001b820: 6465 6661 756c 7420 7769 6c6c 2062 6520  default will be 
+0001b830: 6163 6365 7074 6564 2066 6f72 2072 696e  accepted for rin
+0001b840: 6720 3220 2877 6869 6368 2069 7320 2752  g 2 (which is 'R
+0001b850: 696e 6720 3227 292e 0a0a 2020 2020 2e2e  ing 2')...    ..
+0001b860: 2070 6c6f 743a 3a0a 2020 2020 2020 2020   plot::.        
+0001b870: 3a63 6f6e 7465 7874 3a20 636c 6f73 652d  :context: close-
+0001b880: 6669 6773 0a0a 2020 2020 2020 2020 3e3e  figs..        >>
+0001b890: 3e20 696d 706f 7274 206e 756d 7079 2061  > import numpy a
+0001b8a0: 7320 6e70 0a20 2020 2020 2020 203e 3e3e  s np.        >>>
+0001b8b0: 2069 6d70 6f72 7420 6d61 7470 6c6f 746c   import matplotl
+0001b8c0: 6962 2e70 7970 6c6f 7420 6173 2070 6c74  ib.pyplot as plt
+0001b8d0: 0a20 2020 2020 2020 203e 3e3e 2066 726f  .        >>> fro
+0001b8e0: 6d20 7079 7965 7469 2069 6d70 6f72 7420  m pyyeti import 
+0001b8f0: 6e61 7374 7261 6e0a 2020 2020 2020 2020  nastran.        
+0001b900: 3e3e 3e20 7468 6574 6131 203d 206e 702e  >>> theta1 = np.
+0001b910: 6172 616e 6765 2830 2c20 3335 392c 2033  arange(0, 359, 3
+0001b920: 3630 2f35 292a 6e70 2e70 692f 3138 300a  60/5)*np.pi/180.
+0001b930: 2020 2020 2020 2020 3e3e 3e20 7261 6431          >>> rad1
+0001b940: 203d 2035 302e 0a20 2020 2020 2020 203e   = 50..        >
+0001b950: 3e3e 2073 7461 3120 3d20 302e 0a20 2020  >> sta1 = 0..   
+0001b960: 2020 2020 203e 3e3e 206e 3120 3d20 6c65       >>> n1 = le
+0001b970: 6e28 7468 6574 6131 290a 2020 2020 2020  n(theta1).      
+0001b980: 2020 3e3e 3e20 7269 6e67 3120 3d20 6e70    >>> ring1 = np
+0001b990: 2e76 7374 6163 6b28 286e 702e 6172 616e  .vstack((np.aran
+0001b9a0: 6765 2831 2c20 6e31 2b31 292c 2020 2020  ge(1, n1+1),    
+0001b9b0: 2020 2320 4944 0a20 2020 2020 2020 202e    # ID.        .
+0001b9c0: 2e2e 2020 2020 2020 2020 2020 2020 2020  ..              
+0001b9d0: 2020 2020 2020 7374 6131 2a6e 702e 6f6e        sta1*np.on
+0001b9e0: 6573 286e 3129 2c20 2020 2020 2020 2023  es(n1),        #
+0001b9f0: 2078 0a20 2020 2020 2020 202e 2e2e 2020   x.        ...  
+0001ba00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ba10: 2020 7261 6431 2a6e 702e 636f 7328 7468    rad1*np.cos(th
+0001ba20: 6574 6131 292c 2020 2020 2023 2079 0a20  eta1),     # y. 
+0001ba30: 2020 2020 2020 202e 2e2e 2020 2020 2020         ...      
+0001ba40: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+0001ba50: 6431 2a6e 702e 7369 6e28 7468 6574 6131  d1*np.sin(theta1
+0001ba60: 2929 292e 5420 2023 207a 0a20 2020 2020  ))).T  # z.     
+0001ba70: 2020 203e 3e3e 2023 2050 726f 7669 6465     >>> # Provide
+0001ba80: 2061 206e 616d 6520 666f 7220 7269 6e67   a name for ring
+0001ba90: 2031 3a0a 2020 2020 2020 2020 3e3e 3e20   1:.        >>> 
+0001baa0: 7269 6e67 3120 3d20 2827 5370 6163 6563  ring1 = ('Spacec
+0001bab0: 7261 6674 272c 2072 696e 6731 290a 2020  raft', ring1).  
+0001bac0: 2020 2020 2020 3e3e 3e20 7468 6574 6132        >>> theta2
+0001bad0: 203d 206e 702e 6172 616e 6765 2831 302c   = np.arange(10,
+0001bae0: 2033 3539 2c20 3336 302f 3729 2a6e 702e   359, 360/7)*np.
+0001baf0: 7069 2f31 3830 0a20 2020 2020 2020 203e  pi/180.        >
+0001bb00: 3e3e 2072 6164 3220 3d20 3435 2e0a 2020  >> rad2 = 45..  
+0001bb10: 2020 2020 2020 3e3e 3e20 7374 6132 203d        >>> sta2 =
+0001bb20: 2031 2e0a 2020 2020 2020 2020 3e3e 3e20   1..        >>> 
+0001bb30: 6e32 203d 206c 656e 2874 6865 7461 3229  n2 = len(theta2)
+0001bb40: 0a20 2020 2020 2020 203e 3e3e 2072 696e  .        >>> rin
+0001bb50: 6732 203d 206e 702e 7673 7461 636b 2828  g2 = np.vstack((
+0001bb60: 6e70 2e61 7261 6e67 6528 312c 206e 322b  np.arange(1, n2+
+0001bb70: 3129 2b31 3030 2c20 2023 2049 440a 2020  1)+100,  # ID.  
+0001bb80: 2020 2020 2020 2e2e 2e20 2020 2020 2020        ...       
+0001bb90: 2020 2020 2020 2020 2020 2020 2073 7461               sta
+0001bba0: 322a 6e70 2e6f 6e65 7328 6e32 292c 2020  2*np.ones(n2),  
+0001bbb0: 2020 2020 2020 2320 780a 2020 2020 2020        # x.      
+0001bbc0: 2020 2e2e 2e20 2020 2020 2020 2020 2020    ...           
+0001bbd0: 2020 2020 2020 2020 2072 6164 322a 6e70           rad2*np
+0001bbe0: 2e63 6f73 2874 6865 7461 3229 2c20 2020  .cos(theta2),   
+0001bbf0: 2020 2320 790a 2020 2020 2020 2020 2e2e    # y.        ..
+0001bc00: 2e20 2020 2020 2020 2020 2020 2020 2020  .               
+0001bc10: 2020 2020 2072 6164 322a 6e70 2e73 696e       rad2*np.sin
+0001bc20: 2874 6865 7461 3229 2929 2e54 2020 2320  (theta2))).T  # 
+0001bc30: 7a0a 2020 2020 2020 2020 3e3e 3e20 6669  z.        >>> fi
+0001bc40: 6720 3d20 706c 742e 6669 6775 7265 2827  g = plt.figure('
+0001bc50: 4578 616d 706c 6527 2c20 6669 6773 697a  Example', figsiz
+0001bc60: 653d 2838 2c20 3629 290a 2020 2020 2020  e=(8, 6)).      
+0001bc70: 2020 3e3e 3e20 6669 672e 636c 6628 290a    >>> fig.clf().
+0001bc80: 2020 2020 2020 2020 3e3e 3e20 6178 203d          >>> ax =
+0001bc90: 2066 6967 2e61 6464 5f73 7562 706c 6f74   fig.add_subplot
+0001bca0: 2831 2c20 312c 2031 2c20 7072 6f6a 6563  (1, 1, 1, projec
+0001bcb0: 7469 6f6e 3d27 3364 2729 0a20 2020 2020  tion='3d').     
+0001bcc0: 2020 203e 3e3e 206e 6173 7472 616e 2e77     >>> nastran.w
+0001bcd0: 7472 7370 6c69 6e65 5f72 696e 6773 280a  trspline_rings(.
+0001bce0: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
+0001bcf0: 312c 2072 696e 6731 2c20 7269 6e67 322c  1, ring1, ring2,
+0001bd00: 2031 3030 312c 2032 3030 312c 0a20 2020   1001, 2001,.   
+0001bd10: 2020 2020 202e 2e2e 2020 2020 206d 616b       ...     mak
+0001bd20: 6570 6c6f 743d 6178 2920 2020 2320 646f  eplot=ax)   # do
+0001bd30: 6374 6573 743a 202b 534b 4950 0a20 2020  ctest: +SKIP.   
+0001bd40: 2020 2020 2024 0a20 2020 2020 2020 2024       $.        $
+0001bd50: 2046 6974 206f 6620 5370 6163 6563 7261   Fit of Spacecra
+0001bd60: 6674 2067 7269 6473 3a0a 2020 2020 2020  ft grids:.      
+0001bd70: 2020 2420 2020 2020 4365 6e74 6572 3a20    $     Center: 
+0001bd80: 5b30 2e30 3030 2c20 302e 3030 302c 2030  [0.000, 0.000, 0
+0001bd90: 2e30 3030 5d20 2869 6e20 6261 7369 6329  .000] (in basic)
+0001bda0: 0a20 2020 2020 2020 2024 2020 2020 2052  .        $     R
+0001bdb0: 6164 6975 733a 2035 302e 300a 2020 2020  adius: 50.0.    
+0001bdc0: 2020 2020 240a 2020 2020 2020 2020 2420      $.        $ 
+0001bdd0: 4669 7420 6f66 2052 696e 6720 3220 6772  Fit of Ring 2 gr
+0001bde0: 6964 733a 0a20 2020 2020 2020 2024 2020  ids:.        $  
+0001bdf0: 2020 2043 656e 7465 723a 205b 312e 3030     Center: [1.00
+0001be00: 302c 202d 312e 3737 3665 2d31 352c 202d  0, -1.776e-15, -
+0001be10: 332e 3535 3365 2d31 355d 2028 696e 2062  3.553e-15] (in b
+0001be20: 6173 6963 290a 2020 2020 2020 2020 2420  asic).        $ 
+0001be30: 2020 2020 5261 6469 7573 3a20 3435 2e30      Radius: 45.0
+0001be40: 0a20 2020 2020 2020 2024 0a20 2020 2020  .        $.     
+0001be50: 2020 2024 204f 7269 6769 6e20 6f66 206c     $ Origin of l
+0001be60: 6f63 616c 2043 4f52 4432 5220 3130 3031  ocal CORD2R 1001
+0001be70: 3020 6973 2061 7420 6365 6e74 6572 206f  0 is at center o
+0001be80: 6620 5370 6163 6563 7261 6674 3b20 7a20  f Spacecraft; z 
+0001be90: 6973 0a20 2020 2020 2020 2024 2070 6572  is.        $ per
+0001bea0: 7065 6e64 6963 756c 6172 2074 6f20 706c  pendicular to pl
+0001beb0: 616e 6520 6f66 2063 6972 636c 652c 2061  ane of circle, a
+0001bec0: 6e64 2078 2069 7320 616c 6967 6e65 6420  nd x is aligned 
+0001bed0: 7769 7468 206e 6f64 6520 3120 2861 6e64  with node 1 (and
+0001bee0: 0a20 2020 2020 2020 2024 206e 6577 206e  .        $ new n
+0001bef0: 6f64 6520 3130 3031 292e 0a20 2020 2020  ode 1001)..     
+0001bf00: 2020 2024 0a20 2020 2020 2020 2024 2043     $.        $ C
+0001bf10: 6f6f 7264 696e 6174 6520 3130 3031 303a  oordinate 10010:
+0001bf20: 0a20 2020 2020 2020 2043 4f52 4432 522a  .        CORD2R*
+0001bf30: 2020 2020 2020 2020 2020 2020 3130 3031              1001
+0001bf40: 3020 2020 2020 2020 2020 2020 2020 2020  0               
+0001bf50: 3020 2030 2e30 3030 3030 3030 3065 2b30  0  0.00000000e+0
+0001bf60: 3020 2030 2e30 3030 3030 3030 3065 2b30  0  0.00000000e+0
+0001bf70: 302a 0a20 2020 2020 2020 202a 2020 2020  0*.        *    
+0001bf80: 2020 2020 2030 2e30 3030 3030 3030 3065       0.00000000e
+0001bf90: 2b30 3020 2031 2e30 3030 3030 3030 3065  +00  1.00000000e
+0001bfa0: 2b30 3020 2030 2e30 3030 3030 3030 3065  +00  0.00000000e
+0001bfb0: 2b30 3020 2030 2e30 3030 3030 3030 3065  +00  0.00000000e
+0001bfc0: 2b30 302a 0a20 2020 2020 2020 202a 2020  +00*.        *  
+0001bfd0: 2020 2020 2020 2030 2e30 3030 3030 3030         0.0000000
+0001bfe0: 3065 2b30 3020 2031 2e30 3030 3030 3030  0e+00  1.0000000
+0001bff0: 3065 2b30 3020 2030 2e30 3030 3030 3030  0e+00  0.0000000
+0001c000: 3065 2b30 300a 2020 2020 2020 2020 240a  0e+00.        $.
+0001c010: 2020 2020 2020 2020 2420 4772 6964 7320          $ Grids 
+0001c020: 746f 2052 4245 3220 746f 2074 6865 2053  to RBE2 to the S
+0001c030: 7061 6365 6372 6166 7420 6772 6964 732e  pacecraft grids.
+0001c040: 2054 6865 7365 2067 7269 6473 206c 696e   These grids lin
+0001c050: 6520 7570 2077 6974 6820 7468 650a 2020  e up with the.  
+0001c060: 2020 2020 2020 2420 5269 6e67 2032 2063        $ Ring 2 c
+0001c070: 6972 636c 6520 736f 2074 6861 7420 7468  ircle so that th
+0001c080: 6520 5253 504c 494e 4520 2877 6869 6368  e RSPLINE (which
+0001c090: 2074 6965 7320 746f 6765 7468 6572 2074   ties together t
+0001c0a0: 6865 7365 206e 6577 2067 7269 6473 0a20  hese new grids. 
+0001c0b0: 2020 2020 2020 2024 2061 6e64 2074 6865         $ and the
+0001c0c0: 2052 696e 6720 3220 6772 6964 7329 2077   Ring 2 grids) w
+0001c0d0: 696c 6c20 6265 2073 6d6f 6f74 682e 0a20  ill be smooth.. 
+0001c0e0: 2020 2020 2020 2024 0a20 2020 2020 2020         $.       
+0001c0f0: 2047 5249 442a 2020 2020 2020 2020 2020   GRID*          
+0001c100: 2020 2020 2031 3030 3120 2020 2020 2020       1001       
+0001c110: 2020 2020 3130 3031 3020 2020 2020 3435      10010     45
+0001c120: 2e30 3030 3030 3030 3020 2020 2020 2d30  .00000000     -0
+0001c130: 2e30 3030 3030 3030 300a 2020 2020 2020  .00000000.      
+0001c140: 2020 2a20 2020 2020 2020 2020 2020 2020    *             
+0001c150: 312e 3030 3030 3030 3030 2020 2020 2020  1.00000000      
+0001c160: 2020 2020 2020 2020 2030 0a20 2020 2020           0.     
+0001c170: 2020 2047 5249 442a 2020 2020 2020 2020     GRID*        
+0001c180: 2020 2020 2020 2031 3030 3220 2020 2020         1002     
+0001c190: 2020 2020 2020 3130 3031 3020 2020 2020        10010     
+0001c1a0: 3133 2e39 3035 3736 3437 3520 2020 2020  13.90576475     
+0001c1b0: 3432 2e37 3937 3534 3332 330a 2020 2020  42.79754323.    
+0001c1c0: 2020 2020 2a20 2020 2020 2020 2020 2020      *           
+0001c1d0: 2020 312e 3030 3030 3030 3030 2020 2020    1.00000000    
+0001c1e0: 2020 2020 2020 2020 2020 2030 0a20 2020             0.   
+0001c1f0: 2020 2020 2047 5249 442a 2020 2020 2020       GRID*      
+0001c200: 2020 2020 2020 2020 2031 3030 3320 2020           1003   
+0001c210: 2020 2020 2020 2020 3130 3031 3020 2020          10010   
+0001c220: 202d 3336 2e34 3035 3736 3437 3520 2020   -36.40576475   
+0001c230: 2020 3236 2e34 3530 3333 3633 350a 2020    26.45033635.  
+0001c240: 2020 2020 2020 2a20 2020 2020 2020 2020        *         
+0001c250: 2020 2020 312e 3030 3030 3030 3030 2020      1.00000000  
+0001c260: 2020 2020 2020 2020 2020 2020 2030 0a20               0. 
+0001c270: 2020 2020 2020 2047 5249 442a 2020 2020         GRID*    
+0001c280: 2020 2020 2020 2020 2020 2031 3030 3420             1004 
+0001c290: 2020 2020 2020 2020 2020 3130 3031 3020            10010 
+0001c2a0: 2020 202d 3336 2e34 3035 3736 3437 3520     -36.40576475 
+0001c2b0: 2020 202d 3236 2e34 3530 3333 3633 350a     -26.45033635.
+0001c2c0: 2020 2020 2020 2020 2a20 2020 2020 2020          *       
+0001c2d0: 2020 2020 2020 312e 3030 3030 3030 3030        1.00000000
+0001c2e0: 2020 2020 2020 2020 2020 2020 2020 2030                 0
+0001c2f0: 0a20 2020 2020 2020 2047 5249 442a 2020  .        GRID*  
+0001c300: 2020 2020 2020 2020 2020 2020 2031 3030               100
+0001c310: 3520 2020 2020 2020 2020 2020 3130 3031  5           1001
+0001c320: 3020 2020 2020 3133 2e39 3035 3736 3437  0     13.9057647
+0001c330: 3520 2020 202d 3432 2e37 3937 3534 3332  5    -42.7975432
+0001c340: 330a 2020 2020 2020 2020 2a20 2020 2020  3.        *     
+0001c350: 2020 2020 2020 2020 312e 3030 3030 3030          1.000000
+0001c360: 3030 2020 2020 2020 2020 2020 2020 2020  00              
+0001c370: 2030 0a20 2020 2020 2020 2024 0a20 2020   0.        $.   
+0001c380: 2020 2020 2024 2052 4245 3220 7468 6520       $ RBE2 the 
+0001c390: 5370 6163 6563 7261 6674 206e 6f64 6573  Spacecraft nodes
+0001c3a0: 2074 6f20 6e65 7720 6e6f 6465 7320 6372   to new nodes cr
+0001c3b0: 6561 7465 6420 6162 6f76 6520 2874 6865  eated above (the
+0001c3c0: 206e 6577 206e 6f64 6573 0a20 2020 2020   new nodes.     
+0001c3d0: 2020 2024 2061 7265 2069 6e64 6570 656e     $ are indepen
+0001c3e0: 6465 6e74 293a 0a20 2020 2020 2020 2024  dent):.        $
+0001c3f0: 0a20 2020 2020 2020 2052 4245 322c 3130  .        RBE2,10
+0001c400: 3031 2c31 3030 312c 3132 3334 3536 2c31  01,1001,123456,1
+0001c410: 0a20 2020 2020 2020 2052 4245 322c 3130  .        RBE2,10
+0001c420: 3032 2c31 3030 322c 3132 3334 3536 2c32  02,1002,123456,2
+0001c430: 0a20 2020 2020 2020 2052 4245 322c 3130  .        RBE2,10
+0001c440: 3033 2c31 3030 332c 3132 3334 3536 2c33  03,1003,123456,3
+0001c450: 0a20 2020 2020 2020 2052 4245 322c 3130  .        RBE2,10
+0001c460: 3034 2c31 3030 342c 3132 3334 3536 2c34  04,1004,123456,4
+0001c470: 0a20 2020 2020 2020 2052 4245 322c 3130  .        RBE2,10
+0001c480: 3035 2c31 3030 352c 3132 3334 3536 2c35  05,1005,123456,5
+0001c490: 0a20 2020 2020 2020 2024 0a20 2020 2020  .        $.     
+0001c4a0: 2020 2024 2052 5350 4c49 4e45 2074 6865     $ RSPLINE the
+0001c4b0: 2052 696e 6720 3220 6e6f 6465 7320 746f   Ring 2 nodes to
+0001c4c0: 2074 6865 206e 6577 206e 6f64 6573 2063   the new nodes c
+0001c4d0: 7265 6174 6564 2061 626f 7665 2c20 7769  reated above, wi
+0001c4e0: 7468 2074 6865 206e 6577 0a20 2020 2020  th the new.     
+0001c4f0: 2020 2024 206e 6f64 6573 2062 6569 6e67     $ nodes being
+0001c500: 2069 6e64 6570 656e 6465 6e74 2e0a 2020   independent..  
+0001c510: 2020 2020 2020 240a 2020 2020 2020 2020        $.        
+0001c520: 5253 504c 494e 4520 2020 2020 3230 3031  RSPLINE     2001
+0001c530: 2020 2020 2030 2e31 2020 2020 3130 3031       0.1    1001
+0001c540: 2020 2020 2031 3031 2020 3132 3334 3536       101  123456
+0001c550: 2020 2020 2031 3032 2020 3132 3334 3536       102  123456
+0001c560: 2020 2020 3130 3032 0a20 2020 2020 2020      1002.       
+0001c570: 2052 5350 4c49 4e45 2020 2020 2032 3030   RSPLINE     200
+0001c580: 3220 2020 2020 302e 3120 2020 2031 3030  2     0.1    100
+0001c590: 3220 2020 2020 3130 3320 2031 3233 3435  2     103  12345
+0001c5a0: 3620 2020 2031 3030 330a 2020 2020 2020  6    1003.      
+0001c5b0: 2020 5253 504c 494e 4520 2020 2020 3230    RSPLINE     20
+0001c5c0: 3033 2020 2020 2030 2e31 2020 2020 3130  03     0.1    10
+0001c5d0: 3033 2020 2020 2031 3034 2020 3132 3334  03     104  1234
+0001c5e0: 3536 2020 2020 2031 3035 2020 3132 3334  56     105  1234
+0001c5f0: 3536 2020 2020 3130 3034 0a20 2020 2020  56    1004.     
+0001c600: 2020 2052 5350 4c49 4e45 2020 2020 2032     RSPLINE     2
+0001c610: 3030 3420 2020 2020 302e 3120 2020 2031  004     0.1    1
+0001c620: 3030 3420 2020 2020 3130 3620 2031 3233  004     106  123
+0001c630: 3435 3620 2020 2031 3030 350a 2020 2020  456    1005.    
+0001c640: 2020 2020 5253 504c 494e 4520 2020 2020      RSPLINE     
+0001c650: 3230 3035 2020 2020 2030 2e31 2020 2020  2005     0.1    
+0001c660: 3130 3035 2020 2020 2031 3037 2020 3132  1005     107  12
+0001c670: 3334 3536 2020 2020 3130 3031 0a20 2020  3456    1001.   
+0001c680: 2022 2222 0a0a 2020 2020 6465 6620 5f63   """..    def _c
+0001c690: 6865 636b 5f67 7269 6473 2867 7269 6473  heck_grids(grids
+0001c6a0: 2c20 6e61 6d65 293a 0a20 2020 2020 2020  , name):.       
+0001c6b0: 2069 6620 6973 696e 7374 616e 6365 2867   if isinstance(g
+0001c6c0: 7269 6473 2c20 7475 706c 6529 2061 6e64  rids, tuple) and
+0001c6d0: 206c 656e 2867 7269 6473 2920 3d3d 2032   len(grids) == 2
+0001c6e0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+0001c6f0: 7475 726e 2067 7269 6473 0a20 2020 2020  turn grids.     
+0001c700: 2020 2072 6574 7572 6e20 6e61 6d65 2c20     return name, 
+0001c710: 6772 6964 730a 0a20 2020 2064 6566 205f  grids..    def _
+0001c720: 6465 7370 6163 6528 7329 3a0a 2020 2020  despace(s):.    
+0001c730: 2020 2020 7265 7475 726e 2028 2222 2e6a      return ("".j
+0001c740: 6f69 6e28 732e 7370 6c69 7428 2929 292e  oin(s.split())).
+0001c750: 6c6f 7765 7228 290a 0a20 2020 2072 316e  lower()..    r1n
+0001c760: 616d 652c 2072 3167 7269 6473 203d 205f  ame, r1grids = _
+0001c770: 6368 6563 6b5f 6772 6964 7328 7231 6772  check_grids(r1gr
+0001c780: 6964 732c 2022 5269 6e67 2031 2229 0a20  ids, "Ring 1"). 
+0001c790: 2020 2072 326e 616d 652c 2072 3267 7269     r2name, r2gri
+0001c7a0: 6473 203d 205f 6368 6563 6b5f 6772 6964  ds = _check_grid
+0001c7b0: 7328 7232 6772 6964 732c 2022 5269 6e67  s(r2grids, "Ring
+0001c7c0: 2032 2229 0a0a 2020 2020 2320 656e 7375   2")..    # ensu
+0001c7d0: 7265 2074 6861 7420 696e 6465 7065 6e64  re that independ
+0001c7e0: 656e 7420 6973 2065 6974 6865 7220 2772  ent is either 'r
+0001c7f0: 696e 6731 2720 6f72 2027 7269 6e67 3227  ing1' or 'ring2'
+0001c800: 3a0a 2020 2020 696e 6465 7065 6e64 656e  :.    independen
+0001c810: 7420 3d20 5f64 6573 7061 6365 2869 6e64  t = _despace(ind
+0001c820: 6570 656e 6465 6e74 290a 2020 2020 6966  ependent).    if
+0001c830: 2069 6e64 6570 656e 6465 6e74 203d 3d20   independent == 
+0001c840: 5f64 6573 7061 6365 2872 316e 616d 6529  _despace(r1name)
+0001c850: 3a0a 2020 2020 2020 2020 696e 6465 7065  :.        indepe
+0001c860: 6e64 656e 7420 3d20 2272 696e 6731 220a  ndent = "ring1".
+0001c870: 2020 2020 656c 6966 2069 6e64 6570 656e      elif indepen
+0001c880: 6465 6e74 203d 3d20 5f64 6573 7061 6365  dent == _despace
+0001c890: 2872 326e 616d 6529 3a0a 2020 2020 2020  (r2name):.      
+0001c8a0: 2020 696e 6465 7065 6e64 656e 7420 3d20    independent = 
+0001c8b0: 2272 696e 6732 220a 2020 2020 6966 2069  "ring2".    if i
+0001c8c0: 6e64 6570 656e 6465 6e74 206e 6f74 2069  ndependent not i
+0001c8d0: 6e20 2822 7269 6e67 3122 2c20 2272 696e  n ("ring1", "rin
+0001c8e0: 6732 2229 3a0a 2020 2020 2020 2020 7261  g2"):.        ra
+0001c8f0: 6973 6520 5661 6c75 6545 7272 6f72 2822  ise ValueError("
+0001c900: 696e 7661 6c69 6420 6069 6e64 6570 656e  invalid `indepen
+0001c910: 6465 6e74 6020 6f70 7469 6f6e 2229 0a0a  dent` option")..
+0001c920: 2020 2020 6966 2072 6265 325f 6964 3020      if rbe2_id0 
+0001c930: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
+0001c940: 2072 6265 325f 6964 3020 3d20 6e6f 6465   rbe2_id0 = node
+0001c950: 5f69 6430 0a20 2020 2069 6620 636f 7264  _id0.    if cord
+0001c960: 5f69 6420 6973 204e 6f6e 653a 0a20 2020  _id is None:.   
+0001c970: 2020 2020 2063 6f72 645f 6964 203d 206e       cord_id = n
+0001c980: 6f64 655f 6964 3020 2a20 3130 0a0a 2020  ode_id0 * 10..  
+0001c990: 2020 6e61 6d65 7320 3d20 2872 316e 616d    names = (r1nam
+0001c9a0: 652c 2072 326e 616d 6529 0a20 2020 2049  e, r2name).    I
+0001c9b0: 4473 203d 205b 5d0a 2020 2020 7879 7a20  Ds = [].    xyz 
+0001c9c0: 3d20 5b5d 0a20 2020 2066 6f72 2072 696e  = [].    for rin
+0001c9d0: 672c 206e 616d 6520 696e 2028 2872 3167  g, name in ((r1g
+0001c9e0: 7269 6473 2c20 2272 3167 7269 6473 2229  rids, "r1grids")
+0001c9f0: 2c20 2872 3267 7269 6473 2c20 2272 3267  , (r2grids, "r2g
+0001ca00: 7269 6473 2229 293a 0a20 2020 2020 2020  rids")):.       
+0001ca10: 2069 6620 6973 696e 7374 616e 6365 2872   if isinstance(r
+0001ca20: 696e 672c 2070 642e 4461 7461 4672 616d  ing, pd.DataFram
+0001ca30: 6529 3a0a 2020 2020 2020 2020 2020 2020  e):.            
+0001ca40: 7220 3d20 7269 6e67 2e73 6861 7065 5b30  r = ring.shape[0
+0001ca50: 5d0a 2020 2020 2020 2020 2020 2020 6966  ].            if
+0001ca60: 2028 7220 2f2f 2036 2920 2a20 3620 213d   (r // 6) * 6 !=
+0001ca70: 2072 3a0a 2020 2020 2020 2020 2020 2020   r:.            
+0001ca80: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+0001ca90: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
+0001caa0: 2020 2020 2020 2020 2020 6622 6e75 6d62            f"numb
+0001cab0: 6572 206f 6620 726f 7773 2060 7b6e 616d  er of rows `{nam
+0001cac0: 657d 6020 6973 206e 6f74 2022 2022 6d75  e}` is not " "mu
+0001cad0: 6c74 6970 6c65 206f 6620 3620 666f 7220  ltiple of 6 for 
+0001cae0: 5553 4554 2069 6e70 7574 220a 2020 2020  USET input".    
+0001caf0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+0001cb00: 2020 2020 2020 2020 2020 4944 732e 6170            IDs.ap
+0001cb10: 7065 6e64 2872 696e 672e 696e 6465 782e  pend(ring.index.
+0001cb20: 6765 745f 6c65 7665 6c5f 7661 6c75 6573  get_level_values
+0001cb30: 2822 6964 2229 5b3a 3a36 5d29 0a20 2020  ("id")[::6]).   
+0001cb40: 2020 2020 2020 2020 2078 797a 2e61 7070           xyz.app
+0001cb50: 656e 6428 7269 6e67 2e69 6c6f 635b 3a3a  end(ring.iloc[::
+0001cb60: 362c 2031 3a5d 2e76 616c 7565 7329 0a20  6, 1:].values). 
+0001cb70: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+0001cb80: 2020 2020 2020 2020 2072 696e 6720 3d20           ring = 
+0001cb90: 6e70 2e61 746c 6561 7374 5f32 6428 7269  np.atleast_2d(ri
+0001cba0: 6e67 290a 2020 2020 2020 2020 2020 2020  ng).            
+0001cbb0: 4944 732e 6170 7065 6e64 2872 696e 675b  IDs.append(ring[
+0001cbc0: 3a2c 2030 5d2e 6173 7479 7065 286e 702e  :, 0].astype(np.
+0001cbd0: 696e 7436 3429 290a 2020 2020 2020 2020  int64)).        
+0001cbe0: 2020 2020 7879 7a2e 6170 7065 6e64 2872      xyz.append(r
+0001cbf0: 696e 675b 3a2c 2031 3a5d 290a 0a20 2020  ing[:, 1:])..   
+0001cc00: 2023 2066 6974 2062 6f74 6820 6369 7263   # fit both circ
+0001cc10: 6c65 733a 0a20 2020 2063 6972 635f 7061  les:.    circ_pa
+0001cc20: 726d 7320 3d20 5b79 746f 6f6c 732e 6669  rms = [ytools.fi
+0001cc30: 745f 6369 7263 6c65 5f33 6428 7879 7a5b  t_circle_3d(xyz[
+0001cc40: 695d 2e54 2920 666f 7220 6920 696e 2028  i].T) for i in (
+0001cc50: 302c 2031 295d 0a0a 2020 2020 2320 7a20  0, 1)]..    # z 
+0001cc60: 6178 6573 2062 6574 7465 7220 6265 2061  axes better be a
+0001cc70: 6c69 676e 6564 3a0a 2020 2020 5f63 6865  ligned:.    _che
+0001cc80: 636b 5f7a 5f61 6c69 676e 6d65 6e74 2863  ck_z_alignment(c
+0001cc90: 6972 635f 7061 726d 732c 2030 2e39 3929  irc_parms, 0.99)
+0001cca0: 0a0a 2020 2020 2320 7573 6520 3173 7420  ..    # use 1st 
+0001ccb0: 6261 7369 6332 6c6f 6361 6c20 7472 616e  basic2local tran
+0001ccc0: 7366 6f72 6d20 6f6e 2073 6563 6f6e 6420  sform on second 
+0001ccd0: 7365 7420 6f66 2064 6174 6120 746f 2067  set of data to g
+0001cce0: 6574 2061 6c6c 0a20 2020 2023 2063 6f6f  et all.    # coo
+0001ccf0: 7264 696e 6174 6573 2069 6e20 7361 6d65  rdinates in same
+0001cd00: 206c 6f63 616c 2073 7973 7465 6d3a 0a20   local system:. 
+0001cd10: 2020 2062 6173 6963 326c 6f63 616c 203d     basic2local =
+0001cd20: 2063 6972 635f 7061 726d 735b 305d 2e62   circ_parms[0].b
+0001cd30: 6173 6963 326c 6f63 616c 0a20 2020 2063  asic2local.    c
+0001cd40: 656e 7465 7220 3d20 6369 7263 5f70 6172  enter = circ_par
+0001cd50: 6d73 5b30 5d2e 6365 6e74 6572 0a20 2020  ms[0].center.   
+0001cd60: 2063 6972 635f 7061 726d 735b 315d 2e6c   circ_parms[1].l
+0001cd70: 6f63 616c 203d 2062 6173 6963 326c 6f63  ocal = basic2loc
+0001cd80: 616c 2040 2028 7879 7a5b 315d 202d 2063  al @ (xyz[1] - c
+0001cd90: 656e 7465 7229 2e54 0a0a 2020 2020 2320  enter).T..    # 
+0001cda0: 7468 6520 6365 6e74 6572 2070 6f69 6e74  the center point
+0001cdb0: 2077 696c 6c20 6f66 7465 6e20 6861 7665   will often have
+0001cdc0: 206e 6561 722d 7a65 726f 7320 6275 7420   near-zeros but 
+0001cdd0: 6265 206e 756d 6572 6963 616c 6c79 0a20  be numerically. 
+0001cde0: 2020 2023 206f 6666 202e 2e2e 2063 6865     # off ... che
+0001cdf0: 636b 2066 6f72 2074 6869 7320 616e 6420  ck for this and 
+0001ce00: 6164 6a75 7374 2069 6620 7468 6174 2773  adjust if that's
+0001ce10: 2074 6865 2063 6173 653a 0a20 2020 2072   the case:.    r
+0001ce20: 6164 6975 7320 3d20 6369 7263 5f70 6172  adius = circ_par
+0001ce30: 6d73 5b30 5d2e 7261 6469 7573 0a20 2020  ms[0].radius.   
+0001ce40: 2066 6f72 2069 2c20 7661 6c75 6520 696e   for i, value in
+0001ce50: 2065 6e75 6d65 7261 7465 2863 656e 7465   enumerate(cente
+0001ce60: 7229 3a0a 2020 2020 2020 2020 6966 2061  r):.        if a
+0001ce70: 6273 2876 616c 7565 2920 3c20 3165 2d37  bs(value) < 1e-7
+0001ce80: 202a 2072 6164 6975 733a 0a20 2020 2020   * radius:.     
+0001ce90: 2020 2020 2020 2063 656e 7465 725b 695d         center[i]
+0001cea0: 203d 2030 2e30 0a0a 2020 2020 4067 7569   = 0.0..    @gui
+0001ceb0: 746f 6f6c 732e 7772 6974 655f 7465 7874  tools.write_text
+0001cec0: 5f66 696c 650a 2020 2020 6465 6620 5f77  _file.    def _w
+0001ced0: 7269 7465 5f66 696c 6528 6629 3a0a 2020  rite_file(f):.  
+0001cee0: 2020 2020 2020 2320 7772 6974 6520 6369        # write ci
+0001cef0: 7263 6c65 2069 6e66 6f20 666f 7220 7265  rcle info for re
+0001cf00: 6665 7265 6e63 653a 0a20 2020 2020 2020  ference:.       
+0001cf10: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
+0001cf20: 3229 3a0a 2020 2020 2020 2020 2020 2020  2):.            
+0001cf30: 6374 7220 3d20 6369 7263 5f70 6172 6d73  ctr = circ_parms
+0001cf40: 5b69 5d2e 6365 6e74 6572 0a20 2020 2020  [i].center.     
+0001cf50: 2020 2020 2020 2063 7472 5f73 7472 696e         ctr_strin
+0001cf60: 6720 3d20 6622 5b7b 6374 725b 305d 3a23  g = f"[{ctr[0]:#
+0001cf70: 2e34 677d 2c20 7b63 7472 5b31 5d3a 232e  .4g}, {ctr[1]:#.
+0001cf80: 3467 7d2c 207b 6374 725b 325d 3a23 2e34  4g}, {ctr[2]:#.4
+0001cf90: 677d 5d22 0a20 2020 2020 2020 2020 2020  g}]".           
+0001cfa0: 2063 6f6d 6d65 6e74 203d 2028 0a20 2020   comment = (.   
+0001cfb0: 2020 2020 2020 2020 2020 2020 2022 245c               "$\
+0001cfc0: 6e22 0a20 2020 2020 2020 2020 2020 2020  n".             
+0001cfd0: 2020 2066 2224 2046 6974 206f 6620 7b6e     f"$ Fit of {n
+0001cfe0: 616d 6573 5b69 5d7d 2067 7269 6473 3a5c  ames[i]} grids:\
+0001cff0: 6e22 0a20 2020 2020 2020 2020 2020 2020  n".             
+0001d000: 2020 2066 2224 2020 2020 2043 656e 7465     f"$     Cente
+0001d010: 723a 207b 6374 725f 7374 7269 6e67 7d20  r: {ctr_string} 
+0001d020: 2869 6e20 6261 7369 6329 5c6e 220a 2020  (in basic)\n".  
+0001d030: 2020 2020 2020 2020 2020 2020 2020 6622                f"
+0001d040: 2420 2020 2020 5261 6469 7573 3a20 7b63  $     Radius: {c
+0001d050: 6972 635f 7061 726d 735b 695d 2e72 6164  irc_parms[i].rad
+0001d060: 6975 737d 5c6e 220a 2020 2020 2020 2020  ius}\n".        
+0001d070: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+0001d080: 2020 662e 7772 6974 6528 636f 6d6d 656e    f.write(commen
+0001d090: 7429 0a0a 2020 2020 2020 2020 2320 7772  t)..        # wr
+0001d0a0: 6974 6520 6c6f 6361 6c20 636f 6f72 6469  ite local coordi
+0001d0b0: 6e61 7465 2073 7973 7465 6d20 746f 2066  nate system to f
+0001d0c0: 696c 653a 0a20 2020 2020 2020 205f 7774  ile:.        _wt
+0001d0d0: 5f63 6972 636c 6531 5f63 6f6f 7264 2866  _circle1_coord(f
+0001d0e0: 2c20 636f 7264 5f69 642c 2063 656e 7465  , cord_id, cente
+0001d0f0: 722c 2062 6173 6963 326c 6f63 616c 2c20  r, basic2local, 
+0001d100: 4944 735b 305d 5b30 5d2c 206e 6f64 655f  IDs[0][0], node_
+0001d110: 6964 302c 206e 616d 6573 290a 0a20 2020  id0, names)..   
+0001d120: 2020 2020 2023 2063 7265 6174 6520 6e65       # create ne
+0001d130: 7720 6e6f 6465 7320 7468 6174 2077 696c  w nodes that wil
+0001d140: 6c20 6265 2052 4245 3227 6420 746f 2072  l be RBE2'd to r
+0001d150: 696e 6720 3120 6e6f 6465 732c 2062 7574  ing 1 nodes, but
+0001d160: 0a20 2020 2020 2020 2023 206c 6f63 6174  .        # locat
+0001d170: 6564 206f 6e20 7269 6e67 2032 2063 6972  ed on ring 2 cir
+0001d180: 636c 650a 2020 2020 2020 2020 2320 2d20  cle.        # - 
+0001d190: 7468 6573 6520 6e6f 6465 7320 7769 6c6c  these nodes will
+0001d1a0: 2062 6520 6465 6669 6e65 6420 696e 2074   be defined in t
+0001d1b0: 6865 206c 6f63 616c 2073 7973 7465 6d20  he local system 
+0001d1c0: 6275 7420 6f75 7470 7574 0a20 2020 2020  but output.     
+0001d1d0: 2020 2023 2020 2069 6e20 6261 7369 630a     #   in basic.
+0001d1e0: 2020 2020 2020 2020 6e65 7770 7473 2c20          newpts, 
+0001d1f0: 6e65 7769 6473 203d 205f 7774 6772 6964  newids = _wtgrid
+0001d200: 735f 7262 6532 7328 0a20 2020 2020 2020  s_rbe2s(.       
+0001d210: 2020 2020 2066 2c0a 2020 2020 2020 2020       f,.        
+0001d220: 2020 2020 6369 7263 5f70 6172 6d73 2c0a      circ_parms,.
+0001d230: 2020 2020 2020 2020 2020 2020 6365 6e74              cent
+0001d240: 6572 2c0a 2020 2020 2020 2020 2020 2020  er,.            
+0001d250: 6261 7369 6332 6c6f 6361 6c2c 0a20 2020  basic2local,.   
+0001d260: 2020 2020 2020 2020 2063 6f72 645f 6964           cord_id
+0001d270: 2c0a 2020 2020 2020 2020 2020 2020 6e6f  ,.            no
+0001d280: 6465 5f69 6430 2c0a 2020 2020 2020 2020  de_id0,.        
+0001d290: 2020 2020 7262 6532 5f69 6430 2c0a 2020      rbe2_id0,.  
+0001d2a0: 2020 2020 2020 2020 2020 4944 735b 305d            IDs[0]
+0001d2b0: 2c0a 2020 2020 2020 2020 2020 2020 6e61  ,.            na
+0001d2c0: 6d65 732c 0a20 2020 2020 2020 2029 0a0a  mes,.        )..
+0001d2d0: 2020 2020 2020 2020 2320 7273 706c 696e          # rsplin
+0001d2e0: 6520 7769 6c6c 2074 6965 2074 6865 2027  e will tie the '
+0001d2f0: 6e65 7770 7473 2720 616e 6420 7468 6520  newpts' and the 
+0001d300: 7269 6e67 2032 206e 6f64 6573 2074 6f67  ring 2 nodes tog
+0001d310: 6574 6865 723a 0a20 2020 2020 2020 2072  ether:.        r
+0001d320: 7370 6c69 6e65 5f6e 6f64 6573 203d 205f  spline_nodes = _
+0001d330: 736f 7274 5f6e 5f77 7269 7465 280a 2020  sort_n_write(.  
+0001d340: 2020 2020 2020 2020 2020 662c 2069 6e64            f, ind
+0001d350: 6570 656e 6465 6e74 2c20 6369 7263 5f70  ependent, circ_p
+0001d360: 6172 6d73 2c20 6e65 7770 7473 2c20 6e65  arms, newpts, ne
+0001d370: 7769 6473 2c20 4944 735b 315d 2c20 7273  wids, IDs[1], rs
+0001d380: 706c 696e 655f 6964 302c 2044 6f4c 2c20  pline_id0, DoL, 
+0001d390: 6e61 6d65 730a 2020 2020 2020 2020 290a  names.        ).
+0001d3a0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0001d3b0: 6e65 7770 7473 2c20 6e65 7769 6473 2c20  newpts, newids, 
+0001d3c0: 7273 706c 696e 655f 6e6f 6465 730a 0a20  rspline_nodes.. 
+0001d3d0: 2020 2023 2077 7269 7465 2074 6865 2072     # write the r
+0001d3e0: 7370 6c69 6e65 3a0a 2020 2020 6e65 7770  spline:.    newp
+0001d3f0: 7473 2c20 6e65 7769 6473 2c20 7273 706c  ts, newids, rspl
+0001d400: 696e 655f 6e6f 6465 7320 3d20 5f77 7269  ine_nodes = _wri
+0001d410: 7465 5f66 696c 6528 6629 0a0a 2020 2020  te_file(f)..    
+0001d420: 6178 203d 2079 746f 6f6c 732e 5f63 6865  ax = ytools._che
+0001d430: 636b 5f6d 616b 6570 6c6f 7428 6d61 6b65  ck_makeplot(make
+0001d440: 706c 6f74 2c20 6669 6773 697a 653d 5b38  plot, figsize=[8
+0001d450: 2c20 365d 2c20 6e65 6564 3364 3d54 7275  , 6], need3d=Tru
+0001d460: 6529 0a20 2020 2069 6620 6178 3a0a 2020  e).    if ax:.  
+0001d470: 2020 2020 2020 5f70 6c6f 745f 7273 706c        _plot_rspl
+0001d480: 696e 6528 0a20 2020 2020 2020 2020 2020  ine(.           
+0001d490: 2061 782c 0a20 2020 2020 2020 2020 2020   ax,.           
+0001d4a0: 2063 6972 635f 7061 726d 732c 0a20 2020   circ_parms,.   
+0001d4b0: 2020 2020 2020 2020 2078 797a 2c0a 2020           xyz,.  
+0001d4c0: 2020 2020 2020 2020 2020 6e65 7770 7473            newpts
+0001d4d0: 2c0a 2020 2020 2020 2020 2020 2020 6e65  ,.            ne
+0001d4e0: 7769 6473 2c0a 2020 2020 2020 2020 2020  wids,.          
+0001d4f0: 2020 6261 7369 6332 6c6f 6361 6c2c 0a20    basic2local,. 
+0001d500: 2020 2020 2020 2020 2020 2063 656e 7465             cente
+0001d510: 722c 0a20 2020 2020 2020 2020 2020 2072  r,.            r
+0001d520: 7370 6c69 6e65 5f6e 6f64 6573 2c0a 2020  spline_nodes,.  
+0001d530: 2020 2020 2020 2020 2020 4944 735b 315d            IDs[1]
+0001d540: 2c0a 2020 2020 2020 2020 2020 2020 6e61  ,.            na
+0001d550: 6d65 732c 0a20 2020 2020 2020 2029 0a0a  mes,.        )..
+0001d560: 0a64 6566 2077 7463 6f6f 7264 6361 7264  .def wtcoordcard
+0001d570: 7328 662c 2063 6929 3a0a 2020 2020 2222  s(f, ci):.    ""
+0001d580: 220a 2020 2020 5772 6974 6520 4e61 7374  ".    Write Nast
+0001d590: 7261 6e20 434f 5244 322a 2063 6172 6473  ran CORD2* cards
+0001d5a0: 2074 6f20 6120 6669 6c65 0a0a 2020 2020   to a file..    
+0001d5b0: 5061 7261 6d65 7465 7273 0a20 2020 202d  Parameters.    -
+0001d5c0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 6620  ---------.    f 
+0001d5d0: 3a20 7374 7269 6e67 206f 7220 6669 6c65  : string or file
+0001d5e0: 5f6c 696b 6520 6f72 2031 206f 7220 4e6f  _like or 1 or No
+0001d5f0: 6e65 0a20 2020 2020 2020 2045 6974 6865  ne.        Eithe
+0001d600: 7220 6120 6e61 6d65 206f 6620 6120 6669  r a name of a fi
+0001d610: 6c65 2c20 6f72 2069 7320 6120 6669 6c65  le, or is a file
+0001d620: 5f6c 696b 6520 6f62 6a65 6374 2061 7320  _like object as 
+0001d630: 7265 7475 726e 6564 0a20 2020 2020 2020  returned.       
+0001d640: 2062 7920 3a66 756e 633a 606f 7065 6e60   by :func:`open`
+0001d650: 206f 7220 3a63 6c61 7373 3a60 696f 2e53   or :class:`io.S
+0001d660: 7472 696e 6749 4f60 2e20 496e 7075 7420  tringIO`. Input 
+0001d670: 6173 2069 6e74 6567 6572 2031 2074 6f0a  as integer 1 to.
+0001d680: 2020 2020 2020 2020 7772 6974 6520 746f          write to
+0001d690: 2073 7464 6f75 742e 2043 616e 2061 6c73   stdout. Can als
+0001d6a0: 6f20 6265 2074 6865 206e 616d 6520 6f66  o be the name of
+0001d6b0: 2061 2064 6972 6563 746f 7279 206f 7220   a directory or 
+0001d6c0: 4e6f 6e65 3b0a 2020 2020 2020 2020 696e  None;.        in
+0001d6d0: 2074 6865 7365 2063 6173 6573 2c20 6120   these cases, a 
+0001d6e0: 4755 4920 6973 206f 7065 6e65 6420 666f  GUI is opened fo
+0001d6f0: 7220 6669 6c65 2073 656c 6563 7469 6f6e  r file selection
+0001d700: 2e0a 2020 2020 6369 203a 2064 6963 7469  ..    ci : dicti
+0001d710: 6f6e 6172 7920 6f72 204e 6f6e 650a 2020  onary or None.  
+0001d720: 2020 2020 2020 4469 6374 696f 6e61 7279        Dictionary
+0001d730: 206f 6620 636f 6f72 6469 6e61 7465 2063   of coordinate c
+0001d740: 6172 6420 696e 666f 2061 7320 7265 7475  ard info as retu
+0001d750: 726e 6564 2062 790a 2020 2020 2020 2020  rned by.        
+0001d760: 3a66 756e 633a 6070 7979 6574 692e 6e61  :func:`pyyeti.na
+0001d770: 7374 7261 6e2e 6e32 702e 6d6b 636f 7264  stran.n2p.mkcord
+0001d780: 6361 7264 696e 666f 602e 2049 6620 4e6f  cardinfo`. If No
+0001d790: 6e65 206f 7220 6966 2064 6963 740a 2020  ne or if dict.  
+0001d7a0: 2020 2020 2020 6973 2065 6d70 7479 2c20        is empty, 
+0001d7b0: 7468 6973 2072 6f75 7469 6e65 2071 7569  this routine qui
+0001d7c0: 6574 6c79 2064 6f65 7320 6e6f 7468 696e  etly does nothin
+0001d7d0: 672e 0a0a 2020 2020 5265 7475 726e 730a  g...    Returns.
+0001d7e0: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
+0001d7f0: 4e6f 6e65 0a0a 2020 2020 4e6f 7465 730a  None..    Notes.
+0001d800: 2020 2020 2d2d 2d2d 2d0a 2020 2020 5479      -----.    Ty
+0001d810: 7069 6361 6c6c 7920 6361 6c6c 6564 2062  pically called b
+0001d820: 7920 3a66 756e 633a 6077 7465 7874 7365  y :func:`wtextse
+0001d830: 6f75 7460 2e0a 0a20 2020 2045 7861 6d70  out`...    Examp
+0001d840: 6c65 730a 2020 2020 2d2d 2d2d 2d2d 2d2d  les.    --------
+0001d850: 0a20 2020 203e 3e3e 2069 6d70 6f72 7420  .    >>> import 
+0001d860: 6e75 6d70 7920 6173 206e 700a 2020 2020  numpy as np.    
+0001d870: 3e3e 3e20 6672 6f6d 2070 7979 6574 6920  >>> from pyyeti 
+0001d880: 696d 706f 7274 206e 6173 7472 616e 0a20  import nastran. 
+0001d890: 2020 203e 3e3e 2063 6920 3d20 7b31 303a     >>> ci = {10:
+0001d8a0: 205b 2743 4f52 4432 5227 2c20 6e70 2e61   ['CORD2R', np.a
+0001d8b0: 7272 6179 285b 5b31 302c 2031 2c20 305d  rray([[10, 1, 0]
+0001d8c0: 2c0a 2020 2020 2e2e 2e20 2020 2020 2020  ,.    ...       
+0001d8d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d8e0: 2020 2020 2020 2020 205b 3130 302e 2c20           [100., 
+0001d8f0: 302e 2c20 302e 5d2c 0a20 2020 202e 2e2e  0., 0.],.    ...
+0001d900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d910: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d920: 5b31 3030 2e2c 2030 2e2c 2031 3030 2e5d  [100., 0., 100.]
+0001d930: 2c0a 2020 2020 2e2e 2e20 2020 2020 2020  ,.    ...       
+0001d940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001d950: 2020 2020 2020 2020 205b 3230 302e 2c20           [200., 
+0001d960: 302e 2c20 302e 5d5d 295d 7d0a 2020 2020  0., 0.]])]}.    
+0001d970: 3e3e 3e20 6e61 7374 7261 6e2e 7774 636f  >>> nastran.wtco
+0001d980: 6f72 6463 6172 6473 2831 2c20 6369 290a  ordcards(1, ci).
+0001d990: 2020 2020 2420 436f 6f72 6469 6e61 7465      $ Coordinate
+0001d9a0: 2031 303a 0a20 2020 2043 4f52 4432 522a   10:.    CORD2R*
+0001d9b0: 2020 2020 2020 2020 2020 2020 2020 2031                 1
+0001d9c0: 3020 2020 2020 2020 2020 2020 2020 2020  0               
+0001d9d0: 3020 2031 2e30 3030 3030 3030 3065 2b30  0  1.00000000e+0
+0001d9e0: 3220 2030 2e30 3030 3030 3030 3065 2b30  2  0.00000000e+0
+0001d9f0: 302a 0a20 2020 202a 2020 2020 2020 2020  0*.    *        
+0001da00: 2030 2e30 3030 3030 3030 3065 2b30 3020   0.00000000e+00 
+0001da10: 2031 2e30 3030 3030 3030 3065 2b30 3220   1.00000000e+02 
+0001da20: 2030 2e30 3030 3030 3030 3065 2b30 3020   0.00000000e+00 
+0001da30: 2031 2e30 3030 3030 3030 3065 2b30 322a   1.00000000e+02*
+0001da40: 0a20 2020 202a 2020 2020 2020 2020 2032  .    *         2
+0001da50: 2e30 3030 3030 3030 3065 2b30 3220 2030  .00000000e+02  0
+0001da60: 2e30 3030 3030 3030 3065 2b30 3020 2030  .00000000e+00  0
+0001da70: 2e30 3030 3030 3030 3065 2b30 300a 2020  .00000000e+00.  
+0001da80: 2020 2222 220a 2020 2020 6966 2063 6920    """.    if ci 
+0001da90: 6973 204e 6f6e 6520 6f72 206c 656e 2863  is None or len(c
+0001daa0: 6929 203d 3d20 303a 0a20 2020 2020 2020  i) == 0:.       
+0001dab0: 2072 6574 7572 6e0a 0a20 2020 2040 6775   return..    @gu
+0001dac0: 6974 6f6f 6c73 2e77 7269 7465 5f74 6578  itools.write_tex
+0001dad0: 745f 6669 6c65 0a20 2020 2064 6566 205f  t_file.    def _
+0001dae0: 7774 636f 6f72 6473 2866 2c20 6369 293a  wtcoords(f, ci):
+0001daf0: 0a20 2020 2020 2020 2066 6f72 206b 2069  .        for k i
+0001db00: 6e20 6369 3a0a 2020 2020 2020 2020 2020  n ci:.          
+0001db10: 2020 6461 7461 203d 2063 695b 6b5d 2020    data = ci[k]  
+0001db20: 2320 5b6e 616d 652c 205b 5b69 642c 2074  # [name, [[id, t
+0001db30: 7970 652c 2072 6566 5d3b 2041 3b20 423b  ype, ref]; A; B;
+0001db40: 2043 5d5d 0a20 2020 2020 2020 2020 2020   C]].           
+0001db50: 2063 6f6f 7264 203d 2064 6174 615b 315d   coord = data[1]
+0001db60: 0a20 2020 2020 2020 2020 2020 2061 6263  .            abc
+0001db70: 203d 202b 636f 6f72 645b 313a 5d0a 2020   = +coord[1:].  
+0001db80: 2020 2020 2020 2020 2020 6162 635b 6162            abc[ab
+0001db90: 7328 6162 6329 203c 2061 6273 2861 6263  s(abc) < abs(abc
+0001dba0: 292e 6d61 7828 2920 2a20 3165 2d31 355d  ).max() * 1e-15]
+0001dbb0: 203d 2030 2e30 0a20 2020 2020 2020 2020   = 0.0.         
+0001dbc0: 2020 2066 2e77 7269 7465 2866 2224 2043     f.write(f"$ C
+0001dbd0: 6f6f 7264 696e 6174 6520 7b6b 7d3a 5c6e  oordinate {k}:\n
+0001dbe0: 2229 0a20 2020 2020 2020 2020 2020 2066  ").            f
+0001dbf0: 2e77 7269 7465 280a 2020 2020 2020 2020  .write(.        
+0001dc00: 2020 2020 2020 2020 227b 3a3c 3873 7d7b          "{:<8s}{
+0001dc10: 3a31 3664 7d7b 3a31 3664 7d7b 3a31 362e  :16d}{:16d}{:16.
+0001dc20: 3865 7d7b 3a31 362e 3865 7d2a 5c6e 222e  8e}{:16.8e}*\n".
+0001dc30: 666f 726d 6174 280a 2020 2020 2020 2020  format(.        
+0001dc40: 2020 2020 2020 2020 2020 2020 6461 7461              data
+0001dc50: 5b30 5d20 2b20 222a 222c 206b 2c20 696e  [0] + "*", k, in
+0001dc60: 7428 636f 6f72 645b 302c 2032 5d29 2c20  t(coord[0, 2]), 
+0001dc70: 2a61 6263 5b30 2c20 3a32 5d0a 2020 2020  *abc[0, :2].    
+0001dc80: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+0001dc90: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+0001dca0: 2020 2020 2020 2020 662e 7772 6974 6528          f.write(
+0001dcb0: 2822 7b3a 3c38 737d 2220 2b20 227b 3a31  ("{:<8s}" + "{:1
+0001dcc0: 362e 3865 7d22 202a 2034 202b 2022 2a5c  6.8e}" * 4 + "*\
+0001dcd0: 6e22 292e 666f 726d 6174 2822 2a22 2c20  n").format("*", 
+0001dce0: 6162 635b 302c 2032 5d2c 202a 6162 635b  abc[0, 2], *abc[
+0001dcf0: 315d 2929 0a20 2020 2020 2020 2020 2020  1])).           
+0001dd00: 2066 2e77 7269 7465 2828 227b 3a3c 3873   f.write(("{:<8s
+0001dd10: 7d22 202b 2022 7b3a 3136 2e38 657d 2220  }" + "{:16.8e}" 
+0001dd20: 2a20 3320 2b20 225c 6e22 292e 666f 726d  * 3 + "\n").form
+0001dd30: 6174 2822 2a22 2c20 2a61 6263 5b32 5d29  at("*", *abc[2])
+0001dd40: 290a 0a20 2020 205f 7774 636f 6f72 6473  )..    _wtcoords
+0001dd50: 2866 2c20 6369 290a 0a0a 4067 7569 746f  (f, ci)...@guito
+0001dd60: 6f6c 732e 7772 6974 655f 7465 7874 5f66  ols.write_text_f
+0001dd70: 696c 650a 6465 6620 7774 6578 7472 6e28  ile.def wtextrn(
+0001dd80: 662c 2069 6473 2c20 646f 6629 3a0a 2020  f, ids, dof):.  
+0001dd90: 2020 2222 220a 2020 2020 5772 6974 6573    """.    Writes
+0001dda0: 2061 204e 6173 7472 616e 2045 5854 524e   a Nastran EXTRN
+0001ddb0: 2063 6172 6420 746f 2061 2066 696c 652e   card to a file.
+0001ddc0: 0a0a 2020 2020 5061 7261 6d65 7465 7273  ..    Parameters
+0001ddd0: 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a  .    ----------.
+0001dde0: 2020 2020 6620 3a20 7374 7269 6e67 206f      f : string o
+0001ddf0: 7220 6669 6c65 5f6c 696b 6520 6f72 2031  r file_like or 1
+0001de00: 206f 7220 4e6f 6e65 0a20 2020 2020 2020   or None.       
+0001de10: 2045 6974 6865 7220 6120 6e61 6d65 206f   Either a name o
+0001de20: 6620 6120 6669 6c65 2c20 6f72 2069 7320  f a file, or is 
+0001de30: 6120 6669 6c65 5f6c 696b 6520 6f62 6a65  a file_like obje
+0001de40: 6374 2061 7320 7265 7475 726e 6564 0a20  ct as returned. 
+0001de50: 2020 2020 2020 2062 7920 3a66 756e 633a         by :func:
+0001de60: 606f 7065 6e60 206f 7220 3a63 6c61 7373  `open` or :class
+0001de70: 3a60 696f 2e53 7472 696e 6749 4f60 2e20  :`io.StringIO`. 
+0001de80: 496e 7075 7420 6173 2069 6e74 6567 6572  Input as integer
+0001de90: 2031 2074 6f0a 2020 2020 2020 2020 7772   1 to.        wr
+0001dea0: 6974 6520 746f 2073 7464 6f75 742e 2043  ite to stdout. C
+0001deb0: 616e 2061 6c73 6f20 6265 2074 6865 206e  an also be the n
+0001dec0: 616d 6520 6f66 2061 2064 6972 6563 746f  ame of a directo
+0001ded0: 7279 206f 7220 4e6f 6e65 3b0a 2020 2020  ry or None;.    
+0001dee0: 2020 2020 696e 2074 6865 7365 2063 6173      in these cas
+0001def0: 6573 2c20 6120 4755 4920 6973 206f 7065  es, a GUI is ope
+0001df00: 6e65 6420 666f 7220 6669 6c65 2073 656c  ned for file sel
+0001df10: 6563 7469 6f6e 2e0a 2020 2020 6964 7320  ection..    ids 
+0001df20: 3a20 3164 2061 7272 6179 5f6c 696b 650a  : 1d array_like.
+0001df30: 2020 2020 2020 2020 5665 6374 6f72 206f          Vector o
+0001df40: 6620 6e6f 6465 2069 6473 0a20 2020 2064  f node ids.    d
+0001df50: 6f66 203a 2031 6420 6172 7261 795f 6c69  of : 1d array_li
+0001df60: 6b65 0a20 2020 2020 2020 2056 6563 746f  ke.        Vecto
+0001df70: 7220 6f66 2044 4f46 0a0a 2020 2020 5265  r of DOF..    Re
+0001df80: 7475 726e 730a 2020 2020 2d2d 2d2d 2d2d  turns.    ------
+0001df90: 2d0a 2020 2020 4e6f 6e65 0a0a 2020 2020  -.    None..    
+0001dfa0: 4e6f 7465 730a 2020 2020 2d2d 2d2d 2d0a  Notes.    -----.
+0001dfb0: 2020 2020 5479 7069 6361 6c6c 7920 6361      Typically ca
+0001dfc0: 6c6c 6564 2062 7920 3a66 756e 633a 6077  lled by :func:`w
+0001dfd0: 7465 7874 7365 6f75 7460 2e0a 0a20 2020  textseout`...   
+0001dfe0: 2045 7861 6d70 6c65 730a 2020 2020 2d2d   Examples.    --
+0001dff0: 2d2d 2d2d 2d2d 0a20 2020 203e 3e3e 2066  ------.    >>> f
+0001e000: 726f 6d20 7079 7965 7469 2069 6d70 6f72  rom pyyeti impor
+0001e010: 7420 6e61 7374 7261 6e0a 2020 2020 3e3e  t nastran.    >>
+0001e020: 3e20 6e61 7374 7261 6e2e 7774 6578 7472  > nastran.wtextr
+0001e030: 6e28 312c 205b 3939 392c 2031 3030 3031  n(1, [999, 10001
+0001e040: 2c20 3130 3030 322c 2031 3030 3033 2c20  , 10002, 10003, 
+0001e050: 3130 3030 342c 2031 3030 3035 5d2c 0a20  10004, 10005],. 
+0001e060: 2020 202e 2e2e 2020 2020 2020 2020 2020     ...          
+0001e070: 2020 2020 2020 2020 2020 5b31 3233 3435            [12345
+0001e080: 362c 2030 2c20 302c 2030 2c20 302c 2030  6, 0, 0, 0, 0, 0
+0001e090: 5d29 0a20 2020 2045 5854 524e 2020 2020  ]).    EXTRN    
+0001e0a0: 2020 2020 3939 3920 2031 3233 3435 3620      999  123456 
+0001e0b0: 2020 3130 3030 3120 2020 2020 2020 3020    10001       0 
+0001e0c0: 2020 3130 3030 3220 2020 2020 2020 3020    10002       0 
+0001e0d0: 2020 3130 3030 3320 2020 2020 2020 300a    10003       0.
+0001e0e0: 2020 2020 2020 2020 2020 2020 2020 2031                 1
+0001e0f0: 3030 3034 2020 2020 2020 2030 2020 2031  0004       0   1
+0001e100: 3030 3035 2020 2020 2020 2030 0a20 2020  0005       0.   
+0001e110: 2022 2222 0a20 2020 2066 2e77 7269 7465   """.    f.write
+0001e120: 2822 4558 5452 4e20 2020 2229 0a20 2020  ("EXTRN   ").   
+0001e130: 2069 6e74 7320 3d20 6e70 2e7a 6572 6f73   ints = np.zeros
+0001e140: 286c 656e 2869 6473 2920 2a20 322c 2064  (len(ids) * 2, d
+0001e150: 7479 7065 3d69 6e74 290a 2020 2020 696e  type=int).    in
+0001e160: 7473 5b3a 3a32 5d20 3d20 6964 730a 2020  ts[::2] = ids.  
+0001e170: 2020 696e 7473 5b31 3a3a 325d 203d 2064    ints[1::2] = d
+0001e180: 6f66 0a20 2020 2077 746e 6173 696e 7473  of.    wtnasints
+0001e190: 2866 2c20 322c 2069 6e74 7329 0a0a 0a64  (f, 2, ints)...d
+0001e1a0: 6566 2077 7465 7874 7365 6f75 7428 0a20  ef wtextseout(. 
+0001e1b0: 2020 206e 616d 652c 0a20 2020 202a 2c0a     name,.    *,.
+0001e1c0: 2020 2020 7365 2c0a 2020 2020 6d61 612c      se,.    maa,
+0001e1d0: 0a20 2020 2062 6161 2c0a 2020 2020 6b61  .    baa,.    ka
+0001e1e0: 612c 0a20 2020 2062 7365 742c 0a20 2020  a,.    bset,.   
+0001e1f0: 2075 7365 742c 0a20 2020 2073 706f 696e   uset,.    spoin
+0001e200: 7431 2c0a 2020 2020 7365 646e 3d30 2c0a  t1,.    sedn=0,.
+0001e210: 2020 2020 6e61 6d65 6c69 7374 3d5b 0a20      namelist=[. 
+0001e220: 2020 2020 2020 2022 6b61 6122 2c0a 2020         "kaa",.  
+0001e230: 2020 2020 2020 226d 6161 222c 0a20 2020        "maa",.   
+0001e240: 2020 2020 2022 6261 6122 2c0a 2020 2020       "baa",.    
+0001e250: 2020 2020 226b 3478 7822 2c0a 2020 2020      "k4xx",.    
+0001e260: 2020 2020 2270 6122 2c0a 2020 2020 2020      "pa",.      
+0001e270: 2020 2267 7078 7822 2c0a 2020 2020 2020    "gpxx",.      
+0001e280: 2020 2267 6478 7822 2c0a 2020 2020 2020    "gdxx",.      
+0001e290: 2020 2272 7661 7822 2c0a 2020 2020 2020    "rvax",.      
+0001e2a0: 2020 2276 6122 2c0a 2020 2020 2020 2020    "va",.        
+0001e2b0: 226d 7567 3122 2c0a 2020 2020 2020 2020  "mug1",.        
+0001e2c0: 226d 7567 316f 222c 0a20 2020 2020 2020  "mug1o",.       
+0001e2d0: 2022 6d65 7331 222c 0a20 2020 2020 2020   "mes1",.       
+0001e2e0: 2022 6d65 7331 6f22 2c0a 2020 2020 2020   "mes1o",.      
+0001e2f0: 2020 226d 6565 3122 2c0a 2020 2020 2020    "mee1",.      
+0001e300: 2020 226d 6565 316f 222c 0a20 2020 2020    "mee1o",.     
+0001e310: 2020 2022 6d67 7066 222c 0a20 2020 2020     "mgpf",.     
+0001e320: 2020 2022 6d67 7066 6f22 2c0a 2020 2020     "mgpfo",.    
+0001e330: 2020 2020 226d 6566 3122 2c0a 2020 2020      "mef1",.    
+0001e340: 2020 2020 226d 6566 316f 222c 0a20 2020      "mef1o",.   
+0001e350: 2020 2020 2022 6d71 6731 222c 0a20 2020       "mqg1",.   
+0001e360: 2020 2020 2022 6d71 6731 6f22 2c0a 2020       "mqg1o",.  
+0001e370: 2020 2020 2020 226d 716d 6731 222c 0a20        "mqmg1",. 
+0001e380: 2020 2020 2020 2022 6d71 6d67 316f 222c         "mqmg1o",
+0001e390: 0a20 2020 205d 2c0a 2020 2020 2a2a 6b77  .    ],.    **kw
+0001e3a0: 6172 6773 2c0a 293a 0a20 2020 2022 2222  args,.):.    """
+0001e3b0: 0a20 2020 2057 7269 7465 202e 6f70 342c  .    Write .op4,
+0001e3c0: 202e 6173 6d2c 202e 7063 6820 616e 6420   .asm, .pch and 
+0001e3d0: 706f 7373 6962 6c79 2074 6865 2064 616d  possibly the dam
+0001e3e0: 7069 6e67 2044 4d49 4720 6669 6c65 2066  ping DMIG file f
+0001e3f0: 6f72 2061 6e0a 2020 2020 6578 7465 726e  or an.    extern
+0001e400: 616c 2053 452e 0a0a 2020 2020 4e6f 7465  al SE...    Note
+0001e410: 2074 6861 7420 616c 6c20 696e 7075 7473   that all inputs
+0001e420: 2065 7863 6570 7420 606e 616d 6560 206d   except `name` m
+0001e430: 7573 7420 6265 206e 616d 6564 2061 6e64  ust be named and
+0001e440: 2063 616e 2062 6520 696e 7075 740a 2020   can be input.  
+0001e450: 2020 696e 2061 6e79 206f 7264 6572 2e0a    in any order..
+0001e460: 0a20 2020 2050 6172 616d 6574 6572 730a  .    Parameters.
+0001e470: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
+0001e480: 2020 206e 616d 6520 3a20 7374 7269 6e67     name : string
+0001e490: 0a20 2020 2020 2020 2042 6173 656e 616d  .        Basenam
+0001e4a0: 6520 666f 7220 6669 6c65 733b 2065 673a  e for files; eg:
+0001e4b0: 2027 7370 6163 6563 7261 6674 272e 2046   'spacecraft'. F
+0001e4c0: 696c 6573 2077 6974 6820 7468 650a 2020  iles with the.  
+0001e4d0: 2020 2020 2020 6578 7465 6e73 696f 6e73        extensions
+0001e4e0: 2027 2e6f 7034 272c 2027 2e61 736d 272c   '.op4', '.asm',
+0001e4f0: 2061 6e64 2027 2e70 6368 2720 7769 6c6c   and '.pch' will
+0001e500: 2062 6520 6372 6561 7465 642e 2049 6620   be created. If 
+0001e510: 6062 6860 0a20 2020 2020 2020 2069 7320  `bh`.        is 
+0001e520: 5472 7565 2c20 6120 272e 6261 615f 646d  True, a '.baa_dm
+0001e530: 6967 2720 6669 6c65 2077 696c 6c20 616c  ig' file will al
+0001e540: 736f 2062 6520 6372 6561 7465 642e 0a20  so be created.. 
+0001e550: 2020 2073 6520 3a20 696e 7465 6765 720a     se : integer.
+0001e560: 2020 2020 2020 2020 5375 7065 7265 6c65          Superele
+0001e570: 6d65 6e74 2069 643b 2061 6c73 6f20 7573  ment id; also us
+0001e580: 6564 2061 7320 7468 6520 466f 7274 7261  ed as the Fortra
+0001e590: 6e20 756e 6974 206e 756d 6265 7220 6f6e  n unit number on
+0001e5a0: 2074 6865 0a20 2020 2020 2020 2053 4542   the.        SEB
+0001e5b0: 554c 4b20 656e 7472 792e 0a20 2020 206d  ULK entry..    m
+0001e5c0: 6161 2c20 6261 612c 206b 6161 203a 2032  aa, baa, kaa : 2
+0001e5d0: 6420 6172 7261 795f 6c69 6b65 0a20 2020  d array_like.   
+0001e5e0: 2020 2020 2054 6865 7365 2061 7265 2074       These are t
+0001e5f0: 6865 2043 7261 6967 2d42 616d 7074 6f6e  he Craig-Bampton
+0001e600: 206d 6173 732c 2064 616d 7069 6e67 2061   mass, damping a
+0001e610: 6e64 2073 7469 6666 6e65 7373 0a20 2020  nd stiffness.   
+0001e620: 2020 2020 206d 6174 7269 6365 7320 7265       matrices re
+0001e630: 7370 6563 7469 7665 6c79 2e0a 2020 2020  spectively..    
+0001e640: 6273 6574 203a 2031 6420 6172 7261 795f  bset : 1d array_
+0001e650: 6c69 6b65 0a20 2020 2020 2020 2049 6e64  like.        Ind
+0001e660: 6578 2070 6172 7469 7469 6f6e 2076 6563  ex partition vec
+0001e670: 746f 7220 666f 7220 7468 6520 6273 6574  tor for the bset
+0001e680: 0a20 2020 2075 7365 7420 3a20 7061 6e64  .    uset : pand
+0001e690: 6173 2044 6174 6146 7261 6d65 0a20 2020  as DataFrame.   
+0001e6a0: 2020 2020 2041 2044 6174 6146 7261 6d65       A DataFrame
+0001e6b0: 2061 7320 6f75 7470 7574 2062 790a 2020   as output by.  
+0001e6c0: 2020 2020 2020 3a66 756e 633a 6070 7979        :func:`pyy
+0001e6d0: 6574 692e 6e61 7374 7261 6e2e 6f70 322e  eti.nastran.op2.
+0001e6e0: 4f50 322e 7264 6e32 636f 7032 602e 0a0a  OP2.rdn2cop2`...
+0001e6f0: 2020 2020 2020 2020 2e2e 2077 6172 6e69          .. warni
+0001e700: 6e67 3a3a 0a20 2020 2020 2020 2020 2020  ng::.           
+0001e710: 2055 6e6c 696b 6520 3a66 756e 633a 6070   Unlike :func:`p
+0001e720: 7979 6574 692e 6362 2e6d 6b5f 6e65 745f  yyeti.cb.mk_net_
+0001e730: 6472 6d73 602c 2074 6869 7320 5553 4554  drms`, this USET
+0001e740: 2074 6162 6c65 0a20 2020 2020 2020 2020   table.         
+0001e750: 2020 2064 6566 696e 6573 2074 6865 2062     defines the b
+0001e760: 2d73 6574 206e 6f64 6573 2072 656c 6174  -set nodes relat
+0001e770: 6976 6520 746f 2074 6865 2062 6173 6963  ive to the basic
+0001e780: 2063 6f6f 7264 696e 6174 650a 2020 2020   coordinate.    
+0001e790: 2020 2020 2020 2020 7379 7374 656d 206f          system o
+0001e7a0: 6620 7375 7065 7265 6c65 6d65 6e74 2030  f superelement 0
+0001e7b0: 2e20 5468 6973 2069 7320 736f 2074 6865  . This is so the
+0001e7c0: 2065 7874 6572 6e61 6c0a 2020 2020 2020   external.      
+0001e7d0: 2020 2020 2020 7375 7065 7265 6c65 6d65        supereleme
+0001e7e0: 6e74 2069 7320 706f 7369 7469 6f6e 6564  nt is positioned
+0001e7f0: 2070 726f 7065 726c 792e 204e 6f74 6520   properly. Note 
+0001e800: 686f 7765 7665 7220 7468 6174 2074 6865  however that the
+0001e810: 0a20 2020 2020 2020 2020 2020 2022 6469  .            "di
+0001e820: 7370 6c61 6365 6d65 6e74 2220 636f 6f72  splacement" coor
+0001e830: 6469 6e61 7465 2073 7973 7465 6d28 7329  dinate system(s)
+0001e840: 2028 7370 6563 6966 6965 6420 6166 7465   (specified afte
+0001e850: 7220 7468 650a 2020 2020 2020 2020 2020  r the.          
+0001e860: 2020 636f 6f72 6469 6e61 7465 7320 6f6e    coordinates on
+0001e870: 2074 6865 2022 4752 4944 2220 6361 7264   the "GRID" card
+0001e880: 2920 6d75 7374 206d 6174 6368 2077 6861  ) must match wha
+0001e890: 7465 7665 7220 7468 650a 2020 2020 2020  tever the.      
+0001e8a0: 2020 2020 2020 6469 7370 6c61 6365 6d65        displaceme
+0001e8b0: 6e74 2063 6f6f 7264 696e 6174 6520 7379  nt coordinate sy
+0001e8c0: 7374 656d 2873 2920 6172 6520 666f 7220  stem(s) are for 
+0001e8d0: 7468 650a 2020 2020 2020 2020 2020 2020  the.            
+0001e8e0: 4372 6169 672d 4261 6d70 746f 6e20 636f  Craig-Bampton co
+0001e8f0: 6d70 6f6e 656e 742e 0a0a 2020 2020 7370  mponent...    sp
+0001e900: 6f69 6e74 3120 3a20 696e 7465 6765 720a  oint1 : integer.
+0001e910: 2020 2020 2020 2020 5374 6172 7469 6e67          Starting
+0001e920: 2076 616c 7565 2066 6f72 2074 6865 2053   value for the S
+0001e930: 504f 494e 5473 2028 666f 7220 6d6f 6461  POINTs (for moda
+0001e940: 6c20 444f 4629 0a20 2020 2073 6564 6e20  l DOF).    sedn 
+0001e950: 3a20 696e 7465 6765 723b 206f 7074 696f  : integer; optio
+0001e960: 6e61 6c0a 2020 2020 2020 2020 446f 776e  nal.        Down
+0001e970: 7374 7265 616d 2073 7570 6572 656c 656d  stream superelem
+0001e980: 656e 7420 6964 0a20 2020 206e 616d 656c  ent id.    namel
+0001e990: 6973 7420 3a20 6c69 7374 3b20 6f70 7469  ist : list; opti
+0001e9a0: 6f6e 616c 0a20 2020 2020 2020 204c 6973  onal.        Lis
+0001e9b0: 742c 2069 6e20 6f72 6465 722c 206f 6620  t, in order, of 
+0001e9c0: 6e61 6d65 7320 746f 2077 7269 7465 2074  names to write t
+0001e9d0: 6f20 7468 6520 6f70 3420 6669 6c65 2e20  o the op4 file. 
+0001e9e0: 5661 6c75 6573 0a20 2020 2020 2020 2064  Values.        d
+0001e9f0: 6566 6175 6c74 2074 6f20 3178 3120 7a65  efault to 1x1 ze
+0001ea00: 726f 206d 6174 7269 6365 7320 7769 7468  ro matrices with
+0001ea10: 2074 6865 7365 2065 7863 6570 7469 6f6e   these exception
+0001ea20: 733a 2022 6d61 6122 2c0a 2020 2020 2020  s: "maa",.      
+0001ea30: 2020 226b 6161 222c 2022 6261 6122 2c20    "kaa", "baa", 
+0001ea40: 6172 6520 6173 2069 6e70 7574 2061 626f  are as input abo
+0001ea50: 7665 2c20 2270 6122 2069 7320 6120 7665  ve, "pa" is a ve
+0001ea60: 6374 6f72 206f 6620 7a65 726f 730a 2020  ctor of zeros.  
+0001ea70: 2020 2020 2020 616e 6420 2276 6122 2069        and "va" i
+0001ea80: 7320 6120 7665 6374 6f72 206f 6620 6f6e  s a vector of on
+0001ea90: 6573 2e20 5468 6520 6465 6661 756c 7473  es. The defaults
+0001eaa0: 2063 616e 2062 6520 6f76 6572 7269 6464   can be overridd
+0001eab0: 656e 0a20 2020 2020 2020 2069 6e20 606b  en.        in `k
+0001eac0: 7761 7267 7360 2e0a 2020 2020 2a2a 6b77  wargs`..    **kw
+0001ead0: 6172 6773 203a 206f 7074 696f 6e61 6c0a  args : optional.
+0001eae0: 2020 2020 2020 2020 416c 6c6f 7773 2075          Allows u
+0001eaf0: 7365 7220 746f 2069 6e70 7574 206f 7468  ser to input oth
+0001eb00: 6572 206d 6174 7269 6365 7320 746f 2062  er matrices to b
+0001eb10: 6520 7772 6974 7465 6e20 746f 2074 6865  e written to the
+0001eb20: 206f 7034 0a20 2020 2020 2020 2066 696c   op4.        fil
+0001eb30: 652e 204e 616d 6520 6d75 7374 2069 6e20  e. Name must in 
+0001eb40: 606e 616d 656c 6973 7460 2074 6f20 6265  `namelist` to be
+0001eb50: 2077 7269 7474 656e 2e0a 0a20 2020 2052   written...    R
+0001eb60: 6574 7572 6e73 0a20 2020 202d 2d2d 2d2d  eturns.    -----
+0001eb70: 2d2d 0a20 2020 204e 6f6e 650a 2020 2020  --.    None.    
+0001eb80: 2222 220a 2020 2020 6d61 612c 2062 6161  """.    maa, baa
+0001eb90: 2c20 6b61 6120 3d20 6e70 2e61 746c 6561  , kaa = np.atlea
+0001eba0: 7374 5f32 6428 6d61 612c 2062 6161 2c20  st_2d(maa, baa, 
+0001ebb0: 6b61 6129 0a20 2020 2062 7365 7420 3d20  kaa).    bset = 
+0001ebc0: 6e70 2e61 746c 6561 7374 5f31 6428 6273  np.atleast_1d(bs
+0001ebd0: 6574 290a 2020 2020 6e20 3d20 6d61 612e  et).    n = maa.
+0001ebe0: 7368 6170 655b 305d 0a20 2020 206e 7120  shape[0].    nq 
+0001ebf0: 3d20 6e20 2d20 6c65 6e28 6273 6574 290a  = n - len(bset).
+0001ec00: 0a20 2020 2023 2070 7265 7061 7265 2073  .    # prepare s
+0001ec10: 7461 6e64 6172 6420 4e61 7374 7261 6e20  tandard Nastran 
+0001ec20: 6f70 3420 6669 6c65 3a0a 2020 2020 7061  op4 file:.    pa
+0001ec30: 203d 206e 702e 7a65 726f 7328 286e 2c20   = np.zeros((n, 
+0001ec40: 3129 290a 2020 2020 7661 203d 206e 702e  1)).    va = np.
+0001ec50: 6f6e 6573 2828 6e2c 2031 2929 0a20 2020  ones((n, 1)).   
+0001ec60: 2064 6374 203d 207b 2a2a 6c6f 6361 6c73   dct = {**locals
+0001ec70: 2829 2c20 2a2a 6b77 6172 6773 7d0a 2020  (), **kwargs}.  
+0001ec80: 2020 7661 726c 6973 7420 3d20 5b64 6374    varlist = [dct
+0001ec90: 2e67 6574 2869 2c20 302e 3029 2066 6f72  .get(i, 0.0) for
+0001eca0: 2069 2069 6e20 6e61 6d65 6c69 7374 5d0a   i in namelist].
+0001ecb0: 2020 2020 6f70 342e 7772 6974 6528 6e61      op4.write(na
+0001ecc0: 6d65 202b 2022 2e6f 7034 222c 206e 616d  me + ".op4", nam
+0001ecd0: 656c 6973 742c 2076 6172 6c69 7374 290a  elist, varlist).
+0001ece0: 0a20 2020 2023 2047 6574 2073 6f6d 6520  .    # Get some 
+0001ecf0: 6461 7461 2066 726f 6d20 7468 6520 7573  data from the us
+0001ed00: 6574 2074 6162 6c65 3a0a 2020 2020 6369  et table:.    ci
+0001ed10: 203d 206e 3270 2e6d 6b63 6f72 6463 6172   = n2p.mkcordcar
+0001ed20: 6469 6e66 6f28 7573 6574 290a 2020 2020  dinfo(uset).    
+0001ed30: 6772 6964 7320 3d20 7573 6574 2e69 6e64  grids = uset.ind
+0001ed40: 6578 2e67 6574 5f6c 6576 656c 5f76 616c  ex.get_level_val
+0001ed50: 7565 7328 2269 6422 290a 2020 2020 646f  ues("id").    do
+0001ed60: 6620 3d20 7573 6574 2e69 6e64 6578 2e67  f = uset.index.g
+0001ed70: 6574 5f6c 6576 656c 5f76 616c 7565 7328  et_level_values(
+0001ed80: 2264 6f66 2229 0a20 2020 2070 7620 3d20  "dof").    pv = 
+0001ed90: 646f 6620 3d3d 2031 0a20 2020 2067 7269  dof == 1.    gri
+0001eda0: 6473 203d 2067 7269 6473 5b70 765d 0a20  ds = grids[pv]. 
+0001edb0: 2020 2078 797a 203d 2075 7365 742e 6c6f     xyz = uset.lo
+0001edc0: 635b 7076 2c20 2278 223a 227a 225d 2e76  c[pv, "x":"z"].v
+0001edd0: 616c 7565 730a 2020 2020 7076 203d 2064  alues.    pv = d
+0001ede0: 6f66 203d 3d20 320a 2020 2020 6364 203d  of == 2.    cd =
+0001edf0: 2075 7365 742e 6c6f 635b 7076 2c20 2278   uset.loc[pv, "x
+0001ee00: 225d 2e76 616c 7565 732e 6173 7479 7065  "].values.astype
+0001ee10: 2869 6e74 290a 0a20 2020 2023 2057 7269  (int)..    # Wri
+0001ee20: 7465 206f 7574 2041 534d 2066 696c 650a  te out ASM file.
+0001ee30: 2020 2020 756e 6974 203d 2073 650a 2020      unit = se.  
+0001ee40: 2020 7370 6f69 6e74 6e20 3d20 7370 6f69    spointn = spoi
+0001ee50: 6e74 3120 2b20 6e71 202d 2031 0a20 2020  nt1 + nq - 1.   
+0001ee60: 2077 6974 6820 6f70 656e 286e 616d 6520   with open(name 
+0001ee70: 2b20 222e 6173 6d22 2c20 2277 2229 2061  + ".asm", "w") a
+0001ee80: 7320 663a 0a20 2020 2020 2020 2066 2e77  s f:.        f.w
+0001ee90: 7269 7465 280a 2020 2020 2020 2020 2020  rite(.          
+0001eea0: 2020 6622 2420 7b6e 616d 652e 7570 7065    f"$ {name.uppe
+0001eeb0: 7228 297d 2041 5353 454d 424c 5920 4649  r()} ASSEMBLY FI
+0001eec0: 4c45 2046 4f52 2052 4553 4944 5541 4c20  LE FOR RESIDUAL 
+0001eed0: 5255 4e2e 2e2e 494e 434c 5544 4520 494e  RUN...INCLUDE IN
+0001eee0: 2042 554c 4b20 4441 5441 5c6e 220a 2020   BULK DATA\n".  
+0001eef0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0001ef00: 662e 7772 6974 6528 2224 5c6e 2229 0a20  f.write("$\n"). 
+0001ef10: 2020 2020 2020 2066 2e77 7269 7465 2866         f.write(f
+0001ef20: 2253 4542 554c 4b20 207b 7365 3a38 647d  "SEBULK  {se:8d}
+0001ef30: 2020 4558 544f 5034 2020 2020 2020 2020    EXTOP4        
+0001ef40: 2020 4d41 4e55 414c 2020 2020 2020 2020    MANUAL        
+0001ef50: 2020 2020 2020 2020 7b75 6e69 743a 3864          {unit:8d
+0001ef60: 7d5c 6e22 290a 2020 2020 2020 2020 662e  }\n").        f.
+0001ef70: 7772 6974 6528 6622 5345 434f 4e43 5420  write(f"SECONCT 
+0001ef80: 7b73 653a 3864 7d7b 7365 646e 3a38 647d  {se:8d}{sedn:8d}
+0001ef90: 2020 2020 2020 2020 2020 2020 2020 4e4f                NO
+0001efa0: 5c6e 2229 0a20 2020 2020 2020 2066 2e77  \n").        f.w
+0001efb0: 7269 7465 2822 2020 2020 2020 2020 2229  rite("        ")
+0001efc0: 0a20 2020 2020 2020 2067 6964 7320 3d20  .        gids = 
+0001efd0: 6e70 2e76 7374 6163 6b28 2867 7269 6473  np.vstack((grids
+0001efe0: 2c20 6772 6964 7329 292e 540a 2020 2020  , grids)).T.    
+0001eff0: 2020 2020 7774 6e61 7369 6e74 7328 662c      wtnasints(f,
+0001f000: 2032 2c20 6769 6473 2e72 6176 656c 2829   2, gids.ravel()
+0001f010: 290a 0a20 2020 2020 2020 2023 2057 7269  )..        # Wri
+0001f020: 7465 2063 6f6f 7264 696e 6174 6520 7379  te coordinate sy
+0001f030: 7374 656d 2063 6172 6473 2069 6620 6e65  stem cards if ne
+0001f040: 6564 6564 3a0a 2020 2020 2020 2020 662e  eded:.        f.
+0001f050: 7772 6974 6528 2224 5c6e 2420 434f 4f52  write("$\n$ COOR
+0001f060: 4449 4e41 5445 2053 5953 5445 4d20 4441  DINATE SYSTEM DA
+0001f070: 5441 5c6e 245c 6e22 290a 2020 2020 2020  TA\n$\n").      
+0001f080: 2020 7774 636f 6f72 6463 6172 6473 2866    wtcoordcards(f
+0001f090: 2c20 6369 290a 0a20 2020 2020 2020 2023  , ci)..        #
+0001f0a0: 2057 7269 7465 2047 7269 6420 6461 7461   Write Grid data
+0001f0b0: 3a0a 2020 2020 2020 2020 662e 7772 6974  :.        f.writ
+0001f0c0: 6528 2224 5c6e 2420 424f 554e 4441 5259  e("$\n$ BOUNDARY
+0001f0d0: 2047 5249 4420 4441 5441 5c6e 245c 6e22   GRID DATA\n$\n"
+0001f0e0: 290a 2020 2020 2020 2020 7774 6772 6964  ).        wtgrid
+0001f0f0: 7328 662c 2067 7269 6473 2c20 302c 2078  s(f, grids, 0, x
+0001f100: 797a 2c20 6364 290a 2020 2020 2020 2020  yz, cd).        
+0001f110: 6966 2073 706f 696e 746e 203e 3d20 7370  if spointn >= sp
+0001f120: 6f69 6e74 313a 0a20 2020 2020 2020 2020  oint1:.         
+0001f130: 2020 2066 2e77 7269 7465 2822 245c 6e22     f.write("$\n"
+0001f140: 290a 2020 2020 2020 2020 2020 2020 662e  ).            f.
+0001f150: 7772 6974 6528 6622 5345 434f 4e43 5420  write(f"SECONCT 
+0001f160: 7b73 653a 3864 7d7b 7365 646e 3a38 647d  {se:8d}{sedn:8d}
+0001f170: 2020 2020 2020 2020 2020 2020 2020 4e4f                NO
+0001f180: 5c6e 2229 0a20 2020 2020 2020 2020 2020  \n").           
+0001f190: 2066 2e77 7269 7465 280a 2020 2020 2020   f.write(.      
+0001f1a0: 2020 2020 2020 2020 2020 6622 2020 2020            f"    
+0001f1b0: 2020 2020 7b73 706f 696e 7431 3a38 647d      {spoint1:8d}
+0001f1c0: 2020 2020 5448 5255 7b73 706f 696e 746e      THRU{spointn
+0001f1d0: 3a38 647d 220a 2020 2020 2020 2020 2020  :8d}".          
+0001f1e0: 2020 2020 2020 6622 7b73 706f 696e 7431        f"{spoint1
+0001f1f0: 3a38 647d 2020 2020 5448 5255 7b73 706f  :8d}    THRU{spo
+0001f200: 696e 746e 3a38 647d 5c6e 220a 2020 2020  intn:8d}\n".    
+0001f210: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0001f220: 2020 2020 2020 662e 7772 6974 6528 2224        f.write("$
+0001f230: 5c6e 2229 0a20 2020 2020 2020 2020 2020  \n").           
+0001f240: 2066 2e77 7269 7465 2866 2253 504f 494e   f.write(f"SPOIN
+0001f250: 5420 207b 7370 6f69 6e74 313a 3864 7d20  T  {spoint1:8d} 
+0001f260: 2020 2054 4852 557b 7370 6f69 6e74 6e3a     THRU{spointn:
+0001f270: 3864 7d5c 6e22 290a 0a20 2020 2023 2057  8d}\n")..    # W
+0001f280: 7269 7465 206f 7574 2050 4348 2066 696c  rite out PCH fil
+0001f290: 650a 2020 2020 7769 7468 206f 7065 6e28  e.    with open(
+0001f2a0: 6e61 6d65 202b 2022 2e70 6368 222c 2022  name + ".pch", "
+0001f2b0: 7722 2920 6173 2066 3a0a 2020 2020 2020  w") as f:.      
+0001f2c0: 2020 662e 7772 6974 6528 6622 2420 7b6e    f.write(f"$ {n
+0001f2d0: 616d 652e 7570 7065 7228 297d 2050 554e  ame.upper()} PUN
+0001f2e0: 4348 2046 494c 4520 464f 5220 5245 5349  CH FILE FOR RESI
+0001f2f0: 4455 414c 2052 554e 2e2e 2e49 4e43 4c55  DUAL RUN...INCLU
+0001f300: 4445 2041 5420 454e 445c 6e22 290a 2020  DE AT END\n").  
+0001f310: 2020 2020 2020 662e 7772 6974 6528 2224        f.write("$
+0001f320: 5c6e 2229 0a20 2020 2020 2020 2066 2e77  \n").        f.w
+0001f330: 7269 7465 2866 2242 4547 494e 2053 5550  rite(f"BEGIN SUP
+0001f340: 4552 7b73 653a 3864 7d5c 6e24 5c6e 2229  ER{se:8d}\n$\n")
+0001f350: 0a20 2020 2020 2020 2069 6473 203d 206e  .        ids = n
+0001f360: 702e 6873 7461 636b 2828 6772 6964 732c  p.hstack((grids,
+0001f370: 2073 706f 696e 7431 202b 206e 702e 6172   spoint1 + np.ar
+0001f380: 616e 6765 286e 7129 2929 0a20 2020 2020  ange(nq))).     
+0001f390: 2020 2064 6f66 203d 206e 702e 7a65 726f     dof = np.zero
+0001f3a0: 735f 6c69 6b65 2869 6473 2c20 6474 7970  s_like(ids, dtyp
+0001f3b0: 653d 696e 7429 0a20 2020 2020 2020 2064  e=int).        d
+0001f3c0: 6f66 5b3a 206c 656e 2867 7269 6473 295d  of[: len(grids)]
+0001f3d0: 203d 2031 3233 3435 360a 2020 2020 2020   = 123456.      
+0001f3e0: 2020 7774 6578 7472 6e28 662c 2069 6473    wtextrn(f, ids
+0001f3f0: 2c20 646f 6629 0a20 2020 2020 2020 2066  , dof).        f
+0001f400: 2e77 7269 7465 2822 245c 6e22 290a 2020  .write("$\n").  
+0001f410: 2020 2020 2020 662e 7772 6974 6528 2224        f.write("$
+0001f420: 2043 4f4f 5244 494e 4154 4520 5359 5354   COORDINATE SYST
+0001f430: 454d 2044 4154 415c 6e24 5c6e 2229 0a20  EM DATA\n$\n"). 
+0001f440: 2020 2020 2020 2077 7463 6f6f 7264 6361         wtcoordca
+0001f450: 7264 7328 662c 2063 6929 0a20 2020 2020  rds(f, ci).     
+0001f460: 2020 2066 2e77 7269 7465 2822 245c 6e24     f.write("$\n$
+0001f470: 2042 4f55 4e44 4152 5920 4752 4944 2044   BOUNDARY GRID D
+0001f480: 4154 415c 6e24 5c6e 2229 0a20 2020 2020  ATA\n$\n").     
+0001f490: 2020 2077 7467 7269 6473 2866 2c20 6772     wtgrids(f, gr
+0001f4a0: 6964 732c 2030 2c20 7879 7a2c 2063 6429  ids, 0, xyz, cd)
+0001f4b0: 0a20 2020 2020 2020 2066 2e77 7269 7465  .        f.write
+0001f4c0: 2822 245c 6e22 290a 0a20 2020 2020 2020  ("$\n")..       
+0001f4d0: 2066 2e77 7269 7465 2822 2420 4253 4554   f.write("$ BSET
+0001f4e0: 5c6e 245c 6e22 290a 2020 2020 2020 2020  \n$\n").        
+0001f4f0: 662e 7772 6974 6528 6622 4153 4554 3120  f.write(f"ASET1 
+0001f500: 2020 7b31 3233 3435 363a 3864 7d22 290a    {123456:8d}").
+0001f510: 2020 2020 2020 2020 7774 6e61 7369 6e74          wtnasint
+0001f520: 7328 662c 2033 2c20 6772 6964 7329 0a20  s(f, 3, grids). 
+0001f530: 2020 2020 2020 2069 6620 7370 6f69 6e74         if spoint
+0001f540: 6e20 3e3d 2073 706f 696e 7431 3a0a 2020  n >= spoint1:.  
+0001f550: 2020 2020 2020 2020 2020 662e 7772 6974            f.writ
+0001f560: 6528 2224 5c6e 2229 0a20 2020 2020 2020  e("$\n").       
+0001f570: 2020 2020 2066 2e77 7269 7465 2822 2420       f.write("$ 
+0001f580: 5153 4554 5c6e 245c 6e22 290a 2020 2020  QSET\n$\n").    
+0001f590: 2020 2020 2020 2020 662e 7772 6974 6528          f.write(
+0001f5a0: 6622 5153 4554 3120 2020 7b30 3a38 647d  f"QSET1   {0:8d}
+0001f5b0: 7b73 706f 696e 7431 3a38 647d 2020 2020  {spoint1:8d}    
+0001f5c0: 5448 5255 7b73 706f 696e 746e 3a38 647d  THRU{spointn:8d}
+0001f5d0: 5c6e 2229 0a20 2020 2020 2020 2020 2020  \n").           
+0001f5e0: 2066 2e77 7269 7465 2822 245c 6e22 290a   f.write("$\n").
+0001f5f0: 2020 2020 2020 2020 2020 2020 662e 7772              f.wr
+0001f600: 6974 6528 6622 5350 4f49 4e54 2020 7b73  ite(f"SPOINT  {s
+0001f610: 706f 696e 7431 3a38 647d 2020 2020 5448  point1:8d}    TH
+0001f620: 5255 7b73 706f 696e 746e 3a38 647d 5c6e  RU{spointn:8d}\n
+0001f630: 2229 0a0a 0a64 6566 206d 6b6e 6173 7428  ")...def mknast(
+0001f640: 0a20 2020 2073 6372 6970 743d 4e6f 6e65  .    script=None
+0001f650: 2c0a 2020 2020 2a2c 0a20 2020 206e 6173  ,.    *,.    nas
+0001f660: 636f 6d3d 226e 6173 7439 7031 222c 0a20  com="nast9p1",. 
+0001f670: 2020 206e 6173 6f70 743d 2262 6174 6368     nasopt="batch
+0001f680: 3d6e 6f22 2c0a 2020 2020 6578 743d 226f  =no",.    ext="o
+0001f690: 7574 222c 0a20 2020 2073 746f 706f 6e66  ut",.    stoponf
+0001f6a0: 6174 616c 3d46 616c 7365 2c0a 2020 2020  atal=False,.    
+0001f6b0: 7368 656c 6c3d 222f 6269 6e2f 7368 222c  shell="/bin/sh",
+0001f6c0: 0a20 2020 2066 696c 6573 3d4e 6f6e 652c  .    files=None,
+0001f6d0: 0a20 2020 2062 6566 6f72 653d 2222 2c0a  .    before="",.
+0001f6e0: 2020 2020 6166 7465 723d 2222 2c0a 2020      after="",.  
+0001f6f0: 2020 746f 703d 2222 2c0a 2020 2020 626f    top="",.    bo
+0001f700: 7474 6f6d 3d22 222c 0a29 3a0a 2020 2020  ttom="",.):.    
+0001f710: 2222 220a 2020 2020 4372 6561 7465 7320  """.    Creates 
+0001f720: 6120 7368 656c 6c20 7363 7269 7074 2066  a shell script f
+0001f730: 6f72 2072 756e 6e69 6e67 2061 2063 6861  or running a cha
+0001f740: 696e 206f 6620 4e61 7374 7261 6e20 286f  in of Nastran (o
+0001f750: 7220 6f74 6865 7229 0a20 2020 2072 756e  r other).    run
+0001f760: 732e 0a0a 2020 2020 4e6f 7465 2074 6861  s...    Note tha
+0001f770: 7420 616c 6c20 696e 7075 7473 2065 7863  t all inputs exc
+0001f780: 6570 7420 6073 6372 6970 7460 206d 7573  ept `script` mus
+0001f790: 7420 6265 206e 616d 6564 2061 6e64 2063  t be named and c
+0001f7a0: 616e 2062 650a 2020 2020 696e 7075 7420  an be.    input 
+0001f7b0: 696e 2061 6e79 206f 7264 6572 2e0a 0a20  in any order... 
+0001f7c0: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
+0001f7d0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
+0001f7e0: 2073 6372 6970 7420 3a20 7374 7269 6e67   script : string
+0001f7f0: 206f 7220 4e6f 6e65 3b20 6f70 7469 6f6e   or None; option
+0001f800: 616c 0a20 2020 2020 2020 204e 616d 6520  al.        Name 
+0001f810: 6f66 2073 6865 6c6c 2073 6372 6970 7420  of shell script 
+0001f820: 746f 2063 7265 6174 653b 2069 6620 4e6f  to create; if No
+0001f830: 6e65 2c20 7573 6572 2069 7320 7072 6f6d  ne, user is prom
+0001f840: 7074 6564 2066 6f72 0a20 2020 2020 2020  pted for.       
+0001f850: 206e 616d 652e 0a20 2020 206e 6173 636f   name..    nasco
+0001f860: 6d20 3a20 7374 7269 6e67 3b20 6f70 7469  m : string; opti
+0001f870: 6f6e 616c 0a20 2020 2020 2020 204e 6173  onal.        Nas
+0001f880: 7472 616e 2063 6f6d 6d61 6e64 3b20 6e6f  tran command; no
+0001f890: 7465 3a20 7468 6973 2063 616e 2061 6374  te: this can act
+0001f8a0: 7561 6c6c 7920 7370 6563 6966 7920 616e  ually specify an
+0001f8b0: 7920 7072 6f67 7261 6d2c 0a20 2020 2020  y program,.     
+0001f8c0: 2020 2062 7574 2060 6e61 736f 7074 6020     but `nasopt` 
+0001f8d0: 776f 756c 6420 6c69 6b65 6c79 206e 6565  would likely nee
+0001f8e0: 6420 6164 6a75 7374 696e 6720 746f 6f2e  d adjusting too.
+0001f8f0: 0a20 2020 206e 6173 6f70 7420 3a20 7374  .    nasopt : st
+0001f900: 7269 6e67 3b20 6f70 7469 6f6e 616c 0a20  ring; optional. 
+0001f910: 2020 2020 2020 204f 7074 696f 6e73 2066         Options f
+0001f920: 6f72 206e 6173 7472 616e 2063 6f6d 6d61  or nastran comma
+0001f930: 6e64 0a20 2020 2065 7874 203a 2073 7472  nd.    ext : str
+0001f940: 696e 673b 206f 7074 696f 6e61 6c0a 2020  ing; optional.  
+0001f950: 2020 2020 2020 5468 6520 6578 7465 6e73        The extens
+0001f960: 696f 6e20 6f66 2074 6865 204e 6173 7472  ion of the Nastr
+0001f970: 616e 206f 7574 7075 7420 2866 3036 2920  an output (f06) 
+0001f980: 6669 6c65 3b20 7573 7561 6c6c 7920 2766  file; usually 'f
+0001f990: 3036 270a 2020 2020 2020 2020 6f72 2027  06'.        or '
+0001f9a0: 6f75 7427 0a20 2020 2073 746f 706f 6e66  out'.    stoponf
+0001f9b0: 6174 616c 203a 2062 6f6f 6c3b 206f 7074  atal : bool; opt
+0001f9c0: 696f 6e61 6c0a 2020 2020 2020 2020 5365  ional.        Se
+0001f9d0: 7420 746f 2054 7275 6520 6966 2079 6f75  t to True if you
+0001f9e0: 2077 616e 7420 7468 6520 7363 7269 7074   want the script
+0001f9f0: 2074 6f20 6578 6974 206f 6e20 6669 7273   to exit on firs
+0001fa00: 7420 4641 5441 4c0a 2020 2020 2020 2020  t FATAL.        
+0001fa10: 696e 7374 6561 6420 6f66 2063 6f6e 7469  instead of conti
+0001fa20: 6e75 696e 6720 6f6e 0a20 2020 2073 6865  nuing on.    she
+0001fa30: 6c6c 203a 2073 7472 696e 673b 206f 7074  ll : string; opt
+0001fa40: 696f 6e61 6c0a 2020 2020 2020 2020 5368  ional.        Sh
+0001fa50: 656c 6c20 7072 6f67 7261 6d20 746f 2077  ell program to w
+0001fa60: 7269 7465 2061 7420 746f 7020 6f66 2073  rite at top of s
+0001fa70: 6372 6970 742c 2065 673a 2023 2160 7368  cript, eg: #!`sh
+0001fa80: 656c 6c60 0a20 2020 2066 696c 6573 203a  ell`.    files :
+0001fa90: 2073 7472 696e 6720 6f72 204e 6f6e 653b   string or None;
+0001faa0: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
+0001fab0: 2020 4c69 7374 206f 6620 6669 6c65 6e61    List of filena
+0001fac0: 6d65 7320 746f 2072 756e 3b20 6966 204e  mes to run; if N
+0001fad0: 6f6e 652c 2075 7365 7220 6973 2070 726f  one, user is pro
+0001fae0: 6d70 7465 6420 666f 7220 6e61 6d65 730a  mpted for names.
+0001faf0: 2020 2020 6265 666f 7265 203a 2073 7472      before : str
+0001fb00: 696e 673b 206f 7074 696f 6e61 6c0a 2020  ing; optional.  
+0001fb10: 2020 2020 2020 5374 7269 6e67 2074 6f20        String to 
+0001fb20: 7075 7420 696e 2073 6865 6c6c 2073 6372  put in shell scr
+0001fb30: 6970 7420 6265 666f 7265 2065 6163 6820  ipt before each 
+0001fb40: 6e61 7374 7261 6e20 636f 6d6d 616e 640a  nastran command.
+0001fb50: 2020 2020 6166 7465 7220 3a20 7374 7269      after : stri
+0001fb60: 6e67 3b20 6f70 7469 6f6e 616c 0a20 2020  ng; optional.   
+0001fb70: 2020 2020 2053 7472 696e 6720 746f 2070       String to p
+0001fb80: 7574 2069 6e20 7368 656c 6c20 7363 7269  ut in shell scri
+0001fb90: 7074 2061 6674 6572 2065 6163 6820 6e61  pt after each na
+0001fba0: 7374 7261 6e20 636f 6d6d 616e 640a 2020  stran command.  
+0001fbb0: 2020 746f 7020 3a20 7374 7269 6e67 3b20    top : string; 
+0001fbc0: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
+0001fbd0: 2053 7472 696e 6720 746f 2070 7574 2069   String to put i
+0001fbe0: 6e20 7368 656c 6c20 7363 7269 7074 2061  n shell script a
+0001fbf0: 7420 7468 6520 746f 700a 2020 2020 626f  t the top.    bo
+0001fc00: 7474 6f6d 203a 2073 7472 696e 673b 206f  ttom : string; o
+0001fc10: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
+0001fc20: 5374 7269 6e67 2074 6f20 7075 7420 696e  String to put in
+0001fc30: 2073 6865 6c6c 2073 6372 6970 7420 6174   shell script at
+0001fc40: 2074 6865 2062 6f74 746f 6d0a 0a20 2020   the bottom..   
+0001fc50: 2052 6574 7572 6e73 0a20 2020 202d 2d2d   Returns.    ---
+0001fc60: 2d2d 2d2d 0a20 2020 204e 6f6e 650a 0a20  ----.    None.. 
+0001fc70: 2020 204e 6f74 6573 0a20 2020 202d 2d2d     Notes.    ---
+0001fc80: 2d2d 0a20 2020 2049 6620 796f 7527 7265  --.    If you're
+0001fc90: 2069 6e20 7468 6520 2762 6173 6827 2073   in the 'bash' s
+0001fca0: 6865 6c6c 2c20 7468 6520 7265 7375 6c74  hell, the result
+0001fcb0: 696e 6720 7363 7269 7074 2063 616e 2062  ing script can b
+0001fcc0: 6520 7275 6e20 696e 0a20 2020 2074 6865  e run in.    the
+0001fcd0: 2062 6163 6b67 726f 756e 6420 7769 7468   background with
+0001fce0: 2c20 6173 7375 6d69 6e67 2074 6865 2073  , assuming the s
+0001fcf0: 6372 6970 7420 6e61 6d65 2069 7320 2764  cript name is 'd
+0001fd00: 6f72 756e 732e 7368 273a 3a0a 0a20 2020  oruns.sh'::..   
+0001fd10: 2020 2020 6e6f 6875 7020 2e2f 646f 7275      nohup ./doru
+0001fd20: 6e73 2e73 6820 3e20 646f 7275 6e73 2e6c  ns.sh > doruns.l
+0001fd30: 6f67 2032 3e26 3120 260a 0a20 2020 2045  og 2>&1 &..    E
+0001fd40: 7861 6d70 6c65 2075 7361 6765 3a3a 0a0a  xample usage::..
+0001fd50: 2020 2020 2020 2020 6672 6f6d 2070 7979          from pyy
+0001fd60: 6574 6920 696d 706f 7274 206e 6173 7472  eti import nastr
+0001fd70: 616e 0a20 2020 2020 2020 206e 6173 7472  an.        nastr
+0001fd80: 616e 2e6d 6b6e 6173 7428 2764 6f72 756e  an.mknast('dorun
+0001fd90: 732e 7368 272c 2066 696c 6573 3d5b 2766  s.sh', files=['f
+0001fda0: 696c 6531 2e64 6174 272c 2027 6669 6c65  ile1.dat', 'file
+0001fdb0: 322e 6461 7427 5d29 0a20 2020 2022 2222  2.dat']).    """
+0001fdc0: 0a20 2020 2023 204e 616d 6520 6f66 2073  .    # Name of s
+0001fdd0: 6372 6970 7420 746f 2063 7265 6174 653a  cript to create:
+0001fde0: 0a20 2020 2069 6620 7363 7269 7074 2069  .    if script i
+0001fdf0: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
+0001fe00: 7363 7269 7074 203d 2069 6e70 7574 2822  script = input("
+0001fe10: 4e61 6d65 206f 6620 7368 656c 6c20 7363  Name of shell sc
+0001fe20: 7269 7074 2074 6f20 6372 6561 7465 2028  ript to create (
+0001fe30: 646f 7275 6e73 2e73 6829 3a20 2229 0a20  doruns.sh): "). 
+0001fe40: 2020 2020 2020 2069 6620 6e6f 7420 7363         if not sc
+0001fe50: 7269 7074 3a0a 2020 2020 2020 2020 2020  ript:.          
+0001fe60: 2020 7363 7269 7074 203d 2022 646f 7275    script = "doru
+0001fe70: 6e73 2e73 6822 0a0a 2020 2020 2320 696e  ns.sh"..    # in
+0001fe80: 6974 6961 6c69 7a65 2073 6865 6c6c 2073  itialize shell s
+0001fe90: 6372 6970 740a 2020 2020 4752 4550 203d  cript.    GREP =
+0001fea0: 2022 6772 6570 202d 6c20 275b 2a5e 5d5b   "grep -l '[*^][
+0001feb0: 2a5e 5d5b 2a5e 5d2e 2a46 4154 414c 2722  *^][*^].*FATAL'"
+0001fec0: 0a20 2020 2077 6974 6820 6f70 656e 2873  .    with open(s
+0001fed0: 6372 6970 742c 2022 7722 2920 6173 2066  cript, "w") as f
+0001fee0: 3a0a 2020 2020 2020 2020 662e 7772 6974  :.        f.writ
+0001fef0: 6528 6622 2321 7b73 6865 6c6c 7d5c 6e22  e(f"#!{shell}\n"
+0001ff00: 290a 2020 2020 2020 2020 6375 7264 6972  ).        curdir
+0001ff10: 203d 206f 732e 6765 7463 7764 2829 0a20   = os.getcwd(). 
+0001ff20: 2020 2020 2020 2066 2e77 7269 7465 2866         f.write(f
+0001ff30: 2263 6420 7b63 7572 6469 727d 5c6e 5c6e  "cd {curdir}\n\n
+0001ff40: 2229 0a20 2020 2020 2020 2069 6620 746f  ").        if to
+0001ff50: 703a 0a20 2020 2020 2020 2020 2020 2066  p:.            f
+0001ff60: 2e77 7269 7465 2866 227b 746f 707d 5c6e  .write(f"{top}\n
+0001ff70: 2229 0a0a 2020 2020 2020 2020 6920 3d20  ")..        i = 
+0001ff80: 2d31 0a20 2020 2020 2020 2077 6869 6c65  -1.        while
+0001ff90: 2031 3a20 2023 206c 6f6f 7020 6f76 6572   1:  # loop over
+0001ffa0: 2066 696c 6520 6e61 6d65 730a 2020 2020   file names.    
+0001ffb0: 2020 2020 2020 2020 6920 2b3d 2031 0a20          i += 1. 
+0001ffc0: 2020 2020 2020 2020 2020 2069 6620 6669             if fi
+0001ffd0: 6c65 7320 6973 206e 6f74 204e 6f6e 653a  les is not None:
+0001ffe0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001fff0: 2069 6620 6920 3e3d 206c 656e 2866 696c   if i >= len(fil
+00020000: 6573 293a 0a20 2020 2020 2020 2020 2020  es):.           
+00020010: 2020 2020 2020 2020 2062 7265 616b 0a20           break. 
+00020020: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00020030: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00020040: 2020 2020 2020 2020 206e 6173 6669 6c65           nasfile
+00020050: 203d 2066 696c 6573 5b69 5d0a 2020 2020   = files[i].    
+00020060: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00020070: 2020 2020 2020 2020 2020 2020 2020 7020                p 
+00020080: 3d20 6622 4669 6c65 2023 7b69 202b 2031  = f"File #{i + 1
+00020090: 3a32 647d 2028 626c 616e 6b20 746f 2071  :2d} (blank to q
+000200a0: 7569 7429 3a20 220a 2020 2020 2020 2020  uit): ".        
+000200b0: 2020 2020 2020 2020 6e61 7366 696c 6520          nasfile 
+000200c0: 3d20 696e 7075 7428 7029 0a20 2020 2020  = input(p).     
+000200d0: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
+000200e0: 7420 6e61 7366 696c 653a 0a20 2020 2020  t nasfile:.     
+000200f0: 2020 2020 2020 2020 2020 2020 2020 2062                 b
+00020100: 7265 616b 0a0a 2020 2020 2020 2020 2020  reak..          
+00020110: 2020 6966 206e 6f74 206f 732e 7061 7468    if not os.path
+00020120: 2e65 7869 7374 7328 6e61 7366 696c 6529  .exists(nasfile)
+00020130: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00020140: 2020 7761 726e 696e 6773 2e77 6172 6e28    warnings.warn(
+00020150: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00020160: 2020 2020 2066 2266 696c 6520 277b 6e61       f"file '{na
+00020170: 7366 696c 657d 2720 6e6f 7420 666f 756e  sfile}' not foun
+00020180: 6422 2c0a 2020 2020 2020 2020 2020 2020  d",.            
+00020190: 2020 2020 2020 2020 5275 6e74 696d 6557          RuntimeW
+000201a0: 6172 6e69 6e67 2c0a 2020 2020 2020 2020  arning,.        
+000201b0: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+000201c0: 2020 2020 2020 2066 2e77 7269 7465 2866         f.write(f
+000201d0: 225c 6e23 202a 2a2a 2a2a 2a2a 2a20 4669  "\n# ******** Fi
+000201e0: 6c65 207b 6e61 7366 696c 657d 202a 2a2a  le {nasfile} ***
+000201f0: 2a2a 2a2a 2a5c 6e22 290a 2020 2020 2020  *****\n").      
+00020200: 2020 2020 2020 7020 3d20 6e61 7366 696c        p = nasfil
+00020210: 652e 7266 696e 6428 222f 2229 0a20 2020  e.rfind("/").   
+00020220: 2020 2020 2020 2020 2069 6620 7020 3e20           if p > 
+00020230: 2d31 3a0a 2020 2020 2020 2020 2020 2020  -1:.            
+00020240: 2020 2020 6669 6c65 7061 7468 203d 206e      filepath = n
+00020250: 6173 6669 6c65 5b3a 705d 0a20 2020 2020  asfile[:p].     
+00020260: 2020 2020 2020 2020 2020 2066 696c 656e             filen
+00020270: 616d 6520 3d20 6e61 7366 696c 655b 7020  ame = nasfile[p 
+00020280: 2b20 3120 3a5d 0a20 2020 2020 2020 2020  + 1 :].         
+00020290: 2020 2020 2020 2066 2e77 7269 7465 2866         f.write(f
+000202a0: 2220 2063 6420 7b66 696c 6570 6174 687d  "  cd {filepath}
+000202b0: 5c6e 2229 0a20 2020 2020 2020 2020 2020  \n").           
+000202c0: 2020 2020 2064 6f63 6420 3d20 310a 2020       docd = 1.  
+000202d0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+000202e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000202f0: 6669 6c65 6e61 6d65 203d 206e 6173 6669  filename = nasfi
+00020300: 6c65 0a20 2020 2020 2020 2020 2020 2020  le.             
+00020310: 2020 2064 6f63 6420 3d20 300a 0a20 2020     docd = 0..   
+00020320: 2020 2020 2020 2020 2069 6620 6265 666f           if befo
+00020330: 7265 3a0a 2020 2020 2020 2020 2020 2020  re:.            
+00020340: 2020 2020 662e 7772 6974 6528 6622 7b62      f.write(f"{b
+00020350: 6566 6f72 657d 5c6e 2229 0a20 2020 2020  efore}\n").     
+00020360: 2020 2020 2020 2066 2e77 7269 7465 2866         f.write(f
+00020370: 2220 207b 6e61 7363 6f6d 7d20 277b 6e61  "  {nascom} '{na
+00020380: 736f 7074 7d27 2027 7b66 696c 656e 616d  sopt}' '{filenam
+00020390: 657d 275c 6e22 290a 0a20 2020 2020 2020  e}'\n")..       
+000203a0: 2020 2020 2069 6620 7374 6f70 6f6e 6661       if stoponfa
+000203b0: 7461 6c3a 0a20 2020 2020 2020 2020 2020  tal:.           
+000203c0: 2020 2020 2070 203d 2066 696c 656e 616d       p = filenam
+000203d0: 652e 7266 696e 6428 222e 2229 0a20 2020  e.rfind(".").   
+000203e0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+000203f0: 7020 3e20 2d31 3a0a 2020 2020 2020 2020  p > -1:.        
+00020400: 2020 2020 2020 2020 2020 2020 6630 3666              f06f
+00020410: 696c 6520 3d20 6669 6c65 6e61 6d65 5b3a  ile = filename[:
+00020420: 2070 202b 2031 5d20 2b20 6578 740a 2020   p + 1] + ext.  
+00020430: 2020 2020 2020 2020 2020 2020 2020 656c                el
+00020440: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00020450: 2020 2020 2020 2020 6630 3666 696c 6520          f06file 
+00020460: 3d20 6669 6c65 6e61 6d65 202b 2022 2e22  = filename + "."
+00020470: 202b 2065 7874 0a0a 2020 2020 2020 2020   + ext..        
+00020480: 2020 2020 2020 2020 662e 7772 6974 6528          f.write(
+00020490: 6622 2020 6966 205b 2058 2021 3d20 5860  f"  if [ X != X`
+000204a0: 7b47 5245 507d 207b 6630 3666 696c 657d  {GREP} {f06file}
+000204b0: 6020 5d20 3b20 7468 656e 5c6e 2229 0a20  ` ] ; then\n"). 
+000204c0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+000204d0: 2e77 7269 7465 2822 2020 2020 6578 6974  .write("    exit
+000204e0: 5c6e 2229 0a20 2020 2020 2020 2020 2020  \n").           
+000204f0: 2020 2020 2066 2e77 7269 7465 2822 2020       f.write("  
+00020500: 6669 5c6e 2229 0a20 2020 2020 2020 2020  fi\n").         
+00020510: 2020 2069 6620 6166 7465 723a 0a20 2020     if after:.   
+00020520: 2020 2020 2020 2020 2020 2020 2066 2e77               f.w
+00020530: 7269 7465 2866 227b 6166 7465 727d 5c6e  rite(f"{after}\n
+00020540: 2229 0a0a 2020 2020 2020 2020 2020 2020  ")..            
+00020550: 6966 2064 6f63 643a 0a20 2020 2020 2020  if docd:.       
+00020560: 2020 2020 2020 2020 2066 2e77 7269 7465           f.write
+00020570: 2866 2220 2063 6420 7b63 7572 6469 727d  (f"  cd {curdir}
+00020580: 5c6e 2229 0a0a 2020 2020 2020 2020 6966  \n")..        if
+00020590: 2062 6f74 746f 6d3a 0a20 2020 2020 2020   bottom:.       
+000205a0: 2020 2020 2066 2e77 7269 7465 2866 227b       f.write(f"{
+000205b0: 626f 7474 6f6d 7d5c 6e22 290a 2020 2020  bottom}\n").    
+000205c0: 6f73 2e73 7973 7465 6d28 6622 6368 6d6f  os.system(f"chmo
+000205d0: 6420 612b 7278 2027 7b73 6372 6970 747d  d a+rx '{script}
+000205e0: 2722 290a 0a0a 6465 6620 7264 6474 6970  '")...def rddtip
+000205f0: 6368 2866 2c20 6e61 6d65 3d22 5455 4731  ch(f, name="TUG1
+00020600: 2229 3a0a 2020 2020 2222 220a 2020 2020  "):.    """.    
+00020610: 5265 6164 2074 6865 2032 6e64 2072 6563  Read the 2nd rec
+00020620: 6f72 6420 6f66 2073 7065 6369 6669 6320  ord of specific 
+00020630: 4454 4973 2066 726f 6d20 6120 2e70 6368  DTIs from a .pch
+00020640: 2066 696c 652e 0a0a 2020 2020 5061 7261   file...    Para
+00020650: 6d65 7465 7273 0a20 2020 202d 2d2d 2d2d  meters.    -----
+00020660: 2d2d 2d2d 2d0a 2020 2020 6620 3a20 7374  -----.    f : st
+00020670: 7269 6e67 206f 7220 6669 6c65 5f6c 696b  ring or file_lik
+00020680: 6520 6f72 204e 6f6e 650a 2020 2020 2020  e or None.      
+00020690: 2020 4569 7468 6572 2061 206e 616d 6520    Either a name 
+000206a0: 6f66 2061 2066 696c 652c 206f 7220 6973  of a file, or is
+000206b0: 2061 2066 696c 655f 6c69 6b65 206f 626a   a file_like obj
+000206c0: 6563 7420 6173 2072 6574 7572 6e65 640a  ect as returned.
+000206d0: 2020 2020 2020 2020 6279 203a 6675 6e63          by :func
+000206e0: 3a60 6f70 656e 602e 2049 6620 6669 6c65  :`open`. If file
+000206f0: 5f6c 696b 6520 6f62 6a65 6374 2c20 6974  _like object, it
+00020700: 2069 7320 7265 776f 756e 6420 6669 7273   is rewound firs
+00020710: 742e 2043 616e 0a20 2020 2020 2020 2061  t. Can.        a
+00020720: 6c73 6f20 6265 2074 6865 206e 616d 6520  lso be the name 
+00020730: 6f66 2061 2064 6972 6563 746f 7279 206f  of a directory o
+00020740: 7220 4e6f 6e65 3b20 696e 2074 6865 7365  r None; in these
+00020750: 2063 6173 6573 2c20 6120 4755 490a 2020   cases, a GUI.  
+00020760: 2020 2020 2020 6973 206f 7065 6e65 6420        is opened 
+00020770: 666f 7220 6669 6c65 2073 656c 6563 7469  for file selecti
+00020780: 6f6e 2e0a 2020 2020 6e61 6d65 203a 2073  on..    name : s
+00020790: 7472 696e 670a 2020 2020 2020 2020 4e61  tring.        Na
+000207a0: 6d65 206f 6620 4454 4920 7461 626c 6520  me of DTI table 
+000207b0: 746f 2072 6561 6420 6672 6f6d 2074 6865  to read from the
+000207c0: 202e 7063 6820 6669 6c65 0a0a 2020 2020   .pch file..    
+000207d0: 5265 7475 726e 730a 2020 2020 2d2d 2d2d  Returns.    ----
+000207e0: 2d2d 2d0a 2020 2020 6964 5f64 6f66 203a  ---.    id_dof :
+000207f0: 206e 6461 7272 6179 0a20 2020 2020 2020   ndarray.       
+00020800: 2032 2d63 6f6c 756d 6e20 6d61 7472 6978   2-column matrix
+00020810: 206f 6620 7468 6520 666f 726d 3a20 6060   of the form: ``
+00020820: 5b69 642c 2064 6f66 5d60 602e 2054 6865  [id, dof]``. The
+00020830: 206e 756d 6265 7220 6f66 2072 6f77 730a   number of rows.
+00020840: 2020 2020 2020 2020 696e 2060 6964 5f64          in `id_d
+00020850: 6f66 6020 636f 7272 6573 706f 6e64 7320  of` corresponds 
+00020860: 746f 2074 6865 206d 6174 6368 696e 6720  to the matching 
+00020870: 6d61 7472 6978 2069 6e20 2e6f 7034 2066  matrix in .op4 f
+00020880: 696c 650a 2020 2020 2020 2020 2873 6565  ile.        (see
+00020890: 204e 6f74 6573 292e 0a0a 2020 2020 4e6f   Notes)...    No
+000208a0: 7465 730a 2020 2020 2d2d 2d2d 2d0a 2020  tes.    -----.  
+000208b0: 2020 5468 6973 2072 6f75 7469 6e65 2069    This routine i
+000208c0: 7320 7573 6566 756c 2066 6f72 2072 6561  s useful for rea
+000208d0: 6469 6e67 2064 6174 6120 6672 6f6d 202e  ding data from .
+000208e0: 7063 6820 6669 6c65 7320 7772 6974 7465  pch files writte
+000208f0: 6e20 6279 0a20 2020 2074 6865 2045 5854  n by.    the EXT
+00020900: 5345 4f55 5420 636f 6d6d 616e 642e 2054  SEOUT command. T
+00020910: 6865 2032 6e64 2072 6563 6f72 6420 6f66  he 2nd record of
+00020920: 2022 5455 4731 2220 2866 6f72 2065 7861   "TUG1" (for exa
+00020930: 6d70 6c65 290a 2020 2020 636f 6e74 6169  mple).    contai
+00020940: 6e73 2074 6865 2044 4f46 2074 6861 7420  ns the DOF that 
+00020950: 636f 7272 6573 706f 6e64 2074 6f20 7468  correspond to th
+00020960: 6520 726f 7773 206f 6620 7468 6520 224d  e rows of the "M
+00020970: 5547 3122 206d 6174 7269 780a 2020 2020  UG1" matrix.    
+00020980: 696e 2074 6865 202e 6f70 3420 6669 6c65  in the .op4 file
+00020990: 2e20 5468 6174 206d 6174 7269 7820 6361  . That matrix ca
+000209a0: 6e20 6265 2072 6561 6420 6279 2074 6865  n be read by the
+000209b0: 0a20 2020 203a 6d6f 643a 6070 7979 6574  .    :mod:`pyyet
+000209c0: 692e 6e61 7374 7261 6e2e 6f70 3460 206d  i.nastran.op4` m
+000209d0: 6f64 756c 652e 0a0a 2020 2020 4578 616d  odule...    Exam
+000209e0: 706c 6520 7573 6167 653a 3a0a 0a20 2020  ple usage::..   
+000209f0: 2020 2020 2023 2072 6561 6420 6d75 6731       # read mug1
+00020a00: 2061 6e64 2074 7567 3120 2863 7265 6174   and tug1 (creat
+00020a10: 6564 2066 726f 6d20 4558 5453 454f 5554  ed from EXTSEOUT
+00020a20: 293a 0a20 2020 2020 2020 2066 726f 6d20  ):.        from 
+00020a30: 7079 7965 7469 2069 6d70 6f72 7420 6e61  pyyeti import na
+00020a40: 7374 7261 6e0a 2020 2020 2020 2020 6672  stran.        fr
+00020a50: 6f6d 2070 7979 6574 692e 6e61 7374 7261  om pyyeti.nastra
+00020a60: 6e20 696d 706f 7274 206f 7034 0a20 2020  n import op4.   
+00020a70: 2020 2020 206d 7567 3120 3d20 6f70 342e       mug1 = op4.
+00020a80: 7265 6164 2827 6461 7461 2e6f 7034 272c  read('data.op4',
+00020a90: 2027 6d75 6731 2729 5b27 6d75 6731 275d   'mug1')['mug1']
+00020aa0: 0a20 2020 2020 2020 2074 7567 3120 3d20  .        tug1 = 
+00020ab0: 6e61 7374 7261 6e2e 7264 6474 6970 6368  nastran.rddtipch
+00020ac0: 2827 6461 7461 2e70 6368 2729 0a0a 2020  ('data.pch')..  
+00020ad0: 2020 2020 2020 2320 666f 726d 2044 524d        # form DRM
+00020ae0: 2074 6f20 7265 636f 7665 7279 2067 7269   to recovery gri
+00020af0: 6420 3130 302c 2064 6f66 2034 3a0a 2020  d 100, dof 4:.  
+00020b00: 2020 2020 2020 6672 6f6d 2070 7979 6574        from pyyet
+00020b10: 6920 696d 706f 7274 206c 6f63 6174 650a  i import locate.
+00020b20: 2020 2020 2020 2020 726f 7720 3d20 6c6f          row = lo
+00020b30: 6361 7465 2e66 696e 645f 726f 7773 2874  cate.find_rows(t
+00020b40: 7567 312c 205b 3130 302c 2034 5d29 0a20  ug1, [100, 4]). 
+00020b50: 2020 2020 2020 2064 726d 203d 206d 7567         drm = mug
+00020b60: 315b 726f 772c 203a 5d0a 2020 2020 2222  1[row, :].    ""
+00020b70: 220a 2020 2020 7374 7269 6e67 203d 2066  ".    string = f
+00020b80: 2244 5449 2020 2020 207b 6e61 6d65 3a3c  "DTI     {name:<
+00020b90: 3873 7d32 220a 2020 2020 6320 3d20 7264  8s}2".    c = rd
+00020ba0: 6361 7264 7328 662c 2073 7472 696e 6729  cards(f, string)
+00020bb0: 0a20 2020 2063 203d 2063 5b30 2c20 3136  .    c = c[0, 16
+00020bc0: 3a2d 315d 2e72 6573 6861 7065 282d 312c  :-1].reshape(-1,
+00020bd0: 2034 292e 6173 7479 7065 286e 702e 696e   4).astype(np.in
+00020be0: 7436 3429 0a20 2020 206d 203d 2063 5b3a  t64).    m = c[:
+00020bf0: 2c20 313a 5d0a 0a20 2020 2023 2061 7272  , 1:]..    # arr
+00020c00: 6179 285b 5b20 2020 2020 2033 2c20 2020  ay([[      3,   
+00020c10: 2020 2020 362c 2020 2020 2020 2031 5d2c      6,       1],
+00020c20: 0a20 2020 2023 2020 2020 2020 2020 5b20  .    #        [ 
+00020c30: 2020 2020 3131 2c20 2020 2020 2020 362c      11,       6,
+00020c40: 2020 2020 2020 2037 5d2c 0a20 2020 2023         7],.    #
+00020c50: 2020 2020 2020 2020 5b20 2020 2020 3139          [     19
+00020c60: 2c20 2020 2020 2020 362c 2020 2020 2020  ,       6,      
+00020c70: 3133 5d2c 0a20 2020 2023 2020 2020 2020  13],.    #      
+00020c80: 2020 5b20 2020 2020 3237 2c20 2020 2020    [     27,     
+00020c90: 2020 362c 2020 2020 2020 3139 5d2c 0a20    6,      19],. 
+00020ca0: 2020 2023 2020 2020 2020 2020 5b20 2020     #        [   
+00020cb0: 2020 3435 2c20 2020 2020 2020 362c 2020    45,       6,  
+00020cc0: 2020 2020 3235 5d2c 0a20 2020 2023 2020      25],.    #  
+00020cd0: 2020 2020 2020 5b20 2020 2020 3630 2c20        [     60, 
+00020ce0: 2020 2020 2020 362c 2020 2020 2020 3331        6,      31
+00020cf0: 5d2c 0a20 2020 2023 2020 2020 2020 2020  ],.    #        
+00020d00: 5b31 3939 3530 3032 2c20 2020 2020 2020  [1995002,       
+00020d10: 362c 2020 2020 2020 3337 5d5d 290a 0a20  6,      37]]).. 
+00020d20: 2020 2069 6620 6e70 2e61 6c6c 286d 5b3a     if np.all(m[:
+00020d30: 2c20 315d 203d 3d20 6d5b 302c 2031 5d29  , 1] == m[0, 1])
+00020d40: 3a0a 2020 2020 2020 2020 2320 616c 6c20  :.        # all 
+00020d50: 6964 7320 6861 7665 2073 616d 6520 6e75  ids have same nu
+00020d60: 6d62 6572 206f 6620 636f 6d70 6f6e 656e  mber of componen
+00020d70: 7473 2c20 736f 2074 616b 6520 7368 6f72  ts, so take shor
+00020d80: 7463 7574 3a0a 2020 2020 2020 2020 6320  tcut:.        c 
+00020d90: 3d20 6d5b 302c 2031 5d0a 2020 2020 2020  = m[0, 1].      
+00020da0: 2020 6964 7320 3d20 6e70 2e64 6f74 286d    ids = np.dot(m
+00020db0: 5b3a 2c20 303a 315d 2c20 6e70 2e6f 6e65  [:, 0:1], np.one
+00020dc0: 7328 2831 2c20 6329 2c20 6e70 2e69 6e74  s((1, c), np.int
+00020dd0: 3634 2929 0a20 2020 2020 2020 2069 6473  64)).        ids
+00020de0: 203d 2069 6473 2e72 6573 6861 7065 2828   = ids.reshape((
+00020df0: 2d31 2c20 3129 290a 2020 2020 2020 2020  -1, 1)).        
+00020e00: 646f 6620 3d20 6e70 2e61 7261 6e67 6528  dof = np.arange(
+00020e10: 312c 2063 202b 2031 2c20 6474 7970 653d  1, c + 1, dtype=
+00020e20: 6e70 2e69 6e74 3634 292e 7265 7368 6170  np.int64).reshap
+00020e30: 6528 312c 202d 3129 0a20 2020 2020 2020  e(1, -1).       
+00020e40: 2064 6f66 7320 3d20 6e70 2e64 6f74 286e   dofs = np.dot(n
+00020e50: 702e 6f6e 6573 2828 6e70 2e73 697a 6528  p.ones((np.size(
+00020e60: 6d2c 2030 292c 2031 292c 206e 702e 696e  m, 0), 1), np.in
+00020e70: 7436 3429 2c20 646f 6629 0a20 2020 2020  t64), dof).     
+00020e80: 2020 2064 6f66 7320 3d20 646f 6673 2e72     dofs = dofs.r
+00020e90: 6573 6861 7065 2828 2d31 2c20 3129 290a  eshape((-1, 1)).
+00020ea0: 2020 2020 2020 2020 6964 646f 6620 3d20          iddof = 
+00020eb0: 6e70 2e68 7374 6163 6b28 2869 6473 2c20  np.hstack((ids, 
+00020ec0: 646f 6673 2929 0a20 2020 2065 6c73 653a  dofs)).    else:
+00020ed0: 0a20 2020 2020 2020 206e 726f 7773 203d  .        nrows =
+00020ee0: 206d 5b2d 312c 2032 5d20 2b20 6d5b 2d31   m[-1, 2] + m[-1
+00020ef0: 2c20 315d 202d 2031 0a20 2020 2020 2020  , 1] - 1.       
+00020f00: 2069 6464 6f66 203d 206e 702e 7a65 726f   iddof = np.zero
+00020f10: 7328 286e 726f 7773 2c20 3229 2c20 6e70  s((nrows, 2), np
+00020f20: 2e69 6e74 3634 290a 2020 2020 2020 2020  .int64).        
+00020f30: 6a20 3d20 300a 2020 2020 2020 2020 666f  j = 0.        fo
+00020f40: 7220 4a20 696e 2072 616e 6765 286e 702e  r J in range(np.
+00020f50: 7369 7a65 286d 2c20 3029 293a 0a20 2020  size(m, 0)):.   
+00020f60: 2020 2020 2020 2020 2070 7620 3d20 6e70           pv = np
+00020f70: 2e61 7261 6e67 6528 302c 206d 5b4a 2c20  .arange(0, m[J, 
+00020f80: 315d 2c20 6474 7970 653d 6e70 2e69 6e74  1], dtype=np.int
+00020f90: 3634 290a 2020 2020 2020 2020 2020 2020  64).            
+00020fa0: 6964 646f 665b 7076 202b 206a 2c20 305d  iddof[pv + j, 0]
+00020fb0: 203d 206d 5b4a 2c20 305d 0a20 2020 2020   = m[J, 0].     
+00020fc0: 2020 2020 2020 2069 6464 6f66 5b70 7620         iddof[pv 
+00020fd0: 2b20 6a2c 2031 5d20 3d20 7076 202b 2031  + j, 1] = pv + 1
+00020fe0: 0a20 2020 2020 2020 2020 2020 206a 202b  .            j +
+00020ff0: 3d20 6d5b 4a2c 2031 5d0a 2020 2020 7265  = m[J, 1].    re
+00021000: 7475 726e 2069 6464 6f66 0a              turn iddof.
```

### Comparing `pyyeti-1.3.0/pyyeti/nastran/n2p.py` & `pyyeti-1.3.1/pyyeti/nastran/n2p.py`

 * *Files identical despite different names*

### Comparing `pyyeti-1.3.0/pyyeti/nastran/op2.py` & `pyyeti-1.3.1/pyyeti/nastran/op2.py`

 * *Files identical despite different names*

### Comparing `pyyeti-1.3.0/pyyeti/nastran/op4.py` & `pyyeti-1.3.1/pyyeti/nastran/op4.py`

 * *Files identical despite different names*

### Comparing `pyyeti-1.3.0/pyyeti/ode/__init__.py` & `pyyeti-1.3.1/pyyeti/ode/__init__.py`

 * *Files identical despite different names*

### Comparing `pyyeti-1.3.0/pyyeti/ode/_base_ode_class.py` & `pyyeti-1.3.1/pyyeti/ode/_base_ode_class.py`

 * *Files identical despite different names*

### Comparing `pyyeti-1.3.0/pyyeti/ode/_utilities.py` & `pyyeti-1.3.1/pyyeti/ode/_utilities.py`

 * *Files identical despite different names*

### Comparing `pyyeti-1.3.0/pyyeti/ode/freqdirect.py` & `pyyeti-1.3.1/pyyeti/ode/freqdirect.py`

 * *Files identical despite different names*

### Comparing `pyyeti-1.3.0/pyyeti/ode/frf_mode_participation.py` & `pyyeti-1.3.1/pyyeti/ode/frf_mode_participation.py`

 * *Files identical despite different names*

### Comparing `pyyeti-1.3.0/pyyeti/ode/solvecdf.py` & `pyyeti-1.3.1/pyyeti/ode/solvecdf.py`

 * *Files identical despite different names*

### Comparing `pyyeti-1.3.0/pyyeti/ode/solveexp1.py` & `pyyeti-1.3.1/pyyeti/ode/solveexp1.py`

 * *Files identical despite different names*

### Comparing `pyyeti-1.3.0/pyyeti/ode/solveexp2.py` & `pyyeti-1.3.1/pyyeti/ode/solveexp2.py`

 * *Files identical despite different names*

### Comparing `pyyeti-1.3.0/pyyeti/ode/solvenewmark.py` & `pyyeti-1.3.1/pyyeti/ode/solvenewmark.py`

 * *Files identical despite different names*

### Comparing `pyyeti-1.3.0/pyyeti/ode/solveunc.py` & `pyyeti-1.3.1/pyyeti/ode/solveunc.py`

 * *Files identical despite different names*

### Comparing `pyyeti-1.3.0/pyyeti/pp.py` & `pyyeti-1.3.1/pyyeti/pp.py`

 * *Files identical despite different names*

### Comparing `pyyeti-1.3.0/pyyeti/psd.py` & `pyyeti-1.3.1/pyyeti/psd.py`

 * *Files identical despite different names*

### Comparing `pyyeti-1.3.0/pyyeti/rainflow/c_rain.c` & `pyyeti-1.3.1/pyyeti/rainflow/c_rain.c`

 * *Files identical despite different names*

### Comparing `pyyeti-1.3.0/pyyeti/rainflow/py_rain.py` & `pyyeti-1.3.1/pyyeti/rainflow/py_rain.py`

 * *Files identical despite different names*

### Comparing `pyyeti-1.3.0/pyyeti/srs.py` & `pyyeti-1.3.1/pyyeti/srs.py`

 * *Files identical despite different names*

### Comparing `pyyeti-1.3.0/pyyeti/ssmodel.py` & `pyyeti-1.3.1/pyyeti/ssmodel.py`

 * *Files identical despite different names*

### Comparing `pyyeti-1.3.0/pyyeti/stats.py` & `pyyeti-1.3.1/pyyeti/stats.py`

 * *Files identical despite different names*

### Comparing `pyyeti-1.3.0/pyyeti/writer.py` & `pyyeti-1.3.1/pyyeti/writer.py`

 * *Files identical despite different names*

### Comparing `pyyeti-1.3.0/pyyeti/ytools.py` & `pyyeti-1.3.1/pyyeti/ytools.py`

 * *Files 0% similar despite different names*

```diff
@@ -337,17 +337,17 @@
          the second equation from the first gives::
 
              alpha * b1 - beta * b2 = mid2 - mid1
 
          That equation is actually three equations with two of them
          being independent. Therefore, we can solve for ``alpha`` and
          ``beta`` using a least-squares approach (
-         :func:`np.linalg.lstsq`). Then, we can use either of the two
-         equations above to solve for `center`. Note the `center` is
-         in basic coordinates.
+         :func:`numpy.linalg.lstsq`). Then, we can use either of the
+         two equations above to solve for `center`. Note the `center`
+         is in basic coordinates.
       9. The coordinates of all points can now be calculated in the
          local coordinate system (note that the local z-coordinate is
          0.0 for all points)::
 
             local = basic2local @ (basic - center)
 
      10. The radius for each point in ``local`` is simply the root-sum-
```

### Comparing `pyyeti-1.3.0/pyyeti.egg-info/PKG-INFO` & `pyyeti-1.3.1/pyyeti.egg-info/PKG-INFO`

 * *Files 6% similar despite different names*

```diff
@@ -1,21 +1,19 @@
 Metadata-Version: 2.1
 Name: pyyeti
-Version: 1.3.0
+Version: 1.3.1
 Summary: Tools mostly related to structural dynamics
 Home-page: http://github.com/twmacro/pyyeti/
 Author: Tim Widrick
 Author-email: twmacro@gmail.com
 License: BSD
 Platform: any
 Classifier: Development Status :: 4 - Beta
 Classifier: Programming Language :: C
 Classifier: Programming Language :: Python
-Classifier: Programming Language :: Python :: 3.6
-Classifier: Programming Language :: Python :: 3.7
 Classifier: Programming Language :: Python :: 3.8
 Classifier: Programming Language :: Python :: 3.9
 Classifier: Programming Language :: Python :: 3.10
 Classifier: Programming Language :: Python :: 3.11
 Classifier: Programming Language :: Python :: 3 :: Only
 Classifier: Programming Language :: Python :: Implementation :: CPython
 Classifier: Natural Language :: English
```

#### html2text {}

```diff
@@ -1,22 +1,20 @@
-Metadata-Version: 2.1 Name: pyyeti Version: 1.3.0 Summary: Tools mostly related
+Metadata-Version: 2.1 Name: pyyeti Version: 1.3.1 Summary: Tools mostly related
 to structural dynamics Home-page: http://github.com/twmacro/pyyeti/ Author: Tim
 Widrick Author-email: twmacro@gmail.com License: BSD Platform: any Classifier:
 Development Status :: 4 - Beta Classifier: Programming Language :: C
 Classifier: Programming Language :: Python Classifier: Programming Language ::
-Python :: 3.6 Classifier: Programming Language :: Python :: 3.7 Classifier:
-Programming Language :: Python :: 3.8 Classifier: Programming Language ::
-Python :: 3.9 Classifier: Programming Language :: Python :: 3.10 Classifier:
-Programming Language :: Python :: 3.11 Classifier: Programming Language ::
-Python :: 3 :: Only Classifier: Programming Language :: Python ::
-Implementation :: CPython Classifier: Natural Language :: English Classifier:
-Intended Audience :: Science/Research Classifier: License :: OSI Approved ::
-BSD License Classifier: Operating System :: OS Independent Classifier: Topic ::
-Scientific/Engineering Description-Content-Type: text/markdown License-File:
-LICENSE.txt
+Python :: 3.8 Classifier: Programming Language :: Python :: 3.9 Classifier:
+Programming Language :: Python :: 3.10 Classifier: Programming Language ::
+Python :: 3.11 Classifier: Programming Language :: Python :: 3 :: Only
+Classifier: Programming Language :: Python :: Implementation :: CPython
+Classifier: Natural Language :: English Classifier: Intended Audience ::
+Science/Research Classifier: License :: OSI Approved :: BSD License Classifier:
+Operating System :: OS Independent Classifier: Topic :: Scientific/Engineering
+Description-Content-Type: text/markdown License-File: LICENSE.txt
 [Build_Status] [Documentation_Status] [Coverage_Status] [License:_BSD_3-Clause]
                           [PyPI] [Code_style:_black]
 # pyYeti pyYeti has tools mostly related to structural dynamics: * Solve matrix
 equations of motion in the time and frequency domains * Shock response spectrum
 (SRS) * Fatigue damage equivalent power spectral densities (PSD) * Hurty-Craig-
 Bampton model checks * Coupled loads analysis tools * Statistics tools for
 computing k-factors (for tolerance bounds and intervals) and for order
```

### Comparing `pyyeti-1.3.0/pyyeti.egg-info/SOURCES.txt` & `pyyeti-1.3.1/pyyeti.egg-info/SOURCES.txt`

 * *Files identical despite different names*

### Comparing `pyyeti-1.3.0/scripts/lsop2` & `pyyeti-1.3.1/scripts/lsop2`

 * *Files identical despite different names*

### Comparing `pyyeti-1.3.0/setup.py` & `pyyeti-1.3.1/setup.py`

 * *Files 3% similar despite different names*

```diff
@@ -24,16 +24,14 @@
 
 
 long_description = read("README.md")
 CLASSIFIERS = [
     "Development Status :: 4 - Beta",
     "Programming Language :: C",
     "Programming Language :: Python",
-    "Programming Language :: Python :: 3.6",
-    "Programming Language :: Python :: 3.7",
     "Programming Language :: Python :: 3.8",
     "Programming Language :: Python :: 3.9",
     "Programming Language :: Python :: 3.10",
     "Programming Language :: Python :: 3.11",
     "Programming Language :: Python :: 3 :: Only",
     "Programming Language :: Python :: Implementation :: CPython",
     "Natural Language :: English",
@@ -93,15 +91,15 @@
         )
     else:
         kw = {}
 
     install_requires = check_dependencies()
     setup(
         name="pyyeti",
-        version="1.3.0",
+        version="1.3.1",
         url="http://github.com/twmacro/pyyeti/",
         license="BSD",
         author="Tim Widrick",
         install_requires=install_requires,
         author_email="twmacro@gmail.com",
         description=("Tools mostly related to structural dynamics"),
         long_description=long_description,
```

### Comparing `pyyeti-1.3.0/tests/nas2cam_csuper/inboard.asm` & `pyyeti-1.3.1/tests/nas2cam_csuper/inboard.asm`

 * *Files identical despite different names*

### Comparing `pyyeti-1.3.0/tests/nas2cam_csuper/inboard.op4` & `pyyeti-1.3.1/tests/nas2cam_csuper/inboard.op4`

 * *Files identical despite different names*

### Comparing `pyyeti-1.3.0/tests/nas2cam_csuper/inboard.pch` & `pyyeti-1.3.1/tests/nas2cam_csuper/inboard.pch`

 * *Files identical despite different names*

### Comparing `pyyeti-1.3.0/tests/nas2cam_csuper/nas2cam.op2` & `pyyeti-1.3.1/tests/nas2cam_csuper/nas2cam.op2`

 * *Files identical despite different names*

### Comparing `pyyeti-1.3.0/tests/nas2cam_csuper/nas2cam.op4` & `pyyeti-1.3.1/tests/nas2cam_csuper/nas2cam.op4`

 * *Files identical despite different names*

### Comparing `pyyeti-1.3.0/tests/nastran_drm12/drm12.op2` & `pyyeti-1.3.1/tests/nastran_drm12/drm12.op2`

 * *Files identical despite different names*

### Comparing `pyyeti-1.3.0/tests/nastran_drm12/drm12.op4` & `pyyeti-1.3.1/tests/nastran_drm12/drm12.op4`

 * *Files identical despite different names*

### Comparing `pyyeti-1.3.0/tests/nastran_drm12/inboard_nas2cam.op2` & `pyyeti-1.3.1/tests/nastran_drm12/inboard_nas2cam.op2`

 * *Files identical despite different names*

### Comparing `pyyeti-1.3.0/tests/nastran_drm12/inboard_nas2cam.op4` & `pyyeti-1.3.1/tests/nastran_drm12/inboard_nas2cam.op4`

 * *Files identical despite different names*

